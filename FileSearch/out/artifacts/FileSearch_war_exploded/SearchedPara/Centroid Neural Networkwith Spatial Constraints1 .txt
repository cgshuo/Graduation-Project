 Much attention has been paid to image segmentation by many researchers [1] -[4]. Image segmentation is a technique of decomposing an image into meaningful parts, or objects. Each object is labeled in a way that facilitates the description of the original image so that it can be interpreted by the system that handles the image. In general, image segmentation classifies image X  X  pixels as belonging to one of the  X  X bjects X  composing the the image. It is widely used in practice such as in object detection and image classification applications. In the field of medicine, image segmentation is often used to analyze MR image.
 Traditionally, in order to cluster an image into objects, algorithms such as Self Organizing Map(SOM)[5], k-means[6], Fuzzy c-means(FCM)[7], and Centroid Neural Network(CNN)[8] are the most w idely used in practice. The k-means, SOM, CNN are common approaches to assign each object into one or many classes according to their features. k -means algorithm is one of the common unsupervised learning algorithms that solve the well known clustering problem. One strength of the k-means algorithm is fast in convergence and be able to apply for a large data. Another popular approach for data clustering problems is SOM algorithm. The main idea of SOM algorithm is to find winner neuron, which is the closest to a given datum, and to update the synaptic weights of winner and its neighbors. However, performance of SOM algorithm heavily depends on the initial parameter values including the learning coefficient, the sequence of data presentation, and the number of iterations. One of the efficient clustering methods is FCM. FCM is a method of clustering which allows one piece of data to belong to two or more clusters. It requires each data in the data set to belong to each of the clusters with corresponding membership value.

In order to improve the unstableness of k-means and SOM, the Centroid Neu-ral Network (CNN)[8] algorithm introduced the concepts of the reward and the punishment to the winner and the loser neurons. To have a better local minimum than k-means and SOM, CNN starts with setting the number of groups at 2 and increases the number of groups step by st ep until it reaches the predetermined number of groups. In most of experimen ts, CNN has shown a superior perfor-mance to k-means and some conventional algorithms such as SOM, DCL[9], and SLA[10].

The SOM, k-means, FCM and CNN are used to assign each object into one or many classes. These algorithms have basically solved the problem of clustering objects well. From experiments with MR images,however, we recognized that these algorithms yield less optimal solutions when images are contaminated with noise. In practice, when analyzing an MR image, the noise can affect the doctor X  X  diagnosis and thus this problem poses a particular challenge to researchers.
Noise usually exists in audio signals and images and is a cause of ambigu-ousness. A generally accepted method utilizes the intensities of neighbor values to reduce noise in audio or images. From this concept, a clustering approach called Centroid Neural Network with spatial constraints (CNN-S) is proposed in this paper. The proposed CNN-S algorithm is devised to cope with the noises in image segmentation problems. The proposed CNN-S algorithm utilizes the weights of attributes to evaluate the roles of attributes on data. The main pixel of a block is given a higher weight than neighbor pixels.

The remainder of this paper is organized as follows: Section 2 presents a brief summary of the CNN algorithm. The CNN-S with spatial constraints algorithm is proposed in Section 3. Sect ion 4 presents experiments and results on synthetic data and a real-world application. Section 5 concludes the paper. The CNN algorithm [8] is an unsupervised competitive learning algorithm based on the classical k-means clustering algorithm [6]. It finds the centroids of clusters at each presentation of the data vector . The CNN first introduces definitions of the winner neuron and the loser neuron. When a data x i is given to the network at the epoch (k), the winner neuron at the epoch (k) is the neuron with the minimum distance to x i . The loser neuron at the epoch (k) to x i is the neuron that was the winner of x i at the epoch (k-1) but is not the winner of x i at the epoch (k). The CNN updates its weights only when the status of the output neuron for the presenting data has changed when compared to the status from the previous epoch.

When an input vector x is presented to the network at epoch n ,theweight update equations for winner neuron j and loser neuron i in CNN can be sum-marized as follows: where w j ( n )and w i ( n ) represent the weight vectors of the winner neuron and the loser neuron, iteration, respectively.

The CNN has several advantages over conventional algorithms such as SOM or k-means algorithm when used for clustering and unsupervised competitive learning. The CNN requires neither a predetermined schedule for learning gain nor the total number of iterations for clustering. It always converges to sub-optimal solutions while conventional algorithms such as SOM may give unstable results depending on the initial learning gains and the total number of iterations. More detailed description on the CNN can be found in [8,11].

Note that the CNN was designed for deterministic data because the distance measure used in the CNN is the quadric (Euclidean) distance. The Centroid Neural Network with spatial constraints is based on the Centroid Neural Network algorithm and utilizes spatial constraints to increase the influ-ence of neighbor vectors.

Assume that N data vectors, x ( i ) ,i =1 ..N and the number of clusters, M ,are given. Each of the datum is grouped as a member of one of the M clusters. Each of group is represented by prototype vector w j .Cluster i has N i members and x ( j ) denotes the data j in the cluster i for one instance and x i ( j )isthemean vector of neighbor vectors of x i ( j ). The penalty of neighbor pixels to the main pixel is defined by the parameter  X  .
 The object function of CNN-S can be rewritten as follows: defined as the input vector, the mean vector of neighbor vectors around the input, a prototype of the cluster w i , and the penalty of neighbors pixels, respectively.
By minimizing the object function J , we obtain the equations of the proto-typesasfollows:
From Eq.(4), we can derive the formulas to update the winner neuron j and the loser neuron i . That is, when a data vector x is applied to the the network at time n , the update equations for the winner neuron j and the loser neuron i in CNN-S can be written as follows:  X  for the winner neuron j ,  X  for the loser neuron i , In order to avoid getting stuck at an undesirable local minimum solution, the CNN-S algorithm starts at 2 clusters and increases the number of clusters one by one until it reaches the predetermined number of groups like the CNN algorithm. The CNN-S algorithm improves upon the CNN algorithm with respect to solv-ing the noisy image segmentation problem. The result of the CNN-S algorithm depends on the parameter  X  , which is a penalty of neighbor pixels. In this section, we describe experimental results on both synthetic data and a real-world problem. FCM, FCM-S [12,13] and CNN-S are used for the perfor-mance evaluation purpose.
 In the experiments, the original image is divided into overlapping 3x3 blocks. In the data set, a heuristic is used: larger weights for the main pixel and smaller weights for neighbor pixels. Thus, the distance of two vectors is changed to the Euclidean distance with weights.
 4.1 Experiments on Synthetic Data The synthetic data used for experiments consists of a 64x64 image. The image includes two classes with two intensity values, taken as 0 and 120. We tested the performance of the algorithms where the image data are corrupted by  X  X alt and pepper X  noise. This data set is similar to the data set described in [12]. The results are evaluated by the ratio of the number of pixels with correct classification over the total number of p ixels. The performance results of the different algorithms and the segmentation images are shown in Table 1 and Fig.1, respectively.

On experiments with synthetic data, the algorithms were tested with different  X  values. For the overall classification results of the three different algorithms, the proposed CNN-S algorithm achieves 98.57% accuracy while the FCM and the FCM-S show 43% accuracy and 93.71% accu racy, respectively. The accuracy of each algorithm depends on the  X  value. The  X  value refers to the penalty of neigh-bor pixels to the main pixels. A higher  X  reflects greater influence of neighbor pixels. The clustering accuracies with various  X  values are shown in Table.2. 4.2 Experiments on Real-World Application Experiments on MR images collected from the Internet Brain Segmentation Repository(IBSR) [14] are also performed. The test images are brain MR images with 3% noise. The image segmentation technique was used to cluster the MR image into 3 parts, i.e., gray matter, white matter, and cerebrospinal fluid, and comparison scores were calculated by the following ratio: where A j represents a set of pixels that belong to the j th class and A refj repre-sents a set of pixels that belong to the j th class in the reference segmented image. In the experiments,  X  =0 . 8 was used for all algorithms with spatial constraints. Fig.2 and Table 3 present a comparison of image segmentation results on a real T1-weighted MR image. The scores in Table 3 evaluate the classification results of the algorithms of interest. As can b e seen in Table 3, the proposed CNN-S algorithm outperforms FCM and FCM-S by 17.58% and 5.29%, respectively. In this paper, the CNN-S algorithm is proposed for solving image segmenta-tion when noise is present in images. The proposed CNN-S algorithm, based on the CNN algorithm, incorporates spatial constraints to increase the influence of neighbor pixels and reduce the noise in image. The proposed algorithm is applied to image segmentation problems where a certain noise is present in two types of images: a synthetic image and a MR image. The proposed CNN-S algorithm is compared with FCM and FCM-S, the proposed CNN-S outperforms FCM and FCM-S by 17.58% and 5.29% , respectively, in MRI experiments.
 This work was supported by the Korea Science and Engineering Foundation (KOSEF) grant funded by the Korean government (MOST)( Grant No.: R01-2007-000-20330-0). This manuscript was prepared with the help of Tran Nhon and ICRL members.

