 Enterprise computer networks are filled with users perform-ing a variety of tasks, ranging from business-critical tasks to personal interest browsing. Due to this multi-modal dis-tribution of behaviors, it is non-trivial to automatically dis-cern which behaviors are business-relevant and which are not. Additionally, it is di ffi cult to infer communities of in-terest within the enterprise, even given an organizational mapping. In this work, we present a two-step framework for classifying user behavior within an enterprise in a data-driven way. As a first step, we use a latent topic model on active search queries to identify types of behaviors and top-ics of interest associated with a given user. We then leverage the information about user X  X  assigned role within the orga-nization to extract relevant topics which are most reflective of self-organizing communities of interest. We demonstrate that our framework is able to identify rich communities of interest that are better representations of how users interact and assemble in an enterprise setting.
 H.3.3 [ Information Storage and Retrieval ]: Information Search and Retrieval topic modeling; clustering; business intelligence; Latent Dirichlet Allocation
As enterprises become more diversified, it is increasingly diffi-cult for stakeholders to characterize the body of work taking place on their computer networks and accurately cluster users according  X  This work is sponsored by the Department of Defense under Air Force Contract FA8721-05-C-0002. Opinions, interpre-tations, conclusions and recommendations are those of the author and are not necessarily endorsed by the United States Government. to their job functions. Although enterprise stakeholders have access to categorical organizational data separating users into the internal hierarchy of the enterprise, such data often proves insufficient to the task of characterizing and classifying the actual behavior of users. For instance, users with very similar job functions (and therefore similar professional needs and interests), in practice may be sep-arated into different partitions of the enterprise. Additionally, the network behavior of enterprise users is often multi-modal; activi-ties performed arise from both business and non-business related interests. These factors make it difficult to infer user communi-ties of interest, which has implications to situational awareness and collaborative recommendations within the enterprise.

In this paper, we present a framework for inferring communi-ties of business interest within an enterprise computer network by modeling user behaviors. For the purpose of this study, we leverage web search queries as a well understood mechanism for expressing topics of interest [10]. We characterize both group and individual behavior on an enterprise network with a latent topic model, specif-ically Latent Dirichlet Allocation (LDA) [1], effectively treating the history of activity for a user as a bag-of-words document.
Given a model of user behavior and a representation of each user as a vector in the corresponding topic space, we discover the ness -related topics of interest through a feature selection mecha-nism. We demonstrate the inferential power of these filtered topics in identifying latent user communities of interest. Furthermore, the characterization of these communities points to non-trivial and use-ful insights on latent self-organization within an enterprise.
Some previous works using latent models over search queries treat each of these queries as individual observations [9] or as indi-vidual documents themselves [12], towards the goal of improving search. We are principally interested in the complete distribution of query terms of an enterprise X  X  users, and take an aggregation of microtext approach similar to [8]. While they pool terms over tweet content to reduce noise, we aggregate over individual users.
Latent topic models have been used for document classification and information retrieval in the past [1, 13]. While we aim to group users according to their topic distributions, we are more interested in identifying the latent communities of interest rather than some super-imposed or pre-determined organization. We show that the discovered communities differ greatly from the imperfect oracle that is an org chart.

Our work is an extension of [10], where we demonstrated the efficacy of using latent topic models to perform inference of user behaviors and interests by modeling network artifacts. While that work focused on the collective interests of an enterprise, in this work we aim to discover the self-organization of its individuals. Figure 1: The standard LDA plate model used to model topics, z ,fromtheobservedwords, w ,ofasetofusers, U .
Search queries are an imperfect observation of a particular user X  X  latent  X  X nterest X  space. However, they are an active expression of interest in a particular topic by the user, making them quite inter-esting. In order to efficiently model user interests, we will leverage latent topic models over the collection of search queries that users issue on an enterprise computer network, as we did in [10].
Latent Dirichlet Allocation [1] is a generative Bayesian topic model where observations are conditioned on latent hidden vari-ables with Dirichlet priors. Assume that there are W unique query tokens (e.g. individual words within a query) and U users, where each user u is represented as a  X  X ocument X  with N u tokens col-lected over their entire search history. Furthermore, each user has a multinomial distribution  X  u over the K topics, and each topic has a multinomial distribution  X  z over the W tokens. These dis-tributions have a Dirichlet prior with fixed hyperparameters respectively. For each token w ( u ) n from user u , LDA asserts that a z n . A plate diagram for this model is shown in Fig. 1.
Training an LDA model to data entails estimating both the user-topic  X  and topic-word  X  distributions from the observed users, given the fixed hyperparameters of the Dirichlet priors and the num-ber of topics K . Exact inference is intractable, so we perform in-ference utilizing Gibbs sampling [6]. We implement LDA with the Matlab Topic Toolbox 1.4 [4] on commodity hardware and set the hyperparameters  X  =200 /W  X  0 . 05 and  X  =0 . 25 ,whichbiases the method towards sparse topics. This will become important in identifying clusters of users.

We take a basic quantitative approach at measuring model fit by computing the model perplexity of the trained models against a held out test set [1]. We trained on 90% of the users, holding out 10% as a test set, and used Laplace smoothing to account for out-of-vocabulary words encountered in the test set. Varying over the number of topics K , we discovered that the best model fit occurred at
K =100 , which will be used for the remainder of this paper.
We collected web proxy logs aggregating the activity of 3715 users of a mid-sized enterprise network from September 1, 2011 to May 15, 2012, anonymizing the logs to protect user privacy. We capture user search history by mining user HTTP request lines from web proxy logs for search query strings.

We select the set T of acceptable tokens in the corpus by count-ing all strings of concurrent words of size 1 to n within each query for each user, for some integer n . We then filter tokens following a basic algorithm used to identify common n -grams, while also re-moving from T unigram tokens which are composed of stop words or are shorter than 3 characters. At the end of the tokenization stage, each user  X  X ocument X  consists of all of the tokens mined from a user X  X  search history. The complete process resulted in |T| =34621 unique tokens across 3491 users.

Each user u i is additionally assigned to a class y i according to the organizationally-defined identifier. For this enterprise, we consider 7 distinct groups, which we will refer to by the set Y = { A, B, C, D, E, F, G } , y i  X  Y . The number of users in each group in Y ranged from 192 to 371.
There are several issues which make it difficult to discover an organizational structure from network behavior. Of the totality of user X  X  network activity, only a subset is directly related to their role within the enterprise. Many organizations have policies which al-low limited personal use of the company network, and there is lit-tle reason to believe the non-business behaviors are strongly cor-related with business activities. Additionally, an organizational mapping does not necessarily correspond directly with the day-to-day activities and tasking of enterprise users. Individuals with the same interests and skill sets may self-organize into communities that cross organizational boundaries. We explore these factors in subsequent sections.
It may seem intuitive to cluster all user behaviors according to their pre-defined class labels, Y , which implies that the organiza-tional mapping is a perfect oracle of actual user behavior and in-terests. We can demonstrate this is not the case by measuring the natural separation of clusters in Y in the topic space. Let us define each user u  X  R K as a K -dimensional vector for which each of the K topics is a feature. Given their multinomial nature, we measure the cosine distance between user vectors to determine similarity.
We use the Average Silhoutte Width (ASW) [11] as an exter-nal clustering quality measure, which is defined as: where C is the defined clustering. The silhouette,  X  1  X  s ( i )  X  1 measures how well a certain data point u i fits within its cluster by comparing the average distance to other members of y i closest average distances to data from another cluster y j Large values of s ( i ) correspond to a u i that is appropriately clus-tered, while negative values suggest the data would be better served being clustered elsewhere. Utilizing the organizational cluster def-inition, Y , we measure ASW Y =  X  0 . 0038 , which suggests signif-icant overlap and little-to-no separation between clusters.
Network activity that falls under the non-business regime com-plicates the inference process of discovering business -based latent relationships and can be viewed as noise, even if the topics them-selves are coherent. To filter such noise, we must identify the topics which are business relevant rather than simply evaluating individ-ual topic quality based on unsupervised metrics (e.g. topic entropy). While this can be done manually through domain expertise, it may also be viewed as an automated feature selection problem.
Using a random forest classifier [2], which performs classifica-tion through an ensemble of decision trees, we perform topic selec-tion by measuring the impact each topic has on classification per-formance. While the organization mapping is an imperfect oracle of the latent communities, it does represent some level of inten-tional discrimination, such as product groups or areas of expertise. We aim to identify the topics which best characterize this intent and use those topics to infer the latent community structure. Figure 2: Measures used to evaluate feature importance in discriminating business from non-business topics.
 Table 1: The 5 most and least discriminating topics w.r.t. business vs. non-business activities of the enterprise.
The random forest classifier offers two means of determining feature importance: Out of Bag Permuted Variable Error (PVE) and the Gini Impurity measure [2]. PVE of a given feature quan-tifies the sensitivity of the out of bag (e.g. held out sample) error estimate to random permutations of the feature values. High sensi-tivity indicates the feature is critical for discriminating the different class labels. The Gini measure computes on average the increase in information gain by splitting the data based on the values of a given feature; similarly with large values indicating high discriminative power. Agreement between the two measures indicates robustness of the feature selection results.

In Fig. 2 we illustrate the values of both the PVE and Gini mea-sures, ranked in descending order. We note that they have very similar profiles, including the discovery of topics which have a neg-ative impact on classification performance. There was an overlap of 8 of the top 10 topics between the two measures, while the two non-agreeing topics were still ranked in the top 15 of each of the other measures. Hence, the topics that we identify as business related do indeed possess discriminative power. As an illustration, least discriminating topics. Noting that this enterprise focuses on technology and engineering, the resultant topics clearly represent topics that are of business and non-business interests respectively; this has been confirmed by subject matter experts.
We now look to identify communities of business interest and discover how they relate to the organizational mapping. By lever-aging standard clustering algorithms on user topic vectors, we aim Locations have been redacted for privacy considerations Figure 3: Clustering quality as a function of the number of discriminating topics. The dotted line represents quality when all topics are considered, with the optimal nc =2. Figure 4: An example cluster of users characterized by the 10 most discriminative topics. Each color represents one of the organizational-defined subgroups. to discover two properties of the network: Does topic selection im-prove the quality of identified clusters? Does the clustering offer non-obvious insights into latent communities in the enterprise?
Let us first represent each user u ( M ) space defined by the M most discriminating topics according to the PVE measure. Each vector is then re-normalized, such that all elements sum to unity, in order to maintain a multinomial inter-pretation. We cluster each distribution vector u ( M ) version of the k -means algorithm which iterates over several initial center sets to avoid convergence to local optima [5]. This version of the algorithm automatically selects the number of clusters by optimizing an external clustering quality measure (e.g. ASW).
Fig. 3 shows ASW as a function of number of discriminating topics M .Sincetheoptimalnumberofclustersdifferedaswevar-ied M , we plot results for a range of numbers of clusters compare the clustering quality with the optimal clustering ( corresponding to the entire topic space. We observe a consistent trend of improvement in clustering quality across the range of dif-ferent numbers of discriminative topics, becoming substantial for small M . The significant improvement in quality suggests that our hypothesis of a multi-modal distribution is correct, where noisy topics complicate the community inference process.

The improvement in clustering quality is inherent in the data and not an artifact of the clustering technique or the quality measure. In Table 2 we show clustering results from an additional cluster-ing algorithm, PAM [7], which is considered to be more robust in Figure 5: The probability mass function (PMF) of vari-ous clusterings, with top 25 topics ranked by discriminative power. The solid line is the cluster presented in Fig. 4, while the dashed lines represent the pre-defined subgroups Y .
Method Metric Business Non-business All k -means PAM Table 2: Clustering quality when 10 most discriminative topics are considered as business-related, with the remainder considered non-business. The numbers in parenthesis indi-cate the number of clusters used within each algorithm, high-lighting the optimal values across the di ff erent topic spaces. handling noise and outliers than k -means. We also evaluated algo-rithms with the Calinski-Harabasz (CH) index, which computes the ratio of within cluster dispersion to across cluster separation [3].
Fig. 4 illustrates how the inferred latent clustering relates to the organizational mapping Y .Weselectedoneof nc =10 clusters produced by the M =10 most discriminative topics. A trivial re-sult would have been a strong overlap with Y ,yetweobservea much more rich and diverse composition of users in this cluster. This becomes even more clear when we examine the topic distri-bution of users as presented in Fig. 5. We see the users in this cluster are overwhelmingly driven by the 2nd most discriminative topic (see Table 1), accounting for more than 10% of their total search queries. This is a larger proportion of activity than any of the organization-defined subgroups has for any other topic (dashed lines), as it is identifying a community interested in aircraft-related items, pulled from across many groups. This was especially true for groups B and G , which have the mission goals of supporting domestic air travel and airborne surveillance, respectively. These types of results were common amongst our inferred clusters.
We tested cluster quality with k -means clustering over all topics pre-processed via tf-idf feature weighting. The resultant perfor-mance ASW =0 . 226 was maximized with nc =100 clusters (
ASW =0 . 087 for nc =10 ). The overall lower retrieved qual-ity demonstrates the necessity of filtering topics rather than simply re-weighting them with a scheme such as tf-idf .
In this paper we have demonstrated the ability to discover topics and communities of business relevance within an enterprise com-puter network, based on modeling user search queries with a latent topic model. We have shown that users conduct both business non-business activities on the network, the latter of which acts as a substantial source of noise when trying to infer clusters of users. By performing feature selection in the topic space, we were able to filter this noise and discover self-organized communities of busi-ness interest. These inferred communities showed significant dif-ferences from the pre-defined organizational structure leading to a more truthful representation of users X  shared interests.
This work has many potential applications, such as developing recommendation systems within the enterprise. While this is com-mon in many social networking domains, it has not been thoroughly explored for internal business intelligence. In future work, we aim to discover communities based on other network artifacts, such as website visits and server authentications. [1] D. M. Blei, A. Y. Ng, M. I. Jordan, and J. Lafferty. Latent [2] L. Breiman. Random forests. Machine Learning , [3] T. Calinski and J. Harabasz. A dendrite method for cluster [4] T. Griffiths and M. Steyvers. Finding scientific topics. In [5] C. Hennig. Flexible procedures for clustering, 2010. [6] M. Jordan, editor. Learning in Graphical Models .MIT [7] L. Kaufman and P. Rousseeuw. Clustering by Means of [8] R. Mehrotra, S. Sanner, W. Buntine, and L. Xie. Improving [9] B. Peng, Y. Wang, and J.-T. Sun. Mining mobile users X  [10] B. Priest and K. M. Carter. Characterizing latent user [11] P. Rousseeuw. Silhouettes: a graphical aid to the [12] W. Song, Y. Zhang, T. Liu, and S. Li. Bridging topic [13] X. Wei and W. B. Croft. LDA-based document models for
