 Wei Chu chuwei@ga tsby.ucl.a c.uk Zoubin Ghahramani zoubin@ga tsby.ucl.a c.uk David L. Wild david wild@k gi.edu Protein secondary structure prediction remains an im-portan t step on the way to full tertiary structure pre-diction in computational biology . A variety of ap-proac hes have been prop osed to deriv e the secondary structure of a protein from its amino acid sequence as a classification problem. Beginning with the semi-nal work of Qian and Sejno wski (1988), many of these metho ds have utilized neural networks. A major im-provemen t in the prediction accuracy of these metho ds was made by Rost and Sander (1993), who prop osed a prediction scheme using multi-la yered neural networks, known as PHD. The key novel aspect of this work was the use of evolutionary information in the form of pro-files deriv ed from multiple sequence alignmen ts instead of training the networks on single sequences. Another type of alignmen t profile, position-sp ecific scoring ma-trices (PSSM) deriv ed by the iterativ e searc h proce-dure PSI-BLAST (Altsc hul et al., 1997), has been used in neural network prediction metho ds to achieve fur-ther impro vemen ts (Jones, 1999; Cuff &amp; Barton, 2000). An alternativ e approac h is to treat the problem from the perspectiv e of generativ e models. One of the first applications of hidden Mark ov models (HMMs) to the secondary structure prediction problem was describ ed by Delcher et al. (1993). Generalized HMMs with explicit state duration, also known as segmen tal semi-Mark ov models (SSMMs), have been widely applied in the field of gene identification (Burge &amp; Karlin, 1997; Yel et al., 2001; Zhang et al., 2003; Korf et al., 2001). Recen tly, Schmidler (2002) presen ted a particu-lar SSMM for protein structure prediction, which is an interesting statistical generativ e model for sequence-structure relationships. One advantage of the proba-bilistic framew ork is that it is possible to incorp orate varied sources of sequence information using a joint sequence-structure probabilit y distribution based on structural segmen ts. Secondary structure prediction can then be form ulated as a general Bayesian infer-ence problem. However, the secondary structure pre-diction accuracy of the SSMM as describ ed by Schmi-dler (2002) still falls short of the best contemp orary discriminativ e metho ds. Incorp oration of the pro-files from multiple sequence alignmen ts into the model migh t be a plausible way to impro ve the performance. In this paper, we prop ose a novel parameterized model as the likeliho od function for the SSMM to exploit the information provided by the profiles. Moreo ver, it is straigh tforw ard to incorp orate long range interaction information in  X  -sheets into the modelling. We de-scrib e a Mark ov Chain Monte Carlo sampling scheme to perform inference in this model, and demonstrate the capabilit y of the parametric SSMM to carry out inference on  X  -sheet contact maps in the Bayesian seg-mental framew ork. This abilit y to infer contact maps represen ts one of the advantages of the probabilistic modelling approac h over the traditional discriminativ e approac h to protein secondary structure prediction. The paper is organized as follows. We describ e the Bayesian framew ork of the SSMM with details in sec-tion 2. In section 3 we extend the model to incorp orate long range interactions. In section 4 we discuss the is-sue of parameter estimation. In section 5 a sampling scheme for inference is given, and we point out the ca-pabilit y to infer contact maps in section 6. In section 7 we presen t the results of numerical experimen ts, and conclude in section 8. The key idea in our model for secondary structure prediction is the alignmen t profile deriv ed by multiple sequence alignmen t 1 or PSI-BLAST 2 . For a sequence of n amino acid residues, we can searc h a sequence database for several other sequences which are similar enough at the sequence level to be evolutionarily re-lated. By aligning these sequences and coun ting the number of occurrences of each amino acid at each lo-cation, we obtain an alignmen t profile. Formally , the alignmen t profile O = [ O 1 , O 2 , . . . , O i , . . . , O quence of 20  X  1 vectors, where O i contains the occur-rence coun ts for the 20 amino acids at location i which can be regarded as a realization of a multinomial ran-dom variable. The associated secondary structure can be fully specified in terms of segmen t locations and seg-ment types. The segmen t locations can be identified by the positions of the last residue of these segmen ts, denoted as e = [ e 1 , e 2 , . . . , e m ] where m is the num-ber of segmen ts. We use three secondary structure types. The set of secondary structure types is denoted as T = { H, E, C } where H is used for  X  -helix, E for  X  -strand and C for Coil. The sequence of segmen t types can be denoted as T = [ T 1 , T 2 , . . . , T i , . . . , T with T i  X  T  X  i . It is worth noting the existence of helical capping signals within segmen ts (Aurora &amp; Rose, 1998), which refer to the preference for particu-lar amino acids at the N-and C-terminal ends which terminate helices through side chain-bac kbone hydro-gen bonds or hydrophobic interactions. In Figure 1, we presen t an illustration for the specification of the sec-ondary structure of an observ ed sequence along with the definition of capping positions within segmen ts. Based on the set of protein chains with known sec-ondary structure, we learn an explicit probabilistic model for sequence-structure relationships in the form of a segmen tal semi-Mark ov model.
 The segmen tal semi-Mark ov model (SSMM) (Osten-dorf et al., 1996) is a generalization of hidden Mark ov models that allows each hidden state to generate a variable length sequence of the observ ations. In seg-ment modelling, the segmen t types are regarded as the set of discrete variables, known as states. Each of the segmen t types possesses an underlying generator, which generates a variable-length sequence of obser-vations, i.e. a segmen t. A schematic depiction of the SSMM is presen ted in Figure 2 from the perspectiv e of generativ e models. The variables ( m, e, T ) describ e the secondary structure segmen tation of the sequence. The secondary structure prediction problem consists of computing P ( m, e, T | O ) for an observ ed sequence O . For this purp ose we need to define the prior P ( m, e, T ) and the likeliho od P ( O | m, e, T ). This Bayesian frame-work is describ ed with more details in the following. 2.1. Prior Distribution The prior distribution for the variables describing sec-ondary structure P ( m, e, T ) is factored as
P ( m, e, T ) = P ( m ) The segmen t type depends on the nearest previous neigh bour in the sequence through the state transi-tion probabilities P ( T i | T i  X  1 ), which are specified by a 3  X  3 transition matrix. P ( e i | e i  X  1 , T i ), more exactly P ( l i | T i ) is the segmen tal length distribution of the type T , where l i = e i  X  e i  X  1 with e 0 = 0. Note that the prior on length implicitly defines a prior on the num-ber of segmen ts m for a sequence of a given length. A uniform prior can be assigned for m , i.e. P ( m )  X  1, as this does not have much effect on inference. 2.2. Likeliho od Function The likeliho od is the probabilit y of observing the se-quence of alignmen t profiles given the set of random variables { m, e, T } . Generally , the probabilit y of the observ ations can be evaluated as a product of the seg-ments specified by { m, e, T } : where S i = O [ e is the i -th segmen t, and S  X  i = [ S 1 , S 2 , . . . , S likeliho od function P ( S i | S  X  i , T i ) for each segmen t can be further written as a product of the conditional prob-abilities of individual observ ations where O k is the 20  X  1 coun t vector obtained from the alignmen t profile at the k -th residue. The likeliho od function P ( O k | O [1: k  X  1] , T i ) for each residue should be capable of capturing the core features of the segmen-tal comp osition, such as segmen tal dependency (Eisen-berg et al., 1984) and helical capping signals (Aurora &amp; Rose, 1998). Schmidler et al. (2000) prop osed a helical segmen t model with lookup tables to capture helical capping signals and the hydrophobicit y depen-dency of segmen tal residues. However, this metho d is designed to use the residue sequence only, and its secondary structure prediction accuracy falls short of the best contemp orary metho ds. Incorp oration of the alignmen t profiles into the model migh t be a plausible way to impro ve the performance. Here, we prop ose a new parameterization for the likeliho od function to exploit the information in the profile. 2.2.1. Multinomial Distribution We assume that O k comes from a multinomial distri-bution with 20 possible outcomes and outcome proba-bilities  X  k , a 20  X  1 vector. The outcomes refer to the types of amino acids occurring at the curren t residue position, while O k is a 20  X  1 vector coun ting the oc-currence of these outcomes. Thus, the probabilit y of getting O k can be evaluated by where A is the set of 20 amino acids, O a k is the elemen t in O k for the amino acid a , and  X  a k denotes the proba-bility of the outcome a with the constrain t P a  X  a k = 1. 2.2.2. Dirichlet Distribution As shown in the dependency windo w of Figure 2, the multinomial distribution at the k -th residue is depen-dent upon preceding observ ations within the depen-dency windo w, the segmen t type, and the curren t cap-ping position within the segmen t (refer to Figure 1). The underlying causal impact on the curren t multino-mial distribution, where we observ ed O k , can be cap-tured by a prior distribution over the laten t variables  X  . A natural choice for the prior distribution over  X  k is a Diric hlet, which has also been used to define pri-ors for protein family HMMs (Sj  X olander et al., 1996). In our case, this can be explicitly parameterized by weight matrices with positive elements as follows: where  X  k is a 20  X  1 vector defined as  X  with ` is the length of dependency windo w, 3 ` k = min( k  X  e i  X  1  X  1 , ` ), and weight vectors W cap of size 20  X  1 are used to capture capping signals at the capping position cap of O k . Weight matrices W intr a and W inter of size 20  X  20 are used to capture both intra-segmen tal and inter-segmen tal dependency re-spectiv ely, where the superscript denotes the residue interval.  X (  X  ) is the Gamma function defined as  X ( x ) = R  X  0 t x  X  1 exp(  X  t ) dt . The constrain t  X  a is guaran teed by constraining the weight variables to have positiv e values. Note that we have used two sets of positioning indices for each residue: a sequen tial number k where 1  X  k  X  n , and a capping position cap where cap  X  { N1 , N2 , . . . , Internal , . . . , C2 , C1 } . In total we have three sets of weights for  X   X  T individually . For a segmen t type  X  , we get the set of weight parameters, W  X  = 2.2.3. Dirichlet-Mul tinomial Distribution be finally obtained as an integral over the space of the laten t variables  X  k , which is given by where  X (  X  ) denotes the Gamma function, and  X  k is defined as in (6). 2.3. Posterior Distribution All inferences about the segmen tal variables ( m, e, T ) defining secondary structure are deriv ed from the pos-terior probabilit y P ( m, e, T | O ). Using Bayes X  theorem, where P ( O ) = P { m,e,T } P ( O | m, e, T ) P ( m, e, T ) as the normalizing factor. In this framew ork, we con-sider some importan t measures of the segmen tal vari-ables for an observ ed sequence, such as  X  The most probable segmen tal variables in the poste-rior distribution: arg max MAP estimate;  X  The marginal posterior mode estimate is defined as arg max type at the i -th observ ation.
 The Viterbi and forward-bac kward algorithms for SSMM (Rabiner, 1989) can be emplo yed for the MAP and marginal posterior mode estimate respectiv ely. We have set up a Bayesian framew ork to predict the secondary structure. However, the secondary struc-ture is affected not only by local sequence information, but also by long range interactions with distal regions of the amino acid sequence. An importan t example is a  X  sheet which is built up from several interacting regions of  X  -strands. The strands align so that the NH groups on one strand can form hydrogen bonds with the CO groups on the distal strand and vice versa. The alignmen t can happ en in two ways: either the direc-tion of the polypeptide chain of  X  -strands is identical, a parallel  X  -sheet, or the strand alignmen t is in an al-ternativ e direction, an anti-p arallel  X  -sheet. In Figure 3, we presen t the two cases for a pair of interacting segmen ts, S i and S j with i &lt; j . A binary variable is used to indicate alignmen t direction; d ij = +1 for parallel and d ij =  X  1 for anti-parallel. An integer variable a ij is used to indicate the alignmen t position. The endp oint of S i , known as e i , is used as the ori-gin, and then a ij is defined as the shift between e i and e j for parallel cases, while for anti-parallel cases it is the shift between e i and the beginning point of S j , i.e. e j  X  1 +1. 4 The challenge for a predictiv e approac h is how to introduce these long range interactions into the model. In this section, we extend the paramet-ric model to incorp orate the information of long range interactions in  X  -sheets. 3.1. Prior Specification for Distal Interactions A set of random variables is introduced to de-scrib e the long range interactions, collected as I =  X  { interacting segmen ts together with their alignmen t information. We can expand the prior probabil-ity as P ( m, e, T, I ) = P ( I| m, e, T ) P ( m, e, T ), where P ( m, e, T ) is defined as in (1) and the conditional prob-abilit y P ( I| m, e, T ) can be further factored as
P ( I| m, e, T ) = P ( r | k ) P ( { S j , S j 0 } r j =1 where r is the number of interacting pairs, k is the number of  X  -strands, and { S j , S j 0 } r j =1 denotes a com-bination for  X  -strands to form r interacting pairs. Var-ious specifications for these distributions in (9) are ap-plicable provided that they satisfy P I P ( I| m, e, T ) = 1. In the presen t work, we assume a uniform distri-valid, where c ( r, k ) is the total number of valid com-tributions. We may specify them according to our prior knowledge or learn them from training data. 3.2. Joint Segmen tal Likeliho od It is straigh tforw ard to extend the parametric model (7) to include long range interactions in  X  -sheets, which can be regarded as an extension of the depen-dency windo w to include the distal pairing partners. We introduce another 20  X  20 weight matrix W sheet to capture the correlation between distal interacting pairs. The segmen tal likeliho od function (3) for the  X  -strands can be enhanced as
P ( S i | T i = E, S  X  i , I ) = fined as in (6) and { k  X  } denotes the set of interacting residues of O k that can be determined by I . The probabilistic model we describ e above has two classes of free parameters: a) the parameters that specify discrete distributions, which include the state transition probabilities for P ( T i | T i  X  1 ) in (1), 6 weights in the segmen tal likeliho od (7) and (10), which consist of three sets for differen t segmen tal types, i.e. { W  X  } for  X   X  T .
 The parameters that specify discrete distributions can be directly estimated by their relativ e frequency of oc-currence in the training data set. 7 For a segmen t type  X  , a Maxim um A Posteriori estimate of its associated weights W  X  can be obtained as under the condition of positiv e elemen ts, where P ( W  X  ) is the prior probabilit y usually specified by P ( W  X  )  X  exp(  X  C  X  2 k W  X  k 2 2 ) with C  X   X  0. The op-timal W  X  is therefore the minimizer of the negativ e logarithm of (11), which can be obtained by min subject to w &gt; 0 ,  X  w  X  W  X  , where P { O } means the sum over all the sequences, P {  X  } denotes the sum over all the segmen ts of type  X  , and P ( S i | S  X  i ,  X  ) is defined as in (3). L ( W  X  ) is a regularized functional, and the optimal regularization factor C  X  can be determined by cross validation. 8 A set of auxiliary variables  X  = ln w can be introduced to convert the constrained optimiza-tion problem into an unconstrained problem, and then standard gradien t-based optimization metho ds are em-ployed to minimize L ( W  X  ). Generally , the introduction of long range interactions into the graphical model makes exact calculation of posterior probabilities intractable. Mark ov Chain Monte Carlo (MCMC) algorithms can be applied here to obtain appro ximate inference. A series of samples will be collected according to the joint distribution in the Mark ov chain simulation. As the dimension of the variable space varies in this process, the Metrop olis-Hasting scheme can be applied with a reversible-jump approac h (Green, 1995), which ensures that jumps be-tween models of differing dimension are reversible. What we are interested in here is the posterior distri-bution P ( m, e, T | O ) which is prop ortional to the joint distribution P ( m, e, T, O ). The joint distribution can be evaluated as where P ( m, e, T ) is defined as in (1), and only the seg-ments of  X  -strands are in the interaction set I . Schmi-dler (2002) prop osed an MCMC algorithm by sampling in the posterior distribution P ( m, e, T, I| O ), in which the dependency between ( m, e, T ) and I makes the sampling scheme complicated. However the main idea of the reversible jump approac h is still applicable here. The following set of Metrop olis prop osals are defined for the construction of a Mark ov chain on the space of segmen tations, denoted as V = ( m, e, T ): The acceptance probabilit y for Type change and Endp oint change depends on the ratio of likeliho od
P ( V ,O ) , where the likeliho od is defined as in (12). Seg-ment split and Segment mer ge jumps between segmen-tations of differen t dimension are accepted or rejected according to a reversible-jump Metrop olis criteria. Ac-cording to the requiremen t of detailed balance, the ac-ceptance probabilit y for a new prop osal V  X  should be tance probabilit y for Segment split and Segment mer ge should respectiv ely be where |T | = 3 denotes the number of segmen t types. Due to the factorizations in (12), only the changed parts require evaluation. Once the interact-ing set I has been changed, the joint segmen tal like-lihood has to be calculated again, which is a sum P
I P ( I| m, e, T ) Q S i  X  X  P ( S i | T i , S  X  i ). Although the set I is comp osed of finite elemen ts, it migh t be too expensiv e to traverse all of them. We again apply sam-pling metho ds here to appro ximate the sum by ran-domly walking in the distribution P ( I| m, e, T ) that is defined as in (9). Contact maps represen t the pairwise, inter-residue contacts as a symmetrical, square, boolean matrix. Pollastri and Baldi (2002) have previously applied en-sembles of bidirectional recurren t neural network ar-chitectures to the prediction of such contact maps. In this section, we describ e the capabilit y of this para-metric SSMM model to carry out inference on contact maps. This capabilit y is one of the advantages of the probabilistic modelling approac h over the traditional discriminativ e approac h (e.g. neural networks) to pro-tein secondary structure prediction.  X  -sheets are built up from pairs of  X  -strands with hydrogen bonds, which are prominen t features in contact maps. The set of  X  -sheet interactions is associated with a  X  -she et contact map defined by a n  X  n matrix C whose ij -th entry C ij defined as C ij ( I ) = We may estimate the marginal predicted C from the posterior distribution of P ( m, e, T, I| O ), given by
P ( C ij = 1 | O ) = X where the indicator function C ij ( I ) is defined as in (13). Using the samples we have collected in the dis-tributions P ( m, e, T | O ) and P ( I| m, e, T ) (refer to Sec-tion 5), (14) can be estimated by
P ( C ij = 1 | O ) = P m,e,T P I C ij ( I ) P ( m, e, T, I| O ) where the samples {I} are collected from P ( I| m, e, T ), and N samples of { m, e, T } are from P ( m, e, T | O ). We implemen ted the prop osed algorithm in ANSI C. 10 In this implemen tation, the length of dependency win-dow was fixed at 5, and the length of N-and C-capping was fixed at 4, and the regularization factors C  X  = 0 . 01  X   X  were chose to estimate the optimal weights. 11 7.1. 7-fold Cross Validation The data set we used is CB513, a non-redundan t set of 513 non-homologous protein chains with structures determined to a resolution of  X  2 . 5  X  A (Cuff &amp; Barton, 2000). 12 We used 3-state PDB definitions of secondary structure. We remo ved the proteins that are shorter than 30 residues, or longer than 550 residues, follow-ing Cuff and Barton (2000), to leave 480 proteins for cross validation training. Seven partitions were cre-ated randomly , and cross validation was carried out on these partitions. We used two kinds of alignmen t pro-files: the multiple sequence alignmen t profiles (MSAP) used by Cuff and Barton (2000), and position-sp ecific score matrices (PSSM) as in Jones (1999). For com-parison purp oses, we also implemen ted the algorithm prop osed by Schmidler et al. (2000), which uses the se-quence information only. 13 The validation results are recorded in Table 1. We also cite the results reported by Cuff and Barton (2000) in Table 2 for reference. The results obtained from our model show a great im-provemen t over those of Schmidler et al. (2000) on all evaluation criteria. Compared with the performance of the neural network metho ds with various alignmen t profiles as shown in Table 2, the prediction accuracy of our model is also comp etitiv e. 14 We observ ed that the marginal posterior mode is more accurate than the MAP estimate, which shows that averaging over all the possible segmen tations helps. 7.2. Prediction of Contact Maps We prepared a dataset with long range interaction in-formation specified by the data files of Protein Data Bank (PDB). The dataset, a subset of CB513, is com-posed of 152 protein chains along with  X  -sheet defini-tions. This reduction was caused by the incomplete-ness in the long range interaction information in many of the original PDB files. We carried out 30-fold cross validation on this subset. In MCMC sampling, we col-lected 9000 samples. We have not yet observ ed signif-icant impro vemen t on secondary structure prediction accuracy in the sampling results over exact inference without interactions. This suggests that in our cur-rent model, the main determinan ts of  X  -sheet structure are local contributions rather than distal hydrogen-bonding information. The small size of training data migh t be another factor. However it is interesting that we can infer  X  -sheet contacts. We presen t two predic-tive contact maps in Figure 4 as examples. We have also computed the area under the ROC curve (AUC) for  X  -sheet contact prediction. The average AUC over these protein chains is 0 . 899  X  0 . 086. 7.3. Test on CASP The meetings of Critical Assessmen t of techniques for protein Structure Prediction (CASP) facilitate large-scale experimen ts to assess protein structure prediction metho ds. We extracted protein chains of the latest four meetings from the public web page of the Protein Structure Prediction Center http://predictioncen ter.llnl.go v/. 15 Using the 480 chains from CB513 and their PSSM profiles as train-ing data, we built up our model, and then carried out prediction on these CASP proteins. The predictiv e re-sults of our algorithm are reported in Table 3 indexed by the meetings. These results indicate that our algo-rithm gives a performance that is very similar to that given by other contemp orary metho ds. In this paper, we prop ose a graphical model with a novel parametric likeliho od function to exploit the in-formation in alignmen t profiles. Long range inter-action information in  X  -sheets can be directly incor-porated into the model. The numerical results show that the generalization performance of this graphical model is comp etitiv e with other contemp orary meth-ods. Inference on contact maps can also be carried out in the Bayesian segmen tal framew ork. Moreo ver, with the inclusion of dihedral angle information in the joint sequence-structure probabilit y distribution, this graphical model also has the potential for tertiary structure prediction.

