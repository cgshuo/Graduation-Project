 We consider the problem of link prediction in signed net-works. Such networks arise on the web in a variety of ways when users can implicitly or explicitly tag their relationship with other users as positive or negative. The signed links thus created reflect social attitudes of the users towards each other in terms of friendship or trust. Our first contribution is to show how any quantitative measure of social imbalance in a network can be used to derive a link prediction algo-rithm. Our framework allows us to reinterpret some existing algorithms as well as derive new ones. Second, we extend the approach of [6], by presenting a supervised machine learning based link prediction method that uses features derived from longer cycles in the network. The supervised method out-performs all previous approaches on 3 networks drawn from sources such as Epinions, Slashdot and Wikipedia. The su-pervised approach easily scales to these networks, the largest of which has 132k nodes and 841k edges. Most real-world networks have an overwhelmingly large proportion of posi-tive edges and it is therefore easy to get a high overall ac-curacy at the cost of a high false positive rate. We see that our supervised method not only achieves good accuracy for sign prediction but is also especially effective in lowering the false positive rate.
 H.4 [ Information Systems Applications ]: Miscellaneous ;J.4[ Computer Applications ]: Social and Behavioral Sciences X  Sociology Algorithms, Experimentation  X  Equal contribution to the work.
 Link &amp; Graph Mining, Web &amp; Social Knowledge Manage-ment
Many research problems in the analysis of networks, social or otherwise, have been tackled by modeling the presence or absence of relationships between pairs of entities using a graph where a relationship is simply indicated by a positively weighted edge. Recently, real-world networks have appeared that do not fit this simple description. In e-commerce sites such as Ebay, users of the network develop trust and distrust in agents in the network; websites such as Amazon let mem-bers express their likes and dislikes toward the purchased products; online review and news websites such as Epinions and Slashdot allow readers to approve or denounce reviews and articles; certain nodes in a computer network may be detected as byzantine by a sub-network, and communica-tion through a byzantine node is considered unreliable. In all such cases, it is helpful to think of the edges between entities as being signed either positively or negatively.
The study of signed networks dates back to the early 1950s [1] where dislikes and distrusts were modeled as nega-tive weight edges in a graph. A formal model encompassing different types of interpersonal relationships was proposed and notion of balance in signed graphs was defined.
We note that the nature and complexity of many graph problems change once negative edges are introduced. For example, the shortest-path problem in the presence of cy-cles with negative edges is known to be NP-hard. Conse-quently, solutions to problems in unsigned social networks are usually not immediately applicable to signed networks. In particular, signed link prediction has connections to so-cial balance theory while no such connection exists for the standard (unsigned) link prediction task.

The proliferation of online signed networks, and the recent advances in social network analysis, including the problem of link prediction in particular, naturally led researchers to the problem of predicting the sign of a link in signed networks[3, 6]. We follow this line of work and consider the problem of predicting signs in a signed network. Our proposed meth-ods for the problem are motivated by the general theory of social balance [1]. We build on the work of Leskovec et al.[6], driven by the realization that higher order cycles in a signed graph yield a  X  X easure of imbalance X  suggested by the gen-eral theory of social balance. We show how these measures can be successfully exploited for sign prediction. We also go beyond these simple measures of imbalance and propose a supervised machine learning approach that achieves state-of-the-art performance on datasets drawn from sources as diverse as Epinions, Slashdot and Wikipedia. Our largest network has more than 100k nodes and 800k edges. Our main contributions can be summarized as follows. First, we show how any quantitative measure of imbalance in a network can be used to derive a link prediction algorithm. We discuss different measures of imbalance that are derived from social balance theory and signed graph theory. In par-ticular, we show that the Katz measure on a signed graph is quite naturally connected to a measure of imbalance. Sec-ond, we show that using measures of imbalance that depend on higher order cycles can improve the quality of sign pre-diction. The effect is more pronounced in the case of edges with zero embeddedness . The nodes of such edges, by defi-nition, do not share any common neighbors. Third, our su-pervised learning approach to sign prediction uses features derived from longer cycles and achieves state-of-the-art per-formance. In particular, our method has smaller false pos-itive rate , compared to the methods in [6]. Moreover, the performance improvement is co nsistent across diverse net-works (in the sense of formation and composition of signed edges) such as Epinions, Slashdot and Wikipedia.

Our experiments with real-world networks show that not all relationships formed in a social network conform to the intuitions underlying social balance theory. Indeed, we find that real-world networks are too complex to be described by a simple formalism. Given the complexity of these net-works, longer cycles seem to contain in them more useful information for predicting signs of links.
Signed networks have received attention in the last decade in the context of clustering and link prediction. The problem of predicting edge signs in a social network was first consid-ered by Guha et al.[3], albeit in a slightly different setting. They develop a trust propagation framework to predict the trust (or distrust) between pairs of nodes. First, a combined matrix is derived from the adjacency matrix which captures all one-step propagations (corresponding to cases k =2and k =3inour k -cycle method). The propagated trusts and distrusts are then computed as a linear combination of pow-ers of the combined matrix. They apply variants of their method on the Epinions network and find that higher iter-ations of propagation tend to have a beneficial effect on the accuracy of prediction.

Kunegis et al.[5] study the spectral properties of signed networks and use kernels derived from a signed variant of the graph Laplacian for link prediction. They also consider power sum of the adjacency matrix (up to degree 4) for link prediction. However, they do not propose any supervised learning approach that learns the coefficients in their models.
Leskovec et al.[6] first considered an explicit formulation of the sign prediction problem. Their prediction methods are based on the theory of social balance and status[7]. The idea is that the sign of an edge ( i, j ) should minimize the number of unbalanced triangles involving the edge ( i, j ), i.e. triangles with an odd number of negative edges (see Section 4). They also propose a supervised machine-learning formulation of the problem, and show that the features derived from dif-ferent types of triangles, combined with first-order features of a node like the number of incoming positive edges, make better predictors of the edge sign. The prediction model is also shown to generalize fairly well across different online so-cial networks. Their model, however, does not look beyond such local structures as triangles. These local features lead to impressive accuracies in the networks that they consider. Nevertheless, it is natural to ask if the acccuracy can be further boosted by considering higher order features.
For us, a graph will mean a signed graph unless other-wise stated. This formally means that G =( V, E,  X ) where V = { 1 , 2 ,..., | V |} is a finite set of nodes or vertices of the graph. The set E consists of edges of the form { i, j } or ( for i, j  X  V , depending on whether the graph is undirected or directed (we assume there are no self-loops). The third com-ponent of a graph is a mapping  X  : E  X  X  +1 ,  X  1 } giving a sign to each edge. We will assume that our graphs are con-nected (weakly connected if directed). We will use the terms  X  X etwork X  and  X  X raph X  interchangeably. An undirected graph has an associated adjacency matrix A  X  X  X  1 , 0 , +1 } | V | X | V | For undirected graphs, A is symmetric, i.e. A = A T , while for directed graphs it will not be symmetric in general. It will also be convenient to define the positive part A + and negative part A  X  as: A + := max( A, 0), A  X  := min( A, 0) where max/min are applied entry-wise. With these defini-tions, we have A = A + + A  X  .

A path (of length or order k ) in an undirected graph is a sequence i 1 ,i 2 ,...,i k +1 of vertices such that { i an edge for 1  X  j  X  k .A simple path is a path with no repeated vertices. A cycle is a path with i 1 = i k +1 .A simple cycle is a cycle with no repeated vertices (except the first one). Similar definitions yield paths, simple paths, cycle and simple cycles in directed graphs. Denote the set of all order k cycles and simple cycles of a graph G by C k ( G )and SC k ( G ) respectively. The indicator 1 [ P ] is 1 if predicate is true and 0 otherwise. We let power take precedence over subscript, i.e. A k i,j denotes ( A k ) i,j .
We adopt the framework [3, 6] of predicting the sign of a single edge that has been suppressed, using the rest of the network. Formally, given a graph G =( V, E,  X ), and atestedge e test  X  E ,wewanttopredict X ( e test ), using only the edges in E  X  X  e test } . When using a supervised machine learning approach it is convenient to think of { e  X  E  X  X  e test } : X ( e )=+1 } and { e  X  E  X  X  e test } : X ( e )= as the set of positive and negative examples respectively.
We briefly review the rudiments of the theory of social bal-ance. This theory rests on the premise that certain config-urations of positive ( X  X s a friend of X  or  X  X rusts X ) and negative ( X  X s an enemy of X  or  X  X istrusts X ) edges between individuals are socially more plausible than others. A more detailed treatment can be found in [2, Chapter 5]. For example, in the case of three individuals a , b and c , the left two config-urations below are more likely than the right two: a + on the basis of sayings such as  X  X  friend of a friend is a friend X  and  X  X n enemy of an enemy is a friend X . Accordingly, the first two triangles are called balanced while the latter two are said to be unbalanced . Formally, a complete undirected signed graph is called balanced iff all triangles in it are balanced. Of course, real world networks are not complete by any means. Hence, the notion of balance can be extended by using the idea of filling in missing entrie s. An undirected signed graph is called balanced iff it is possible to add signed edges to make it a balanced and complete graph. It turns out that this  X  X ocal X  definition based on looking at triangles only is equivalent to a  X  X lobal X  definition where we say that a graph is balanced if and only if its vertices can be divided into two mutually exclusive and exhaustive sets X and Y (with one of them possibly empty) such that all edges within X and within Y are positive while all edges with one end in X and the other in Y are negative.

The following theorem relates balance to the existence of simple cycles with an odd number of negative edges.
Theorem 1. ([4, 1]) A signed graph is balanced iff there are no simple cycles with odd number of negative edges. Motivated by this theorem, we call a cycle (simple or oth-erwise) balanced if it has an even number of negative edges and unbalanced otherwise.
The main idea developed in this section is that any quan-titative measure of social imbalance in a graph can be used to design a link prediction algorithm. The sign prediction for a given edge is the one that minimizes the social imbal-ance in the resulting graph (once the signed edge has been added to the network).

In a complete graph, perfect balance, by definition, implies the absence of any unbalanced triangles. This motivates a simple measure of imbalance, namely the total number of unbalanced triangles in a graph. Thus, we define, A definition essentially similar to the one above appears in the recent work of van de Rijt [10, p. 103] who observes that the equivalence between  X  tri ( G )=0and G being balanced holds only for complete graphs.

For an incomplete graph, imbalance might manifest itself only if we look at longer simple cycles. Accordingly, we define a higher-order analogue of (1), where k  X  3and  X  i  X  X  are coefficients weighting the rela-tive contributions of unbalanced simple cycles of different lengths. If we choose a decaying choice of  X  i , like  X  i for some  X   X  (0 , 1), then we can even define an infinite-order version  X  s  X  ( G ) by setting k =  X  above. It is clear that  X   X  (  X  ) is a genuine measure of imbalance in the sense formalized by the following theorem which follows directly from Theorem 1).

Theorem 2. Fix a (possibly incomplete) graph G .Let  X  i &gt; 0 be any sequence such that  X  s  X  ( G ) is well-defined. Then,  X   X  ( G ) &gt; 0 iff G is unbalanced.

This suggests that we could use  X   X  (  X  )asameasureof imbalance to derive link prediction algorithms. However, enumerating simple cycles of a graph is a hard problem. In particular, if we could count simple cycles of length n in agraphwith n vertices in polynomial time, we would solve the NP-complete Hamiltonian cycle problem. To get around this computational issue, we slightly change the definition of  X  (  X  ) to the following. As before, we allow k =  X  provided the  X  i  X  X  decay suffi-ciently rapidly. The only difference between these definitions and the previous one is that here we sum over all cycles, not just simple ones. However, we still get a valid notion of im-balance as stated by the following result (proof will be given in a longer version of the paper).

Theorem 3. Fix a (possibly incomplete) graph G .Let  X  i &gt; 0 be any sequence such that  X   X  ( G ) is well-defined. Then,  X   X  ( G ) &gt; 0 iff G is unbalanced.

The basic idea of using a measure of imbalance for pre-dicting the sign of a given query link i, j , such that i { i, j } X  E is as follows. Given a graph G and query { i, j } i, j  X  V, i = j , we construct two graphs: G +( i,j ) and These are obtained from G by augmenting its edge-set with { i, j } and attaching a +1 and  X  1 sign to it respectively. Given a measure of imbalance,  X  (  X  ), the predicted sign of { i, j } is then simply:
Note that, to be able to this quickly, we should use a  X  ( for which the quantity (4) is efficiently computable. We now consider the measures mentioned in the previous subsection to ensure that this is indeed the case for them.

Somewhat surprisingly, for  X  (  X  )=  X  3 (  X  ), the prediction (4) simply amounts to computing the ( i, j ) entry in the matrix A 2 where A is the (signed) adjacency matrix of G .Infact, a more general result is true (proof will be given in a longer version of the paper).

Theorem 4. Let G =( V, E,  X ) be an undirected signed graph and let i = j be such that { i, j } /  X  E .Let G +( i,j ) G  X  ( i,j ) be the augmented graphs as defined above. Then, for any k  X  2 , where A  X  X  X  1 , 0 , +1 } | V | X | V | is the adjacency matrix of
Using Theorem 4, it is easy to see that sign and that the above is true even for k =  X  .Inthespe-cial case  X  k =  X  k  X  1 with  X &lt; 1 / A 2 ,wecansumthe above infinite series to get the Katz prediction rule for edge sign prediction: sign been successfully used as a link prediction method for un-signed networks [8] but here we see it reappearing for link prediction in signed networks from a social balance point of view. We find this connection between Katz and social bal-ance intriguing and believe, to the best of our knowledge, that it has not been made before.
The methods derived from the measures of imbalance in the previous section rely on social balance theory for link prediction in signed networks. However, real world networks may not conform to the prediction of social balance theory or may do so only to a certain extent. To deal with this sit-uation, we use measures such as Katz to derive features that can then be fed to a supervised machine learning algorithm along with the signs of the known edges in the network. We draw upon research in unsigned link prediction where the Katz measure has been empirically demonstrated to produce competitive results [8]. However, recent research [9] shows that learning the weights  X  i based on supervised machine learning approaches tends to increase link prediction accu-racy. It is thus natural to expect that the relative weights for cycles of various lengths may be better estimated by taking into account the evidence in the training data corresponding to the given network .

We pose the problem of predicting the sign of an observed link as a standard (binary) classification problem in machine learning, using positive and negative examples. Our training set consists of pairs ( e,  X ( e )) where e ranges over edges whose signs are given to us and  X ( e ) X  X  are the given signs. Given the dataset, we wish to learn a classifier that can predict the sign of a given test edge e test that was not part of the training set.

We now extend the supervised learning approach of [6] by introducing features derived from longer cycles .Inthe process, we obtain supervised variants of the cycle-based sign prediction methods introduced in the previous section.
Let us now describe the features of a directed edge e = ( i, j ). Note that, unlike methods presented in Section 4, we here consider directed signed networks. Social balance theory has mostly been concerned with undirected network and hence the methods in Section 4 deal with undirected networks only. Here, we are weakening our reliance on so-cial balance theory and can therefore naturally deal with directed graphs as well.

To motivate our longer cycle based features, let us first recall the feature construction used in Leskovec et al [6]. Fix an edge e =( i, j ). Consider an arbitary common neighbor (in an undirected sense) k of i and j . The link between i k can be in 4 possible configurations: i +  X  k , i +  X  ki  X  or i  X   X  k . Similarly, there are 4 possible configurations for the link between k and j . Thus, we can get a total of 16 features for the edge e by considering the number of common neighbors k in each of the 4  X  4 = 16 configurations.
This corresponds to a supervised variant of k -cycle method for k = 3. In terms of matrix powers, these sixteen fea-tures are nothing but the ( i, j ) entry in the sixteen matrices: ( cism against using only these triangle-based features is that there could be many people in the social network who do not share friends. In fact, this is the case in most of the net-No. of nodes 131 , 828 82 , 144 7 , 065 No. of edges 840 , 799 549 , 202 103 , 561 Fraction of + edges 0 . 8529 0 . 7740 0 . 7884 Fraction of  X  edges 0 . 1471 0 . 2260 0 . 2116
Normalized MOI-3 0 . 0950 0 . 1335 0 . 2165 works that are used in [6]. The reason their method is able to predict well on such pairs is that they additionally use 7  X  X egree-type X  features like in-degree and out-degree (and their signed variants). Thus, the prediction for edge with zero emdeddedness (embeddedness refers to the number of common neighbors of the vertices of an edge) relies com-pletely on such degree based features. These degree features tend to introduce a bias in learning. For example, a node that is predisposed to make positive relationships, biases the classifier to predict positive relationships.

This criticism thus necessitates incorporating features from higher-order cycles. Generalizing the construction for k =3 case, for the edge ( i, j ), the features can be obtained as the ( i, j )entriesinthe4 k  X  1 matrices with b i  X  X  X } ,t i  X  X  T, 1 } .

Note that the number of features is exponential in k ,and therefore it is not feasible to ob tain features from arbitrarily long cycles. We use supervised higher order cycle (HOC) methods for k  X  5intheexperiments.

The number of features can quickly become unmanage-able, and computationally infeasible, as soon as k is beyond 5. While dimensionality of the feature space may be the pri-mary concern, the combinatorial nature of the features also raises the following intuitive concern: the interpretability of features rendered by high-order cycles, say when k =6, composed of different signs and directions, is a challenge. For example, it is intuitively hard to appreciate the differ-ence between two walks i +  X  k 1 +  X  k 2  X   X  k 3 +  X  k 4 + i
With this realization, one way to reduce the number of features yet retain the information in longer cycles, is to consider the underlying undirected graph, ignoring the di-rections. In particular, the k th order features will be from are considering the undirected graph, we ensure that the fea-tures are symmetric by summing features of the form A b 1 and A b 2 A b 1 .Thusthenumberof k -th order features to com-pute is reduced to O (2 k )from O (4 k ). Though the number of features is still exponential in k , the construction of features becomes much easier for small values of k .

We use a simple logistic regression where the imbalance of an edge is modeled as a linear combination of the fea-tures, which are imbalances in cycles of various lengths and characteristics themselves. Let  X  : V  X  V  X  R p denote the feature map. We have, P ( X ( u, v )=+1)=1 / (1 + exp is given by sign( w,  X ( u, v ) ).
We consider three online social networks  X  Epinions, Slash-dot and Wikipedia[6] (downloaded from snap.stanford. edu ). All the networks have explicit sign labels on the links. Refer to Table 1 for the statistics of the networks. Note that MOI-3 is normalized by the total number of triangles. Refer to [6] for description of the networks. We have 2 families of methods: one based on measures of imbalance (MOI) from Section 4 and the other based on the supervised machine learning approach involving higher order cycles (HOC) de-scribed in Section 5. Both families depend on a parameter k  X  3 that denotes the order of the cycles that the method is based on. For MOI, we consider k up to 10 and for HOC we consider k =3 , 4 , 5. Note that the set of features used by HOC-( k + 1) is a strict superset of the features used by HOC-k . We also remind the reader that MOI-3 and HOC-3 are the methods considered in [6].

We evaluate and compare MOI methods using a leave-one-out type methodology: each edge in the network is suc-cessively removed and the method tries to predict the sign of that edge using the rest of the network. For HOC meth-ods, we resort to 10 -fold cross-validation . We (randomly) created 10 disjoint test folds each consisting of 10% of the total number of edges in the network. For each test fold, the remaining 90% of the edges serve as the training set. For a given test fold, the feature extraction and logistic model training happens on a graph with the test edges removed. We report accuracies and false-positive rates by averaging them over the 10 folds.
Our experiments on the three online social networks show that higher order cycles benefit the accuracy of sign pre-diction and lower the false positive rate. Furthermore, the results are consistent across th e three diverse networks. Fig-ure 2 shows the accuracy of MOI based methods. Note that the accuracy is shown for edges with embeddedness under certain threshold. Firstly, we see that accuracy is non-decreasing in embeddedness threshold. Next, it is clear that higher-order methods perform significantly better than MOI-3 (triangles) method. Finally, the performance boost is large for edges with low embeddedness. This is expected as edges of low embeddedness by definition do not have many common neighbors for their end-points, and higher-order cy-cles have relatively better information for such edges than others. We also observe from our experiments that beyond k = 5, the performance gain is not very significant.
Figure 1 shows the distribution of edge embeddedness in the data sets. Observe that a significant fraction of the edges have low embeddedness in all the networks. Thus, for a good fraction of edges, we observe a large increase in accuracy of higher-order MOI based methods, in all the data sets.
The results for the supervised HOC methods are shown in Tables 2 &amp; 3 and Figure 3. In all the data sets, there is a small improvement in accuracy by using higher order cycles (HOC-5), as shown in Table 2. The false positive rate, however, reveals a more interesting phenomenon in Table 3. Indeed, higher order methods (such as HOC-5) significantly reduce the false positive rate as compared to that of HOC-3. However Figure 3 shows that, unlike MOI based methods, edge embeddedness does not seem to affect the decrease in false positive rate for HOC methods. We see this trend across all the data sets.
We see that longer cycles significantly benefit sign pre-diction, and do so consistently across many real-world net-works. We presented a framework to obtain a link predic-tion algorithm, using any quantitative measure of imbalance. Higher order cycles came as a natural generalization of lo-cal triangles, and furthermore, the generalization is well-founded by the general theory of social balance. Finally, we observe that the edges appearing in real-world signed networks do not necessarily conform to the intuitions un-derlying the social balance theory, and longer cycles contain more useful information for predicting edge signs.
This research was supported by NSF grant CCF-0916309 and DOD Army grant W911NF-10-1-0529. [1] D. Cartwright and F. Hara ry. Structure balance: A [2] D. Easley and J. Kleinberg. Networks, Crowds, and [3] R.Guha,R.Kumar,P.Raghavan,andA.Tomkins.
 [4] F. Harary. On the notion of balance of a signed graph. [5] J. Kunegis, S. Schmidt, A. Lommatzsch, J. Lerner, [6] J. Leskovec, D. Huttenlocher, and J. Kleinberg. [7] J. Leskovec, D. Huttenlocher, and J. Kleinberg. Signed [8] D. Liben-Nowell and J. Kleinberg. The link-prediction [9] Z. Lu, B. Savas, W. Tang, and I. S. Dhillon. [10] A. van de Rijt. The micro-macro link for the theory of with embeddedness no more than T for various thresholds T Figure 2: Accuracy of Measures of Imbalance (MOI) Based Methods for accuracy of MOI-k methods for edges with embeddedness at least
T for various thresholds T . We see that the difference in Figure 3: False Positive Rates of Higher Order Cycle (HOC) Methods for positive rate of HOC-k methods for edges with embeddedness at least
