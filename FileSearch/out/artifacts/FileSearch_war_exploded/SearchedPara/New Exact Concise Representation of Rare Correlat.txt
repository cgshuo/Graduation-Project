 Recently, rare pattern mining has been proved to be of actual added value in many appli-cation fields such as the intrusion detection, the analysis of criminal data, the pharma-of rare patterns is hampered by the high number and the low quality of the extracted rare patterns. Thus, an extracted rare pattern may not represent any useful information whenever it is composed only by items among which there is no semantic link. In this situation, integrating correlation measures would be of benefit by only mining Rare cor-related patterns . These latter patterns offer a strong semantic link among their items. Indeed, an interesting rare p attern is that which appears a very small number of times in the database but has items that are strongly linked w.r.t. a correlation metric.
In this paper, we focus on the extraction of an exact concise representation of rare support. Indeed, although used in many works under various names like extended Jac-card measure , coherence , Tanimoto coefficient , the link between the expression of this measure and the disjunctive support in the denominator part has never been established in the literature. Our choice of this measure is motivated by the theoretical framework that any measure of quality dedicated to rare association rule should have. Moreover, the authors in [12] proposed a generic approach for correlated patterns mining based on the bond measure. Note, however, that the study of rare correlated patterns was not previously carried out in the literature.

From the computational point of view, the integration of the bond measure within the associated to the bond measure verify an anti-monotone constraint and then induce an of rare correlated patterns result from the intersection of two theories [9] induced by complicated to be mined than any set of patterns induced by one or more constraints of the same nature [4]. We thus provide in this paper a thorough characterization of this are induced by the closure operator associated to the bond measure.

To the best of our knowledge, there is no previous study in the literature that has been dedicated to the extraction of a concise representation of patterns fulfilling both the rarity and the correlation constraints. Worth of mention that the new proposed approach correlation measure which shares the same structural properties as the bond measure, e.g. ,the all-confidence measure [10]. 1
The remainder of the paper is organized as follows: Section 2 presents basic notions terns by studying the associated constraints. We also introduce the associated new exact concise representation. Section 4 is dedicated to the description of the R CPR M INER algorithm allowing the extraction of the proposed representation. The empirical stud-ies are provided in Section 5. Section 6 illustrates the application of our approach in intrusion detection. The conclusion and p erspectives are sketched in Section 7. We start by presenting the key notions related to our work. We first define a dataset. tively, a finite set of transactions and items, and R X  X  X I is a binary relation between  X  X  contains the item i  X  X  .
 In this work, we are mainly interested in itemsets as a class of patterns. The two main kinds of support a pattern can have are defined as follows, for any non-empty pattern I : -Conjunctive support : Supp (  X  I )= |{ t  X  X  | (  X  i  X  I, ( t, i )  X  X  ) }| -Disjunctive support : Supp (  X  I )= |{ t  X  X  | (  X  i  X  I, ( t, i )  X  X  ) }| Example 1. Let us consider the dataset given by Table 1. We have Supp (  X  AD )= |{ 1 }| = 1 and Supp (  X  AD )= |{ 1, 3, 5 }| = 3 . 2 We distinguish, given a minimum support threshold [1], between frequent and rare patterns. These latter patterns are defined as follows.
 Definition 2. ( Rare patterns ) The set of rare patterns is defined by: RP = { I  X  X | Supp (  X  I ) &lt; minsupp } .
 Among the elements of RP , we distinguish the smallest rare patterns according to set-inclusion relation. These patterns constitute the set M in RP defined as follows: Definition 3. ( Minimal rare patterns ) The M in RP set of minimal rare pattern is composed by rare patterns having no rare proper subset. It is equal to: M in RP = { I  X  X P| X  I Example 2. Let us consider the dataset given by Table 1 for minsupp =4.Wehave,for example, the pattern BC  X  X P since Supp (  X  BC )=3 &lt; 4. We also have the pattern BC  X  X  in RP since Supp (  X  BC )=3 &lt; 4 and, on the other hand, Supp (  X  B )= Supp (  X  C )= 4. In this case, M in RP = { A , D , BC , CE } .
 In the following, we define monotone and anti-monotone constraints [4,11]. Definition 4. ( Monotone/Anti-Monotone constraint ) Let Q be a constraint,  X  Q is anti-monotone if  X  I  X  X  ,  X  I  X  Q is monotone if  X  I  X  X  ,  X  I that the frequency constraint induces an order ideal [5].

Definition 6 presents the set of correlated patterns according to the bond measure [10] which is redefined here as given in Definition 5.
 Definition 5. ( The bond measure ) The bond measure of a non-empty pattern I  X  X  is defined as follows: Definition 6. ( Correlated patterns ) Considering a minimum correlation threshold min-
The constraint of correlation is an anti-monotone constraint, i.e. ,  X  I , I 1  X  X  ,if I 1  X 
I ,then bond ( I 1 )  X  bond ( I ). Therefore, the set CP of correlated patterns forms an order ideal [5] on P ( I ).

In the following, we will need the set composed by the maximal correlated patterns Definition 7. ( Maximal correlated patterns ) The set of maximal correlated patterns, denoted M ax CP , is composed by correlated patterns having no correlated proper su-perset, i.e., M ax CP = { I  X  X P| X  I 1  X  I : I 1 /  X  X P} .
 Example 3. Consider the dataset illustrated by Table 1. For minbond =0.2,wehave bond ( BCE )= M ax CP = { ACD , ABCE } .
 Now we focus on the closure operator associated to the bond measure.
 bond ( I  X  X  i } ) } .
 items containing I and sharing the same bond value with I . It can be easily proven that f f . Indeed, according to the framework proposed in [13], bond measure is a condens-able function based on both preserving functions, namely the conjunctive support and the disjunctive support.
 Example 4. Consider the dataset illustrated by Table 1. For minbond =0.2,wehave f bond ( AB )= ABCE since C and E preserve the bond value of AB .
 We focus now on the equivalence classes induced by the f bond closure operator. Definition 9. ( Equivalence class associated to the closure operator f bond ) An equiva-lence class associated to the closure operator f bond is composed by all the patterns disjunctive, and negative supports. Therefore, all the patterns belonging to the same characterize the same set of transactions. I ndeed, each transaction necessarily contains a non-empty subset of each pattern of the class.

In the next section, we will carry out a detailed study of the rare correlated patterns. 3.1 Definition and Properties The set of rare correlated patterns is defined as follows: Definition 10. ( Rare correlated patterns ) Considering the support threshold minsupp RCP , is equal to: RCP = { I  X  X | Supp (  X  I ) &lt; minsupp and bond ( I )  X  minbond } . Example 5. Consider the dataset illustrated by Table 1. For minsupp =4and minbond =0.2,theset RCP consists of the following patterns where each triplet represents the pattern, its conjunctive support value and its bond value: RCP = { ( A ,3, 1, 3, 3 5 2 5 ) } . This set is depicted by Figure 1. The support shown at the top left of each frame represents the conjunctive support. As shown in Figure 1, the rare correlated patterns are then localized below the border shown in red of the anti-monotone constraint of correlation, composed by the elements of M ax CP , and over the border shown in black of the monotone constraint of rarity, composed by the elements of M in RP .
Therefore, the localization of the rare correlated patterns is much more complex than the localization of theories corresponding to constraints of the same nature.
Interestingly enough, the use of bond allows improving the quality of mined patterns by only retaining those containing strongly correlated items. However, the number of these patterns is not necessarily reduced which may hamper its practical use. To loss-lessly reduce such amount of information, we propose to define a new exact concise rep-resentation of the RCP set. An exact representation of rare correlated patterns should correlated one, then this representation must allow faithfully deriving the values of its support and its bond measure. In this respect, the proposed representation in this work of rare correlated patterns. It also allows a better exploitation and management of the it allows to derive, whenever of need, the whole set of rare correlated patterns. notion of equivalence class. Equivalence classes allow us to only keep track of non-redundant patterns. Indeed, we retain for each class only the maximal and the minimal ones. The next subsection details our approach. 3.2 Characterization of the Rare Correlated Equivalence Classes Based on Definition 9, the elements of the same equivalence class have the same behav-frequent. The application of f bond then provides a more selective process to only ex-The smallest, w.r.t. the set-inclusion relation, patterns in a class are the minimal rare Definition 11. ( Closed rare correlated patterns ) The CRCP set of closed rare corre-lated patterns is equal to: CRCP = { I  X  X CP| X  I 1  X  I : bond ( I ) &gt; bond ( I 1 ) } . Definition 12. ( Minimal rare correlated patterns ) The MRCP setofminimalrare Example 6. Consider the dataset D illustrated by Table 1. For minsupp =4and minbond = 0.2, Figure 2 shows the rare correlated equivalence classes. We have, the set CRCP = { A , D , AC , AD , ACD , BCE and ABCE } . Whereas, the set MRCP is equal to: MRCP = and AD are closed and at the same time minimal. Their equivalence classes then contain a unique element.
 Before introducing our new concise representation, it is worth mentioning that the no-tions of closed patterns and minimal generators were also simultaneously used in [8] in order to offer a lossless concise representation of frequent itemsets. Now, based on the two previous sets, we define our new exact concise representation RCPR . 3 Definition 13. ( The RCPR representation ) The RCPR representation is equal to: RCPR = CRCP  X  X RCP .
 Example 7. Consider the dataset illustrated by Table 1 for minsupp =4and minbond = 0.2. According to the previous example, we have the RCPR representation composed by: ( A , 3 , 1 , 1 4 The following theorem proves that the RCPR representation is a lossless concise rep-resentation of the RCP set. In this respect, both sets MRCP and CRCP composing RCPR are required for the exact regeneration of the set RCP . The elements of the former set are indeed required for ensuring the rarity property of an arbitrary pattern. its bond and support values.
 Theorem 1. The RCPR representation is an exact c oncise representation of the RCP set of rare correlated patterns.
 Proof. Let I  X  X  . We distinguish between three different cases: a) If I  X  X CPR ,then I is a rare correlated pattern and we have its support and its bond values in the representation. b) If J  X  X CPR such that J  X  I or Z  X  X CPR such that I  X  Z ,then I/  X  RCP since I does not belong to any rare correlated equivalence class. c) I  X  X CP . Indeed, J and Z exist (otherwise I fulfills the conditions of the case b ). closure of I ,say F . The closed pattern F belongs to RCPR since I is rare correlated and RCPR includes the CRCP set of closed rare correlated patterns. Therefore, F = min  X  { I 1  X  X CPR| I  X  I 1 } .Since f bond preserves the bond value and the conjunctive support, we then have: bond ( I )= bond ( F )and Supp (  X  I )= Supp (  X  F ).  X  Example 8. Consider the RCPR representation illustrated by Example 7. Let us con-sider each case separately. The pattern AD  X  X CPR . Thus, we have its support equal to 1 and its bond value equal to from the RCPR representation, namely BCE and ABCE , BE /  X  X CP since no element of RCPR is included in BE . Consider now the pattern ABC . There are two patterns of RCPR which allow determining that the pattern ABC is a rare correlated one, namely AB and ABCE ,since AB  X  ABC  X  ABCE . The smallest pattern in RCPR which cover ABC , i.e. its closure, is ABCE . Then, bond ( ABC )= bond ( ABCE )= = Supp (  X  ABCE )=2. The proof of Theorem 1 clearly highlights that it is straightforward the way queries over of the proposed representation would be carried out w.r.t. a given arbitrary pattern as well as the derivation of the whole set of rare correlated patterns. It is also important to mention that the RCPR representation is a perfect cover of the RCP set, i.e. ,the size of RCPR never exceeds that of the RCP set whatever the dataset and the used minsupp and minbond values. It is in fact always true that ( CRCP X  X RCP )  X  X CP .
In the following, we introduce the R CPR M INER algorithm dedicated to the extraction of the RCPR representation. The pseudo-code of R CPR M INER is shown by Algorithm 1. R CPR M INER is a levelwise algorithm which takes as an input a dataset D , a minimum support threshold minsupp and a minimum correlation threshold minbond . This algorithm allows the determination of the MRCP and the CRCP sets which constitute the RCPR representation.
 Algorithm 1. R CPR M INER
The R CPR M INER algorithm mainly operates in two steps. The first step consists in extracting the maximal correlated patterns from the extraction context through the in-vocation of the dedicated M AX CP E XTRACTION procedure ( cf. Line 4). The second step consists in integrating the constraint of rarity and the obtained maximal correlated patterns in a mining process of RCPR . In this situation, the set PC and n of poten-tial candidates of size n is obtained using the classical A PRIORI -G EN procedure ( cf. Line 15) from the retained candidates of size ( n -1). Once obtained, the set elements of
PC and C and n . The used pruning strategies are as follows: ( i ) The pruning of the candidates which are included in a maximal correlated frequent pattern. ( ii ) The pruning of the candidates which are not included in a maximal rare correlated pattern. ( iii ) The pruning based on the order ideal of the minimal correlated patterns . fore, every minimal correlated candidate, having a non minimal correlated subset, will be pruned since it will not be a minimal correlated pattern. In this respect, within the MRCP CRCP C OMPUTATION procedure ( cf. Line 13), whose pseudo-code is omitted here for lack of available space, the minimal rare correlated patterns are determined among the retained candidates in C and n ( cf. Line 11). This is done by comparing their bond values to those of their respective immedi ate subsets. Then, minimal rare corre-lated patterns are inserted into the MRCP set. Their closures are after that computed according to the f bond closure operator, and then, inserted in the CRCP set. From the computational point of view, it is important to mention that the localization of the bor-der composed by the maximal correlated patterns is an NP-hard problem [3]. Therefore, this task constitutes the most consuming part, w.r.t. execution time, in R CPR M INER .
The next section experimentally studies the RCPR representation compactness. In this section, our main objective is to show, through extensive experiments, that the RCPR representation provides interesting compactness rates compared to the whole set of rare correlated patterns. All experiments were carried out on a PC equipped with a 2 . 7 GHz Intel Dual Core processor E 5400 and 4 GB of main memory, running the Linux Ubuntu 10.04. The experiments were carried out on different dense and sparse benchmark datasets. 4 Representative results are plot by Figure 3.

According to the obtained experimental results, interesting reduction rates are ob-tained whether minsupp varies or minbond varies. The RCPR representation is indeed proved to be a perfect cover of the RCP set. In fact, the size of RCPR is always smaller than that of RCP set over the entire range of the support and bond thresholds. For ex-ample, considering the dense M USHROOM dataset for minsupp = 35 % and minbond = 0.15 : |RCPR| = 1, 810 , while |RCP| = 100, 156 . In this situation, RCPR offers a reduction reaching approximately 98 % . These results are obtained thanks to the non-equivalence classes , patterns that have the same char acteristics. This process avoids mining redundant patterns. Note that, in this case, |MRCP| = 1, 412 and |CRCP| = 652 . Since the RCPR representation corresponds to the union without redundancy of the MRCP and CRCP ,wealwayshave |RCPR| X |MRCP| + |CRCP| .

We present in the following the application of the proposed representation to the context of intrusion detection. We present in this section, the application of the RCPR representation in the design of an association rules based classifier. In fact, we used the MRCP and the CRCP sets, composing the RCPR representation, within the generation of the generic rare correlated rules of the form Min  X  Closed \ Min , with Min  X  X RCP and Closed  X  X RCP . 5 Then, from the generated set of the generic rules, only the classification part. After that, a dedicated classifier we d esigned is fed with these rules and has to perform the classification process and return s the detection rate for each attack class.
We present hereafter the application of our approach on the KDD 99 dataset. 6.1 Description of the KDD 99 Dataset Each object of the KDD 99 dataset 6 represents a connection in the network data flow partitioned into four Attack classes, which are D OS ,P ROBE , R2L and U2R, and one N
ORMAL class. The KDD 99 dataset contains 4, 940, 190 objects in the learning set and 41 input attributes for each connection. We propose in this work to consider 10 % The learning set contains 79.20 % (respectively, 0.83 % , 19.65 % ,0.22 % and 0.10 % )of D
OS (respectively, P ROBE ,N ORMAL , R2L and U2R). 6.2 Summary of Experimentations and Discussion of Obtained Results Table 2 summarizes the obtained results, where AR and DR, respectively, denote  X  X s-sociation Rule X  and  X  X etection Rate X , 7 while minconf is the minimum threshold of the confidence measure [1]. In addition, by  X  X onstruction step X , we mean that the step associated to the extraction of the RCPR representation while  X  X lassification step X  RCPR and applied for detecting intrusions.
 We note that the highest value of the detection rate is achieved for the classes N OR -MAL and D OS . In fact, this is related to the high number of connections of these two classes. This confirms that our proposed approach presents interesting performances even when applied to voluminous datasets. We also remark that the detection rate varies when compared to th e others classes.

To sum up, according to Table 2, the computa tional cost varies from one attack class much more time-consuming than the classification step. This can be explained by the fact that the extraction of the RCPR concise representation is an NP-hard problem since the localization of the associated two borders is a complex task.

Furthermore, the results shown by Table 3 prove that the proposed rare correlated association rules are more competitive than the decision trees as well as the Bayesian networks [2]. In fact, our approach presents better results for the attack classes D OS , R2L and U2R than these two approaches. For the N ORMAL class, the obtained results using our approach are close to those obtained with the decision trees. The Bayesian networks based approach presents better detection rate only for the P ROBE attack class. tool when applied to the intrusion detection in a computer network.
 We proposed in this paper a characterization of the RCP set of rare correlated patterns and we defined the new exact concise RCPR representation associated with this set. We then designed the R CPR M INER algorithm allowing an efficient extraction of this repre-sentation. The carried out experimental studies highlight interesting compactness rates offered by RCPR . The effectiveness of the proposed classification method, based on detection. Other avenues of future works concern the extraction of generalized associ-In addition, we plan to extend our approach to other correlation measures [6,10,12,14] through classifying them into classes of measures sharing the same properties.
