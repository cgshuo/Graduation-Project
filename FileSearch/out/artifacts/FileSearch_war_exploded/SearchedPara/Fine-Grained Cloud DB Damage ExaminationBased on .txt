 Wi th the rap i dde v e lo pme n t o fc lo ud c o mput in gtech nolo g y, m o re a n dm o re c lo ud database ser vi ces ha v eemergedsuchas A maz on X  s Si mp l e DB [1] a n dRe l a -[ 4 ] etc .D esp i te the great d iff ere n ce in the data m o de l, s y stem arch i tecture a n d h i gh ly sca l ab l e database ser vi ces due t o the u n der lyin gc lo ud c o mput in gp l at -f o rms .T heref o re users are e n t i t l ed t o database ser vi ces wi th o ut the purchase a n dma in te n a n ce o f DBMS s o ft w are .

How e v er , the secur i t y a n dpr iv ac y c on cer n s in these ser vi ces are m o re pr o m i-n e n ttha n e v er bef o re , espec i a lly w he n the databases are cr i t i ca l t o the users . S e v era l rece n tc lo ud c o mput in gp l atf o rm secur i t yin c i de n ts o ccurred in A maz on a n d Mi cr o s o ft rem in d the users that , due t o the v ar i et yo fr i skssuchastheat -tacks fr o m the hackers , the fa il ure o fthec lo ud c o mput in gp l atf o rm , a n de v e n the c lo sed own s o ftheC lo ud S er vi ce P r ovi ders ( C SP s ), the pr o bab ili t yo fdata lo ss a n d damage o fc lo ud DB i squ i te s i g ni fica n t .T heref o re the users sh o u l d no t re ly on the C SP s only t o pr o tect the in tegr i t y a n dretr i e v ab ili t yo fthe i rc lo ud databases .

T he in tegr i t y pr o tect ion pr o b l em o fc lo ud DB i ss i m il ar t o that o ftheOut -s o urced D atabase ( O DB) w h i ch w as o fc on s i derab ly c on cer n t o ma ny researchers . Curre n t ly ma ny O DB v er i ficat ion meth o ds ha v ebee n pr o p o sed w h i ch ha v ea d iff ere n t v er i ficat ion g o a l t o that o fthec lo ud DB. M a ny o fthem [5][6][ 7 ][ 8 ][9] [10][1 2 ][13] are des i g n ed t o supp o rt the O DB users t ov er i f y the c o rrect n ess , c o mp l ete n ess a n dfresh n ess o fthe i rquer i es .T he yonly pr ovi de users wi th the v er i ficat ion resu l tas  X  X  es  X  X  r  X  X o X , w h il ethet y pe o f damages a n dthe i rp o s i t ion s are no tc on cer n ed .So me wo rks [11],[ 7 ] de li cate t o pr ovi de own ers wi th the pr o b -ab ili t y a n a ly s i s o fO DB damages , e i ther b y check in gthe n umber o ffaketup l es in serted in t o the O DB [11] o rb yin sert in gs o me cha ll e n ge quer i es w h o se a n s w ers are a l read y k nown in t o aseque n ce o frea l quer i es [ 7 ]. T he y he l p the user /own er t o u n dersta n dO DB X  s ov era ll damage degree , but st ill ca nno tprec i se ly lo cate them . T he c lo sest wo rk t oo ur g o a li s [1 4 ]w h i ch supp o rts O DB damage i de n t i ficat ion b y embedd in gfrag il e w atermark in t o the O DB. B ut the i rresu l t i sasuperset o ftherea l damages .T heref o re w e wo u l d argue that thus far the fi n e -gra in ed O DB v er i ficat ion d i d no t rece iv e adequate atte n t ion y et , a n d i t i s no te no ugh t oonly detect the e xi ste n ce o f damages o fc lo ud DB s , but m o re i mp o rta n t ly, the user sh o u l dbeab l et olo cate damages , such as i de n t i f yin gthe lo st tup l es , damaged on es a n dsuper fl u o us on es etc ,w h i ch ca n after w ards in d i cate the c lo ud DB rec ov er y. Fi g 1 sh ow s on esuchsce n ar io.

To address th i spr o b l em ,in th i spaper w epr ovi de fi n e -gra in ed c lo ud DB dam -damages .Ino ur o p inion, t o be effic i e n t , the v er i ficat ion pr o cess sh o u l dbeper -f o rmed b yi ts own er in stead o feachuser .A s Fi g 1 sh ow s ,o ccas ion a lly the users se n dsamp lin gquer i es t o the C SP w h i ch c ov ers a part o fthe DB, a n dbased on the retur n ed resu l ts a n dthe v er i ficat ion o b j ects st o red in the user  X  ss i de , the users ca n prec i se ly i de n t i f y the lo st tup l es , super fl u o us tup l es a n d the damaged Mo re ov er , s in ce the samp lin gquer i es are c o mm on S Q L c o mma n ds w h i ch i s in-d i st in gu i shab l efr o mthec o mm on user quer i es , the damage e x am in at ion pr o cess t o d iff ere n tusers .

T he rest o f the paper i s arra n ged as f ollow s :S ect ion 2prese n ts the backgr o u n d o fb loo mfi l ter ,S ect ion 3 descr i bes the bas i cmeth o d w h i ch supp o rts the ra n d o m samp lin gquer y a n dprese n ts i ts a n a ly s i s ;S ect ion 4pr ovi des the descr i pt ion a n da n a ly s i s o fthe i mpr ov ed meth o d w h i ch supp o rts the ra n ge samp lin gquer y; T he Bloo m Fil ter [1 7 ]i saspec i a l structure used t o qu i ck ly test w hether on e e l eme n tbe lon gs t o aset .Un der g iv e n err o rrat io, Bloo m Fil ter e n ab l es the great sa vin g in st o rage space at the pr i ce o fsma ll am o u n t o ferr o rs .Sin ce Bloo m Fil ter w as first prese n ted b yB urt on Bloo m in the 7 0 X  s ,i thasbee nwi de ly accepted in the spe llin gcheck in g ,w eb cach in g ,n et wo rk r o ut in ga n d database s y stem . h 1 a n dm .T he Bloo m Fil ter o fset S = { s 1 ,s 2 , ... ,s n } i sa m -b i tb in ar y arra y, w h o se ini t i a lv a l ues are a ll set 0 s .Fo reache l eme n t s set the p o s i t ion in BF hash fu n ct ion s , the nonly the first set wo rks , the l atter o perat ion has no e ff ect at a ll. To determ in e i fe l eme n t s be lon gs t o set S ,j ust app li es i t wi th the l hash fu n ct ion s .I f in the BF a ll the p o s i t ion ssta n db y h i ( s )(1  X  i  X  l ) are set 1, the n i t i sregardedasthemember o f S, o ther wi se the a n s w er i s no.

A fa l se h i t o ccurs w he n a Bloo mfi l ter p o s i t iv e ly c on firms the membersh i p o fa n e l eme n t w h il eth i se l eme n tactua lly d o es no tbe lon gt o th i sset .T he fa l se p o s i t iv erate i s (1  X  e  X  nl m ) l .T heref o re , supp o se there are n members in the set , a n dthema xi mum err o rrate i s  X  , the n the l e n gth o f arra y m sh o u l dbeat l east nlog 2 1  X  . the m ini mum n umber o fhashfu n ct ion i s l = m n ln 2 . B ut c l ear ly b o th the st o rage c o st a n dthe v er i ficat ion requ i reme n t (DBMS) are u n acceptab l et o the own er .In th i s sect ion w epr ovi de the meth o dbased on the b loo mfi l ter ,w h i ch i sst o rage a n d v er i ficat ion effic i e n t .
 Unique Tuple IDs. To i de n t i f y damage prec i se ly, w e assume each tup l e in ab l e T has a n u ni que ID, w h i ch i sc on t in u o us fr o m 1 t oN.Wi th o ut the lo ss o f ge n era li t y, the ID attr i bute i sa l s o me n t ion ed as A 1 .W ema yin tercha n geab ly ID i s regarded as the de l et ion o fthe ol dtup l et o gether wi th a nin sert ion o fthe n e w tup l e .B e low are the ma jo r no tat ion sused in the l ater sect ion s . 3.1 Initialization To supp o rt e l eme n t -l e v e lv er i ficat ion, w eapp ly m BF s ( BF 1 , ... ,BF m )w h i ch are defi n ed as f ollow s :  X  BF 1 rec o rds the set o fhash v a l ues o fa ll tup l es in T w h i ch i sde no ted as :  X  BF i ( 2  X  i  X  m ) rec o rds a ll the e l eme n ts in attr i bute A i ( 2  X  i  X  m ). Note. T he ge n erat ion o fa ll BF sares i m il ar :L et h 1 ,h 2 , ... ,h l be l in d ivi dua l hash fu n ct ion s , BF 1 ,BF 2 , ... ,BF m be m empt y b loo mfi l ters .T he n f o reach BF i (1  X  i  X  m ), in sert a ll members in set WS i in t o BF i as S ect ion 2 descr i bes . set the c o rresp on d in gb i ts in BF i as  X 1 X . W h il e in the tup l e -l e v e lv er i ficat ion, only BF 1 i s n eeded .Fi g2 ill ustrates the ge n erat ion o f4b loo mfi l ters f o r T ab l e TAB ( ID,A 2 ,A 3 ,A 4 ). 3.2 Damage Examination T he damage e x am in at ion pr o cess involv es the f ollowin gsteps : 1. Random Sampling Queries Generation. P repare a set o fsamp lin gquer i es 2 . Random Sampling Query Processing. Fo reachra n d o msamp lin gquer y Q  X  3. Final Results Generation. G iv e n the ab ov ea n s w ers , the t o ta llo st tup l es ,in-3.3 Security Analysis L emma descr i bes the err o rb o u n d o f the bas i cmeth o d .
 Lemma 1. Given the random sampling query set QSET = { Q 1 ,Q 2 , ... ,Q n } which covers table T , The false alarm rate of INCR , LOST ,and SUP are all 0; The hit rate of LOST , SUP ,and INCR are respectively 100% , 100% and P , which values P =1  X  P Err in tuple-level verification and P =1  X  ( P Err ) x in element-level verification. Here P Err =(1  X  e  X  Nl w ) l is the false positive rate of a bloom filter, x is the average number of non-ID attributes which are modified.
 Proof. In the bas i cmeth o d , the ca l cu l at ion o fe x pected a n s w er a n d LOST ( Q ) a n d SUP ( Q ) are a ll in str i ct acc o rda n ce wi th the defi ni t ion, non e o fb loo mfi l ter i s involv ed w h o se fa l se p o s i t iv e rate has no e ff ect t o them , thus f o ra ny quer y Q ,i ts h i trates o f LOST ( Q ) a n d SUP ( Q ) are 100% a n dthefa l se a l arm rates o f LOST ( Q ) a n d SUP ( Q ) are a ll 0. Sin ce QSET c ov ers T , th i sresu l t i sa l s o app li cab l et o that o fthe w h ol equer y set : LOST a n d SUP .
 T he pr o b l em happe n s w he n INCR ( Q )i sge n erated based on the b loo mfi l ters . D ue t o the fa l se p o s i t iv erat io, a nnon-member ma y be regarded as a member o fthe BF, w h i ch in the damage e x am in at ion pr o cess mea n sthata nin c o rrect ficat ion, acc o rd in gt o the defi ni t ion, a nin c o rrect tup l e t ca n be regarded as a c o rrect on e i fa n d only i f Word ( t )i s w r on g ly regarded as the member o f BF 1 , 1  X  P c o rrect e l eme n t t . A i ca n be regarded as a c o rrect on e i fa n d only i f Word ( t )i s w r on g ly regarded as the member o f BF 1 , a n datthesamet i me , f o reachm o d i-fied attr i bute A i that Word ( t, i )i s w r on g ly regarded as the member o f BF i , the y the h i trate o fa ny quer y INCR ( Q )i s P =1  X  ( P Err ) x .Sin ce each quer y has thesameh i trate , the h i trate o ft o ta l tab l e INCR i s the same as that o fa ll samp lin gquer i es . O n epr o b l em o f the bas i cmeth o d i s that the quer y c on d i t ion i s on the ID at -the C SP. In th i s sect ion w epr o p o se a ni mpr ov ed meth o d w h i ch use ra n ge quer i es w h o se c on d i t ion sare on c o mm on attr i butes in stead o f the attr i bute ID. Ra n ge samp lin gquer yi sd i fficu l tt o be d i st in gu i shed fr o mc o mm on user  X  srequests . 4.1 Initialization I ts ini t i a li zat ion pr o cess in c l udes t wo ma jo rsteps . 1. Table Mapping Function Generation. Fo rtab l e T s each s o rtab l e Non-ID attr i bute A i ( 2  X  i  X  m ), the own er e v e nly maps part o f i ts d o ma in in t o a d i screte v a l ue b y amapp in gfu n ct ion MapV alue i : G iv e n the mapp in gfu n ct ion s on a ll attr i butes ,T ab l e T ca n be mapped in t o T M w h o se e l eme n ts sat i sfies that , f o reach 1  X  i  X  N a n d2  X  j  X  m , T M ( i, j )= MapValue i ( T ( i, j )). A ppare n t ly T M has the same schema a n dsca l e wi th T . 2. Bloom Filter Initialization. In add i t ion t o the b loo mfi l ters f o rtab l e T , b loo m fi l ters f o r mapped tab l e T M are bu il ta l s o t o supp o rt the ra n ge quer y. T he pr o cess i s descr i bed as f ollow s :  X  BF 1 i sfi ll ed wi th e l eme n ts in WS 1 : WS 1 = { Word ( t ) | t  X  T } .  X  Each BF i ( 2  X  i  X  m )i sfi ll ed wi th e l eme n ts in WS i w h i ch are defi n ed as :  X  Each BF m  X  1+ i ( 2  X  i  X  m )i sfi ll ed wi th e l eme n ts in WS m  X  1+ i w h i ch are C on s i der in g the pre vio us e x amp l etab l e TAB .S upp o se the M ap V a l ue fu n ct ion s are defi n ed as f ollow s : T he n the BF sarec on structed as the f ollowin gfigure 3 sh ow s .
 4.2 Damage Examination T he damage e x am in at ion pr o cess involv es the f ollowin gsteps : 1. Range Sampling Queries Generation. P repare a set o fsamp lin gquer i es 2 . Range Sampling Query Processing. Fo reachra n d o msamp lin gquer y Q  X  3. Final Results Generation. G iv e n the ab ov ea n s w ers , the t o ta lin c o rrect tu -4.3 Security Analysis T he err o rb o u n d o fthe i mpr ov ed meth o d i s descr i bed b y the f ollowin g L emma . Lemma 2. Given the range sampling query set QSET = { Q 1 ,Q 2 , ... ,Q n } which covers table T , The false alarm rates of INCR , LOST ,and SUP are respective 0, P Err , and 0; All lost and superfluous tuples in T s can be found in LOST ,and SUP , while the hit rate of an incorrect tuple/element INCR is same as in the basic method. Here P Err =(1  X  e  X  Nl w ) l is the false positive rate of a bloom filter. Proof. Unli ke in the bas i cmeth o d ,in the i mpr ov ed meth o dthefa l se a l arm rate o f LOST ( Q )i s no t 0. D ue t o the fa l se p o s i t iv erate o fb loo mfi l ters ,in the step o f  X  E x pected An s w er Ca l cu l at ion X , i t i sp o ss i b l ethat on etup l e ID i s w r on g ly in c l uded in EID ; thus EID = Q o , a n dm o re prec i se ly, EID  X  Q o .A m on ga ll k x as a member in the b loo mfi l ter BF m  X  1+ i w h o se fa l se n egat iv erate i s P Err .
T he c o mputat ion o ftheh i trate o f INCR ( Q )i sratherc o mp l e x due t o the attackers ):(1) t  X  Q , but the at l east on ese l ect ion cr i ter i a attr i bute  X  s v a l ue i s m o d i fied w h i ch causes t d o es no tsat i sfies the se l ect ion cr i ter i a , that i s : t  X  Q s ;( 2 )on the c on trar y, t  X  Q , but t  X  Q s ; a n d (3) b o th t  X  Q a n d t  X  Q s , o f w h ol etab l e INCR i s no tthatc o mp l e x. Sin ce QSET c ov ers T , a ny tup l e in T will be retur n ed in on equer y q : q  X  QSET , the s i tuat ion (1) a n d ( 2 ) will no te ff ect the INCR . O nly s i tuat ion (3) matters .Si m il ar t o that in the bas i c ma y be w r on g ly regarded as c o rrect u n der certa in p o ss i b ili t y P .An df o rthe same reas on that QSET c ov ers T , a ll lo st a n dsuper fl u o us tup l es ca n be f o u n d in LOST a n d SUP . 5.1 Experiment Setup i mp l eme n ted b o th the bas i cmeth o da n dthe i mpr ov ed meth o d , a n d in each W euseas yn thet i c database that c on s i sts o f on etab l e wi th 100, 000 tup l es . T he e x per i me n ttab l ec on ta in s on eu ni que ID attr i bute (A1) a n dse v era l str in g attr i butes w h i ch ra n ges fr o m 50 b y te t o 500 b y tes lon g .To test the err o rrate , me n t o fthee x per i me n t i sthat :w ebu il dthee x per i me n t on a P C o f In te l C o re 2 D u o C PU E84 00 wi th 1 GRam . 5.2 Performance W efirste v a l uate the st o rage c o st o ftheset wo meth o ds .Fi gure 4 sh ow s that the y b o th are lin ear t o the s i ze o fthetab l e ,w h il ethe i mpr ov ed meth o d i sab o ut 7 0% h i gher tha n that o f the bas i cmeth o d .W ea l s o prese n tthes i ze o fthe o r i g in a l tab l ea n d the hashed tab l e (w h i ch i sc o mp o sed o f the hash v a l ues o fthe o r i g in a l tab l e ) as the c o mpar i s on. Fi gure 4 a l s o sh ow s that due t o the character i st i c o f the b loo mfi l ter , b o th meth o ds ca n great ly reduce the st o rage c o st f o rab o ut t wo o rders o fmag ni tude .In th i se x per i me n t w ech oo se the pr o p i t i ate parameters w h i ch has the h i trate o f 99.9 82 %. Un der th i ss i tuat ion, the st o rage c o st o fthe bas i cmeth o da n dthe i mpr ov ed meth o d i s only ab o ut 2 % a n d 3.5% o fthethe o r i g in a l s i ze .In fact the c o mpress ion rat io ca n be h i gher w he n the err o rrate requ i reme n tca n be re l a x ed .
Fi gure 5 ill ustrates the v er i ficat ion t i me c o st o fb o th meth o ds .Fo reach meth o d w emeasuredt wo t y pe o fc o st : the lo ca lv er i ficat ion t i me w h i ch rec o rds the pr o cess in gt i me w he n the quer y resu l t i s rece iv ed at the c li e n t  X  ss i de , a n d the BF preparat ion t i me a n dthec o mmu ni cat ion c o st .A sfigure 5 sh ow s , the i s only s li ght ly h i gher tha n that o f the bas i cmeth o d . 5.3 Error Rate and Parameter Selection T he e xi ste n ce o f BF X  sfa l se p o s i t iv erateresu l ts in that the h i trate o fthe in-c o rrect tup l es i s no t 100%. G iv e n the n umber o ftup l es N , t wo parameters are c lo se ly re l ated t o the h i trate : s i ze o fthe BF w , a n dthe n umber o fhashfu n c -t ion s l .In fact i fthe n umber o fhashfu n ct ion s l i st oo sma ll, there will be a v a l ue o f l i st oo l arge , the n there will be t oo much  X 1 X  s in the BF w h i ch will a l s o cause the in crease o fthefa l se p o s i t iv erate .A cc o rd in gt o the best n umber o f hash fu n ct ion s o f BF[1 7 ], in o ur meth o d l i sch oo se n appr oxi mate ly l = w N ln 2 . Fi g 6 descr i bes the h i trate o f in c o rrect tup l es w h i ch ser v es f o rb o th the bas i c a n d i mpr ov ed meth o df o rthe y ha v ea l m o st the same v a l ue .I t  X  sc l ear that the in stead o f in crease the s i ze o fthe BF, user ca ni mpr ov etheh i trateb y ad o pt in g e l eme n t l e v e lv er i ficat ion. Fo r in sta n ce w he n w/N = 10, the h i trate o fe l eme n t l e v e li s 99.9 82 %w h i ch i s acceptab l e in m o st cases .Fi gure 7 sh ow sthefa l se a l arm rate o fb o th meth o ds .A s w eme n t ion ed in the paper that i t i sa lw a y s 0in the bas i cmeth o d .W h il ef o rthe i mpr ov ed meth o d ,i tsh ow sthat w he n w/N i sh i gher tha n5 the fa l se a l arm rate will be low er tha n 10%. T he fa l se a l arm rate has no re l at ion sh i p wi th the v er i ficat ion gra n u l ar i t y. D ue t o the rap i dde v e lo pme n t o fc lo ud DB ser vi ces , h ow t o pr o tect the in tegr i t y In th i spaper w epr ovi de a n effic i e n tfi n e -gra in ed c lo ud db damage e x am in e meth o dbased on b loo mfi l ter arra y s ,w h i ch ca nlo cate the damage prec i se ly a n d thus be used t o f o r the damage rec ov er y. F uture wo rk in c l udes the supp o rt o f c lo ud DB m o d i ficat ion.

