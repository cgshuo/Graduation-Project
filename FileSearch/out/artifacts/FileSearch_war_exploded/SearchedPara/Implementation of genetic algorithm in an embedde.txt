 1. Introduction
In coherent optical communication systems, polarization match-ing between the transmitted and received signal must be guaranteed. The challenge comes due to instability of the polarization when light propagates along the standard single mode fiber (SSMF) ( Prat et al., 1995 ). There have been many technologies proposed to solve this problem, such as polarization controller ( Noe  X  et al., 1988 ), polariza-tion diversity ( Okoshi, 1985 ), polarization scrambling ( Hodgkinson et al., 1987 ) and polarization switching ( Habbab and Cimini, Jr, 1988 ). Among these techniques, polarization controller (PC) is preferable due to bit rate independ ency and simple receiver config-uration ( Shimizu et al., 1991 ). Optimum performan ce of transmission system requires endless and fast re sponse polarization controller to track polarization variation without any interruption ( Hidayat, 2008 ). In high-speed transmission, even a short time of undesired polariza-tion mismatch may cause loss of data. The first electro-optic endless polarization control uses an analogue electronic feedback loop. The response time of the control loop is about 150 ms ( Heismann &amp; Whalen, 1991 ). Another technology involves an electro-optic polarization transformer with a simple electronic feedback circuit.
Theresponsetimeofthepolariza tion trajectory is about 20 ms, whichisbetterthanthepreviousone( Heismann &amp; Whalen, 1992 ).
For improving control speed, many algorithms have been proposed for polarization controller, which were developed with sophisticated programming and high complexity ( Hidayat, 2008 ).
 ization control system based on genetic algorithm (GA). We use and develop the intelligent algorithm to achieve better perfor-mance with minimum cost. The code construction of the algo-rithm is simple and consumes low size of memory besides providing fast speed. To our knowledge, this is the first report on the implementation of GA with embedded microcontroller to realize automatic polarization control system. 2. Principle of operation control system is depicted in Fig. 1 . An automatic polarization control system is located after the link and before the receiver to recover the polarization state of the launched signal. Two photo-diodes (PD) are used, where PD 1 is used for receiving the signal and
PD 2 for feeding the information to the control system. In this paper the control system works simply based on the aim to minimize the optical power received by PD 2 . The objective is to assure that the received signal with random polarization state is transformed into a highly polarized signal with stable polarization state. The signal going to both PDs is isolated based on the principal state of polarization (PSP) by using a Polarization Beam Splitter (PBS). Minimizing the signal to PD 2 means that all signals are directed at
PD . This means that the received signal is highly polarized and the launched polarization state is recovered.

The control setup for the polarization control system is schematically shown in Fig. 2 . The controller is realized by using a PIC32MX360F512L microcontroller, where the developed algo-rithm is embedded. This microcontroller has an onboard analog-to-digital converter (ADC). One of the ADC pins is connected to
PD , which is used to monitor the power. The control process is started when there is power detected and stopped when the power is suppressed to a minimum value. The control signal that consists of the decision produced by the algorithm is converted to analog signal by using digital-to-analog converters (DACs). The DACs output are fed to the LiNbO 3 polarization controller.
The monitor is used to display the status of the controller where the computer is important to retrieve additional information and changing the operation of the controller. We have developed an automatic polarization control system with an integrated-optical polarization controller in X-cut, Z-propagation LiNbO 3 . The device consists of 8 cascaded integrated polarization transformer stages each of which can be electro-optically adjusted by applying different voltages (positive and negative voltages).

This controller has 24 pins where 8 of them are grounded. The other 16 pins are used for control purposes. According to Heismann &amp; Whalen (1991 , 1992 ) only three stages are sufficient to produce different states of polarization. In this paper, all eight stages are used to achieve fast operation and high accuracy ( Hidayat, 2008 ). The value of finite word length used in our experiment is 16. This value is sufficient for GA to operate for producing different and wide range of voltages in each generation, besides optimizing the parameters to achieve desired fitness value and control speed. Therefore, 16 electrodes are used to recover the original polarization state. By changing the voltage applied to each electrode, which is determined by the control algorithm, the state of polarization is changed. Proper control of the 8 stages by GA allows for fastest endless reset-free polarization control. 3. Genetic algorithm
GA is embedded in a PIC32MX microcontroller, which acts as a brain that determines the whole operation of the system. The operation is based on the natur al selection scheme and can be parameterized for solving optimization problems. GA is evolutionary algorithm that mimics the manner of natural evolution and self-adaption to solve difficult problems ( Greenwood &amp; Tyrrell, 2006 ). GA operates on the chromosomes. In general, chromosomes are any point that is applied to the fitness function. Fitness function is an objective function that needs to be minimized in our case. Each chromosome is assigned a  X  X  X itness score X  X  referring to the quality of the solution offered to any given problem ( Greenwood &amp; Tyrrell, 2006 ). In other words, all possible solutions can be represented as a population, which is an array of chromosomes. The population size depends on the nature of the problem. In this paper, population size is recognized as an 8 16 matrix. The general form of the popula-tion matrix of GA code consists of a minimum number of 20. GA population size can be any even number that is greater than 6 because of crossover operator. In this system, to decrease the response time and number of generation, the two possible values of 12 and 8 are chosen to be evaluated. Finally the population size of 8 is chosen for less time consumption. Sixteen chromosomes in the matrix refer to the number of polarization controller pins. Different operators applied to the GA are the selection methods, crossover and mutation. The selection process creates a new generation from the current generation involving two s teps. It starts with the initial population, which is randomly pr oduced. Selection is applied to the initial population to create an intermediate population. In the intermediate population, chrom osomes which are called parents that contribute to the population at the next generation are chosen. These chromosomes are selected by one of parent selection techni-ques, where children are produced from the parents ( Greenwood &amp; Tyrrell, 2006 ). Children are produced either by making random changes to a single parent (mutation) or by combining the two parents (crossover) to the interme diate population. Both operators are essential to the GA. While cros sover enables the algorithm to extract the best index from different voltages and recombine them into potentially superior children ( Deb et al., 2002 ). Mutation adds to the diversity of a population, and thus increases the chance that the algorithm will generate voltages that control the PC to reduce the intensity detected at PD 2.

The process of going from the current population to the next population constitutes one generation in the implementation of a GA ( Deb et al., 2002 ). In the first generation, the current popula-tion is also the initial population. The new populations are generated to replace the old one. This process is repeated until desired fitness value (minimum intensity at PD 2 ) is detected. In this experiment, the minimum intensity at PD 2 is fixed at 0.05 V. 3.1. Genetic algorithm for polarization control system The structure of complete control algorithm is implemented in Fig. 3 , which attempted to control all interface modules such as ADC and DACs. In the ADC module, the feedback signal (that is the photo-intensity) must be detected by a photo detection circuit and then converted by an analog-to-digital converter (ADC) to the discrete binary representation. The value of photodiode voltages is checked. If it reached 0.05 V, the control stops. The driving signal from the controller must be converted by using a digital-to-analog converter (DAC) so that it can drive the LiNbO 3 polariza-tion controller pins. For faster operation, 8 stages are used where several DACs are required. 4. Estimation of the best GA parameters
The performance is characterized by evaluating the fitness value (intensity) against the number of generations for selection technique and probability of operator (crossover). The control response for different population size in tracking the speed of polarization changes is tested and it is shown that the execution time reduces with lower population size. This is because less execution time is needed for each function. Different values of population size namely 20, 12, and 8 are tested. Population size 8 can track faster for all selection methods. 4.1. Selection methods
Among several selection schemes for genetic algorithm, Roul-ette wheel, Elitism and tournament are chosen. To find the best selection methods, those popular selection methods are run on PIC32 microcontroller. The principal duties of all selection meth-ods are to measure the relative fitness of each chromosome. Small size of 8 results in desirable intensity faster than larger size of 12 and 20. So, in these experiments the population size is fixed to 8 to compare the performance of the three selection techniques with crossover probability and mutation probability of P c and P m  X  0.01, respectively. As shown in Fig. 4 , tournament is recognized as the best solution for fastest execution time where the desired fitness value is detected in the 11th generation. Roulette wheel and Elitism can detect the desired fitness value after 13th and 15th generation, respectively. Tournament selects the voltages with lower fitness value among the different voltages which leads to perform faster than other two techniques. So tournament is chosen as the best selection method. 4.2. Probability
Fig. 5 shows the performance of crossover using tournament selection with population size of 8 at various values of prob-ability. In all experiment P m is constant and equal to 0.01. By using P c  X  0.6, the corresponding generation is 11. This trend is detected in 10th generation for P c  X  0.65. As shown in Fig. 5 ,itis clear that tournament selection with P m  X  0.01, P c  X  0.7 gives much better performance because suitable combination of voltages can be constructed faster. As demonstrated in Fig. 5 ,
P c  X  0.75 cannot perform faster than P c  X  0.7. Hence, other value of more than 0.75 was not tested.
 a few numbers of generations. GA is better than Gradient algorithm because it can rapidly check the solution set. GA does not need gradient information or Look-Up-Table (LUT) to estimates the solutions. So it is more intelligent than gradient. Gradient optimiza-tion methods can rapidly converge to an optimum solution. How-ever, the solution often stuck at local optimum. The local optimum may be far from the global optimum and depends on the user input starting point. GA is effective at finding global solutions ( Schmitt, 2001 ) and made our polarization control system intelligent as compared to the competing solutions. As a result, GA makes polarization control system to be intelligent enough to control polarization changes in m srange. 5. Response time parameters, which is executed by using MPLAB, can be explained using Table 1 . In our case, the algorithm can automatically transform the polarization until the feedback signal reaches its minimum point in 17 m s and 300 m s in the best and the worst case, respectively. For the best case, the target intensity is achieved when algorithm detects the first intensity value. While for the worst case, the minimum intensity is achieved after the maximum of 9 generation. As reported in Heismann &amp; Whalen (1991 , 1992 ), the control speed of the reported systems were 150 and 20 ms, respectively. While Table 1 certifies that, the system that uses GA performs faster than the systems reported in
Heismann &amp; Whalen, (1992 ). The response time of DAC control and tournament with P c  X  0.7, P m  X  0.01 for one successful control loop is 120 m s. 6. Experimental setup for polarization control system
The complete experimental setup for polarization control system is shown in Fig. 6 . A polarization beam splitter isolates the two orthogonal polarization states. The photodiode with 36 MHz speed returns the intensity in the desired output polar-ization state. The PIC32MX microcontroller is clocked at 72 MHz. The controller measures the intensity to infer the GA. If the desired fitness value is not reached, the genetic algorithm is started and stopped when the intensity of PD is suppressed to a minimum value. In each generation, 16 voltages are transformed and evaluated, while desired fitness value is checked. The control algorithm is capable to execute maximum of 100 generation to provide 16 suitable voltages, which are sufficient to produce minimum intensity in the photodiode in 300 m s. When the controller voltages are set so that the feedback signal is mini-mized, maximum intensity with stabilized polarization is avail-able at the output. 7. Comparison against earlier solutions
Now, we will discuss in details on the comparison between earlier methods to our solution. For this purposes, the properties of different methods are listed in Table 2 . In previous studies, LiNbO 3 polarization controller was used with different number of stages and voltages ranges. The table shows that Heismann developed an electro-optic endless polarization control system with analogue and simple electronic feedback circuit which were stabilized in around 150 and 20 ms, respectively in 1991 and 1992 ( Heismann &amp; Whalen, 1991 , 1992 ). For communication network applications such as PMD compensators ( Noe et al., 1999 ) and polarization division multiplex, the speed requirement should be high to track rapid polarization changes without any interruption ( Brackett, 2007 ). Hence, it leads towards the realization of polarization control system with very fast response time. Field Programmable Gate Array (FPGA) with Gradient search algorithms were also employed as reported in Hidayat et al. (2008) , Koch et al. (2008a , 2008b) , Noe  X  et al. (2009 ). Gradient search algorithm derives the control voltages and seeks for a global intensity minimum point. The performance comes at the cost of sophisticated programming, complex algorithm and high development cost. In this algorithm, the calibration data were entered in LUT for fast access ( Hidayat, 2008 ). Different version of tracking speed namely 7, 3.5, 2 and 1.8 m s is achieved. The fastest version of the FPGA implementation with only 1.8 m s iteration time was able to track up to 38 krad/s polarization changes ( Noe  X  et al., 2009 ). The implementation of PIC32MX microcontroller (our results) allows for more economic control module. The control speed of our system is several times faster than the fairly slow polarization control system as reported in Heismann &amp; Whalen (1991 , 1992 ). In our study, control algorithm is able to stabilize the polarization changes within 300 m s. Even though our speed is relatively slow in comparison to the value achieved in Hidayat et al. (2008 ), Koch et al. (2008a , 2008b ), Noe  X  et al. (2009 ), but it offers more economic, more intelligent and less compli-cated alternative without the needs to rely on LUT. 8. Experimental result
Fig. 7 shows the intensity achieved for 5 times execution with the best parameter. GA is run on in the experimental setup shown in Fig. 6 . GA executes when the intensity is below 0.05 V. The number of generation shows the time required for GA to tracks the polarization state. The numbers of generation for these 5 times execution are 8, 9, 9, 10, and 11, respectively, where the intensity below is 0.05 V. 9. Conclusion
The implementation of GA to realize an intelligent adaptive endless polarization control system with embedded low cost PIC32MX Microcontroller is demonstrated. The controller is able to stabilize the polarization changes in 17 and 300 m s in the best and the worst case by using GA, respectively. It is believed that the system performance can be further improved by enhancing both the algorithm and hardware. In contrast to FPGA-based polarization control system with Gradient Search algorithms, our system results in more natural and intelligent endless polarization tracking without utilizing LUT. This system showed acceptable performance with reduced complexity, lower cost and flexible algorithm. This finding may lead towards more natural automation process and give huge impact to the industry. References
