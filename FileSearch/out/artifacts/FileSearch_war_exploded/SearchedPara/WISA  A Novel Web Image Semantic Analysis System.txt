 We present a novel Web Image Semantic Analysis (WISA) system, which explores the problem of adaptively modeling the distributions of the semantic labels of the web image on its surrounding text. To deal with this problem, we employ a new piecewise penalty weighted regression model to learn the weights of the contributions of the different parts of the surrounding text to the semantic labels of images. Experi-mental results on a real web image data set show that it can improve the performance of web image semantic annotation significantly.
 I.4.9 [ Image Processing and Computer Vision ]: Ap-plications; H.3.1 [ Information Storage and Rtreial ]: Content Analysis and Indexing Algorithms,Experimentation, Performance Web multimedia management, image semantic annotation, regression model
Web image semantic annotation has attracted many re-search interests due to its great potential for improving the keyword based web image searching and browsing. Different from the general Automatic Image Annotation(AIA)[5], ex-ploiting the corresponding surrounding text is the key point to infer the semantic content of web image, which had been studied extensively in many previous web AIA work. The  X  This work was partially supported by the NSF of China Grant no.60403018 and no.60773077, 973-Plan Grant no.2005CB321905  X  Corresponding author Name: Caption: Te x t :
Vacation Rentals Alt: Title:
Sparkling Vacation Rentals Figure 1: Two web images and the keywords distri-butions surrounding text had been utilized to support web image searching in practice, such as the web image search engine of google and yahoo. Usually, the surrounding text of web image is defined as a set of textual data which locates in the page tile, image file name, ALT-tag and other html layout positions. However, most of the previous web image annota-tion and searching approaches either regard the surrounding text as a whole, or set fixed weights to the different parts of the textual data according to some prior knowledge or vari-ous heuristic ideas [1, 2, 3, 4]. It observed that the correla-tions between the semantic labels of image and the different parts of the surrounding text change variously. Fig.1 shows an example, and in this figure we can observe that the se-mantic distributions of the same word  X  X cean X  in two images are different, and in the same image, different words, such as  X  X each X  and  X  X cean X , also have different distributions.
In this paper we explore the problem of adaptively mod-eling the distributions of the semantic labels of web image on its surrounding text by WISA  X  a web image semantic analysis system. Specifically, we employ a new piecewise penalty weighted regression model to learn the weights of the different parts of the surrounding text contributed to the semantic of web images.
The WISA system is consisted of two major components: web data processing and web image semantic analysis.
As an experimental system, we obtain the web pages and images by using existing search engines. More specific, we issue the query keywords to Yahoo, and get a collection of result web pages, which is denoted as web page set P .We use a  X  X ightweight X  tool HTML Parser to parse html docu-ment, and then extract the textual contents and images by traversing through the DOM tree. According to the posi-tion of the text located, we classify the different parts of the surrounding text into 5 categories: (1) image file name; (2) alternate text (ALT X  X ag); (3) caption text (Heading X  X ag); (4) ordinary surrounding text; (5) page title. They are de-noted as T 1 ,T 2 ,...,T 5 respectively.
After web data processing, set P is partitioned into two training subset L and text subset U . For the training set L , the correlations between the semantic keywords and the images are already manually labeled. Then based on the training set L , we employ image semantic analysis technique to learn the semantic labels of images of U from their cor-responding surrounding text. In particular, a linear model is utilized to predict the probability of the semantic con-cept w being the semantic label of image I .Thesemantic generation function P ( w, I ) which measures the degree of the correlation between keyword w and image I is given as follows: where N is the number of the original and extended parts of the surrounding text. The correlation Cor ( w, h j ( T )) be-tween semantic keyword w and the j th textual feature h j can be estimated by multi-nominal distribution estimation[5].
We extend the position structure of the surrounding text to further explore the relationship between image semantic labels and the corresponding text located in different sur-rounding positions. That is, we consider the higher order pairwise structures of the different positions of the surround-ing text by estimating their pairwise joint generation prob-H ( T )), where j&gt;M and k, l  X  M , M is the number of the original text parts (in our experiment M is set to 5). Noticed that according to Equ.1, the weights of different parts of the surrounding text are crucial to estimate semantic labels of image. Thus we propose the following new piecewise penalty regression model to learn weights  X  ( w, I ) as follows: 1.For a given unlabeled image I and the corresponding surrounding text T , a neighborhood in the training web im-age set (denoted as N ( I )) is first generated under the simi-larity measurement[5] of visual and textual features. 2. Since the textual data is consisted of different ordered structures, we impose different penalty to the surrounding textual data and their pairwise higher order structure. We partition the coefficients (excluding the intercept) into two subsets corresponding to the textual data T and their pair-wise higher order structures. The coefficients of the two parts are denoted as D 1 and D 2 respectively. We shrink-age the regression coefficients by imposing a L 2 penalty to each part, where the penalty parameters are denoted as  X  , X  2 (  X  1  X   X  2 ). The piecewise penalty weighted regres-sion coefficients is calculated by minimizing weighted resid-
Table 1: The performance comparasion results. ual sum of squares as follows: where K is the number of images in n ( I ), y i refers to the probability of the semantic concept w as the label of image J  X  n ( I )), and T i denotes the textual features of image J  X  denotes the similarity between image I and J i .
To demonstrate the effectiveness of the WISA, we ap-ply it into web image annotation task (denoted as AIA-WISA ), and compare the performance with the baseline method where the position weights are uniquely distributed (denoted as AIA-uniform ). The well known average preci-sion and recall are adopted as performance measurements. In our experiments, 2,500 web images are collected from web pages by using the previous mentioned web data precessing method, in which 900 images are manually labeled as train-ing images with 177 keywords. The value of  X  1 and  X  2 are set to 0.3, 0.7 respectively. The number of the keyword for each annotation is set 4, and the average recall and precision are calculated over all 177 keywords.

Tab.1 gives the experiment results. According to Tab.1, we can draw the conclusion that WISA can improve the performance of web image semantic annotation significantly.
We present our ongoing project WISA, a novel automatic web image semantic analysis system. In our work, a new piecewise penalty regression model is proposed to adaptively explore the distributions of the semantic labels of web image on its surrounding text. Experiment results show that WISA can improve the performance of web AIA significantly. [1] H.M. Sanderson, M.D. Dunlop. Image Retrieval by [2] V.S. Tseng, J.H. Su, B.W. Wang, Y.M. Lin. Web Image [3] X. Li, L. Chen, L. Zhang,F. Lin, and W.Y. Ma. Image [4] X.Zhou, M. Wang, Q. Zhang, J. Zhang, B.Shi.
 [5] V. Lavrenko and R. Manmatha and J. Jeon. A Model
