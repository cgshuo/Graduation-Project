 Describing daily life activities is an important abil-ity of intelligent systems. In fact, we can use this ability to achieve a monitoring system that is able to report on an observed situation, or cre-ate an automatic diary of a user. Recently, sev-eral studies have been performed to generate sen-tences that describe images using Deep Learning (Vinyals et al., 2014; Fang et al., 2014; Donahue et al., 2014; Kiros et al., 2015). Although these results were good, we are interested in unsuper-vised frameworks. This is necessary to achieve a system that can adapt to the user, that is, one that can learn a user-unique language and gener-ate it automatically. Moreover, the use of crowd-sourcing should be avoided to respect the privacy of the user. Regarding this, studies on sentence generation from RGB videos have been discussed in (Yu and Siskind, 2013; Regneri et al., 2013). A promising result for language learning has been shown in (Yu and Siskind, 2013) and a quite chal-lenging effort to describe cooking activities was made in (Regneri et al., 2013). However, these studies rely only on visual information, while we aim to build a system that is able to describe every-day activities using multimodal information. To realize such systems, we need to consider two problems. The first problem is the sensing of daily life activities. In this paper, we utilize a smart house (Motooka et al., 2010) for sensing human activities. Thanks to the smart house, multimodal information such as visual, motion, and audio data can be captured. The second problem to be tack-led is verbalization of the observed scenes. To solve this problem, a multilayered multimodal la-tent Dirichlet allocation (mMLDA) was proposed in (Attamimi et al., 2014).

In this paper, we propose a sentence generation system from observed scenes in a bottom up man-ner using mMLDA and a Bayesian hidden Markov model (BHMM) (Goldwater and Griffiths, 2007). To generate sentences from scenes, we need to consider the words that represent the scenes and their order. Here, mMLDA is used to infer words for given scenes. To determine the order of words, inspired by (Kawai et al., 2014), a probabilis-tic grammar that considers syntactic information is learned using BHMM. In this study, the order of concepts is generated by sampling the learned grammar. The word selection for each generated concept is then performed using the observed data. Moreover, a language model that represents the re-lationship between words is also used to calculate Figure 1: Language learning and sentence genera-tion system.

Figure 2: Multimodal information acquisition. the transition probability between them. Consid-ering the transition probability at word level, a lat-tice of word candidates corresponding to the con-cept sequence can be generated. Therefore, sen-tence generation can be thought of as a problem of finding the word sequence that has the high-est probability from the lattice of word candidates, which can be solved by the Viterbi algorithm. Fi-nally, sampling from grammar is performed mul-tiple times to generate sentence candidates and se-lect the most probable one. 2.1 Overview Figure 1 illustrates the overall system of proposed language learning and sentence generation. In this study, we use a smart environment for sens-ing multimodal information. The system shown in Figure 2 is part of a smart house (Motooka et al., 2010) that is used to capture multimodal informa-tion. Here, an RFID tag is attached to an object to enable the object information to be read using a wearable tag reader. To capture motion, five sen-sors that consist of 3-axis acceleration with 3-axis gyroscope sensors are attached to the upper body, as shown in Figure 2. Moreover, a particle filter-based human tracker (Glas et al., 2007) applied to four laser range finders is used to estimate the location of a person while performing an action. This is a setup designed to demonstrate that lan-guage can be learned and generated from real hu-man actions. Ultimately, our goal is sensing based on image recognition.

The acquired multimodal data is then processed, which results in a bag-of-words model (BoW) and bag-of-features model (BoF) (Csurka et al., 2004). Using mMLDA (see section 2.2), various concepts can be formed from the multimodal data. Given teaching sentences, the connection between words and concepts can be learned based on mMLDA and BHMM which is learned with mutual infor-mation (MI) as the initial value. On the other hand, the bigram model of words is calculated and used as the score when reordering words inferred from multimodal information using grammar. A mor-phological analyzer for parsing words in a sen-tence is also necessary in the proposed system. We use publicly available parser MeCab (Kudo et al., 2004). In the future, we plan to use the unsuper-vised morphological analysis technique proposed in (Mochihashi et al., 2009). 2.2 mMLDA Figure 3 shows the graphical model of mMLDA used in this paper. Here, z repre-sents the integrated category (concept), whereas tion, and place concepts, respectively. In the bottom layer (lower panel of Figure 3), the multimodal information obtained from each denote multimodal information obtained respec-tively from the object used in an action, motion of a person while using the object, and location of denotes word information obtained from teaching sentences. Observation information is acquired by using the system shown in Figure 2. A brief explanation of each observation is as follows.
For object information, an N o -dimensional vec-tor w o = ( o 1 ; o 2 ;  X  X  X  ; o N notes the number of objects. In this vector, o takes a value of 0 or 1, where o i is set to 1 if an object with index i is observed. Moreover, all of the teaching sentences are segmented into words and represented by a BoW as word information. Here, motion is segmented according to the ob-ject used. A sequence of 15-dimensional feature vectors for each motion is acquired. Using BoF, the acquired feature vectors are vector quantized, resulting in a 70-dimensional vector. The acquired two dimensional of human positions are processed using BoF to construct a 10-dimensional vector as place information.

In mMLDA, latent variables that represent up-are learned simultaneously. Gibbs sampling is ap-plied to the marginalized posterior probability of latent variables to learn the model from observed data w m (Attamimi et al., 2014). 2.3 Language learning and generation 2.3.1 Word inference In this study, word information is obtained from teaching sentences and employed for all concepts, as shown in Figure 3. Considering that appropriate words to express each concept exist, a criterion to measure the correlation between words and con-cepts is needed. At the start of grammar learn-ing, MI, which can measure the mutual depen-dence of two stochastic variables, is used. There-fore, a word is considered to express a category when the MI between the word and category is large. On the other hand, a word with small MI is identified as a functional word. This determi-nation is used as an initial value in the syntac-tic learning and needs not be strictly determined. Once the grammar is learned, we can utilize BHMM X  X  parameters P ( w w | c ) to infer a word w w max k P ( w wC | c ) P ( w wC | k ) P ( k | w m P ( w wC | k ) and P ( k | w m from mMLDA (Attamimi et al., 2014) and k is category of concept c  X   X  X  object; motion; place } and c  X  X  c  X  ; f unctional } . It should be note that P ( w wC | k ) and P ( k | w m as uniform distribution for  X  X unctional X  since they cannot be inferred from observed data using mMLDA. In this case, we can rely on syntactic in-formation which is learned by BHMM. 2.3.2 Grammar learning using BHMM Thanks to mMLDA and BHMM, appropriate words to represent the observed information can be inferred. Given an input consisting of a teach-ing sentence of a sequence of words, a BHMM can infer a sequence of concepts. In the learning phase, the MI results of concept selection for each word are used as the initial values of the BHMM. Here, grammar is defined as the concept transi-tion probability P ( C t | C t 1 ) , which is estimated using Gibbs sampling, where C t  X  c represents the corresponding concepts of the t -th word in the sentence. In addition, a language model that rep-resent the bigram model of words in the teaching sentences is also used for generating sentences. index). 2.3.3 Sentence generation of observed scenes First, concepts are sampled from the begin of sen-tence  X  X OS X  until the end of sentence  X  X OS X  ac-cording to the learned grammar N times. Let the n -th ( n  X  X  1 ; 2 ;  X  X  X  ; N } ) sequence of con-cepts that excludes  X  X OS X  and  X  X OS X  be C n = number of sampled concepts, which corresponds to the length of a sampled sentence.
 is estimated. Here, for a given observed infor-all words for a sequence of concepts C n can be written as W n = { w n 1 ; w n 2 ;  X  X  X  ; w n fore, K T n number of patterns for a candidate of the sentence can be considered for C n and the cor-responding words W n . Each candidate for sen-tence S n is selected from these patterns and has the following probability:
P ( S n | C n ; W n ; w m obs )  X   X  For observed information, the most probable sen-tence is selected from N sequences of concepts with sets of words. Here, the sentence  X  S n that maximizes Eq. (1) is determined for each se-quence of concepts. Because many patterns of the computational cost and determine the most probable sentence. Thus, a set of sentences that consists of sentences with the highest probability for each sequence of concepts can be written as  X  S = {  X  S 1 ;  X  X  X  ;  X  S n ;  X  X  X  ;  X  S N } .
We can select the final sentence from  X  S by con-sidering the most probable candidate. In fact, long sentences tend to have low probability and are less likely to be selected. To cope with this problem, adjustment coefficient  X  (  X  S n ) = troduced, where, L  X  tence  X  S n and L max represents the maximum value of the sentence length in  X  S . Using  X  (  X  S n ) , the logarithmic probability of the sentence can be calculated as log  X  P (  X  S n | C n ; W n ; w m log P (  X  S n | C n ; W n ; w m is a weight that controls the length of sen-tences. A large weight leads to longer sen-tences. The final sentence S is determined as S = argmax The acquisition system shown in Figure 2 was used to capture multimodal information from hu-man actions. Table 1 shows the actions that were performed by three subjects twice, resulting in a total of 195 multimodal data with 1170 sentences. We then divided the data into training data (99 multimodal data with 594 sentences) and test data (96 multimodal data with 576 sentences). Some examples of acquired multimodal data are shown in Figure 4(b). Using training data, various con-cepts were formed by mMLDA, and the catego-rization accuracies for object, motion, and place were respectively 100.00%, 52.53%, and 95.96%. Motion similarity was responsible for the false cat-egorization of motion concepts. Since our goal is to generate sentences from observed scenes, these results are used as reference instead of comparing with the baseline.

To evaluate the concept selection of words, 98 words in teaching sentences were used. We com-pared the results of concept selection with hand-labeled ones. Table 2 shows the accuracy rate of concept selection. Here, we excluded the func-tional words (resulting in 78 words) for fair com-parison with the baseline method (Attamimi et al., 2014). One can see that, better results can be achieved by the proposed method. It is clear that concept selection is improved by using the BHMM, indicating that a better grammar can be learned using this model.

Next, the learned grammar was used and sen-tences were generated. To reduce randomness of the results, sentence generation was conducted 10 times for each data. To verify sentence gener-ation quantitatively, we evaluated the sentences automatically using BLEU score (Papineni et al., 2002). Figure 5 depicts the results of 2-to 4-gram of BLEU scores. Since functional words are not considered in (Attamimi et al., 2014), we used our grammar and performed sentence generation pro-posed in (Attamimi et al., 2014) as the baseline method. One can see from the figure that in all cases the BLEU scores of proposed method out performs the baseline method. It can be said that the sentences generated by the proposed method are of better quality than those generated by the baseline method.

Moreover, we also manually evaluated gener-ated sentences by asking four subjects (i.e., col-lege students who understand Japanese) whether the sentences were: correct both in grammar and meaning (E1), grammatically correct but incorrect in meaning (E2), grammatically incorrect but cor-rect in meaning (E3), or incorrect both in grammar and meaning (E4). The average rates of E1, E2, E3, and E4 were shown in Table 3. We can see that the proposed method out performs the base-line method by providing high rates of E1 and E2; and low rates of E4. Because we want to generate sentences that explain actions, incorrect motion in-Table 3: Evaluation results of generated sentences.
Figure 5: BLEU scores of generated sentences. ference would lead to incorrect sentence genera-tion. Examples of E2 are  X  X ating the plastic wrap in the dining room X  and  X  X pening the dressing in the kitchen. X  One can see that these sentences are grammatically correct but do not express the scenes correctly because the words that represent the motion are incorrect. Hence, the misclassi-fication that occurred in the motion concept for-mation was responsible for the incorrect meaning of the generated sentences. Figure 4(c) shows the sentences generated from the given scenes (Fig-ure 4(a)). We can see that meaningful yet natural sentences that explain the observed scenes can be generated using the proposed method. In this paper, we proposed an unsupervised method to generate natural sentences from ob-served scenes in a smart environment using mMLDA and BHMM. In the smart environment, multimodal information can be acquired for real-istic scenarios. Thanks to mMLDA, various con-cepts can be formed and an initial determination of functional words can be made by assuming a weak connection of concepts and words calculated by MI. The possibility that grammar can be learned from BHMM by considering the syntactic infor-mation has also been shown. We conducted exper-iments to verify the proposed sentence generation, and promising preliminary results were obtained. In future work, we aim to implement a nonpara-metric Bayes model that will be able to estimate the number of concepts automatically.
 This work is partly supported by JSPS KAKENHI 26280096.
