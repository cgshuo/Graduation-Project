 Carl Henrik Ek CHEK @ CSC . KTH . SE KTH  X  Royal Institute of Technology, CVAP Lab, Stockholm, Sweden Michalis K. Titsias MTITSIAS @ WELL . OX . AC . UK Multiview learning is characterised by data which contain observations from several different modalities: for exam-ple depth cameras provide colour and depth images from the same scene, or a meeting might be represented by both an audio and a video feed. This motivates latent variable models which align the different views by assuming that a portion of the data variance is shared between the modal-ities, whilst explaining the remaining variance with latent spaces that are private to each modality. This model struc-ture allows inference when only a subset of the modali-ties is available and, because the observation spaces have been aligned, it is possible to transfer information between modalities by conditioning the model through the underly-ing concept.
 Several approaches that combine multiple views have been suggested. One line of work aims to find a low-dimensional representation of the observations by seeking a transfor-mation of each view. Different approaches exploit differ-ent characteristics of the data such as, correlation (Kuss &amp; Graepel, 2003; Ham et al., 2005), or mutual information (Memisevic et al., 2011). However, these methods only aim to encode the shared variance and do not provide a probabilistic model. To address these shortcomings dif-ferent generative models have been suggested. In partic-ular, approaches formulated as Gaussian Processes Latent Variable Models (GP-LVMs) (Lawrence, 2005) have been especially successful (Shon et al., 2006; Ek et al., 2007). However, these models assume that a single latent variable is capable of representing each modality, implying that the modalities can be fully aligned. To overcome this, the idea of a factorized latent space was presented in (Ek et al., 2008) where each view is associated with an additional private space, representing the variance which cannot be aligned, in addition to the shared space (Ek, 2009), an idea independently suggested by Klami &amp; Kaski (2006). The main challenge for the applicability of the proposed mod-els is that the factorization of the latent variable is a struc-tural and essentially discrete property of the model, making it very challenging to learn. Salzmann et al. (2010) intro-duced a set of regularizers allowing the dimensionality of the factorization to be learned. However, the regularizers were motivated out of necessity rather than principle and introduced several additional parameters to the model. We present a new principled approach to learning a factor-ized latent variable representation of multiple observation spaces. We introduce a relaxation of the structural factor-ization of the model from the original hard discrete rep-resentation, where each latent variable is either associated with a private space or a shared space, to a smooth contin-uous representation, where a latent variable may be more important to the shared space than the private space. In con-trast to previous approaches the model is fully Bayesian, al-lowing estimation of both the dimensionality and the struc-ture of the latent representation to be done automatically. Further, it provides an approximation to the full posterior of the latent points given the data.We describe the model and the variational approximation in the next section. The model is capable of handling extremely high dimensional data. We illustrate this by modelling image data directly in the pixel space in section 3. We also demonstrate the model X  X  ability to reconstruct pose from silhouette in a hu-man motion example and, finally, by considering class la-bels to be a second  X  X iew X  of a dataset we show how the model can be used to improve classification performance in a well known visualization benchmark: the  X  X il data X . We wish to relate two views Y  X  R N  X  D Y and Z  X  R the existence of a single latent variable X  X  R N  X  Q which, through the mappings { f Y d } D Y d =1 : X 7 X  Y and { f Z X 7 X  Z ( Q &lt; D ), gives a low dimensional representation of the data. Our assumption is that the data is generated from a low dimensional manifold and corrupted by addi-tive Gaussian noise { Y,Z }  X  X  ( 0 , X  { Y,Z } I ) , where { y,z } nd represents dimension d of point n . This leads to the likelihood under the model, P ( Y,Z | X,  X  ) , where  X  = {  X  Y ,  X  Z } collectively denotes the parameters of the mapping functions and the noise variances  X  { Y,Z } Finding the latent representation X and the mappings f Y and f Z is an ill-constrained problem. Lawrence (2005) suggested regularizing the problem by placing Gaussian process (GP) (Rasmussen &amp; Williams, 2006) priors over the mappings and the resulting models are known as Gaus-sian Process latent variable models (GP-LVMs).
 In the GP-LVM framework each generative mapping is modeled as a product of independent GP X  X  parametrized by a (typically shared) covariance function k { Y,Z } evaluated over the latent variable X , so that for F Z . This allows for general non-linear mappings to be marginalised out analytically leading to a likelihood as a product of Gaussian densities, A fully Bayesian treatment requires integration over the la-tent variable X in equation (3) which is intractable, as X appears non-linearly in the inverse of the covariance matri-ces K Y and K Z of the GP priors for f Y and f Z . In prac-tice, a maximum a posteriori solution (Shon et al., 2006; Ek et al., 2007; Salzmann et al., 2010) was often used. How-ever, failure to marginalize out the latent variables means that it is not possible to automatically estimate the dimen-sionality of the latent space or the parameters of any prior distributions used in the latent space. We show how we can obtain an approximate Bayesian training and inference pro-cedure by variationally marginalizing out X . We achieve this by building on recent variational approximations for standard GP-LVMs (Titsias &amp; Lawrence, 2010; Damianou et al., 2011). We then introduce automatic relevance de-termination (ARD) priors (Rasmussen &amp; Williams, 2006) so that each view of the data is allowed to estimate a sep-arate vector of ARD parameters. This allows the views to determine which of the emerging private and shared latent spaces are relevant to them. We refer to this idea as mani-fold relevance determination (MRD). 2.1. Manifold Relevance Determination We wish to recover a factorized latent representation such that the variance shared between different observation spaces can be aligned and separated from variance that is specific (private) to the separate views. In manifold rel-evance determination the notion of a hard separation be-tween private and shared spaces is relaxed to a continuous setting. The model is allowed to (and indeed often does) completely allocate a latent dimension to private or shared spaces, but may also choose to endow a shared latent di-mension with more or less relevance for a particular data-view. Importantly, this factorization is learned from data by maximizing a variational lower bound on the model ev-idence, rather than through construction of bespoke reg-ularizers to achieve the same effect. The model we pro-pose can be seen as a generalisation of the traditional ap-proach to manifold learning; we still assume the existence of a low-dimensional representation encoding the underly-ing phenomenon, but the variance contained in an observa-tion space does not necessarily need to be governed by the full manifold, as traditionally assumed, nor by a subspace geometrically orthogonal to that, as assumed in Salzmann et al. (2010).
 The expressive power of our model comes from the ability to consider non-linear mappings within a Bayesian frame-work. Specifically, our D Y latent functions f Y d are selected to be independent draws of a zero-mean GP with an ARD covariance function of the form: and similarly for f Z . Accordingly, we can learn a common latent space 1 but we allow the two sets of ARD weights w
Y = { w Y fer the responsibility of each latent dimension for generat-ing points in the Y and Z spaces respectively. We can then automatically recover a segmentation of the latent space subspace, defined by the set of dimensions q  X  [1 ,...,Q ] for which w Y q ,w Z q &gt;  X  , with  X  being a number close to zero and Q s  X  Q . This equips the model with further flex-ibility, because it allows for a  X  X oftly X  shared latent space, if the two sets of weights are both greater than  X  but dis-similar, in general. As for the two private spaces, X Y and X
Z , they are also being inferred automatically along with their dimensionalities Q Y and Q Z 2 . More precisely: and analogously for X Z . Here, x q denotes columns of X , while we assume that data are stored by rows. All of the above are summarised in the graphical model of figure 1. 2.2. Bayesian training The fully Bayesian training procedure requires maximi-sation of the logarithm of the joint marginal likelihood p ( Y,Z |  X  ) = R p ( Y,Z | X,  X  ) p ( X ) d X , where a prior distri-bution is placed on X . This prior may be a standard normal distribution or may generally depend on a set of parameters  X 
X . By looking again at (3) we see that the above integral is intractable due to the nonlinear way in which X appears in p ( F { Y,Z } | X,  X  { Y,Z } ) . Standard variational approxima-tions are also intractable in this situation. Here, we describe a non-standard method which leads to an analytic solution. As a starting point, we consider the mean field method-ology and seek to maximise a variational lower bound F ( q,  X  ) on the logarithm of the true marginal likelihood by relying on a variational distribution which factorises as q ( X ) q ( X ) , where we assume that q ( X )  X  N (  X  ,S ) . As will be explained later more clearly, in our approach q ( X ) is a distribution which depends on additional variational pa-rameters  X  = {  X  Y ,  X  Z } so that q ( X ) = q ( X  Y ) q ( X  These additional parameters  X  as well as the exact form of q ( X ) will be defined later on, as they constitute the most crucial ingredient of our non-standard variational approach. By dropping the model hyperparameters  X  from our expres-sions, for simplicity, we can use Jensen X  X  inequality and obtain a variational bound F v ( q )  X  log p ( Y,Z ) :
F v ( q ) = for L Z . However, this does not solve the problem of in-tractability since the challenging terms still appear in L and L Z . To circumvent this problem, we follow Titsias &amp; Lawrence (2010) and apply the  X  X ata augmentation X  prin-ciple, i.e. we expand the joint probability space with M extra samples U Y and U Z of the latent functions f Y and f
Z evaluated at a set of pseudo-inputs (known as  X  X nducing points X )  X  X Y and  X  X Z respectively. Here, U Y  X  R M Y U M = M Y + M Z . The expression of the joint probability is as before except for the term p ( Y | X ) which now becomes: and similarly for p ( Z | X ) . The integrations over U are tractable if we assume Gaussian prior distributions for these variables. As we shall see, the inducing points are variational rather than model parameters. More details on the variational learning of inducing variables in GPs can be found in Titsias (2009).
 Analogously to Titsias &amp; Lawrence (2010), we are now able to define q ( X ) = q ( X  Y ) q ( X  Z ) as where q ( U { Y,Z } ) are free form distributions. In that way, the p ( F K | U K ,X,  X  X K ) factors cancel out with the  X  X iffi-cult X  terms of L Y and L Z , as can be seen by replacing equations (8) and (7) back to (6), which now becomes our final objective function and can be trivially extended for more than two observed datasets. This function is jointly maximised with respect to the model parameters, involv-ing the latent space weights w Y and w Z , and the vari-ational parameters {  X  ,S,  X  X } . As in standard variational inference, this optimisation gives, as a by-product, an ap-proximation of p ( X | Y,Z ) by q ( X ) , i.e. we obtain a dis-tribution over the latent space. This adds extra robustness to our model, since previous approaches rely on MAP esti-mates for the latent points. More detailed derivation of the variational bound can be found in the suppl. material. Dynamical Modelling: The model formulation described previously is also covering the case when we wish to addi-tionally model correlations between datapoints of the same output space, e.g. when Y and Z are multivariate time-series. For the dynamical scenario we follow Damianou et al. (2011); Lawrence &amp; Moore (2007) and choose the prior on the latent space to depend on the observation times t  X  R N , e.g. a GP with a covariance function k = k ( t,t With this approach, we are also allowed to learn the struc-ture of multiple independent sequences which share some commonality by learning a common latent space for all timeseries while, at the same time, ignoring correlations between datapoints belonging to different sequences. Inference: Given a model which is trained to jointly rep-resent two output spaces Y and Z with a common but fac-torised input space X , we wish to generate a new (or infer (potentially partially) observed test points Y  X   X  R N  X   X  D This is done in three steps. Firstly, we predict the set of latent points X  X   X  R N  X   X  Q which is most likely to have generated Y  X  . For this, we use an approximation to the posterior p ( X  X  | Y  X  ,Y ) , which has the same form as for the standard Bayesian GP-LVM model (Titsias &amp; Lawrence, 2010) and is given by a variational distribution q ( X,X  X  To find q ( X,X  X  ) we optimise a variational lower bound on the marginal likelihood p ( Y,Y  X  ) which has analogous form with the training objective function (6). Specifically, we ignore Z and replace Y with ( Y,Y  X  ) and X with ( X,X  X  ) in (6). In the second step, we find the training latent points X NN which are closest to X  X  in the shared latent space. In the third step, we find outputs Z from the likelihood p ( Z | X NN ) . This procedure returns the set of training points Z which best match the observed test points Y  X  . If we wish to generate novel outputs, we have to propa-gate the information recovered when predicting X  X  . Since the shared latent space encodes the same kind of informa-tion for both datasets, we can achieve the above by simply replacing the features of X NN corresponding to the shared latent space, with those of X  X  .
 Complexity: As in common sparse methods in Gaussian processes (Titsias, 2009), the typical cubic complexity re-duces to O ( NM 2 ) , where N and M is the total number of training and inducing points respectively. In our exper-iments we set M = 100 . Further, the model scales only linearly with the data dimensionality. Indeed, the Gaus-sian densities in equation (6) result in an objective function which only involves the data matrices Y and Z in expres-sions of the form Y Y &gt; and ZZ &gt; which are N  X  N matri-ces no matter how many features D Y and D Z are used to describe the original data. Also, these quantities are con-stant and can be precomputed. Consequently, our approach can model datasets with very large numbers of features. The MRD method is designed to represent multiple views of a data set as a set of factorized latent spaces. In this sec-tion we will show experiments which exploit this factorized structure. Source code for recreating these experiments is included as supplementary material.
 Yale faces: To show the ability of our method to model very high-dimensional spaces our first experiment is ap-plied to the Yale dataset (Georghiades et al., 2001; Lee et al., 2005) which contains images of several human faces under different poses and 64 illumination conditions. We consider a single pose for each subject such that the only variations are the location of the light source and the sub-ject X  X  appearance. Since our model is capable of working with very high-dimensional data, it can be directly applied to the raw pixel values (in this case 192  X  168 = 32 , 256 pixels/image) so that we do not have to rely on image fea-ture extraction to pre-process the data, and we can directly sample novel outputs. From the full Yale database, we con-structed a dataset Y containing the pictures corresponding to all 64 different illumination conditions for each one of 3 subjects and similarly for Z , for 3 different subjects. In this way, we formed two datasets, Y and Z , each consisting of all 64  X  3 images corresponding to a set of three different faces, under all possible illumination conditions, therefore, Y,Z  X  R N  X  D , N = 192 , D = 32 , 256 . We then aligned the order of the images in each dataset, so that each image y n from the first one was randomly set to correspond to one of the 3 possible z n  X  X  of the second dataset which are depicted in the same illumination condition as y n . In that way, we matched datapoints between the two datasets only according to the illumination condition and not the identity of the faces, so that the model is not explicitly forced to learn the correspondence between face characteristics. The latent space variational means were initialised by con-catenating the two datasets and performing PCA. An alter-native approach would be to perform PCA on each dataset separately and then concatenate the two low dimensional representations to initialise X . We found that both initial-izations achieved similar results. The optimized relevance weights { w Y , w Z } are visualized as bar graphs in figure 2. The latent space is clearly segmented into a shared part, consisting of dimensions indexed as 1 , 2 and 3 3 two pri-vate and an irrelevant part (dimension 9 ). The two data views allocated approximately equal weights to the shared latent dimensions, which are visualized in figures 3(a) and 3(b). Interaction with these three latent dimensions reveals that the structure of the shared subspace resembles a hollow hemisphere. This corresponds to the shape of the space de-fined by the fixed locations of the light source.
 This indicates that the shared space successfully encodes the information about the position of the light source and not the face characteristics. This indication is enhanced by the results found when we performed dimensionality re-duction with the standard Bayesian GP-LVM for pictures corresponding to all illumination conditions of a single face (i.e. a dataset with one modality). Specifically, the latent space discovered by the Bayesian GP-LVM and the shared subspace discovered by MRD have the same dimensional-ity and similar structure, as can be seen in figure 4. As for the private manifolds discovered by MRD, these cor-respond to subspaces for disambiguating between faces of the same dataset. Indeed, plotting the largest two dimen-sions of the first latent private subspace against each other reveals three clusters, corresponding to the three different faces within the dataset. Similarly to the standard Bayesian GP-LVM applied to a single face, here the private dimen-sions with very small weight model slight changes across faces of the same subject (blinking etc).
 We can also confirm visually the subspaces X  properties by sampling a set of novel inputs X samp from each subspace and then mapping back to the observed data space using the likelihoods p ( Y | X samp ) or p ( Z | X samp ) , thus obtain-ing novel outputs (images). To better understand what kind of information is encoded in each of the dimensions of the shared or private spaces, we sampled new latent points by varying only one dimension at a time, while keeping the rest fixed. The first two rows of figure 5 show some of the outputs obtained after sampling across each of the shared dimensions 1 and 3 respectively, which clearly encode the coordinates of the light source, whereas dimension 2 was found to model the overall brightness. The sampling pro-cedure can intuitively be thought as a walk in the space shown in figure 3(b) from left to right and from the bottom to the top. Although the set of learned latent inputs is dis-crete, the corresponding latent subspace is continuous, and we can interpolate images in new illumination conditions by sampling from areas where there are no training inputs (i.e. in between the red crosses shown in figure 3). Similarly, we can sample from the private subspaces and obtain novel outputs which interpolate the non-shared char-acteristics of the involved data. This results in a morphing effect across different faces, which is shown in the last row of figure 5. Example videos can be found in the supple-mentary material.
 As a final test, we confirm the efficient segmentation of the latent space into private and shared parts by automat-ically recovering all the illumination similarities found in the training set. More specifically, given a datapoint y from the first dataset, we search the whole space of train-ing inputs X to find the 6 Nearest Neigbours to the latent representation x n of y n , based only on the shared dimen-sions. From these latent points, we can then obtain points in the output space of the second dataset, by using the likeli-hood p ( Z | X ) . As can be seen in figure 6, the model returns images with matching illumination condition. Moreover, the fact that, typically, the first neighbours of each given point correspond to outputs belonging to different faces, indicates that the shared latent space is  X  X ure X , and is not polluted by information that encodes the face appearance. Human motion data: For our second experiment, we con-sider a set of 3 D human poses and associated silhouettes, coming from the dataset of Agarwal and Triggs (Agarwal &amp; Triggs, 2006). We used a subset of 5 sequences, totalling 649 frames, corresponding to walking motions in various directions and patterns. A separate walking sequence of 158 frames was used as a test set. Each pose is repre-sented by a 63  X  dimensional vector of joint locations and each silhouette is represented by a 100  X  dimensional vec-tor of HoG (histogram of oriented gradients) features. Given the test silhouette features, we used our model to generate the corresponding poses. This is challenging, as the data are multi-modal, i.e. a silhouette representation may be generated from more than one poses (e.g. fig. 7). As described in the inference section, given y  X  , one of the N  X  test silhouettes, our model optimises a test latent point x  X  and finds a series of K candidate initial training inputs { x
NN } K k =1 , sorted according to their similarity to x ing into account only the shared dimensions. Based on these initial latent points, it then generates a sorted series of K novel poses { z ( k ) } K k =1 . For the dynamical version of our model, all test points are considered together and the predicted N  X  outputs are forced to form a smooth se-quence. Our experiments show that the initial training in-puts x NN typically correspond to silhouettes similar to the given one, something which confirms that the segmentation of the latent space is efficient. However, when ambiguities arise, as the example shown in figure 7, the non-dynamical version of our model has no way of selecting the correct input, since all points of the test sequence are treated inde-pendently. But when the dynamical version is employed, the model forces the whole set of training and test inputs to create smooth paths in the latent space. In other words, the dynamics disambiguate the model.
 Indeed, as can be seen in figure 8, our method is forced to select a candidate training input x NN for initialisation which does not necessarily correspond to the training sil-houette that is most similar to the test one. What is more, if we assume that the test pose z  X  is known and seek for its nearest training neighbour in the pose space, we find that the corresponding silhouette is very similar to the one found by our model, which is only given information in the silhouette space.
 Given the above, we quantify the results and compare our method with linear and Gaussian process regression and Nearest Neighbour in the silhouette space. We also com-pared against the shared GP-LVM (Ek et al., 2008; Ek, 2009) which optimises the latent points using MAP and, therefore, requires an initial factorisation of the inputs to be given a priori. Finally, we compared to a dynamical ver-sion of Nearest Neighbour where we kept multiple nearest neighbours and selected the coherent ones over a sequence. The errors shown in table 1 as well as the video provided as supplementary material show that MRD performs better than the other methods in this task.
 Classification: As a final experiment, we demonstrate the flexibility of our model in a supervised dimensional-ity reduction scenario for a classification task. The train-ing dataset was created such that a matrix Y contained the actual observations and a matrix Z the correspond-ing class labels in 1-of-K encoding. We used the  X  X il X  database (Bishop &amp; James, 1993) which contains 1000 12  X  dimensional examples split in 3 classes. We selected 10 random subsets of the data with increasing number of training examples and compared to the nearest neighbor (NN) method in the data space. As can be seen in figure 9, MRD successfully determines the shared information be-tween the data and the label space and outperforms NN. We have presented a new factorized latent variable model for multi view data. The model automatically factorizes the data using variables representing variance that exists in each view separately from variance being specific to a par-ticular view. The model learns a distribution over the latent points variationally. This allows us to to automatically find the dimensionality of the latent space as well as to incor-porate prior knowledge about its structure. As an example, we showed how dynamical priors can be included on the latent space. This allowed us to use temporal continuity to disambiguate the model X  X  predictions in an ambiguous human pose estimation problem. The model is capable of learning from extremely high-dimensional data. We illus-trated this by learning a model directly on the pixel repre-sentation of an image. Our model is capable of learning a compact an intuitive representation of such data which we exemplified by generating novel images by sampling from the latent representation in a structured manner. Finally, we showed how a generative model with discriminative ca-pabilities can be obtained by treating the observations and class labels of a dataset as separate modalities.
 Research was partially supported by the University of Sheffield Moody endowment fund and the Greek State Scholarships Foundation (IKY). We would like to thank the reviewers for their useful feedback.

