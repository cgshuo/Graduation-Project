 Word alignment is a crucial early step in the training of most statistical machine translation (SMT) sys-tems, in which the estimated alignments are used for constraining the set of candidates in phrase/grammar extraction (Koehn et al., 2003; Chiang, 2007; Galley et al., 2006). State-of-the-art word alignment mod-els, such as IBM Models (Brown et al., 1993), HMM (Vogel et al., 1996), and the jointly-trained symmet-ric HMM (Liang et al., 2006), contain a large num-ber of parameters (e.g., word translation probabili-ties) that need to be estimated in addition to the de-sired hidden alignment variables.

The most common method of inference in such models is expectation-maximization (EM) (Demp-ster et al., 1977) or an approximation to EM when exact EM is intractable. However, being a maxi-mization (e.g., maximum likelihood (ML) or max-imum a posteriori (MAP)) technique, EM is gen-erally prone to local optima and overfitting. In essence, the alignment distribution obtained via EM takes into account only the most likely point in the parameter space, but does not consider contributions from other points.
 Problems with the standard EM estimation of IBM Model 1 was pointed out by Moore (2004) and a number of heuristic changes to the estimation pro-cedure, such as smoothing the parameter estimates, were shown to reduce the alignment error rate, but the effects on translation performance was not re-ported. Zhao and Xing (2006) note that the param-eter estimation (for which they use variational EM) suffers from data sparsity and use symmetric Dirich-let priors, but they find the MAP solution.

Bayesian inference, the approach in this paper, have recently been applied to several unsupervised learning problems in NLP (Goldwater and Griffiths, 2007; Johnson et al., 2007) as well as to other tasks in SMT such as synchronous grammar induction (Blunsom et al., 2009) and learning phrase align-ments directly (DeNero et al., 2008).

Word alignment learning problem was addressed jointly with segmentation learning in Xu et al. (2008), Nguyen et al. (2010), and Chung and Gildea (2009). The former two works place nonparametric priors (also known as cache models) on the param-eters and utilize Gibbs sampling. However, align-ment inference in neither of these works is exactly Bayesian since the alignments are updated by run-ning GIZA++ (Xu et al., 2008) or by local maxi-mization (Nguyen et al., 2010). On the other hand, Chung and Gildea (2009) apply a sparse Dirichlet prior on the multinomial parameters to prevent over-fitting. They use variational Bayes for inference, but they do not investigate the effect of Bayesian infer-ence to word alignment in isolation. Recently, Zhao and Gildea (2010) proposed fertility extensions to IBM Model 1 and HMM, but they do not place any prior on the parameters and their inference method is actually stochastic EM (also known as Monte Carlo EM), a ML technique in which sampling is used to approximate the expected counts in the E-step. Even though they report substantial reductions in align-ment error rate, the translation BLEU scores do not improve.

Our approach in this paper is fully Bayesian in which the alignment probabilities are inferred by integrating over all possible parameter values as-suming an intuitive, sparse prior. We develop a Gibbs sampler for alignments under IBM Model 1, which is relevant for the state-of-the-art SMT sys-tems since: (1) Model 1 is used in bootstrapping the parameter settings for EM training of higher-order alignment models, and (2) many state-of-the-art SMT systems use Model 1 translation probabil-ities as features in their log-linear model. We eval-uate the inferred alignments in terms of the end-to-end translation performance, where we show the re-sults with a variety of input data to illustrate the gen-eral applicability of the proposed technique. To our knowledge, this is the first work to directly investi-gate the effects of Bayesian alignment inference on translation performance. Given a sentence-aligned parallel corpus ( E , F ) , let e i ( f j ) denote the i -th ( j -th) source (target) 1 word in e ( f ), which in turn consists of I ( J ) words and denotes the s -th sentence in E ( F ). 2 Each source sentence is also hypothesized to have an additional imaginary  X  X ull X  word e 0 . Also let V E ( V F ) denote the size of the observed source (target) vocabulary.
In Model 1 (Brown et al., 1993), each target word f j is associated with a hidden alignment variable a j whose value ranges over the word positions in the corresponding source sentence. The set of align-ments for a sentence (corpus) is denoted by a ( A ). The model parameters consist of a V E  X  V F ta-ble T of word translation probabilities such that t e,f = P ( f | e ) .

The joint distribution of the Model-1 variables is given by the following generative model 3 :
P ( E , F , A ; T ) = Y
In the proposed Bayesian setting, we treat T as a random variable with a prior P ( T ) . To find a suit-able prior for T , we re-write (2) as: P ( E , F , A | T ) = Y where in (3) the count variable n e,f denotes the number of times the source word type e is aligned to the target word type f in the sentence-pair s , and in (4) N e,f = P s n e,f . Since the distribution over { t e,f } in (4) is in the exponential family , specifically being a multinomial distribution, we choose the con-jugate prior, in this case the Dirichlet distribution, for computational convenience.

For each source word type e , we assume the prior distribution for t e = t e, 1  X  X  X  t e,V a distribution over the target vocabulary, to be a Dirichlet distribution (with its own set of hyperpa-rameters  X  e =  X  e, 1  X  X  X   X  e,V priors of other source word types:
We choose symmetric Dirichlet priors identically for all source words e with  X  e,f =  X  = 0 . 0001 to obtain a sparse Dirichlet prior. A sparse prior favors distributions that peak at a single target word and penalizes flatter translation distributions, even for rare words. This choice addresses the well-known problem in the IBM Models, and more severely in Model 1, in which rare words act as  X  X arbage col-lectors X  (Och and Ney, 2003) and get assigned ex-cessively large number of word alignments.

Then we obtain the joint distribution of all (ob-served + hidden) variables as:
P ( E , F , A , T ;  X  ) = P ( T ;  X  ) P ( E , F , A | T ) (5) where  X  =  X  1  X  X  X   X  V
To infer the posterior distribution of the align-ments, we use Gibbs sampling (Geman and Ge-man, 1984). One possible method is to derive the Gibbs sampler from P ( E , F , A , T ;  X  ) obtained in (5) and sample the unknowns A and T in turn, re-sulting in an explicit Gibbs sampler. In this work, we marginalize out T by: and obtain a collapsed Gibbs sampler, which sam-ples only the alignment variables.

Using P ( E , F , A ;  X  ) obtained in (6), the Gibbs sampling formula for the individual alignments is derived as: 4 where the superscript  X  j denotes the exclusion of the current value of a j .

The algorithm is given in Table 1. Initialization of A in Step 1 can be arbitrary, but for faster conver-gence special initializations have been used, e.g., us-ing the output of EM (Chiang et al., 2010). Once the Gibbs sampler is deemed to have converged after B burn-in iterations, we collect M samples of A with L iterations in-between 5 to estimate P ( A | E , F ) . To obtain the Viterbi alignments, which are required for phrase extraction (Koehn et al., 2003), we select for each a j the most frequent value in the M collected samples.
Input: E , F ; Output: K samples of A 1 Initialize A 2 for k = 1 to K do 3 for each sentence-pair s in ( E , F ) do 4 for j = 1 to J do 5 for i = 0 to I do 6 Calculate P ( a j = i | X  X  X  ) 7 Sample a new value for a j For Turkish  X  English experiments, we used the 20K-sentence travel domain BTEC dataset (Kikui et al., 2006) from the yearly IWSLT evaluations 6 for training, the CSTAR 2003 test set for develop-ment, and the IWSLT 2004 test set for testing 7 . For Czech  X  English, we used the 95K-sentence news commentary parallel corpus from the WMT shared task 8 for training, news2008 set for development, news2009 set for testing, and the 438M-word En-glish and 81.7M-word Czech monolingual news cor-pora for additional language model (LM) training. For Arabic  X  English, we used the 65K-sentence LDC2004T18 (news from 2001-2004) for training, the AFP portion of LDC2004T17 (news from 1998, single reference) for development and testing (about 875 sentences each), and the 298M-word English and 215M-word Arabic AFP and Xinhua subsets of the respective Gigaword corpora (LDC2007T07 and LDC2007T40) for additional LM training. All lan-guage models are 4-gram in the travel domain exper-iments and 5-gram in the news domain experiments.
For each language pair, we trained standard phrase-based SMT systems in both directions (in-cluding alignment symmetrization and log-linear model tuning) using Moses (Koehn et al., 2007), SRILM (Stolcke, 2002), and ZMERT (Zaidan, 2009) tools and evaluated using BLEU (Papineni et al., 2002). To obtain word alignments, we used the accompanying Perl code for Bayesian inference and GIZA++ (Och and Ney, 2003) for EM.

For each translation task, we report two EM es-timates, obtained after 5 and 80 iterations (EM-5 and EM-80), respectively; and three Gibbs sampling estimates, two of which were initialized with those two EM Viterbi alignments (GS-5 and GS-80) and a third was initialized naively 9 (GS-N). Sampling set-tings were B = 400 for T  X  E, 4000 for C  X  E and 8000 for A  X  E; M = 100, and L = 10. For refer-ence, we also report the results with IBM Model 4 alignments (M4) trained in the standard bootstrap-ping regimen of 1 5 H 5 3 3 4 3 . Table 2 compares the BLEU scores of Bayesian in-ference and EM estimation. In all translation tasks, Bayesian inference outperforms EM. The improve-ment range is from 2.59 (in Turkish-to-English) up to 2.99 (in English-to-Turkish) BLEU points in travel domain and from 0.16 (in English-to-Czech) up to 0.85 (in English-to-Arabic) BLEU points in news domain. Compared to the state-of-the-art IBM Model 4, the Bayesian Model 1 is better in all travel domain tasks and is comparable or better in the news domain.

Fertility of a source word is defined as the num-ber of target words aligned to it. Table 3 shows the distribution of fertilities in alignments obtained from different methods. Compared to EM estimation, in-cluding Model 4, the proposed Bayesian inference dramatically reduces  X  X uestionable X  high-fertility (4  X  fertility  X  7) alignments and almost entirely elim-inates  X  X xcessive X  alignments (fertility  X  8) 10 .
The number of distinct word-pairs induced by an alignment has been recently proposed as an objec-tive function for word alignment (Bodrumlu et al., 2009). Small dictionary sizes are preferred over large ones. Table 4 shows that the proposed in-ference method substantially reduces the alignment dictionary size, in most cases by more than 50%. We developed a Gibbs sampling-based Bayesian in-ference method for IBM Model 1 word alignments and showed that it outperforms EM estimation in terms of translation BLEU scores across several lan-guage pairs, data sizes and domains. As a result of this increase, Bayesian Model 1 alignments per-form close to or better than the state-of-the-art IBM Model 4. The proposed method learns a compact, sparse translation distribution, overcoming the well-known  X  X arbage collection X  problem of rare words in EM-estimated current models.
 Murat Sarac  X lar is supported by the T  X  UBA-GEB  X  award.

