 ORIGINAL PAPER Emanuele Salerno  X  Francesca Martinelli  X  Anna Tonazzini Abstract The problem of see-through cancelation in digital images of double-sided documents is addressed. We show that a nonlinear convolutional data model proposed else-where for moderate show-through can also be effective on strong back-to-front interferences, provided that the recto and verso pure patterns are estimated jointly. To this end, we propose a restoration algorithm that does not need any clas-sification of the pixels. The see-through PSFs are estimated off-line, and an iterative procedure is then employed for a joint estimation of the pure patterns. This simple and fast algorithm can be used on both grayscale and color images and has proved to be very effective in real-world cases. The experimental results we report in this paper demonstrate that our algorithm outperforms the ones based on linear models with no need to tune free parameters and remains compu-tationally inexpensive despite the nonlinear model and the iterative solution adopted. Strategies to overcome some of the residual difficulties are also envisaged.
 Keywords Document image processing  X  See-through cancelation  X  Nonlinear image models 1 Introduction The see-through distortion can arise from either the transpar-ency of the paper combined with the illumination conditions ( show-through ) or from ink bleeding through the paper ( bleed-through ). Mitigating the effects of interferences can be of moderate importance to a human reader, who is by nature a very skilled pattern recognizer, but becomes impor-tant when an automatic procedure (binarization, optical char-acter recognition, and the like) is supposed to further process the document. For example, we demonstrated [ 18 ] that an effective see-through removal can highly increase the perfor-manceofacommercialcharacterrecognitionapplicationona printed document. However, scholarly reading often requires unwanted interference or degradations to be removed, while maintaining all the other signs of the history and the authen-ticity of a document. We are dealing with one such problem here: we want to remove the interference without altering the other interesting features of the document.

See-through removal can be seen as a classification prob-lem: each side of the document can be partitioned in classes to be treated separately (e.g.,  X  X ackground X ,  X  X ain text X  and  X  X ee-through X ). Conversely, our approach is to assume the existenceofpurefront( recto )andrear( verso )patterns,which superimpose to form the appearance of the document and to estimate them from the observed data. We constrain our solution by using a generative data model. One such model can account for either grayscale or color multispectral data, coming from either the recto alone or both the recto and the verso. This allows us to separate the different patterns even if they overlap spatially, minimizing the alterations to the original appearance. Unfortunately, a realistic and tractable data model is seldom available a priori. Sometimes, it is pos-sible to build a parametric model, to be estimated from the data and from possible prior knowledge. As an example, the appearance can be considered as a linear and instantaneous superposition of the recto and the verso patterns. This means that, at each pixel in one side of the document, the observed colorisalinearcombinationbetweentheoriginalcolorinthat pixel and the original color only in the corresponding pixel of the opposite side. The term instantaneous (or, equivalently, memoryless ) has an obvious origin in the processing of time signals, but is commonly used to denote any pointwise mix-ing model, irrespective of the definition domain involved [ 8 ]. On the basis of one such model, the original recto and verso patterns can be estimated by some blind source separation method, e.g., by independent component analysis [ 16 ]. This can be done from either grayscale recto X  X erso data [ 18 ]or color multispectral, even single-sided, data [ 17 , 19 ]. How-ever, both the linearity and the instantaneousness assump-tions are too simplistic. Indeed, as the recto becomes darker, the see-through contribution to the page appearance becomes weaker; for example, any black stroke in the recto simply covers the possible see-through. See-through must thus be a nonlinear effect. Furthermore, for the capillarity and light-scattering properties of the paper, the see-through in a pixel does not depend only on the corresponding pixel in the oppo-site side, but on an entire neighborhood of that pixel. This is why see-through is also a noninstantaneous phenomenon. As a result, any restoration technique based on a linear and instantaneous model is affected by artifacts. In particular, the linearity assumption often produces unwanted splits in the characters, where they overlap the see-through. Instanta-neousness,inturn,seldomproducesagoodcancelation,since more or less pronounced halos can remain around the zones where the see-through has been removed. Linear instanta-neous models can be useful in some cases, but many authors are trying to overcome their limitations. In [ 12 ], a linear instantaneous model is used, and the separation is achieved by nonnegative matrix factorization, regularized by a sta-bilizer that compensates for the nonlinearity in the overlap zones. To reduce the effects of instantaneousness, a linear convolutive model is proposed in [ 20 ], where the unknown point spread functions (PSFs) are evaluated by a Bayesian strategy.

A way to obtain better results is to adopt a nonlinear data model. To be physically sound, however, such a model should distinguish between the different types of see-through. In [ 13 ], a nonlinear diffusion model of bleed-through is intro-duced, based on the physical mechanism of liquid seep-age in porous media. In [ 15 ], a model of show-through is introduced, based on the transmission of light through the paper and only valid for scanned images affected by mod-erate interference. The diffusion of light is accounted for by a show-through PSF . From the same model, a total-varia-tion-regularized optimization approach is proposed in [ 14 ]. To our knowledge, no physically based model has been pro-posed so far for both the show-through and the bleed-through distortions. In [ 11 ], a clever experiment is designed to esti-mate empirically a class of nonlinear (instantaneous) mod-els, which is then given a parametric form to be estimated by a recursive network. A PSF is included in the network to account for noninstantaneousness. In [ 1 ], the nonlinearity is estimated by a multilayer perceptron. The same estimation strategy is followed in [ 2 ], where a physical model is also introduced, specific for halftone prints. Completely differ-ent strategies are adopted in [ 3 , 22 ], where typical features of both the pure patterns and the observed data are exploited to develop wavelet cancelation techniques.

As far as effectiveness is concerned, we can say that the linear methods can be totally blind and automatic, but are often affected by strong model errors. The nonlinear models, on the other hand, may have problems of uniqueness of the solution [ 6 , 7 ], are normally computationally expensive, and often too specific. The method proposed in [ 15 ] is specifi-cally related to images captured by a (flatbed) scanner with white backing. The nonlinear model introduced, moreover, is exploited in a simplified form that results in an erosion of the characters, and a number of manual choices to be made can introduce further difficulties. Some of these drawbacks can also affect the approach in [ 11 ] when applied to historical documents, since its nonlinearity is based on a preliminary calibration that depends on the properties of the document support.

We believe that, even without a physical meaning, a model of the type proposed in [ 15 ] can account for both show-through and bleed-through. This is why, rather than fur-ther approximating it, we maintain its original form and derive an algorithm that avoids some of the above-mentioned drawbacks and maintains an acceptable computational cost. The see-through PSF, indeed, is estimated only once, so the algorithm is not too expensive. In [ 15 ], the show-through and background pixels are identified by setting appropri-ate thresholds. This can require an experienced operator. Our approach just needs a pure background and a pure see-through areas to be selected, and this can even be done by a non-expert user.

Section 2 introduces the notation used throughout this paper and the data model proposed in [ 15 ], in a slightly more general form. Section 3.1 briefly recalls the solution strategy in [ 15 ] to remark the differences with our approach, which is described in detail in Sects. 3.2 and 3.3 . Section 4 shows some experimental results to validate both the model and the algorithm. Section 5 concludes the paper. 2 A nonlinear data model for see-through Considering a double-sided document affected by back-to-front interferences, let us denote the pure and observed recto and verso patterns by the reflectance maps x r ( i , j ), x pixel index. Strictly speaking, these maps should be obtained by correcting the light intensity values captured by the imag-ing system, taking into account the spectral and spatial features of the illumination. Since this is not our focus, we do not discuss this issue. On the other hand, if the imag-ing system provides a sufficiently uniform illumination, the processing technique we are proposing does not need any photometric correction. Besides the reflectance x ( i , j density D ( i , j ) can be used to represent the images. These two quantities are related through the transformations D ( i , j ) = X  ln x where N denotes the average background reflectance. With no loss of generality, we assume reflectances that belong to a discrete set [ 0 , 1 ,..., N max ] . Then, it is D ( i , j x ( i , j ) = N , D ( i , j )&lt; 0 where N &lt; x ( i , j )  X  D ( i , j ) =+ X  where x ( i , j ) = 0 (i.e., in black pixels). When infinite values must be avoided, we set the reflectance of all the black pixels to 1 rather than 0.

From the mechanism of light scattering in the paper of a document placed in a flatbed scanner with white backing, Sharma [ 15 ] derives the following approximated show-through model
D
D v ( i , j ) = D v ( i , j ) + h ( i , j )  X  X  1  X  e where the indices used are coherent with the ones introduced above for reflectances, the asterisk means linear convolution, and the show-through PSF, h ( i , j ) , takes noninstantaneous-ness into account. The physical approximations exploited to derive this model require that h is much smaller than 1 everywhere. In other words, Eq. ( 2 ) is only accurate when the show-through is weak.

Historical documents are often affected by heavy distor-tions of various origins, including both show-through and bleed-through, and model ( 2 )wouldbeofnousewiththem. However, we observe that this type of model has a num-ber of desirable properties for our purposes. In particular, its nonlinearity can reproduce the effects of any back-to-front interference in the regions where it overlaps the front pattern, and its noninstantaneousness can model approximately both the scattering of light in the paper and the smearing produced by the diffusion of ink. Therefore, we conjecture that a res-toration algorithm based on this model can also be used with heavily degraded documents, even though its physical mean-ing is lost. Its effectiveness, however, can only be assessed experimentally.

To build a model accounting for any see-through effect, we modify slightly the form of Eq. ( 2 ):
D
D v ( i , j ) = D v ( i , j ) + q v r h v r ( i , j )  X  X  1  X  With respect to Eq. ( 2 ), this model allows the see-through PSFs to be different on the two sides, thus accounting for pos-sible anisotropies. The back-to-front and front-to-back PSFs, respectively, have been split as the products q r v  X  h r two space-invariant kernels, h r v ( i , j ) and h v r ( i unit volume, that is: Parameters q r v and q v r , multiplied by the maxima of h and h v r , respectively, are the levels of interference from one side to the other. Following our conjecture, model ( 3 ) does not require q r v  X  h r v and q v r  X  h v r to be much smaller than 1 everywhere: heavy interference is allowed.

It is easy to see that, for Eqs. ( 2 ) and ( 3 ) to be valid, each pair of corresponding pixels in the recto and verso maps must refer to the same spatial location. This is because the location of each pixel in one side must match the possible interfer-ence it produces in the opposite side. To do such a matching, we must first flip horizontally one of the document sides. Hereafter, we take the recto as our reference, thus D obs and D v ( i , j ) are the verso density maps after horizontal flip-ping. A perfect match, however, is difficult to obtain, for the finite precision of the image capture system. This is why, after horizontal flipping, all the data images must be spatially registered (see [ 3 , 19 , 21 ]). 3 See-through removal 3.1 A simplified strategy [ 15 ] To build the density maps, the average background reflec-tances of both the recto and the verso, N r and N v ,must be evaluated. This can be done by selecting areas where no other pattern than background is present. Then, if model ( 2 ) is assumed, the unknown to be estimated to extract the pure recto and verso patterns is the PSF h . The pure patterns can then be evaluated by solving the resulting nonlinear system. This is not a quick task, even if h is known perfectly. To develop a fast restoration algorithm, Sharma [ 15 ] proposes to compute the interference terms in his model by using D and D obs v rather than D r and D v . The problem thus becomes to find D r and D v from D obs r and D obs v , and from the genera-tive relationships (hereafter, we drop the pixel indices when unnecessary)
D
D v = D v + h  X  X  1  X  e It is apparent that this problem is much easier to solve than the one based on Eq. ( 2 ), since the pure patterns can sim-ply be obtained by subtracting the interference terms from the observed data, once h has been estimated. The main advantage, however, is that the two equations in ( 5 )arenow decoupled, so recto and verso can be treated independently. This entails that the isotropy assumption made by introduc-ing the same PSF in the recto and verso equations can be relaxed. Indeed, in [ 15 ], h is not estimated explicitly: all the show-through pixels are  X  X ushed X  toward the background value by adaptive filtering, thus obtaining the effect of a spa-tially variant kernel rather than a stationary PSF. Along with these advantages, this strategy has a main disadvantage that descends directly from substituting D r and D v with D obs D v : the interference terms in ( 5 ) do not arise from the show-through pattern alone, but also from the main pattern. The result is that, when the back-to-front interference is strong, the strokes in the main pattern are somewhat  X  X roded. X  The method proposed in [ 15 ] thus needs a weak show-through to justify both model ( 2 ) and its simplified solution strat-egy. Another disadvantage is that the identification of show-through and background pixels depends on thresholds that could be difficult to choose for heavily degraded documents. 3.2 Off-line PSF estimation To avoid the drawbacks of Sharma X  X  approach, we chose to adopt the generalized model ( 3 ), with no further approxi-mation. A popular approach to restoration, then, is to start from a reasonable initial guess and exploit the model rela-tionships to refine all the parameters iteratively. Since this can lead to expensive algorithms [ 10 ], in this paper, we exploit the possibility of estimating q r v , q v r , h r v , and h v and then estimate D r and D v iteratively. In other words, the PSFs are estimated before starting the restoration, and the system obtained from ( 3 ) is then solved iteratively with fixed q r v , q v r , h r v , and h v r .Todothis,wemustidentifytwo regions where pure see-through is present, one in the recto and one in the verso. Any non-expert user is normally capa-ble to recognize such regions, so this does not limit the scope of our method. Let us assume we have an area, say, in the recto, where D r is zero and D v is not identically zero. From ( 3 ), we obtain D The corresponding equation for a pure see-through area in the verso is obtained by exchanging the subscripts r and v Equation ( 6 ) allows qh to be estimated by constrained least squares: qh = arg min
The first squared norm in brackets is a data fit term, whereas the second squared norm constrains the solution to be regular to some degree, identified by operator L , and parameter  X  weighs the influences of data fit and regularity on the solution. Equation ( 7 ) can be solved for qh , choos-ing  X  so that the residual square norm equals the energy of the noise [ 4 , 9 ]. What we need is thus the noise power and a suitable regularization operator L . As the noise power, we assume the variance of the recto background reflectance around its mean N r . As the regularizing operator, we choose the Laplacian, which enforces second-order smoothness in the solution. The support of qh is initially assumed to coin-cide with the selected see-through area. Once the estimation is complete, we could use the normalization condition ( 4 )to evaluate q . Actually, the estimated qh normally assumes sig-nificant values in a restricted area around its maximum and, since positivity is not enforced, it could also assume physi-cally meaningless negative values. Thus, we compute q after restricting appropriately the support of h and truncating all its negative values. From ( 6 ), it is also immediate to note that, in each see-through pixel, we have q which gives us another tool to estimate q once h is available. This equation could allow us to introduce a nonstationarity in q while keeping h unchanged over the whole page.
In many cases (in most cases when only show-through is present), it is reasonable to assume a common shape for the PSFs that appear in ( 3 ). If the two sides are registered per-fectly, then it is h r v = h v r = h . However, a possible residual displacement, ( i 0 , j 0 ) , between D obs r and D obs v duce h r v ( i , j ) = h ( i + i 0 , j + j 0 ) , and h v r i , j  X  j on one side and derive the PSF on the other side by just trans-lating it. 1 Small registration errors can thus be corrected. In documents made of more than one folio, it is difficult for any imaging system to produce the same registration error for all the folios. Moreover, many historical documents show very diverse degradations in different pages. This is why, except possibly in special cases, the estimation of the see-through PSFs must be repeated for each folio. 3.3 Iterating recto and verso restoration From ( 3 ), we obtain
D Once suitable estimates of q r v,v r and h r v,v r are available, Eq. ( 9 ) can provide a number of iterative schemes to esti-mate D r and D v (see also [ 5 ]). For example, set D ( 0 scheme is
D
D where the lower density bounds D ,v = X  ln prevent the solution from going out of the allowed range [ 0 , 1 ,..., N from ( 11 ) using the intensity values x obs , max r ,v as approxima-tions to x max r ,v , or set to different values (for example, zero, i.e., by definition, the average background density value). The criterion we use to stop the iteration is based on the norm of the difference between two consecutive estimates. In a large majority of our experiments, convergence has been reached by less than ten iterations. In principle, the final solu-tion may depend on the initial guess. So far, however, we have been reaching good results in nearly all the cases, including artificial tests constructed so to have perfectly transparent paper. 4 Validation and experimental results We have been testing extensively the restoration scheme ( 10 ) on both simulated and real data images. The simulated exper-iments do not give us an ultimate proof of practical applica-bility, but allow us to perform quantitative evaluations on ground-truth data. The real-world cases reported here are intended to demonstrate qualitatively the effectiveness of the strategy we are proposing and its advantages over lin-ear methods. Such comparisons would be unfair on simulated data, sincethesearebuilt exactlythroughmodel ( 3 ). Notethat all the derivations presented in this paper are applied to scalar images, whereas the algorithm can be applied separately for each channel of an RGB image, thus recovering the original document colors. Some of the experiments shown here are made on color images to demonstrate this possibility. 4.1 Simulated experiments Figure 1 reproduces some of the synthetic images we used to perform our tests. 2 All the data were generated by the sym-metric version of model ( 3 ), with the same pure patterns, increasing values of q (from left to right in the figure), and increasing apertures (  X  ) of a truncated Gaussian see-through PSF (from top to bottom in the figure). The results produced by our algorithm on these data are shown in Fig. 2 . These can be compared immediately, and quantitatively, with the cor-responding results of the algorithm proposed in [ 15 ], since both techniques are based on the same model. Indeed, by a single iteration of our scheme ( 10 ), we are able to repro-duce the best results attainable by the algorithm in [ 15 ]. We have just to introduce the ideal values for q r v,v r and h ( 10 ). Hereafter, we denote these results as  X  X harma results. X  The typical differences they show when compared with our results are illustrated in Fig. 3 . Apparently, the text strokes in the Sharma results are eroded because the main text, which should not take part in see-through cancelation, is present in the interference term of Sharma X  X  approximated model ( 5 ) and is then subtracted in part from the image to be restored.
An appropriate measure for the capability of suppress-ing interferences is the signal-to-interference ratio (SIR [ 1 ]), defined as the ratio between the energy of the reconstructed image and the energy of the difference between the recon-structed and the original images. Table 1 shows the SIR val-ues obtained on the set of results partially reproduced in Fig. 2 , compared with the corresponding Sharma results. In Fig. 4 , we also report the results obtained by fixing q = and  X  = 1, and letting the graylevel of the characters in the verso vary from 0 to 100. This set of experiments is useful to evaluate the effectiveness of our off-line PSF estimation against the color of the characters that show-through. In all of these 101 experiments, we chose the same background and puresee-throughestimationareas.Whereasthesuperiorityof our results over Sharma X  X  results is apparent, we observe that the plot obtained by our method is rougher than Sharma X  X . This is because our algorithm estimates the PSFs at each experiment, while the Sharma values are always obtained through the theoretical q r v,v r and h r v,v r .
 We also give a quantitative evaluation of our estimated PFSs. For q r v,v r , we use the percent deviation,  X  q , with respect to the original value. A comparison between the esti-mated and the original PSFs is not so straightforward but, if we admit that they have a single peak and no oscillations, a good quality index can be the percent deviation  X   X  , given by  X  where the summation is performed over the entire support of h ,( i tion ( 4 ) is assumed to hold true. The values obtained for Table 2 .

Besides interference suppression, a restoration algorithm should also be evaluated on its fidelity, that is, the similarity of its results to the originals. A popular measure for fidel-ity is the root-mean-square error (RMSE). In our case, since the data images are mostly white, this measure would not let us appreciate the apparent differences shown, for example, in Fig. 3 . For this reason, we chose to compute the RMSE between the original and the restored images by only tak-ing into account the area occupied by characters. In Table 3 , we report the RMSE values corresponding to the results in Table 1 . As done with the SIR, we also evaluated the RMSEs resulting from varying the verso graylevels. Figure 5 shows the RMSEs corresponding to the cases in Fig. 4 . These results confirm the superiority of our algorithm over the one in [ 15 ]. 4.2 Real-world experiments The first real-world example we show here (Fig. 6 )is concerned with a paper manuscript affected by significant see-through and is intended to compare the results obtained by the technique proposed here and the ones coming from linear instantaneous blind source separation as suggested in [ 18 , 19 ]. The linear instantaneous results are shown in the upper half of Fig. 7 . All the drawbacks mentioned are appar-ent: (a) there is a significant see-through residual and (b) the instantaneous model and the registration errors produce halos around the removed strokes. The result obtained by the technique proposed here on the same data is shown in the lower half of Fig. 7 . As anticipated, there are no halos left. This can be observed more easily in Fig. 8 , where a small portion of the two results is magnified. In both the linear and the nonlinear solutions, there are patterns that do not come from the verso side but appear by transparency from the next manuscript page. These can be seen as bluish strokes in the recto side. As any other non-see-through pattern, they are not accounted for in our model, and cannot be removed, unless additional color image processing is performed (as done, for example, in [ 17 , 19 ]).

Figure 9 shows a case where the manuscript is affected by heavy distortions, the interferences between recto and verso areduetobothshow-throughandbleed-through,andthemix-ing is nonstationary. Here, model ( 3 ) loses its physical mean-ing, and neither linear techniques nor the algorithm proposed here work well unless a way to introduce nonstationarity is found. The results obtained by our procedure are interest-ing anyway: the see-through patterns have not been removed completely, but a significant enhancement in readability has been obtained. For example, the stamp that shows through in the recto lower-right corner has been completely removed, and the spreading of ink has been significantly reduced. No free parameter must be set to estimate the PSFs. It is suffi-cient to select a pure see-through area, where Eq. ( 6 ) holds true. In Fig. 10 , we show, on the left, the one selected in this case and, on the right, the corresponding region in the opposite side. By comparing them visually, a slight misalign-ment of the recto and verso patterns can be noted. As men-tioned, this corresponds to a small registration error, which can be corrected by our procedure. In Fig. 11 , we show the see-through PSF, h r v , estimated in the red channel. Its peak is off-center by ( + 3 , + 4 ) pixels. The see-through PSFs are normally different in different channels, because the optical and geometric features of the capture setup may be chan-nel-dependent [ 19 ]. Since there is no qualitative difference, however, we do not show here the PSFs estimated in the other channels.

The third example comes from a grayscale two-sided scan of a printed document showing see-through, stains, and a rather nonuniform background, with different average lev-els on the recto and verso sides. The observed and restored images are shown in Fig. 12 . The see-through has been effec-tivelyreduced,whereasthepatternsthatdonotoriginatefrom a recto X  X erso interference have not been affected. This is the case, e.g., with the large stain in the verso, the handwrit-ten strokes in the recto, and with the words  X  X NNALI X  and  X  X CONOMIA, X  barely visible in the recto as the result of a transparency from the next page of the document. 5 Conclusion In [ 15 ], a nonlinear mathematical model of the show-through affecting scanned images of double-sided documents is intro-duced. The show-through cancelation algorithm proposed, however, just relies on a simplified version of this model. Here, we propose to use that model in its original form, and conjecture, heuristically, that a slight generalization can account for even strong see-through interferences of whatever origin.
Rather than linearizing the model or approximating the maps of the interfering patterns, we propose a restoration procedure where the see-through PSFs are estimated off-line and the images are restored iteratively through the nonlinear model equations. Our experiments show that this overcomes several drawbacks suffered by other strategies. Moreover, the method we propose is not computationally expensive: the time it requires to run on a 3GHz X 3.50GB Pentium D computer is a few tens of seconds at most, with real RGB images such as the ones presented here (1 X 8Mpixels per channel). Our procedure is easy to implement and does not require particular skills from the operator. No threshold or any other free parameter must be set.

Future improvements should include a strategy to cope with nonstationarity. Exploiting the locality of our method (the support of any physically reasonable PSF is much smaller than the image domain), a first, empirical, response to this problem can be to partition the image into subdo-mains where stationarity is approximately valid. However, the problem of nonstationarity becomes particularly difficult when both show-through and bleed-through are present. In these cases, we should expect at least three different shapes for the PSFs in the same recto X  X erso pair, and a strategy to choose automatically the correct one at each pixel could be difficult to envisage. At the expense of a considerable increase in computing, a neat and general solution would be to use the data to estimate space-varying see-through ker-nels. A strategy that requires less computation and could improve the performance anyway is to let h r v,v r be spatially invariant and exploit Eq. ( 8 )tomake q r v,v r spatially variant. This would not be effective, however, in the cases where the PSFs can assume completely different shapes.
 References
