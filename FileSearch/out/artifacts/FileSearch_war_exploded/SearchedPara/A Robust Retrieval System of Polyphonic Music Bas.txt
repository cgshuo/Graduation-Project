 Retrieval systems for polyphonic music rely on the auto-matic estimation of similarity between two musical pieces. In the case of symbolic music, existing systems either con-sider a monophonic reduction based on melody or propose algorithms with high complexity. In this paper, we propose a new approach. Musical pieces are represented as a sequence of chords which are estimated from groups of notes sound-ing at the same time. A root and a mode are associated to each chord. Local alignment is then applied for estimating a similarity score between these sequences. Experiments per -formed on MIDI files collected on the Internet show that the system proposed allows the retrieval of different versions o f the same song.
 H.5.5 [ Information Systems ]: HCI X  Sound and Music Computing Experimentation
The number of digital musical pieces available on the In-ternet is always growing. New interfaces for browsing and recommending music in large databases have to be developed for users, since retrieval systems based on textual queries im-pose a prior knowledge of the properties of musical pieces. Researches about Music Information Retrieval involve pro-posals of new retrieval systems [9]. One of the major issue is the automatic estimation of the similarity between musi-cal pieces. Since existing works generally concern Western music, four main characteristics of the music are considere d: rhythm, timbre, melody and harmony. In this paper we fo-cus on symbolic music (music represented as musical events) and on tonal properties, i.e. harmony.

Existing systems for estimating the symbolic melodic sim-ilarity generally deal with monophonic music [8, 12]. Adap-tations of geometric [7] or string-matching algorithms [3] to polyphonic music have recently been proposed. Some sys-tems consider a monophonic reduction of the musical piece compared. Others propose adaptations which increase the complexity of algorithms [4, 10] and thus prevent their ap-plication to large databases. For example, a possible way  X 
This work is part of the SIMBALS project (JC07-188930), funded by the French National Research Agency.

Errors (semitones) 1 2 3 4 5 6 Table 1: Type of errors (in % of total errors) re-garding the root of the estimated chord. When the estimated root does not the match the ground truth, a distance is calculated between the estimated root and the correct root. This distance is in semitones. successfully adapted for melodic similarity comparison pu r-poses [8]. A first approach for audio chord sequences com-parison has also been presented in [1]. We propose to com-pute substitution scores regarding the errors due to the cho rd analysis process (see Table 1). These scores also take into account the difference between modes.
Experiments are performed using 1000 symbolically en-coded musical pieces, collected on the Internet and checked for quality. Among them, 150 MIDI files represent versions of 43 different songs, forming 43 classes of songs. Versions can differ in a number of ways: differently sequenced, cov-ers of the same song or a few cases of plagiarisms. Ex-act copies of files have been deleted from the database by first comparing files using the diff Linux command, but also by applying the retrieval system proposed: if the similar-ity score between two musical pieces is estimated as max-imum (i.e. the similarity score of one of the piece com-pared to itself), one of the musical pieces is deleted. List o f MIDI files and detailed results are available at http://dept-info.labri.fr/~hanna/SIGIR .

Table 2 shows the results of the experiments performed by considering each version as a query. The total number of tests is 150. For each query, the corresponding C  X  1 ver-sion(s) is(are) expected to be retrieved at the first rank(s) . Columns of Table 2 show the average first tier and second tier per class, recall at top 10 and top 20. The first tier is the number of correctly retrieved songs within the best ( C  X  1) matches divided by ( C  X  1), where C is the number of ver-sions of the same song [2]. The second tier is the number of correctly retrieved songs within the best (2 C  X  1) matches divided by (2 C  X  1). Recall at top 10 is the number of cor-rectly retrieved songs within the best 10 matches, divided by ( C  X  1).

The average first tier is 0 . 68 and indicates that the re-trieval system is quite accurate. Songs of 19 classes allow the retrieval of every corresponding song at the first best matches. One third of the query songs (51 over 150) gives all the corresponding versions at the first best matches. More than 75% (116 over 150) queries allow the retrieval of at least one corresponding version at the first rank. The aver-age Mean Reciprocal Rank of the first correct piece is 0 . 80. Errors occur when musical differences between the songs compared are important. For example, we tested our system with two versions of the Coldplay song Viva la Vida and the Joe Satriani song If I Could Fly which has been estimated as very similar by many listeners. Our system correctly esti -mates the two versions of Coldplay song as very similar, but different from the Joe Satriani song, because the differences are complex (different musical structures, different verses , etc.).
In this paper, we propose a robust retrieval system for symbolic polyphonic music. Whereas existing systems mainl y rely on monophonic reduction by analyzing the main melody,
