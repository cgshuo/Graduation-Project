 During the past several years, fuzzy sets and fuzzy inference systems have reached a popular level within technology, especially fuzzy control based on different kinds of fuzzy inference systems has emerged as one of the most active and fruitful areas for research. Fuzzy if-then rules are an appropriate form to describe the human knowledge under the uncertainty due to fuzziness. On the other hand, the uncertainty due to randomness can be dealt with by the theory of probability (subjective or objective), and the human knowledge under this situation can be represented by the probability distributions. It should be clear that fuzzy sets and probability can live side by side in providing tools for uncertainty analysis in complex, real-world problems[1, 2, 4, 7, 8, 9, 11].
 there is a great need of learning, and tuning the fuzzy if-then rules and associated parameters to achieve a desired level of performance. In order to tune only a particular rule, the fuzzy inference system is extended and each rule is assigned an importance factor or certainty factor, this factor has been explained by many researchers the degree of truth of a rule [10], and some experiments manifest that the importance factor enhances the robustness, flexibility and modelling capability of the system [6].
 if-then rule associates a factor, but here the factor is interpreted as the condi-tional probability of the consequent given the premise, it means how certain the casual relationship between the premise and the consequent is, so in this pa-per the importance factor or certainty factor is named as the probability factor. The experiments manifest this fuzzy inference system with probability factor is efficient.
 our fuzzy inference system with probability factor. We introduce the quasi-newton optimization technique and adopt it in the learning process of fuzzy inference system with probability factor. Finally, this new fuzzy model is ap-plied to the data minin g  X  a time series prediction. There are two types fuzzy inference systems: Mamdani-type and Sugeno-type. These two types of inference systems vary somewhat in the way outputs are determined. In this investigation we use Mamdani-type fuzzy inference system. represent the non-linear function by a collection m  X  X ules X  of the form where if X j is the universe of discourse of U j then A ij is a fuzzy subset of X j and with Y the universe of discourse of V then B i is a fuzzy subset of Y . And r =1 , 2 ,...,m , m is the total number of rules,  X  r (0 &lt; X  r  X  1) is the importance factor or certainty factor of the r th rule.
 the value U j = x j for j =1 ,...,n . The procedure for reasoning consists of the following steps: 1. Calculate the firing level of each rule  X  i 2. Associate the importance or certainty factor  X  i with  X  i 3. Calculate the output of each rule as a fuzzy subset F i of Y where 4. Aggregate the individual rule outputs to get a fuzzy subset F of Y where 5. Defuzzify the aggregate output fuzzy subset Let P is a probability measure over R n . Then, the probability of a fuzzy event A is defined by the Lebesgue-Stieltjes integral: The nodes can be the linguistic variables which have a finite number of possible linguistic values. And this graph has two levels of nodes (see Fig.1). There are n nodes representing the linguistic variables U 1 ,...,U n in the first level nodes; and just one node representing the linguistic variable V is in the second level. There is a conditional probability table (CPT) assigned to the node V , this CPT includes the probabilities P ( V | U 1 ,  X  X  X  ,U n ) of all possible instantiation of V and U ,...,U n . In fact this directed graph also represents a fuzzy rule-base which is a multiple input and single output, the first level nodes represent the input variables, and the node in the second level means the output variable. So for any instantiation of input variables U 1 = A r 1 ,...,U n = A rn and output variable V = B r , there is a corresponding fuzzy if-then rule: where for each j , { A rj for all r } is the fuzzy partition of the universe of discourse X j of input variable U j , and { B r for all r } is the fuzzy partition of the universe of discourse Y of the output variable V . Here p r is the conditional probability of the variable V given its parents: an estimate method of p r . Let there exists a training data set TD in which the i th element is a n + 1-dim vector [ X i y i ], and X i is n -dim vector x 1 i ,...,x n i . So we have where { B j } is the collection of all fuzzy subsets in Y . And [ X i y i ] is the element using a directed graph. The factor of each rule is the conditional probability of the consequent given the premise. We construct the fuzzy inference system with probability factor to predict a time series that is generated by the following Mackey-Glass (MG) time-delay differential equation. search communities [5]. The training data set and checking data set used in this experiment are shown in [3]. 4.1 The Initial Model FISP This system has four input variables and one output variable. We assume that the  X  X nd X  operator is production and the domain interval of the i th input variable U i let K i = 3. Then the 4-dim input space is divided into 3 4 = 81 fuzzy subspaces: And the domain interval of the output variable V is divided into 3 fuzzy sets labelled as B 1 ,B 2 ,B 3 . The gauss-shaped fuzzy sets A j i i and B i are adopted: 500 data values to compute the conditional probability of each rule, for each i =1 , 2 , 3 considering all rules whose consequents involve the fuzzy set B i ,we select 2 rules whose conditional probabilities are the largest to construct the final fuzzy rule-base. So the final fuzzy rule-base has 6 rules whose conditional probabilities are larger. Then we use this fuzzy rule-base to reason, the prediction result is shown in Fig.2. This figure shows that the fuzzy inference system with probability factor can memorize the shape of the data set, and can predict the changing tendency of data values with time.
 abilities are enough large is necessary. Fig. 2 illustrates the prediction output of the FISP which includes all possible rules (the total number is 3 5 = 243), it X  X  clear that the performance is bad. 4.2 Learning Process of FISP In order to improve the prediction precision further, we will adjust the parame-ters ( a,  X  ) which determine the fuzzy partitions of the input and output spaces. Here we take the quasi-newton optimization technique.
 where y i is the predicted output of the inference system, and y i is the expected output in the training data set.
 Newton methods. Because in each iteration the structure of the fuzzy rule-base changes, the gradient information of E can not be supplied analytically, we derive the partial derivatives using a numerical differentiation method via finite differences. This involves perturbing each of the design parameters ( a,  X  ) in turn and calculating the rate of change in the objective function. After 70 iteration, we get the desired performance, Fig. 3 shows the prediction result, it is hardly to distinguish the difference of the predicted output and the expected output. In this paper we discuss the inner relationship between the body of the fuzzy rule and its associated factor. The factor of a fuzzy rule is interpreted as the conditional probability of the consequent given the premise. In order to compute the probability factor in this kind of fuzzy inference system, a computing method is given in this paper.
 This work has been supportedbyNatural Science Foundationof Zhejiang Province, China Postdoctoral Science Foundation (No. 2003034514), Department of Edu-cation of Zhejiang Province (No. 20040115), National Natural Science Founda-tion of China (60475025).

