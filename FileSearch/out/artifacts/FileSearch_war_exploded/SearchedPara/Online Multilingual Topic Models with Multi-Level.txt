 Bag of words models simplify the representation of documents by discarding grammatical information and simply relying on document-level word cooc-currence statistics. Topic models, such as latent Dirichlet allocation (LDA) (Blei et al., 2003), use this representation. A major drawback of the bag of words representation, especially in collections of large documents, is that the word co-occurrence statistics are computed on a document level and as such they do not capture the effect of words co-occurring close to each other versus words co-occurring further apart.

One alternative approach to longer documents that has received attention in the past has been to directly model local X  X .e., Markov X  X ependencies among tokens. For example, the topical n-gram model (TNG) introduced by Wang et al. (2007) models unigram and n-gram phrases as mixture of topics based on the nearby word context. More recently, Jameel &amp; Lam (2013) proposed an LDA extension that uses word sequence information to generate topic distribution over n-grams and per-forms topic segmentation using segment and para-graph information. While these and many other ap-proaches offer a better and more realistic modeling of word sequences, they don X  X  model topical varia-tions across document sections either in mono-or multilingual collections.

In this paper, we focus on hierarchical models for improving topic models of long documents. In the past, document-topic based hierarchical prior struc-tures have been explored for LDA. For example, Wallach et al. (2009) showed that Gibbs sampling implementation of asymmetric Dirichlet priors pro-vide better modeling of documents, across the whole collection, compared to the original LDA approach. More recently, Kim et al. (2013) introduced tiLDA, a topic model of monolingual document collections with nested hierarchies. In order to achieve reason-able performance over large document collections with deep hierarchies, tiLDA utilizes parallel vari-ational Bayes (VB) inference. While VB is known to converge faster than Gibbs sampling, and paral-lel implementations are even faster, they, as with Gibbs sampling, still require multiple iterations over the whole collection besides the overhead of paral-lelizing the model parameters. Furthermore these approaches focus on monolingual collections.
We propose an online VB inference approach for topic models that captures the document specific ef-fect of local and long range word co-occurrence by modeling individual document sections using multi-level Dirichlet prior structure. The proposed models assign Dirichlet priors to individual document sec-tions that are coupled by a document level hierarchi-cal Dirichlet prior which facilitates explicit model-ing of the variation in topics across documents in mono-and multilingual collections. This in turn streamlines the use of topic models in collections of large documents where there is a predetermined section structure. Our contribution is twofold: (1) we present an online VB inference approach for topic models with multi-level Dirchlet prior struc-ture and more importantly (2) introduce a polylin-gual topic model (PLTM) with multi-level hyperpri-ors (mlhPLTM) which is capable of efficiently mod-eling topical variations across document sections in large multilingual collections. The original LDA model and its multilingual vari-ant, PLTM, use symmetric Dirichlet priors over the document-topic distributions  X  d and topic-word dis-tributions  X  k which means that the concentration pa-rameter  X  of the Dirichlet distribution is fixed and that the base measure u across all topics is uni-form. Symmetric Dirichlet priors assume that all documents in the collection are drawn from the same family of distributions. This assumption is not suit-able for collections of documents that cover a di-verse set of topics. In the past this issue has been addressed with asymmetric priors where the base measures are non-uniform. One way to assign asym-metric priors to individual documents is to treat the base measures vector u as a hidden variable and assign a symmetric Dirichlet prior to it which cre-ates a hierarchical Dirichlet prior structure over all document-topic distributions in the collection. This approach was used by Wallach et al. (2009). Unlike Wallach et al. (2009), who use a single document-topic distribution  X  d , we introduce section-topic dis-tributions  X  s . The existing symmetric Dirichlet prior over  X  d creates a hierarchical Dirichlet prior over  X  s (  X  =  X  d , X  s In this setting the most widely used approach for es-timating  X  d is Minka X  X  (2000) fixed-point iteration approach which is also used in (Kim et al., 2013). Instead we use a more efficient approach for estimat-ing the Dirichlet-multinomial hyperparameters by approximating the digamma differences in Minka X  X  approach which was showcased in (Wallach, 2008) to be more efficient. Figure 1 shows the graphical model representation (left) of our model, which we refer to as multi-level hyperpriors LDA (mlhLDA), along with the free variational parameters for ap-proximating the posteriors (right). 2.1 Inference using Online VB Due to its ease of implementation, the most widely used approach for inferring LDA posterior distri-butions is Gibbs sampling (Griffiths and Steyvers, 2004). For example, this approach was used by Wallach et al. (2009) and was originally used for PLTM. On the other hand the VB approach (Blei et al., 2003) offers more efficient computation but as in the case of Gibbs sampling requires iterating over the whole collection multiple times (e.g. Kim et al. (2013)). More recently Hoffman et al. (2010) in-troduced online LDA (oLDA) that relies on online stochastic optimization and requires a single pass over the whole collection. The same approach was also extended to PLTM (oPLTM) (Krstovski and Smith, 2013). In our work we also utilize online VB to implement multi-level hyperprior (mlh) structure in LDA and PLTM. Similar to batch VB, in online VB locally optimal values of the free variational pa-rameters  X  and  X  , which are used to approximate the posterior  X  and z , are computed in the E step of the algorithm but on a batch b of documents d i (rather than the whole collection D as in the case of batch VB) while holding the topic-word variational parameter  X  fixed. In the M step,  X  is updated using stochastic gradient algorithm by first computing the optimal values of  X   X  using the batch optimal values of  X  b :  X   X  kw =  X  + D combined with value of  X  computed on the previous batch through weighted average: When computing the section-topic variational pa-rameters we follow the proof of the lower bound which was derived by Kim et al. (2013). This lower bound, which is looser than the original VB Evi-dence Lower Bound (ELBO), allows for the batch VB approach to be used with asymmetric priors. More specifically, given the document-topic varia-tional parameter  X  dk in the E step of our online VB approach the update for the section-topic variational parameter  X  sk becomes: Given an aligned multilingual document tuple, PLTM assumes that: (1) there exists a single tuple-specific distribution across topics and (2) sets of lan-guage specific topic-word distributions. Each word is generated from a language-and topic-specific
We extend this model by introducing sections spe-cific topic distributions  X  s across the different lan-guages in the tuple which are coupled by the tuple specific document-topic distribution  X  d .

Given a collection of document tuples d where each tuple contains l documents that are translations of each other in different languages, mlhPLTM as-sumes the following generative process. For each language l in the collection the model first gener-ates a set of k  X  { 1 , 2 ,...,K } topic-word distribu-w z Dirichlet (  X  l ) . For each document d l with s d sec-tions in tuple d , mlhPLTM then assumes the follow-ing generative process:  X  Choose  X  d  X  Dir. (  X  d )  X  For each section s d in document tuple d :  X  Choose  X  s  X  Dir. (  X  s  X  d ) Figure 2 shows the graphical representation of mlh-PLTM. The free variational parameters for the on-line VB approximation of the posteriors are shown in Figure 3. We explore the ability of mlhLDA to model vari-ations across document sections found in scientific articles using a collection of journal articles from the Astrophysics Data System (ADS) (Kurtz et al., 2000). Our collection consists of 130k training ar-ticles (888,346 sections) and a held-out set of 8,078 articles (54,502 sections). Figure 4 shows an exam-ple mlhLDA representation of an ApJ article with 100 topics. Shown on the top is the inferred topic representation of the whole document (  X  d ) which, in the mlhLDA model, serves as a prior for the section-topic distributions (  X  s ). Shown on the bottom are ex-amples of 2 article sections (out of 7), their inferred topic distributions along with the top 10 words for each of the top 3 section topics.
The left side of Figure 5 shows the held-out per-plexity comparison between oLDA and mlhLDA across 13 different topic configurations. For this set of experiments we used the above training set of 130k articles and the set of 8,078 held-out arti-cles. From these comparisons we clearly see the ad-vantage of using the multi-level Dirchlet prior struc-ture. Another way of evaluating topic models is through an extrinsic evaluation task which was not available for this collection. In the case of oLDA, ar-ticle sections were treated as individual documents. ument concentration parameter  X  d was set to 1 which we also use in our case for both the sym-metric  X  d and asymmetric  X  s (same goes for PLTM and mlhPLTM). Since in our case we perform rel-ative comparison between oLDA and mlhLDA we weren X  X  concerned with experimenting with differ-ent concentration parameters but we rather used the default one implemented in oLDA.

With a random subset of 10k training and 1k held-out articles we compared the performance of oLDA tation of Blei et al. (2003). Unlike the implemen-tations of oLDA and mlhLDA which are written in Python the original VB algorithm is written in C and requires multiple iterations over the whole collec-tion. The right side of Figure 5 shows the speed (in natural log scale) vs. perplexity comparison across the three models. We compared the modeling performance of oPLTM and mlhPLTM on a subset of the English-Spanish Europarl collection (Koehn, 2005). The subset consists of  X  64k training pairs of English-Spanish speeches that are translations of each other which originate from 374 sessions of the European Par-liament (Europarl) and a test set of  X  14k speech translation pairs from 112 sessions. With oPLTM we modeled individual speech pairs while with mlh-PLTM we utilized the session hierarchy and mod-eled pairs of speeches as document sections. Com-parisons were performed intrinsically (using per-plexity) and extrinsically on a cross-language infor-mation retrieval (CLIR) task. This task, along with the Europarl subset, have been previously defined by Mimno et al. (2009) and used across other publica-tions (Platt et al., 2010; Krstovski and Smith, 2013). Given a query English speech, the CLIR task is to re-trieve its Spanish translation equivalent. It involves performing comparison across topic representations of all Spanish speeches using Jensen-Shannon diver-gence and sorting the results. Models are evaluated using precision at rank one (P@1). Figure 6 shows the CLIR task performance comparisons results us-ing 13 different topic configurations. We performed comparisons across three different settings of the concentration parameters  X  d and  X  s (  X  d =  X  s = 1 and 1.0).
Across the different concentration parameter val-ues and across the 13 different topic configurations we observe that the performance of oPLTM fluc-tuates as we increase the numbers of topics. On the other hand, across the three different concen-tration parameter settings, mlhPLTM performance is very steady and tends to increase with the num-ber of topics. Across the different topic configura-tions both models provide the best performance with  X  d =  X  s = 0 . 4 . Setting the concentration parame-ters to 1
In our initial experiments we unintentionally re-ordered our set of training Europarl sessions based on two digit years which was different from the experimental setup in (Mimno et al., 2009) and (Krstovski and Smith, 2013) where the order of the presentation data (Europarl speeches) was chrono-logical. This emphasized the fact that in online VB, order of presentation of documents plays an impor-tant role especially in the training step where the model learns the per topic-word distributions. Fig-ure 7 shows the performance comparison results be-tween oPLTM and mlhPLTM when documents in the training and test steps are ordered numerically. In our initial experimental setup concentration pa-rameters where set to  X  d =  X  s = 1 the perplexity comparison between the two models. The CLIR task performance comparisons results are shown on the right. Unordered mlhPLTM achieves high P@1 after 2,000 topics. While it takes much longer in terms of the number of topics unordered mlhPLTM ultimately achieves similar performance results as ordered mlhPLTM. We presented online topic models with multi-level Dirichlet prior structure that provide better model-ing of topical variations across document sections in mono-and multilingual collections. We showed that documents with rich sub-document level structure could be modeled with higher likelihood compared to regular online LDA and PLTM models while of-fering the same efficiency. Furthermore on the task of retrieving document translations we showed that mlhPLTM achieves significantly better retrieval re-sults compared to online PLTM.
 This work was supported in part by the Harvard-Smithsonian CfA predoctoral fellowship, in part by the Center for Intelligent Information Retrieval and in part by NSF grant #IIS-0910884. Any opinions, findings and conclusions or recommendations ex-pressed in this material are those of the authors and do not necessarily reflect those of the sponsor.
