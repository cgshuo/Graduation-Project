 Social networks have already emerged as inconceivably vast information repositories and have provided great opportuni-ties for social connection and information di usion. In light of these notable outcomes, social prediction is a critical re-search goal for analyzing and understanding social media and online social networks. We investigate underlying social theories that drive the characteristics and dynamics of social networks, including homophily, heterophily, and the struc-tural hole theories. We propose a uni ed coherent frame-work, namely mutual latent random graphs (MLRGs), to exploit mutual interactions and bene ts for predicting social actions (e.g., users' behaviors, opinions, preferences or inter-ests) and discovering social ties (e.g., multiple labeled rela-tionships between users) simultaneously in large-scale social networks. MLRGs introduce latent, or hidden factors and coupled models with users, users' actions and users' ties to exibly encode evidences from both sources. We propose an approximate optimization algorithm to learn the model parameters eciently. Furthermore, we speedup this algo-rithm based on the Hadoop MapReduce framework to han-dle large-scale social networks. We performed experiments on two real-world social networking datasets to demonstrate the validity and competitiveness of our approach. H.2.8 [ Database Management ]: Database Applications| Data mining ; I.5.1 [ Pattern Recognition ]: Models| Sta-tistical Algorithms, Experimentation Social theories; social actions; social ties; mutual latent ran-dom graphs (MLRGs); latent factors; Hadoop MapReduce
With the dramatically rapid growth of users worldwide, social networks provide great opportunities for social con-nection and we have access to unprecedented amounts of information about social interaction. Many large-scale on-line social networking services (e.g., Facebook and Twitter) are changing our daily physical life and emerging new pos-sibilities for investigation [22]. In light of these notable out-comes, social prediction which aims at predicting social ac-tions (e.g., users' behaviors) and inferring social ties (e.g., user-user connections) is an essential research goal. Pre-dicting and analyzing social actions could gain insights into users' behaviors and experience, marketing analytics, etc. Similarly, social tie discovery can aid understanding char-acteristics and structures of social networks. Doubtlessly, social prediction has generated much theoretical and prac-tical interest in social network analysis and has played an important role in a variety of world-wide-web applications such as online advertising and recommender systems.
Without loss of generality, we de ne social actions as ac-tivities, opinions, preferences or interests associated with users in socially connected networks. For example, a so-cial action can be purchasing a product, posting a comment, specifying a particular favorite movie, etc. Traditional social network analysis only distinguishes between pairs of people that are linked vs. not-linked. However, user connections in social media are much richer. Correspondingly, a social tie or social relation is de ned as any ne-grained relationship between pairs of people in a social network. More speci -cally, each social tie is explicitly tagged with a sign or label, such as the friend, family, or colleague relationship between linked user pairs. Social tie is the most basic unit to form the network structure, and relationships between users can be either directed or undirected. Note that our de nitions for both social actions and social ties are much more gen-eral than prior research work, such as [18] for user behavior investigation and [11] for user interest modeling, thus they are more applicable to real-world scenarios.

Social networks are a media designed to be disseminated through social interaction. Information transmitted by the media interact with the personal in uence arising from so-cial networks [16, 8]. Real social networks are complex, both social actions and social ties are a ected by a variety of fac-tors. However, a fundamental mechanism that drives the characteristics and dynamics of networks is the underlying social theory of homophily [13]: people tend to follow the behaviors of their friends, and people tend to create rela-tionships with other people who are already similar to them. create the friend relationship with each other.
 This phenomenon is often expressed in the adage \birds of a feather ock together"and it shows the power of strong ties On the other hand, the heterophily theory implies that nu-merous weak ties 2 can be important in seeking information and innovation. Many social structures are characterized by dense clusters, information within these clusters tends to be rather homogeneous and redundant. To nd new informa-tion or insights, users of the social clusters will have to look beyond the clusters to other acquaintances. This is called \the strength of weak ties" [6]. The heterophily theory is re-lated to the structural hole theory [2]: information di uses and spreads across clusters, when two separate clusters have non-redundant information, opportunities and perspectives, there is said to be a structural hole between them. Thus, a network with many di erent structural holes will o er addi-tive information bene ts. Structural hole users control the information ow between di erent clusters and they are able to access information from diverse sources and clusters. For example, compared to strong ties, weak ties are more likely to bring information about job openings and opportunities.
Inspired by these social theories, we hypothesize that there exists high correlation and mutual interactions between so-cial actions and social ties. In the following, we will give concrete motivating examples to illustrate and support our hypothesis.
Fig. 1 shows an social network example to illustrate the mutual interactions between social actions and social ties. This concrete social network consists of 6 users \Mary", \Smith", \John", \Kate", \Jennifer", and \Bob". The social actions can be \Like Samsung GALAXY S5", \Like IPhone 5S", and\Like HTC One", and the social ties can be\Friend", \Foe", and \Colleague", respectively. It is well known that di erent types of social ties have essentially di erent in u-ence on social actions. Intuitively, a user's trusted friends on the web a ect that user's online behavior. [11] and [12] claimed that one user's nal behavior decision is the balance between his/her own taste and her/his trusted friends' fa-vors. As shown in Fig. 1(a), since \Mary" and \John" are
St rong ties usually have frequent communication, but ties are redundant due to high clustering in social networks
Weak ties reach far across network, but the communication is infrequent. friends, it is likely that they have the same social action (\Like Samsung GALAXY S5") to follow the behaviors of their friends. \Kate" and \Smith" are foes, the probability that they have the same action is low. This is consistent with the social theories.

On the other hand, social actions also have important in-uence on social ties, and Fig. 1(b) demonstrates such in-uence. Suppose \Mary", \John" and \Kate" have similar action (\Like Samsung GALAXY S5"), they tend to create the friend relationship with each other. The in uentials or opinion leaders bring in new information, ideas, and opin-ions, and disseminate them down to the masses through in-formation di usion [16]. Such users can in uence a sucient number of users in the network with their actions for a long period of time. Obviously, users with similar preferences or behaviors are more likely to be friends than others in social media. Users with momentous activities will attract many other users to be connected with. On the contrary, no body will be interested in users with trivial or insignif-icant behaviors. Interestingly, knowing the intimate rela-tionship (e.g., friend) between \Mary" and \John" is helpful to discover the same action of them. Similarly, if two users have the same action, it will be a strong evidence indicat-ing the intimate relationship between them. To summarize, exploring bidirectional interactions and rich interdependen-cies between social actions and social ties to capture mutual bene ts is intuitively appealing.
Consequently, we face several interesting but challenging research problems which will be delved:
To address the above research problems, we learn the bidi-rectional interactions between social actions and social ties for simultaneous social prediction. We further extend our proposed framework for large-scale social network analysis. In summary, we list our major contributions of this paper as follows:
In this section we consider both social action prediction and social tie inference in the context of social media, where evidences for both actions and ties are available. We be-gin by necessary description of preliminaries and notations, we then present the mutual latent random graphs (MLRGs) model, upon which both sources of evidence could be ex-ploited simultaneously to capture their mutual interactions. We also discuss the major di erence and superiority of this model against several alternative models.
Let G = ( V , E ) be a social network graph, where V = { v 1 ,v 2 ,...,v N } is the set of | V | = N users and E = { ...,e M } X  V  X  V is the set of | E | = M connections between users. Let y = { y 1 ,y 2 ,...,y N } ( y i  X  X  ) be the set of actions associated with N users, and s = { s 11 ,s 12 ,...,s M } ( s be the set of corresponding social tie labels associated with M connections. The connection e ij (1  X  i,j  X  N,i  X  = j ) between v i and v j might be directed or undirected. To be consistent, both s ij  X  = s ji and s ij = s ji are valid settings. Given the observed social network data D constructing the graph G , our goal is to simultaneously detect the most likely types of actions y  X  and ties s  X  such that both of them are optimized.
To characterize the user action y i , we assume that for the user v i there exist observable attributes or properties m , such as the user's registered information and histori-cal actions. Without loss of generality, we further assume that there exist some hidden, or latent properties x ij for v . These properties are implicit and cannot be observed directly [26], such as the in uence from social ties. Conse-quently, we denote the observable factor  X  ( y i ,v i , m servable properties and latent factor  X  h ( y i ,s ij , x den properties, respectively. Given the graph G , the prob-ability distribution of y i depends on both observable and latent factors as:
This modeling integrates two types of factors for both observable and latent properties. It captures not only the user-action dependencies, but also the in uence from social ties, for exploring social actions.
To characterize the social tie s ij between user pair ( v we also assume that there exist observable properties w ij such as the posterior probability of the social tie s ij assigned to ( v i ,v j ). We denote the observable factor  X   X  ( s ij for w ij . Similarly, we further assume that there exist some latent properties to incorporate the social action in uence on social ties. To be consistent, we still use the vector x ij to represent the latent properties and the latent factor  X  ( y i ,s ij , x ij ) to capture the social action in uence on social ties. Note that both x ij and  X  h ( y i ,s ij , x ij ) now play double duties in encoding social action dependency and social tie connection simultaneously. On the one hand,  X  h ( y i ,s ij exploits in uence from social ties for modeling social actions. On the other hand, this factor exploits in uence from social actions for modeling social ties. By doing so, the latent fac-sources of evidence and exploring mutual interactions and dynamics between social actions and social ties. Such mu-tual in uence and dynamics are crucial and modeling them often leads to improved performance. Given the user action y and the graph G , we devise the following model for the probability distribution of s ij depending on both observable and latent factors as: P P
The mutual correlation between social actions and social ties advocates joint modeling of both sources of evidence in a single uni ed framework. Based on the above descriptions, we de ne our mutual latent random graph (MLRG) based on exponential-family random graph models (ERGMs) [3, 23], which have gained tremendous successes in social network analysis and have even become the current state-of-the-art [15]. To design a concrete model, one needs to specify dis-tributions for the dependencies for MLRGs. According to the celebrated Hammersley-Cli ord theory, the joint condi-tional distribution P ( y i ;s ij ) |G is factorized as a product of potential functions over all cliques in the graph G and we summarize the MLRG in the following table. In summary, our model consists of three factors: the factor  X  ( y i ,v measuring dependencies of the social action y i conditioned s ij between two arbitrary users v i and v j in G , and the latent factor  X  h ( y i ,s ij , x ij ) exploiting mutual interactions between the social action y i and social tie s ij . described. We use di erent lines to represent functions f (  X  ) , g (  X  ) , and h (  X  ) .
 )  X  ,v ,v , m
The three factors  X  (  X  ),  X  h (  X  ), and  X   X  (  X  ) can be instanti-ated in di erent ways. In this paper, each factor is de-ned as the exponential family of an inner product over sucient statistics (feature functions) and corresponding pa-rameters. Each factor is a clique template whose parame-ters are tied. More speci cally, we de ne these factors as  X  ( y i ,v i , m i ) = exp { exp { exp { are real-valued weighting vectors and f (  X  ), g (  X  ), and h ( corresponding vectors of sucient statistics. The joint prob-ability distribution shown in the above table can be rewrit-ten as P where  X , X  , and  X  are real-valued weighting vectors and f ( g (  X  ), and h (  X  ) are corresponding vectors of sucient statis-tics, which capture social network features of interest, its postulated dependence structure, or both. Z is the normal-ization factor to make all probabilities sum to one. In the following, we use P ( y |G ), P ( s | y , G ), and P ( y , s P
Fig. 2 shows an example social network ( V = { v 1 ,v 2 ,v v and the corresponding 3D graphical representation of the MLRG model. The functions f (  X  ) model dependencies of social actions in the bottom part, and the functions h (  X  model dependencies of social ties in the upper part. More importantly, the functions g (  X  ) capture mutual in uence and dependencies between social actions and social ties. The su-periority of MLRG is its ability to represent a large number of complicated factors, and capture rich interdependencies between them. Thus both homophily and heterophily theo-ries could be exploited in this modeling. As we will see, this modeling o ers a natural formalism for exploiting bidirec-tional dependencies and interactions between social actions and social ties to capture their mutual bene ts, as well as a great exibility to incorporate a large collection of arbitrary, overlapping and nonindependent features.
Noticeably, our proposed MLRG model is essentially dif-ferent from the standard exponential-family random graph models (ERGMs) and the prior models discussed in Sec. 5 mainly in two aspects. Firstly, compared to the standard ERGMs, the MLRG model de nes latent factors to assume mutual and dynamical interactions between social ties and social actions. Secondly, compared to the prior models such as [11] and [20], MLRG provides a single uni ed framework to address both social action prediction and social tie in-ference simultaneously while enjoying the resources of both sources of evidence.

Importantly, we give an analytical explanation on the mu-tual nature of our model in terms of a random walk [10] perspective. A random walk on the graph G is a reversible Markov chain on the vertexes V . The social in uence propa-gation procedure occurs through information di usion in the social graph G . More speci cally: (1) a user v i will propagate her/his in uence to other related users, and will propagate more to the user which has a stronger relation (e.g., friend-ship) with v i . This kind of propagation expresses the power of strong ties. Interestingly, this process is consistent with the homophily theory that a user in the social network tends to be similar to their connected neighbors; (2) according to the heterophily theory, a user v i will also be in uenced by other users who have weak ties with the user v i . The in-uence propagation will stop when the social graph reaches an equilibrium state, in which both social actions and social ties are mutually reinforced. Both strong ties and weak ties a ect this social in uence propagation procedure.
The objective of learning the MLRG model is how to nd a con guration of the whole set of model's parameters = {  X , X , X  } to maximize the log-likelihood objective function O ( ) of the observation given the graph G as log P ( G ) = log
Approximating objective function O ( ). Exactly max-imizing this objective function is prohibitively intractable in our model. Recall that the target probability distribution of our MLRG model P ( y , s |G ), we employ another probabil-ity distribution Q  X  ( y , s ) parameterized by the vector {  X   X  , X   X  , X   X  } , for an approximation of P ( y , s |G ). Instead of maximizing the objective function O ( ) directly, we would like to nd the best approximated distribution Q  X  ( y , s ) such that Q  X  ( y , s ) and P ( y , s |G ) are as close as possible. More speci cally, we exploit the Kullback-Leibler (KL) di-P ( y , s |G ) as the choice of dissimilarity function to mini-mize. Consequently, we have the following objective func-tion to maximize: where H ( Q  X  ) is the entropy of distribution Q  X  ( y , s ) and E Q  X  { X } represents the expectation with respect to Q  X  ( y , s ). Computing L (  X  ). Now we describe how to compute L (  X  ) eciently. We explore substructures or subgraphs which form a factorized distribution: factor graphs pro-vide a method to factorize the global probability as a prod-uct of local factor functions (e.g., marginal probabilities), each of which depends on a subset of the variables in the graph [7, 21]. Let the original probability P ( y , s , G torize into a product of pairwise potentials depending only on the variables associated with each undirected edge as P ( y , s , G ) = eld variational theory [7], we assume that Q  X  ( y , s ) forms a feasible factorized distribution as where y = { y i } ( y i  X  X  ) and s = { s ij } ( s ij  X  X  ).
Having the factorization graph structure of the original probability and the structure imposed on the distribution Q  X  ( y , s ), L (  X  ) can be evaluated feasibly as where Q  X  ( r e  X  h ) is the marginal probability over variables r = { y , s } associated with edge e and Y  X  X  = h .
Updating distribution Q  X  ( y , s ) and learning  X  . Note that L (  X  ) is a concave function of the distribution Q . We need to update the marginal probabilities to optimize  X  based on feasibility calculation of L (  X  ) via Eq. (6). We re-sort to an iterative procedure for maximizing L (  X  ) within the class of factored distributions via Eq. (5). The marginal probabilities in Eq. (5) can be updated independently, and we can optimize L (  X  ) one marginal component at a time. Recall that E Q  X  { X } denotes the expectation with respect to Q , let E Q  X  { X | r m } ,m  X  h be the conditional expectation with respect to Q . We explicate in more detail the feasibility of computation the conditional expectation in the updates as where h \ m is the set of nodes other than m , the variable r m can be either y i or s ij . e  X  X  h \ m } is either an empty set or refers to a single node associated with edge e . Note that but a function of the conditioning variable r m .
To update the m th marginal, we view L (  X  ) as a function the dependency of L (  X  ) on the marginal Q  X  Through straightforward calculation, it is easy to verify that maximizing L (  X  ) with respect to Q  X  ing mean eld equations [21] as
In summary, we describe the whole parameter estimation procedure of  X  as follows: we compute the marginal expec-tation E Q  X  { log P ( y , s , G ) | r m } via Eq. (8) and we update imize the objective function L (  X  ) via Eq. (6). After we compute and maximize L (  X  ), we can have a con guration of the parameter vector  X  . Such optimization procedure runs iteratively until it converged to an equilibrium state in which both L (  X  ) and  X  are optimized. Let  X  t and  X  t +1 the values of parameter vector  X  at iteration t and t + 1, respectively. At iteration t + 1, each update is carried out in a closed form, the optimization procedure increases L ( such that L (  X  t +1 )  X  L (  X  t ) to maximize L (  X  ). We have a con guration of the parameter vector  X  at iteration t +1 as
We perform theoretical analysis on this parameter estima-tion algorithm, and we show that it o ers guarantees in the form of a lower bound on the true objective function O ( ). Based on Jensen's inequality and given the non-negativity property of the KL divergence, we have
O ( ) = log De nitely, L (  X  ) is the lower bound on the observed data O ( ) (with equality when Q  X   X  ( y , s ) = P ( y , s |G ))). Maxi-mizing the lower bound L (  X  ) with respect to Q will always recover the log-marginal probability log P ( G ).
W e now analyze the computational complexity of this al-gorithm as follows. Let | h | ( Y  X  X  = h ) be the number of social action and social tie variables r = { y , s } , and let  X  be the distinct values each variable can take. In Eq. (6), the O ( | h |  X  ). Similarly, the computation of the third summation takes O ( | E |  X  2 ) since each expectation E Q  X  { X } involves two variables and there are | E | edges. Let T be the iteration number, thus the overall computational complexity of this rithm provides a fast, deterministic approximation to oth-erwise unattainable posteriors. Also its convergence time is independent of dimensionality, especially in the case that Markov chain Monte Carlo (MCMC) algorithms are too slow to converge [21].
Large-scale data analysis is a signi cant challenge in so-cial networks. We explore such challenge and we present a distributed implementation of the learning algorithm based on the Hadoop MapReduce framework 3 to scale up to large-scale networks. The Apache Hadoop is a framework that allows for the scalable parallel and distributed computing of large data sets across clusters of computers using sim-ple programming models such as MapReduce. This frame-work adopts a master-slave architecture which consists of one master node and multiple slave nodes in the clusters. The master node is generally served as JobTracker and each slave node is served as TaskTracker .

Generally speaking, our proposed learning algorithm con-tains two iterative steps: (1) compute the marginal expec-tation E Q  X  { log P ( y , s , G ) | r m } and update the marginal ter vector  X  based on (1). The most expensive part is the rst step, and we develop a distributed algorithm to speed up. Based on the Hadoop MapReduce framework, one master node is responsible for optimizing parameters (Step (2)), and the other multiple slave nodes are respon-sible for calculating the marginal probabilities (Step (1)). Since our algorithm exploits factorized distribution of the real probability, the substructures or subgraphs are then distributed and parallelized over slave processors. In other words, each slave node calculates its own \local" marginal expectation E Q  X  { log P ( y , s , G ) | r m } via Eq. (8) and the Map stage. In the Map stage, each slave node receives a subset of data as input and produces a set of intermediate key/value pairs for the marginal probabilities. Finally we combine and aggregate these marginal probabilities on each slave node together to calculate and maximize L (  X  ) via Eq. (6) for optimizing the parameter vector  X  on the master node in the Reduce stage. In the Reduce stage, the mas-ter node merges all intermediate marginal values associated with the same intermediate key, calculates L (  X  ) and opti-mizes  X  for the nal computation results. We summarize this distributed learning algorithm in Algorithm 1.
The optimized parameter vector  X  can be used to infer social actions and social ties. More speci cally, given the h ttp://hadoop.apache.org/
A lgorithm 1: The distributed learning algorithm for MLRGs.
 Inp ut : The social graph G , number of iterations T . Output : Optimized parameters  X  = {  X   X  , X   X  , X   X  } . Initialize pairwise potentials  X  ( y e , s e , G e );
Initialize factorized distribution for Q  X  ( y , s ); repeat until converge ; tes ting network data, the task of social prediction is to nd the most likely types of actions y  X  and corresponding social tie labels s  X  that have the maximum posterior probability:
This can be accomplished by performing the model infer-ence which is straightforward. After parameter estimation via Algorithm 1, the marginal expectation E Q  X  { log P ( y , s , | r m } and marginal probability Q  X  m ( r m ) are obtained. We predict the labels of social actions and social ties by nd-ing the maximum a posterior (MAP) social action labeling assignment and corresponding social tie labeling assignment that have the largest marginal probability.
Since our prediction task involves both social actions and social ties, several publicly available social network datasets are not suitable for us. We collected the following two real-world datasets for our experimental study: Epinion+ . This dataset is extracted by crawling Epinions a well known knowledge sharing site and consumer review site. Users of this site can assign integer ratings from 1 to 5 as their personal opinions or reviews on products, compa-nies, movies, etc. These ratings and reviews will in uence future customers when they are about to decide whether a product is worth buying or a movie is worth watching. Users can also decide whether to trust or distrust each other. Thus Epinions is a who-trust-whom online social network. The so-cial actions here are users' review ratings, and we use very dislike , dislike , neural , like , very like to represent the ratings from 1 to 5 on products, respectively. The social ties are the trust and distrust relationships in this network of product reviewers. Our dataset consists of 126,785 users who have rated a total of 102,807 di erent items from 5 categories: electronics, health &amp; beauty, computers, media, and other. h ttp://www.epinions.com/ T able 1: Statistics of Epinion+ and Mobile datasets. Th e total number of ratings is 816,946. Thus the number of distinct action labels is 5  X  5 = 25 (We view the same rat-ings in the same category as the same labels to alleviate the sparsity problem). This dataset also contains 620,159 rela-tionships, of which more than 80% are trust relationships. A more detailed statistics is shown in Table 1.

Mobile . Mobile phones have become an important tool for communication. They are an ideal platform for under-standing social in uence and social dynamics. We collected a social network dataset containing 3,268 mobile phone users. The social actions are formed by calling or sending short messages between each other during a few months. The social ties we investigated are friend , family , and colleague relationships. Table 1 also lists detailed statistics of this dataset, where ACC denotes the average clustering coe-cient, and Diameter is the longest shortest path in the net-work. The Avg. Num. of item and Max. Num. of item are the average number of item per user and maximal number of item per user, respectively.
For quantitative performance evaluation, we employed the standard measures of Precision (P), Recall (R), and F-measure for both social action prediction and social tie inference. We also investigated the eciency issue of the models.
We performed four-fold cross-validation on the two datasets, and took the average performance. We compared our ap-proach with the following alternative methods for predicting social actions and inferring social ties: Table 2: Comparative performance of social action prediction on the Epinion+ dataset.

We exploited a wide range of important features for all the models. For the Epinion+ dataset, the features include in-degree, out-degree, total-degree, common neighbors, etc. For the Mobile dataset, the features include temporal and social features. For the latent factor, we incorporated social tie evidences and hypotheses as features to capture social actions, and we also incorporated social action evidences and hypotheses as features to leverage social ties.
All these models exploited standard parameter learning and inference algorithms in our experiments. For ERGM, we employed a standard gradient based method for parameter estimation. To avoid over-tting, penalization techniques on likelihood were also performed. All experiments were performed on the Linux blade server, with 18 2.5GHz Intel Xeon E5-2640 CPU processors and 16  X  18 GB of memory.
Table 2 and Table 3 show the social action prediction per-formance of di erent methods on the Epinion+ and Mobile datasets, respectively. Table 4 and Table 5 list the social tie discovery performance of di erent methods on the Epinion+ and Mobile datasets, respectively. We only compared the overall social action prediction performance on the Epinion+ dataset in Table 2, since the number of possible action labels is large (25 in total). The best overall Precision, Recall and F1-measure of these results are highlighted in boldface. Our proposed MLRG consistently achieves better performance on F1-measure than other comparison methods. We per-formed McNemar's paired tests on these results, which con-rm that all the improvements of our proposed models over the baseline methods are statistically signi cant.
The SVM and ERGM methods generally produce poor prediction performance on the two datasets. They perform social action prediction and social tie discovery indepen-dently without considering the mutual correlations between them, thus leading to reduced performance. By model-ing interactions between actions and ties, boosted perfor-mance can be achieved, as illustrated by the DCRF model. However, the DCRF model applies loopy belief propagation (LBP) for approximate learning and inference, which is in-herently unstable and may cause convergence problems. An-other shortcoming of DCRF is that the graphical structure of this model is not well suited for social networks, as DCRF was originally proposed for sequence labeling problems. As 1 P R F 1 P R F 1 1 P R F 1 P R F 1 ca n be seen, our model achieves stronger interactions via ap-propriate graphical structures for social networks, and cou-pled latent factors to exploit bidirectional mutual interac-tions between social actions and social ties. We also no-ticed that the prediction performance on the two datasets varies di erently. The prediction performance on the Mobile dataset is much better than that on the Epinion+ dataset. This is due to the di erence of the social network properties.
We examined the nature and e ectiveness of the associ-ated latent factors of our MLRG on exploiting bidirectional interactions and mutual bene ts between social actions and social ties. Fig. 3 and Fig. 4 demonstrate their feasibility on the Epinion+ and Mobile datasets, respectively. It shows that the latent factors consistently enhance Precision, Re-call, and F1-measure for both social action prediction and social tie inference tasks. For example, the latent factors signi cantly improve the F-measure by 7.92% (from 81.20 to 89.12) for social action prediction, and improve the F-measure by 8.24% (from 80.24 to 88.48) for social tie dis-covery on the Mobile dataset, respectively. However, the latent factor contributions on the Epinion+ dataset are sig-ni cantly less: 2.9% F-measure improvement on social ac-tion prediction and 3.89% F-measure improvement on social tie discovery. We present an in-depth analysis on this phe-nomenon. By carefully investigating the two datasets, we found that in the Mobile dataset, the mobile phone users tend to cluster together to create tightly knit groups char-acterized by a relatively high density of ties. However, in the Epinion+ dataset, the social network is loose and many users seldom connect with each other through the trust or distrust relationships. This is also implied by the average clustering coecient (ACC) shown in Table 1. The ACC of Mobile dataset is signi cantly higher than that of Epinion+ dataset (0.45 vs. 0.14). These results not only illustrate that there exists high correlations and mutual interactions between social actions and social ties, but also demonstrate the feasibility and e ectiveness of our latent factors for ex-ploring them, especially when the nodes in the network clus-ter together tightly with high density of ties.
We empirically compared the e ectiveness and eciency of the distributed learning algorithm of our model against other baselines. Table 6 shows the total running time of Fi gure 3: Contribution of latent factors on social ac-tion prediction (left) and social tie inference (right) on the Epinion+ dataset.
 Fi gure 4: Contribution of latent factors on social ac-tion prediction (left) and social tie inference (right) on the Mobile dataset. di erent models on the two datasets in our experiments. We used single machine node for the models SVM, ERGM, DCRF and MLRG. It is particularly notable that our MLRG model without speedup takes much less time than the joint model DCRF for running. As stated before, when the graph has large tree-width as in our case, the LBP algorithm in DCRF is inecient, and is slow to converge. Table 6 also summarizes the running time of the distributed learning al-gorithm for our model. Here we used 16 processor nodes for the speedup of the distributed learning algorithm. In par-ticular, our model (MLRG with Speedup) is over orders of magnitude faster than MLRG with single processor node. As can be seen, the speedup ratios are 14.2 (9.25hrs/39.10mins) and 13.5 (65.27mins/4.83mins) on the Epinion+ and Mobile datasets, respectively. 1 P R F 1 P R F 1 T able 6: Eciency comparison of di erent models on the Epinion+ and Mobile datasets. The running time includes both learning time and inference time.
Fig . 6 demonstrates the speedup ratios of the distributed learning algorithm with di erent numbers of computer nodes. We increased the number of nodes from 2 to 16, with an in-cremental step of 2 on both Epinion+ and Mobile datasets. The two speedup curves are near linear. This nding is particularly interesting, suppose we have a commercial dis-tributed system with thousands of computer nodes, our learn-ing algorithm can be further accelerated over hundreds of or even thousands of times.
We performed a representative case study to further demon-strate the e ectiveness of the proposed model, and Fig. 5 shows a social prediction example from our Epinion+ dataset of the computers category. All the users here are anonymized. Both SVM and ERGM are prone to many prediction errors. For example, the SVM model mis-predicted 3 social ties and 2 social actions, and the ERGM model mis-predicted 2 so-cial ties and 2 social actions. Since they model social actions and social ties as two separate tasks. The DCRF model can alleviate some of the errors by solving the two tasks jointly. Our proposed MLRG model can correct most of the errors made by SVM and ERGM models. This illustrative example shows the validity and competitiveness of our model.
In online social media, social action prediction and so-cial tie discovery are two fundamental tasks for social net-work analysis. Traditionally, they were considered as sepa-rate tasks and solved independently without taking into con-sideration the reciprocities or mutual interactions between them. [18] proposed a noise tolerant time-varying model to track social behaviors, which are a ected by various kinds of factors, such as users' attributes, users's historical behav-iors, social in uence and social network structures. Aiming at modeling user actions more accurately and realistically, [11] and [12] considered connections among users and pro-posed social trust ensemble to fuse the users' tastes and their trusted friends' favors together. In this modeling, only trusted friend relationship was considered. [4] investigated users' social behaviors from a spatio-temporal-social aspect in location-based mobile social networks. For social tie pre-diction, [20] proposed a semi-supervised framework, the par-Fi gure 6: Speedup eciency for the distributed learning algorithm of MLRGs. tially labeled factor graph model to infer the type of social relationships. [19] inferred social ties across multiple het-erogeneous networks via transfer learning. [24] investigated labeling the edges of a social network graph as either positive or negative relations to show that it is possible to infer signed social ties. Thus we can turn an unsigned acquaintance net-work into a signed trust-distrust network. However, the so-cial tie label in [24] is only binary (positive/negative). As stated in Sec. 1, our de nitions for social actions and so-cial ties are much more general than the above-mentioned research work, thus our modeling is more applicable to real-world problems. Our approach involving both actions and ties modeling is more challenging than [18, 20]. Most im-portantly, we introduce latent factors and coupled models to incorporate both sources of evidences, and we capture bidi-rectional interactions between social actions and social ties to predict them simultaneously.

Exploring interplay and mutual bene ts between relevant tasks has proven to be highly desirable in NLP [27, 29], data mining and information extraction research communi-ties [31, 28, 25, 30, 32]. We are also aware of several research work attempting to explore joint or uni ed models in social media and social network analysis [14, 9, 1, 5]. For ontology emergence and semantics, [14] extended a bipartite model of ontologies to a tripartite model of actors, concepts and instances. [9] proposed a uni ed approach, the latent user preference model (LUPM), to employ mixed membership stochastic block models and topic models for users and the posted content on social networking sites. This uni ed mod-eling captures the interactions between users and posts, but it is only loosely coupled. Moreover, the LUPM is a gener-ative model, whereas our proposed model is discriminative. Compared to discriminative models, generative models may have diculties to capture complex dependencies and rich features. Due to these reasons, discriminative models are generally more accurate than generative models. [1] pro-posed a CRF based approach to user identity resolution which combines user pro le attributes and social linkage. [5] extended the social-attribute network (SAN) framework with several link prediction algorithms. The SAN frame-work integrates network structure and node attributes to perform both link prediction and attribute inference. How-ever, due to the computational complexity problem, both [1] and [5] require considerable engineering and they are not scaled up to large-scale social graphs. Since individual users are socially connected, social in uence occurs through infor-mation di usion in social networks. Social in uence happens when one's opinions or behaviors are a ected by others, in-tentionally or unintentionally. We eciently exploit mutual interactions and bene ts via MLRGs, and we speedup our framework based on Hadoop MapReduce to scale it up to big data and large-scale social networks.
In this paper we investigated underlying social theories, and we presented a coherent uni ed framework, mutual la-tent random graphs (MLRGs), for simultaneous social ac-tion prediction and social tie discovery. This framework in-corporates shared latent factors and coupled models with users, users' actions and users' ties to exploit bidirectional mutual interactions and interdependencies between social actions and social ties. We proposed an approximated al-gorithm which explores factor graph substructures and fac-torized distribution to optimize model parameters eciently, and this algorithm o ers a theoretical lower bound on the real objective function. Furthermore, we scaled it up to large-scale social network process based on the Hadoop MapRe-duce architecture. Extensive experimental results on two real-world datasets Epinion+ and Mobile exhibit that our model signi cantly outperforms several state-of-the-art mod-els while also running much faster. Several interesting issues were analyzed and discussed as well. For the future work, we plan to further investigate and extend our framework to more general scenarios including semi-supervised and unsu-pervised learning settings. We also plan to apply and test our approach on other large-scale social network datasets.
