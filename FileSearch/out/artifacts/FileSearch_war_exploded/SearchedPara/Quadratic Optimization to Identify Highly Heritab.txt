  X  Identifying genetic variation underlying a complex disease is important. Many complex diseases have heterogeneous phenotypes and are products of a variety of genetic and en-vironmental factors acting in concert. Deriving highly her-itable quantitative traits of a complex disease can improve the identification of genetic risk of the disease. The most sophisticated methods so far perform unsupervised cluster analysis on phenotypic features; and then a quantitative trait is derived based on each resultant cluster. Heritability is estimated to assess the validity of the derived quantita-tive traits. However, none of these methods explicitly max-imize the heritability of the derived traits. We propose a quadratic optimization approach that directly utilizes heri-tability as an objective during the derivation of quantitative traits of a disease. This method maximizes an objective function that is formulated by decomposing the traditional maximum likelihood method for estimating heritability of a quantitative trait. We demonstrate the effectiveness of the proposed method on both synthetic data and real-world problems. We apply our algorithm to identify highly her-itable traits of complex human-behavior disorders includ-ing opioid and cocaine use disorders, and highly heritable traits of dairy cattle that are economically important. Our approach outperforms standard cluster analysis and several previous methods.
 G.1.6 [ Numerical ]: Optimization X  Quadratic programming methods ; H.2.8 [ Database management ]: Database Ap-plication X  Data mining Algorithms, Performance, Experimentation  X  Correspondence to: Jinbo Bi, jinbo@engr.uconn.edu Quadratic optimization, Quantitative trait, Heritability
Identifying genetic variants that underlie complex pheno-types is important in genetics. Genetic correlation analysis can help to uncover the underlying biological processes mod-erating or regulating a complex disease, such as cancer, heart disease, and substance dependence disorders, which facili-tates the development of more effective treatments. Com-plex phenotypes, however, exhibit great heterogeneity, and are often products of a variety of genetic and environmental factors acting in concert. Refinement of a complex pheno-type to reduce phenotypic heterogeneity that is aimed at separating genetic and environmental effects, and dissecting its genetic heterogeneity is a challenging problem.
The success of genetic correlation with a complex trait depends on the heritability of the trait. Heritability of a phenotype measures the proportion of the total phenotypic variance due to additive genetic effects [10]. It is a key popu-lation parameter that helps to understand the genetic archi-tecture of traits. Higher heritability of a phenotype implies that the phenotype is more genetically influenced. Thus, there is chance to detect its causal genetic variants. Methods to obtain unbiased estimates of heritability from family pedi-gree data are well developed for quantitative phenotypes [6]. For example, SOLAR [1], a genetic linkage analysis software package, can estimate the heritability (both broad-sense and narrow-sense) of a quantitative trait.

In the context of genetic analysis, phenotypic heterogene-ity means that there are diverse forms of a particular trait. Complex disease phenotypes are often characterized by a variety of clinical variables and symptoms. For example, to diagnose whether a patient has a lifetime drug dependence, clinicians interview the patient to understand many aspects of the patient X  X  drug use and related behaviors, the negative consequences of drug use and treatment history, together with an assessment of other co-occuring medical conditions. All of these variables are used to make a diagnosis of depen-dence on certain drug. Hence the phenotype of dependence on a drug ,suchasopioidorcocaine,ischaracterizedbyall of these parameters.

Although a large number of variables are involved in the clinical diagnosis, multivariate data mining of these clinical features has seldom been utilized. In genetic analysis of a complex disease, the diagnosis itself is often regarded as the phenotype, which is a binary trait, partitioning the popula-tion into two groups, one with the drug dependence disorder, and the other without. This binary trait simply cannot dif-ferentiate the heterogeneous clinical manifestations of the disorder, and is likely attributable to heterogeneous genetic causes. Hence, insights into the genetic etiology of drug de-pendence are limited. In general, diagnosis-induced binary traits often have low heritability and are not optimal for genetic association studies [12].

In the effort to identify clinical traits that are suitable for genetic analysis, researchers can perform a simple phenome scan which assesses the heritability of each collected clini-cal feature used in the diagnosis. This univariate analysis approach, however, cannot evaluate the interplay between different clinical features. It cannot answer the question of whether a combination of several clinical features will form a trait with higher heritability. In the few studies that have used multivariate analysis of clinical symptoms and features [8, 12, 5, 21], the most sophisticated approach is unsuper-vised cluster analysis, which is used to find sub-groups of a population that are homogeneous in their clinical features. Quantitative traits can be derived for each resultant clus-ter by calculating the membership likelihood in a cluster for each subject. Then heritability of the derived quantitative trait is estimated and used to assess the validity of the clus-ters. Since cluster analysis is completely unsupervised, the resultant clusters are not guaranteed to achieve high heri-tability. There is currently no empirically derived and sta-tistically rigorous method to identify the optimal trait for a complex disease such as psychiatric illness [9].

In this paper, we propose to make explicit use of the heri-tability estimate during the derivation of quantitative traits of a complex phenotype. The problem of deriving a highly heritable quantitative trait based on a collected sample dif-fers from traditional supervised or unsupervised machine learning problems where a human expert can either label each sample subject with a precise label, e.g. the member-ship of a subtype, or give no guidance at all. Mathematically, we are given data X n  X  d on a set of d phenotypic features x for a total of n subjects from multiple families, and our objective is to project X into some dimensions so that the empirical heritability of the projected traits is high.
We propose to construct a quantitative trait y in the linear form of y = x w , and find the weight vector w that maxi-mizes the empirical heritability of y . Non-linear projections, if desirable, can be formulated using kernel machines [20] fol-lowing the proposed approach here. A quadratic optimiza-tion problem is formulated by decomposing the traditional maximum likelihood method for estimating heritability of a quantitative trait. We develop an efficient solver to optimize the proposed quadratic optimization problem, and evaluate the proposed algorithms on both synthetic and real world data. The computational results demonstrate the effective-ness and efficiency of our approach in deriving quantitative trait with high heritability. In particular, we apply the ap-proach to analyze clinical features related to opioid depen-dence and cocaine dependence and pedigrees of small nuclear families. To further show the general applicability of our ap-proach, we apply it to a set of dairy cattle traits collected for animal improvement together with extended pedigrees. Our approach can define quantitative traits of drug use with much higher heritability than those obtained by cluster anal-ysis, and derive highly heritable quantitative traits for dairy cattle.

The rest of this paper is organized as follows. We briefly review the literature that is most relevant to the proposed work in Section 2. We describe our formulation that derives highly-heritable quantitative traits based on phenotypic fea-tures in Sections 3 and 4, followed by an algorithm evalua-tion on both synthetic and real world data in Section 5. We conclude this paper with a discussion in Section 6.
To date, the most sophisticated phenotypic refinement methods come from multivariate cluster analysis and latent class analysis that have been mainly used to subtype human disease phenotypes [5, 12, 14, 7, 8]. Traditional clustering algorithms such as k-means [19] and hierarchical clustering [18] have been extensively applied to phenotype complex diseases [22, 23, 4, 3]. Many of the studies lack a quantita-tive and objective measure to validate the clusters. Cluster analysis requires that the subtypes differ significantly on the disease-specific phenotypic parameters that are used. More recently, heritability was used to assess the validity of the clusters [8, 5].

Figure 1 shows the flowchart of a common approach [7, 8, 16] for phenotypic subtyping. First, a standard clustering strategy, relying either on a single clustering method or k-means combined consecutively with hierarchical clustering, was applied to the phenotypic data to partition the sam-ple. It assigns each subject to a specific cluster. To form a quantitative trait, a classification approach, typically lo-gistic regression, is used to separate subjects in different clusters with a probabilistic classifier that is a function of an individual X  X  phenotypic features. The resulting classifier is expected to report a higher membership score for subjects in the cluster than those who are not. The score computed for each subject is regarded as a quantitative trait character-izing the specific cluster, and its heritability is empirically estimated using software such as SOLAR [1]. This approach is limited by the fact that, although heritability is used to validate the clusters, it is not used in their creation. Figure 1: A common approach to phenotypic subtyping.
In very recent work [21], an approach was proposed to identify stable and heritable subtypes of opioid use and re-lated behavior traits using a three-step sequence: variable selection, clustering, and classification. This approach ad-vanced the subtyping methodology by assuming that highly-heritable traits can be derived based on the clinical features that are also heritable. In the variable selection step, clinical features were selected based on their estimated heritability and used in cluster analysis. This method resulted in two highly-heritable opioid-use subtypes [21]. However, there are several limitations that may prevent successful applica-tions of this approach to other data sets. First, some of the clinical features are binary traits, such as the response variable to a question of  X  X ave you used opiates more than 11 times in your lifetime? X  is binary with two possible an-swers  X  X es X  or  X  X o X . It is not straightforward to estimate the heritability of a binary trait. Second, it is unclear that combining only highly heritable clinical features will neces-sarily lead to traits that are more heritable. Third, similar to the standard approach reviewed above, heritability was not used directly in the clustering process.
In this paper, we propose a new approach to maximize a heritability-derived objective. Let X n  X  d be the data matrix on a set of d phenotypic features x for a total of n subjects from multiple families. The goal is to find a y : y = x w that yields a high heritability estimate. We limit our dis-cussion to linear projections. The proposed approach can be extended to non-linear combinations, if desirable, by us-ing kernel machines [20].

The heritability of a quantitative trait y can be estimated using a well-established maximum likelihood method based on linear mixture models [13, 2]. It assumes that the phe-notype y i of a family i follows a multivariate normal distri-bution with covariance  X  i and separate means for male and female family members,  X  m and  X  f respectively. The reason to have separate means for males and females is that it aligns with the general observation that male and female subjects present differences in quantitative traits, such as height and weight. Each entry of  X  i is the phenotypic covariance of two family members j and k , given by (1).  X  a and  X  fects and dominant effects, respectively;  X  2 e denotes the vari-ance due to environmental factors. Here another genetic component: epistatic effects  X  2 I is not considered, but the approach can be extended to include this component or ef-fects from any other source. The quantity  X  i jk is the kinship coefficient between members j and k . It is the probability that two alleles randomly drawn from j and k at a genetic locus are identical by descent (IBD), which means that these two alleles are identical copies of the same ancestral allele. An allele is one of the alternative forms of a gene or a genetic locus. As the human genome is diploid, each human subject has two copies of an allele that can be in different forms at a specific genetic locus. The quantity  X  i jk is the probability of members j and k sharing both alleles at a genetic locus. Both matrices  X  i and  X  i can be calculated from the family pedigrees. Readers can consult Chapter 32 in [2] for de-tails. Exemplar entries of  X  and  X  between selected family members are illustrated in Table 1 where random mating is Table 1: Elements of the matrices  X  and  X  for selected relationships in a family when random mating is assumed assumed. The parameter  X  i jk is an environmental indicator that encodes whether j and k live together (  X  i jk =1)or apart (  X  i jk =0).
 by maximizing the log likelihood of pedigrees over all sample families [13]. The log likelihood is computed by the following equation (2) where  X  i denotes a vector of the respective means  X  m ,  X  male or female members in the family i .Bothgradientand Hessian of the equation (2) with respect to  X  m ,  X  f ,  X  and  X  2 e can be calculated, and a Newton-Raphson algorithm or a scoring method [13] can be applied to maximize the log likelihood (2).

The narrow sense heritability is defined by h 2 =  X  2 a / X  where  X  2 p given by (3) is the total variance in y . The broad sense heritability is defined by the portion of to-tal variance due to all genetic variation: H 2 =(  X  2 a +  X  In this paper, we target quantitative traits with higher nar-row sense heritability, which we call heritability through the remainder of this paper. If higher broad sense heritability is desirable, our formulation can be easily adapted to derive a quantitative trait of that sort.

To derive a trait y that has the highest possible heritabil-ity, i.e., 1, the variance or covariance of y , cov ( y i be due to the additive effect  X  2 a only, and  X  2 d =  X  2 tivated by this fact, we propose to search for the optimal w ,  X  m and  X  f such that the resulting trait y = x w achieves the maximal log likelihood LL in (2) with  X  i fixed to: Given that a scaling factor will not change the results, we scale  X  a = 1. Then, maximizing the log likelihood LL in (2) is equivalent to finding the optimal solution of the following objective (4) after constants are eliminated: Let  X  =[ w , X  m , X  f ] ,and H be defined by where [1] i ,[  X  1 / 0] im and [  X  1 / 0] if are column vectors with length equal to the number of members in family i ,[1] i con-sists of all 1 X  X . For males in the family,  X  1 is assigned at their corresponding entries in [  X  1 / 0] im and 0 at other positions of the vector. The vector of [  X  1 / 0] if is similarly defined for female family members. Then Problem (4) can be simplified to the following optimization problem (5): This objective function can be scaled with the magnitude of  X  . We control the magnitude of  X  by fixing the sample variance of the resulting trait to 1, which corresponds to a constraint  X  H H  X   X  n = 0. Clearly,  X  m and  X  f are related to the sample means of clinical features x for male and female respectively. They are not true free parameters as they are determined once w is determined. Actually,  X  m and  X  f are equal to the sample phenotypic means of male and female, respectively when the optimal  X  is found. Let  X  means on features x .Both  X  m and  X  f have a length of d . Let Then the equality of  X  m =Mean( x w ) on all male family members is translated into a m  X  = 0. Similarly, we also have a  X  =0.

Imposing all of these constraints yields an optimization problem with a quadratic objective subject to both quadratic and linear equality constraints as shown in (6).
In many applications, sparsity on the clinical features may be a desirable target. In other words, we expect to use few clinical features in the projection. In such a case, the objective can be regularized by a regularization term on w , R ( w ). Then the overall optimization problem becomes: where  X  is a pre-specified tuning parameter for balancing the two terms in the objective function, and R ( w )canbe realized in different forms according to specific requirement of an application. For example, if less features should be included in the projection, R ( w ) can be implemented with the 1 vector norm: || w || 1 which is defined by i | w i | w i is the i -th entry of w . When features in x are clustered in different groups, R ( w ) can be implemented by the 1 , vector norm defined as where G contains the feature indices of a group .More specifically, if we focus on the implementation of (7) with the norm, i.e., we solve the following optimization problem: We next introduce an algorithm to solve Problem (9) in the following section. Note that Problem (6) can be treated as a special case of Problem (9) at  X  = 0. Hence, the solver for Problem (7) with  X  = 0 serves a solver for Problem (6).
The objective function in (9) is not continuously differ-entiable because of the one norm regularization term. In order to convert it to a canonical optimization problem and gradient-based methods can be applied, we introduce two sets of variables u  X  0and v  X  0 both with equal length of w .Wereplace w by u  X  v .Then || w || 1 = d i =1 u i + v Correspondingly, we re-organize the variables as follows Let and where 2 d is a vector with length of 2 d consisting of all ones. By change of variables, Problem (9) can be proved to be equivalent to Problem (10): where e =2 d + 5 is the total number of constraints in the problem. As we have an equality constraint in a quadratic form, Problem (10) is not a convex optimization problem. However, considering its special structure, we can solve it ef-ficiently in the framework of sequential quadratic program-ming (SQP) [15], as the gradient of both the objective func-tion f and the constraints g i : i =1: e can be calculated as fol-lows: where I 2 d  X  2 d is the identity matrix of dimension 2 d The Lagrange function for this problem is, where  X  contains all Lagrangian multipliers. The Hessian of
L with respect to  X  can be calculated as,
As other SQP methods, we solve the proposed problem iteratively. At each iteration t + 1, we solve a quadratic programming subproblem given in (13) to find the direction to move towards one optimal solution. where p is a direction to be determined along with the ob-jective function can be reduced. The solution  X  p t to this sub-problem together with its corresponding optimal Lagrangian multipliers  X  q t are used to update  X  and  X  as follows: where s is the learning step size which is a scalar and can be found by general line search with 1 merit function defined as following: z is a multiplier that can be chosen in each step with the following constraint: for some parameter  X   X  (0 , 1).  X  is a constant, either 1 when 2  X  X  L (  X  t ,  X  t ) is positive definite, otherwise 0. The directional derivative of  X  in the direction  X  p t is given in (17).
 Algorithm 1 summarizes the algorithm that we used to solve Problem (10).
In our experiments, we first evaluated the effectiveness of our approach using synthetic data for which we knew the ground truth to test against. We then compared our ap-proach on real-world data sets with several clustering ap-proaches [12, 5, 21]. To the best of our knowledge, these methods [12, 5, 21] are most suitable for comparison with the proposed one. Heritability for the derived traits was esti-mated using the polygenic program in the SOLAR software package [1]. The polygenic function estimates the narrow sense heritability of a quantitative trait.
We synthesized data by creating the pedigrees for 250 nu-clear families, each of which had 4 family members: father, mother and two children. Hence, we had 1000 subjects in total in the pedigree. The gender of all of the children were randomly assigned. Both the kinship matrix  X  and the delta Algorithm 1 A sequential quadratic programming ap-proach for solving problem (10) Input: C i ,  X  i , a m , a f ,  X 
Output:  X  1. Initialize  X  with u =1, v =0,and  X  m ,  X  f equal to the sample male and female means of the obtained trait when w = 1 applied. 2. Initialize  X  with all ones. 3. Evaluate f , f , g i and 2  X  X  L with  X  and  X  . 4. Solve problem (13) to obtain  X  p and  X  q . 5. Choose z satisfy Eq. (16). 6. Do line search to find a step size s satisfying Eq.(18) with  X   X  (0 , 0 . 5). 7. Update  X  and  X  as in Eq.(14).

Repeat 3-7 until  X  reaches a fixed point. matrix  X  were calculated for each family. Since all simu-lated families had the exact same structure, they had the exact same kinship matrix and delta matrix as follows: with family members aligned in such order: father, mother, the first child and the second child in both columns and rows.

We then simulated a quantitative trait y which corre-sponded to a vector where each entry was the phenotype of a subject in the pedigree. The simulation procedure was designed according to how the heritability of a quan-titative trait was typically estimated. We randomly drew points from a 4-dimensional multivariate Gaussian distri-bution: N (  X  ,  X  ) for each family. The 4 dimensions corre-sponded to the 4 family members in each simulated fam-ily. Notice that the  X  used in the simulation of each family may vary between families according to the gender of family members. More precisely, if a family member is male,  X  was set to  X  m ; or otherwise it was set to  X  f . The covariance matrix  X  was given as follows: Without loss of generality, for simplicity, here we use identity matrix I as the matrix  X  in (1). The quantitative trait was simulated with the following choice of parameters
We next simulated 5 phenotypic features by randomly drawing from a Gaussian distribution and used them to ap-proximate the simulated quantitative trait by a linear func-tion of y i = x i w for each simulated subject i . We regressed on the simulated x i and the quantitative trait y i and the best w =[1 . 3 , 1 . 5 , 0 . 7 , 0 , 1 . 1] in the simulation. The fourth variable had no effect on this simulated trait.
Before we ran the proposed algorithm, we estimated the heritability of the simulated quantitative trait. The heri-tability reported by SOLAR was 0.75, which was close to the parameters we set and was accurate enough taking into account the random nature of the simulation. The heri-tability we implanted in the data was 0.8 according to (20). This means that there is at least one specific combination of the 5 simulated features that gives us a trait of around 0 . 75 heritability. Hence, if our approach works, it should yield quantitative traits with a heritability estimate of at least 0 . 75.

We conducted a set of experiments with the proposed algo-rithm where we chose  X  =0 , 1 , 2 , 3 , 4 in succession. For all of the choices of  X  tested, the proposed method can recover the true w with good accuracy. And as expected, w was shrunk when we increased  X  . The proposed algorithm could completely rule out the effect of the fourth variable when  X  = 4. The estimated heritability of the five derived quan-titative traits (corresponding to  X  =0 , 1 , 2 , 3 , 4) are as which are higher than the implanted one. This result shows that our approach can successfully derive quantitative traits of high heritability. When  X  increases, heritability tends to decrease but without significant changes for all tested  X  s.
We evaluated the proposed approach on two real-world problems in genetic studies of opioid use and cocaine use separately. Subjects were recruited from multiple sites, in-cluding the University of Connecticut Health Center, Yale University School of Medicine, the University of Pennsylva-nia School of Medicine, McLean Hospital and the Medical University of South Carolina. All subjects gave written, in-formed consent to participate, using procedures approved by the institutional review board at each participating site. All of the subjects identified themselves as either African American (AA) or European American (EA). Opioid use or cocaine use and related behaviors were assessed with two separate sections of the interview, each of which was dedicated to the diagnosis of opioid dependence or cocaine dependence. The computer-assisted interview is called the Semi-Structured Assessment for Drug Dependence and Al-coholism (SSADDA) [17].
A total of 4964 subjects with 1888 from small nuclear families and 3076 unrelated individuals were aggregated for the opioid use study. We included unrelated individuals in the analysis, because they contribute to phenotypic variance estimation even though they have no effect on covariance estimation. There are 23 questions in the opioid dependence section of the SSADDA, resulting in 220 clinical variables. These variables represent features of opioid use and related behaviors, including age of onset and frequency of opioid use, the occurrence of psychosocial and medical consequences of opioid use, etc. Of the 220 variables, 69 were identified and used as key features for the purpose of subtyping opioid use and related behaviors in a previous study [21]. We used these selected features in the current analysis.

We ran the proposed algorithm on this dataset and we set  X  from 0 to 10 with a step size of 1. Estimated heritabil-ity of the derived quantitative traits is reported in Figure 2, which also shows the percentage of clinical variables that were selected by the 1 norm sparse regularization in our analysis. As was observed in the synthetic data, the her-itability dropped when as features were removed from the model. We obtained the highest heritability, approximately 1, at  X  = 0, where all features were used in the model. The lowest heritability of 0.9543 was obtained at  X  = 10, where less than 44% of the features were selected for use in the model.
 Figure 2: Heritability estimates of derived quantitative traits for opioid use and related behaviors when  X  varies (marked by diamonds) and the percentage of clinical vari-ables included in the corresponding models (marked by tri-angles).

We also examined the 10 clinical features that received the highest weights in the model. Figure 3 shows the coef-ficients w of these 10 clinical features (i.e., when  X  = 10). The clinical questions corresponding to these 10 variables are listed below. These features may be worth investigating in future genetic studies of opioid dependence. Figure 3: Weights of the top 10 variables used in the model that characterized a quantitative trait of opioid use and re-lated behaviors.

We compared the proposed approach with a cluster anal-ysis method published recently [21], which created a quanti-tative trait of estimated heritability of 0 . 76 using the same data. In the original study using this approach [21], it was applied to a larger sample, which included the current data as a subset and yielded five clusters, with the highest esti-mated heritability of the clusters being 0 . 76. The heritabil-ity was estimated using the same function in the SOLAR.
Another cluster analysis method [5] was also applied to the same sample used in our study. The highest heritability that the method in [5] achieved in its derived quantitative traits was 0.66. Using the proposed method, we were able to derive quantitative traits that approximated the highest possible heritability, which demonstrated a clear benefit of our algorithm.
Phenotype data were collected for a set of 9436 subjects for the studies of cocaine use and related behavior. Of these 9436 subjects, 2268 were from small nuclear families; and 7268 of them were unrelated individuals. The sample over-lapped with the one used for opioid dependence, but the vari-ables were derived from a different section of the SSADDA interview. The cocaine use section of the SSADDA contains 25 questions on (1) age of onset, frequency, and intensity of cocaine use; (2) route of cocaine administration; (3) occur-rence of psychosocial and medical consequences of cocaine use; (4) attempts to quit cocaine use; and (5) cocaine abuse treatment sought and received, resulting in 160 variables. There were 68 variables identified as key variables in the derivation of highly heritable quantitative traits for cocaine use and related behaviors [12]. We used these variables as inputs in the proposed method.

Similar to the analysis on opioid use data, we also ran our algorithm with  X  ranging from 0 to 10 with a step size of 1. Figure 4 reports the heritability of the derived traits and the percentage of clinical variables retained in the model. Heritability decreased when fewer features were used in the quantitative trait model. We reached the highest heritability of 0.88 when  X  = 0 and the corresponding quantitative trait used all clinical features. The lowest heritability was 0.87 when  X  = 10, where more than 54 % of the clinical features were ruled out. Even when the number of features used in the formation of the traits was significantly reduced, the heritability of the resulting trait was more or less stable. The results suggested that the phenotypic and clinical features of cocaine use and related behaviors appeared to be less heritable than those of opioid use.
 Figure 4: Heritability estimates of derived quantitative traits for cocaine use and related behaviors when  X  varies (the diamond line) and the percentage of features included in the corresponding models (the triangle line).

The 10 clinical variables that received a large magnitude of weights when  X  = 10 were examined. Their corresponding weights are shown in Figure 5. The questions corresponding to these 10 variables are listed as follows: Figure 5: Weights of the top 10 variables in the model that characterizes the quantitative trait for cocaine use and re-lated behaviors.

A subset of our cocaine-use data was employed previously in [12] to derive highly heritable quantitative traits for co-caine use and related behaviors. The highest heritability reported in [12] was 0.5. We applied that cluster analysis method to the same sample used in this study to search for highly heritable traits, and the highest heritability we could find was 0.644. Instead, the proposed method achieved a quantitative trait with a much higher heritability (i.e., 0.88).
A subset of pedigrees consisting of 2,544 extended families and 19,097 individuals selected from a large cattle pedigree data set (downloaded from http://aipl.arsusda.gov/eval.htm ) were used in our analysis. All individual bulls are of Holstein breed and are from the United States. Among the 19,097 individuals, 10,216 bulls were evaluated on 38 quantitative traits, such as reliability of yield and average number of lactations per daughter. We first estimated the heritability for all 38 individual traits and found 11 traits with low-to-moderate heritability. Of these 11 traits, 8 had an estimated heritability less than 0.35, and the other three had an esti-mated heritabilities of 0.64, 0.65 and 0.73. We ran our algo-rithm on the 11 traits to derive highly heritable quantitative traits. Similar to the analysis for human subjects, we tested multiple choices of  X  ranging from 0 to 10.

The heritability estimates of the derived traits when  X  varies are plotted in Figure 6 together with the percentage of features remaining in the model. As expected, we ob-tained the highest heritability of 0.907 when  X  =0. The heritability decreased slightly when  X  increased, with the lowest heritability of 0.898 when  X  = 10. Two features are dropped by the model when  X   X  6. All of the 11 derived traits had a higher heritability than that of any single input trait, which shows the effectiveness of our algorithm when heritability is estimated using extended pedigrees. Figure 6: Heritability estimates of derived quantitative traits of dairy cattle when  X  varies (the diamond line) and the percentage of features included in the corresponding models (the triangle line).
Discovering genetic risk factors for complex diseases is an important task in medicine and biology. The power of most genotype-phenotype association studies is positively associ-ated with the heritability of the quantitative traits stud-ied [2]. However, for many complex diseases, such as sub-stance use disorders, currently no highly heritable quantita-tive traits are available, despite the fact that twin studies show them to be heritable diseases [11]. There is a lack of effective methods to derive such a trait, a problem that is exacerbated by the complicated structure of their clini-cal features. Researchers have been using cluster analysis to identify subgroups of a study population and then de-rive cluster-based quantitative traits to maximize heritabil-ity and homogeneity of the clinical features [12, 5, 21]. How-ever, all previous approaches search for quantitative traits without explicitly maximizing heritability, using heritability only as the evaluation metric.

In this paper, we have proposed a quadratic optimiza-tion problem to derive quantitative traits of a linear form y = x w by explicitly maximizing heritability. We searched for the optimal w that maximizes the log likelihood in the heritability estimation. An optimization algorithm based on the framework of sequential quadratic programming was de-veloped to efficiently solve the proposed formulation. The proposed approach was evaluated on synthetic data and three real-world problems. The empirical results demon-strate the effectiveness of the proposed approach to the iden-tification of highly heritable quantitative traits. Comparing the results with those from existing cluster analysis meth-ods on the two real-world substance dependence data sets clearly showed that the new approach was superior. Our future work will include a more thorough evaluation of the proposed method on multiple other datasets that represent difficult subtyping problems. We plan to implement the pro-posed method with a few more choices of other regulariza-tion terms, such as the 1 , 2 -norm discussed in an early sec-tion of this paper. These different regularization terms can help to deal with complex data structures in the clinical fea-tures, such as the different groups of clinical features in the opioid and cocaine use datasets. This work was supported by NIH grants DA12849, DA12690, AA03510, AA11330, and AA13736 and Philadelphia VA Mental Illness Research, Education, and Clinical Centers (MIRECCs). [1] L. Almasy and J. Blangero. Multipoint quantitative [2] D. J. Balding, M. J. Bishop, and C. Cannings. [3] C. Braet and W. Beyers. Subtyping children and [4] P. R. Burgel, N. Roche, J. L. Paillasseur, D. Caillaud, [5] G. Chan, J. Gelernter, D. Oslin, L. Farrer, and H. R. [6] D. S. Falconer and T. C. Mackay. Introduction to [7] J. Gelernter, C. Panhuysen, R. Weiss, K. Brady, [8] J. Gelernter, C. Panhuysen, M. Wilcox, [9] D. C. Glahn, J. E. Curran, A. M. Winkler, M. A. [10] W. G. Hill and N. R. Wray. Heritability in the [11] K. S. Kendler, K. C. Jacobson, C. A. Prescott, and [12] H. R. Kranzler, M. Wilcox, R. D. Weiss, K. Brady, [13] K. Lange, J. Westlake, and M. A. Spence. Extensions [14] M. J. Niciu, G. Chan, J. Gelernter, A. J. Arias, [15] J. Nocedal and S. J. Wright. Numerical Optimization . [16] C. I. Panhuysen, Y. Yu, L. A. Farrer, H. R. Kranzler, [17] A. Pierucci-Lagha, J. Gelernter, G. Chan, A. Arias, [18] A. P. Reynolds, G. Richards, B. De la Iglesia, and [19] A. P. Reynolds, G. Richards, and V. J.
 [20] J. Shawe-Taylor and N. Cristianini. Kernel Methods [21] J. Sun, J. Bi, G. Chan, D. Oslin, L. Farrer, [22] M. Weatherall, J. Travers, P. Shirtcliffe, S. Marsh, [23] D. Williams, R. De Silva, D. Paviour, A. Pittman,
