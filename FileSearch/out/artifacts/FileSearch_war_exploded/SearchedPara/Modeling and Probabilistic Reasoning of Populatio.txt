 The Great East Japan Earthquake and the Fukushima nu-clear accident cause large human population movements and evacuations. Understanding and predicting these movements is critical for planning effective humanitarian relief, disaster management, and long-term societal reconstruction. In this paper, we construct a large human mobility database that stores and manages GPS records from mobile devices used by approximately 1.6 million people throughout Japan from 1 August 2010 to 31 July 2011. By mining this enormous set of Auto-GPS mobile sensor data, the short-term and long-term evacuation behaviors for individuals throughout Japan during this disaster are able to be automatically discovered. To better understand and simulate human mobility during the disasters, we develop a probabilistic model that is able to be effectively trained by the discovered evacuations via machine learning technique. Based on our training model, population mobility in various cities impacted by the dis-asters throughout the country is able to be automatically simulated or predicted. On the basis of the whole database, developed model, and experimental results, it is easy for us to find some new features or population mobility patterns after the recent severe earthquake, tsunami and release of radioactivity in Japan, which are likely to play a vital role in future disaster relief and management worldwide. H.4 [ Database Management ]: Data mining; H.4 [ Database Management ]: Spatial databases and GIS human mobility, disaster informatics, data mining
The 9.0 magnitude Great East Japan Earthquake [1] oc-curred on 11 March 2011 off the east coast of Honshu, Japan X  X  largest island. Since modern record keeping began in 1900, this is considered the most powerful earthquake to have oc-curred in Japan and is one of the five most powerful histori-cal earthquakes worldwide [1]. The Japanese National Police Agency confirmed 15,881 deaths [2], 6,142 injured [2], and 2,668 missing persons as well as 128,801 buildings damaged or destroyed across 18 prefectures [2]. The earthquake and the tsunami that followed severely damaged the Fukushima Daiichi nuclear power plant, causing the most extensive re-lease of radioactivity since the 1986 Chernobyl accident in the former Ukraine [3]. The three separate events (earth-quake, tsunami, and release of radioactive materials) cre-ated an unprecedented composite disaster that significantly impacted the people of Japan. In the wake of a disaster of this magnitude, it is very important to record people X  X  movements following the event to analyze their behavioral patterns and to develop simulation or predictive models for future disaster mitigation. The types of data, evacuation be-havior pattern, and simulation model available following the Great East Japan Earthquake and the Fukushima Daiichi nuclear power plant meltdown are unique in human history, and are likely to play a vital role in future disaster relief and management worldwide.

Therefore, in this paper, we constructed a population mo-bility database that stored and managed daily GPS records from approximately 1.6 million individuals throughout Japan over one year. By mining the whole database, we attempted to analyze and model evacuation behaviors of people during the Great East Japan Earthquake and ensuing Fukushima nuclear accident. Meanwhile, we developed a probabilis-tic inference model to effectively represent people X  X  mobil-ity patterns during the disaster to better understand hu-man evacuation behaviors in general, and to understand how those behaviors were impacted by various city states under disasters. Moreover, based on our training model, our objec-tive was to simulate or predict population mobility in various cities throughout Japan in an effort to inform future disaster relief and management (as shown in Fig.1).

The remainder of this paper is structured as follows: In the following section, we will introduce the evacuation be-haviors discovery. Section 3 and 4 provide the details about evacuation behavior model learning and inference. Experi-mental results are presented in Section 5. Related work is briefly reviewed in Section 6, and the paper is finally sum-marizedinSection7.
The Great East Japan Earthquake and Fukushima nuclear accident cause large population movements or evacuations. Obviously, analysis of these movements and evacuations in short-term and long-term will play a vital role for planning effective humanitarian relief and disaster management in the future. In this section, we present the details relating to the discovery of people X  X  evacuation behavior through enormous set of Auto-GPS mobile sensor data.
For each person, the history geographic location are a se-ries of geographic position with its longitude, latitude and time period. Let X k ( t, T period )= { p k ( t, d ): d  X  denotes the history geographic locations of person k in time t ( t  X  T time ) during period T period ,where p k ( t, d )isitsge-ographic position in time t of day d , its geographic location distribution is represented by  X  bins distribution by:
L k ( t, T period )= {  X  ( n ;  X  ( p k ( t, d )) ,d  X  T period where  X  ( p k ( t, d )) is a function that computes the bin index associated with the geographic location,  X  ( n ;  X  ( p k ( t, d )) ,d T period ) denotes the probability of person k will appear in location index n at time t during the period T period .The example of this distribution is shown in Fig.2, and the size of the circles indicates the probability of staying location of an individual person at a specific time; larger circles indicate higher probability that persons stay or live there. Blue and orange circles indicate this distribution before and after the earthquake respectively. Based on this distribution, it is easy for us to find some regular and important places for each people, such as home, working area and etc.
To discover the evacuations during the disasters, we can compute the similarity of geographic location distribution for individual person before and after the earthquake re-spectively, and if the similarity is large enough, this person X  X  behavior is able to be seem as an evacuation (as shown in Fig.2). Here, we utilize the Jaccard Coefficient [4] to mea-sure the similarity, and the coefficient  X  for before earth-quake period T before period and after earthquake one T after to be calculated as follows: Therefore, based on this similarity, people X  X  evacuations in short-term or long-term is able to be automatically discov-ered by mining the whole Auto-GPS mobile sensor database. Some examples of the discovered evacuations during the dis-aster are shown in Fig.3-A, and all these discovered evacua-tions form a sample dataset for further training or testing.
To understand, simulate and predict human mobility dur-ing severe disasters, we need a concise model to effectively represent these discovered evacuations or movements. In this research, we develop a probabilistic inference model and utilize the discovered human evacuations to train its param-eters via machine learning technique. We assume in this paper that our collected Auto-GPS mobile sensor data are representative of the general population movements during the disasters. The creation of this type of inference model is possible because social interactions, transportation net-works, and political responses in some given cities (except for some highly destroyed cities) are typically stable through time, and large population movements (which are often in-fluenced by these conditions) are likely to remain the same following different disasters.

To generate the probabilistic inference model, there are mainly two stages: evacuation graph construction and infer-ence model learning (as shown in Fig.3 and Fig.4). Firstly, we construct the people X  X  evacuation graph in some affected regions based on the geographic location distribution and the training samples of people X  X  evacuations, and its node parameters and edge connections are able to be learned by collaborative learning [5]. Secondly, given the learned evac-uation graph, we develop the reasoning model based on the Markov Decision Process (MDPs) [6], and utilize Inverse Reinforcement Learning [7, 8] to train its parameters. In this section, we present the further details relating to this probabilistic inference model development and learning.
To construct the evacuation graph, we firstly need to dis-cover connected geographical areas during disasters with the discovered evacuations (as shown in Fig.3). Here, we define people X  X  evacuations as follows:
Definition 1. (Evacuation): Let E k = { p b k , p 1 k , ... p denotes the evacuation of person k ,where p b k and p a k major residential location before and after the earthquake respectively, and they are the highest probability location of person k based on its geographic location distribution. { p k , ... p n k the disasters (as shown in Fig.3-A).
 We divide the geographical range into disjoint cells by a given cell length l . The set of the cells is denoted as c ,and the its grid ID is represented by ( x, y ). Thus, the specific position of the evacuation is able to be mapped into a cell, and overall evacuation is transformed into a sequence of cells as p k locates in. Given two cells c ( x, y )and c ( x ,y ), the c and c are called spatially close if | x  X  x  X  1 | and | y  X  y
To explore connected geographical regions, we need to de-fine correlated relations among evacuations. Given a cell verses cell c , denoted c  X  E k .If E k traverses from cell c to c , it is represented by c  X  c  X  E k ,andthetraveltimeis represented by  X  ( c  X  c ,E k ). Thus, the spatio-temporally correlated relation (st-correlated) of evacuations is defined as:
Definition 2. (Spatio-temporally Correlated Relation): Given two evacuations E i and E j , and a temporal constraint  X  , their sub-trajectories tra i = { p n i , ... p n i } and tra , where tra i  X  E i , tra j  X  E j , are correlated if (1)  X   X  t 1  X   X  ( c p n (2) one of the two rules is satisfied: In addition, we define the connection support as follows: Definition 3. (Connection support): Given a set of cells C , two specific cells c, c  X  C , where they are spatially close, the connection support of the cell pair ( c, c ) is defined as |
Q 1  X  Q 2 | ,and Q 1 = { ( tra i ,tra j ) } , where its sub-trajectories tra i and tra j are st-correlated, and c  X  c  X  tra i , c  X  c  X  tra j ,forsome c  X  C  X  X  c, c } ,and Q 2 = { ( tra i ,tra where its sub-trajectories tra i and tra j are st-correlated, and c  X  c  X  tra i , c  X  c  X  tra j ,forsome c  X  C  X  X  c, c } Hence, the neighbor cells and enclosed cells are able to be defined as:
Definition 4. (Neighbor cells): Given a set of cells C ,two specific cells c, c  X  C , and a minimum connection support K , if the connection support of the cell pair ( c, c )isgreater than or equal to K , c and c are neighbor cells, denoted as neighbor ( c, c ).
 Based on above definitions, the region as a connected geo-graphical areas and the enclosed cell are defined as:
Definition 5. (Region): Given a set of cells C ,itformsa region if for any two cells c, c  X  C , there exists a chain of cells ( c =) c 1 = c 2 = ... = c n , s.t. neighbor ( c i ,c c  X  C and i  X  [1 ,n ).

Definition 6. (Enclosed cells): Given a set of cells C and acell c  X  C ,the c is enclosed if there exists a region r C, s.t. c, c  X  r ,  X  c  X  X  c | c and c are spatially close ,c C } .

Hence, to construct the regions, we can generate all cell pairs from the set of cells C and then compute the con-nection support of each cell pair by checking other cells in C . We then verify whether the connection supports of cell pairs satisfy the given minimum connection support K to construct regions (as shown in Fig.3-B). Moreover, the computational cost is able to be reduced by building up a grid index [5] in which each cell has a unique grid ID, a value grid ( c ), and a corresponding evacuations list, where grid ( c )= |{ E | c  X  E,E  X  D }| . Therefore, the overall algo-rithm of region construction is detailed in Algorithm 1 and Algorithm 2.
Once the nodes in the evacuation graph are generated, we then need to infer edges and derive some edge information, such as travel frequency, travel time and etc. In this re-search, the evacuation graph is a directed graph G =( V,E ), where V is a set of vertices and E is a set of edges. Each vertex v represents a geographical area, and the directed edge e indicates a transition relationship, including travel frequency and travel time.

Given the constructed regions R , and the discovered evac-uation dataset D , we utilize these evacuations traversing the regions to derive edge connections and information within regions. For each evacuation traversing the region, we infer the shortest path between any two consecutive points of the evacuation by virtual bidirected edges in the region, and the travel time of each edge is estimated by the median of all the travel times of the edge. In addition, the travel frequency of each edge is able to be estimated by recording the number of traversing evacuations. Similarly, we can also generate edges between regions: if some evacuations traversers from one region to another region, the edges is constructed be-tween the two regions (as shown in Fig.3-C), and its edge information is estimated by the same methods as previous discussions.
Based on the constructed evacuation graph, the inference model is able to be developed by using the Markov Deci-sion Precess (MDPs). MDPs provide a natural framework for representing sequential decision making, such as evacu-ating through various of geographical areas. In MDP theory, the agent takes as sequence of actions ( a  X  A ), which tran-sition between states ( s  X  S ) and incur and action-based cost ( c ( a )  X  ). The agent is trying to minimize the sum of costs while reaching some destination, and the sequence of action is called a path  X  .ForMDPs,asetof features ( f a  X  ) characterize each action, and the cost of the action is a linear function of these features parameterized by a cost weight vector (  X   X  ). Path feature, f  X  are the sum of the features of actions in the path: a  X   X  f a .Thus,thecost weight applied to the path features is:
In our problem, the evacuation graph provide us a deter-ministic MDP, the geographical region (nodes) is able to be seem as state ,theedgeisthe action ,andthe path is the peo-ple X  X  evacuation (as shown in Fig.4). These evacuations are parameterized by their path feature f  X  . For instance, a per-son X  X  evacuation can be described by: evacuating through region A ( d =25 km , type = small )toregionB( d =55 km , type = midle ), and finally stayed in region C ( d =65 km , type = large )withroute1( frq =0 . 53, time =0 . 72) ( A  X  B )anroute2( frq =0 . 23, time =0 . 52)( B  X  C ), where d is the distance from earthquake or nuclear power plant position, type the city types, frq the travel frequency of the route, time is the travel time of the route, and etc. Hence, we need to utilize all the discovered evacuations to train a MDPs model that is able to optimally demonstrate these people X  X  behavior during the disasters. Obviously, this is an Inverse Reinforcement Learning problem. In this study, we utilize the Maximum Entropy Inverse Reinforce-ment Learning algorithm [7, 8] to train the overall simulation model.

Based on the Maximum Entropy Principle , the path dis-tribution is able to be defined as: Hence, the cost weight vector  X  from demonstrated behav-ior is learned by maximizing the entropy of the distribution over paths subject to the feature constraints from the dis-covered evacuations, and it implies that we maximize the likelihood of the observed data under the maximum entropy distribution as: This function is convex for deterministic MDPs [8] and the optima can be obtained using gradient-based optimization methods. The gradient is the difference between expected empirical feature counts and the learner X  X  expected feature Algorithm 3: Expected Action Frequency Calculation
Input: Cost weight  X  , initial state s o , and goal state Output: Expected action visitation frequencies G a i,j . counts, which can be expressed by: where G a is the expected action visitation frequencies, and is able to be computed by enumerating all paths and proba-bilistically count the number of paths and times in each path the particular state is visited as Algorithm 3 and Eq.(7).
Algorithm 3 employs a more tractable approach by find-ing the probabilistic weight of all paths from the origin s a specific action a , Z a =  X  action a to the goal g , Z a =  X  from the origin to the goal, Z o = Z g =  X  Hence, the expected action visitation frequencies G a is com-puted by:
In summary, the inference model is able to be trained by finding the cost weight parameters with Eq.(5), Eq.(6), Algorithm 3 and Eq.(7) through the discovered evacuation dataset D . With this training model, the people X  X  movement or evacuations during some future disasters is able to be easily simulated or predicted.
Based on the trained probabilistic inference model, peo-ple X  X  evacuation or movements is able to be simulated or predicted for some similar disasters in the future. We uti-lize the Bayes X  X  rule to perform this probabilistic inference: given the partial observed evacuations (such as some evacu-ations during first several hours after disasters),  X  A  X  posterior probability of the destinations is able to computed by: where P (dest) is the evacuation prior in a region A ,andit depends on the popular route inference [5] in the evacuation graph, and P (  X  A  X  B | dest ,  X  ) is likelihood, which is depended on: and Eq.(9) is able to be easily inferred by taking the sums over paths from A to B to each possible destination using the forward pass of Algorithm 3.

Hence, the possible people X  X  evacuation destination or route can be simulated or predicted by the Maximum a Posteriori (MAP) estimation of Eq.(8).
The whole database contains GPS records of approxi-mately 1.6 million anonymized users throughout Japan from 1 August 2010 to 31 July 2011, which contains approxi-mately 9.2 billion GPS records, more than 600GB csv files. The visualization of human mobility in Greater Tokyo Area during the earthquake is shown in Fig.5. From this figure, we can clearly see that the urban transportation before the earthquake was very busy (Fig.5-A,B). In contrast, after the earthquake, the transportation network of whole Greater Tokyo Area was almost stalled (Fig.5-C,D).
Generally speaking, most severe disasters cause large pop-ulation movements and evacuations. But serious radioactive releases were a bit different from the traditional natural di-aster [9], because its real affection was still uncertain to hu-man society, and will last for a very long time. Facing such kind of unfamiliar disaster, people did not have direct feel-ing of its destructiveness, and their evacuations were usually influenced and caused by government declarations or vari-ous kinds of news reporting. To capture this influence, we collected government declarations [10, 11] as well as news reports from NHK in Japan [12] and other mainstream me-dia from around the world [11] from 11 March to 31 March 2011. Based on this information, we divided the Fukushima nuclear event into four temporal stages and analyzed evac-uation behaviors at these different sampling time periods. These stages included: (1) a period of early government dec-larations following the Fukushima nuclear event (12 March to 14 March 2011) before the significance of the event was fully known, (2) a period where the seriousness of the nu-clear accident was more fully known (15 March to 19 March 2011), (3) a period where the nuclear event was beginning to be described through worldwide news reports (20 March to 23 March 2011), and finally (4) a period where the sig-nificance of the release of radioactive materials was more fully understood and described over worldwide news reports (24 March to 31 March 2011). The discovered evacuations during distinct sampling periods in Fukushima, Miyagi and Iwate prefectures are shown in Fig.6. Meanwhile, to get a overview of population distribution before and after the earthquake, we show (Fig.6-H) the residential distributions in Fukushima, Miyagi, and Iwate prefectures 161 days before the earthquake and 20 days after the earthquake.

On the other hand, to further analyze people X  X  evacua-tions after this catastrophic disaster, we show (Fig.7) pop-ulation change rate in Fukushima, Miyagi, and Iwate pre-fectures from short-term to long-term. As shown in Fig.7, we found that 12 days after the earthquake, the popula-tions of Futaba (Fukushima), Onagawa (Miyagi), Kesnnuma (Miyagi), Minamisoma (Fukushima), Kamashi (Iwate), Ishi-nomaki (Miyagi) substantially decreased by 50% or more (Fig.7-E). In contrast, the populations of Hanamaki (Iwate) and Izumi Ward of Sendai (Miyagi) increased slightly (Fig.7-E), suggesting that people may have taken refuge in these areas. Twenty days after the earthquake, as the nuclear accident became more serious, the populations in Futaba (Fukushima) and Minamisoma (Fukushima) continued to decrease rapidly while populations of other disaster-impacted areas increased slightly where people may have chosen to return to their homes (Fig.7-E). Fifty days after the earth-quake, the populations in most of the disaster areas, except for Futaba (Fukushima) and Minamisoma (Fukushima), con-tinued to increase slightly (Fig.7-E). Eighty-one days after the earthquake, the populations in all disaster areas stabi-lized (Fig.7-E).
Based on our initial evaluation of movement behaviors following the composite disaster in Japan, we determined that movements were influenced by government declarations and news reports and that population movements differed over different stages of the Fukushima nuclear accident. Ac-cordingly, we used discovered evacuations within respective sampling periods of the disaster stages to construct evacu-ation graph (Fig.8) for Fukushima, Miyagi, and Iwate pre-fectures in Japan. Based on this graph, we were able to identify critical evacuation routes as well as urban patterns and connections between different disaster areas (Fig.8A-E). In addition, according to the evacuation graph, we found that from 12 March to 23 March 2011, the graph structure was very similar despite with the different learned parame-ters (Fig.8B,8C,8D), suggesting that evacuation patterns in these areas share similar characteristics. For instance, peo-ple tended to evacuate from the most heavily impacted areas and sought shelter in large neighboring cities or government-appointed shelters.

Meanwhile, given any specific area or cities (with its pa-rameters or states) in Fukushima, Miyagi, and Iwate pre-fectures, and some partially observed people X  X  evacuation trajectories, our training model is able to automatically sim-ulate or predict their population evacuations or mobility. To show the simulation results, we assumed that the same dis-aster (earthquake and release of radioactivity) occurred at the same places, and let the training model simulate pop-ulation mobility. In other words, we can easily reproduce the mobility of population during the disasters. We show the simulation results (Fig.9) of some major disaster ar-eas at different stages of this event, such as Minamisoma (Fukushima), Iwaki (Fukushima), Ishinomaki(Miyagi) and Wakabayashi Ward, Sendai (Miyagi).

On the other hand, based on the training model, we try to recommend some safe and fast evacuation routes if some similar disaster occur. Here, we assume that the high fre-quency routes during the diaster are usually the safe ones. Hence, we find the high frequency and fastest (low travel time) ones in the evacuation graph between origin and des-tination, and recommend them as evacuation routes during some possible disasters. Some selected results are shown in Fig.10.
To evaluate simulation results, we performed K-fold cross-validation. The discovered evacuation samples were ran-domly partitioned into three sub-samples: one sample was used as validation data while the other two were used as training data. The cross-validation process was then re-peated three times, with each sub-one used exactly once as validation data. For each repetition, we computed the Jaccard similarity coefficient [4] between simulation results obtained by the training model and real evacuation distribu-tion in testing samples for some major disaster areas (some high weight nodes) in Fukushima, Miyagi, and Iwate prefec-tures. For comparison, we evaluated the average simulation accuracy (Table 1) of the five models trained over both the five separate stages of the disaster (as discussed in the pre-vious section) as well as over the full period of evacuations (11 March to 31 March 2011). Wakabayashi Ward 63.77% 77.35%
According to this evaluation (Table 1), we found that the five-stage training model that considered the influence of government declarations and news reporting significantly improved simulation results, especially for the cities of Fukushima prefecture that were highly impacted by Fukushima nuclear accident. In addition, for most areas of the three prefec-tures, the simulation results of our training model reached above 80% accuracy.
Recently, a number of studies on human mobility patterns during disasters have been proposed [13, 14], mainly focus-ing on small-scale and short-term emergencies (e.g. crowd panics and fires). However, research on the dynamics of pop-ulation movements on a national scale during large-scale dis-asters (e.g. earthquakes, tsunamis, and hurricanes) is very limited [9], likely the result of difficulties in collecting rep-resentative longitudinal data in places where infrastructure and social order have collapsed [15] and where study popula-tions are moving across vast geographical areas [9]. In con-trast, auto-mobile sensor data offer a new way to circumvent methodological problems of earlier research because they of-fer high temporal and spatial resolution are instantaneously available, have no interview bias, and provide longitudinal data for very large populations [16, 17, 9, 15, 20, 21]. Mean-while, human mobility or trajectory data mining [18, 19, 22] have become a very hot topic in various research fields.
In this paper, we constructed a large population mobility database and have shown the population mobility patterns following the Great East Japan Earthquake and Fukushima nuclear accident. Meanwhile, we developed a general proba-bilistic model to simulate or predict population evacuations over complex geographic features in Japan in response to fu-ture disasters, and experimental evaluations demonstrated that the simulation or prediction of large population mobil-ity in severe disasters were sometimes possible.

We note several limitations within our study. The popu-lation mobility database used was constructed from mobile devices and did not incorporate data from some representa-tive portions of the population (i.e. people who did not own mobile devices or did not register for GPS service could not be incorporated into this study). Additionally, data were slightly biased towards younger age groups who were more likely to own GPS-based equipment than older age groups. However, we are confident that the data, which offers move-ment behaviors for the approximately 1.6 million people in-cluded in the database, are reflective of general movement patterns in the country following the composite disaster. A second limitation of our study was related to the difficulty in extrapolating movement patterns predicted by our simula-tion model for use in places outside of Japan or non-affected places by this disaster. Moreover, the actual performance of this model was difficult to be fully evaluated, except some similar events occur again in Japan. This work was partially supported by Grant of Japan X  X  Ministry of Land, Infrastructure, Transport and Tourism (MLIT), and DIAS/GRENE project of Japan X  X  Ministry of Education, Culture, Sports, Science, and Technology (MEST). We specially thank ZENRIN DataCom CO., LTD for their supporting.
