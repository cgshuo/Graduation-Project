 Sanad Al-Maskari 1( Big cities around the world are facing serious air quality and air pollution prob-lems, which prompted governments to introduce more tightened emission and safety regulations. The study of gas identification and measurement using chemo-sensors known as electronic noses, is important in emission control. E-noses can provide an economical solution for air quality and air pollution monitoring. Despite their popular usage, they suffer from serious problems such as drift, noise, selectivity and their inability to provide true concentrations [ 1 , 2 ]. analytes [ 3 ]. Various applications exist for e-nose including: agriculture, disease detection, foods and beverages, air quality and environment protection, water and waste water quality control [ 3 , 4 ]. Despite their wide applications, they are very susceptible to noise and drift, making them unstable. The stability issue can be resolved via periodic recalibration. Unfortunately, recalibration process is an expensive and complex task. Compensation for the need of periodic recalibra-tion and ability to postpone the recalibration period using machine learning will need to solve the aforementioned dynamic matters. In general, the performance of e-noses is affected by drift and noise. Sensor drift is unpredictable degradation of sensor sensitivity and selectivity over time. The degradation can be due to sensor poising, sensor ageing, and environmental fluctuations such as humidity, temperature, pressure and system sampling non-specific adsorption [ 1 , 2 ]. In con-trast, noise is random signal deviation caused by unknown effect. Sensor noise can be due to electronic circuit error, environmental effects, sensor poising and aging. Because sensor drift is not deterministic, it is difficult, if not impossible, to distinguish it from noise and vice versa [ 5 ].
 means of a chemical measurement system. In this paper, we propose a new app-roach to detect gas types together with the quantification of the detected gases in a dynamic environment. The fundamental idea of our approach is to detect the gas types first, then the confidence of this prediction can be measured. After that, the quantification of the detected gases with high confidence can be car-ried out by using a regression approach. The primary contributions of our work are as follows: (1) An ensemble classifier of Kernel Fuzzy C-Mean with Fuzzy Support Vector Machine (FCQM-KFSVM) is trained in different chunks of the data. (2) We present a technique to estimate classifier confidence scores. (3) We focus on improving the model sensitivity to air quality exposure limits rather than attempting to predict just gas concentrations. (4) We present a new frame-work by integrating classification and quantification technique with confidence evaluation to address both of concept drift, identification and quantification of gases in a dynamic environment.
 work. Section 3 describes the Methodology. Our proposed approaches of fuzzy based classification, confidence scores and Scalable gaussian quantification method will be introduced. Section 4 describes the experiments and evaluates the results. Finally, Sect. 5 concludes our paper. The ultimate goal of electronic e-nose outdoor air quality monitoring systems is to identify and quantify gases in the ambient air. Chemo-sensors has the ability to measure a specific gas concentration in a mixture of gases using a chemical interface. The chemo-sensor interface interacts selectively with predefined gases. These sensors have the ability to measure gas concentrations with good accuracy in a closed environment. Installing e-nose in an outdoor environment introduces many challenges such as noise, drift and high uncertainties. Several machine learning models including Self Organizing Maps (SOMs), multiple SOM, and neural networks have been used for gas identification [ 6  X  8 ]. Various quantifica-tion methods have been used in the literature such as Support Vector Regression (SVR), partial least squares regression (PLS), and Artificial Neural Network (ANN). Desai et al. used SVR in soft sensor applications to demonstrate the conversance and generalization capability of SVR. Feed forward neural networks (FFNNs) were used by Gulbag and Temuras [ 9 ] to quantify two gas concen-trations (trichloroethylene and acetone). Linear regression methods such PCR and PLS have been used in the literature due to their ability to reduce the dimensions before fitting a regression function [ 10 , 11 ]. In [ 12 ] they use gaussian process to recalibrate the sensors while in our work we do not calibrate the sen-sors. Instead we are interested in identifying then quantifying gas concentrations levels without recalibration.
 Large portions of the existing work have focused on odour classification using chemo-sensors and few attempts have been made to address the quantification part. Moreover, very few works in the literature have focused on a holistic app-roach that considers gas type detection and concentration measurement using e-noses for air quality monitoring system. This motivated us to introduce a new methodology which is different than other problems found in the literature. On this research we are interested in a model able to classify and quantify data instances while taking into considerations confidence scores, underestimation and overestimation rates of gas concentrations. In this section we formulate a new data mining research problem which is applica-ble for real world applications such as air quality monitoring. We attempt to predict air quality level with high confidence rather than predicting gas con-centrations with high accuracies. Therefore, the proposed model should tolerate overestimation and be more sensitive to underestimation of high concentrations. Problem Definition. Consider a multi-class classification problem with a set of features x produced by a gas sensor. Let S 1 ,...,S t be a batch of examples received from e-nose sensor at time interval t . S t consists of labeled L and unlabeled U exam-ples, S = L  X  U . The labeled sets L t = { ( x 1 t ,y 1 t size tn where x nt  X  R N and y nt  X  X  1 ,...,M } where M refers to the class label (gas type) of instance x nt and m  X  M . Gas concentration for instance x resented by z nt where z nt &gt; 0. The unlabeled examples of size tn are given by U = { x where Y  X  X  1 ,...,M } , indicating the class label of a labeled example x N  X  X  0 , 1 } , indicating whether a given example S is labeled ( N = 1) or unlabelled ( N = 0). Each Instance in L is labeled, represented by &lt;S,Y Consequently, each instance in U is unlabeled and can be represented by &lt;S,Y =? ,N =0 &gt; . Our objective is to train classifiers f set T ( L ) and a validation set V ( U ) such that the unlabeled gas data U can be cor-rectly classified with high confidence  X  . The classification decision process is made by applying all classifiers represented by f p for p  X  X  1 ,...,P sample x nt  X  U and predicting the gas type  X  y nt for which the corresponding clas-sifier reports the highest confidence score: 3.1 System Architecture Gas type detection together with quantification is an unsolved challenge. Differ-ent gases may be present in the atmosphere which will reduce sensor selectivity for differentiating different types of gases. Furthermore, as explained previously, sensors are subject to high uncertainties due to environmental changes. More-over, chemo-sensors suffer from drift and noise. Therefore, the identification and quantification models should consider all the variabilities surrounding e-nose sensors. To address these issues we propose a three stage approach. At the first stage, we construct multiple FCQM-KFSVM classifiers to detect the gas type. At the second stage, a confidence evaluation is conducted to evaluate the prediction generated by all classifiers. Only samples with high confidence will be passed to the third stage for quantification. For each gas type (class) a corresponding training data is created for gas quantification measurement. Finally, at the third stage, the concentration of the predicted gas is estimated using FCQM-SGP. Fig. 1 illustrates the full life cycle of the proposed approach.
 3.2 Feature Extraction The performance of e-nose classification is highly dependent on the effectiveness of features being used. Features that provide high discrimination power between different classes will result in a better classification performance for a learning model. The practical value of metal oxide-based gas sensors is affected due to their poor selectivity, sensitivity, stability, and slow response. Many authors have demonstrated the ability to improve sensor performance using intelligent meth-ods for sensor feature extraction and selection [ 13 ]. Various methods have been used for feature extraction of sensor arrays, such as the Fast Fourier Transform (FFT) and Discrete Wavelet Transform (DWT) [ 14 , 15 ]. Transforming signals from the time domain to the frequency domain fails to preserve important tran-sient characteristics of the original signal. Therefore, using a method that can preserve the signals transient characteristics is very important. In this study, we initially considered steady-state and dynamic-based feature extraction meth-ods, which are standard method for chemo-sensory feature extraction. Steady-state features, are extracted from the steady-state response produced by a gas sensor refer to Fig. 2 a. When a gas sensor is exposed to the same gas, it can produce a static change in resistance as long as the same gas concentration keeps flowing [ 14 ]. The change in resistance of a semiconductor gas sensor  X  R is the difference between the maximal resistance change and the base line a given gas in steady-state, R air is the sensor response to pure air, which is used as a baseline. The steady-state feature  X R has two major issues. Firstly, it becomes available late in the response as shown in Fig. 2 a. Secondly, it is susceptible to drift. Therefore dynamic feature enable us to capture the tran-sient phase of the signal. Dynamic-based features are extracted from transient chemical gas sensor response (adsorption and desorption). In the adsorption stage of gas sensor responses, the resistance R increases, while in the desorption stage, the resistance R decreases, as shown in Fig. 2 a. Dynamic features can pro-vide information about the analyte that can X  X  be extracted using steady-state methods. Furthermore, steady-state values are rarely reached due to gas sensors slow response and environmental complexity (e.g. airflow turbulence). Therefore, dynamic features are used to capture transient features to reduce the effect of dynamic real environment. Considering transient features promises to improve classification performance by reducing the sensitivity to drift and providing more discriminate information about each gas. Hence, combining transient features with steady-state can boost classifier performance and improve the quantifica-tion process. Exponential moving average ( ema X  ) is used to capture the sensor dynamics of the increasing/decaying transient portion of the sensor responses; see Fig. 2 a. This method is borrowed from financial market stock forecasting [ 2 ]. The exponential moving average ema X  transforms sensors discrete-time signal x [ k ] into: y [ k ]=(1  X   X  ) y [ k  X  1] +  X  ( r [ k ]  X  factor between [0 , 1], k =1 , 2 , .., T and y is the forecasted signal and initially set to zero( y [1] = 0). Various features are extracted from raw sensor responses using different smoothing parameters  X  e.g. (  X  =0 . 1 , X  =0 . 01 , X  =0 . 001) 3.3 Classification Because e-noses generate unpredictable and unstable sensor response, we pro-pose a fuzzy approach to address this issue. When e-nose is exposed to mixture of gases unknown signal output can be produced. This output could belong to mul-tiple classes with different relevance rates. Thus sensory signal output will have various levels of importance or relevance. The standard Support Vector Machine (SVM) suffers from noise sensitivity because all data points receive same treat-ments.Therefore, we introduce Sample Relevance (SR) which defines how each sample x i contributes to a given class C n . SR creates useful cluster representa-tions to identify gas sensor samples X  relevance to each class. We seek to obtain a high degree of SR with little redundancy between classes (no overlapping). For each training pair ( x i , y i ) an SR value s i is calculated, the pairs with high s degree will effect the prediction decision more than pairs with a lower s A Kernel-based Fuzzy C-Means clustering (KFCM) [ 16 ] algorithm is used to calculate SR which will be used as input for the fuzzy classifier. Finally, our approach address concept drift more efficiently and provide more generalization because a fuzzy ensemble is trained on different chunks of data.
 tiple classifiers are trained using KFSVM model [ 1 , 17 ]. Improved predictability and generalization is anticipated when using SR with FSVM ensemble. In order to find the ideal training model, a grid search is executed to find the best  X  and C in [2  X  10 , 2  X  9 ,..., 2 4 , 2 5 ]and[2  X  5 , 2  X  4 ,..., 2 using the following algorithm: 3.4 Confidence Scores The incoming unlabelled sensor data has high prediction uncertainties due to noise and drift. Therefore performing regression directly is biased. In our pro-posed approach, confidence classification evaluation is applied on the prediction received from the FCQM-KFSVM ensemble. The output then is evaluated using ranking and confidence functions. Instances with high confidence are extracted to be used by the FCQM-SGP model. The ranking function R is used to measure the ranking level for the predicted class label of the input instance: Where R t is the ranking for class M for the incoming data points at time t . I is an indicator function which outputs 0 or 1.
 The confidence level C t for class M for the incoming data points at time t is defined by the following: The final confidence score for each class m is given by the confidence function  X  for incoming point x at time t (Eq. 4 ). As we are interested in incoming sensor data with high prediction confidence for a given class, we select the predicted gas type which has the highest confidence, exceeding a given threshold  X  . Only the data points x nt with the highest confidence  X   X  nt are selected to be used in the gas concentration prediction.
 3.5 Scalable Gaussian Process for Quantification The ultimate goal for e-nose monitoring system is to classify and quantify the detected gas. We define the quantifier as a mapping function between the gas sensor response and the reference gas set provided in the training stage. To map gas sensor signals into concentrations, a prior distribution is used. We use a probabilistic approach inspired by Gaussian Process Regression (GPR) for gas quantification. This method, called the Scalable Gaussian process (FCQM-SGP) which was introduced by Belisle et al. [ 18 ]. The traditional GP has a very high computational cost, typically n 3 where n is the number of data points. How-ever, FCQM-SGP significantly reduces the computational time, allowing on-line learning. The FCQM-SGP approach consists of three steps. First step is batch query processing. In this step, the query points are grouped by similarity. The number of points per query group is determined by a parameter e . Secondly, the training database is condensed by eliminating similar data, where an arbitrary condensation parameter is chosen. In this work, we used a value of 1 %. This means that when the measure of similarity between two points in the training set is smaller than 1 %, these two points are merged. Finally, for each group of query points formed in the first step, a subset of the training data created during the second step is selected to perform the GP. The points are chosen according to a distance measure, keeping only the points from the training set that are close to each query group. The number of points in the training set is determined by the parameter a (accuracy). This method is described in Algorithm 2. In this work, we use the covariance matrix introduced by Gibbs and MacKay [ 19 ]: n is the total number of points, X are vectors with length equal to the number of dimensions, x elements of these vectors and w is the Gaussian kernel width. Experimental Design. A publicly available dataset is used in this paper [ 2 , 20 ]. The data set was generated over three years using metal-oxide sensor array for six-gases/analytes. Different type of gases was emitted to the sensors with varying concentrations. The main objective was to detect the type of gases in the presence of drift regardless of their concentrations. It was shown by Vergara et al. that sensor drift actually occurred. A total of 13,910 samples were generated over 36 months. For more details about the dataset, the reader is referred to [ 2 , 20 ]. The experiments are divided into two parts, the first part is FCQM-KFSVM gas detection and the second part is FCQM-SGP gas quantification. In FCQM-KFCM the model is evaluated against different classifiers including Neural Net with weight decay, NN with dropout, NN with sigmoid, and SVM. After, FCQM-KFSVM identify the gas type with high confidence the predicted data points will be used by FCQM-SGP quantification model.
 To evaluate the quantification model, we tested the performance of differ-ent algorithms with different combinations of training and testing data sets. In order to create a dataset that represents a variety of scenarios and capture dif-ferent sub spaces, five different training and testing proportions where created (10 , 30 , 50 , 70 , 90). In 10 % proportion we use 90 % of the training set and only 10 % for testing. On the other hand 90 % indicates that we use only 10 % for train-ing and 90 % for testing. In the 10 % proportion if we assume the data set we have contains 600 points, then 540 points will be used for training and 60 for testing. We use 10 fold cross validation to evaluate our model in each proportion. This ensures the generalization and the accuracy of the estimated error measures.It is important to mention that data points which are misclassified or has low con-fidence level will be ignored by FCQM-SGP.Predictions with FCQM-SGP was executed using the following parameters:  X  =1%, e =4and a = medium. We compare the proposed method with Linear Regression (LR), DynaTree Linear (DT-LIN), DynaTree Constant (DT-CST), Linear SVM Regression(LSVM) and Least Squares SVM (LS-SVM). We evaluate our method in term of Classifica-tion accuracies,Root Mean Square Error (RMSE), Mean Absolute Error (MAE), Mean Bias Error (MBE), Correlation Diversity, and outliers rate.

Correlation Diversity  X  = Results and Discussion. To evaluate the classifiers ability to deal with drift we only used batch 1 for testing and remaining are used for testing. Batch 1 is generated in the first 2 month therefore it doesn X  X  contain drift, while batch 2 X 10 contain drift because it was generated after 3 month refer to [ 2 , 20 ]. Figure 3 a show the prediction accuracies of different classifiers. Our proposed classifier FCQM-KFSVM performed better than other classifiers in batch 5 to 10 indicat-ing it is ability to perform better in drift situations. FCQM-KFSVM archived best overall average accuracies with 58 . 419 % SGP compared to other methods. FCQM-SGP was able to maintain good per-formance even when the training data set is low (10%). From MAE results in Fig. 3 c and d it is clear that all methods produced inferior results compared to FCQM-SGP when the training dataset is very small (10 %). This indicates that FCQM-SGP approach is able to produce better results with the lowest number of training data points. This is very important due to the fact that labelling e-nose data is a very expensive task.
 to other baseline methods. It is clear that the outliers percentage produced by the FCQM-SGP method is significantly less than the alternative methods. This is due to the fact that FCQM-SGP utilizes confidence evaluation, batch query processing, and co-clustering to achieve scalability and efficiency, as well as managing noise more efficiently than other models. Further more, drift and noise are reduced because an ensemble of fuzzy classifiers are trained on different parts of the data. Air Quality Monitoring and Exposure Limits. One of the main objectives of this work is to be able to predict outdoor air quality level with high confidence. It is critical to say that we are not attempting to predict the gas concentrations accurately, rather we use the predicted gas concentrations to identify air quality level. Therefore, low concentrations are irrelevant in this sense. U.S Department of Labour, Occupational Safety &amp; Health Administration (OSHA) has provided exposure limits for different substances [ 21 ]. Figure 4 a shows the exposure limits for different gases used in our experiments.
 To identify the model sensitivity to exposure limit we estimate concentration underestimation and overestimation percentage for each model. Figure 4 bshows the overestimation percentage for each model. From the figure clearly FCQM-SGP model tend to have low rate of overestimation while other models tend to highly overestimate concentrations. The underestimation graph in Fig. 4 cshows than DT-CST and DT-LIN has the lowest underestimation percentage when the training set is 90 % and testing is 10 %. Having said, that FCQM maintain best results when training proportions are 30 % and 50 %.
 In this paper, a new method have been proposed to deal with a real world problem that have not been addressed previously. The proposed model is able to identify and quantify gases data produced by electronic noses. The results have shown the efficiency and stability of our proposed approach in dealing with e-nose gas detection together with quantification. The proposed FCQM method produced less outliers and achieved better results even when a low rate of training data is used.
 Our future work will focus on finding the minimum number of sensors that can be used to achieve the best quantification performance. In this paper we used all 16 MOX sensors in the FCQM model. The reduced number of MOX sensors will significantly save the cost and provide dimensionality reduction. Secondly, despite the performance of the proposed method, it requires a large amount of training data. Manually generating labelled data for e-noses is a very expensive task. We need to work on a huge amount of labelled data to contin-uously update FCQM. Updating FCQM continuously with new training data using semi-supervised techniques can reduce the drift effect. Finally, we will apply the proposed model to different real world applications which have similar characteristics to air quality monitoring. An online implementation of our quantification model is available at: http:// www.crct.polymtl.ca/SGP/run gp.php .

