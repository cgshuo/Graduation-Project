 1. Introduction
Laser metal deposition process (LMDP) also called laser cladding by powder injection is a revolutionary method of materials deposition onto a substrate. In this method injected powder is melted by a laser beam in order to coat the surface of a substrate or fabricate near-net shape components. The deposited layer can have a thickness of 0.1 X 2 mm depending on powder composition, and laser power ( Toyserkani et al., 2005 ). The experimental setup of the laser cladding process with powder injection is shown in Fig. 1 .

An accurate and computationally efficient dynamic model of the laser cladding is required to design a model-based controller or to predict the clad geometry (e.g., height) and quality (e.g., micro-structure) based on the process parameters such as laser power, scanning speed, and powder flow rate. A literature review shows that analytical and numerical modelling (models based on input X  outputdata)ofthelasercladdingprocessisanongoingresearch topics and has been studied by many researchers ( Chen and Huang, Some of the models are developed to describe the metallurgical aspects of the cladding, such as composition of the alloys and cooling process ( Chen and Huang, 2004 ), the calculation of the heat flux in the process ( Salehi and Brandt, 2006 )anddeterminationof the model are out of scope of this paper. There are other models that describe the relation between melt pool geometry and process parameters. In this paper, the goal is to find a relation between the scanning speed, clad height, laser power and powder flow rate. relationship between melt pool geometry and process parameters.
In this regard, Frenk et al. (1997) developed a steady-state model which describes the variation of the clad height based on laser beam velocity (scanning speed) and powder efficiency, Han and Choi (2003) developed a dynamic model that can be solved using semi-implicit finite-difference method and through an iterative steps.
Toyserkani et al. (2005) developed a Hammerstein X  X iener model, which describes the clad height as function of the scanning speed and laser power. In derivation of the above mentioned dynamic models, many simplifying assumptions were made, which cannot be met in practice or if met, the performance would be degraded. For instance, usually the shape of the melt pool is assumed as a priori, the effect of the convection is neglected ( Han and Phatak, 2004 ), heat transfer between laser beam; powder particles and substrate are simplified, or the dimensions of the melt pool surface are assumed to be constant ( Fathi et al., 2007 ). These are the assumptions that may not be satisfied in a process.
 difficulties encountered in the analytical modelling of complex systems such as laser cladding process. The area is quite diverse, and covers topics from estimation theory and nonparametric regression, to algorithms and methods like neural networks, and fuzzy logic-based modelling. A thorough review of nonlinear black-box modelling can be found in Sj  X  oberg et al. (1995 ). For brevity, the term  X  X  X uzzy logic-based modelling X  X  will be referred to as  X  X  X uzzy modelling X  X  throughout this paper. Fuzzy modelling method ( Zadeh, 1973; Sugeno and Yasukawa, 1993 ) is one of the nonlinear black-box modelling methods which has a universal approximation capability ( Wang, 1992 ). This method is widely used in the literature for modelling of different complex systems ( Emami et al., 1998; Zeinali and Notash, 2005 ). Fuzzy model refers to the models consisting of fuzzy IF-THEN rules and fuzzy inference system. For brevity, the term  X  X  X uzzy logic-based dynamic model X  X  will be referred to as  X  X  X uzzy model X  X  throughout this paper. A general type of fuzzy IF-THEN rule that is sometimes known as Mamdani fuzzy rule for Multi-Input X  X ulti-Output (MIMO) systems can be written as IF x 1 is A i 1 AND ... AND x r is A i r THEN y 1 is B i 1 each input and output, respectively.
 and their combinations is investigated by a very few researchers.
Sameni et al. (2004) developed a TSK (Takagi X  X ugeno X  X ang) fuzzy model of laser cladding to predict the clad height. TSK fuzzy model is a special type of fuzzy models in which the consequent parts of the rules are a linear function of system inputs instead of being fuzzy sets. TSK fuzzy rule for multi-input X  X ingle-output (MISO) systems can be written as
IF x 1 is A 1 AND x 2 is A 2 AND ... AND x r is A r THEN y  X  a linear model of the nonlinear system. An adaptive combination of artificial neural networks and fuzzy logic modelling which is called adaptive neuro-fuzzy inference systems (ANFIS) is em-ployed to predict the clad height as a function of process parameters by Alimardani and Toyserkani (2008) . In reference
Pe  X  rez et al. (2009) the authors have also used the same method (ANFIS) for the modelling of laser surface treatment. The traditional fuzzy modelling approach and neuro-fuzzy models using ANFIS method suffers from: (i) lack of a systematic approach to assign input membership functions, which in turn, defines the number of neurons in the layers of ANFIS structure and also numbers of the parameters of the model; (ii) inputs and outputs membership functions are assigned independently while the system outputs depend on the system inputs; and (iii) high computational burden due to large number of parameters in traditional fuzzy modelling, and large number of neurons in different layers of the neuro-fuzzy system, and (iv) no systematic approach to find the numbers of neurons.

In this paper, to address the above mentioned drawbacks, an improved version of the systematic fuzzy modelling method proposed by Zeinali and Notash (2005) is employed to construct the fuzzy inverse dynamic model of the process, which occasion-ally will be referred to as fuzzy model hereafter. As mentioned earlier, the fuzzy inverse dynamic model is required to calculate the scanning speed (i.e., control input) as a function of desired clad height, powder flow rate and laser power. The scanning speed (traverse speed) is one of the important parameters in the laser cladding that influences the amount of energy absorbed by powder, which in turn, has a direct effect on the geometry and quality of the clad. The scanning speed is also required to produce the desired clad height in closed-loop laser cladding. The validity of the fuzzy model is illustrated through experiments and by comparing the model output with the measured actual scanning speed.

The remainder of this paper is organized as follows: Section 2 presents the experimental setup used to collect data and validate the performance of the fuzzy model. Section 3 presents the architecture of fuzzy modelling procedure, which consists of fuzzy model structure identification and parameters identification.
Section 4 presents the parameterized reasoning algorithm and its tuning method. Section 5 explains the summary of the systematic algorithm should be followed for fuzzy modelling.
Section 6 presents the fuzzy inverse dynamic modelling of laser cladding process and Section 7 concludes the paper. 2. Experimental setup and system hardware
The experimental setup for the laser cladding process is shown in Fig. 1 . The main components of the system are: 1000 W Fiber laser system integrated with a 5-axis CNC machine, a powder feeder system, host and target computers with a 4-channel motion control card and a 4-channel image acquisition card from
National Instrument. Extra translational and rotational axes are added to a regular 5-axis CNC machine to control the angle of powder delivery nozzle and laser focal point. As shown in Fig. 1 , powder is supplied to the melt pool through a lateral nozzle and a
CCD camera is used as a feedback sensor to capture the image of the melt pool and measure the height of the clad using image processing. 3. Architecture of a systematic fuzzy modelling method
The fuzzy dynamic model is an explanation of the laser cladding process dynamics in the form of IF-THEN rules instead of a mathematical equation. The basic configuration of a fuzzy system is illustrated in Fig. 2 .

As evident from the configuration of the fuzzy system, there are four principal components in a fuzzy system: fuzzification, fuzzy rule base, reasoning mechanism also called fuzzy inference, and defuzzification. The central part of a fuzzy system is the fuzzy rule base. The existence of a fuzzy system output depends on the existence of rule base. Indeed, other three components of a fuzzy system depicted in Fig. 2 , perform some operations upon the fuzzy rules of rule base to derive a reasonable conclusion (e.g., aggregation of the output of rules through max operation). Base on IF-THEN rule defined in Eq. (1), to construct the fuzzy IF-THEN rules inputs and outputs of the system under investigation must be identified accurately.

Generally speaking, the laser cladding process is a multi-input X  X ulti-output (MIMO) system, in which melt pool geome-try, solidification rate and melt pool temperature are functions of the scanning speed, laser power, powder flow rate and heat transfer. A system with multiple independent outputs can be considered as a set of multi-input X  X ingle-output (MISO) system ( Sugeno and Yasukawa, 1993 ). In our experimental setup, the scanning speed (i.e., velocity of the substrate) is used as a control input. Therefore, the scanning speed v ( t ) is the single output of the fuzzy inverse dynamic model presented in this paper. But, the identification of the inputs which are most relevant in describing the output of the fuzzy inverse dynamic model is not easy task and falls into the general context of  X  X  regressor selection X  X  in nonlinear black-box modelling. According to the literature (e.g., Toyserkani et al. (2005) and Fathi et al. (2008) ) and with physical insight about laser cladding process some of the most obvious PW ) inputs results in a simple static model, and this may not be satisfactory for control application. The nonlinear black-box modelling, inspired by linear black-box modelling such as finite impulse response (FIR) model, and auto-regressive exogenous (ARX) model, suggests that a dynamic model of the process can be constructed by including the past values of the system inputs and dynamic model of the process with potential input candidates. requires that the whole dynamic response time is covered by the past inputs, which could be a large number and brings up the curse of dimensionality problem. Having enough data points for good estimation would require the sample size to grow exponentially with the input dimension. This is referred to as the curse of dimensionality Sj  X  oberg et al. (1995) . Adding it possible to cover slow responses with fewer regressors. A disadvantage is that past outputs bring in past disturbances into the model. So, roughly speaking, the numbers of the past values of the system inputs and outputs which are used as the input candidates, should be identified such that to minimize both the output error and number of the inputs Sugeno and Yasukawa (1993) . Therefore, in this paper, after carefully investigating the v  X  t 2  X  ; _ m ; PW are considered for modelling. This list of input candidates further refined in Section 7, to construct a computa-tionally efficient fuzzy model for real-time control applications.
Based on the above discussion, the knowledge of the process inverse dynamic can be interpreted by MISO fuzzy models, which is a set of R rules in the following form:
IF x
Also ^ Also
IF x where x 1 , y , x r are the main inputs among the input candidates, which are identified systematically and based on an index which is introduced later in this section, other variables and symbols are defined as before. According to the literature Turksen (1997) , fuzzy modelling consists of building two essential components: (i) a knowledge-base consisting of a set of fuzzy rules and (ii) a reasoning mechanism, which is an inference procedure that derives conclusions from a set of fuzzy IF-THEN rule and known facts. In the most recent fuzzy modelling approach, the knowl-edge-base of a fuzzy model, which is a set of R rules, can be built by system identification using the input X  X utput data of the systems ( Sugeno and Yasukawa, 1993; Wang, 1992; Emami et al., 1998; Zeinali and Notash, 2005 ). Systematic fuzzy modelling can be summarized by the flowchart depicted in Fig. 4 .

As pointed out earlier, the existence of a fuzzy system output depends on the existence of the rule base. The first and traditional approach to generate the fuzzy rules is heuristic, and a set of fuzzy rules can be obtained from a priori knowledge of a system, provided that the knowledge is available. For instance, an experienced human operator X  X  knowledge was used by Mamdani and Assillian Mamdani (1974) to generate the fuzzy rules governing the controller of a steam engine. This method of rule generation is suitable for control applications that operator X  X  knowledge is available. The main limitation of this approach is that a priori knowledge of a system (the human operator X  X  knowledge) is not always available and sometimes it could be faulty. The second and more formal approach is to use the input X  output data of system, which is obtained from the system identification. At the core of the rule generation lies the fuzzy partitioning of the input and output spaces. Early methods of fuzzy partitioning were performed simply by dividing (partition-ing) the input and output spaces independent from each other into several subspaces, which led either to large number of partitions (rules) or insufficient partitions (rules) ( Wang, 1992 ). Fig. 5 illustrates the simple fuzzy partitioning of input space of a Laser Power PW Clad Height h (t)
Powder flow rate m(t) system with two input variables. To solve the problem of redundancy and insufficient number of rules, the fuzzy c -means clustering method was adopted by Pedrycz (1984) , to generate the optimum number of rules. The author used the fuzzy c-means (FCM) method for clustering of input and output spaces separately. However firstly, it should be noted that the input and output spaces of physical systems cannot be independent of each other, since the inputs and outputs correspond to  X  X  X ause and effect X  X  in the systems. Secondly, by separate clustering, as the dimension of clustering space increases the complexity of the algorithm grows rapidly ( Emami et al., 1998 ).
 is required to have a fuzzy partitioning method that relates the system inputs and outputs. The fuzzy partitioning based on clustering proposed by Sugeno and Yasukawa (1993) and was later improved by Emami et al. (1998) and Zeinali and Notash (2005) addresses the problems discussed above. The central point of this partitioning approach is that the output space (output data) is partitioned using fuzzy c-mean (FCM) clustering method as a first step of rule generation, Fig. 6 . In the second step, the input space clusters (e.g., cluster A in Fig. 6 ) are obtained by each input variable, separately. Therefore, in the projection method a fuzzy partition of the input space is obtained as a direct result of fuzzy clustering of the output space. Projection of the output space clusters onto each input variable is illustrated in Fig. 6 .

The systematic fuzzy modelling method presented in this paper is based on the above portioning method and improved
FCM clustering proposed in Zeinali and Notash (2005) . Further-more, the employed fuzzy modelling method uses a new parameterized reasoning mechanism which is also proposed by
Zeinali and Notash (2005) . The parameterized reasoning mechan-ism is constructed by generalizing the Centroid of Area (COA) defuzzification method and can briefly be described as follows: ^ y  X  where ^ y is the model output, y i  X  t i y o i = P R i  X  1 output of the i th rule based on COA defuzzification method, W ( i =1, 2, y , R ), is the weight of the i th rule (design parameter) which should be identified such that to minimize a performance index ( PI ), for instance, mean squared error (MSE), t i operator, and y o i is a non-fuzzy representative of the output fuzzy set B i of i th rule. The detail of the above reasoning method is described later in Section 4. In the proposed parameterized reasoning method, the defuzzified output can be directly calculated from the weighted sum of the defuzzified output value of each individual rule of the rule set (rule base). By identifying these parameters (weights) the relative importance of each rule can also be identified. In the literature, the parameters of a fuzzy model refer to those of the membership functions. There are two problems concerning the parameter identification in the tradi-tional fuzzy modelling: (i) the number of parameters is large (e.g., 72 parameters for fuzzy model of famous Box and Jenkins gas furnace system with 6 rules in Sugeno and Yasukawa (1993) ); (ii) the parameter identification method is heuristic and is based on trial and error method.

In this paper, the parameters are the weights of the rules and the fuzziness parameter m in FCM clustering. The number of parameters are equal to the number of the rules plus one (e.g., for fuzzy model of Box and Jenkins gas furnace system with 6 rules as presented in Sugeno and Yasukawa (1993) the parameters are 6+1=7 instead of 72). The rules X  weights are identified using a gradient-descent method and fuzziness parameter ( m ) is identi-fied by minimizing a performance index ( PI ) (e.g., mean-square of the error between model output and the process output). In the fuzzy modelling method used in this study, a small number of the parameters allows online estimation of the parameters to deal with uncertainties. The fuzzy model with online learning capability is convenient for the real-time control applications. It is worth noting that, constructing a robust fuzzy model without using online parameter estimation requires extensive excitation to cover all modes of the process dynamics.

Based on the fuzzy modelling flowchart presented in Fig. 4 , system identification is the main step to build the fuzzy model and consists of: (i) Structure identification ; and (ii) Parameter identification , which are presented next. 3.1. Structure identification
The structure identification process which consists of rule generation, proper membership function assignment to output data, main input selection, and proper membership function assignment to input data, are reviewed in the following sections. First, FCM clustering is briefly presented to clarify the rule generation via FCM. 3.1.1. Rule generation by FCM clustering algorithm
The most widely used fuzzy clustering algorithm is the fuzzy c-means algorithm. The FCM initially was developed by Dunn (1974) and extended by Bezdek (1981) . For clarification of notation, the FCM algorithm is briefly presented here. Suppose data vectors and h is the dimension of each data vector x tion of the number of the fuzzy rules from a given set of input X  output data is equivalent to the assignment of c number of fuzzy find the integer c (the number of the clusters), 1 o c o N , and a c fuzzy partition of a given data set X exhibiting categorically homogeneous subsets ( Bezdek, 1981 ). The two important require-ments for ideal clustering are the compactness and well-separation properties. One approach to satisfy these two require-ments is the objective function methods. The most applicable objective function for the fuzzy clustering is the weighted within-group sum of squared error. Typically, local minimums of the objective function are defined as optimum clustering. Minimiza-tion of the objective function yields hyperspherical cluster shapes if the Euclidean distance d ik of each data point x k to each of the cluster centres v i is used as a measure of dissimilarity (i.e., d  X k x k v i k ) and the membership values of each data point to each cluster is used as a measure of similarity ( Bezdek, 1981 ). Therefore, the problem of fuzzy clustering is to find the optimum membership values of all data points in all clusters ( u ik clusters can be combined in a c N matrix U =[ u ik ]( i =1, 2, and k =1, 2, y , N ) and all cluster centres can be presented by a realized by minimizing the following objective: J  X  U ; V  X  X  where parameter m A [1, N ) is a fuzziness parameter (weighting exponent) that defines the fuzziness between clusters. Minimiz-ing Eq. (5) which is a constrained optimization problem subjected to the following constrains: U A
M fc  X f U A R c N 9 u ik A  X  0 ; 1 8 i ; k ; u ik  X  1 8 k ; 0 o results in membership values of all data points in all clusters ( u
Eq. (5) is solved in an iterative manner ( Bezdek, 1981 ) through the following steps:
Step 1. Choose the optimum number of clusters c , and the fuzziness parameter m Step 2. Choose the termination criterion e 4 0
Step 3. Guess the initial position of cluster centre V 0 =[ v v ,
Step 4. Calculate the membership value for all data points u  X  2 4 where x k is k th data and l is the iteration number.
Step 5. Calculate the cluster centres v  X 
Step 6. Check the termination condition :
IF Eq. (9) is satisfied STOP, otherwise Go To step 3. 3.1.2. Cluster validity
A common approach to determine the correct number of clusters c in the cluster analysis is based on validity indices. In general, clustering algorithms aim at locating well separated and compact clusters. When the number of clusters is chosen equal to the number of groups that actually exist in the data, it can be expected that the clustering algorithm will identify the actual groups correctly. The definition of a  X  X  X ood X  X  cluster is open to interpretation and can be formulated in different ways. Conse-quently, the literatures from different disciplines contain many validity indices, namely data mining, pattern recognition, and fuzzy modelling, some of which can be found in Sugeno and
Yasukawa (1993) , Emami et al. (1998) . In the context of fuzzy modelling, which uses the FCM as a tool to generate the rules, a distinct cluster validity index is given by Fukoyama X  X ugeno ( Sugeno and Yasukawa, 1993 ) as follows:
S  X  U ; V  X  X  where S c-FS is the Fukoyama X  X ugeno validity index, x k is k th data above validity index is used to identify the optimum numbers of the clusters, which gives the optimum numbers of rules for the fuzzy model. 3.1.3. Output data membership assignment
After clustering the output data, the next step is to assign an appropriate membership function to each row of membership matrix U =[ u ik ] resulting from the output data clustering. The assigned membership functions allow to account for data different than the training data and to generalize the fuzzy model.
The common approach is to approximate all the membership values u ik of one cluster by a simple triangular, trapezoidal, or
Gaussian function. A Gaussian membership function has two parameters (centre s i and width a i ), a triangular membership function at most has three parameters, and a trapezoidal fuzzy membership function has four parameters which give more degrees of freedom in terms of tuning, if necessary. Possibility of having more than one data with the membership value of  X  X  X ne X  X  in one cluster well justifies to use the trapezoidal membership function, which is used in this study. 3.1.4. Input selection variables is important for system modelling. Obviously, incorpor-ating only the important variables into a model provides a simpler and more useful model especially for real-time control applica-tions. The objective of this important task is to reduce the dimension of the model inputs without significant loss in accuracy. A simple, effective and practical method of main input selection is proposed in Emami et al. (1998) . Based on the proposed method, a quantitative index p j is calculated for each input variable as follows: where G ij ={set of inputs x j with u ik =1, j =1,2, y , r variable x j , c is the number of rules, and r 0 is the number of all possible input candidates. Eq. (11) was concluded from the fact that, in the calculation of the firing strength of the i th rule ( w either from algebraic product operator w i  X  Q r j  X  1 A ij  X  X  X ne X  X  is the neutral element. Therefore, the input variables with many  X  X  X ne X  X  elements in their membership function correspond to a large value of p j , and can be discarded from the input candidates. 3.1.5. Input data membership assignment partitioned into appropriate fuzzy sets in order to produce the antecedent fuzzy set of each rule. One simple way to partition the input space is to equate the membership value of each input datum to its corresponding output membership value which is called the  X  X  X utput cluster projection onto input axes X  X  in Sugeno and Yasukawa (1993) ; then approximate the raw membership values of each input cluster with an appropriate fuzzy member-ship function, e.g., trapezoidal fuzzy function. The problem with this technique is that the resulting membership functions are not convex and further step is required to assign a convex fuzzy membership function to each raw cluster as shown in Fig. 7 : input membership values to be equal to the output membership values at each sample point. X  X  In order to solve the problem concerning the input membership assignment, another technique was suggested by Emami et al. (1998) which assumes that only the peak points (the data points with membership values of  X  X  X ne X  X  or close to  X  X  X ne X  X ), should be the same for input and output clusters, and the membership value of the remaining data points are calculated through a technique called line fuzzy clustering algorithm ( Emami et al., 1998 ). Therefore, the technique presented in ( Emami et al., 1998 ) is adopted to form the input membership functions in this study. 3.2. Parameter identification
As mentioned earlier, in the literature, the parameters of a fuzzy model refer to those of the membership functions. In Emami et al. (1998) four additional parameters of the reasoning mechanism namely p , q , a , b , are used. There are two problems concerning the parameter identification in the fuzzy modelling: (i) the number of parameters is large (e.g., 96 parameters for fuzzy model of nonlinear static function ( Emami et al., 1998 ); and (ii) the parameter identification is performed using a heuristic method. In this study, the parameter identification is referred to as the identification of the fuzziness parameter m and the weights of the rules which are equal to the number of rules, as discussed in the preceding sections. 4. Parameterized reasoning mechanism
As pointed out in Section 3, one of the two essential components of fuzzy modelling algorithm is a reasoning mechan-ism, which is an inference procedure that derives conclusions from a set of fuzzy IF-THEN rule and known facts. For the approximate reasoning with multi-input X  X ingle-output fuzzy rules shown in Eq. (3), two approaches can be recognized in the (FATI); (2) first infer then aggregate, (FITA). According to Turksen (1997) the two methods of inference, FATI and FITA always give the same output. Based on the second method, FITA, Wang and
Mendel (1992) , Yager and Filev (1994) , Sugeno and Yasukawa (1993) introduced the direct fuzzy reasoning methods in which the model output ^ y can be computed as the normalized linear combinations of the defuzzified value of the individual rules as follows: ^ y  X  where in Yager and Filev (1994) t i is the min operator, and in
Wang and Mendel (1992) and Sugeno and Yasukawa (1993) functions t i is the algebraic product operator. In Wang and Mendel (1992) and Yager and Filev (1994) y o i is the centre of area of consequent fuzzy membership function, where as in Wang and
Mendel (1992) y o i is the smallest value (in terms of the magnitude) of support of consequent fuzzy set of each individual rule, which has a membership value equal to  X  X  X ne X  X . The number of rules R is equal to the number of clusters c . In order to compensate for the inaccuracies and uncertainties that may be contained in the antecedent and consequent parts of the rules, a parameterized direct reasoning method, based on Eq. (12) can be constructed, which is briefly introduced in Eq. (4) and repeated here as follows: ^ y  X  u and W i ( i =1, 2, y , R ), is the weight of the i th rule (design parameter) which should be identified such that to minimize the performance index ( PI ), which is mean squared error (MSE). With the proposed direct fuzzy reasoning method, no longer one in Sugeno and Yasukawa (1993) and Emami et al. (1998) as a centroid of the consequent fuzzy set, in which the calculation of centroid was required. The only condition is that y o i should have membership value of  X  X  X ne X  X . The idea is to calculate the total output of fuzzy model by the weighted sum of the output of each rule. In the simulation section it will be shown that, by tuning the rule weights the modelling error can be reduced significantly and efficiently in comparison to the existing fine tuning procedures (e.g., Sugeno and Yasukawa, 1993 ; Emami et al., 1998 ) which deal with a large number of parameters. This method can also facilitate modification of the output of each individual rule based on the new observation without changing its membership functions. The method is convenient for online training and real-time control applications in fuzzy controllers. The problem of learning the weights (parameters) can be carried out using a gradient-descent technique based on the instantaneous difference of the fuzzy model output and actual output, e k  X  y k ^ y k in real-time applica-tions or mean squared error in off-line learning as follows: PI  X  e  X  1 = N PI  X  1 = N
Using the gradient technique and applying the chain rule at the z th step of learning process the following updating law for rule weights is obtained: D W i  X  z  X  X  2 LR W  X  z  X  1  X  X  W i  X  z  X  X  2 LR where LR ,0 r LR r 1, is the learning rate. 5. Fuzzy modelling algorithm in summary
The fuzzy modelling method used in this paper could be summarized as follows:
Step 1. Choose the initial value of the fuzziness parameter m from the interval [1.5, 2.5] Step 2. Perform the cluster validity analysis Step 3. Perform the fuzzy clustering for the output data
Step 4. Assign proper membership functions to the output clusters Step 5. Select the main inputs
Step 6. Assign proper membership functions to each input variable by the projection method, and build a rough fuzzy model Step 7. Set the weights of rules to  X  X  X ne X  X 
Step 8. Calculate the output of the fuzzy model using Eq. (13), and the performance index ( PI ) using Eq. (15)
Step 9. Plot the variation of PI as a function of m , and choose the value of m which minimizes the PI
Step 10. Repeat the procedure from Step 2 and identify the weights values that give the best performance through gradient decent method. 6. Fuzzy modelling of laser cladding process
At this point, the fuzzy inverse dynamic model of laser cladding process is constructed after collecting adequate amount of system input X  X utput data, and based on the systematic method summarized in Section 5. 6.1. Data acquisition procedure
The first step in data driven modelling (i.e., modelling from input X  X utput data) is that an adequate amount of system input X  output data should be obtained. For the purpose of obtaining input X  X utput data, an identification experiment has to be designed. In this research, experiment means applying some controlled input (i.e., scanning speed) to the experimental setup and observing the clad height using the online image grabbing and processing of the melt pool and also off-line measurement of the clad height. Now the question is: how can one design experiments, in order to obtain as much information possible about the process? System identification for linear systems is a rich and well-established area ( Sj  X  oberg et al., 1995 ), but for complex multivariable systems such as laser cladding process, designing test signals that provide sufficiently informative output data is a nontrivial problem, and there is no general theory of experiment design. However, there are some basic yet important recommendations in the literature ( Sj  X  oberg et al., 1995 ) that should be followed to guarantee the validity of the experiments.
The recommendations are to use random inputs and sufficient excitations to have a rich yet small number of identification data, also called training data ( Sj  X  oberg et al., 1995 ). The random trajectories can excite significant number of modes of the system and generate the input X  X utput data which convey important information about system behaviour, and sufficient excitation means the experiment should excite all modes of the system that may be excited during the use of the model. Due to the physical limitation of the experimental setup in laser cladding process, e.g., limitation in CNC machine speed and acceleration, or limitation in laser power and powder feeder flow rate, an arbitrary random excitation signal cannot be applied. Therefore, for laser cladding process the proper input signals are designed to cover the desired range of input X  X utput variables. The sufficient excitation condi-tion can be relaxed in the fuzzy modelling method used in this paper, which results in an adaptive fuzzy model. In other words, the preliminary process model can be built using the collected data (i.e., off-line identification procedure), and in case of new situations (unseen modes of the system) when the fuzzy model is used, the model output can be modified online using the adaptive capability of the model. The online learning capability can also account for the external disturbances and measurement noise during the operation. This is another advantage of the systematic fuzzy modelling used in this paper, which effectively can reduce investigated experimentally in the next section.

Based on the required input X  X utput data, and the discussion of the previous paragraph, a series of experiments were designed and performed using an interactive program implemented in
LabVIEW and MatLab environment. In the first series of experi-ments, different scanning speeds, laser power and powder flow rate were applied to the open-loop process and the resulting clad height was measured using CCD camera and real-time image processing algorithm and the measured heights were also verified offline using the other accurate measurement tools, to evaluate the measurement noise. In the next series of experiment, a chattering-free sliding mode control was designed and imple-mented to control the clad height and to ensure that the commanded reference trajectory (i.e., desired clad height) is being followed. Samples of the input signals (scanning speed) and associated process output (clad height) which were used during the experiments to collect data are shown in Figs. 8 X 10 . During each experiment laser power and powder flow rate were kept constant. Figs. 9 and 10 illustrate step input and sinusoidal input and process outputs, respectively.
 experimental data and data from the simulations of the first-order mathematical model proposed by Fathi et al. (2008) , in order to use the advantages of any available knowledge of the process. The proposed model is t _ h  X  h  X  3 2 _ m r w where h is the clad height (mm), _ h is the first derivatives of the clad height (mm/s). _ m is the powder flow rate (g/s), r is the powder density (g/m 3 ), w 0 is the steady-state values of the clad width (mm), d p is the powder jet diameter (mm), d b is the laser beam diameter (mm), a is the angle between the nozzle and the are unknown parameters that can be identified through the experiment and in an off-line procedure. To avoid a cumbersome off-line identification procedure, the approximate values of these parameters, which are given in Fathi et al. (2008) , are used for simulation. The error associated with the parameters of the model is considered as an uncertainty. A sample of training data generated by the above model illustrated in Fig. 11 .
The resultant data from all experiments (random, sinusoidal and step inputs), and simulations of the model represented in
Eq. (16) were combined and categorized for the following three purposes: (i) Fuzzy Model Structure Identification : Main part of the collected (ii) Fuzzy Model Parameter Identification : Part of the collected 6.2. Fuzzy inverse dynamic model construction using collected input X  X utput data
The precision, performance, and robustness of the model-based controllers depend, to a large extent, on the accuracy of the inverse dynamic model which is incorporated in the design of the controller ( An et al., 1989 ). Here in this section, the goal is to construct a fuzzy inverse dynamic model of the laser cladding process from input X  X utput data, using the improved systematic fuzzy modelling methodology presented in Section 3. 6.2.1. Structure identification
After data collection and categorization, the fuzzy modelling algorithm presented in Section 5, can be followed to build the fuzzy inverse dynamic model of the process. As a first step, the of randomly chosen initial cluster centres the initial number of clusters is set to c =2. As a second step, the output data, i.e., scanning speed, are clustered using the fuzzy c-means algorithm is performed using Eq. (10), and number of clusters is obtained.
Fig. 12 illustrates the result of the cluster validity analysis for collected data that can be used to identify the optimum number of the clusters, which is equal to the optimum number of the fuzzy rules. Based on Fig. 12 , the optimum number of the clusters is h (mm); v (mm/Sec) c =10. In order to have a minimum possible number of rules and to reduce the real-time computation burden c =8 is chosen as the optimum number of the clusters. As indicated in Fig. 12 , the minimum value of the cluster validity index decreases sharply before eight, and by increasing the number of the clusters it remains almost unchanged. In this case, one can choose the smallest number of cluster c after which there is no considerable change in the validity index, e.g. c =8, which is a trade-off between the performance and transparency of the rule base. Next step is to perform the FCM clustering for output data. Fig. 13 shows the clustering results.

After clustering, suitable trapezoidal MFs are assigned to the output clusters as shown in Fig. 14 .

The next step of fuzzy modelling algorithm is to identify the main input variables among the entire input candidates for inverse fuzzy model. As discussed in Section 3, for fuzzy inverse dynamic model the obvious input candidates are: clad height h ( t ), powder flow rate _ m , and laser power ( PW ). Since the system is dynamic, each instantaneous value of the output v ( t ) can be regarded as being influenced by the most recent past values. Therefore, the most recent past values of the cald height and scanning speed are considered as the input candidates. On the other hand, since during each experiment laser power and powder flow rate are kept constant, thus their past values are not included. As pointed out in Section 3, in this paper, after
S (c) 0.2 0.4 0.6 0.8 Membership Value (mu) keep the final fuzzy model as simple as possible, and to reduce the computation burden, the two most recent past values of the clad v ( t 1), v ( t 2), are considered to form the regression vector which is
At this point, using Eq. (11), the p index is computed for each input candidate to identify the main input variables. The results are listed in Table 1 .

As was discussed in Section 3.1.4, a small value of p corresponds to more dominant input variable. Again, to keep the model simple and to account for all main parameters of the process four inputs from seven candidates were selected based on
After identifying the main input variables, the next task is to assign an appropriate membership function to each input variable. This task was performed using the method presented in Section 6, and trapezoidal membership functions (MF) were assigned to each input variable. The input variables MFs are shown in Fig. 15 .

Up to this point, the structure of the MISO fuzzy inverse dynamics models of the laser cladding process was identified, which allows to compute the fuzzy model output (i.e., scanning speed). This is what is called rough fuzzy model in Section 5, step 6. At this stage, the model output can be calculated and based 01020 0 1 2 0510 0 1 2 24 6 0 1 2 0510 0 1 2 01020 0 1 2 01020 0 1 2 01020 0 1 2 01020 0 1 2 on the performance index defined in Section 5 the parameters of the model can be identified to improve the model accuracy. 6.2.2. Parameters identification
According to the fuzzy modelling algorithm given in Section 6, the next step is the parameter identification procedure. As was discussed in Section 3, the parameters of the fuzzy model are the fuzziness parameter and weights of the rules. At this stage, the weights of the rules are set to  X  X  X ne X  X  and they are identified using second set of collected data. It is worth noting that, during the operation the rules X  weights can be identified based on the desired clad height and real condition of the process to compensate for the uncertainties which are not seen in the construction of the fuzzy inverse dynamic model. First and the most important parameter is the fuzziness parameter that can be identified by plotting the performance index verses parameter m . Fig. 16 illustrates the identification of m for fuzzy models of laser cladding process. As can be seen m =1.45 gives the best performance, i.e., PI =0.63, and this is the performance before tuning the rules weights.

Now, the weights of the rules can be identified using an updating law presented in (17). The procedure is performed and the rules weights are calculated as W =[1.2865, 1.0791, 1.0706 1.2238, 1.2123, 1.7226, 0.5514, 1.1803], and the performance index PI =0.35 is obtained. The above performance index is achieved by tuning only the rules weights (8 parameters). The rules weight tuning is illustrated in Fig. 17 .

Up to this point, the structure (i.e., numbers of rules and associated MFs) and the parameters (i.e., fuzziness parameter and the rules weights) of the fuzzy inverse dynamic model system-atically were identified. The specifications of the identified model are listed in Table 2 . 6.3. Validation of the fuzzy model
The identified fuzzy inverse dynamic model is tested on two different sets of data, which are earlier referred to as validation data, and the fuzzy model output is compared with the actual scanning speed. Comparison of the fuzzy model output and actual scanning speed of laser cladding process is illustrated in Figs. 18 and 19 . As can be seen from the figures the fuzzy model predicts the process scanning speed with a good accuracy. The corresponding performance index value for validation data set one ( Fig. 18 ), before tuning the weights is PI=0.161 and after tuning PI=0.142, and it obtained by 50 iteration. For second set of Performance Index (PI) 0 2 4 6 8 10 12 14 16 18 20 Sacnning Speed (mm/ Sec) 0.5 1.5 2.5 3.5 4.5
Scanning Speed (mm/Sec) validation data ( Fig. 19 ) the performance index before and after tuning are PI=0.15 and PI=0.121, respectively. By having the fuzzy inverse dynamic model of the process, a model-based control can be designed and implemented to improve the closed-loop laser cladding process. 7. Conclusion developed for laser cladding process using a systematic fuzzy modelling method and input X  X utput data. The developed fuzzy inverse dynamic model describes the scanning speed as a function recent past value ( h ( t 1)) and the two most recent past values of the scanning speed ( v ( t 1), v ( t 2)). An important feature of the developed fuzzy model is that it is adaptive and the number of parameters to be tuned is significantly small in comparison to the published works. The small number of parameters (i.e., the rules weights and fuzziness parameter 8+1=9) makes this fuzzy model suitable for real-time control application.
 validated by comparing the model output and experimental data.
The results are very promising and show that the fuzzy inverse dynamic model can accurately predict the scanning speed which is required to produce the desired clad height. Future work aims towards the development of a robust adaptive controller for laser cladding process using this fuzzy model.
 Acknowledgment Ontario Ministry of Research and Innovation, Natural Sciences and Engineering Research Council of Canada (NSERC), and Industrial Tooling System.
 References
