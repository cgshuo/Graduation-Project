 As the cornerstone of Bayesian nonparametric modeling, Dirichlet processes (DP) [22] have been applied to a wide variety of inference and estimation problems [3, 10, 20] with Dirichlet process mixtures (DPMs) [15, 17] being one of the most successful. DPMs are a generalization of finite mixture models that allow an indefinite number of mixture components. The traditional DPM model assumes that each sample is generated independently from the same DP. This assumption is limiting in cases when samples come from many, yet dependent, DPs. HDPs [23] partially address this modeling aspect by providing a way to construct multiple DPs implicitly depending on each other via a common parent. However, their hierarchical structure may not be appropriate in some problems (e.g. temporally varying DPs).
 Consider a document model where each document is generated under a particular topic and each topic is characterized by a distribution over words. Over time, topics change: some old topics fade while new ones emerge. For each particular topic, the word distribution may evolve as well. A natural approach to model such topics is to use a Markov chain of DPs as a prior, such that the DP at each time is generated by varying the previous one in three possible ways: creating a new topic , removing an existing topic , and changing the word distribution of a topic .
 Since MacEachern introduced the notion of dependent Dirichlet processes (DDP) [12], a vari-ety of DDP constructions have been developed, which are based on either weighted mixtures of DPs [6, 14, 18], generalized Chinese restaurant processes [4, 21, 24], or the stick breaking construc-tion [5, 7]. Here, we propose a fundamentally different approach, taking advantage of the intrinsic relationship between Dirichlet processes and Poisson processes: a Dirichlet process is a normal-ized Gamma process, while a Gamma process is essentially a compound Poisson process. The key idea is motivated by the following: observations that preserve complete randomness when applied to Poisson processes result in a new process that remains Poisson. Consequently, one can obtain a Dirichlet process which is dependent on other DPs by applying such operations to their underly-ing compound Poisson processes. In particular, we discuss three specific operations: superposition , subsampling , and point transition . We develop a Markov chain of DPs by combining these opera-tions, leading to a framework that allows creation, removal, and location variation of particles. This construction inherently comes with an elegant property that the random measure at each time is marginally DP distributed. Our approach relates to previous efforts in constructing dependent DPs while overcoming inherent limitations. A detailed comparison is given in section 4. Our construction of dependent Dirichlet processes rests upon the connection between Poisson, Gamma, and Dirichlet processes, as well as the concept of complete randomness . We briefly re-view these concepts; Kingman [9] provides a detailed exposition of the relevant theory. Let ( X  , F  X  ) be a measurable space, and  X  be a random point process on  X  . Each realization of  X  uniquely corresponds to a counting measure N  X  defined by N  X  ( A ) , #( X   X  A ) for each A  X  X   X  . Hence, N  X  is a measure-valued random variable or simply a random measure . A Poisson process  X  on  X  with mean measure  X  , denoted  X   X  PoissonP(  X  ) , is defined to be a point process such that N  X  ( A ) has a Poisson distribution with mean  X  ( A ) and that for any disjoint measurable sets A ,...,A n , N  X  ( A 1 ) ,...,N  X  ( A n ) are independent. The latter property is referred to as complete randomness . Poisson processes are the only point process that satisfies this property [9]: Theorem 1. A random point process  X  on a regular measure space is a Poisson process if and only if N  X  is completely random. If this is true, the mean measure is given by  X  ( A ) = E ( N  X  ( A )) . Consider  X   X   X  PoissonP(  X   X  ) on a product space  X   X  R + . For each realization of  X   X  , We define  X   X  : F  X   X  [0 , +  X  ] as Intuitively,  X   X  ( A ) sums up the values of w  X  with  X   X  A . Note that  X   X  is also a completely random measure (but not a point process in general), and is essentially a generalization of the compound Poisson process . As a special case, if we choose  X   X  to be Then the random measure as defined in Eq.(1) is called a Gamma process with base measure  X  , denoted by G  X   X P(  X  ) . Normalizing any realization of G  X   X P(  X  ) yields a sample of a Dirichlet process , as In conventional parameterization,  X  is often decomposed into two parts: a base distribution p  X  ,  X / X  ( X ) , and a concentration parameter  X   X  ,  X  ( X ) . Motivated by the relationship between Poisson and Dirichlet processes, we develop a new approach for constructing dependent Dirichlet processes (DDPs). Our approach can be described as follows: given a collection of Dirichlet processes, one can apply operations that preserve the complete ran-domness of their underlying Poisson processes. This yields a new Poisson process (due to theorem 1) and a related DP which depends on the source. In particular, we consider three such operations: su-perposition , subsampling , and point transition .
 Superposition of Poisson processes: Combining a set of independent Poisson processes yields a Poisson process whose mean measure is the sum of mean measures of the individual ones. Theorem 2 (Superposition Theorem [9]) . Let  X  1 ,...,  X  m be independent Poisson processes on  X  with  X  k  X  PoissonP(  X  k ) , then their union has Given a collection of independent Gamma processes G 1 ,...,G m , where for each k = 1 ,...,m , G k  X   X P(  X  k ) with underlying Poisson process  X   X  k  X  PoissonP(  X  k  X   X  ) . By theorem 2, we have Due to the relationship between Gamma processes and their underlying Poisson processes, such a combination is equivalent to the direct superposition of the Gamma processes themselves, as Let D k = G k /G k ( X ) , and g k = G k ( X ) , then D k is independent of g k , and thus can construct a Dirichlet process through a random convex combination of independent Dirichlet processes . This result is summarized by the following theorem: Theorem 3. Let D 1 ,...,D m be independent Dirichlet processes on  X  with D k  X  DP(  X  k ) , and ( c 1 ,...,c m )  X  Dir(  X  1 ( X ) ,..., X  m ( X )) be independent of D 1 ,...,D m , then Here, we use the symbol  X  to indicate superposition via a random convex combination. Let  X  k =  X  ( X ) and  X  0 = P m k =1  X  k , then for each measurable subset A , Subsampling Poisson processes: Random subsampling of a Poisson process via independent Bernoulli trials yields a new Poisson process.
 Theorem 4 (Subsampling Theorem) . Let  X   X  PoissonP(  X  ) be a Poisson process on the space  X  , and q :  X   X  [0 , 1] be a measurable function. If we independently draw z  X   X  X  0 , 1 } for each  X   X   X  0 with P ( z  X  = 1) = q (  X  ) , and let  X  k = {  X   X   X  : z  X  = k } for k = 0 , 1 , then  X  0 and  X  1 are independent Poisson processes on  X  , with  X  0  X  PoissonP((1  X  q )  X  ) and  X  1  X  PoissonP( q X  ) 1 . number of particles. We use S q ( X ) :=  X  1 to denote the result of subsampling, where q is referred to as the acceptance function . Note that subsampling the underlying Poisson process of a Gamma process G is equivalent to subsampling the terms of G . Let G = P  X  i =1 w i  X   X  i , and for each i , we draw z i with P ( z i = 1) = q (  X  i ) . Then, we have Let D be a Dirichlet process given by D = G/G ( X ) , then we can construct a new Dirichlet pro-cess D 0 = G 0 /G 0 ( X ) by subsampling the terms of D and renormalizing their coefficients. This is summarized by the following theorem.
 Theorem 5. Let D  X  DP(  X  ) be represented by D = P n i =1 r i  X   X  i and q :  X   X  [0 , 1] be a measur-able function. For each i we independently draw z i with P ( z i = 1) = q (  X  i ) , then Let  X  =  X  ( X ) and  X  0 = ( q X  )( X ) , then for each measurable subset A , Point transition of Poisson processes: The third operation moves each point independently fol-lowing a probabilistic transition. Formally, a probabilistic transition is defined to be a function T :  X   X F  X   X  [0 , 1] such that for each  X   X  X   X  , T (  X ,  X  ) is a probability measure on  X  that describes the distribution of where  X  moves, and for each A  X  X   X  , T (  X  ,A ) is integrable. T can be considered as a transformation of measures over  X  , as Theorem 6 (Transition Theorem) . Let  X   X  PoissonP(  X  ) and T be a probabilistic transition, then With a slight abuse of notation, we use T (  X  ) to denote an independent sample from T (  X ,  X  ) . As a consequence, we can derive a Gamma process and thus a Dirichlet process by applying the probabilistic transition to the location of each term, leading to the following: Theorem 7. Let D = P  X  i =1 r i  X   X  i  X  DP(  X  ) be a Dirichlet process on  X  , then Theorems 1 and 2 are immediate consequences of the results in [9]. We derive Theorems 3 to The-orem 7 independently as part of the proposed approach. Detailed explanation of relevant concepts and the proofs of Theorem 2 to Theorem 7 are provided in the supplement. 3.1 A Markov Chain of Dirichlet Processes Integrating these three operations, we construct a Markov chain of DPs formulated as The model can be explained as follows: given D t  X  1 , we choose a subset of terms by subsampling, then move their locations via a probabilistic transition T , and finally superimpose a new DP H t on the resultant process to form D t . Hence, creating new particles , removing existing particles , and varying particle locations are all allowed, respectively, via superposition , subsampling , and point transition . Note that while they are based on the operations of the underlying Poisson processes, due to theorems 3, 5, and 7, we operate directly on the DPs, without the need of explicitly instantiating the associated Poisson processes or Gamma processes. Let  X  t be the base measure of D t , then and  X   X  =  X  ( X ) are the concentration parameters. One may hold  X  t fixed over time by choosing appropriate values for q and  X   X  . Furthermore, it can be shown that The covariance with previous DPs decays exponentially when q &lt; 1 . This is often a desirable property in practice. Moreover, we note that  X  and q play different roles in controlling the process. Generally,  X  determines how frequently new terms appear; while q governs the life span of a term which has a geometric distribution with mean (1  X  q )  X  1 .
 a mechanism with which new component models can be brought in, existing components can be removed, and the model parameters can vary smoothly over time. In his pioneering work [12], MacEachern proposed the  X  X ingle-p DDP model X . It considers DDP as a collection of stochastic processes, but does not provide a natural mechanism to change the collection size over time. M  X  uller et al [14] formulated each DP as a weighted mixture of a common DP and an independent DP. This formulation was extended by Dunson [6] in modeling latent trait distributions. Zhu et al [24] presented the Time-sensitive DP, in which the contribution of each DP decays exponentially. Teh et al [23] proposed the HDP where each child DP takes its parent DP as the base measure. Ren [18] combines the weighted mixture formulation with HDP to construct the dynamic HDP. In contrast to the model proposed here, a fundamental difference of these models is that the marginal distribution at each node is generally not a DP.
 Caron et al [4] developed a generalized Polya Urn scheme while Ahmed and Xing [1] developed the recurrent Chinese Restaurant process (CRP). Both generalize the CRP to allow time-variation, while retaining the property of being marginally DP. The motivation underlying these methods fundamen-tally differs from ours, leading to distinct differences in the sampling algorithm. In particular, [4] supports innovation and deletion of particles, but does not support variation of locations. Moreover, its deletion scheme is based on the distribution in history, but not on whether a component model fits the new observation. While [1] does support innovation and point transition, there is no explicit way to delete old particles. It can be considered a special case of the proposed framework in which subsampling operation is not incorporated. We note that [1] is motivated from an algorithmic rather than theoretical perspective.
 Grifin and Steel [7] present the  X  DDP based on the stick breaking construction [19], reordering the stick breaking ratios for each time so as to obtain different distributions over the particles. This work is further extended [8] to a generic stick breaking processes. Chung et al [5] propose a local DP that generalizes  X  DDP. Rather than reordering the stick breaking ratios, they regroup them locally such that dependent DPs can be constructed over a general covariate space. Inference in these mod-els requires sampling a series of auxiliary variables, considerably increasing computational costs. Moreover, the local DP relies on a truncated approximation to devise the sampling scheme. Recently, Rao and Teh [16] proposed the spatially normalized Gamma process. They construct a universal Gamma process in an auxiliary space and obtain dependent DPs by normalizing it within overlapped local regions. The theoretical foundation differs in that it does not exploit the relationship between the Gamma and Poisson process which is at the heart of the proposed model. In [16], the dependency is established through region overlapping; while in our work, this is accomplished by explicitly transferring particles from one DP to another. In addition, this work does not support location variation, as it relies on a universal particle pool that is fixed over time. We develop a Gibbs sampling procedure based on the construction of DDPs introduced above. The key idea is to derive sampling steps by exploiting the fact that our construction maintains the property of being marginally DP via connections to the underlying Poisson processes. Furthermore, the derived procedure unifies distinct aspects (innovation, removal, and transition) of our model. Let D  X  DP(  X  ) be a Dirichlet process on  X  . Then given a set of samples  X   X  D , in which  X  i appears c times, we have D |  X   X  DP(  X  + c 1  X   X  1 +  X  X  X  + c n  X   X  n ) . Let D 0 be a Dirichlet process depending on D as in Eq.(16),  X  0 = ( q X  )( X ) , and q i = q (  X  i ) . Given  X   X  D , we have Sampling from D 0 . Let  X  1  X  D 0 . Marginalizing over D 0 , we get Thus we sample  X  1 from three types of sources: the innovation distribution p  X  , the q -subsampled u 1 that indicates which source to sample from. Specifically, when u 1 =  X  1 , u 1 = 0 , or u 1 = l &gt; 0 ,  X  The next issue is how to update the posterior given  X  1 and u 1 . The answer depends on the value of u . When u 1 =  X  1 or 0 ,  X  1 is a new particle, and we have If u 1 = l &gt; 0 , we know that the particle  X  l is retained in the subsampling process (i.e. the corre-sponding Bernoulli trial outputs 1 ), and the transited version T (  X  l ) is determined to be  X  1 . Hence, With this posterior distribution, we can subsequently draw the second sample and so on. This process generalizes the Chinese restaurant process in several ways: (1) it allows either inheriting previous particles or drawing new ones; (2) it uses q k to control the chance that we sample a previous particle; (3) the transition T allows smooth variation when we inherit a previous particle.
 Inference with Mixture Models. We use the Markov chain of DPs as the prior of evolving mixture models. The generation process is formulated as Here, L (  X  i ) is the observation model parameterized by  X  i . According to the analysis above, we derive an algorithm to sample  X  1 ,..., X  n conditioned on the observations x 1 ,...,x n as follows. increase as we draw new particles from p  X  or p q X  . (2) Let w k denote the prior weights of different sampling sources which may also change during the sampling. Particularly, we set w k = q k c k for k &gt; 0 , w  X  1 =  X   X  , and w 0 =  X  0 . (3) Let  X  k denote the particles , whose value is decided when a new particle or the transited version of a previous one is sampled. (4) The label l i indicates to which particle  X  i corresponds and the counter r k records the number of times that  X  k has been sampled respectively when k =  X  1 , k = 0 and k  X  1 .
 Sequential Sampling. For each i = 1 ,...,n , we first draw the indicator u i with probability P ( u i = k )  X  w k F ( k,i ) . Depending on the value of u i , we sample  X  i from different sources. For brevity, let p | x to denote the posterior distribution derived from the prior distribution p conditioned on the then set  X  k =  X  i . If r k &gt; 0 , the k -th particle has been sampled before. Thus, we can simply set  X  =  X  k . In both cases, we set the label l i = k , increase the weight w i and the counter r i by 1 , and update F ( k,i ) to f ( x i |  X  k ) for each i .
 Note that this procedure is inefficient in that it samples each particle  X  k merely based on the first observation with label k . Therefore, we use this procedure for bootstrapping, and then run a Gibbs sampling scheme that iterates between parameter update and label update . (Parameter update): We resample each particle  X  k from its source distribution conditioned on all source  X  k was initially sampled from. After updating  X  k , we need to update F ( k,i ) accordingly. (Label update): The label updating is similar to the bootstrapping procedure described above. The only difference is that when we update a label from k to k 0 , we need to decrease the weight and counter for k . If r k decreases to zero, we remove  X  k , and reset w k to q k c k when k  X  m . At the end of each phase t , we sample  X  k  X  T (  X  k ,  X  ) for each k with r k = 0 . In addition, for each that the particle  X  k will survive in next phase. MATLAB code is available in the following website: http://code.google.com/p/ddpinfer/ . Here we present experimental results on both synthetic and real data. In the synthetic case, we compare our method with dynamic FMM in modeling mixtures of Gaussians whose number and centers evolve over time. For real data, we test the approach in modeling the motion of people in crowded scenes and the trends of research topics reflected in index terms. 6.1 Simulations on Synthetic Data The data for simulations were synthesized as follows. We initialized the model with two Gaussian components, and added new components following a temporal Poisson process (one per 20 phases Figure 1: The simulation results: (a) compares the performance between D-DPMM and D-FMM with differing on average). For each component, the life span has a geometric distribution with mean 40 , the mean evolves independently as a Brownian motion, and the variance is fixed to 1 . We performed the simulation for 80 phases, and at each phase, we drew 1000 samples for each active component. At each phase, we sample for 5000 iterations, discarding the first 2000 for burn-in, and collecting a sample every 100 iterations for performance evaluation. The particles of the last iteration at each phase were incorporated into the model as a prior for sampling in the next phase. We obtained the label for each observation by majority voting based on the collected samples, and evaluated the performance by measuring the dissimilarity between the resultant clusters and the ground truth using the variation of information [13] criterion. Under each parameter setting, we repeated the experiment 20 times, utilizing the median of the dissimilarities for comparison.
 We compare our approach (D-DPMM) with dynamic finite mixtures (D-FMM), which assumes a fixed number of Gaussians whose centers vary as Brownian motion. From Figure 1(a), we observe that when the fixed number K of components equals the actual number, they yield comparable per-formance; while when they are not equal, the errors of D-FMM substantially increase. Particularly, K less than the actual number results in significant underfitting (e.g. D-FMM with K = 2 or 3 at phases 30  X  50 and 66  X  76 ); when K is greater than the actual number, samples from the same com-ponent are divided into multiple groups and assigned to different components (e.g. D-FMM with K = 5 at phases 1  X  10 and 30  X  50 ). In all cases, D-DPMM consistently outperforms D-FMM due to its ability to adjust the number of components to adapt to the change of observations. We also studied how design parameters impact performance. In Figure 1(b), we see that an ac-ceptance probability q to 0 . 1 creates new components rather than inheriting from previous phases, leading to poor performance when the number of samples is limited. If we set q = 0 . 9 , the com-ponents in previous phases have a higher survival rate, resulting in more reliable estimation of the component parameters from multiple phases. Figure 1(c) shows the effect of the diffusion variance that controls the parameter variation. When it is small, the parameter in the next phase is tied tightly with the previous value; when it is large, the estimation basically relies on new observations. Both cases lead to performance degradation on small datasets, which indicates that it is important to main-tain a balance between inheritance and innovation. Our framework provides the flexibility to attain such a balance. Cross-validation can be used to set these parameters automatically. 6.2 Real Data Applications Modeling People Flows. It was observed [11] that the majority of people walking in crowded areas such as a rail station tend to follow motion flows. Typically, there are several flows at a time, and each flow may last for a period. In this experiment, we apply our approach to extract the flows. The test was conducted on video acquired in New York Grand Central Station, which comprises 90 , 000 frames for one hour ( 25 fps). A low level tracker was used to obtain the tracks of people, which were then processed by a rule-based filter that discards obviously incorrect tracks. We adopt the flow model described in [11], which uses an affine field to capture the motion patterns of each flow. The observation for this model is in the form of location-velocity pairs. We divided the entire sequence into 60 phases (each for one minute), extract location-velocity pairs from all tracks, and randomly choose 3000 pairs for each phase for model inference. The algorithm infers 37 flows in total, while at each phase, the numbers of active flows range from 10 to 18 . Figure 2(a) shows the timelines of the top 20 flows (in terms of the numbers of assigned observations). We compare the performance of our method with D-FMM by measuring the average likelihood on a disjoint dataset.  X  3 . 34 , when K are respectively set to 10 , 20 , 30 , 40 , and 50 . Consequently, with a much smaller number of components ( 12 active components on average), our method attains a similar modeling accuracy as a D-FMM with 50 components.
 Modeling Paper Topics. Next we analyze the evolution of paper topics for IEEE Trans. on PAMI. By parsing the webpage of IEEE Xplore, we collected the index terms for 3014 papers published in PAMI from Jan, 1990 to May, 2010 . We first compute the similarity between each pair of papers in terms of relative fraction of overlapped index terms. We derive a 12 -dimensional feature vector using spectral embedding [2] over the similarity matrix for each paper. We run our algorithm on these features with each phase corresponding to a year. Each cluster of papers is deemed a topic . We compute the histogram of index terms and sorted them in decreasing order of frequency for each topic. Figure 2(b) shows the timelines of top 10 topics, and together with the top two index terms for each of them. Not surprisingly, we see that topics such as  X  X eural networks X  arise early and then diminish while  X  X mage segmentation X  and  X  X otion estimation X  persist. We developed a principled framework for constructing dependent Dirichlet processes. In contrast to most DP-based approaches, our construction is motivated by the intrinsic relation between Dirichlet processes and compound Poisson processes. In particular, we discussed three operations: super-position, subsampling, and point transition, which produce DPs depending on others. We further combined these operations to derive a Markov chain of DPs, leading to a prior of mixture models that allows creation, removal, and location variation of component models under a unified formula-tion. We also presented a Gibbs sampling algorithm for inferring the models. The simulations on synthetic data and the experiments on modeling people flows and paper topics clearly demonstrate that the proposed method is effective in estimating mixture models that evolve over time. This framework can be further extended along different directions. The fact that each completely random point process is a Poisson process suggests that any operation that preserves the complete randomness can be applied to obtain dependent Poisson processes, and thus dependent DPs. Such operations are definitely not restricted to the three ones discussed in this paper. For example, random merging and random splitting of particles also possess this property, which would lead to an extended framework that allows merging and splitting of component models. Furthermore, while we focused on Markov chain in this paper, the framework can be straightforwardly generalized to any acyclic network of DPs. It is also interesting to study how it can be generalized to the case with undirected network or even continuous covariate space. We believe that as a starting point, this paper would stimulate further efforts to exploit the relation between Poisson processes and Dirichlet processes.
