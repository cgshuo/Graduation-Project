 When searching for place entities such as businesses or points of interest, the desired place may be close (finding the near-est ATM) or far away (finding a hotel in another city). Un-derstanding the role of distance in predicting user interests can guide the design of location search and recommendation systems. We analyze a large dataset of location searches on GPS-enabled mobile devices with 15 location categories. We model user-location distance based on raw geographic dis-tance (kilometers) and intervening opportunities ( n th clos-est). Both models are helpful in predicting user interests, with the intervening opportunity model performing some-what better. We find significant inter-category variation. For instance, the closest movie theater is selected in 17.7% of cases, while the closest restaurant in only 2.1% of cases. Overall, we recommend taking category information into ac-count when modeling location preferences of users in search and recommendation systems.
 H.3.3 [ Information Storage and Retrieval ]: Information Search and Retrieval Mobile local search; category; rank distance; cross entropy
Users interested in finding a location entity are increas-ingly using mobile devices to search, rather than desktop machines 1 . On mobile devices, the user X  X  location context is available with greater precision 2 , allowing it to answer questions such as What is the closest movie theater? By http://searchengineland.com/study-consumers-increasingly-turn-mobile-varied-media-combinations-last-mile-200283 visited February 2015 A median accuracy of 75 meters is reported in [12] contrast, the location of a desktop machine is inferred from its IP address, giving a city-level estimate. This would allow us to list which movie theaters are in the city, but not which is closest to the user. Given this improved location context, it is possible to study specific scenarios such as reranking search results [7] or identifying the specific place a user is currently visiting [12]. While such advances in specific prob-lem areas are valuable, they do not give us an overview of location intent on these new devices. Insights into location intent can guide our design for location-based applications, machine learning systems and evaluation metrics.

Geolocated mobile search logs from a general-purpose search engine provide an opportunity to study what types of loca-tion entities users find and select, and how this relates to their location context. Location context includes the loca-tion of the user, the distance of the user from the relevant entity, and the density of alternative entities near the user. The relationship between these aspects is complex, and may vary according to the category of entity. For example, if the density of nearby hotels and nearby ATMs is similar, that does not mean that users who search for the nearest ATM will also search for the nearest hotel. Motivated by this in-tuition, this study focuses on modeling user-entity distance and inter-category differences in location preference.
Our predictive models are based on raw geographic dis-tance ( How many meters is the ATM from me? ), and inter-vening opportunities ( How many other ATMs are closer? ). We make minimal assumptions about how an end-to-end system would work, by for example using querying, map-ping and ranking interfaces to narrow down the search. We analyse user needs in a system-agnostic manner.
 Aggregating data on local intent is a challenging problem. Our dataset is from the general-purpose Bing search engine. During the time of our data collection, the system returns up to three location results in the first instance, then the user can opt to view more. We do not employ human rele-vance assessors to judge the quality of the results, because we do not wish to rely on a third party to understand loca-tion intent. Instead we employ information on which results were selected in the touch-based interface, on the assump-tion that selected results are of interest. Unlike previous studies [7] we do not simply rerank the results to put the clicked item higher. Although reranking offers some benefit to users, it does not give a clear picture of location intent characterization and in-context information needs. For these reasons, we aggregate over queries for studying distance and category, and use cross entropy to evaluate predicted click distributions over location entities.
Cross entropy has been used to characterize the amount of information in personalized search signals [9], and to eval-uate click position bias in search results [3]. Similarly, we use cross entropy to measure the predictability of distance models for different business categories. Our results suggest significant inter-category variation, with the intervening op-portunity model performing better in most cases.
Mobile search is a relatively new field because mobile phones were not as commonly used for search prior to 2007. There are some early studies of mobile information seeking behavior [2, 4], but they do not relate directly to distance modeling or evaluation. Lymberopoulos et al. [8] predicted user clicks on mobile devices by incorporating location at dif-ferent levels of granularity (e.g., zip code or state), and sug-gested the state-level models achieves higher accuracy than a US-wide model. Lv et al. [7] noted that the click-through rate of a business in local search sublinearly decreases with the distance to the user, which is evaluated using a click-based reranking framework. Berberich et al. [1] leveraged direction requests from an online mapping service to deter-mine a reasonable travel distance for a user to a business, along with the business density in the area surrounding the business. We consider a superset of these scenarios, since we gather data from a general-purpose system that allows for driving directions, phone calls and informational intent.
One key exploration is to study the notion of interven-ing opportunities in the context of local search on mobile devices. In 1940, Stouffer [13] proposed that whether a per-son is willing to move to another place is dependent not on the geographic distance, but on the number of comparable alternatives along the way. This mobility model explained user movements from one neighborhood to another in the city of Cleveland. Our work does not make claims about the movements of people in a city; rather we reference his characterization to patronize a business or visit a point of interest. We adopt Stouffer X  X  proposal that a person X  X  will-ingness to visit a business is related to the number of compa-rable intervening businesses available to that person, which we denote as rank distance . Noulas et al. [10] used inter-vening opportunities to model Foursquare check-ins, finding that the probability of transitioning to a new location is in-versely proportional to a power of its rank. Kumar et al. [5] used a combination of distance and rank distance to model geographic choice. They tested this using driving directions data with a source and destination address, taking cases where the destination address is a restaurant and interpret-ing the source address as the user X  X  location.

We base our evaluation approach on cross entropy. En-tropy has been used widely to measure the degree of pre-dictability of a probability distribution. Mei and Church [9], for instance, estimated the size of the search space of the web using entropy, and further computed the conditional entropy to characterize the contribution of personalization in web search. Craswell et al. [3] compared cross entropy among various models of click position bias in a manner that is agnostic to the model itself.
Raw distance model . Given GPS coordinates, the most intuitive model is to directly measure the raw physical dis-Figure 1: The log-log plot for the probability distri-bution of clicks as a function of raw (left) and rank (right) distance. The distributions of categories Ho-tels and Convenience stores differ more in the raw distance model than the rank distance model. tance between users and places. We compute this using the great circle distance 3 . To avoid false assumptions, we opt for a non-parametric approach that counts the number of times entities are clicked given they were x kilometers away from users. In the training data, we discretize the raw distance and record the probability of click at each tick. We test different bucketing sizes including 1, 5 and 10 kilometers.
Rank distance model . For a place v , we define its rank distance as the number of places w that are in the same category as v but are closer to a user u than v is. That is, rank u ( v ) = | w : d ( u, w ) &lt; d ( u, v ) | +1. We count the number of times an entity is clicked at each rank, based on which the probability of click is calculated.

An important difference between rank distance and raw distance is related to business density. Users in a dense area, with many in-category alternatives, may tend to have lower raw distance and users in a sparse area will have higher raw distance. This makes it difficult for a single raw dis-tance model to explain users in both areas. By contrast, a rank distance model naturally predicts lower distances in dense areas because there are many nearby intervening op-portunities. For both models, we consider all nearby en-tities in the same category as alternatives 4 , not just those that were retrieved by the engine. We build both models in a per-category manner. Figure 1 shows the resulting dis-tance models for two example categories. In the raw distance model, the difference in click distributions is evident where we see the probability mass spreads out for the hotel enti-ties, implying that distance may play a less critical role for hotel selection. Interestingly, such variation in categories appears less obvious in the rank distance model, suggesting that rank distance is more invariant of categories, resembling the findings of human mobility in cities [10].

Cross Entropy . Evaluating local search is a challenging problem. The existing Cranfield style evaluation [11] is less appropriate in local search. Unlike web documents, local businesses are represented by metadata, which is sparse. The location relevance heavily depends on various contex-tual factors such as current user location or time [6, 8], mak-ing the assessment non-trivial to recover for offline judges.
Another popular approach to evaluation is to utilize click data in a reranking experiment, where clicks are approxi-http://en.wikipedia.org/wiki/Great-circle_ distance visited February 2015
We take into account entities within an area of 9  X  10 4 km for a better trade-off between efficiency and coverage. model with bucket size x and RankD is rank distance model.  X  mated as relevance judgments [1, 8]. The general goal is to improve retrieval metrics such as nDCG@10 or MAP by reranking top results [7]. One problem with this is that the collected responses are biased towards the design of search systems (e.g., ranking or display algorithms). For mobile search, this becomes more of a concern since only a small number of local entities are shown to users. At the time of our data collection, users were presented with three or fewer results in 97% of cases, making most clicks land on only the top three results. Indeed, if we compute MAP as in [7], we get 0.84 for our log sample, leaving it unclear if reranking and evaluating using clicks on top results truly reflects systems X  retrieval ability.

To address these difficulties, we look to an information-theoretic approach to evaluation. In information theory, en-tropy refers to the average amount of information contained in a sample, while cross entropy measures the average num-ber of bits needed to identify an event when a given distribu-tion P 0 is assumed rather than the true distribution P . We use cross entropy to measure how well the distance models learned from historical data predict users X  responses in the test set. That is, to measure the quality of distance models, we compare, for a test query, the test distribution P against the distribution estimated from the training data P 0 based on the formula H c =  X  P e p ( e ) log p 0 ( e ), where e denotes a local entity. Thus, cross entropy favors a model if P and P 0 are more similar. Although click data is still inherently biased by the user X  X  choice of query and the ranking of the search system, by aggregating over many such queries and incorporating all nearby opportunities, we hope to better represent the distribution of possible clicks for a given user location and business category.

We assemble a test query to be a tuple containing a user u , a clicked entity e of category c , all surrounding entities e of the same category c ( e is considered as in e 0 ), and the geo-information of u and e 0 . Given such tuple, we are able to compute the raw and rank distances from the current user to the clicked entity in a test case. This requirement of exact one clicked entity ensures that we hold no assump-tions about the probability of click in the test set (i.e., P ). That is, the test distribution will assign probability 1 to the clicked entity and 0 to the rest. Since our evaluation is based on the clicked entity, we must use the distance model to pre-dict which entity will be clicked. We do this separately for each test case, using either the raw or rank distance model to firstly assign a probability to each entity in e 0 based on its distance from the user, then renormalizing to give a proba-bility distribution over the set of those entities (i.e., e
Data Collection. We evaluate using Bing mobile search log of users in the U.S. The training data for building the distance models is sampled from a period of four months in 2014, and the evaluation set is sampled from the follow-ing two months. We complement the mobile search data with an entity repository that includes location information (i.e., latitude and longitude) and category information (i.e., whether an entity is a hotel or a convenience store etc). Our resulting test set contains approximately 1.1 million queries.
Baseline Approaches. The naive baseline assumes that no distance information is given between a place and a user, as is the case when users do not allow their location to be known. In this case, a uniform model assigns equal proba-bility to every in-category place entity (Uniform in Table 1). To improve the pure uniformity, the second baseline assigns equal probability to the user X  X  k closest in-category entities with a total probability mass 0.99, with the remaining 0.01 uniformly distributed to the much larger number of more distant alternatives. We denote this as a top k uniform model, and we report the results for the 50 closest entities (TopUni 50 in Table 1). These two approaches are used as comparison basis for the raw and rank distance models.
We take the average of the cross entropy of test queries in each category and show the results in Table 1. The naive uniform model gives an average cross entropy of 16.32, mean-ing that the search space for a category is approximately 2 16 when given no distance information. Under the top 50 nearby places, the average number of bits needed is reduced to 13.45, shrinking the search space about 8 times. The average cross entropy for user clicks is approximately 9.48 if we bucket the physical distance by 10 kilometers, which is a huge improvement compared to the top uniform model. The quantity becomes 9.37 and 9.33 respectively when using bucket sizes of 5 and 1 kilometers. This suggests that a finer granularity may lead to lower entropy but the improvement may saturate quickly. Finally, predicting user clicks with the rank distance model performs the best with the lowest cross entropy 9.18, which is a 10% reduction in the search space compared to the best performing raw distance model (i.e., at 1 km granularity). This suggests that using rank distance can explain users X  selections towards local places better in our test set, despite that the notion of rank distance, in fact, discards the geographic distance information.

In addition to distance, the categories of entities play an important role for predicting user clicks. The cross entropy H c of the uniform model is directly influenced by the num-ber of entities in a category. The more entities a category contains, the higher H c is since it is harder to predict which entities users may click without prior knowledge. In our dataset, the size of Restaurant category is the largest, re-sulting in the largest H c 19.23 compared to others.
Table 1 shows interestingly that H c for the Hotel category drops, at relatively smaller scale, from 15.89 in the uniform model to 13.28 in the rank distance model, resulting only a reduction of 16 . 41% in uncertainty. On the contrary, when the searches were intended for entities of ATMs or Conve-nience stores, H c drops significantly with more than 50% reduction in the rank distance model. This suggests that al-though the distance factor plays a strong role in predicting ATMs searches, the clicks on hotel entities are less explain-able using only distance from the searching user.

For categories such as Department store or Furniture store, the reduction in H c is evident in the rank distance model. This implies for queries with shopping intent, users may have a tendency to click entities that are closer to them. Entities of these categories may be more replaceable when the store items are not significantly different for the users also have a tendency to search for nearby movie theaters, where using rank distance can account for 57 . 92% uncer-tainty. The category Elementary school is another example where the closer entities seem preferable, consistent with our intuition that children go to the elementary school in their neighborhood in most districts.

When are users more willing to travel farther even in the presence of entities that are nearby? Relatively speaking, for categories such as Healthcare, Lawyer and Auto Main-tenance, the entropy reduction degree is smaller compared to ATM or Convenience store, but not as small as in Hotel. People may skip closer places and seek their more desired choices in the cost of travel. This can be because these enti-ties usually provide services that require specific professional knowledge, and nearby places might not meet a user X  X  ex-act need. As the cost increases, the overhead of travel may suppress the desire, which is different from the case of Hotel where distance plays even a less important role. Interest-ingly, we observe that searchers skipped closer intervening opportunities and clicked restaurants farther away. Indeed, people go to restaurants not only for food, but also for fac-tors such as the atmosphere, the chef and nearby attractions or friends. The results for categories such as Church, Apart-ment and Government office also imply that using distance
We note that there should be exceptions when users look for things only available in specific stores. alone is not sufficient for predicting user clicks.

So far we focus our discussion on the comparison within the rank distance model. Similar trends can be observed if we compare results within the top uniform or the raw distance model, with varying degree in entropy reduction. It is interesting to note that in the top 50 uniform model, the assumption that closer entities should receive more clicks fails for the case of hotels and restaurants; the uncertainty in fact increases compared to pure uniformity.
This paper explored several ways that distance can be modeled in the context of mobile local search. Rather than merely reranking the top results, we considered intervening entities that were physically near the users, shedding light on user choices beyond those on the result page. The cross en-tropy results suggest that raw geographic and rank distance are both helpful, with the rank distance model outperform-ing in most cases. This suggests that the task of mobile local search resembles general human mobility in that it is influenced by intervening opportunities. Our analysis iden-tifies significant inter-category variation. We find that loca-tions that are highly replaceable (e.g., convenience stores) are more predictable based solely on distance, whereas user clicks on categories such as hotels and restaurants are de-pendent on complex factors. Overall, we recommend taking category information into account when modeling location preferences of users in search and recommendation systems.
