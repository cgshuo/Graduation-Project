 Recent technological innovation in the Web such as blogosphere and knowledge/media-sharing sites is remarkable, which has made it possible to form various kinds of large social networks through which behaviors, ideas, rumors, and opinions can spread, and our behavioral patterns are to a considerable degree affected by the interaction with these networks. Substantial attention has been directed to investigating the spread of information in these networks [Newman et al. 2002; Newman 2003; Gruhl et al. 2004; Domingos 2005; Leskovec et al. 2006; Crandall et al. 2008; Wu and Huberman 2008].
These studies have shown that it is important to consider the diffusion mechanism explicitly and the measures based on network structure alone, that is, various centrality measures, are not enough to identify the important nodes [Kimura et al. 2009, 2010a]. Information diffusion is modeled typically by probabilistic models. Most representa-tive and fundamental ones for general information diffusion include the Independent Cascade (IC) model [Goldenberg et al. 2001; Kempe et al. 2003], Linear Threshold (LT) model [Watts 2002; Watts and Dodds 2007], and their extensions that include incorpo-rating asynchronous time delay [Saito et al. 2009b; 2010a]. The IC model is a model of information push style, that is, the information sender (a node) tries to push the infor-mation to the neighboring receivers (child nodes) in a probabilistic way. The LT model is a model of information pull style, that is, the information receiver (a node) tries to pull the information from the neighboring senders (parents nodes) in a probabilistic way. Since the focus of study is  X  X nfluence X , these models assume binary states, that is, nodes are either active (influenced) or inactive (uninfluenced). Explicit use of these models to solve such problems as the influence maximization problem [Kempe et al. 2003; Kimura et al. 2010a; Chen et al. 2010a, 2010b] and the contamination minimization problem [Kimura et al. 2009] clearly shows the advantage of the model. The identified influential nodes and links are considerably different from the ones identified by the centrality measures. Another type of information diffusion model that is also often used is the voter model [Even-Dar and Shapria 2007] and its extensions that include incorporating opinion values [Kimura et al. 2010b], node strength [Yamagishi et al. 2011], and antimajoritarian tendency [Kimura et al. 2011]. The voter model is a model of information pull style and is used to study the spread of opinions, that is, opinion formation. It is similar to the LT model in that the opinion of a person is affected by the opinions of his/her neighbors. What is different from the LT model is that it has to have multiple states if it has to deal with multiple opinions 1 . This notion is not necessarily limited to opinion. Application such as an online competitive service in which a user can choose one from multiple choices/decisions requires a model that handles multiple states. There has been a variety of work on the voter model, too. Dynamical properties of the basic model have been extensively studied including how the degree distribution and the network size affect the mean time to reach consensus from mathematical point of view [Liggett 1999; Sood and Redner 2005]. Several variants of the voter model are also investigated and nonequilibrium phase transition is analyzed [Castellano et al. 2009; Yang et al. 2009] from the physics point of view. Yet another line of work extends the voter model by combining it with a network evolution model [Holme and Newman 2006; Crandall et al. 2008]. Kimura et al. [2010b] analyzed how the opinion values affect the opinion share dynamics in their recent study.

What is common to all the preceding models is that they are all probabilistic models and have parameters to characterize the information diffusion. The parameters must be known in advance for the model to be usable for analysis. It is generally difficult to determine the values of these parameters theoretically, and thus, attempts have been made to learn these parameter values by observing the information diffusion sequence data [Saito et al. 2009a, 2009b, 2010a, 2010b; Gomez-Rodriguez et al. 2010; Myers and Leskovec 2010; Kimura et al. 2010b]. In essence the likelihood of generating the observed data by the model employed is first derived, and then the parameter values are determined such that the likelihood is maximized. In particular, Myers and Leskovec [2010] showed that for a certain class of diffusion models, the problem can effectively be transformed to a convex programming for which a global solution is guaranteed. Another important common assumption made in these studies is that the model is stationary. Since the model is probabilistic, even if the model is stationary, the way information propagates from a particular node is not the same (not deterministic) and each time the diffusion result is different. However, the model parameter values remain the same during the whole course of analysis.

This article addresses a different aspect of information diffusion and extends and integrates our recent studies [Saito et al. 2011a; Ohara et al. 2011]. We note that our behavior is affected not only by the behavior of our neighbors but also by other external factors. The model only accounts for the interaction with neighbors. The behavior we observe includes both effects. The problem we address here is to detect the change in the model from a limited amount of observed information diffusion data. If this is possible, this would bring a substantial advantage. For example, we can infer that something unusual happened during a particular period of time by simply analyzing the limited amount of data.
 This is in some sense the same, in the spirit, with the work by Kleinberg [2002] and Swan and Allan [2000]. They noted a huge volume of the data stream and tried to organize it and extract structures behind it. This is done in a retrospective framework, that is, assuming that there is a flood of abundant data already and there is a strong need to understand it. Kleinberg X  X  work is motivated by the fact that the appearance of a topic in a document stream is signaled by a  X  X urst of activity X  and identifying its nested structure manifests itself as summarization of the activities over a period of time, making it possible to analyze the underlying content much easier. He used a hidden Markov model in which bursts appear naturally as state transitions, and successfully identified the hierarchical structure of email messages. Swan and Allan X  X  work is motivated by the need to organize a huge amount of information in an efficient way. They used a statistical model of feature occurrence over time based on hypotheses testing and successfully generated clusters of named entities and noun phrases that capture the information corresponding to major topics in the corpus, and designed a way to nicely display the summary on the screen (Overview Timelines). Our aim is not exactly the same as theirs. We are interested in detecting changes in the external factors which are hidden/embedded in the data. We also follow the same retrospective approach, that is, we are not predicting the future, but we are trying to understand the phenomena that happened in the past. There are many factors that bring in changes and evidently the model cannot accommodate all of them. We formalize this as the unknown changes in the parameter value of the diffusion model we employ, and we re-duce the problem to that of detecting where in time and how long this change persisted and how big this change is. We call the period where the parameter takes anomalous values as  X  X ot span X  and the rest as  X  X ormal span X .

We have chosen the Asynchronous Independent Cascade (AsIC) model [Saito et al. 2009b; 2010a] as the one that represents the model of information push style, and the Value-weighted Voter (VwV) model [Kimura et al. 2010b] as the one that represents the model of information pull style 2 . As explained before, the AsIC is the model for general information diffusion with binary states and the parameter to detect its change is diffusion probability. By contrast, the VwV is the model for opinion formation with multiple states and the parameter to detect its change is opinion value. These two models are recalled in Section 2. We generalized the parameter optimization algorithm that was first introduced in Saito et al. [2011a] and Ohara et al. [2011] so that it can cover both the models as two different instances and expanded the experiments to verify that the same algorithm works satisfactorily for two different types of information diffusion models. As in our previous work, we limit the form of change to a rect-linear one, that is, the parameter value changes to a new large value, persists for a certain period of time, and is restored to the original value and stays the same thereafter 3 . In this simplified setting, detecting the hot span is equivalent to identifying the time window where the parameter value is anomalous and estimating the parameter values both in the hot and the normal spans.
 We use the same parameter optimization algorithm as in Saito et al. [2009b] and Kimura et al. [2010b], that is, the EM-like algorithm for the AsIC model that iteratively updates the values to maximize the model X  X  likelihood of generating the observed data sequences, and the Newton method for the VwV model that guarantees globally maximizing the likelihood. However, the problem here is more difficult because it has another loop to search for the hot span on top of the aforesaid loop. The naive learning algorithm has to iteratively update the patten boundaries (outer loop) and the value must also be optimized for each combination of the pattern boundaries (inner loop), which is extraordinariy inefficient. Our main contribution is that we devise a very efficient general search algorithm which works for probabilistic information diffusion models and avoids the inner loop optimization by using the information of the first-order derivative of the likelihood with respect to the parameters. We test its performance using the structures of four real-world networks (Blog, Coauthorship, Enron, and Wikipedia), and confirm that the algorithm can efficiently identify the hot span correctly as well as the parameter values of both the normal and the hot spans. We further compare our algorithm with the naive method that finds the best combination of the hot span boundaries by an exhaustive search from a set of randomly selected boundary candidates. Moreover we show that the proposed algorithm far outperforms the naive method both in terms of accuracy and computation time.

The article is organized as follows. After very briefly introducing the two diffusion models, AsIC and VwV in Section 2, we define the problem in Section 3 and recall how the parameters can be learned in each model in Section 4. The main part is Section 5 where we explain how we efficiently search for the hot span as well as the parameter values. The results are explained in Section 6, followed by discussion in Section 7. We end this article by summarizing the main result in Section 8. We focus on two types of information diffusion model on a social network G = ( V , E ), where V and E (  X  V  X  V ) are the sets of all the nodes and the links, respectively. One is the Asynchronous Independent Cascade (AsIC) model that is an extension of the Independent Cascade (IC) model, and the other is the Value-weighted Voter (VwV) model that is an extension of the standard voter model. They were extended to meet more realistic situations. We recall their definitions next. The AsIC model we use in this article incorporates asynchronous time delay into the IC model which does not account for time delay, noting that each node changes its state asynchronously in reality [Saito et al. 2009b, 2010a]. Here, we consider choosing a delay time from the exponential distribution for the sake of convenience, but of course other distributions such as power law and Weibull can be employed.

For the AsIC model, the underlying network G = ( V , E ) is a directed graph. For any v  X  V , the set of all the nodes that have links from v (child nodes) is denoted by and the set of all the nodes that have links to v (parent nodes) is denoted by Each node has one of the two states (active and inactive), and the nodes are called active if they have been influenced. It is assumed that nodes can switch their states only from inactive to active.

The AsIC model has two types of parameters p u ,v and r u ,v with 0 &lt; p u ,v &lt; 1and r ,v &gt; 0, where p u ,v and r u ,v are referred to as the diffusion probability through link ( u ,v )andthe time-delay parameter through link ( u ,v ), respectively. We define the diffusion probability vector p and the time-delay parameter vector r by The information diffusion process unfolds in continuous time t , and proceeds from a given initial active node in the following way. When a node u becomes active at time t , it is given a single chance to activate each currently inactive node v  X  F ( u ). A delay time  X  is chosen from the exponential distribution with parameter r u ,v . The node u attempts to activate the node v if v has not been activated by time t +  X  , and succeeds with probability p u ,v .If u succeeds, v will become active at time t +  X  . The information diffusion process terminates if no more activations are possible. The mathematical model we use for the diffusion of opinions is the VwV model with K (  X  2) opinions [Kimura et al. 2010b]. For the VwV model, the underlying network G = ( V , E ) is an undirected (bidirectional) graph with self-loops. For a node v  X  V ,let ( v ) denote the set of neighbors of v in G ,thatis, Note that v  X  ( v ) because of the existence of self-loops.

In the VwV model, each node of G is endowed with ( K + 1) states; opinions 1 ,..., K , and neutral (i.e., no-opinion state). It is assumed that a node never switches its state from any opinion k back to neutral. The model has a parameter w k ( &gt; 0) for each opinion k , which is called the opinion value and must be estimated from observed opinion diffusion data. We define the opinion-value vector w by Let f t : V  X  X  0 , 1 , 2 ,..., K } denote the opinion distribution at time t , where f t ( v ) stands for the opinion of node v at time t , and opinion 0 denotes the neutral state. We also denote by n k ( t ,v ) the number of v  X  X  neighbors that hold opinion k as the latest one before time t for k = 1 , 2 ,..., K ,thatis, where  X  t ( u ) is the latest opinion of u before time t .

Given a target time T , and an initial state in which each opinion is assigned to only one distinct node and all other nodes are in the neutral state, the evolution process of the model unfolds in the following way. At time 0, each node v independently decides its update time t according to some probability distribution such as an exponential distribution with parameter r v , where r v becomes also a model parameter and then we define the time-delay parameter vector r by r = ( r v ) v  X  V . The successive update time is determined similarly at each update time t . Node v changes its opinion at its update time t as follows: If node v has at least one neighbor with some opinion before f ( v ) = 0 with probability 1. It is noted that since node v is included in its neighbors by definition, its own opinion is also reflected. The process is repeated from the initial time t = 0 until the next update time attains a given final time T . We address the hot span detection problem . In this problem, we assume that some change has happened in the way the information diffuses. We observe the diffusion sequences of a certain topic in which the change is embedded, and consider detecting where in time and how long this change persisted and how big this change is. In the following subsections, we describe a specific detection problem by focusing on the aforesaid diffusion models, that is, the AsIC model and the VwV model. An information diffusion result generated by the AsIC model is represented as a set of a diffusion result D (0 , T ), where the initial activation time is set to 0 and the final observation time is denoted by T . Since we employ only a single diffusion result D (0 , T ), r ,v = r (  X  ( u ,v )  X  E ), which should be acceptable noting that we can naturally assume that people behave quite similarly when talking about the same topic (see Section 7).
Let [ T 1 , T 2 ) denote the hot span of the information diffusion, and let p n and p h denote the diffusion probability for the normal span and the hot span, respectively. Namely, the diffusion probability p is obtained by p = p n for the period [0 , T 1 ), p = p h for the the time-delay parameter r does not change and takes the same value for the entire period [0 , T ). Then, the hot span detection problem is reduced to detecting the hot span [ T
Figure 1 shows five examples of diffusion sample with (Figure 1(b) and without (Figure 1(a)) a hot span based on the AsIC model, where the parameters are set at p described later in Section 6.1. We plotted the ratio of active nodes (the number of nodes activated at time step t divided by the number of total active nodes over the whole time span) for five independent simulations, each from a randomly chosen initial source node at time t = 0. Comparing these two figures, we can clearly see bursty activities around the hot span [10 , 20) in Figure 1(b). However, each curve in Figure 1(b) behaves differently, that is, some have their bursty activities only in the first half, some others have them only in the last half, and yet some others have two peaks during the hot span. This means that it is quite difficult to accurately detect the true hot span from only a single diffusion sample. Methods that use only the observed bursty activities, including those proposed by Swan and Allan [2000] and Kleinberg [2002], would not work. Similarly to the detection problem for the AsIC model, let [ T 1 , T 2 ) denote the hot span of the diffusion of opinions under the VwV model. Recall that this implies that the intervals [0 , T 1 ) and [ T 2 , T ) are the normal spans. We place the same assumption that there is no change in the value of the time-delay parameter vector r for simplicity. Let w n and w h denote the opinion-value vectors for the normal span and the hot span, model is invariant to positive scaling of the opinion-value vector w , where w n and w problem is formulated as follows: Given the opinion diffusion data D (0 , T ) in time the hot span and the opinion-value vector w n of the normal span. Here, D (0 , T ) consists of a sequence of ( v, t , k ) such that node v changed its opinion to opinion k at time t .
Figure 2 shows two examples of opinion diffusion sample with (Figures 2(c) and 2(d)) and without (Figures 2(a) and 2(b)) a hot span based on the VwV model with K = 3 opinions, where the opinion-value vectors are set at w = (2 . 0 , 1 . 0 , 1 . 0) for for Figures 2(c) and 2(d). The network used is the same blog network as in Figure 1. We plotted the population of each opinion k , |{ v  X  V ; f t ( v ) = k }| , as a function of time t . It must be difficult to know the existence of a hot span from only their curves depicted in Figures 2(b) and 2(d). Moreover, since the VwV model is a stochastic process model, every sample of opinion diffusion can behave differently. Again, this means that it is quite difficult to accurately detect the true hot span from only a single sample of opinion diffusion. We believe that an explicit use of underlying opinion diffusion model is essential to solve this problem. It is crucially important to detect the hot span precisely in order to identify the external factors that caused the behavioral changes. We describe the framework of model parameter learning as a likelihood maximization problem for the AsIC and the VwV models.
 First, we consider estimating the values of diffusion probability p and time-delay no hot span. Recall that the initial activation time is set to 0 and the final observation time is denoted by T . Let D be the set of all the activated nodes in D (0 , T ), that is, For each node v  X  D , let A v be the set of its parent nodes that had a chance to activate it, that is,
Although we place a constraint that p u ,v = p , r u ,v = r (  X  ( u ,v )  X  E ), we develop a general theory in terms of p and r to be consistent with the description in Section 5.2. v at time t v , that is, A v within the time period ( t u , t v ), that is, By using Eqs. (1) and (2), we can obtain the probability density h v ( p , r ) that a node v is activated at time t v , obtained for observed data D (0 , T ).
 be stably obtained by maximizing Eq. (5) using an EM-like algorithm (see Appendix A for more details).

Now, we assume that there exists a hot span S = [ T 1 , T 2 ). Let p ( t ) denote the value of parameter p at time t . According to our problem setting, we consider the parameter switching For the hot span S , we split the set of the active nodes D as follows.
 time t v when there exists hot span S . By using Eqs. (1) and (2), we obtain the hot span detection problem by adequately modifying Eq. (5) under the switching scheme as follows.
 span detection problem is formalized as the following maximization problem We also consider estimating the value of opinion-value vector w from an observed opinion diffusion data D (0 , T ) in time interval [0 , T ) (a single example) when there is no hot span 4 . From the evolution process of the model, we can obtain the following log-likelihood function where Thus, our estimation problem is formulated as a maximization problem of the log-likelihood function L ( w ; D (0 , T )) with respect to w . We find the optimal value of w by employing a standard Newton method (see Appendix B for more details).

Now, we assume that there exists a hot span S = [ T 1 , T 2 ). Let w ( t ) denote the value of opinion-value vector w at time t . We also consider the following parameter vector switching. time interval [ T s , T e ), that is, can be defined for the hot span detection problem by adequately modifying Eq. (9) under this switching scheme as follows.
 Again, the extended objective function is expected to be maximized by setting S to be the true span S  X  = [ T  X  1 , T  X  2 ), provided that D (0 , T ) is generated by the VwV model with hot span S  X  and is sufficiently large. Therefore, our hot span detection problem is formalized as the following maximization problem where  X  w n ( S )and  X  w h ( S ) denote the maximum likelihood estimators for a given S . We propose a general method of detecting a hot span that is applicable to both the AsIC model and the VwV model. In order to obtain the optimal hot span  X  S according to either Eq. (8) or Eq. (12), we need to prepare a reasonable set of candidate hot spans, denoted by H . One way of doing so is to construct H by considering all pairs of observed activation (or opinion change) time points. In general, let T denote the set of all the observed activation (or opinion change) time points.
 Then, we can construct a set of candidate hot spans by
Hereafter, we denote the model parameter vector by  X  ,thatis,  X  = ( p , r ) for the AsIC model and  X  = w for the VwV model. Since the parameter vector  X  is a function of time t in our problem setting, we denote by  X  ( t ) the value of  X  at time t . Given a hot span S = [ T Let S  X  = [ T  X  1 , T  X  2 ) be the true hot span. We assume that observed data D (0 , T )is generated by using the parameter vector  X   X  ( t ) of hot span S  X  .Inwhatfollows,after introducing a naive method, we describe our proposed detection method. Both Eq. (8) and Eq. (12) can be solved by a naive method which has two iterative loops. In the inner loop we first obtain the maximum likelihood estimators,  X   X  n and  X   X  h , either the EM-like algorithm or the Newton method. In the outer loop we select the be extremely inefficient when the number of candidate spans is large. Thus, in order to make it work with a reasonable computational cost, we consider restricting the number of candidate time points to a smaller value, denoted by J , that is, we construct T J (  X  T ) by selecting J points from T ; then we construct a restricted set of candidate spans by Note that | H J |= J ( J  X  1) / 2, which is large when J is large. It is easily conceivable that the naive method can detect the hot span with a reasonably good accuracy when we set J large at the expense of the computational cost, but the accuracy becomes poorer when we set J smaller to reduce the computational load. We propose a novel detection method shortly that alleviates this problem and can efficiently and stably detect a hot span from the diffusion result D (0 , T ).
We first obtain the maximum likelihood estimators,  X   X  , based on the original objective function of either Eq. (5) or Eq. (9). Next, we focus on the first-order derivative of the objective function L (  X  ; D (0 , T )) with respect to the parameter vector  X  in each obser- X  ,...,  X  and  X   X  is the maximum likelihood estimator based on L (  X  ; D (0 , T )), that is, when no change in  X  is assumed, we have
L be L (  X   X  L (  X   X  ,...,  X   X  ; D (0 , T )). Then, we can obtain the following first-order Taylor expansion. Moreover, by noting Eq. (13), we obtain the following result.
 Here note that we can naturally assume that each gradient vector with respect to  X  j is by considering the following partial sum for a candidate hot span S = [ T 1 , T 2 )  X  H we can expect that g ( S ) is maximized when S  X  S  X  .

Therefore, we propose the method of detecting the hot span by In case of the AsIC model, (see Eq. (5)), and in case of the VwV model (see Eqs. (9)).

Here note that we can incrementally calculate g ( S ). More specifically, we can obtain the following formula for examining each candidate span is much smaller than the naive method described earlier. When | T | is very large, we construct a restricted set of candidate spans H J as explained before. We summarize our proposed method next. (1) Maximize L (  X  ; D (0 , T )) by using the parameter estimation method. (2) Construct the candidate time set T and the candidate hot span set H . (3) Detect the hot span  X  S by Eq. (16) and output  X  S . Here note that the proposed method requires likelihood maximization by using the parameter estimation method only twice. We experimentally investigated how accurately the proposed method can estimate both the hot span and the diffusion parameters for the hot and the normal spans, as well as its efficiency, by comparing it with the naive method using four real-world networks. We used four real large networks which are all bidirectionally connected 6 . The first one is a trackback network of Japanese blogs used in Kimura et al. [2009]. It has 12,047 nodes and 79,920 directed links (the blog network). The second one is a coau-thorship network used in Palla et al. [2005], which has 12,357 nodes and 38,896 directed links (the coauthorship network). The third one is a network derived from the Enron Email Dataset [Klimt and Yang 2004] by extracting the senders and the recipients and linking those that had bidirectional communications. It has 4,254 nodes and 44,314 directed links (the Enron network). The fourth one is a network of people that was derived from the  X  X ist of people X  within Japanese Wikipedia, used in Kimura et al. [2008], and has 9,481 nodes and 245,044 directed links (the Wikipedia network). We generated diffusion results using both the AsIC model (for information diffusion evaluation) and the VwV model (for opinion population diffusion evaluation) for each of the preceding networks under the following settings. As for the AsIC model, we is the mean out-degree of the network. With this base value, for an arbitrary node in the network, the expected number of its child nodes that it succeeds in activating becomes approximately equal to one at least at an early phase of the information diffusion. If the diffusion probability is much smaller than the base value, the diffusion process would end up with only a small number of active nodes on the average. On the other hand, if it is much larger, the information rapidly spreads throughout the entire network and the process finishes at an early phase of the diffusion. Both cases are not appropriate to our aim of investigating the hot span detection, that is, we need a fair amount of information diffusion taking place around the hot span. Thus, in our experiments, we set the diffusion probability for the normal span, p  X  n , to be a value slightly smaller than the base value, and set the diffusion probability for the hot span, p  X  h , to be three times 0 . 6 for the coauthorship network, 0 . 05 and 0 . 15 for the Enron network and 0 . 02 and 0 . 06 for the Wikipedia network, respectively. As explained in Section 3.1, we assumed that the time-delay parameter does not change, and fixed its value to be 1 ( r  X  = 1) for all the networks because changing r  X  works only for scaling the time axis of the diffusion results. We set the observation period to be [0 , T = 30) and the hot span to be [ T  X  1 = 10 , T  X  2 = 20) based on the observation on the preliminary experiments. In all we generated 10 information diffusion results using these parameter values, each starting from a randomly selected initial active node for each network.

As for the VwV model, for each of the aforesaid networks, we generated opinion diffusion results according to the model for three different values of K (the number of opinions), that is, K = 2, 4, and 8, by choosing the top K nodes with respect to node degree ranking as the initial K nodes. We assumed that the values of all the opinions were initially 1 . 0, that is, the value parameters for all the opinions are 1 . 0forthe normal span. Further we assumed that only the value of the first opinion changed to double for the hot span, that is, the value parameter of the first opinion is 2 . 0andthe value parameters of all the other opinions are 1 . 0 for the hot span. Again, based on the observation on the preliminary experiments, we set the observation period and the hot span to be [0 , T = 25) and [ T  X  1 = 10 , T  X  2 = 15), respectively, and generated 10 opinion diffusion results for each network.

We then estimated the hot span [ T  X  1 , T  X  2 ) and the diffusion parameters of each model, that is, the diffusion probabilities p  X  n (for the normal span) and p  X  h (for the hot span) for the AsIC model, and the opinion-value vectors w  X  n (for the normal span) and w  X  h (for the hot span) for the VwV model by the two methods (the proposed and the naive), and compared them in terms of (1) the accuracy of the estimated hot span  X  S = [  X  T 1 ,  X  T 2 ), tegrated estimation error, and (4) the computation time. The accuracy of the estimated AsIC and VwV models. The accuracy of the estimated diffusion parameters is evalu-model, and E w = K i = 1 ( |  X  w n and  X  w  X  n E  X  in a comprehensive manner, where  X   X  ( t )and  X   X  ( t ) is the diffusion parameter vector to be assumed true and its estimation at time t for the corresponding model, respectively. For the proposed method, we adopted 1,000 as the value of J (the number of candidate time points) for the VwV model, while we used all the possible time points, that is, J = N for the AsIC model because the number of time points for opinion changes in the VwV model is observed to be much larger than the number of node activations for the AsIC model for the same period of time. For the naive method, we tested three cases of J = 5, 10, and 20 for both the models. Both the proposed and the naive methods were tested on each diffusion result for each model mentioned previously on a PC with Intel Core 2 Duo 3 GHz, and the results were averaged over the ten independent trials for each network. Figures 4 to 7 summarize the results for the AsIC model. Figure 4 shows the accuracy of  X 
S in the absolute error E S defined earlier. We see that the proposed method achieves a good accuracy, much better than the naive method for every network. As expected, E S for the naive method decreases as J becomes larger. But, even in the best case ( J = 20), its average error is about 3 to 10 times larger than that of the proposed method. Figure 5 error for the naive method decreases as J becomes larger. However, even in the best case ( J = 20), it is about 2 to 3 times larger than that of the proposed method. We note that the average errors for the coauthorship network are relatively large. This is because the number of active nodes within the normal span was relatively small for this network. Figure 6 shows the integrated estimation error given by E  X  ( t ) , which supplements our insights derived from the preceding results. For example, although the relative error of the estimated diffusion probabilities of the naive method ( J = 20) is less than twice as big as the proposed method for the Enron network, its value of E  X  ( t ) becomes more than twice of the proposed method by considering the estimation error of the hot span. Overall, even in the best case of the naive method ( J = 20), its integrated estimation error is about 2 to 4 times larger than that of the proposed method. Figure 7 shows the computation time. It is clear that the proposed method is much faster than the naive method. The significant difference is attributed to the difference in the number of runs of the EM-like algorithm. The proposed method executes the EM-like algorithm only twice: steps 1 and 4 in the algorithm (see Section 5.2). On the other hand, the naive method has to execute the EM-like algorithm once for every single candidate hot span S  X  H time of the naive method for J = 5 is about 5 times larger for every network, which is consistent with the fact that | H 5 |= 10. This relation roughly holds also for the other two cases ( J = 10 and J = 20). This means that even if the naive method could achieve a good accuracy by setting J to a sufficiently large value, it would require unacceptable computation time for such a large J . Overall, the proposed algorithm is about 3 times more accurate in the fastest case for the naive method (in the case of the coauthorship network under J = 5) and about 100 times faster in its most accurate case (in the case of the Wikipedia network under J = 20). Finally, we illustrate the actual behavior of g ( S ) derived from an information diffusion result for the blog network under the AsIC model in Figure 8(a), where g ( S ) is depicted as a function of the ending point t of S when its starting point is fixed to a certain value. We can see the blue broken curve showing g ([0 , t j )) has two peaks at around t j = 10 and t j = 20, which are the starting and ending points of the true hot span, respectively. This means that the sign Thus, the red solid curve showing g ([10 , t j )) has only one peak at around t j = 20, which is the global maximum among all the possible g ( S ) . Thanks to Eq. (17), the proposed method can efficiently calculate the behavior of g ( S ) , and thus can find out the hot span more accurately and more efficiently than the naive method does.
In summary, we can say that the proposed method can detect and estimate the hot span and diffusion probabilities for the AsIC model much more accurately and efficiently compared with the naive method. Figures 9 to 12 show the experimental results for the VwV model. Similarly to the results for the AsIC model, from these results, we can find that the proposed method is much more accurate than the naive method for every network. Again, the average error for the naive method decreases as J becomes larger. But, even in the best case for the naive method ( J = 20), its average error in the estimation of the hot span is maximum about 30 times larger than that of the proposed method (in the case of the Enron network under K = 2) as shown in Figure 9, and it is maximum about 6 times larger in the estimation of opinion values (in the case of the coauthorship network under K = 2) as shown in Figure 10. Figure 11 shows that the proposed method is better than the naive method in the integrated estimation accuracy for every case. It is noted that the naive method needs much longer computation time to achieve these best accuracies than the proposed method, as shown in Figure 12, despite that the number of candidate time points for the naive method is 50 times smaller. Indeed, it is about 20 times longer in the case of the Enron network under K = 2, about 13 times longer in the case of the coauthorship network under K = 2, and maximum about 95 times longer for the whole results (in the case of the Enron network under K = 8). Overall, the proposed method is about 7 times more accurate in the fastest case for the naive method (in the case of the blog network under K = 2and J = 5) and about 13 times faster in its most accurate case (in the case of the coauthorship network under K = 2and J = 20). Figure 8(b) shows the behavior of || g ( S ) || derived from an opinion diffusion result for the blog network under the VwV model. Similarly to the case of the AsIC model, it is found that the blue broken curve showing || g ([0 , t j )) || has two peaks at around t j = 10 and t j = 15, which are the starting and ending points of the true hot span, respectively. In this case, the red solid curve starting from t j = 10 has only one peak at around t j = 15, which becomes the global maximum among all the possible || g ( S ) || . The proposed method can find out the time span that results in the global maximum from a set of the candidate time points efficiently for the VwV model, too.
From these results, it can be concluded that the proposed method is able to detect and estimate the hot span and opinion values for the VwV model much more accurately and efficiently compared with the naive method. The results in the previous section indicate that the proposed approach works as in-tended for both AsIC and VwV diffusion models. Although we believe that the approach is generic, it has yet to be verified whether the approach is applicable to any other model in so far as it is formulated as a probabilistic diffusion model.

We placed a simplifying constraint that the parameters p u ,v and r u ,v of the AsIC single topic diffusion sequences. Our previous experiments [Saito et al. 2009b, 2010a, 2010b] give some evidences which support the validity of this constraint. We exam-ined 7,356 diffusion sequences for a real blogroll network containing 52,525 bloggers and 115,552 blogroll links, and have experimentally confirmed that the diffusion and time-delay parameters that were learned from different diffusion sequences belonging to the same topic were quite similar for most of the topics. This observation naturally suggests that people behave quite similarly for the same topic. On the other hand, our recent study indicates that these parameters can be learned by assuming their functional dependency on the neighboring node attributes [Saito et al. 2011b]. We can extend this approach to augment the attributes to include the node-independent exter-nal factor. This way the uniformity assumption can be removed. We have considered only the AsIC as a model of general information diffusion, but it is straightforward to apply the same technique to the AsLT model [Saito et al. 2010b] and the SIS (suscep-tible/infectious/susceptible) versions of both the models in which each node is allowed to be activated multiple times.

The change pattern we used is also very simple. We assumed that the parameters of all nodes and links change instantaneously and simultaneously in the same de-gree and stay the same during a given hot span. We can assume a more intricate problem setting such that p u ,v (for AsIC), w u (for VwV) and r u ,v (for both) change for multiple distinct hot spans and the shape of change pattern p u ,v and w u are not necessarily rect-linear. One possible extension is to approximate the pattern of any shape by J pairs of time interval each with its corresponding p u ,v, j and w u , j ,thatis, Z greedy recursive partitioning, still employing the derivative of the likelihood function as the main measure for search. For brevity we drop the u ,v dependency and consider the maximum likelihood estimator, and search for the first change time point t 1 ,which we expect to be the most distinguished one, by maximizing g ( S ) that uses  X  p 1 as  X   X  for the whole span [0 ,  X  ). 8 We recursively perform this operation J times by fixing the previously determined change points. When to stop can be determined by a statisti-cal criterion such as AIC or MDL. This algorithm requires parameter optimization J times. Figure 13 is one of the preliminary results obtained for two distinct rect-linear patterns using five sequences in case of the blog network. MDL is used as the stopping criterion. The change pattern of p is almost perfectly detected with respect to both p j and t j ( J the model for some external factors that affect parameter changes reflecting the fact that each individual X  X  response to the external factors is different, that is, some people respond quickly and others slowly.
The change we considered is only in the time domain and we assumed that there is no spatially local change. We can consider a more general setting, namely spatio-temporal change in parameter values. We need a more elaborate algorithm to cope with this extension but the basic approach of using the first derivative of the likelihood function remains valid. We assumed that the network structure is stationary although we introduced the change in the parameter value. The model we used does not account for the structure change by itself. However, once the structure change is known, that is, addition/deletion of nodes and links at each time instance, it is straightforward to apply the proposed algorithm to these changes because the dynamics of a node is determined by the interaction with its neighbors, that is, the local structure of the network. In this article, we addressed the problem of detecting changes in behavior of informa-tion diffusion over a social network that is caused by changes in unknown external factors from a limited amount of observed diffusion sequences in a retrospective set-ting. The information diffusion process is described by a probabilistic model with some parameters that characterize the behavior, and the change in unknown external factors is assumed effectively reflected in changes in the parameter values in the model. We called the period where the parameter takes anomalous values as  X  X ot span X  and the rest as  X  X ormal span X , and the problem is reduced to detecting the hot span, that is, identifying the time window where the parameter value is anomalous and estimating the parameter values both in the hot and normal spans. We solved this problem by searching the time window that maximizes the likelihood of generating the observed information diffusion sequences. Our main contribution is that we devised a very effi-cient general iterative search algorithm that is robust and applicable to a wide class of probabilistic information diffusion models. The algorithm uses the first derivative of the likelihood with respect to the parameters, uses it in the window search (outer loop), and avoids parameter value optimization during the search (inner loop). It only needs to estimate the parameter value twice (at the first and the final steps of the search). This is in contrast to the naive learning algorithm which has to iteratively update the pattern boundaries (outer loop), each requiring the parameter value opti-mization to maximize the likelihood for the candidate window (inner loop), which is very inefficient and totally unacceptable. We showed that the algorithm works satis-factorily well for two instances of the probabilistic information diffusion model that have different characteristics: Asynchronous Independent Cascade (AsIC) model as a model of information push style and Value-weighted Voter (VwV) model as a model of information pull style. The AsIC is the model for general information diffusion with bi-nary states and the parameter to detect its change is diffusion probability. By contrast, the VwV is the model for opinion formation with multiple states and the parameter to detect its change is opinion value. The results tested on these two models using four real-world network structures and a single rect-linear change confirmed that the algorithm is robust enough and can efficiently identify the correct change pattern of the parameter values. Comparison with the naive method that finds the best combina-tion of change boundaries by an exhaustive search through a set of randomly selected boundary candidates showed that the proposed algorithm far outperforms the native method, both in terms of accuracy (about 3 times more accurate for the AsIC model and about 7 times more accurate for the VwV model in the fastest case for the naive method) and computation time (about 100 times faster for the AsIC model and about 13 times faster for the VwV model in the most accurate case for the naive method). The problem setting we assumed in this article is very simple, but we expect that the proposed method can be easily extended to solve more intricate problems. We showed one possible direction and the preliminary result obtained for two rect-linear shape hot spans was very promising. Our immediate future work is to evaluate our method using real-world information diffusion samples with hot spans, as well as to deal with spatio-temporal hot span detection problems using more appropriate stochastic models under a similar problem solving framework.
 We briefly describe the estimation algorithm of parameters p and r for the AsIC model from a sequence of observed data D (0 , T ) (see Saito et al. [2009b, 2010a] for more details).
 We employ an EM-like algorithm. Let  X  p and  X  r be the current estimates of p and r . Using Eqs. (1) and (2), we define  X   X  u ,v and  X   X  u ,v as follows. The update formulas of p and r are as follows. We briefly describe the estimation algorithm of parameter vector w for the VwV model from an observed data D (0 , T ) (see Kimura et al. [2010b] for more details). As men-tioned in Section 3.2, the opinion dynamics for the VwV model is invariant to positive scaling of w . Thus, we transform the parameter vector w by w = w ( z ), where Namely, our problem is to estimate the value of z that maximizes L ( w ( z ); D (0 , T )).
Then, for any i , j  X  X  1 ,..., K  X  1 } , we obtain where  X  i , j is the Kronecker X  X  delta, and find the value of z that maximizes L ( w ( z ); D (0 , T )). We employed a standard Newton method in our experiments.

