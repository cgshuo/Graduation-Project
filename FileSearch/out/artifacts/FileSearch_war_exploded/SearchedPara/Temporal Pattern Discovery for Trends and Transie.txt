 We introduce a novel pattern discovery methodology for event history data focusing explicitly on the detailed tem-poral relationship between pairs of events. At the core is a graphical statistical approach to summarising and visuali s-ing event history data, which contrasts the observed to the expected incidence of the event of interest before and after an index event. Thus, pattern discovery is not restricted to a specific time window of interest, but encompasses extended parts of the underlying event histories. In order to effec-tively screen large collections of event history data for in ter-esting temporal relationships, we introduce a new measure of temporal association. The proposed measure contrasts the observed-to-expected ratio in a time period of interest to that in a pre-defined control period. An important fea-ture of both the observed-to-expected graph itself and the measure of association, is a statistical shrinkage towards the null hypothesis of no association. This provides protectio n against spurious associations and is an extension of the sta -tistical shrinkage successfully applied to large-scale sc reen-ing for associations between events in cross-sectional dat a, such as large collections of adverse drug reaction reports. We demonstrate the usefulness of the proposed pattern dis-covery methodology by a set of examples from a collection of over two million patient records in the United Kingdom. The identified patterns include temporal relationships be-tween drug prescription and medical events suggestive of persistent or transient risks of adverse events, as well as t em-poral relationships between prescriptions of different dru gs. G.3 [ Probability and Statistics ]: Statistical computing; J.3 [ Life and medical sciences ]: Health Algorithms
Temporal patterns relating the occurrence of one event to that of another is of interest in a variety of knowledge discovery applications. Demographic data will contain tem -poral associations between changes in e.g. employment and marital status. Customer purchase data may indicate that the tendency of a customer to purchase a given product in-creases gradually over time subsequent to the purchase of a specific other product. In a pharmaceutical prescription database, the treatment with one drug may systematically be terminated immediately prior to the first prescription of a specific other drug. It is sometimes possible to project tem-poral pattern discovery problems onto cross-sectional one s by appropriate data extraction. However, this requires a quite clear view of the types of temporal relationship of in-terest. In contrast, our primary interest is in open-ended exploratory analysis with minimal restrictions on the type s of temporal association of interest. Explicit considerati on of the relative timing of different events allows for the identi fi-cation of both transient associations and long term trends. Furthermore, simultaneous consideration of separate time periods allows for a distinction between true temporal asso -ciation, and underlying tendencies of two events to occur in the same event histories.

Earlier work on pattern discovery in event history data has primarily focused on the detection of frequently recur-ring sequences of events [1, 5, 9]. This is different from the work presented here in that the former focuses on the order of events rather than their exact relative timing and trend, and in that it is based on the absolute frequency of recurrence rather than the unexpectedness. On the other the number of index events with a focus event in each given tim e period. hand, sequential pattern discovery involves more complex s e-quences of events than are considered in this paper. A stan-dard statistical approach to studying event history data th at does explicitly model and study the time to event is survival analysis. Survival analysis has recently been demonstrate d useful in knowledge discovery in customer relationship man -agement data [8]. However, in this context, survival analys is has primarily been used to investigate variations in the ove r-all time to an event in different subgroups, rather than the detailed temporal association between two different events .
Key challenges in large-scale pattern discovery of event history data in general, and of patient records in particula r, are the large numbers of event pairs and the wide variety of temporal patterns of potential interest, as well as the difficulty of distinguishing true temporal association from general differences between the event histories in which dif -ferent events tend to occur. The temporal pattern discovery framework proposed in this paper addresses these three is-sues simultaneously: statistical shrinkage reduces the ri sk of highlighting spurious associations based on limited amoun ts of data and allows for effective large-scale screening [4]; a statistical graphical approach to summarising and visual-ising event history data facilitates open ended explorator y analysis without prior restrictions in the types of tempora l patterns under consideration; and a crossover comparison o f two different time periods in the same event histories allows for the identification of true temporal associations.
Event history data as defined in the context of this paper consists of sets of events e i with associated times of occur-rence t i : e may carry information on a large number of covariates related to the observed event. On a higher level, &lt; e i pairs are grouped together in event histories h j related to for example the same individual.

A fundamental basis of our data analysis approach is the definition of sets of index events and focus events of interest. The occurrence of an index event defines the relative time frame in which we study the occurrence of the focus event. Our objective is to identify interesting temporal patterns relating the occurrence of focus events to the occurrence of an index event. Figure 1 displays an example of a set of event histories where the index event of interest is marked with squares and the focus event of interest is marked with circle s. The start and end points of the lines indicate the beginning and end of individual event histories. A simple first overvie w of the temporal association between the two events can be obtained from a histogram of the number of index events with at least one focus event in each time interval, as in Figure 2.
The histogram in Figure 2 provides a basic graphical sum-mary of the temporal association between the index event and the focus event. Its main limitation is that the absolute frequency of occurrence tends to be a poor measure of asso-ciation. In order to identify temporal patterns irrespecti ve of the marginal frequencies of the events involved, we have adopted a disproportionality approach where the observed number of events is contrasted to an expected number based on the overall frequency of the event of interest in a referen ce set. Specifically, denote by x a specific index event of inter-est and by y a specific focus event of interest. For a given time interval t denote by n t xy the number of index events x with a focus event y in time interval t . Disproportional-ity analysis is based on a comparison to the incidence of y relative to index events in a broader reference set. Assume such a reference set is available and denote by n t  X  y the num-ber of index events in the reference set with a focus event y in time interval t . Denote by n t x  X  the number of index events x with an event history that, at least partly, covers time interval t , and denote by n t  X  X  the total number of in-dex events in the reference set with an event history that, at least partly, covers time interval t . Our basic measure of association is an observed-to-expected ratio contrasti ng the observed number of index events x with a focus event y in t , n t xy , to an expected number based on the assumption that the proportion of index events x with a focus event y in t is the same as for other index events in the reference set (hence disproportionality analysis):
The logarithm of the observed-to-expected ratio is an intuitive measure of association in that positive valu es indicate that y occurs disproportionally often together with x , and negative values indicate that y occurs disproportion-ally rarely together with x .

With this implementation, repeated focus events within a time interval have no impact on the results. The advantage of this is that it reduces the influence of event histories wit h very large numbers of repeated events. The main limita-tion is that it makes it more difficult to identify temporal associations with very common events. The method can be modified to account for this, by redefining n t xy and n t that they count repeated focus events within each time in-terval, and by replacing the numbers of uncensored index events n t x  X  and n t  X  X  by the total amount of follow-up time in time interval t . However, all results presented in this paper are based on the former implementation.
An advantage of the observed-to-expected ratio is that large relative differences between the observed and expecte d numbers of events tend to correspond to associations of practical relevance. A critical challenge in large-scale p at-tern discovery is that the observed-to-expected ratio is ve ry volatile when the expected number is small, which makes it difficult to discern important patterns from noise. In dis-proportionality analysis of cross-sectional data, the use of shrunk observed-to-expected ratios has proven very effecti ve to distinguish patterns of interest from noise [2, 4, 10, 11] . Shrinkage is a general technique to regularize and reduce the volatility of a measure by trading a bias for decreased variance.

Specifically, we propose an adaptation to temporal pat-tern discovery of the Information Component ( IC ) measure of disproportionality [2, 10]. In slightly simplified form, the IC for the number of index events x with a focus event y in time interval t can be expressed as: The added 1/2 to the nominator and the denominator re-sults in shrinkage towards IC = 0. The impact is equivalent to that of 1/2 additional expected events, and an exactly matching increase in the observed number. In general, the strength and direction of shrinkage can be adjusted alterin g the constants added to the nominator and denominator.
From a frequentist perspective, the IC is a conservative version of the raw log observed-to-expected ratio: tending towards 0 for rare events and with better variance proper-ties. As n t xy and E t xy increase, the impact of the shrinkage diminishes. From a Bayesian perspective, the IC can be viewed as the logarithm of the posterior mean of an un-known rate of incidence  X  under the assumption that n t xy is P o (  X   X  E t xy )-distributed with log 2  X  = IC and a Gamma G (1 / 2 , 1 / 2) prior distribution for  X  . n t xy as defined in Sec-tion 2.1 actually follows a binomial distribution, but the Poisson distribution is an accurate approximation for rare events. The Poisson distribution also applies (without ap-proximation) under the modified definition of n t xy to in-clude repeated events within t in the same event history discussed in Section 2.1. Based on the Gamma G (1 / 2 , 1 / 2) prior distribution, the posterior distribution for  X  will also be Gamma (but with hyperparameters n t xy +1 / 2 and E t xy 1 / 2). Credibility interval limits for  X  can be found numeri-cally as solutions to the following equation, for appropria te posterior quantiles  X  q : Specifically, the logarithm of the solutions to (5) for q = 0 . 025 and q = 0 . 975, respectively, provide the upper and lower limits of a two-sided 95% credibility interval for the IC .
Figure 3 provides an illustration of a chronograph  X  our statistical graphical approach to summarising event histo ry data. The top graph displays IC values with 95% credibil-ity intervals at different time intervals relative to the ind ex the corresponding variation in the IC value. event of interest. The IC value for the occurrence of the fo-cus event in the exact same time period as the index event is marked with an asterisk. The IC graph allows for the identification of changes over time in the ratio of the ob-served to the expected numbers of events. The combined use of shrinkage and credibility intervals reduces the risk of highlighting spurious associations. The bottom graph dis-plays the observed (bar chart) and expected (line graph and asterisk) numbers of events. It gives a sense of the empirica l basis for the IC chronograph, and can highlight changes in the absolute difference between the observed and expected numbers of events.

While limited to a specific pair of events, the chronograph allows for open-ended pattern discovery with respect to the types of temporal patterns that can be identified. A large number of time intervals of potential interest are consid-ered simultaneously both before and after the index event. Through inspection of a chronograph, domain experts can quickly get a sense of the empirical basis for a potential as-sociation between two events: a consistently high IC value long before or after the index event indicates an excess inci -dence at this baseline; a temporary increase in the IC value immediately before the index event may indicate that the fo-cus event potentially triggers the index event; similarly, an increase in the IC value immediately after the index event may indicate that the index event potentially triggers the focus event. However, such temporal associations clearly d o not imply causality, as there are a number of possible expla-nations for why one event may tend to occur soon after the other.
In the typical pattern discovery application, the number of event pairs of potential interest is massive. Inspection of all possible chronographs is therefore not tractable. In order to facilitate pattern discovery in event history data, we have developed a general measure of temporal association. Its basis is the IC value as presented in Section 2.2. The IC value itself provides a basic measure of event association, as discussed in Section 2.3. Its main limitation in this contex t is that it does not account for temporal variation. For this purpose, we introduce a contrast between the IC values in two different time periods referred to as IC  X  . Denote by u the time period of interest, and by v a predefined control period against which u is to be contrasted. First consider the difference between the raw log obseved-to-expected ratios f or u and v , respectively: This expression can be rewritten as a single log observed-to -expected ratio: where Thus, (7) is a modified observed-to-expected ratio, where the expected number of index events with a focus event in u , is computed under the assumption that the observed-to-expected ratio in (3) is the same in u as in v .
 IC  X  is defined as: It is the shrunk difference between the log observed-to-expe cted ratios in periods u and v , respectively. Since IC  X  can be viewed as an IC value with a modified expected value, cred-ibility intervals can be computed based on (5).
 By appropriate selection of time periods u and v , various IC  X  measures can be defined for the purpose of screening event history data for a wide variety of classes of temporal patterns. An IC  X  measure contrasting a period u immedi-ately after the index event to a period v before the index event can identify focus events that are more likely to oc-cur close in time after an index event than in general in the same event histories. The contrast to a control period dis-tinguishes temporal associations from general tendencies of pairs of focus and index events to occur in the same event histories. As IC  X  is computed conditional on the observed-to-expected ratio in v , it is good practice to choose as long time period v as possible, in order to reduce variability in its observed-to-expected ratio.
Large collections of patient records are an extraordinar-ily useful source of information on the real world use of medicines. Patient records contain a multitude of time-stamped events that may serve as the basis for temporal pattern discovery including: prescriptions; laboratory t est results; hospital referrals and admissions; and notes of cl in-ical symptoms, signs, and diagnoses. Specifically, patient records are anticipated to provide an important complement to individual case safety reports in adverse drug reaction (ADR) surveillance. ADRs are a huge public health issue: a recent study showed that in the UK, ADRs account for 1 in 16 of all hospital admissions [12]. There is an increasing political and scientific pressure to use knowledge discover y methods to evaluate healthcare interventions and the impac t of disease in real life situations [13].

Earlier work on knowledge discovery in longitudinal health care data includes a method for identifying risk patterns in linked pharmaceutical, hospital and medical service data [ 7]. This method is based on an exploratory search for subgroups of patients with elevated risk of a specific adverse event at any time in the patient history. The temporal pattern dis-covery problem is thus projected onto a cross-sectional one . An alternative method has been proposed for active surveil-lance of healthcare claims data to highlight elevated adver se event rates associated with exposure to a specific drug [3]. This approach combines survival analysis with a sequential testing method to identify adverse events with shorter time to onset for patients exposed to the drug of interest than for patients in a predefined control group. This method focuses on the time to event for one event of interest rather than on the detailed temporal association between two events of interest. Neither of these methods appear to have been im-plemented for the purpose of large-scale pattern discovery involving large numbers of drugs and medical events, simul-taneously.
UK IMS Disease Analyzer is an observational data set of computerized medical records for over two million patients in the United Kingdom. Data is extracted directly from the computer systems in which general practitioners man-age their patients, so no extra effort is required on behalf of the treating physician to provide the information. The to-tal number of time-stamped events in the data set is large: for example there are more than 120 million individual pre-scriptions.
Active patient histories were extracted for all patients in the data set. As index events, we used first prescriptions of different drugs in at least 13 months. The restriction to first prescriptions reduces the risk that patients with a lar ge number of repeated prescriptions of a given drug have an undue influence on the results. As the reference set of index events we used the first prescriptions for all drugs in the data. The set of focus events included any medical events (diagnoses, clinical symptoms and signs, and administrati ve notes) that could be registered in a patient history, includ ing repeated occurrences of the same event. The analyses were based on the International Classification of Diseases (ICD-10). An IC  X  measure was implemented that contrasted the first month immediately after the index event to a six months long control period between 27 and 21 months ear-lier. This corresponds to a crossover design where patients prescribed a given drug are used as their own controls in the analysis. The rationale for the gap between the control period and the period of interest is to minimize the influence of possible causal associations between the disease and the treatment (a disease which is treated with the drug of inter-est will be overrepresented in a control period immediately prior to the prescription).
The UK IMS Disease Analyzer data was screened for im-portant temporal associations between prescriptions and m ed-ical events. Chronographs were produced and IC  X  values were computed for all possible combinations of a first pre-scription of a drug substance as the index event and the reg-istration of a medical event mapped to a specific ICD term as the focus event. A similar database wide screen was car-ried out for pairs of drugs. Overall, 3 million drug X  X edical event chronographs and 1.4 million drug X  X rug chronographs and IC  X  values were computed. The time required to com-plete these analyses were in the order of 8 hours each, on a server equipped with two AMD Opteron 280 2.4GHz dual core processors and 9 GB of RAM. Below, we present ex-amples of a range of temporal patterns discovered includ-ing suspected ADRs, potential beneficial effects of drugs, medical events related to the underlying disease, periodic patterns and trends, and drug co-prescription patterns. In order to illustrate that a wide variety of temporal patterns can be identified for one single drug, several chronographs relate to the drug nifedipine. Nifedipine was selected on th e basis that it has been on the market for a long time and that there is a considerable amount of data on nifedipine in the data set of interest.
Nifedipine is used for chest pain due to coronary artery spasms and hypertension. Common adverse reactions of nifedipine include flushing and peripheral swelling. Fig-ures 4 and 5 display the chronographs of flushing and lo-calized swelling, mass and lump, lower limb , relative to first prescriptions of nifedipine . Whereas the excessive registra-tion of flushing in nifedipine patients is transient and lim-ited to the first few months immediately after the first pre-Figure 4: Chronograph for the registration of flush-ing relative to first prescriptions of nifedipine . Figure 5: Chronograph for the registration of local-ized swelling, mass and lump, lower limb relative to first prescriptions of nifedipine . scription of nifedipine, the excessive registration of loc al-ized swelling persists for years after the first prescriptio n of nifedipine.
Chronographs and IC  X  values can be used also to detect unexpectedly rare medical events immediately after first pr e-scriptions. This may allow for the identification of potenti al beneficial effects of drugs. Sibutramine is a drug acting on the central nervous system used in the treatment of obe-sity. Figure 6 displays the chronograph of malaise and fa-tigue relative to first prescriptions of sibutramine , with a clear decrease in the registration of malaise and fatigue in the first two months after first prescriptions of sibutramine , suggestive of a positive mood altering effect. Interestingl y, Figure 6: Chronograph for the registration of malaise and fatigue relative to first prescriptions of sibutramine . the potential beneficial effect appears to be transient: afte r six months the patients who received sibutramine have re-gained the slightly elevated registration rate of malaise a nd fatigue. An alternative explanation is that the sibutramin e treatment may have been discontinued. Figure 7: Chronograph for the registration of acute pancreatitis relative to first prescriptions of omepra-zole .

IC  X  identifes elevated registration rates in the month af-ter the prescription relative to a control period two years earlier. Such elevated registration rates may correspond to suspected ADRs, but also to medical events associated with the underlying disease. Chronographs can help distin-guish between these and other types of temporal patterns by presenting information for a large number of time peri-ods, simultaneously. Figure 7 displays the chronograph of acute pancreatitis relative to first prescriptions of omepra-zole . Omeprazole is used in the treatment of ulcers, gastroe-sophageal reflux disease, and esophagitis, and acute pancre -atitis is an inflammation of the pancreas with sudden onset. There is an elevated registration rate of acute pancratitis in patients who receive omeprazole both long before and after the prescription, indicating that these patients are gener ally more prone to experience the event. At the same time, the elevation of the registration rate immediately after the dr ug prescription is even greater than at baseline, which consid -ered in isolation might be suggestive of a possible ADR. On the other hand, the registration rate is equally elevated im -mediately prior to drug prescription, which indicates that acute pancreatitis may not be due to the pharmacological action of omeprazole. Figure 8: Chronograph for the registration of a need for immunization against influenza relative to first prescriptions of nifedipine .

Figure 8 displays the chronograph of a need for immu-nization against influenza relative to first prescriptions of nifedipine . A temporal pattern of 12 month periodic vari-ation in the observed-to-expected ratio is clear. Further analysis of the data shows that the need for influenza vac-cination has a distinct peak of registration in October, and that the first prescription rate of nifedipine is elevated by about 20% in October through March relative to in April through September. Thus, whereas it does not necessarily represent an intrinsic association between nifedipine and in-fluenza vaccination, the temporal pattern has highlighted a seasonal variation in the rate of first prescriptions of nife dip-ine.
As an illustration of the usefulness of chronographs for the discovery of drug co-prescription patterns, we considered the temporal relationship between the prescription of diltiaz em and nifedipine. Diltiazem and nifedipine are in the same Figure 9: Chronograph for the prescription of nifedipine relative to first prescriptions of diltiazem . Figure 10: Chronograph for the prescription of dil-tiazem relative to first prescriptions of nifedipine . drug class, but differ in their pharmacological effects. Fig-ure 9 displays the chronograph of nifedipine prescriptions relative to first prescriptions of diltiazem. The tendency of patients who receive diltiazem to have received nifedip-ine prior to their first prescription of diltiazem is clear. A t the time of the diltiazem prescription, the rate of nifedipi ne prescriptions decreases radically and persistently, sugg esting that many patients switch from nifedipine to diltiazem. Fig -ure 10 displays the opposite chronograph of diltiazem pre-scriptions relative to first prescriptions of nifedipine. F rom this chronograph, we see that use of diltiazem not particu-larly common prior to first prescriptions of nifedipine, but that there is a clear trend of increasing use gradually after the first nifedipine prescription. Medical event Observed Expected IC  X  IC  X 025 Established ADR Flushing 50 7.02 2.75 2.32 Y Brain, Unspecified a 5 0.00 3.46 1.93 Localized Swelling, Mass And Lump, Lower Limb 168 62.43 1.42 1.19 Y Localized Oedema 81 29.82 1.43 1.10 Y Myalgia 19 5.08 1.81 1.08 Y Other Disorders Of Peripheral Nervous System 5 0.47 2.51 0.9 8 Y Mixed Hyperlipidaemia 12 2.93 1.86 0.93 Oedema, Unspecified 107 47.85 1.15 0.87 Y Tachycardia, Unspecified 29 10.61 1.41 0.84 Y
Burn Of Unspecified Degree Of Wrist And Hand 4 0.27 2.56 0.82 Table 1: Top 10 medical events for nifedipine ranked by IC
In order to illustrate the usefulness of IC  X  in screening patient records for suspected ADRs, Table 1 displays the 10 medical events with highest IC  X 025 values for nifedipine. The primary focus here is on suspected ADRs. Therefore, medical events with higher IC values in the month before or on the same day, than in the month after the prescrip-tion, have been excluded from the list. In our experience, this is a useful triage criterion to filter out medical events related to the underlying disease, such as acute pancreatit is for omeprazole in Section 4.3. Terms related to administra-tive details were also excluded from the list.

The rightmost column of Table 1 indicates that seven of the ten medical events in the list are among the known ADRs of nifedipine listed in regulatory information. This provides reassurance that the method can reliably detect el e-vated registration rates corresponding to established ADR s. The elevated registration rate of burn injuries subsequent to nifedipine prescription is intriguing, and can plausibl y be linked as secondary effects of established ADRs, such as dizziness and tremor. Hyperlipidaemia, an increase of lipi ds in the blood, is a condition associated with the underlying disease in patients treated with nifedipine. The tendency of hyperlipidaemia to be registered subsequent to the pre-scription of nifedipine may be due to the need to obtain the appropriate lab test results. The elevated registratio n rate of malignant neoplasms of brain subsequent to nifedip-ine prescription on the other hand is unlikely to represent an ADR, given the short time between the prescription of nifedipine and the cancer diagnosis.
The temporal pattern discovery framework proposed in this paper has three major strengths. It uses statistical shrinkage to reduce the risk of highlighting spurious assoc ia-tions, it facilitates open ended exploratory analysis with out prior restrictions in the types of temporal patterns under consideration, and it contrasts the association between th e events under consideration in two distinct time periods to identify true temporal association.

The incorporation of a graphical approach to summaris-ing and visualising event co-occurrence is fundamental. Th e importance of visual analytical methods in knowledge dis-covery applications is clear [6]. The greatest advantage of the chronograph over one-dimensional measures of temporal association is that it allows for the discovery of unexpecte d temporal patterns, and at the same time can highlight as-pects of the data that render a specific on-dimensional mea-sure of temporal association misleading. The focus on the observed-to-expected ratio rather than the absolute frequ ency of co-occurrence facilitates pattern discovery by elimina ting the impact of some common biases. For example, in patient records, prescriptions and medical events tend to cluster i n time, because one doctor X  X  visit is likely to lead to another . This yields increased rates of registration closer in time t o prescription, which may distort the analysis. By contrasti ng the observed registration rate for one specific drug to that of other drugs, this bias can be eliminated, to the extent that it affects all drugs equally. The chronograph consists of two graphs which provide complementary information. The graph of observed and expected numbers of events is easy to interpret and gives a clear sense of the empirical ba-sis for the chronograph. The IC graph, on the other hand, provides a better overview of the variation in the observed-to-expected ratio and may highlight patterns that are not otherwise obvious. Its strength is perhaps best illustrate d by the chronograph for the association between nifedipine and the need for influenza vaccination in Section 4.4, where the IC renders the periodic pattern more clearly visible.
Whereas the chronograph allows for detailed exploratory analysis of temporal associations between a specific pair of events, IC  X  is a measure of temporal association for screen-ing large collections of event histories. Its greatest stre ngth is the comparison of the observed-to-expected ratio in the period of interest to that in a control period, which isolate s temporal association from general tendencies of two events to occur in the same event histories. As is clear from the results in Section 4, IC  X  is capable of highlighting a variety of different temporal patterns. An elevated registration ra te of a medical event immediately after a prescription may for example be related either to the underlying disease or to the pharmacological action of the prescribed drug. How-ever, IC  X  provides very limited information on the type of temporal association discovered, and is thus primarily a to ol for directing attention to the most important chronographs . In addition, whereas the proposed IC  X  has proven useful in screening patient records for interesting temporal asso ci-ations, it is not necessarily capable of identifying all typ es of temporal patterns of potential interest. Other IC  X  im-plementations with different choices of control periods and periods of interest will provide an important complement. The comparison to a control period prior to the prescrip-tion means that the proposed IC  X  is not applicable to all types of medical events. For example, lethal events by def-inition cannot occur in this control period prior to a given prescription, and so the crossover design is not relevant fo r such events.

There may be an interest in exploring temporal associa-tions between events in a subset of all event histories. The computation of stratum specific chronographs is straight-forward by replacing n t xy , n t x  X  , n t  X  y , and n t sponding stratum specific values n t xyz , n t x  X  z , n t stratum z . Comparison between different stratum specific chronographs or IC  X  values is a useful approach to high-lighting covariates that influence the temporal associatio n between two events.

There are several advantages of patient records over indi-vidual case safety reports, including the information on th e previous medical history and risk factors of individual pa-tients, as well as the availability of data on patients who di d not experience a suspected ADR. At the same time, patient records do not provide a complete documentation of a pa-tient X  X  medical history. The basic requirement for a medica l event to be registered in the patient history is that there is doctor X  X  appointment in which the patient mentions an issue that the doctor decides to note in the patient record. As such, patient histories potentially suffer from an under-recording problem less severe, but not altogether different to that of individual case safety reports.

Important areas of future work include the evaluation of the proposed temporal pattern discovery framework for use in other event history data sets. An interesting possibilit y is the potential combination of chronograph-based pattern discovery with a method for sequential pattern discovery. More complex patterns of co-occurrence identified in sequen -tial pattern discovery could then be further evaluated in a chronograph to determine the exact temporal association between different sets of events.

The results presented in this paper are in agreement with current medical knowledge, with the exception of the points noted as new in the results. These require careful expert clinical evaluation by domain experts as in any other knowl-edge discovery application.
The authors are indebted to IMS Health for sharing the cost of a pilot project into knowledge discovery on the UK IMS Disease Analayzer data set. Erik Swahn, Malin St  X ahl, and Jonathan Edwards, former employees of the Uppsala Monitoring Centre, made important contributions to the early development of the methodology presented in this pa-per. [1] R. Agrawal and R. Srikant. Mining sequential [2] A. Bate, M. Lindquist, I. R. Edwards, S. Olsson, [3] J. S. Brown, M. Kulldorff, K. A. Chan, R. L. Davis, [4] W. DuMouchel. Bayesian data mining in large [5] J. Han, H. Cheng, D. Xin, and X. Yan. Frequent [6] D. A. Keim and J. Schneidewind. Introduction to the [7] J. Li, A. Fu, H. He, J. Chen, H. Jin, D. McAullay, [8] E. C. Malthouse. Mining for trigger events with [9] H. Mannila, H. Toivonen, and A. I. Verkamo.
 [10] G. N. Nor  X en, A. Bate, R. Orre, and I. R. Edwards. [11] G. N. Nor  X en, R. Sundberg, A. Bate, and I. R. [12] M. Pirmohamed, S. James, S. Meakin, C. Green, [13] M. Wadman. Experts call for active surveillance of
