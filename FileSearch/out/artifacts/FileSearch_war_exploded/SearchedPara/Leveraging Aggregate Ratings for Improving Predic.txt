 One of the key problems in recommender systems is accu-rate estimation of unknown ratings of individual items for individual users in terms of the previously specified ratings and other characteristics of items and users. In this thesis, we investigate a way of improving estimations of individ-ual ratings using externally provided properties of aggregate ratings for groups of items and users, such as an externally specified average rating of action movies provided by grad-uate students or externally specified standard deviation of ratings for comedy movies.
 Categories and Subject Descriptors: H.1.2 [Informa-tion Systems]: Models and Principles  X  User/Machine Sys-tems, Human information processing; H.3.3 [Information Systems]: Information Storage and Retrieval  X  Information Search and Retrieval, Information filtering General Terms: Algorithms, Design, Theory Keywords: Recommender systems, collaborative filtering, hierarchical models, predictive models, aggregate ratings.
Consider a Netflix recommender system [3] and assume that it is augmented with the aggregate ratings from the IMDB database [4], such as the one specifying that females in the age category of 18 to 29 gave an average rating of 6.9 (out of 10) to the movie  X  X adagascar. X  Can such ad-ditional information about the aggregated average rating, provided from the external sources, improve the quality of individual ratings prediction? More generally, a traditional recommender system providing individual ratings to individ-ual users can be supplemented with an externally provided aggregate information about the ratings, such as the known aggregate mean rating for X  X adagascar X  X rovided by females or the known standard deviation of ratings for X  X adagascar X  provided by males.

In our prior work [8] we studied the question of introduc-ing aggregate mean rating information into the special type of a statistical model reported in the marketing literature [2] and showed that these externally obtained aggregate ratings can be converted into additional constraints on the model of estimating individual ratings. We also theoretically demon-strated that these additional constraints provide for better estimation of unknown ratings and empirically confirmed these results on several real life rating datasets [9].
Although useful and having nice statistical properties, the model from [2] is not as popular in the field of recommender systems as the well-known collaborative filtering (CF) model. Therefore, we also studied how the aggregate ratings in-formation can be used in the CF systems constituting the  X  X read-and-butter X  of recommender systems. To this end, we showed that these external aggregate ratings can be used for providing better recommendations of individual items to individual users for a certain class of collaborative filtering systems. We also confirmed these theoretical results on real life rating datasets for a model-based CF and for the classi-cal item-based CF approaches [9].

As a future work, we plan to generalize our results to other types of recommender systems and provide general theoret-ical results about the influence of aggregate information on a certain general class of recommender system as will be de-scribed below. We also plan to incorporate different types of aggregate information into the system, e.g. we can in-troduce into the model not only the information about the average rating for an item, but also the information about the standard deviation of the ratings for an item, to improve predictions at the individual level.

Following the general concern in the recommender sys-tems, it is also important to find the scalable versions of the methods, which constitutes another important direction of the future research.
Although different types of aggregate information are avail-able, the most common form of the known external aggre-gate rating information is the average rating for a group of users and a group of items. In this Section, we introduce this type of aggregate information into 2 types of recommender systems: classical item-based CF and a hybrid linear regres-sion recommendation model. We also show that this infor-mation indeed improves performance of the models both in theory and on real life rating datasets.
First, we consider the following model-based collaborative filtering approach based on statistical theory [7] and show how to introduce the external aggregate mean rating infor-mation into the model.

Assume we have a set of N users and M items. Denote r ij an observed or unobserved rating by user i for item j . Moreover, for the specific item j , denote the vector r j ( r j . We assume that all vectors r j are i.i.d draws from a multivariate normal distribution with some unknown mean vector  X  and unknown covariance matrix  X : We also assume that for each j , we do not observe the vec-tor r j completely, but only observe some subset of ratings explicitly provided by some subset of users K ( j ).
We assume that we have some external source of infor-mation from which we also have a noisy observation of an aggregate mean rating r a = 1 N j . 1 In particular, assume that: where a is the observed noisy average rating,  X  is the unob-served true value of the average rating,  X  is a noise compo-nent,  X  is a known parameter of the noise.

In this model, the joint distribution of the vector of ob-served ratings r Kj , unobserved ratings r Uj and the aggre-gate rating r a is a multivariate normal: 0 @ There are several types of estimators that we can use. However if we want the least mean squared error unbiased estimator, we should use the conditional expected value of unknown ratings r Uj given the observed ratings r Kj are equal to y and the aggregate rating r a is equal to a as follows
We show that the extra knowledge of the aggregate rating r is equivalent to addition of the following correction term: where T Uj is a vector of individual correction terms for all unobserved ratings U = U ( j ) for item j .

That is, the predictor that takes into account the aggre-gate information is
Theorem 1. The use of aggregate information (2) im-proves predictive performance of model (3).
 Moreover, this correction term can be used as a heuristic technique to introduce aggregate information into the classi-cal heuristic item-based collaborative filtering [6] as follows
The assumption that the average rating is computed only over item j is for algebraic convenience only. The results can be easily generalized to the case of the average rating across any arbitrary segment of users and items. where  X  r ij is the classical item-based CF predictor [6], T the corresponding correction term calculated according to equation (4) and  X  r  X  ij is the resulting improved predictor that uses the aggregate information.

The detailed statement of the theorem and the proof is available in [9]. Figure 1: MSE decreases both for model-based CF (top) and item-based CF (bottom) on a Netflix-1 data as more aggregate information is introduced.
We run the experiments on several real life movie rat-ing datasets to demonstrate that the prediction quality in-deed improves with the number of additional aggregate con-straints introduced. The datasets reported in this paper are two random subsets of the Netflix Prize dataset [3], called Netflix-1 and Netflix-2 respectively. The quality of predic-tions is displayed in Figures 1 and 2. The figures plot on the x -axis the cumulative number of additional aggregate rat-ings introduced into the model. The 0-th tick corresponds to the plain basic recommendation model without any ag-gregate ratings. The 1st tick corresponds to just one aggre-gate rating of type (2) for the first item. The 2nd tick adds one more aggregate rating of type (2) for the second item, and so on. On the y -axis we plot the mean squared error (MSE) performance of the model with the specified number of aggregate constraints introduced based on 10-fold cross-validation where ratings are scaled to 0 to 1 interval.
The results presented in all these figures demonstrate that the aggregate information indeed improves prediction of in-dividual ratings, which confirms the theoretical result stated in Theorem 1. Figure 2: MSE decreases both for model-based CF (top) and item-based CF (bottom) on a Netflix-2 data as more aggregate information is introduced.
Collaborative filtering models are not the only models for which we introduce the aggregate information. As an-other domain for incorporating the aggregate information, we chose the hybrid recommender systems model. Generally, hybrid models tend to outperform collaborative and content-based recommendation methods in many cases [1]. In fact, it was shown in [2] that this particular type of the recom-mender system that we are going to use below outperformed the classical collaborative filtering model [2]. Second, these models are based on strong statistical theory of hierarchical linear models that have nice statistical properties [5] that can be analyzed theoretically and tested experimentally, as is done below. Figure 3: MSE drifts down for the hybrid regression recommender system on the two subsets of Netflix prize dataset as more aggregate information is in-troduced
More specifically, let r ij be a rating assigned to item j by user i , where r ij is a real-valued number. Moreover, ratings r ij are only known for some subset of all possible (user, item) pairs. Then the unknown rating estimation problem is defined as where observed values of the model are scalar ratings r ij assigned by user i for item j , vectors of user attributes z vectors of item attributes w j , vector x ij = z i  X  w j , where  X  is the Kronecker product. Note that x ij is a long vector containing all possible cross-products between individual el-ements of z i and w j .
Vector  X  in (5) represents unobserved (unknown), slope of the regression line. Vector  X  j represents weight coefficients specific to item j that determine idiosyncracy of item j , i.e., the unobserved heterogeneity of item j . Similarly, vector  X  i represents weight coefficients specific to user i that de-termine idiosyncracy of that user, i.e., the unobserved het-erogeneity of user i . In (6) we make assumptions about the moments of distributions for these heterogeneities and  X  and  X  are unobserved covariance matrices. The full details of this model as well as intuitive explanation of the form of how the model is derived is available in [2] and [9].
In addition to individual ratings, we also assume that we know from external sources the aggregate mean rating infor-mation. As in the case of CF, we assume that the aggregate ratings that we also observe from some external source are  X  X oisy, X  which can be formally represented as: where  X  is an unknown noise component,  X  is an unknown true value for the aggregate rating, a is the observed noisy value for the aggregate rating and  X  2  X  is a known parameter.
As is shown in [8] and [9], the additional aggregate infor-mation on mean rating can be incorporated into the model as an additional observation of the type (5) in the regression model.

Theorem 2. The use of aggregate information (7) im-proves predictive performance of the model (5).
 The detailed statement of the theorem and the proof is men-tioned in [8] and [9].

We run the experiments on several real life movie rating datasets. In Figure 3, we demonstrate the results only on the Netflix-1 and Netflix-2 datasets described above, however these results are consistent across all real life rating datasets that we used. The results show that the prediction quality indeed improves with the number of additional aggregate constraints introduced.
There are several important directions for a future work in this thesis. First, in our current research, we concentrated on introducing only the aggregate mean rating. However, in some situations we have also other moments of the aggre-gated distribution of ratings available, such as the aggregate standard deviation of ratings for a particular group of items etc. It is important to study how this information can also be used to improve predictions. Unfortunately, when we consider higher moments of the distribution of ratings, the constraints on parameters are no longer linear. For example, for known aggregate variance, we can introduce a constraint analogous to (2) as follows However, the right-hand side is no longer normally distributed as was the case for aggregate mean, but has a chi-square distribution. Therefore, in order to understand how obser-vation of aggregate variance of ratings v a helps to improve estimations of the individual ratings r ij , a more complicated approach must be used in order to analyze theoretically the joint distribution of individuals ratings r ij , aggregate mean rating r a and aggregate variance of v a .

Second, there is a strong similarity between the way the aggregate mean rating information is introduced in both the model-based collaborative filtering and the hybrid regres-sion model. In both cases, we have a recommender system model parameterized with some parameter  X  that we esti-mate from the training set. Once parameter  X  is estimated, both the model-based CF and the hybrid linear regression recommender system are some function f producing esti-mates based on history H of ratings, user attributes z i , item attributes w j and estimated model parameter  X   X  For this general setting, it is important to explore theoreti-cally the class of functions f (i.e. the classes of recommender systems) for that the aggregate information improves perfor-mance and prove theoretically the performance improvement under certain general conditions. For example, in both the model-based CF and the hybrid regression model, the addi-tional aggregate mean rating information acted as additional information about the model parameter  X  , thus improving the estimator  X   X  of the true parameter  X  from the data and thus theoretically improving the individual rating predic-tions  X  r ij .

Third, as the modern recommender systems are deployed on datasets with millions of users and items, it is important to study the scalable alternatives to the traditional theoret-ical methods of estimation. We did so in [9] for the hybrid model presented in Section 2.2, and we plan to extend it to other models. [1] G. Adomavicius and A. Tuzhilin. Toward the next [2] A. Ansari, S. Essegaier, and R. Kohli. Internet [3] J. Bennett and S. Lanning. The Netflix Prize. [4] IMDB. http://www.imdb.com. [5] S. W. Raudenbush and A. S. Bryk. Hierarchical Linear [6] B. Sarwar, G. Karypis, J. Konstan, and J. Reidl. [7] A. Schwaighofer, V. Tresp, and K. Yu. Learning [8] A. Umyarov and A. Tuzhilin. Leveraging aggregate [9] A. Umyarov and A. Tuzhilin. Leveraging aggregate
