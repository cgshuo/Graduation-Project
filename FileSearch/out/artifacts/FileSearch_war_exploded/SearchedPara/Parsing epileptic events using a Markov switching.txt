 A Conditional likelihoods 2 B Details of posterior computation 3 C Simulation experiment 11 D Model parameters used 12 E Seizure offset parsing 12 F Assessing the utility of the beta process 13 for probability of the observations from the first t time points and the state z ( i ) t = k , In the above, we omit the dependence on (following from Eq. (1)), these forward messages can be written compactly in vector notation as with where we let the states of the other channels i 0 and the event states is thus Z given channel states z t and event state Z t : t for L possible event states with elements Again, we omit e Y t above for notational simplicity.
 (following from Eq. (4)), these forward messages can be written compactly in vector notation as likelihood of the entire event given the channel states is thus We sample the active features, state sequences, and transition parameters for each channel i . B.1.1 Channel active features, f ( i ) set of unique features for channel i as U i  X  X  1 ,...,K } / S  X  i .
 Shared features The posterior for each shared feature k  X  X   X  i for channel i is given by  X  (  X  where proposal distribution of probability 0 . 5 /n i . This proposal is accepted with probability The likelihood terms again follow from Eq. (3).
 B.1.2 Channel state sequence, z ( i ) 1: T given z ( i ) t = k at time t , from Eq. (1)), so the backward message recursion can be written efficiently as The conditional probability of z ( i ) t is given by B.1.3 Channel transition parameters,  X  ( i ) given by this posterior via two auxiliary variables, covariance  X  0 , The product of these prior and likelihood terms is the joint distribution over a k and y 1: T , We take a brief tangent to prove a useful identity, Lemma B.1. Let the column vector x  X  R m and the symmetric matrix A  X  S m  X  m be defined as where y  X  R p , z  X  R q , B  X  S p  X  p , D  X  S q  X  q , C  X  R p  X  q , and m = p + q . Then Proof. a k 0 6 = k . Suppose that k + denotes the indices of the N channels where z decomposing the likelihood term into three parts, which we can further expand to yield 1 2
X Absorbing more terms unrelated to a k into the proportionality, we have which after some rearranging gives a yielding the quadratic term above, which allows us to solve the cross-term for  X  k : Thus, we have the form of the posterior for a k , where We first sample the event state sequence Z 1: T and then its state transition parameters  X  . B.3.1 Event state sequence, Z 1: T which we compactly represent in vector notation, from Eq. (4)).
 B.3.2 Event transition parameters,  X  simply involves transition counts n l  X  R L from event state l to all L states, The auxiliary variable  X  m ll 0 is defined by B.4.1 Event state covariances,  X  l channels, with a few exceptions to make the graphical model fully decomposable. For each event state l , we have which we then use to sample from the hyper-inverse Wishart posterior for that state, and Fox et al. (2009).
 B.5.1 Sticky HDP-HMM hyperparameters,  X  e ,  X  e ,  X  e ,  X  e we are working with a truncated approximation to the DP that involves L discrete atoms. to sample from the posterior, variables { r l } L l =1 and { s l } L l =1 are sampled as  X  where for w ls  X  Ber(  X  ) over s = 1 ,...,m ll , the posterior for w l  X  is  X  where, recalling again Eq. (37), the auxiliary variables are sampled as B.5.2 BP-AR-HMM hyperparameters,  X  c ,  X  c  X  where  X  =  X  2 c / X  2  X  acceptance ratio for  X  c is similar.
 B.5.3 BP hyperparameter,  X  c We place a Gamma( a,b ) prior on  X  c , which implies a gamma posterior of the form channel feature indicators using a  X  c = 10.
 true values. and 3.
 computational cost.
 models. Biometrika , 94(3):647 X 659, August 2007.
 models. The Annals of Statistics , 21(3):1272 X 1317, 1993.
 with beta processes. Advances in Neural Information Processing Systems , 22, 2009. speaker diarization. The Annals of Applied Statistics , 5(2A):1020 X 1056, 2011. Models of Sequential Data. In Advances in Neural Information Processing Systems , 2012. dencies via graphs. Bayesian Analysis , 2011. seizure by the HIW-spatial BP-AR-HMM model. models with two HIW-spatial models and two invovling beta process feature sampling (BP-).
