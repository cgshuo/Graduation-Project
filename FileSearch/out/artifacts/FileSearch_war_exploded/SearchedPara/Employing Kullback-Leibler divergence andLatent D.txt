 Warsaw University of Technology, ul. Koszykowa 75, Warsaw, Poland Tel.: +48 22 234 7618; Fax: +48 22 625 6278; E-mail: olszewsd@ee.pw.edu.pl 1. Introduction
The Kullback-Leibler divergence (KL-divergence) is a well-known quantity, widely used in probability while in the information theory context, it is the measure of relative entropy. KL-divergence has a wide range of applications, including multivariate data analysis (for example, pattern recognition and non-fra udulent account. We applied a simp le threshold-type classi fi cation algorithm with automatic threshold setting, which provides computational simplicity and ef fi ciency.

There is a number of fraud detection problems, including credit card frauds, money laundering, computer intrusion, and telecommunications frauds, to name but a few. Among all of them, the fraud detection in telecommunications appears to be one of the most dif fi cult, since there is a large amount of data, that needs to be analyzed, and, simultaneously, there is only a small number of fraudulent calls samples, which could be used as the learning data for the learning-based methods. Consequently, this problem essentially inhibits and limits an application of the learning-based techniques, like the neural-networks-based classi fi ers, for example.

Fraud detection systems, generally, fall into rule-based systems and user-pro fi les-based systems. The second of these approaches is regarded as more effective, and became more popular in real-world applications. 1.1. Related work
The general problem of fraud detection has been reviewed in [2,3], while the issue of fraud detection in telecommunications has been studied in [4 X 12]. The authors of [4] present an adaptive and automatic design of user pro fi ling methods for the purpose of fraud detection, using a series of data mining techniques. In paper [6], the Gaussian Mixture Model (GMM) is applied for user pro fi ling, and a high fraud recognition rate is reported. This approach was used in the experimental part of our paper as the comparison forourmethod. The paper[7]employs LatentDirichletAllocation (LDA)to build userpro fi le to modeling the sequential usage of a telephone service by a large group of individuals. The work [10] presents a novelrough fuzzy set based approach to detect fraud in 3G mobile telecommunication network. Hilas, which investigates the usefulness of applying different learning approaches to a problem of telecommunications fraud detection in [9], and constructs an expert system, which incorporates both the network administrator X  X  expert knowledge and knowledge derived from the application of data mining techniques on real-world data in [11]. Finally, the recent study [12] aimed at identifying customers X  subscription fraud by employing data mining techniques and adopting knowledge discovery process. To this end, a hybrid approach consisting of pre-processing, clustering, and classi fi cation phases was applied. 1.2. Our method
Our approach is based on the user pro fi ling technique utilizing LDA, and detecting fraudulent behavior on the basis of threshold-type classi fi cation with use of the KL-divergence. Consequently, our method requires the computation ofKL-divergence between two LDAs,which is an unsolved problem. Therefore, this paperfocusesalso on the issue of approximation of the KL-divergencebetweentwo LDAs, introduces four approximation methods, and chooses the most effective one. The fraudulent activity is indicated by automatic threshold computation is proposed.

Our technique strongly relies on the user pro fi ling with LDA probabilistic model. Employing LDA and our paper is that we detect whole fraudulent accounts, in contrast to [7], where single fraudulent threshold setting method. This kind of approach is al so useful in real-world fraud detection problems.
The LDA model is an example of a probabilistic mixture model, i.e., a model described with a combination (linear co mbination or product) of certain probab ility distributions. A well-known example of such model is the GMM, being a linear combination of Gaussian distributions. The estimation of LDA model X  X  parameters is described in [13], where the model was introduced, and is described, itself.
Recapitulating, this paper proposes:  X  three methods for approximating the KL-divergence between two LDAs,  X  a threshold-type classi fi cation algorithm for fraud detection in telecommunications,  X  a method for automatic threshold computation.

An advantage of our probabilistic approach is that it does not involve the learning process, this way, ef fi cient, and characterized by a low computational complexity.
 1.3. Remainder of this paper The rest of this paper is organized as follows: Section 2 presents the KL-divergence and its properties, Section 3 describes the GMM probabilistic model, and reports selected me thods for approximating the KL-divergence between two GMMs, Section 4 describes the LDA probabilistic model, and explains how we employ this model for user pro fi ling, Section 5 introduces the notion of Multinomial Mixture Model (MMM), and proposes three approximation m ethods of KL-divergence between two MMMs, Section 6 introduces four methods for approximating the KL-divergence between two LDAs, Section 7 proposes a threshold-type classi fi cation algorithm for fraud detection in telecommunications based on the KL-divergence and LDA, and introduces a method for automatic threshold computation, Section 8 reports the results of our experimental study, while Section 9 summarizes the whole paper, and conclude it with some fi nal remarks. 2. KL-divergence ( relative entropy ) De fi nition 1 [1,14]. The KL-divergence between two probability measures P and Q on a continuous measurable space  X  is de fi ned as: where S( P ) is the support of P on  X  , while p and q are the density functions of measures P and Q . Probability measures P and Q are absolutely continuous with respect to the dominating measure  X  (for the choice of the dominating measure  X  . According to the convention the value 0log for all real q , and the value p log marginals of product measures. If P = P
Furthermore, the KL-divergence has the following properties: 1. Self similarity: d ( P , P )=0 . 2. Self identi fi cation: d ( P , Q )=0 only if P = Q . 3. Positivity: d ( P , Q ) 0 for all P , Q .

KL-divergence was fi rst de fi ned in [1] as a generalization of the entropy notion of Shannon [15]. A standard reference on its properties is [16].

For a countable space  X  , measures P and Q on  X  are N -tuples ( p respectively, satisfying following conditions: p i 0 , q i 0 , i p i =1 ,and i q i =1 . In this case, the de fi nition is formulated as follows: De fi nition 2 [14]. The KL-divergence between two probability measures P and Q on a discrete measur-able space  X  is de fi ned as: 3. KL-divergence between two GMMs
The KL-divergence between two GMMs is frequently needed in the fi eld of pattern recognition, speci fi cally, speech and image recognition. Un fortunately, the KL-div ergence between two GMMs is not analytically tractable, nor does any ef fi cient computational algorithm exist. We consider this problem in our paper, since it was the basis for our method formulation. Our solution requires the computation of KL-divergence between two LDA models, consequently, such approximation needed to be introduced, since none curren tly exists in the literature. Our approximations were based on the existing approximations of KL-divergence between GMMs.

The study of the KL-divergence approximation between two GMMs can be found in [17,18]. Paper [17] presents two methods for the considered approximation, while in paper [18], two methods are introduced, and seven are discussed in total. The matching-based approximation proposed in [17], and the Gaussian approximation derived from [18], were an inspiration for our methods formulation.

GMMs of the following form are considered: covariance  X  a .
 notation abuse is common in probability and statistics. It is used, for example, in [7,13].
The matching-based method and the Gaussian method, both, approximate the KL-divergence by computing the divergences between the single components of the entire mixtures of Gaussians, i.e., between the single Gaussians. The matching-based method uses a matching function to select the Gaussians, between which the KL-divergence will be computed. On the other hand, the Gaussian approximation works in the simpler way. In one carnation, it substitute GMMs with the single Gaussians of the same mean and covariance as the whole GMM, while in the other, it uses the nearest pair of Gaussians, what leads to the following approximation of the KL-divergence:
We have applied similar approximation methods, i.e., our methods, introduced in Section 6, also use the single components of the whole mixtures.

We have used also the Monte-Carlo simulation method, discussed in [18]. The method works as follows:
Using n i.i.d. samples x i ,i =1 ,...,n , we obtain:
The method, itself, does not seem to be useful in practical applications, because of its signi fi cant computational effort, however, it is very helpful in the accuracy evaluation of other approximation methods (as the reference method). The accuracy of our two methods (nearest pair and mixed sum) was evaluated on the basis of the comparison between each method and the Monte-Carlo simulation. 4. Using LDA for user pro fi ling
The choice of this speci fi c probabilistic model of a telecommunication user was motivated with its for individuals within a group, and it explicitly captu res the assumption of the existence of a common set of behavioral patterns, which can be estimated on the basis of all observed users, along with their user-speci fi c proportion of participation [7]. The model, itself, was introduced by David Blei et al. in [13]. Pro fi ling the telecommunication users with LDA was fi rst proposed in [7]. Our paper uses the same model, however, we detect whole fraudulent accounts, instead of single fraudulent calls, like it is setting method.
 account. As the features, we use destination, start-time, and duration of a call. The accounts are coded as bag of feature-vectors.
 Procedure 1. An account can be generated from the LDA model using the following procedure: Step 1. Draw the number of iterations N  X  Poisson(  X  ) .

Step 2. Draw the parameter for account class distribution  X   X  Dir(  X  ) ,where  X  is the parameter of Step 3. For i =1:1: N :
The LDA model has two parameters: a vector  X  =[  X  variable K is the number of latent classes, and the variable V is the number of features in vector a . randomness may be ignored. For the convenience of further considerations, we will assume N  X  K .
The posterior distributions of the hidden variables  X  and z are estimated using variational approxima-tion. The model parameters  X  and  X  are estimated using variational EM algorithm (  X  and  X  maximize the (marginal) log likelihood of the data).

Given the parameters  X  and  X  , the joint distribution of a latent class mixture  X  , a vector of K latent classes z , and a vector of V features a is given by [13]: where p (  X  |  X  ) is the Dirichlet probability distribution of the variable  X  =[  X  multinomial probability distribution of the vector of K latent classes z , with vector-parameter  X  ,and parameter  X  z i ( z i -th row of the matrix  X  ). 5. KL-divergence between two MMMs Since the LDA model incorporates the multinomial mixtures, it will be necessary to evaluate the KL-divergence between them, in order to approximate the KL-divergence between LDAs.

We introduce the notion of Multinom ial Mixture Model (MMM) referring to the product of multinomial probability distributions. Consequently, a pair of MMMs can be described with the following formulae:
The problem of determining the KL-divergence between two MMMs is analytically infeasible, as it was with the GMMs. This happens due to the strong statistical dependence between the random variables of each MMM X  X  component, i.e ., each componenthas the same variable (explained in Section 6). Therefore, an approximation needs to be employed.

We propose two methods for approximating t he KL-divergence between two MMMs: 1. The nearest pair method. This approach is inspired with the nearest pair method for approximating 2. The mixed sum method. This method follows from De fi nitions 1 and 2 of the KL-divergence, and 6. KL-divergence between two LDAs
We propose three methods for approximating the KL-divergence between two LDAs. Two of these methods are based on the KL-divergence computation between the components of LDAs, i.e., between the Dirichlet distributions and between the MMMs. The difference between them consists in the use of different methods for approximation of the KL-d ivergence between MMMs. We discuss also the Monte-Carlo simulation method, which was used in our experiments as the reference method.
We consider a pair of LDAs of the following form:
Each LDA can be presented as the three-variable f unction, which, in turn, can be written as the product of three one-variable functions (Dirichlet distribution and two MMMs): where p MMM( z,  X  ) .

We will use this form of LDA for approximation of the KL-divergence. According to De fi nitions 1 and 2, the functions of product form are mathematically convenientfor computation of the KL-divergence the computations, is achieved only if the product components refer to the independent variables. Hence, in the case of the random variables, a statistical independence is expected. In the case of LDA model, Therefore, the KL-divergence between two LDA models is not analytically tractable,and its determination is possible only on the basis of the approximation. Consequently, our methods can be regarded as the example approaches to such approximation, which assume the statistical independence of the random variables  X  , z ,and a .

Assuming the random variables  X  , z ,and a are statistically independent, the KL-divergence between two LDAs can be written as follows: where d
On the basis of this transformation, two approximation methods are proposed. The difference between them derives from the different methods for approxi mating the KL-divergence between MMMs, applied in these three methods. 1. The nearest pair method. In this method, the KL-divergen ce between MMMs is approximated 2. The mixed sum method. In this case, the KL-divergence be tween MMMs is approxi mated according 3. The Monte-Carlo simulation method. In this method, the KL-divergence is approximated according
In the LDA model, the hidden random variable  X  , drawn from the Dirichlet distribution with the vector-distribution. Then, in each of N iterations, the hidden random variable z is being drawn from the fi rst multinomial distribution, and is used to select the row of the matrix  X  (the second parameter of LDA model), which, in turn, will be used as the vector-parameter of the second multinomial distribution (see Procedure 1). Therefore, in order to obtain the parameters of MMM z  X  Mul(  X  ) . 6.1. Computational complexity
In the case of the three methods, proposed in this paper, the estimated computational complexity essentially concerns the MMM Procedure 1.

The computational complexity of the nearest pair method depends on the optimization algorithm applied. Since we deal with the MMMs of small numbe r of components (in our expe riments, we analyze from one to ten-component MMMs), the choice of the optimization procedure was not crucial for our of MMMs X  components. The mixed sum method, in turn , summarizes the KL-divergences between all pairs of components of MMMs. Therefore, the estimat ed computational compl exity is the same for all three proposed methods, and, can be determined as O ( K + K 2 + KV )= O ( K (1 + K + V ))  X C where K is the number of latent classes in LDA model, V is the number of features, and C Dirichlet distribution component is irrelevant for the computational complexity of our methods.
On the other hand, in the case of the Monte-Carlo simulation method the Dirichlet componentde fi nitely matters, and, generally, the entire complexity signi fi cantly arises, since the process of a single KL-divergence computation is multiplicated in n iterations, where n should tend to in fi nity, in order to obtain the exact calculation. Practically, n is assumed as the large numbers, for example, 100K or 10K. The larger is that number, the more precise is the approximation. Consequently, the number of Monte-Carlo samples n strongly affects the computational complexity of this approach, which is O ( n ( K + K 2 + KV )) = O ( nK (1 + K + V )) = n C LDA .

It is clear that our methods provide n times lower estimated computational complexity of the KL-divergence approximation between two LDA models than the Monte-Carlo method. Therefore, taking under consideration the computational complexity, the proposed methods can be regarded as superior over the Monte-Carlo simulation technique. 7. Fraud detection in telecommunications model, described in Section 4. The detection is achieved by evaluating of the KL-divergence between when the previously de fi ned threshold is crossed. The reference account should represent the possibly most typical telecommunication user X  X  behavior. The threshold value can be computed either according to the method proposed in Subsection 7.1 or can be set arbitrary. In case of using the method introduced considered domain is necessary.
 LDA models of telecommunication accounts, among which, two are detected as fraudulent, i.e., points representing these accounts lay outside of the circle determined by the reference model (center) and the threshold (radius).
 In case of multidim ensional spaces, the threshold will be represented by a hypersphere. them also as fraudulent. On the other hand, for unknown cases or cases that are marginal or fuzzy, in additional information about them will be available. The reject option is an idea frequently used in classi fi cation problems. It is discussed, for example, in [20,21]. 7.1. Automatic threshold computation
This paper provides a method for automatic threshold computation on the basis of the vector of KL-divergences between the reference LDA model and each of the models of the entire set of all investigated telecommunication accounts. First, let the following auxiliary function be de fi ned: De fi nition 3. The distance from the reference LDA model function is de fi ned as follows: where lda We are searching for the steepest descent of the function  X  ( r ) .
 Lemma 1. The argument r only if: values (steepest descent).
 On the basis of Lemma 1, the threshold is determined as follows:
Our method aims to detect the border separating t he non-fra udulent and fraudulen t accounts. This see, it is monotonically decreasing.

However, the mentioned border between the non -fraudulent and fra udulent accounts cannot be deter-mined precisely with one value. It is rather an interval or a fuzzy border. Therefore, we employ an additional  X  X afety buffer X  value B , which creates the separation interval [ r the non-fra udulent accounts, and, cons equently, classi fying some of them as fraudulent.
Summarizing, the threshold value computed with our method corresponds to the steepest descent of fraudulent accounts is determined. 8. Experiments
In the fi rst part of our experiments, we have investigated the accuracy of the proposed methods for approximating the KL-divergence between two LDAs. In the second part, we have conducted a telecommunication fraud detection experiment. 8.1. KL-divergence approximation between two LDAs We have evaluated the accuracy of two methods, proposed in this paper, by comparing them with the Monte-Carlo method run for 1K samples. The parameters  X  and  X  of the simulated LDA models were generated randomly, i.e., the entries of the vector  X  were drawn from the uniform distribution, from the interval [0, 5], while the entries of the matrix  X  were drawn from the uniform distribution, from the
The experiments have been conducted for a various (from one to ten) number of latent classes. The accuracies of the nearest pair method and mixed sum method were assessed on the basis of their errors, i.e, the difference between the given method and the Monte-Carlo method (see Fig. 3). For the chosen to track the changes of KL-divergence approximated with our methods and with Monte-Carlo method (see Figs. 4 and 5).
The proposed methods provide a higher accuracy for a lower number of latent classes (one to six latent statistical independence of random variables  X  , z ,and a , is cumulating, and, consequently, arises.
However, despite the experiments with seven, eight, nine, and ten latent classes reported the inferior results, satisfactory is the observation (Figs 5(a) and 5(b)) that the tendency of changes of the KL-divergence was preserved. This means that when the KL-divergence computed with the Monte-Carlo method has risen, the approximation obtained with our methods has risen, as well.
 The higher approximation accuracy was reported for the mixed sum method.
 The mixed sum method, for a lower number of latent classes, provides the similar accuracy to the Monte-Carlo simulation method, hence, regarding the fact of a much lower computational complexity (see Subsection 6.1), we can assert that this method, proposed in our paper, outperforms the Monte-Carlo method, and provides an ef fi cient and effective way for approximating the KL-divergence between two LDAs. 8.2. Fraud detection in telecommunications results
In the experiments, the performance of the proposed telecommunications fraud detection method was assessed by a comparison with the GMM-based fraud detection method. The GMM-based method is discussed in [6], and employs the GMM probabilistic models for user pro fi ling. As the basis of the comparison, the Receiver Operating C haracteristics (ROC) curves were employed . This is a traditional way to investigate the performance of the fraud detection methods [22]. The ROC curves show the fraud The perfect point on the ROC graph is the (0, 1) point, which corresponds to detection of all frauds with simultaneous zero false alarms rate. Therefore, a perfect ROC is the curve containing this point. The closest to this result is the ROC curve, the better is the assessed detection method. On the other Area Under ROC (AUROC) metric was introduced. It simply measures the area under the curve, and a perfect value of AUROC is 1. Also an important value in assessment of the ROC curve is the highest fraud detection rate corresponding to zero false alarms rate (HDZF), and, the lowest false alarms rate corresponding to maximal (i.e., 1) fraud detection rate (LFMD). The ROC curves and the AUROC metric false alarm probability change, when the parameters of the detection algorithm are modi fi ed. Also, the AUROC value allows for an overall assessment of the entire detection approach with use of only one evaluation value. 8.2.1. Experimental setup
The experiments were carried out on fi ve different data sets. Each data set consisted of one thousand telecommunication accounts. Each account, in turn, was represented with one hundred call data records (CDRs). Each CDR contains an information about a speci fi c call, made by a speci fi c user. Hence, CDR is a vector of features of a speci fi c call, such as: destination, start-time, or duration.
For each account an LDA and GMM models, pro fi ling the telecommunication user, were built on the basis of a hundred CDRs. The models, built on the basis of such information, tend to possibly most properly re fl ect the behavior and habits of a telecommunication user. The building of the LDA model consists in estimation of the model parameters  X  and  X  . These parameters are estimated with the variational EM algorithm. The procedure is discussed in [13], and remains beyond the scope of this paper. Each GMM model consisted of three Gaussians, each corresponding to different feature in CDRs. Hence, the building of the GMM model consisted in estimation of the parameters  X  (mean) and  X  2 (variance) of each Gaussian com ponent. The prio r proba bilities  X  and  X  (see Section 3) were set to 1, because the relevance of all three features in CDRs was assumed to be equal, and, also, none prior information about the model was available.
 premium, toll-free, mobile), second is the start-time (8 X 17, 17 X 22, 22 X 8), and third is the duration ( the behavior and habits of a telecommunication user, and affect the pro fi le of the telecommunication account. The number of latent classes was set to three.

Each CDRs data set consisted of one thousand accounts, among which one hundred were intended to be fraudulent. This way, we wanted to test, when the assessed algorithms detect them, and, consequently, we wanted to obtain the ROC curves, which will serve for evaluating the performance of the investigated fraud detection methods . Additionally, for each data set, a r eference account was created. The models of nine hundred non-fra udulent accounts per data set wer e obtained by generating the CDRs with the following probabilities of the respective features values:
The models of the reference accounts (reference models) were built on the basis of the same CDR-probabilitie s as the non-fra udulent accounts X  models.

On the other hand, the fraudulent accounts were created by drawing CDRs with the following proba-bilities of the respective features values:
For each LDA and GMM model, we have computed the KL-divergence from the reference model, in order to detect the models of fraudulent accounts. We have approximated the KL-divergence between LDAs and GMMs with use of the mixed sum method, and the nearest pair method, respectively. The ROC curves were obtained by the sustainable decrease of the threshold value, and observing the number the maximal KL-divergence value for a speci fi c CDRs data set, what corresponds to the point (0, 0) on the ROC graph (none account is detected as fraudulent). The fi nal threshold value was set to 0, what corresponds to the point (1, 1) on the ROC graph (all accounts are detected as fraudulent). 8.2.2. Experimental results
The experimental results are presented in Figs 6 X 12. Figures 6(a) X 10(a) show the ROC curves for our method, while Figs 6(b) X 10(b) show the ROC curves for GMM-based fraud detection method. Each ROC curve is accompanied by the corresponding AUROC value. Figure 11 presents KL-divergence values between the reference model and a hundred of the models in the fi rst data set, for our method, and GMM-based method. The fraudulent accounts correspond to the last ten KL-divergence values. The threshold value for the classi fi cation algorithm computed with use of the automatic threshold setting line. Finally, Fig. 12 shows the AUROC values for each of fi ve examined data sets.

The results of our empirical study show that our method outperforms the GMM-based fraud detection method in case of all investigated CDRs data sets. It produces the higher AUROC values, and, also higher or equal HDZF and LFMD values. The highest detection performance was achieved in case of the third data set (see Fig. 8(a)). The AUROC value, obtained with our method, in this case was 0.9989, while the corresponding AUROC for the GMM-based method was 0.9333. This con fi rms effectiveness of the technique, introduced in this paper, in telecommunications fraud detection. 9. Summary and concluding remarks
The paper proposed a method for fraud detection in telecommunications, based on the user pro fi ling and classi fi cation. The telecommunication users were pro fi led with the LDA probabilistic model. LDA model, and a reference account X  X  LDA model. This paper provided also a method for automatic threshold computation.
Also, we introduced the Multinomial Mixture Model (MMM) de fi ned with the formula (9), and we proposed two methods for approximation of the KL-divergence between a pair of such models. This was necessary for the subsequent development of the algorithms for approximating the KL-divergence between two LDA models, since the LDA model incorporates two MMMs, as it is shown in the joint distribution (15). The ability of determining the KL-divergence between LDAs, in turn, was required for operating of our classi fi cation algorithm.

Consequently, in further part of our paper, two methods for approximation of the KL-divergence between two LDA models were introduced, and, in experimental study, compared to the Monte-Carlo simulation method. For a lower number of latent classes (one to six classes), our methods yield very similar output, what, considering much lower computational complexity than the Monte-Carlo method, can be recognized as a satisfactory result.

Finally, we demonstrated the results of telecommunications fraud detection. We assessed the per-formance of our method on the basis of the comparison with the GMM-based method. We used the ROC curves and its AUROC, HDZF, and LFMD values as the evaluation metrics for the investigated techniques. We carried out the experiments on fi ve data sets of CDRs. Our fraud detection method appeared superior over the GMM-based method in all of the studied cases, this way con fi rming the effectiveness of the proposed approach.
 Acknowledgments The author would like to thank the anonymous reviewers for their helpful comments and suggestions. References
