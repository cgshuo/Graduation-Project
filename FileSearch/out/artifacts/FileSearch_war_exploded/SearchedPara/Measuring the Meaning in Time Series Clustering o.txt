 We use a combination of proven methods from time series analysis and machine learning to explore the relationship between temporal and semantic similarity in web query logs; we discover that the combination of correlation and cycles is a good, but not perfect, sign of semantic relationship. Categories and Subject Descriptors: H.3.3 Information Storage and Retrieval Information Search and Retrieval [Clus-tering, Query Formulation]: H.3.5 Information Storage and Retrieval Online Information Services [Web-based services] General Terms: Experimentation, Measurements Keywords: time series, query clustering, semantic similar-ity, Web search, query log analysis
The time series of a query on a search engine, recording how many searches there were for that query per unit time, reflects changing patterns of collective behavior for the users. Queries which are semantically related may have similar pat-terns of popularity with users over time, so temporal charac-teristics might be used as features for query suggestion and query expansion, complementing content-and link-based approaches. Some of this information is also carried by static features, like within-session query co-occurrence but that lacks temporal context, such as an increase in searches on Christmas related terms during the holiday season, or a sudden peak related to a particular news event. Figure 1: Daily web search query volumes of  X  X hrist-
We know that temporal similarity is not always an ac-curate indicator of semantic similarity. For example, two  X  Work conducted while author was at Yahoo! Research. unrelated events may take place on the same day, but queries about those events could have no semantic relationship. These instances are reflected by a temporal pattern with a major peak at a particular point in time, but no cyclic regularity. Since these false positives may occur when events happen to be correlated in time, but only, literally, coincidentally, we could make the basic assumption that events which co-occur regularly, on a weekly, monthly, yearly, etc. basis are more likely to be semantically related, and test that assumption.
Jones et al [2] use within-session co-ocurence of terms to do query expansion. Recently a few groups have applied methods from time series analysis to query data: Vlachos et al [3] use Euclidean distance on leading Fourier coefficients for similarity matching. Chien and Immorlica [1] use cross-correlation to perform nearest neighbors search. While Vla-chos et al use structure-based similarity, periodicity specifi-cally, and Chien and Immorlica use shape-based similarity, we believe neither, on its own, is adequate to capture mean-ingful semantic relations. We use standard methods from time series analysis, cross-correlation and Fourier analysis; we check first cross-correlation (measuring shape-based sim-ilarity) over time and then filter by matching periodicity of queries (matching structure-based features).
Our data is from search engine query logs from years 2002 to 2005, with around 1 million queries per day. We use queries appearing in a daily list of the top 10,000 most pop-ular queries at least once in the time period. The query time series is represented as a sequence of daily counts of the number of users issuing that query. The data set con-tains 45,200 distinct queries with volumes on 1,096 days.
We perform two sets of clustering experiments. In the baseline experiment, we use only cross-correlation (Euclidean distance) as a similarity measure. In the second experi-ment, we initially check periodicity and partition the queries into 4 different periodic groups, then cluster based on cross-correlation to produce periodicity-constrained clusters. Since we restrict the search for periodicity to 4 frequencies: week, month, half a year, and one year, this partitions the original query time series into 5 subsets. Note that we treat any other periodicity which is not one of these 4 as aperiodic . Then complete link clustering is run within each subset; the summary of the results is shown in Table 1.

We manually labeled the clusters in several random sam-ples, with the number of semantically related queries, the type of their semantic relation, and the broad topical cate-gory those queries belong to. We define the semantic coher-ence coefficient of a group as S , the proportion of semanti-cally related queries in the group. If a group contains mul-tiple semantically related sub-groups, the largest sub-group is used to calculate the coherence coefficient.

We randomly sampled 100 clusters from the 4,751 clusters of the baseline experimental results. There were 63 clusters with S X  0 . 5, including 40  X  X erfect X  clusters with S =1 . To repeat the experiment with periodicity constraints, we randomly sampled 50 clusters, for each of the 5 periodic subsets, from our experimental results, with the exception of the monthly subset. There are only 31 clusters in that subset, all of which are used as samples. We pool all 5 sets and the results for semantic coherence are that for S 0 . 5, 79% of the clusters are coherent and  X  X erfect X  clusters account for 53.5%, compared to 40% for the baseline case. Table 2: Temporal and within-session information to-Table 3: Pairs of queries which were found to be highly
The proportion of topics for different periodicities and for the baseline case (looking at clusters with S = 1) are in Fig-ure 2. Entertainment is a large fraction in all cases. Com-pared with the baseline, the proportions of holiday-related and sports-related clusters increase for the yearly queries; for the weekly queries, the education-related clusters stand out.

We also found that when both within-session information and temporal information suggest that a pair of queries are similar, they are correct 94% of the time. However, within-session similarity can be found for only 29 of the 43 query-pairs correctly identified as similar by temporal correlation, a recall of 67%. In Table 3 we see the query pairs cor-rectly identified as similar by cross-correlation, which were not identified by session information.
Correlation among query log time series can help identify semantically coherent clusters, but also yields many  X  X alse Constraining all the queries in a cluster to have the same leading period helped, but still 27% of clusters were not coherent. Combining time-series and session similarity may lead to the best results for identifying semantically related queries.
