
Recom m e nder s ys t e m s bas ed on col l abor at i v e fi l t e r i ng pr edi c t u s e r p r e f e r e nces f o r p r oduct s or s e r v i ces by l e ar n-i ng pas t us e r -i t e m r el at i ons hi ps . A pr edom i nant appr oac h t o col l abor at i v e fi l t e r i ng i s nei ghbor hood bas ed ( X  -near e s t nei ghbor s  X  ), w h er e a us er -i t e m p r e f e r e nce r at i n g i s i nt er -pol at ed f r om r a t i ngs of s i m i l a r i t e m s and/ or us er s . W e en-hance t he nei ghbor hood-bas ed appr oac h l eadi ng t o s ub-s t ant i a l i m p r o vem ent o f p r e di ct i o n a ccur a cy , w i t hout a m e ani ngf ul i n cr eas e i n r unni ng t i m e . F i r s t , w e r e m o ve cer t a i n s o -cal l e d  X  gl obal ef f ect s  X  f r om t h e dat a t o m ak e t h e r at i ngs m o r e com par abl e , t h er eby i m p r o vi ng i n t e r pol a-t i o n a ccur a cy . S econd, w e s how how t o s i m u l t aneous l y de-r i ve i n t e r pol at i o n w ei ght s f or al l n ear e s t nei ghbor s , unl i k e pr e v i ous appr oac hes w her e eac h w e i ght i s com put ed s e pa-r a tely . B y g lo b a lly so lvin g a su ita b le o p timiza tio n p r o b lem, act i ons bet w een nei ghbor s l eadi ng t o i m pr o ved accur a cy . Ou r m eth o d is very f a s t i n p r a ctice , g e n e r a tin g a p r ed ictio n in about 0.2 m illis econds . I mpor t antly , i t does not r e quir e t r ai ni ng m any par am et er s o r a l e ngt hy pr epr o ces s i ng , m ak-s how how t o appl y t hes e m e t hods t o t h e p er cei vabl y m uc h s l ow er us er -or i ent e d appr oac h. T o t h i s end, w e s u g g e s t a no vel s c hem e f o r l ow di m e ns i onal em beddi ng of t h e u s e r s . W e e v al uat e t hes e m e t hods on t h e N et fli x dat as et , w her e t h e y fli x C i n em at c h r ecom m e nder s ys t e m .
R ecommender s ys tems analyze p atterns o f u s e r i nteres t i n i t e ms or product s t o pro v i d e p ers onal i zed recommen-d a tio n s o f item s th at will su it a u ser  X  s t aste [ 1 ] . I n cr eas-in g l y , th eir e x cellen t ab ility to ch ar acter ize a n d r eco m m e n d i t e ms w i t h i n huge col l ect i ons repres ent a comput eri zed al -ternati v e t o human recommendations . B ecaus e good per -s onal i zed recommendat i ons can add a not her d i m ens i on t o the u s e r e xperience, e-commerce l eaders lik e A mazon.com and online m o v ie rental compan y N etflix, ha v e made rec-ommender s ys t e ms a s al i e nt part of t h ei r w eb s i t e s .
B roadl y s peaki ng, recommender s ys t e ms us e e i t h er of tw o s tr ate g ies. Th e cont ent bas ed appr oac h profiles each us er or product , al l o w i ng programs t o a s s o ci at e u s e rs w i t h mat c hi ng product s . F or e x ampl e, a mo v i e profi l e mi ght de-s c ri be i t s genre, t h e p art i c i p at i n g act ors , i t s box of fi c e pop-ul ari t y , e t c . U s e r p rofi l es coul d i ncl ude demographi c i nfor -mat i o n o r a ns w e rs t o a s ui t a bl e ques t i onnai re. O f cours e , cont ent b as ed s t rat e gi es requi re gat h eri n g e xt ernal i nforma-t i o n t hat m i ght not be a v ai l a bl e o r eas y t o c ol l ect .
W e focus o n a n a lternati v e s trate g y , kno wn as Co l-labor ative F ilter i ng (C F ) [6 ], whi c h rel i e s onl y o n p as t us er beha vi or  X  e .g., t h ei r p re vi ous t rans act i ons or product rat i ngs  X  a nd does not requi re t h e c reat i o n o f e xpl i c i t pro-fi l es . C F a nal y zes rel a t i ons hi ps bet w een us ers a nd i n t e rde-pendenci e s a mong product s , i n o rder t o i d ent i fy n e w us er -item a s s o ciations . B es ides a v oiding the n eed for e xtens i v e dat a col l ect i o n a bout i t e ms or us ers , C F requi res n o domai n kno w l edge. In a ddi t i on, i t of fers t h e pot ent i a l t o unco v er pat t e rns t hat w oul d b e d i f fi c ul t o r i mpos s i bl e t o p rofi l e u s -i n g c ont ent b as ed t echni ques . Thi s has l ed t o man y papers (e.g., [8 ]), res earch projects ( e.g., [ 9]) a nd commercial s ys -tems (e.g., [11 ] ) b as ed on C F .

From a m ore a bs tract pers pecti v e, C F can be cas t a s m issin g v a lu e e stim atio n . Gi v e n a u s er -item m atr ix o f s c ores w i t h man y mi s s i ng v a l u es , our goal i s t o e s t i m at e t h e mi s s i ng v a l u es bas e d o n t he gi v e n ones . The obs erv e d us er -i t e m s cores m eas ure t he amount of i n t e res t bet w een res p ecti v e u s e rs and items . W e call t hes e us er -item s cores r at i ngs , a nd the y cons titute the i nput to our algorithm.
The m os t c ommon f orm of C F i s t he nei ghborhood-bas e d a pproach (al s o kno w n as  X  N eares t N ei ghbors  X  or kN N , for s hort ) . T he kN N met hods i d ent i f y p ai rs of i t e ms th at ten d to b e r a ted s im ilar l y o r lik e-m i n d e d u ser s with sim -i ngs for unobs erv e d u s e rs -i t e m p ai rs .

Three m aj or component s c haract eri z e t he kN N a p-proach: (1) dat a normal i zat i on, (2) n ei ghbor s e l ect i on, and (3) d et ermi nat i o n o f i nt erpol at i o n w ei ght s . O u r e xperi ence has s ho wn little dif f er ence among neighbor s e lection s trate-gi es (e.g., di s t ance-bas e d v s . correl a t i on-bas e d). H o w e v er , t h e t w o ot her c omponent s , namel y dat a normal i zat i o n a nd interpolation w eights , ha v e pro v e d v ital t o t he s u cces s o f t h e s cheme. A ccordi ngl y , w e re vi s i t t hes e t w o c omponent s and s ugges t no v e l m et hods t o s i gni fi cant l y i m pro v e t h e ac-curac y of kN N a pproaches w i t hout meani ngful l y af fect i n g runni ng t i m e. O u r t hree mai n cont ri b u t i ons are: 1. It i s cus t omary t o normal i z e t he dat a before act i v at i n g 2. P a s t kN N met hods rel a t e i t e ms (or u s e rs ) b y v ari ous 3. The k NN approach can capitalize o n t w o dif f erent An en co u r ag in g e v a lu atio n o f t h e r e su lts o n th e N etflix Prize u s e r -mo vie d atas et [3 ] i s p ro vided i n S ection 6 .
W e are g i v en rat i ngs about us ers a nd item s , a r r a n g e d in an m a tr ix . W e r es erv e for u s e rs , a n d f o r item s .

The o ri gi nal n ei ghborhood-bas e d a pproach, w hi ch w a s s h ared by vi rt ual l y al l earl i e r C F s ys t e ms , i s u s e r -ori e nt ed; s e e [8 ] for a good anal ys i s . In o rder t o es t i mat e t he unkno w n r a tin g , w e r e s o r t t o a s e t o f us er s th at ten d to r a te sim ilar ly to ( X  X ei ghbors  X  ), and t hat act ual l y rat e d i t e m (i.e., is kno wn for each ).

The p redicted v a lue o f is tak en as a weighted a v erage of t h e n ei ghbors  X  rat i ngs :
A n anal ogous al t e rnat i v e t o t he us er -ori ent e d a pproach i s t h e i t e m-ori e nt ed approach [11 , 15 ]. In t hos e met hods , t o es t i mat e t he unkno w n , w e i dent i fy a s e t o f n ei ghbori n g items th at o th e r u ser s ten d to r a te sim ilar ly to th e ir r a tin g o f . A ll item s in mus t ha v e been rat e d b y .
 Then, i n p arallel t o ( 1) , t he es timated v a lue o f is tak e n as a w ei ght ed a v erage o f t he rat i ngs of nei ghbori n g i t e ms :
Th e s im ilar ities X  X  e n o t ed b y or  X  X lay a central rol e here, a s t he y a re us ed bot h for s e l ect i n g t he nei ghbors and for w e i ght i n g t he abo v e a v e rages . C o mmon c hoi ces are th e P ear so n c o r r e latio n c o e f fi cien t a n d th e c lo sely r e lated cos i ne s i mi l a ri t y . M et hods al s o di f fer by ho w t he y normal -ize o r center d ata p rior to acti v at i n g i nt erpol at i o n r ul e ( 1) or (2) . F o r e xample, c orrecting f or us er -s pecific means can im p r o v e p r ed ictio n q u a lity . W e p r e sen t a m o r e c o m p r eh en -si v e tr eatm e n t o f d a ta n o r m a lizatio n i n S ectio n 3 . S ar w a r et al . [15 ] found t h at i t e m-ori e nt ed approaches del i v e r b et -ter q u a lity estim ates th an u s er -o r i en ted a p p r o ach es wh ile al-l o w i ng more ef fi c i e nt comput at i ons . T he great er ef fi c i e nc y occurs becaus e , t ypically , t he number o f items is s i gnifi-cant l y l o w e r t han t he number o f u s e rs , w hi ch al l o w s pre-co m p u tin g a ll item -item s im ilar ities f o r r e tr ie v a l a s n eed ed .
Neighborhood-bas e d m ethods became v ery popular be-caus e the y are i ntuiti v e and r el ati v ely s imple t o i mplement. In part i c ul ar , t he y d o not requi re t uni ng man y paramet e rs or an e x t e ns i v e t rai n i n g s t a ge. T he y a l s o p ro vi de a c onci s e en ab les p r e sen tin g t h e u s er a list o f s im ilar item s th at h e o r sh e h as p r e v io u s ly r a ted , as th e b asis f o r t h e estim ated r a t-i ng. Thi s w a y , t h e u s e r act ual l y unders t a nds t h e reas oni ng behi nd t h e recommendat i on, al l o w i ng hi m/ her t o b et t e r a s -sess its r e le v a n c e ( e.g . , d o w n g r ad e t h e estim ated r a tin g i f i t i s bas e d o n a n i t e m t hat h e o r s he no l onger l i k es ), or e v en encourage t he us er t o al t e r out dat e d rat i ngs .

H o w e v e r , s t andard nei ghborhood-bas e d met hods rai s e s o me concerns : 1 . Th e s im ilar ity f u n c tio n ( or ) , wh ich d ir ectly d e -2. P r e v ious neighborhood-bas e d methods do not account 3. B y defi n i t i on, t h e i nt erpol at i o n w ei ght s s um t o one, 4. N e i ghborhood met hods may not w o rk w e l l i f v a ri abi l -
In a r ecent w ork [ 2 ] , w e o v e rcame m os t o f t hes e s hort-co m i n g s , b u t th e r esu ltin g a lg o r ith m w as se v e r a l o r d er s of magni t ude s l o w er t h an pre v i ous nei ghborhood-met hod s , th er eb y lim itin g its p r actical ap p licab ility . I n t h i s w o r k , we addres s t he aforement i oned i s s u es of nei ghborhood bas e d approaches , w i t hout compromi s i ng runni ng t i me e f fi ci enc y .
A l t hough nei ghborhood and f act ori zat i o n b as ed C F are bot h p o w erful p redi ct i o n m et hods , t here are s e v eral reas ons to precede e ither technique w ith s i mple models that es ti-mate what we call  X  global e f f ects .  X  F irs t , t here may b e l ar ge u s er an d item e f f ects X  X .e., s y s tem a tic ten d e n c ies f o r so m e us ers t o g i v e h i gher rat i ngs t h an ot her u s e rs and for s o me items to recei v e higher r atings than others . T he bas i c k NN i n t e rpol at i o n met hod det a i l e d i n e quat i ons (1) -(2) requi res r a tin g s wh er e u ser a n d item e f f ects h a v e b een tak e n o u t in order t o, e.g., a v o i d predi c t i n g t oo hi gh for l o w -rat e d i t e ms t h at happen t o h a v e a l o t o f n ei ghbors w i t h hi gh a v erage rat i ngs , a nd vi ce v e rs a.

S econd, one may h a v e acces s t o i nformation a bout ei-t h er t h e i t e ms or us ers t hat can benefi t t h e m odel . A l t hough f actorization o f f ers t he potential t o d etect s u ch s t ructure t h rough es t i m at i o n o f l at ent v ari a bl es , d i r ect l y i n corporat -ing v ariables s u ch as mo vie g enre and u s e r d emographics may b e m ore e f fect i v e a nd does not requi re t rai ni ng a f act or -i zat i o n m odel . W h i l e s u ch cont ent b as ed anal ys i s i s be yond t h e s cope of t h i s paper , w e do cons i d er t w o t ypes o f eas i l y deri v e d v ari a bl es : t he number o f rat i ngs of an i t e m o r b y a us er and t he a v erage r ating o f a n item o r b y a us er . V ari-abl e s l i k e t hes e al l o w u s , for e xampl e , t o d i s t i ngui s h us ers w h o l i k e t he mos t commonl y rat ed mo vi es bes t from t hos e mo vie a nd us er ef fects ) .

Third, there m ay be character istics o f s p ecific r a tin g s , s u ch as t h e d at e o f t he rat i ng, t h at e xpl ai n s ome o f t he v a ri -at i o n i n s cores . F o r e xampl e , a part i c ul ar us er X  s rat i ngs may s l o w l y , o r s uddenl y , ri s e o v e r t i m e, abo v e and b e yond an y ch an g e e x p l ain e d b y t h e in h e r e n t q u a lity o f th e item s b e -in g r atin g . Sim ilar l y , r a tin g s f o r s o m e m o v ies m ay f a ll with tim e a f t er th eir i n itial r elease d ates, w h ile o t h e r s stan d t h e test o f tim e q u ite well. Neith er f acto r izatio n n o r k N N c o u l d be e xpect ed t o det ect pat t e rns l i k e t hes e .

Our s trate g y i s t o es timate one  X  X f fect X  at a time, in s e-quence ( i.e., t he main ef fect for items , t he main ef fect for us ers , a u s e r -time i nteraction, etc.). At each s t ep, w e u s e res i dual s from t he pre v i ous s t ep as t h e d ependent v a ri abl e for t he current s t ep. C ons equent l y , a ft er t h e fi rs t s t e p, t h e
F o r each of the e f f ects m entioned a bo v e , our goal i s t o es timate e ither one parameter f or each item o r one param-eter for each us er . F or the r es t o f t his s ubs ection, we de-s c ri be our met hods for e s t i m at i n g u s e r s peci fi c paramet e rs ; t h e m et hod for i t e ms i s perfect l y anal ogous .

W e denot e b y the e xplanatory v ariable o f i nteres t corres pondi ng t o us er an d item . F or us er main ef fects , th e  X  s are i dentically 1. F o r o ther global e f f ects , we cen-ter for each us er by s ubtracting t he mean of for t hat us er . I n each cas e, our model i s : W ith s u f fi cient r atings for u s e r , w e mi ght us e t he unbi as ed es timator: where each s u mmation i s o v er all items rated b y . H o w -e v er , f or s p ars e dat a , s ome v al ues o f may b e b as ed on v e r y f e w o b s er v a tio n s , r esu ltin g i n u n r eliab l e e stim ates.
T o a v oi d o v e rfi t t i ng, w e s h ri nk i ndi vi dual v al ues o f t o w a rds a common v al ue. S hri nkage can be mot i v a t e d from a B ayes i a n p ers p ect i v e. S uppos e t hat t he t rue are i nde-pendent random v a ri abl e s d ra w n from a normal d i s t r i b ut i on, for kno w n and , w h ile for kno w n . W e e stim ate by i t s pos t e ri or mean: a lin ear co m b in atio n o f t he empirical es timator and t he common m ean . T he paramet e r can be es timated from th e f o r m u la f o r t h e v a r i an ce of a w eighted mean, w hile can be es timated by the m ean of the  X  s (opt i onal l y w e i ght ed by ). Empi ri cal B a yes [4] s ugges t s t hat t he maxi mum l i k el i hood es t i m at e o f can be found as t h e s o-lu tio n to : I n p r actice, we u s ed a s lig h tly sim p ler e stim ato r f o r by a ssu m i n g and i s proport i onal t o , t o y ield : wh ere i s t h e number o f rat i ngs by us er and i s a c on-stan t. W e d e ter m in ed by cros s v al i d at i on.

W e illu strate th e i mp act o f estimatin g s u ccessi v e g l o b a l ef fects o n t he Netflix data [3 ]. The d atas et is bas ed o n m ore th an 1 0 0 m illio n r atin g s o f m o v i es p e r f o r m ed b y an o n y -mous N e t fl i x cus t omers a nd i s des c ri bed i n d et ai l s i n S ec-tio n 6 . H er e, we r e p o r t r esu lts o n th e Pr obe s e t , w h i c h i s a t es t s et containing about 1.4 m illion r atings compiled b y N e t fl i x . A ccurac y of predi c t i ons i s meas ured by t h ei r root mean s quared e rror (R M S E ).

T a bl e 1 s h o w s h o w t h e R MS E for t h e p robe s e t d ecl i n es with the i nclus i on of each s u cces s i v e global e f f ect. N ot s u r -pri s i ngl y , by f a r t he l a r g es t i mpro v e ment s i n R MS E a re as -s o ciated with the t w o s ets of main ef fects f or mo vies and f or us ers . The y reduce t he R M S E from 1 .1296 bas e d o n u s e of t h e m ean rat i n g i n t he t rai ni ng dat a , d o w n t o 0 .9841.
Of m o r e in ter e st ar e v ar io u s in ter actio n s . T h e fir st in ter -action t erm, Us er T i me(us e r) , allo ws each us er X  s rating t o change l i n earl y w i t h t h e s quare root of t h e number o f days s i nce t he us er X  s fi rs t rat i ng. Expl orat ory a nal y s i s i n-d i cated th at th is tr an sf o r m a tio n i m p r o v e d t h e fit r e lati v e to the untrans formed number o f d ays . T echnically , w e s et each sin c e t h e fir st r a tin g b y u se r till th e tim e r a ted item . Then, f or each fix ed us er , w e center a ll computed v a lues of , and calculate i n order t o p redi ct bas e d o n .
 Thi s i n t e ract i on, reduces t h e R MS E b y 0 .0032.

Sim ilar l y , User Ti m e ( m o v i e ) , allo ws each us er X  s rat-i n g t o c hange l i n earl y w i t h t h e s quare root of t h e number of days s i nce t he mo vi e X  s fi rs t rat i n g b y a n yone. S ome-Ef fect RM SE Impro v e ment Ov erall m ean 1.1296 NA Mo vie ef f ect 1.0527 .0769 Us er ef fect 0.9841 .0686 User T i me(us e r) 0.9809 .0032 User Ti m e ( m o v i e ) 0.9786 .0023 Mo vie Ti m e ( m o v i e ) 0.9767 .0019 Mo vie T i me(us e r) 0.9759 .0008 User Mo vi e a v e rage 0.9719 .0040 User Mo vi e s upport 0.9690 .0029 Mo vie Us er a v erage 0.9670 .0020 Mo vie U s er s upport 0.9657 .0013
T a b l e 1 . R M S E f or Ne tflix pr obe da ta a fte r a d ding a s e r ie s o f g loba l e ff e c t s t o t he mode l as much as t h e fi rs t . T w o a ddi t i onal t i m e i nt eract i ons con-cent rat e o n t he compl e ment ary mo v i e vi e w poi nt . T hat i s , for each mo vie, the y model h o w its ratings change with time. Once again, the time v ar i a bl es are e i t h er s quare root of days s i nce fi rs t r at i n g o f t he mo vi e, or s quare root of days s i nce fi rs t rat i n g b y t he us er .

The n e x t t w o ef fects i nteract us ers w ith mo vie c haracter -i s t i c s . W e meas ure t he popul ari t y of a mo v i e i n t w o d i f fer -ent w ays : (1) i t s a v erage rat i ng; and (2) i t s s upport , w h i c h is th e n u m b e r o f r atin g s asso ciated with th e m o v ie. T h e se ef fects  X  Us er Mo vi e a v e rage and U s e r Mo vi e s upport  X  meas ure h o w us ers c hange t h ei r rat i ngs bas e d o n t he pop-u l ar ity o f th e m o v ies. W e tr y t o e stim ate h er e h o w clo s ely a us e r f ol l o w s t he publ i c opi ni on, or perhaps t he oppos i t e , ho w c ont rari an i s t h e u s e r . The m os t e f fect i v e i nt eract i o n i s bet w een us ers a nd mo vi e a v e rage, i ndi cat i n g t hat u s e rs v a r i ed in ter m s o f h o w m u ch th e y ag r e e w ith th e c o n s en su s.
Finally , w e i nteract mo vies with us er characteris tics , re-gres s i ng the ratings of each mo vie o n t he mean or s upport of t h e u s e rs . A l t hough t h es e i nt eract i ons are more d i f fi c ul t to mo ti v a te, each co n t rib u tes a n a d d itio n a l m o d e st d ecrease o f th e R MSE. Ov er all, th e e ig h t in ter actio n s co m b in e t o r e-duce t he R M S E by 0.0184 t o 0.9657.
I n th is sectio n w e a ssu m e th at g lo b a l e f f ects h a v e a l-ready b een remo v e d, s o whene v er we refer t o a rating w e actually mean the r es idual r emaining after r emo v ing g lobal ef fect s from t he ori g i n al rat i ngs dat a . H o w e v er , our di s c us -sio n h e r e is co m p letely g e n e r a l, so th e f o llo win g m e th o d appl i e s w het h er gl obal e f fect s a re remo v e d o r not .
W e need t o es t i m at e t he unkno w n rat i n g b y u s e r of item , t h a t i s . A s w i t h al l n ei ghborhood-bas e d m et h-ods , our fi rs t s t ep i s nei ghbor s e l ect i on. In t h i s s ect i on, w e focus o n a n i t e m-ori e nt ed met hod. A mong al l i t e ms rat e d by , w e s elect the m o st sim ila r t o , , b y u s i n g a s im ilar ity f u n c tio n s u c h a s t h e co r r e latio n c o e f fi cien t, as des c ri bed l at er i n t h i s s ect i on. T ypi cal v a l u es of lie in th e range of 20 X 50; s e e S ect i o n 6 .

G i v e n a s e t o f n ei ghbors , w e n eed to compute in terp o la tio n w eig h ts th at will en ab le t h e b es t p redi ct i o n rul e o f t he form: F o r not at i onal c on v e ni ence as s u me t h at t h e nei ghbors i n
W e s eek a formal c omput at i o n o f t he i n t e rpol at i o n weig h t s, th at stem s d ir ectly f r o m t h e ir u s ag e w ith in p r ed ic-al l i nt erpol at i o n w ei ght s s i mul t a neous l y t o account for i n-t e rdependenci e s a mong t h e n ei ghbors . W e achi e v e t h es e g o a ls b y d e fin in g a su itab le o p tim izatio n p r o b lem .
T o s t art , w e cons i d er a hypot het i cal dens e cas e, w h ere all u s e rs b u t rat e d bot h and al l i t s nei ghbors i n . In that cas e, we could l earn t he interpolation w eights b y model i n g t he rel a t i ons hi ps bet w een i t e m and i t s nei ghbors t h rough a l eas t s quares p robl em: N o t i c e t hat t he onl y unkno w n s h ere a re t h e  X  s . T he op-t i m al s o l u t i o n t o t he l eas t s quares p robl em (5) i s found by d i f f er en tiatio n a s a so lu tio n o f a lin ear sy stem o f eq u a tio n s . Fr o m a s tatistics v ie wp o in t, it is e q u i v a len t to th e r esu lt o f a l i n ear re gres s i on (w i t hout i n t e rcept ) of on t he for Here, is a m a tr ix d e fin ed as: S i mi l a rl y t he v ect or i s gi v e n by: F o r a sp ar se r a tin g s m a tr ix th er e a r e lik ely to b e v er y f e w us ers w ho rat e d and a l l i t s nei ghbors . A ccord-i ngl y , i t w oul d b e unw i s e t o b as e and as gi v e n i n (7)  X  ( 8 ) o n l y o n u ser s with co m p lete d a ta. E v e n i f t h e r e ar e enough us ers w i t h compl e t e dat a for t o be nons i ngul ar , t h at es t i mat e w oul d i gnore a l a r g e p roport i o n o f t he i n for -mat i o n a bout pai r w i s e rel a t i ons hi ps among rat i ngs by t h e sam e u s er . H o w e v er , w e can still estim ate and , u p t o t h e s a me cons t a nt , b y a v e ragi ng o v er t h e g i v en pai rw i s e s up-port , l eadi n g t o t he fol l o w i ng reformul at i on: wh ere i s t h e s et of us ers w ho rat e d bot h and .
 This is s till not enough to o v ercome the s pars enes s i s s u e. The e lements o f or may d i f fer b y o rders o f m agni -t ude i n t e rms o f t he number o f u s e rs i n cl uded i n t he a v erage. A s di s c us s e d i n t he pre v i ous s ect i on, a v erages bas e d o n rel -at i v el y l o w s upport ( s m al l v al ues o f ) can general l y be i mpro v e d b y s hri nkage t o w a rds a common mean. T hus , w e comput e a bas e l i n e v al ue t h at i s defi n ed by t a ki ng t h e a v erage o f a ll pos s i ble v a l u es . Let us denot e t hi s b as e-l i n e v al ue by ; its precis e computatio n i s d es cribed in the ne xt s ubs ect i on. A ccordi ngl y , w e defi n e t he corres pondi ng The p arameter cont rol s t h e e xt ent o f t he s h ri nkage. A t yp-ical v a lu e o n t h e Netflix d a ta wh en w o r k in g w ith r e sid u a ls of ful l gl obal e f fect s i s .
 Our b es t e s timate f or and are and , r es pecti v ely .
 Therefore, w e modi fy (6) s o t hat t he i n t e rpol at i o n w ei ght s are d efined a s t he s o lution o f t he linear s y s t em: Th e r esu ltin g i n t er p o l atio n w eig h t s a r e u s ed with in ( 4 ) i n order t o p redi ct . W hen w orki ng w i t h res i dual s of gl obal ef fect s , t h e y s houl d b e a dded b ack t o t h e p redi ct ed , w h i c h c ompl et es t h e c omput at i on.

Thi s met hod addres s e s a l l four concerns rai s ed i n S ec-tio n 2 .1 . F ir st, i n t er p o l atio n w eig h t s a r e d e r i v e d d ir ectly from t he rat i ngs , not bas e d o n a n y s i mi l a ri t y meas ure. S ec-ond, the i nterpolation w eight s f ormula e xplicitly accounts for r el at i ons hi ps among t h e n ei ghbors . Thi r d, t h e s um of t h e w ei ght s i s not cons t rai ned t o e qual one. If a n i t e m (or us er) h as onl y w eak nei ghbors , t h e e s t i m at ed w e i ght s m ay all b e v er y s m a ll. F o u r th , t h e m e th o d au to m a tically ad ju sts for v ariations among items in their m eans o r v ariances .

Ef fi c i e nt comput at i o n o f a n i t e m-i t e m n ei ghborhood-bas e d m ethod requires p recomputing certain v a lues as s o -ciated with each item-item p air f or rapid r etrie v al.

First, we n eed a q u i ck access t o a ll item-item s imilarities, th e v a lu es. T h e se sim ilar ities a r e r e q u ir e d f o r id en tif y -in g th e neighbors t hat c ons titute . H ere, we us u-ally tak e as the P ears o n correlation coef fi cient b etween and calcu lated o n t h e ir co m m o n r ater s. I t is im p o r tan t to sh r i n k bas e d o n t heir s upport, e.g., m ultiplying t he co r r e latio n b y : for s ome s mal l .
 S econd, w e precomput e a l l pos s i bl e e nt ri es of and . T o this end, for each tw o items and , w e c omput e: Then, t he aforementioned b as eline v alue , w hi ch i s us ed i n (11) -(12) , i s t ak en as t h e a v e rage ent ry o f t he precom-put ed m a tr ix . I n f act, w e r ecommend us ing t w o di f ferent b as el i n e v al ues , one by a v eragi n g t he non-di agonal en tr ies o f and a not her one by a v eragi n g t he general l y -l a r g er di agonal e nt ri es . F i n al l y , w e d eri v e a ful l ma-tr ix from by (11) , us i ng t he a ppropri a t e v a l ue of . H e re, t he non-di agonal a v e rage i s us ed w h en deri vi ng t h e non-di agonal e nt ri es of , w hereas t h e d i a gonal a v e rage i s us ed w h en deri vi ng t h e d i a gonal e nt ri es of .

B ecaus e of s y mmetry , it is s u f fi cient t o s tore the v alues of and onl y f or . W e a l l o cat ed one byt e for each indi vidual v alue, s o t he o v e rall s p ace required f or item s is e x actly byt es . F or e x ampl e, for t he N e t -fl i x d at as et w h i c h c ont ai ns 17770 mo vi es , o v e ral l memory requirements a re 300MB , eas ily fitting w ithin core mem-ory . A m ore c omprehens i v e s y s t em that includes d ata o n 100,000 items w ould require about 10GB o f s pace, which can fi t w i t h i n core memory of current 64bi t s erv e rs . F or u e s i s s till p r actical, a s e v i d e n t b y th e A m azo n item -item recommender s ys tem, which acces s e s s tored s imilarity in-f o r m atio n f o r se v e r a l m illio n catalo g item s [ 1 1 ] . P r e p r o -cessin g tim e is q u a d r atic in an d lin ear in th e n u m b e r o f rat i ngs . T he t i me r equi red f or comput i n g a l l  X  X  a n d  X  X  o n th e N etflix d ata ( wh ich c o n t ain s 1 0 0 m illio n r atin g s ) w as about 15 mi nut es on a P ent i u m 4 P C . N ot i c e t hat p repro-ces s i ng can be eas ily parallelized.

P recomput i n g a l l pos s i bl e e nt ri es of mat ri x sa ve s t h e ot herw i s e l engt hy t i m e n eeded t o cons t ruct e nt ri es on t h e fl y . A ft er qui ckl y ret ri e vi ng t h e rel e v ant e nt ri es of , w e can comput e t he i n t e rpol at i o n w ei ght s b y s ol vi ng a s y s t em of equat i ons . F or t ypi cal v a l u es of (between 20 and 50), t hi s t i me i s c omparabl e t o t he t i me n eeded for c om-put i ng t he neares t n ei ghbors , w h i c h i s c ommon t o a l l nei ghborhood-bas e d a pproaches . H ence, w h i l e our met hod r e lies o n a m u ch m o r e d e tailed c o m p u t atio n o f t h e in ter p o -l a t i o n w ei ght s c ompared t o p re vi ous met hods , i t does not s i gni fi cant l y i n creas e runni ng t i m e; s e e S ect i o n 6 .
The i nt erpol at i o n w ei ght s can be comput ed by s o l v i n g (13) us i n g s t a ndard l i n ear equat i ons s o l v ers . H o w e v e r , we e xperience a m odes t increas e i n p rediction accurac y wh en i s cons t rai ned t o b e nonne gat i v e . T hi s requi res a
No nNeg a t i v eQ ua dra t icO p t ( ) % M in imize s. t.
Figur e 1 . M inimizing a qua dr a t ic func tion with non-ne ga tiv i ty c ons tr a i nts q u a d r atic p r o g r am , wh i ch can b e so lv ed b y callin g  X  No n -Ne g a ti v e Qu ad r a ticOp t( , ) X , a s s ho w n i n F i gure 1 . T he funct i o n i s b as ed on t h e p ri nci p l e s o f t he G radi e nt P roj ec-t i o n m et hod; s ee, e.g., [12 ].
A u s e r -ori e nt ed approach can be i m pl ement e d b y s w i t c h-i n g t he rol e s o f u s e rs and i t e ms t h roughout t h e d eri v a-t i o n o f t he pre v i ous s ect i on. H o w e v e r , as w i t h pre v i ous nei ghborhood-bas e d a pproaches , a n i t e m-ori e nt ed approach enables a much f a s t er implem en tatio n b y p r eco m p u tin g a n d sto r in g i n m ain m em o r y a f u ll item -item m atr i x c o n t ain -in g a ll and v alues for f uture r etrie v al. T ypically , the l ar ger number o f u s e rs complicates s u ch a p recomputa-tion i n t erms of both time a nd s p ace, and out-of-core s tor -age i s requi red. Moreo v e r , our e xperi ence w i t h t h e N et fl i x data, under v arious s e ttings , s ho wed t hat a n item-oriented approach cons is tently deli v e red m ore accurate predictions t h an a u s e r -ori e nt ed one.

Nonetheles s , us er -oriented a pproaches identify d if ferent ki nds of rel a t i ons t h at i t e m-ori e nt ed approaches may f ai l t o recognize, and t hus can be us eful on certain occas ions . F or e x ampl e, s uppos e t hat w e w ant t o p redi ct , b ut none of th e item s r a ted b y u ser is r eally sim ilar t o . I n t his cas e, an item -o r ien t ed ap p r o ach will f ace o b v i o u s d i f fi cu lties. Ho w-e v er , w hen e mpl o yi ng a u s e r -ori e nt ed pers pect i v e, w e may fin d a se t o f u se r s sim ila r t o , w h o r a t e d . T he rat i ngs of b y th ese u ser s w o u l d a llo w u s t o i m p r o v e p r ed ictio n o f .
A not her c ommon cas e i s w hen a us er has b arely p ro-vi ded a n y rat i ngs t o t h e s ys t e m, b u t w e h a v e a ri ch hi s t ory o f pas t t rans act i ons by hi m X  e.g., h i s purchas e h i s t o ry , v i e w e d p a g e s h isto r y , s ear ch ed item s an d o th er k i n d s o f im p licit in -format i on. B y empl o y i n g a us er -ori ent e d met hod on t h e i m-p licit in f o r m atio n , we can r e late u s er t o ot her u s e rs w h o di d p ro vi de rat i ngs for i t e m , t hereby deri v e . F in ally , we can impro v e prediciton accura c y by mixing the r es ults of t h e i t e m-ori e nt ed approach w i t h t hos e o f t he us er -ori ent e d one. I n t his s ection, we pres ent a w ay t o ef fi ciently capital-ize o n t h e ad d itio n a l i n f o r m a tio n cap tu r e d w ith in u s er -u ser rel a t i ons hi ps .

W h en appl yi ng our met hod i n a u s e r -ori e nt ed man-n e r , th e m ajo r co m p u t atio n a l b o ttlen eck is th e c r eatio n o f Here, t he typically huge number o f u s e r -us er s i milarities complicates their s torage an d p recomput at i on. Moreo v e r , becaus e we e xpect man y more us ers t han items , s canning all u s ers that rated for pi c ki ng t he m o st sim ila r t o becomes a rather lengthy proces s . Hence, it is crucial t o meas ure t he s i milarity between us ers v ery e f fi ciently .
W e s i gni fi cant l y l o w e r t he comput at i onal e f fort o f m ea-su r i n g u s er -u ser s im ilar ities b y e m b ed d i n g all u ser s in a lo w d imens i onal E uclidean s p ace. T o this end, we vie w each us er as a point within the s pace of mo vies . A com-m o n w ay f o r r ed u c in g d im en sio n a lity is b y u s in g P r i n c i-pal C omponent A n al ys i s (P C A ), w h i c h i s o ft en carri ed out through the c los e ly related S ingular V a lue D ecompos ition (SVD). R ecall t hat t he -di mens i onal u s e r poi nt s a re ar -r a n g e d w ith in th e m a tr ix . C ons equent l y , S V D computes the b es t r ank-approxi mat i o n , w hi ch i s de-fi n ed as t h e p roduct o f t w o rank-m a tr ices and tr ix is an o p tim al -di mens i onal e mbeddi ng of t h e u s e rs .
A ppl yi ng an S V D -bas e d t echni que t o C F rai s es uni que d i f fi cu lties d u e to th e s p a r s ity issu e. Th e c o n v e n tio n a l S VD co m p u t atio n r eq u i r e s t h a t a ll en tr ies o f are kno w n . In f act , t he goal o f S V D i s not properl y d efi ned w hen s ome e n-tr ies o f are mi s s i ng. P re v i ous w o rks h a v e a dapt ed mat ri x f act ori zat i ons t echni ques t o h andl e m i s s i ng dat a i n a v ari e t y of w a ys [2 , 5 , 7 , 1 3 , 14 ]. F o r our s p eci al needs , w e s ugges t t h e fol l o w i ng approach.

Let u s s ymbol i z e t he s e t o f pai r s f or w h i c h i s kno w n by . T he goal o f S VD, when res t ricted to the k n o wn r a tin g s , i s t o m in im ize: Here, is th e -t h r o w of , w hi ch corres ponds t o us er . L ik e w ise, is th e -t h r o w of , w hi ch corres ponds t o item . A cr itical issu e i s t o a v o id o v er fittin g f o r item s an d u s er s w ith r e lati v e ly sp ar se d a ta. T o t h i s e n d we r e g u l ar ize the m odel b y p enalizing t he norm o f each and ( X  X i dge re gres s i on X ). That is , w e r eplace (14) with: A t ypi cal choi ce of for t he N e t fl i x dat a i s 0.3. T o mi ni mi ze ( 1 5 ) , we e m p lo y a n a lter n atin g l east s q u a r e s s tr ate g y . Th at is , w e alternate b etween fixing and , t hereby obt ai ni ng a s eries o f ef fi ciently s o lv able leas t s quares p roblems . T o furt her a v o i d o v e rfi t t i ng, we res t ri ct al l e nt ri es of and to be nonne gat i v e by us i ng a nonne gat i v e l eas t s quar es so lve r [ 1 0] . I n e sse n c e , and form a re gul ari zed nonne gat i v e m a tr ix f acto r izatio n f o r th e p ar tially o b s er v e d m atr i x . W h en recomputing , w e a ddres s each us er as f o llo ws.
 R ecall t hat i s t h e number o f r at i ngs by . W e u s e t h e item s r a ted b y , a nd l e t t he v ect or cont ai n t he gi v e n r at i ngs by ordered a s i n . T he ne w v al ue for i s gi v e n b y s ol vi ng a nonne gat i v e l eas t -s quares p robl em: Here, is an di agonal m at ri x, w h ere a l l di agonal en tr ies a r e . T he comput at i o n o f i s anal ogous .

F i nal l y , f ol l o w i ng a f e w t e ns of i t e rat i ons of recomput i n g and , w e c o n v e r g e a t a n -di mens i onal e mbeddi ng of th e u ser s -. W e u s e . O f c ours e , t he l o w d i men-s i onal e mbeddi ng of t h e u s e rs i s performed onl y once, at t h e preproces s i ng s t age. Since t hen, whene v er we need to find nei ghbori n g u s e rs , w e d o s o i n t hei r l o w d i mens i onal rep-res e nt at i on. Thi s s i gni fi cant l y al l e vi at es t h e c omput at i onal co m p le x ity o f th e u ser -b a sed c o m p u t atio n s an d f acilitates their u s e in real life, lar g e d atas ets , s u ch as the Netflix d ata. F u rt her p erformance gai n s can be achie v e d b y o r g anizing th e -d imen sio n a l u ser p o i n t s with in a s p ace-p a rtitio n i n g data s t ructure ( s u ch as a d-tree), w hich allo ws v ery ef fi-cient r etrie v al of the n eares t points ( mos t s i milar u s e rs ).
A f t e r i dent i f yi ng t h e m o st sim ila r u se r s , , w e cont i nue w i t h t h e u s u al comput at i o n o f i nt erpol at i o n w e i ght s . U n l i k e t he mo vi e-ori e nt ed cas e, t h e s heer number of us ers p re v e nt s u s from p recomput i n g t hei r i nner p rod-uct s . H o w e v er , a t t hi s s t a ge w e need t o deal w i t h onl y u s er s, wh ich i s n o t a m ajo r b o ttlen eck in th e p r o cess, esp e -ci al l y w h en cons i d eri n g t hat i ndi vi dual u s e rs are t ypi cal l y as s o ciated with f a r f e w er ratings compared to indi vidual i t e ms . W e p ro vi de e xperi ment al res u l t s i n S ubs ect i o n 6 .3.
O u r c urrent model a s s u mes t hat rel at i ons hi ps among u s er s a r e fix ed acr o s s a ll item s . Ho we v er , i n r eality , a u s er m a y b e v e r y p r e d i c t i v e o f u s e r for cert a i n ki nds of i t e ms , b u t f ar less p r ed icti v e f o r o th er item s . W h e n p r e d i ctin g , w e w oul d l i k e t o d eri v e u s e r -us er i n t e rpol at i o n w ei ght s t hat refl ect ho w t he nei ghbori n g u s e rs rel a t e t o with r e sp ect to th e g i v en item  X  . T hus , w hen l earni ng t h e i nt erpol at i o n w e i ght s , w e gi v e a h i gher w ei ght t o i t e ms s i mi l a r t o , w h i c h may s erv e as a b et t e r p roxy for t he s ought us er rel a t i ons . T o this end, we introduce item-item s imilarities ( ) i nt o t he us er v e rs i o n o f (5) , w hi ch becomes : Sim ilar ly , th e u ser -v e r s io n o f m atr ix and v ector of (7) -(8) , becomes : , item -item r elatio n s h ip s in to th e u ser -u s er m o d e l. Po ssib le choices for ar e t h e ab so lu te v a lu e o f t h e Pear so n c o r r e la-t i o n c oef fi ci ent , or an i n v e rs e o f t he s quared e rror . A s us ual with item -item m ag n itu d e s, all  X  s can be precomputed and s t o red, s o i n t roduci n g t hem i nt o t he us er -us e r model barel y af fect s r unni ng t i m e w hi l e benefi t i n g p redi ct i o n ac-curac y . N at ural l y , t hi s i s p art o f our def a ul t s et t i ng.
A p arallel i dea can be us ed for i nte g rating u s e r -a w arenes s i nt o t he i t e m-ori e nt ed model . H o w e v e r , i t re-qui res t he i t e m-i t e m i nner p roduct s t o be comput ed s p eci f-ically for each query in order t o r eflect the r ele v ant u s er sim ilar ities. Th is p r e v en ts th e p r eco m p u t atio n a n d sto r ag e of all item-item i nner p roducts . B ecaus e items are t ypically as s o ci at ed w i t h l a r g e numbers of rat i ngs , a n onl i n e c ompu-t a t i o n o f t hei r i nner p roduct s i s v e ry e xpens i v e a nd i mprac-tical for l ar ge datas e ts . H ence, currently , w e a re not adding u s er -a w a r e n e ss in to th e item -o r ien ted m o d e ls.
W e e v al uat e d our al gori t h ms on t h e N et fl i x d at a o f m ore th an 1 0 0 m illio n m o v ie r a tin g s [ 3 ] . W e ar e n o t a w ar e o f a n y publicly a v ailable C F d atas et that is clos e t o t he s c ope and q u a lity o f th is d a taset.

T o maintain compatibility w ith res u lts publis hed b y o th-ers , w e adopt ed s o me s t andards t hat w ere s et by N e t fl i x , a s f o llo ws. F ir st, q u a lity o f th e r esu lts is m easu r ed b y th eir root mean s quared e rror (R M S E ), a m eas ure t hat put s m ore emphas i s o n l ar ge errors compared with the a lternati v e o f m ean ab so lu te er r o r . I n ad d itio n , we r e p o r t r esu lts o n tw o test sets co m p iled b y N etflix , o n e is k n o wn as t he P r obe se t and t he ot her i s kno w n as th e Qu i z s et . T h e s e t w o t e s t s e t s w e re cons t r uct e d s i mi l a rl y , w i t h bot h c ont ai ni ng about 1 . 4 m illio n o f t h e mo st recen t m o v ie ratin g s (b y d ate) p e r -formed by t h e u s e rs . T he t r ue rat i ngs of t h e P robe s e t a re pro v i d ed. H o w e v er , w e d o not kno w t he t r ue rat i ngs for the Q uiz s et, w hich are h eld b y N etflix b eing the s ubject of th e N etflix P r i ze co n t est. Netflix p r o v id es RMSE v a lu es to co m p etito r s th at su b m it th eir p r e d i ctio n s f o r t h e Qu iz set. Th e b en ch m a r k is Netflix  X  s p r o p r ietar y CF sy stem , C in e-mat c h, w h i c h achi e v e d a R M S E of 0.9514 on t h i s Q u i z s e t . The t w o t e s t s e t s cont ai n m an y m ore rat i ngs by us ers t hat d o not rate much and a re harder to predict. In a w ay , t he y r ep-res e nt real requi rement s from a C F s y s t em, w hi ch needs t o predi c t n e w rat i ngs from o l d er ones , and t o e qual l y addres s al l u s e rs , not onl y t he hea v y rat ers .

T a bl e 2 compares our i t e m-ori e nt ed met hod t o a k N N met hod t h at t a k e s i nt erpol at i o n w ei ght s a s P ears o n c orre-latio n c o e f fi cien ts ( s h r u n k to im p r o v e r e su lts) , wh ich r ep -res e nt t h e c ommon a pproach t o t h e p robl em. B ot h met h-ods us e t he s a me i t e m n ei ghborhoods . R eport e d r es ul t s are R MS E v al ues c omput ed on t h e P robe s e t . W e appl y t h e m et hods aft e r v aryi ng s t ages of preproces s i ng t h e d at a. F i rs t , w e appl i e d t he met hods t o t h e ra w dat a , w here s c ores were not normalized at all. Then, w e r emo v ed the fi rs t t w o ef fects : the u s er ef f ect and t he item ef f ect, w hich is s i milar t o doubl e-cent e ri ng. W h en no nei ghborhood-i n t e rpo l at i o n i s performed, s uch a normal i zat i o n a l one del i v e rs a R MS E of 0.9841, as s h o w n i n t he s econd col u mn of t h e t abl e . A m o r e su b s tan tial n o r m a lizatio n i s ach ie v e d b y acco u n tin g for a l l t h e g l obal e f f ect s , as des c ri bed i n S ect i o n 3 . G l obal ef fect s o n t hei r o w n l o w er t h e P robe R M S E t o 0.9657, be-fore appl yi ng an y n ei ghborhood i n t e rpol at i on.

Finally , our method can be combined with a f actoriza-t i o n a pproach, w hi ch model s t h e rat i ngs mat ri x t h rough a lo w r ank f actorization [ 2 , 5 , 7, 13 , 1 4 ] . I n a w a y , f actoriza-t i o n c ompl ement s t h e more l ocal i zed nei ghborhood-bas e d met hods by pro v i d i n g a hi gher l e v el pers pect i v e t o t he rat -i ngs dat a . N ot i c e t hat unl i k e t he pre v i ous l y ment i oned nor -mal i zat i ons , f act ori zat i o n requi res a n e xt ens i v e t rai ni ng i n order t o l earn t he f actors . Our i mplementation d eli v ered a R M S E of 0.9167 on t h e P robe s e t , before cons i d eri n g a n y nei ghborhood i n format i on. A k N N met hod can be us ed t o im p r o v e f acto r izatio n r esu lts, b y a p p ly in g it to th e r esid u -als r emaining after s ubtractin g t he es timates generated b y f act ori zat i on. Ef fect i v el y , error i s s moot hed b y c ons i d eri n g proaches tend to mis s .

The r emaining columns o f T ab le 2 c o n tain r esu lts u s in g t h e t w o met hods for d et ermi ni ng i n t e rpol at i o n w ei ght s . W e pro v i d e res ul t s repres ent i n g t he s p ect rum o f v i a bl e c hoi ces for n ei ghborhood s i ze  X  . F or each v a lue o f , t h e s a m e nei ghborhoods are u s e d f or t h e t w o met hods ; t he onl y d i f -ference l i e s i n t he det e rmi n at i o n o f i nt erpol at i o n w ei ght s . The mai n fi ndi ngs are a s fol l o w s .

The c orrel a t i o n b as ed met hod requi red a bout 200 s ec-onds t o proces s t he w hol e P robe s e t r e g ardl es s o f t he v a l u e of . O ur met hod, w i t h , i n c r eased th e tim e s lig h tly t o about 235 s econds for t he w hol e P robe s e t , w h ere t he added time r epres e nts t he ef fort needed to s o lv e t he leas t s quares p roblem for each query . N ot s u rpris i ngly , in-creas ing furt her rai s e d runni ng t i m es t o around 355 s ec-onds ( ) o r 470 s econds ( ) , d u e to th e g r o w-ing e f f ort n eeded to s o lv e t he lar g er leas t s quares p roblems . Ev en s o , t he s l o w er mode of our met hod ( ) p r o -ces s e d a s i ngle r ating query in les s than 0.4 m illis econd.
Wh en co m p u tin g p r e d i ctio n s f o r t h e Qu iz set, th e t est s et hel d by N e t fl i x, w e s ubs ume t he P r obe s e t i nt o our t r ai ni ng dat a . T hi s m ak es Q u i z res u l t s bet t e r t han t he P robe res u l t s . A ccordi ngl y , our i t e m-ori e nt ed met hod produced a R MS E of 0.9086 (4.5% i mpro v e ment o v e r N et fl i x s ys t e m) for t he qui z s et w h en appl i e d t o r es i dual s of gl obal e f f ect s . W h en appl i e d t o res i dual s of f act ori zat i o n t he R M S E dropped t o 0.8982 (5.6% i mpro v e ment o v e r N et fl i x s ys t e m), a t t he cos t of requi ri ng t h e t rai n i n g o f a f act ori zat i o n m odel .
Thes e r es ults are c omparabl e t o r ecently reported r es ults for t he N e t fl i x dat a by met hods t h at requi re an e x t e ns i v e t rai ni ng phas e [2 , 1 3 ]. M oreo v e r , w h en mi x e d w i t h ot her met hods , res ul t s can be s ubs t a nt i a l l y i mpro v e d. F o r e x-ampl e, an al t e rnat i v e m et hod t o i n t roduci n g n ei ghborhood-a w arenes s i nto f actorization-bas ed r es ults w as d es cribed in [2 ]. W h ile the accurac y of the t w o methods is s i milar , the y di f fer cons i d erabl y i n t h ei r n at ure, and t hus produce d i f fer -ent rat i ngs . T hus , t he y can be mi x e d e f fect i v el y t o p roduce a m ore accurate s o lution. Thei r m ixtures achie v e s o lutions w i t h R M S E s a round 0.8900 (6.45% i mpro v e ment o v e r N et -fl i x s ys t e m), w hi ch w oul d c urrent l y rank hi gh on t h e N et -flix P rize Leaderboard 1 , e v e n b ef o r e m ix in g w ith th e u ser -ori e nt ed approach t o w h i c h w e n o w t u rn.

W e e v al uat e d t he us er -ori ent e d a pproach on t h e Q ui z s e t . In cont ras t t o t h e i t e m-ori e nt ed met hod, w h i c h re-qui res a round 30 X 50 nei ghbors t o maxi mi z e p redi ct i o n ac-curac y , t he us er -ori ent e d a pproach benefi t s from a l a r g er number o f n eighbors . Our d ef ault s e tting u s e s 100 neigh-b o r s. Th is p r o b a b l y r eflects t h e r eality th at th e d ata c o n -t a i n s man y more u s e rs t h an mo vi es , b ut i ndi vi dual u s e rs pro v i d e a rel a t i v e l y s mal l a mount of i n format i on. The l o w di mens i onal e mbeddi ng of t h e u s e rs w a s e s s e nt i a l f or deal -in g w ith th e N etflix d ata, b y allo win g p r ed ictio n o f a sin -gle r ating i n a round 40 millis econds . Though this is much slo w er th an th e m o v ie-o r i en ted c o m p u t atio n , it is still co n -s i derabl y f as t e r t han t he common ful l -di mens i onal c ompu-tation, which r equires a bout 400 millis econds per p redic-t i on. Moreo v e r , as hi nt ed i n S ubs ect i o n 5 .1, a more ef fi -cien t u tilizatio n o f t h e lo w d im en sio n a l e m b ed d i n g w o u l d in v o lv e a sp ace-p a rtitio n i n g d a ta stru ctu r e i n o rd er to fu rth e r s p eed up t h e n ei ghborhood ret ri e v a l . C o mput at i o n o f t he 10-di mes n i s onal e mbeddi ng i t s el f r equi red a bout 40 mi n-ut es .

W h i l e a l o w di mens i onal e mbeddi ng of us ers a l l o w e d a 10X s p eedup compared w i t h t h e ful l h i gh-di mens i onal computation, it did not reduc e p rediction accurac y . The R M S E w h en empl o y i n g t he met hod on normal i zed dat a (af-t e r g l obal e f fect s w ere remo v ed) i s 0 .9157. S u rpri s i ngl y , t h i s compares f a v o rabl y , w i t h a R MS E o f 0 .9174 achi e v e d t h rough a much l onger r un t h at comput ed nei ghborhoods o n th e o r i g i n a l d ata. Hen ce, we d e d u c e t h a t d im en sio n a lity reduct i o n i s a n e f fect i v e t ool for p erformi n g u s e r -ori e nt ed met hods .

W h i l e a R MS E o f 0 .9157 pres ent s a 3 .75% i mpro v e -m e n t o v e r N etflix C in em atch r e su lt, it is still w o r s e th a n our report e d 0 .9086 R M S E us i n g t he i t e m-ori e nt ed met hod. H o w e v e r , s i nce t he t w o met hods capt u re di f ferent s ort s of i n format i on, w e can get a bet t e r res ul t b y c ombi ni ng t h em. F o r e xampl e by t a ki ng a w ei ght ed a v erage o f t he res u l t s (60% mo vi e, 40% us er), t h e R MS E w as l o w e red t o 0 .9030. More s ophi s t i cat ed combi n at i ons mi ght go be yond us i n g a fix ed r a tio , t o m o d i f y th e r atio acr o s s q u e r i es b y estim atin g the r elati v e s ucces s o f t he us er -oriented m ethod.
C o l l a borat i v e fi l t e ri ng t h rough nei ghborhood-bas e d i n-t e rpol at i o n (  X  X N N  X  ) i s p robabl y t he mos t popul ar w a y t o create a recommender s ys tem. The s ucces s o f t hes e meth-ods depends on t h e c hoi ce of t h e i nt erpol at i o n w ei ght s , w h i c h a re us ed t o es t i mat e unkno w n rat i ngs from n ei ghbor -in g k n o wn o n e s. Ne v e r th e less, th e liter a tu r e lack s a r ig o r -ous w a y t o d eri v e t hes e w e i ght s . In t h i s w o rk w e s h o w ed ho w t he i n t e rpol at i o n w ei ght s can be comput ed as a g l obal so lu tio n t o a n o p tim izatio n p r o b l em th at p r ecisely r e flects t h ei r rol e. C o mpari s on w i t h pas t kN N m et hods on t h e N et -fl i x d at a, demons t rat ed a s i gni fi cant i mpro v e ment of pre-diction accurac y without a m eaningful increas e i n r unning tim e.

O u r s econd, compl e ment ary c ont ri b u t i o n i s rel at ed t o d a ta n o r m a lizatio n . No r m alizatio n i s e ssen tial t o k NN met hods , a s o t h erw i s e mi xi ng rat i ngs pert ai ni ng t o di f ferent unnormal i zed us ers o r i t e ms can produce i nferi o r res ul t s . Thi s w o rk of fered a comprehens i v e a pproach t o dat a nor -m a lizatio n , fittin g 1 0 e f f ects t h a t can b e r ead ily o b s er v e d i n us er -item r ating d ata. Thos e e f f ects caus e s ubs tantial d ata v a riability and m as k t he fundame ntal relations hips between ratings . H ence, their i nclus o n b ri ngs t h e rat i ngs cl os er and f acilitates i mp ro v e d e stimatio n accu rac y .

A k NN method can be mos t ef fecti v ely e mplo yed i n a n i t e m-ori e nt ed manner , by anal yzi n g rel at i ons hi ps bet w een items . H o w e v er , certain cas es call f or a u s er -oriented ap-proach. E xampl e s i ncl ude us ers t hat d i d not rat e much or at all, or when it is needed to impro v e prediction accurac y by cons i d eri n g a l s o u s e r -us er rel a t i ons hi ps . W e s ho w h o w t o appl y our met hod for t he us er -ori ent e d cas e. Import a nt l y , w e of fer a no v e l i mpl e ment at i on, bas e d o n a l o w d i men-s i onal e mbeddi ng of t h e u s e rs , t hat a l l o w s a s i gni fi cant c om-put at i onal s peedup.
 [ 1 ] G . A d o m a v iciu s a n d A. T u zh ilin ,  X  T o w a r d s t h e Ne x t [ 2 ] R . M . B ell, Y . K o r e n a n d C. V o lin sk y ,  X  X o d e lin g [3] J . B ennet a nd S. Lanning,  X  X he Netflix Prize X , KDD [4] B . E fron a nd C . Morri s ,  X  X at a a nal y s i s u s i ng S t ei n X  s [5] S . F unk,  X  X  et fl i x U pdat e : T ry Thi s A t H o me X , [6] D . G ol dber g , D . N i c hol s , B . M. O k i a nd D . T e rry ,  X  U s -[7] K . G ol dber g , T . R oeder , D . G upt a a nd C . P e rki n s , [8] J . L . H erl o ck er , J . A . K ons t a n, A . B o rchers and J ohn [ 9 ] J . K o n s tan , B. Miller , D. Maltz, J . Her lo ck er , L . Go r -[10] C . L. La w s on and B . J . H ans on, Sol vi ng L e as t Squar es [11] G . Li nden, B . S m i t h and J . Y ork,  X  A mazon.com R ec-[12] J . Nocedal and S . W right, Nu merica l O p timiza tio n , [13] R . S a l a khut di no v , A . Mni h , a nd G . H i nt on,  X  X  e-[14] B . M. S a rw ar , G . K arypi s , J . A . K ons t a n, and J . R i e dl , [15] B . S a rw ar , G . K arypi s , J . K ons t a n a nd J . R i edl ,  X  X t e m-
