 Wireless sensor networks have received increasing interest in recent years [1, 10]. A wireless sensor network usually consists of a large number of small, inexpen-sive, limited-battery-powered sensors. The sensors can be densely deployed to monitor the environment and collect useful information on their surroundings. During the lifetime of network, the collected information is periodically gathered and transmitted to a base station for further processing.
 network is to increase the network lifetime. In [3], Chang and Tassiulas proposed a maximum lifetime routing algorithms by treating the data transmission pro-cess as a maximum flow problem which meets the flow conservation principle. Nowadays data aggregation has emerged as a particularly useful paradigm for wireless routing in sensor networks to reduce the energy consumption [2, 6]. The idea is to combine the data from different sensors enroute to eliminate redundant transmission. This paradigm greatly reduces the amount of data transmitted and thus saves energy. Several protocols, such as LEACH [4] and PEGASIS [8], used data aggregation to minimize the energy consumed by sensors and increase the network lifetime accordingly. Further, Lindsey et al proposed PEDAP-PA [9], a tree based routing algorithm, which tries to improve the network lifetime. It achieves a good performance comparing with LEACH and PEGASIS in terms of lifetime. However, these algorithms are not well optimized.
 gation problem formally. Tree structure is used as the basic routing scheme for our analysis since it is the minimal graph structure supporting the network con-nectivity. After giving some analysis, we propose a new near optimal maximum lifetime data gathering and aggregation algorithm MLDGA. MLDGA tries to construct a maximum lifetime routing tree for each data gathering round while the tree is energy-efficient. The experimental results show that MLDGA suc-ceeds in achieving longer lifetime and better network utility than several other existing algorithms in various conditions.
 works. Section 3 presents the maximum lifetime data gathering problem and gives some definitions used in this paper. Section 4 investigates the problem and proposed a near optimal algorithm MLDGA. In section 5, we conduct experi-ments to compare our algorithm with other known algorithms. We conclude our work in section 6. Several efficient data gathering routing algorithms have been proposed in the recent years.
 In LEACH, each cluster-head collects data from sensors in its cluster, fuses the data, then sends the result to the base station. LEACH utilizes randomized rotation of cluster-heads to evenly distribute the energy load among sensors in the network. Simulation results show that LEACH achieves as much as a factor of 8 reduction in energy dissipation comparing with direct transmission [4]. with a close neighbor, and takes turns transmitting to the base station to prevent the failure of network. Only one node is designated to communicate with the base station, consequently the energy dissipation is significantly reduced. PEGASIS achieves better lifetime than LEACH about 100 to 200% [8].
 PA. The basic idea is to minimize the total energy expended in a round of com-munication while balance the energy consumption among sensors. In PEDAP, the weights of edges are the transmission cost between two connected sensors. In PEDAP-PA, the weight of edges is the ratio of the transmission cost between two connected nodes to the remaining energy of the sending node. PEDAP prolongs the lifetime of the last node death while PEDAP-PA provides a good lifetime for the first node death. Simulation results show that these two algorithms perform better than LEACH and PEGASIS both in systems that the base station is far away from and inside the field [9]. In this section, we present some background information about the maximum lifetime data gathering and aggregation problem, and give some definitions which will be used in the following paper. 3.1 Problem Statement We consider a wireless sensor network consisting of a group of sensors and a base station which are randomly distributed over a region. The locations of sensors and the base station are fixed. The base station knows the locations of all sensors apriori, which can be obtained by manually entering coordinates or by using GPS-equipped sensors. A sensor can transmit data to any other sensor, and can communicate directly with the base station. The sensors periodically monitor their vicinity and generate monitoring data. The data from sensors are gathered at each time unit and sent to the base station for further processing. The time unit is called round . We assume that each sensor has limited battery energy and the action of transmitting or receiving data will consume its battery power. Our problem is to find a routing scheme to deliver data from all sensors to the base station, which can maximize the lifetime of the sensor network. In the process, data aggregation can be used to reduce the number of messages in the network.
 in [4]. In this model, the radio dissipates E elec =50 nJ/bit to run the transmit-ter or receiver circuitry, and E amp = 100 pJ/bit/m 2 for the transmit amplifier. Therefore, the energy expended to transit a k -bit message to a distance d is: while the energy expended to receive this message is: which is a constant for a fixed-size message.
 [9] mentioned two different definitions for lifetime: In applications that the co-operation of all sensors working together is important, lifetime is defined as the time when the first node is drained of its energy; In applications that adjacent sensors record identical data, lifetime is defined as the time when a specified percentage of the sensors die. In this paper, we focus on the applications that need the cooperation of all sensors, and we adopt the first type of definition. Put it another way, we try to maximize the time when the first node dies. 3.2 Definitions We can view a sensor network as a directed graph G =( N, A ), where:  X  N is a set of all sensors and the base station in network. Each sensor is  X  A is a set of directed edges connecting two sensors, i.e. A = { ( i, j ) } . We denote the weight of edge ( i, j )  X  A as w ij ( w ij = w ji ).
 Definition 1. For a sensor network G =( N, A ) , T =( N, A ) is a rooted di-rected spanning tree of G , where A is a subset of A (i.e. A  X  A ) and T is rooted at the base station (i.e. root[ T ] = 0). we call T a routing tree for network G. in sensor networks. It can be seen that a spanning tree is the minimal graph structure supporting the network connectivity. In the tree-based routing scheme, for each sensor i , we can find a directed path from i to the base station, and the path does not contain a cycle. In section 2, we have reviewed three types of routing scheme: cluster-based, chain-based and tree-based routing scheme. In fact, cluster-based and chain-based routing scheme can be viewed as a special case of the tree structure based routing scheme. Therefore, we base our discussion on the tree structure in the following paper.
 Definition 2. We define the lifetime of a sensor i as the duration of the time tree T as the duration of the time when i and j are alive, and denote it as l ij . Foraedge ( i, j ) in tree T , we have l ij = min { l i ,l j } .
 sor i in routing tree T , the residual battery energy level of a sensor i at round t n ( T )  X  E Rx . The tree with minimum total energy consumption is denoted as T o , In this section, we investigate the maximum lifetime data gathering and aggre-gation problem in sensor networks. Based on tree structure routing scheme, we propose an algorithm MLDGA for the problem.
 problem can be described formally as following: For a sensor network G =( N, A ), round t . When data is gathered through these routing trees, the lifetime of the network G can be maximized.
 Definition 3. For a sensor network G =( N, A ) , let the series of routing trees used by G be  X  = { T ( t ) } . Then the network lifetime of G is where l i is the maximum value which satisfies The optimum network lifetime L o of G is defined as where  X   X  is the set of all possible routing tree series for G .
 Theorem 1. For a sensor network G , its optimal network lifetime L o is upper bounded by i.e. L o  X  L o U .
 Proof. We cannot spend more energy than the total energy of G , which is i =1 R i (0). In every round, at least of power should be spent no matter what kind of tree we use. Therefore, the network lifetime cannot exceed L o U .
 ering problem. (1) Try to minimize the total energy consumption of a routing tree in each round. From theorem 1, we know that if the total energy consumed in a round is minimized, we will have more energy to be used in the following data gathering process, thus the lifetime of the network can be increased. (2) Try to maximize the lifetime of a routing tree constructed in a round. By maximizing the lifetime of a routing tree used in a round, we will have a cumulative effect to improve the lifetime of the network.
 lifetime data gathering and aggregation algorithm MLDGA. In each round, MLDGA constructs a routing tree for this round. We describe the tree con-struction process of MLDGA by presenting an example.
 Step 1: Initialize variables. Figure 1(a) shows a five-node sensor network. The base station is location in (2, -100), which is labelled by 0. The current energy level of 1 is 0.12J, and the current energy levels of 2, 3, 4, 5 are 0.01J. Each sensor sends 2000-bit message to the base station in a round. We use tree structure T 0 to represent the sub-routing-tree that has been built for G at a round, use S to represent the sensors that have already been selected as part of T 0 (includes the base station), and use U to represent the sensors that have not been inserted into T 0 ( U = N  X  S ). S is initialized to the base station, and U is initialized to all the sensors. In Fig. 1(a), S = { 0 } and U = { 1 , 2 , 3 , 4 , 5 } . Step 2: Determine which edge can be added to T 0 . For each node i in U and each node j in S , we compute the edge weight w ij ( t ) between i and j at round t , and add the edge with maximum weight to T 0 . We define the edge weight w cost between i and j . The lifetime of a node is related to its residual battery power, transmission cost and receive cost. Since the routing tree has not been constructed and the tree is dynamic, we cannot determine the lifetime of a node until the death of the node. Therefore, we have to make an estimation to the lifetime of a node, and give an estimation to the weight of an edge accordingly. l  X  55 and w w 50 . We add edge (1, 0) to T 0 . The base station is located far from the boundary of figure, so we use the dotted line to denote the edge between 1 and 0 in Fig. l  X  99 . 6, l w are changed correspondingly. U = { 3 , 4 , 5 } and S = { 0 , 1 , 2 } . Continue: The procedure is continued until all sensors in U have been added to S . Figure 1(d) shows the final tree. The routing tree T for G in current round is constructed ( T 0 = T ).
 our strategies about the maximum lifetime data gathering problem:  X  If the transmission cost between the sending sensor i and the receiving sensor  X  If the lifetime of edge ( i, j ) is high, the edge weight w ij tends to be high. sentially. It inserts a sensor into the tree based on the maximal weight edge one at a time until all sensors are included in the tree. In [9], the authors used Prim X  X  algorithm to construct a minimal spanning tree. The edge weight of PEDAP-PA relates to the transmission cost and the remaining energy of sending node, which only considers the effect of the sending node and keeps unchanged during the construction of routing tree at a round. However, our definition of edge weight considers not only the transmission cost of sending node, but also the combined effect of sending node and receiving node, which can be got from the definition of flects the essence of maximum lifetime data gathering problem, and can achieve a longer lifetime comparing with other existing algorithms, which is confirmed by experiments. In this section, we conducted experiments to evaluate performance of our algo-rithm. We compared MLDGA with several other different data gathering algo-rithms: LEACH, PEGASIS, PEDAP and PEDAP-PA. We tried to investigate the effect of base station location and the effect of initial energy level to these al-gorithms by considering two metrics: the round when the first node dies (RFND) and the round when the last node dies (RLND). RFND is considered in the first place since it meets our definition of network lifetime. For a sensor network, we try to maximize RFND and also expect to prolong RLND.
 randomly distributed over a region of 50m  X  50m. Each sensor had an initial energy level of 0.5J or uniform distribution between 0.2J and 0.8J. The base station was located far away from the field (at point (0, -100)) or in the center of the field (at point (25, 25)). In each round, a sensor sent a 2000-bit message to the base station. The base station computed a routing scheme to deliver data in each round. 5.1 Effect of Base Station Location We investigate the effect of base station location first. [9] mentioned that PEDAP-PA performs well both in systems that the base station is far away from the field and the base station is in the center of the field, while LEACH and PEGASIS perform poor when the base station is inside the field because they do not take the cost of sending data to base station into account. So we examined the effect of base station location to our algorithm.
 from the field and all sensors had equal initial energy levels (F-EE). It can be observed from Fig. 2(a) that both MLDGA and PEDAP-PA achieve a good RFND comparing with other algorithms. PEDAP provides a good RLND but has a bad RFND, since it constructs a minimum energy consuming routing tree for each round of communication but pays no attention to balance the load among sensors. PEGASIS provides both a good RFND and a good RLND. However, MLDGA and PEDAP-PA further improves the RFND about 60% comparing with PEGASIS.
 center of the field and the sensors had equal initial energy levels (C-EE). It can be seen from Fig. 2(b) that MLDGA also achieves a good RFND. It is the best one which achieves the longest RFND in all algorithms.
 (i.e. lifetime) regardless of the base station location. It distributes the load evenly among sensors and tries to minimize the total energy consumed in a round, so it achieves a good RFND and a RLND near to RFND. 5.2 Effect of Initial Energy Level To check the ability of balancing the load among sensors further, we investigate the situations when the sensors have unequal initial energy levels. We distributed the initial energy levels of all sensors between 0.2J and 0.8J uniformly. The average energy level of a sensor is 0.5J, which is the same as Fig. 2(a) and 2(b). from the field and the sensors had unequal initial energy levels (F-UE). Com-paring with Fig. 2(a), we see from Fig. 2(c) that the RFNDs of all algorithms decrease significantly except MLDGA. It means that MLDGA is robust to bal-ance the energy consumption among sensors even the initial energy levels of all sensors are different greatly. MLDGA improves the RFND about 35% comparing with PEDAP-PA, and about 200% comparing with PEGASIS.
 ter of the field and the sensors had unequal initial energy levels (C-UE). Again, MLDGA is the best one which achieves the longest RFND in all algorithms. It improves the RFND about 70% comparing with PEDAP-PA, and about 100% comparing with PEGASIS.
 (i.e. lifetime) regardless of the initial energy levels of all sensors. Its abilities to distribute the load evenly among sensors and to minimize the total energy consumed in a round are further confirmed because it achieves a good RFND and a RLND near to RFND even when all sensors have unequal initial energy levels. In this paper, we investigated the maximum lifetime data gathering and ag-gregation problem in wireless sensor networks. We convert this problem into a problem that: finding a series of routing trees for a sensor network so that the network lifetime can be maximized when data is gathered through these trees. After giving some analysis, we proposed a near optimal algorithm MLDGA to construct the series of routing trees. In MLDGA, the edge weight is estimated as the ratio of the edge lifetime to the remaining energy of sending node, which meets the requirement to construct an energy-efficient maximum lifetime routing tree for each data gathering round. We conducted experiments to evaluate the performance of MLDGA. The experimental results show that MLDGA achieves a good lifetime performance and a good network utility performance regardless of the base station location and the initial battery levels of sensors.
