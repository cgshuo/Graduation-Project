 Real-time extraction of information from composite neural recordings is a significant challenge in neural interfacing. Developing integrated circuit (IC) to enable portable and implantable systems is important to allow the study of complex behavior in neuros cience experiments, closed loop deep brain stimulation, and cortical controlled neuromuscular prostheses. In order for a spike feature extraction algorithm to be functional as a small device with real-time low-latency processing and low power operation it must be efficient in both computation a nd IC implementation.
 Implementing spike sorting before data telemetry offers ma ny significant advantages. Spike feature extraction provides the necessary information required to sort spikes from raw sampled data. With this information each spike event can be represented by its u nique features and firing time, result-ing in significant data compression. A data transceiver desi gned with the current semiconductor technology can simultaneously support a large number of rec ording channels for a microchip im-plementation to extract the spike feature. System integrat ion using wireless power telemetry or a rechargeable battery as well as wireless data telemetry rem oves the need for tethering wires. As a result, a fully wireless operation would relieve the subjec ts overall stress factor and allow them to move freely in their natural environment.
 Frequently used spike feature extraction algorithms inclu de principal component analysis (PCA) [1], bayesian algorithm [2], template matching [3], wavele ts [4] and independent component anal-ysis (ICA) [5], which demand significant computation. Effor ts to improve the efficiency of these algorithms have been reported, however, these efforts reli ed on either over simplified functionality or bulky hardware systems that consume excessive power.
 recording process. The associated noise includes ion chann el noise, activities from distant neurons, it is unrealistic to synchronize the sampling clock with ind ividual recorded spikes.
 This paper reports a new spike feature extraction algorithm which is suitable for real-time spike sorting and enables integrated microchip implementation. 2.1 PCA Based Spike Feature Extraction PCA is a feature extraction algorithm widely employed for sp ike sorting. It uses correlation between samples and computes the vectors capturing the maximal vari ance. PCA algorithm performs well given a strong correlation between samples by reporting rel evant features. However, recorded spikes are usually corrupted by large low frequency noise and disto rtion, which blur sample correlation and compromise the quality of the estimated covariance matrix a nd its eigenvectors. As a result, PCA may fail to resolve spike clusters in noisy recordings. 2.2 Variable Selection Techniques As a complementary approach to dimensionality reduction al gorithms, Jolliffe discussed a general feature extraction algorithm based on a subset of samples in the classic work [6]. This concept prominent sample set.
 There are two challenges facing a sample selection algorith m. The first challenge is the computa-tional burden to select informative samples. If the trainin g procedure is as complicated as suggested in [6], it would prohibit microchip implementation for impl ant purposes. The power and area are the primary problems with the microchip implementation of othe r spike feature extraction algorithms. The second challenge is the availability of localized featu res. Improved performance compared to PCA is unlikely if localized features are not prominent. 2.3 Our Approach We have developed a spike feature extraction algorithm base d on informative samples. The the-oretical framework includes neuronal geometry signatures , noise shaping, and informative sample selection. By evaluating neuronal geometry signatures wit h the compartment model, we find that high frequency signal spectrum may contain useful informat ion to differentiate neurons. Studying the noise properties has revealed that a frequency shaping fi lter can be used to boost the SNR. The sample selection technique using estimated entropy identi fies informative samples for sorting spikes. In addition, a preliminary IC implementation of the algorit hm has been reported [7, 8] and further integrated onto a multi-channel neural recording IC with wi reless telemetry [9]. 3.1 Neuronal Geometry Signature This section describes how neuronal geometry signatures co ntribute to the difference among similar waveforms. Assume that both the intra-and extra-fluids are n eutral, the induced voltage waveform is where j  X  X  X  r represent the locations of the point electrode and the activ e membrane segments, respectively. Since action potentials propagate slowly along the axonal b ranches of the cortex neurons (averaged 0 . 5 m/sec  X  2 m/sec [10]), active membranes do not fire simultaneously. As a resu lt, the detailed geometry of the underlying neuron influences the shape of spi kes. Assuming that ionic channels spike waveform is modeled as the convolution of the transmem brane current profile and an implicit geometry kernel function as where W ( t ) is the geometry kernel function.
 The recorded waveforms from neurons with similar ion channe l populations can be very similar. A general spike sorting algorithm frequently fails to resolv e such ambiguity and may report a single, the similar spikes. Assume W the same ion channel population, the difference between the two spikes is Small waveform differences appear if R ( W the waveforms are identical, ignoring the skew of the activa tion of membranes.
 To differentiate the waveforms, we rewrite Eq. 3 in the frequ ency domain as where F () denotes the fourier transform. The condition of R [ W functions has small contribution at lower frequency spectr um. A more quantitative explanation can be given by studying the derivative of F (  X  V ) with respect to the frequency using Eq. 4 where f is frequency.
 Note that F ( j with a relative wider spectrum. The first term in Eq. 5 is atten uated by F ( W dominant spectrum of F ( j Eq. 4. The second term in Eq. 5, on the other hand, exhibits a st rong frequency dependency within the dominant spectrum of F ( j when kernel functions W In summary, the waveform difference between similar neuron s caused by geometry functions satis-fies the following conditions emphasis on frequency shows that F (  X  V ) exhibits a higher frequency spectrum. As a result, a frequency-shaping filter that emphasizes on high-frequenc y spectrum may help to differentiates ker-nel functions. 3.2 Noise and Sample Distortion An estimated power spectrum of noise associated with record ed neural signal, where the dominance of low frequency noise is clear, is plotted in Figure 1. The no ise profile is approximately fitted as where N noise and N Sampling distortion is unavoidable, since the neuron X  X  firi ng is random and not synchronized with the sampling clock of the analog-to-digital converter(ADC ). It can be reduced by either increasing the sampling frequency of the ADC or performing interpolati on and alignment in the digital domain. Both approaches require additional power, computation and storage space, which are not favorable to microchip implementation. The sampling distortion is re lated to the slope of the spikes. In case a fast transition edge is sampled 4 times, the sampling disto rtion can be more than 10% of the spike peak-to-peak magnitude. Considerable distortion is expec ted since  X  X eural spikes X  are, by definition, fast changing waveforms. Figure 1: noise properties of recordings from a cat cerebral cortex (500 Hz to 15K Hz); (a) noise power spectrum of raw data. (b) noise power spectrum of the de rivative. spikes can be classified into multiple clusters by evaluatin g that sample alone. The method used to quantify the sample information is outlined below.
 Sample Information Estimation Input: M peak aligned spike segments { v Output: Information inf o The computation required to accurately quantify the entrop y of an underlying data set is typically high. However, only a rough estimation is required to select informative samples. Therefore, the amount of spikes to compute information can be reduced to a re latively small number, which should allow hardware implementation in terms of storage space and computation complexity. With the synthesized spike data we used, each sequence contains 3 neu ronal sources with similar firing rate. As a result, the possible information score should be 0 , 1 increase the mount of training events to M = 300 the information scores approximately settle to the expected values, as shown in Figure 2.
 Quantitative comparisons to investigate the existence of i nformative samples in noisy spikes have been done. Results using synthesized spikes with recording s from neocortex and basal ganglia [4] are shown in Figure 2. There are two clear observations. Firs t, the amount of information carried by few of the samples is informative. As a constraint to create i nformative samples, the computation and storage space have to be feasible for microchip implemen tation. As analyzed in Section 3, a frequency shaping filter can be use d to manifest different geometry Figure 2: (a) -(h) information carried by samples from spike s and their derivatives. Horizontal axis is the sample number and vertical axis is the estimated entro py. The black solid line and red dotted line represent the sample information from spikes and their derivatives, respectively. designed to boost high frequency spike features, which shou ld be localized and less correlated if examined in time domain. In this section, we use derivative o peration as an example to illustrate the informative samples.
 In a discrete time spike sequence, the frequency response of taking derivative is where f As shown in Section 3.1, the difference between neuron geome try kernel functions W ( t ) of similar spikes is contained in the higher frequency components, whi ch should be emphasized by derivative operation.
 reduced and the high frequency thermal noise is amplified, as shown in Figure 1 (b). The quantitative impact of the frequency shaping filter on noise is affected by the recording system and biological environment, and the typical values of  X  we observe vary around 2 within the signal band as shown where f case  X  is less than 1, SNR further increases, which favors spike sor ting from the noise perspective. The sampling distortion distribution among samples is alte red after taking the derivative. In the original waveforms, samples close to peaks suffer less dist ortion compared with those in transition. After taking the derivative, samples initially suffering f rom large distortion become less distorted experiments to demonstrate the creation of informative sam ples have been done.
 A subset of results are shown in Figure 2 (a) -(h). In these dat a, the black solid lines represent information carried by the samples from spikes and the dotte d red lines represent the derivatives. The spike data are 8 challenging sequences from [4]. They are compiled from recordings in the neocortex and basal ganglia with superimposed noise. All 8 s equences contain 3 neuronal sources. During estimation of sample entropy, a mean shift classifier with a hierarchical merging procedure is being used to quantify the partition. Small clusters with events less than 5% are ignored. The corresponding feature extraction results using the most in formative samples from spikes as well as their derivatives are shown in Figure 3 (a) -(h), which clear ly presents a 3 cluster configuration. Figure 3: feature extraction results using the proposed alg orithm and competing algorithms. (a) -(h) display the extracted features using the most informati ve samples of spikes and their derivatives (proposed). (i) -(p) display the extracted features using a subset of samples includes the peaks of the spike derivative and spike height (implemented on chip, proposed). (q) -(x) display the PCA Nonlinear energy operator (NEO) [11] is used as the spike det ection algorithm. Overlapping spikes within 600  X Sec are ignored. Haar wavelet is used to perform wavelets based f eature extraction, and features are obtained from the variance peaks after the wave let transform. Two dimensional features are projected from a higher dimensional space.) Synthesized spike sequences used in Figure 2 are applied to c ompare the sorting accuracies of differ-ent approaches. Feature extraction using the pre-specified subset consists of the peaks of the spike derivative as well as the height of the original spike is show n in Figure 3 (i) -(p). Comparative feature extraction results using competing algorithms, e. g, PCA, wavelets, spike peaks and width are also shown in Figure 3. The extracted spike features are c lustered on a PC [12]. About 5% overlapping spikes are ignored to clearly quantify the perf ormance of different spike feature extrac-tion algorithms. The proposed feature extraction algorith m including the most informative samples (corresponding to Figure 3 (a) -(h)) achieves the highest ac curacy ( 97 . 0% ). The hardware [9, 8] Figure 4: (a) recorded spikes from cat cerebral cortex are su perimposed, (b) the extracted spike features using a subset of samples are plotted and grouped wi th a clustering algorithm implemented 0.15) compared with (h) -(j) in (-0.5, 0.3) and (k) in (-0.5, 0 .5). using the pre-specified subset gives similar accuracy ( 96 . 1% ). The counterpart algorithms include PCA, wavelets and spike peaks and width give 78 . 4% , 73 . 6% and 35 . 4% , respectively. The sorting accuracy comparisons are listed in Table 1.
 Animal sequences are collected to test the performance of th e proposed algorithm. An example with overlapped spike clusters is selected for demonstrati on. The sequence is recorded from the 1210 spikes are superimposed. Extracted spike features usi ng the pre-specified subset of samples implemented on chip are shown in Figure 4 (b). The discrete po ints in feature space are grouped into 8 clusters with different colors using off-line cluste ring. Less than 10 % of noisy spikes and the validity of the classified spike clusters, superimposed clusters in Figure 4(c) are individually plotted in Figure 4(d)-(k).
 The second example containing more than 4000 spikes recorde d from a monkey is shown in Figure 5. In Figure 5 (a), detected spikes are superimposed. Extracte d features using the pre-specified subset to display the isolation quality of clusters in feature spac e. The corresponding PCA based feature extraction is shown in Figure 5 (d) as a comparison. The class ified spike clusters using the pre-specified subset of informative samples are plotted in Figur e 6 (a) -(e). Spike clusters plotted in informative samples based sorting does not over partitioni ng the data set, the derivatives of spike to-peak magnitude or shape. framework includes neuronal geometry signatures, frequen cy shaping filter, and informative sample selection. Unlike PCA which uses correlated features, the s ample selection algorithm focuses on localized and uncorrelated features which are strengthene d by the frequency shaping filter. With simulated spike waveforms from a public data base, the algor ithm demonstrates an improved sort-ing accuracy compared with many competing algorithms. The a lgorithm is designed for integrated microchip implementation and performing real-time spike s orting. A preliminary hardware imple-mentation has been realized using an integrated circuit chi p interfaced with a personal computer. Figure 5: (a) detected spikes from a monkey, (b) extracted sp ike features using a subset of samples, (c) zoom in of (b) for better visualization; (d) extracted fe atures using PCA. Figure 6: (a) -(e) the classified 5 clusters of the monkey sequ ence shown in Figure 5, (f)-(j) the derivative of the classified 5 clusters. The identity is indi cated by color.

