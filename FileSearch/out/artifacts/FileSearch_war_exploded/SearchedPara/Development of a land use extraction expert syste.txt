 1. Introduction
Land use (LU) information is of signi fi cant value for various urban studies and is needed for a wide variety of decision-making initiatives in the range of global, regional and urban areas. In the fi eld of urban land use planning, one of the prime prerequisites for modeling and simulation of urban system involves evaluating existing land use patterns and mapping its changes over the time.
In this regard, urban planners/modelers require different data, such as census population, employment, household, land use (developed and developing) to predict and simulate urban devel-opment. From the viewpoint of data collection, Nossin (1982) stated that  X  The technical capability of data collection is the on a long road, but is often considered a goal in itself. It may be an objective in itself to create awareness of the steps that follow the data collection phase, so that it may serve the development purpose
He also continued his opinion that  X  data collection is the necessity of planning and is the fundamental of decision-making and developments  X  .
 such as Levinson and Yerra (2006) , Abrahamsson and Lundqvist (1999) , Crainic and Ricciardi (2009) , and Flotterod and Bierlair (2011) have used land use information in their modeling, fore-casting, classi fi cation, and predicting work fl ows. However, lack of detailed information on urban land use and of ef fi cient gathering method have made modeling/planning of urban system dif fi
Existing geographic and census data are usually dated and they cannot re fl ect rapid urban developments. This situation impels city planners/modelers to use zone-based system and aggregate LU information in the process. In this case, heterogeneity of urban
LUs within the zones has to be tolerated, and economic activities are assumed homogeneously distributed over a zone. Subse-quently, all activities within a zone are assumed to be located at the center of the zone centroid. Popular transportation and land use models, such as Surface Transportation Ef fi ciency Analysis Model (STEAM), TRANPLAN, PECAS, MEPLAN, TRANUS, ITLUPE,
CUF-2, IRPUD, IRPUD2, and MUSSA, all follow such assumptions and therefore, their accuracy is deteriorated by the errors intro-duced by such a spatial aggregation. State-of-the-art urban plan-ning and integrated land use and transportation modeling (ILUTM) demand up-to-date and much more detailed land and fl oorspace inventory data. Unfortunately, to date, there is no good way to obtain such data in an ef fi cient and accurate way.

Remote sensing (RS) technologies have a great potential to extract detailed land use information. However, many barriers still exist and the technologies are far from practical for real-world applications in the urban and transportation planning/modeling, which will be discussed in Section 2 . This paper proposes a hierarchical rule-based LU extraction system using geographic vector data and remotely sensed imagery. The two LU classes, including residential and commercial, are extracted through morphological and spatial arrangement analysis at a fi ne spatial level (i.e., parcel-level). 2. Study background
Distinguishing land use and land cover, which have been misunderstood by many, is important in understanding the scope of this study. Land cover classi fi cation is related to chemical and physical properties of landscape objects and usually describes features, which are visible on the ground such as buildings or trees. In contrast, land use is an abstract concept describing the amalgam of economic, social, and cultural factors ( Barnsley and
Barr, 1997 ) of a piece of land being used by human being. It should be noted that, unlike land cover, land use is de fi ned in terms of function, such as residential, commercial, or industrial, rather than physical form. The abstract nature of LUs means that it is impossible to directly extract them from RS imagery (through traditional land cover classi fi cation method) because they are not physically visible. In other words, it is simply impossible to extract
LUs based on grey values of RS images. Instead, LUs have to be inferred or generalized through various LU components (e.g., buildings vs. parking lots and their spatial relationship), for example, if a group of neighbor buildings are dense and the size of them are small, then the land being used is more likely for low-density residential purpose. 2.1. Review of land cover classi fi cation
Many studies have been dedicated to classify and extract landscape features (land covers) from remotely sensed images in either urban or suburban areas. Different techniques and course of actions have been used to tackle different situations from different types of aerial and satellite imagery (medium, high, and very high resolutions). It should be noted; however, the previous research of extracting land covers utilizing medium spatial resolution ima-gery, such as Landsat ETM  X  and SPOT4, is only acceptable for the application of urban mapping at a very coarse level ( Zhang, 1999, 2001 ; Mundia and Aniya, 2005 ; Deng et al, 2005 ).

However, such medium spatial resolution images are not useful for identifying detailed and accurate man-built urban features (such as buildings, streets, and parking lots), which is the need of the present research. This is mainly due to the lower spatial resolution of such images on one side and the complexity of urban features on the other side ( Beykaei et al., 2010 ). Therefore, there is a need to incorporate very high resolution (VHR) imagery along with spatial information for extracting detailed LU informa-tion in an urban area. Many other studies ( Xiao et al., 2004; Liu and Prinet, 2005; Paci fi ci et al., 2007; Mohaptra and Wu, 2008 ) have also shown the great potential of VHR imagery in detecting detailed urban features. However, the disadvantage of using such images is their limited spectral information (usually 3 or 4 bands), which makes classifying land covers with similar spectral signa-ture dif fi cult. 2.2. Review of land use classi fi cation
On the other hand, LU classi fi cation, particularly in urban areas, exhibits some unique features that make the related research even more challenging. The previous studies show that extracting LU information is the most challenging part of classi fi cation process and it needs other auxiliary data and a signi fi cant post-classi fi cation analysis. Mesev (2005) mentioned that due to abstract nature of LUs, extracting detailed LU information inevi-tably relies on auxiliary geographic or spatial data (non-spectral data) as well as images (spectral data) to improve the accuracy of classi fi cation. This is because that LU is de fi ned based on its function, rather than its physical or chemical properties. The function of a LU cannot be directly observed, but need to be generalized and inferred through its various components, such as building size, the quantity of parking and vegetation area. In this regard, a far less number of studies have been devoted to extracting urban LU information via remotely sensed imagery. Consequently, the techniques being developed for land cover classi fi cation and applied to some well-known classi fi ware, such as ENVI and eCognition, have not been proven to be useful in LU extraction.

Bales et al. (2008) used partial morphological reconstruction to better preserve the shape of objects, which contains the informa-tion about the minimum and maximum dimension of urban objects, to improve the classi fi cation results. Barnsely et al. (2003) used Light Detection And Ranging (LiDAR) and multi-spectral image data to determine urban LUs through an analysis of the spatial composition of building. Three morphological properties of building including roof area, compactness and height, were examined in their study. Yoshida and Omae (2005) studied the form and structure of urban features in Tokyo based on their urban landscape model (ULM) using RS data to extract residential and industrial areas. They used city blocks (spaces between street grids) as the analysis unit. The interrelationships as well as geographical distribution of blocks were interpreted based on their morphological properties. In this regard, they concluded that the correlation and interrelation of the parameters (morpho-logical properties) are important to extract LU information from images. The two questions arise from their study: (i) what combination of properties and relations provides the best separation of the two land use categories, and (ii) is this suf fi cient to identify areas of each land use unambiguously? Despite the fact that the above studies attempted to improve LU classi fi cation in different fashions, only limited enhancements have been achieved. Further, no one has really answered the two above questions raised by Pesaresi and Bianchin (2001) ten years ago and no solid and effective method has been materialized.

Overall, the literature demonstrates that the application of remote sensing technology in the urban and transportation plan-ning/modeling is indisputable and promising, but it is still imma-ture for real-world planning applications, especially for extracting detailed LU information in urban areas. Studies in this area are usually contributed from two disciplines: Geodesy and Geomatics Engineering and Civil Engineering. From the viewpoint of geodesy and geomatics engineers, extracting precise land cover informa-tion from remotely sensed imagery is the priority whereas less attention has been paid to their applicability to other disciplines such as urban and transportation planning or modeling. From the viewpoint of planners, land use information is more important than land cover in their modeling and forecasting work fl which few studies have been dedicated.
 3. Study area and data
This research uses the City of Fredericton, Canada as the study area. As discussed before in the study background, due to the abstract nature of land uses, several types of data, including geographic vector and remote sensing (RS) imagery, are used to discover correlation/association rules related to urban LU classes.
Based on the results of previous research on land cover/use classi fi cation ( Beykaei et al., 2010 ), it is found that the similarity of spectral characteristics of urban land covers/uses requires incorporating geometrical/spatial information within the classi -cation process. In this regard, ancillary data such as geographic vector data (hereafter referred as  X  geographic data  X  ) plays an important role to understand LU patterns and association rules.
Due to signi fi cant processing time required with each image, a bunch of sample dissemination blocks (DBs) from the study area are selected and considered. It should be noted that DB is the smallest zone unit from the Canadian census. The testing area includes 43 DBs with a variety of LUs, ranging from highly complex downtown area at the center of the city, residential areas, institu-tional and industrial areas, to exclusive commercial areas.
The following geographic data (which are GIS shape fi les) are used in this study: digital Property Map (DPM), building footprint, and street network. DPM data set contains New Brunswick tax assessment records, which divides the entire province into parcels with known LU purposes. The LU information is usually unavail-able for modelers and planners due to its con fi dentiality issue.
Reference data on the size, shape and spatial location of building objects in the study area are also available in the format of geographic vector layer provided by the City of Fredericton.
However, the building footprint data has no information about activity uses. In order to assign LU information to the building footprint data, they are spatially joined with the tax assessment records from the DPM data. Street network is another geographic data used in this study which is a poly-line shape fi le and has the information about each road segment.

City of Fredericton in 2008, which have been corrected and ready for image processing (also called orthophotos), are used to extract land covers. The orthophotos are VHR images with .15 m resolu-tion, 8 bit depth, multispectral with three bands of Red, Green, and
Blue (RGB). Each image has a size of 6667 6667 pixels. In order to cover the entire testing area, 34 orthophotos are used for segmentation and classi fi cation purposes. Fig. 1 shows the ortho-photos used, sample DBs, and built areas to be analyzed. 4. Study methodology 4.1. Research hypothesis and overview and physical correlation between different man-built features in an urban system and various LU activities. This assumption comes from the fact that, in an urban system social and economic activities locate at various points in space and there are rationales behind their physical and spatial arrangements. Such rationales are that land uses are designed, arranged and developed to facilitate various social activities and to achieve numerous com-munity goals. In this regard, Batty (2007) mentioned that Cities are highly organized with respect to their form.
 cate that morphology and spatial arrangement analysis of land covers are vital for extracting urban LUs. A sophisticated land cover classi fi cation system was developed through a hybrid pixel-and object-based approach, which was thoroughly presented in the previous studies ( Beykaei et al., 2011, 2012 ). The results of land covers extracted (including bare soils, parking lots, and vegetation areas) and geographic data are used further in the LU extraction process in order to derive association/correlation rules related to target LUs.

This paper proposes to develop a LU extraction system at the parcel level. This is consistent with the practice in the real-world, where parcel is used as the smallest unit for planning, designing, developing, and managing land uses. Following this approach, all buildings within a same parcel will be collectively counted as one hypothetical building, and LU indicators such as built-ratio and fl oorspace/area ratio are then calculated based on this rule. It should be noted that only residential and commercial LUs are considered and used because there are limited numbers of observations at the parcel level for other LU types (such as industrial, institutional, and recreational) in the study area. 4.2. Structure of proposed LU classi fi cation expert system
Due to the abstract nature of land uses, it is dif fi cult and sometimes impossible to extract LUs directly from RS imagery.
Therefore, intermediate analyses (i.e., morphological and spatial arrangement analyses) using RS and auxiliary geographic data are required to develop association/correlation rules with respect to different LUs. Land covers are fi rst extracted using RS imagery.
Results of land cover classi fi cation including parking lots, vegeta-tion areas, and bare soils are essential to analyze morphological and spatial properties of urban features. In this regard, geographic data and land covers extracted are used to examine and recognize different land use patterns at the parcel-level.

A LU classi fi cation tool  X  Logistic-Decision Tree (LDT) is used in the morphological analysis in order to extract LU information at the parcel-level. The LU extraction process is then followed by the spatial arrangement analysis to develop a more sophisticated and reliable LU extraction framework. It should be noted that the strength of the proposed LDT approach versus a common logistic regression model is that a speci fi c LU is extracted independently at each level/node of the decision tree based on its own speci effective variables, so that there is no need to examine a compli-cated data set to extract all LUs based on one  X  master  X  this case, the LDT approach provides signi fi cantly increased accuracy because the developed models work independently at each level of classi fi cation system and they can well handle the heterogeneity and noise presented in the data set.

In general, the proposed method for LU extraction at parcel level consists of the following two steps: 1) Parcels are fi rst classi fi ed into a LU category (e.g., residential vs. commercial) based on the morphological analysis. 2) Misclassi fi cations occurred in the morphological analysis are corrected through the post spatial arrangement analysis.
A hierarchical rule-based LU classi fi cation model is applied to extract residential and commercial LUs in a decision tree system ( Fig. 2 ). Initial analysis indicates that extracting residential parcels is easier and more accurate than commercial parcels due to their homogenous signature. Therefore, the hierarchical classi fi model fi rst starts by differentiating residential (Res) vs. none residential (non-Res) parcels at Node #1 through morphological analysis. Extracted residential parcels are then fi ltered in a post-correction process using spatial arrangement analysis. The non-
Res parcels are then considered in a subsequent commercial LU classi fi cation model to extract commercial (Com) vs. none com-mercial (non-Com) parcels at Node #2. Similarly, extracted com-mercial parcels are then further examined in a post-correction process using spatial arrangement analysis. It should be noted that, the post-correction process corrects misclassi occurred in the parcel-based morphological analysis. The accura-cies of the fi nal results from LU extraction system at each step (morphological and spatial arrangement analysis) are assessed to evaluate the utility of the LU extraction framework developed.
In order to de fi ne the signatures of the residential and commercial LUs, several morphological properties derived from geographic and RS data are examined in the classi fi cation system. The following morphological properties are considered as poten-tial LU classi fi cation indicators, including: 1) Derived from geographic data: Sum of building area (sB_Area), sum of building perimeter (sB_Per), average building compact-ness (AvB_Com), average building height (AvB_Height), built ratio (Built_Ratio, which is the ratio of total building area and parcel area), fl oorspace area ratio (FAR), parcel area (P_Area), distance to CBD (Dis_CBD), distance to nearest local road (Dis_Local), distance to nearest arterial (Dis_Arterial), distance to nearest collector (Dis_Collector), and distance to nearest freeway (Dis_Freeway), 2) Derived from RS data: Vegetation ratio (Veg_Ratio), parking ratio (Park_Ratio), and bare soil ratio (BareS_Ratio).

The sample area in this study contains 824 parcels which are divided into two subsets; 75% of them are used for training and the other 25% are used for testing the classi fi er LDT. 4.3. Morphological analysis for extracting residential parcels
Morphological study can provide quantitative analysis of shape, size, texture, and phase distribution of individual physical objects in urban areas ( Yoshida and Omae, 2005 ). Urban LUs are catego-rical responses which consist of a set of categories, in this case, residential and commercial. Different properties derived from RS and geographic data are tested through logistic regression model.
In order to identify the best indicators for differentiating Res vs. non-Res and Com vs. non-Com parcels, two binary logistic models are tested (using the training data set) and then implemented at the Node #1 and 2 of the decision tree, shown in Fig. 2 . A forward step-wise regression is used to select the effective indicators (independent variables) to be used in the binary logistic model at each node. In other words, such a model is used to select a subset of parcel properties, which will be considered as the indicators in the LU classi fi cation model, in order to provide the best extraction results for the residential and commercial LUs.
The mathematical formulation of the binary logistic model is fully explained by Agresti (1996) .

Five steps with different combinations of variables are tested through the binary logistic model. All the tests are carried out at the 95% con fi dence interval for exp(  X  ), where  X  is the coef independent variable to be estimated by the model. All the potential variables are initially considered in the model at step 1. Moving from step 1 to step 5, insigni fi cant variables are recognized based on their estimated p -values in the model ( p -value 4 .05) and then removed from the model at each step. The variables for the fi nal model (step 5) are selected based on the critical p -value (sig.  X  .05) and the higher accuracy in the model estimation. In this regard, the probability of a parcel being a Res or a non-Res class and a Com or a non-Com class is calculated using the binary logistic model. The cut-off probability for a parcel to be assigned into either LU class is set as .5. For example, if the probability of a parcel belonging to the residential class vs. non-residential is calculated as .42 ( P (Res)  X  .42),itislessthanthecut-off value .5, which means the parcel should be classi fi ed as non-residential rather than residential. 4.4. Spatial arrangement analysis for enhanced residential and commercial LU extraction
Morphological analysis introduced above characterizes the natural properties of each individual unit  X  parcel. The interrelationships of units, nevertheless, are not considered in such analysis. However, the spatial arrangement or formation o f urban features, such as buildings or parcels located in a given area; need to be analyzed if a thorough understanding to the LU pattern i s desired. To address this issue, spatial analysis is tested against spatial arrangement of urban features  X  parcels through the Gabriel Graph.

Gabriel Graph is used to connect parcels in order to cluster them and to de fi ne their spatial patterns. The rule of Gabriel Graph is that connecting centroids of each pair of parcels (points  X  b  X  in Fig. 3 ) if there is not any other parcel (point  X  c within the surrounded circle of the two targets.
 In this case, by de fi ning effective connection thresholds in the
Gabriel Graph, a zone with mixed-LUs can potentially be separated into different pure or single LU areas. This statement is based on the following real-world phenomena  X  the same urban activities desire to locate close to each other to better support the intended socio-economic activities in order to increase the service ef (Economies of Scale). It should be noted that this is also desired in that it controls the con fl icts between different LUs (e.g. residential vs. commercial) and this is actually an important reason for governments and jurisdictions to implement zoning regulations.
Visual examination to the study area also indicates that each speci fi c activity and the corresponding LU tend to be clustered in different urban areas.
 parcels in the sample area are spatially clustered in terms of their  X  distances  X  or other  X  parcel properties  X  . If the parcels are clus-tered, then it can be concluded that there are rationales behind the structure of LUs in the sample area, which is in line with the hypothesis of this study stated in Section 4.1 . Further, studying the spatial arrangement of parcels for each type of LU will bene the LU classi fi cation process. In this regard, spatial arrangement analysis will serve as a post process to correct the misclassi tions occurred during the morphological analysis, where only the properties of each individual parcel are considered.
 classes in order to best cluster and then extract them from the rest.
It should be noted that a decision rule set will be de fi of connection thresholds against adjacency (distance) or similarity of parcels (in terms of their properties), which are explained in the following sections. 4.4.1. Calculating optimal connection distance threshold for spatial clustering which will then be used for residential and commercial classi tion purposes, different distance thresholds are tested in the
Gabriel Graph analysis. At each speci fi ed distance threshold, the link between a pair of target parcels is disconnected if the distance between them is more than the threshold speci fi ed. In other words, the connections between parcels exist whenever their distances are less than the distance threshold speci fi ed. extracting both residential and commercial LUs in the clustering process is de fi ned based on the following three criteria: 1) The average number of residential parcels in residential clus-2) The number of isolated residential and commercial parcels 3) The total number of non-Res parcels in residential clusters plus together in the satisfaction model which will determine an  X  optimal distance threshold  X  for best extracting both residential and commercial clusters simultaneously.
 both residential and commercial parcels is de fi ned as below:
F Dt  X  X  X  ANoLUiLU NoIsLU TNonLUiLU  X  1  X  where Dt is connection distance threshold, ANoLUiLU denotes the average number of Res parcels in residential clusters plus the average number of Com parcels in commercial clusters, NoIsLU denotes the number of isolated Res and Com parcels, and TNon-
LUiLU denotes the total number of non-Res parcels within resi-dential clusters plus the total number of non-Com parcels within commercial clusters.

Fig. 4 . The best regression trend lines with polynomial order 2 or 3 are fi tted separately to the data for the three components of the satisfaction model in order to study their relationship with the connection distance thresholds. The regression trend lines for the three components shown in Fig. 4 indicate that the models are accurately fi tted to the observed data with very high R
By merging the three sub-functions into one using Eq. (1) , the function is then simpli fi ed in terms of connection distance thresh-old (Dt). Afterwards, the optimal connection distance threshold is obtained by maximizing the satisfaction function as below:
Dt  X  argMax 200 Dt  X  20 2 10 5 Dt 3 0 : 0035 D t 2 where argMax stands for the argument of the maximum, that is to say, a point of the given argument with which the given satisfac-tion function attains its maximum value, Dt opt is the optimal connection distance threshold where the satisfaction function is maximized, and Dt is the connection distance threshold.
By solving the above equation, the optimal connection thresh-old is found as Dt opt  X  99.70 100 m. This means that if adjacent parcels with a distance lower than 100 m are connected (following the Gabriel Graph rule), a best spatial structure can then be created, where clustered parcels provide the best separation of the two LU classes.

As a result, the decision rule based on the optimal connection distance threshold is de fi ned as below:
If Connection distance 4 100 m Then Disconnect Gabriel Line 4.4.2. De fi ning Gabriel connection threshold against other parcel properties
The last section shows that using the connection distance threshold of 100 m for the Gabriel Graph can best extract residen-tial and commercial parcels. It should be noted that in the clustering process, applying the connection distance threshold is always the fi rst step, in which both target LUs are considered simultaneously in the analysis using a  X  compromised  X  connection threshold (e.g., 100 m ). On top of that, spatial arrangement analysis through other parcel properties (e.g., vegetation vs. parking ratio) can help to better de fi ne decision rules to further correct mis-classi fi cations arising from the morphological analysis. In this regard, in the Gabriel Graph analysis, connection rules are derived individually for residential and commercial parcels based on their own parcel properties. Adjacent parcels clustered in the previous step (using the connection distance threshold) are further exam-ined based on the  X  other  X  parcel properties and the connections established during the fi rst step will be maintained or discon-nected. In this section, properties of residential and commercial parcels are used as the criteria for the clustering purpose, in order to develop a more sophisticated classi fi cation system to extract residential and commercial parcels.

In order to study a best way to extract residential/commercial parcel clusters, all parcel  X  s properties described in the morpholo-gical analysis are tested against corresponding satisfaction models. The satisfaction models are de fi ned based on their capability of separating residential and commercial parcels from others and creating pure/single residential and commercial clusters. Similar to the optimal connection distance threshold analysis carried out earlier, each parcel property is considered separately in a satisfac-tion model and the optimal threshold value of the corresponding property is de fi ned by maximizing the satisfaction model. In the clustering process each pair of parcels is disconnected if the difference of corresponding property is more than its optimal threshold value. Similarly, the satisfaction models for residential and commercial LUs are de fi ned separately based on the following three criteria: 1) The total number of isolated Res/Com parcels (NoIsRe/NoIsCo) should be low. 2) The total number of non-Res/non-Com parcels in residential/ commercial clusters (NoRe_noRe/NoCo_noCo) should be low, and 3) The total number of Res/Com parcels in residential/commercial clusters (NoRe_Re/NoCo_Co) should be high.

Based on the above criteria, the satisfaction models for cluster-ing residential and commercial LUs are de fi ned as below: F Res  X  X  X  NoRe _ Re NoRe _ noRe NoIsRe  X  3  X  F Com  X  X  X  NoCo _ Co NoCo _ noCo NoIsCo  X  4  X 
In order to identify optimal connection thresholds, each satis-faction model is tested against each of the 15 parcel properties. However, only those parcel properties are selected for further spatial arrangement analysis whose optimal values can be derived from their satisfaction models. In the Gabriel Graph analysis, each pair of parcels is disconnected if the difference of a speci fi c property of a given pair of parcels is greater than the corresponding threshold. A series of thresholds are used to test the sensitivity of the satisfaction model with respect to each property.
Among the 15 properties used in the morphological analysis, six of them, including building area, building perimeter, building com-pactness, vegetation ratio, parking ratio, and sum of building heights of parcel, are examined through the above optimization process, in order to de fi ne the corresponding connection thresholds.

The reason to select the above six properties is that their corresponding satisfaction models have maxima (local maximum) or knee points (see Figs. 5 and 6 for residential and commercial respectively) which are identi fi ed as the optimal threshold values.
In order to calculate the maxima or the knee point, the regression trend line against each satisfaction model (Eqs. (3) and (4) ) for each of the six properties is fi rst speci fi ed, but the results show a low goodness-of-fi t for most of them. Therefore, to be consistent, the maxima or the knee point of satisfaction model for all properties are derived visually through their corresponding 2D graph, as shown in Figs. 5 and 6 . The optimal thresholds are used to de fi ne decision rules in order to best cluster residential and commercial parcels. Based on the optimal threshold values of the above properties, six independent decision rules of each LU of interest are de fi ned as below:
It should be noted that the above decision rules are derived independently against each of the six parcel properties in order to best extract residential and commercial clusters. For example, in the residential clustering process, if the fi rst decision rule is applied to the Gabriel Graph analysis (which is in terms of sum of building heights of parcel), a pair of parcels is disconnected if the height difference (  X  Height) between them is more than 10 Using the second decision rule, if the area difference (  X  each pair of parcels is greater than 200 m 2 , they will be discon-nected. Similarly, for other speci fi ed decision rules, each pair of parcels is disconnected through the Gabriel Graph, when the difference of each corresponding property is greater than its optimal value. 4.4.3. Correcting misclassi fi cations through spatial arrangement analysis
Level of connection is de fi ned based on the independent decision rules de fi ned in the spatial arrangement analysis at the parcel level. It should be noted that the decision rules are de based on identi fi ed  X  connection threshold  X  (level of connection) against different properties in order to best separate residential and commercial parcels from the others. Combinations of such decision rules are examined based on results from the spatial arrangement analysis and ground truth data to fi nd a best subset of decision rules in order to maximally correct misclassi Trial and error method is used to select the best subset of the seven speci fi ed decision rules for the two target LUs in the spatial arrangement analysis. At the end, the following subset consisting of the four decision rules is found to be best to extract residential and commercial clusters:
Decision rule subset for extracting residential LU:
Decision rule subset for extracting commercial LU:
It should be noted that the above subsets incorporates all four selected decision rules by the logical  X  or  X  operator. Based on the above criteria, if one or more above rules is satis fi ed for a pair of parcels in the Gabriel Graph analysis, then the result is disconnect the two), otherwise, the results is  X  1  X  (i.e., maintain the connection). In general, the  X  or  X  operations used in the decision system make the decision rules work one after another, deciding whether a connection between a pair of parcels should be maintained or not.

Fig. 7 shows more details of how applying individual decision rule (from the de fi ned subset) to the Gabriel Graph analysis can disconnect Gabriel Lines in order to cluster and then separate residential parcels within a given DB with mixed LUs. First, Gabriel
Graph analysis without applying any decision rule is carried out and shown in Fig. 7 (a). In this case, all parcels within the DB are connected as one cluster following the Gabriel Graph. In the next step, the distance threshold of 100 m is applied to the Gabriel Graph (see Fig. 7 (b)), which results in one disconnection between the high-density residential parcel located at the center of the zone (the two buildings within are shown in red) and the commercial parcel located at the lower left corner of the zone (blue building).
However, the commercial parcel is still connected with another low-density residential parcel. It shows that parcels within DBs with mixed-LU are often close to each other and therefore, they cannot be well separated based on the distance threshold only. Applying the second decision rule, the height threshold (see
Fig. 7 (c)), it does not bring any disconnection to the Gabriel Lines, which means all parcels in the DB are similar to each other in terms of the property of building height. Fig. 7 (d) and (e) show the
Gabriel connections after the decision rules based on the area threshold and the vegetation ratio threshold are applied to the
Gabriel Graph analysis respectively. It can be concluded from the results of applying each individual decision rule to the Gabriel
Graph that the area threshold is more effective (results in more disconnections) than the other in order to separate residential parcels.

Finally, Fig. 7 (f) illustrates the results after applying all the above four decision rules to the Gabriel Graph analysis. It shows that the developed system can effectively separate the low density residential parcels from the others. In general, the fi nal results show how spatial arrangement analysis can more effectively extract residential parcels based on the similarity and the adja-cency criteria speci fi ed in the decision rule set.

Fig. 8 is an example showing how applying individual decision rule to the Gabriel Graph analysis can effectively disconnect
Gabriel Lines in order to separate and cluster commercial parcels within a given DB with mixed LUs. Fig. 8 (a) shows the Gabriel Lines without applying any decision rule to the clustering process.
In this case, following the Gabriel Graph, all parcels within the DB are connected as one cluster. First, the distance threshold of 100 is applied to the Gabriel Graph (see Fig. 8 (b)), which results in three disconnections. In this case, the commercial parcels are disconnected from a non-commercial parcel located on the far right side. It is found that parcels in the DB presented in Fig. 8 are more diverse in terms of building areas than all other properties speci fi ed in the decision rule set, and therefore, applying the decision rule for the area threshold results in more disconnections in the Gabriel Graph (see Fig. 8 (c)). Fig. 8 (d) shows that there is not any disconnection when the compactness threshold is applied to the Gabriel Graph. Fig. 8 (e) illustrates that only one disconnection takes place when the parking ratio threshold is applied to the
Gabriel Graph. The reason for a small number of or no disconnec-tion is that parcels in the DB are very similar in terms of their corresponding building compactness and parking ratio.
 all the above fi ve decision rules to the Gabriel Graph analysis. It shows that the speci fi ed decision rule set can effectively separate and extract commercial parcels from the others. In this case, the mixed-LU zone presented in the fi gure can be successfully divided into single-LU subzones for enhanced modeling accuracy. 5. Experimental results 5.1. Results of residential LU extraction from the stepwise regression are used to search the signi variables that should be included in the classi fi cation model.
Considering the percentage correct and the signi fi cance value of each indicator (which should be less than the signi fi cance level speci fi ed  X  .05), it is found that the model using all the variables selected from the Step 5 offers the best overall accuracy of 97.8% (see Table 1 ). In this case, the least number of independent variables are included, which is consistent with the principle of  X  parsimony  X  . Further, all of the following independent variables are signi fi cant: AvB_Height, Built_Ratio, FAR, P_Area, Dis_Local,
Dis_Arterial, Dis_Collector, Dis_Freeway, and Park_Ratio and they are selected and used in the residential binary logistic LU classi fi cation model.
 class is calculated based on the binary logistic model identi from the Step 5 as the following:
Pr Res  X  X  X  1 Exp where  X  i are the coef fi cients of independent variables estimated by the model and v i are independent variables/indicators selected through the Step 5 of the above test, which are listed in Table 1 . testing data set to check its prediction power. The accuracy assessments against the training and the testing datasets are then summarized in Table 2 . The results show that the classi fi model developed can accurately classify parcels into residential and non-residential LUs. Residential parcels are classi fi high accuracy of 98.8% for the training data set and 97.6% for the testing data set. The accuracy of extracting non-Res parcels is slightly lower than the Res extraction, which results in 93.5% for the training and 91.7% for the testing of the model. The overall accuracy for training and testing the model is 97.8% and 96.6% respectively.
 at the parcel level indicates that most of misclassi fi ed residential parcels are those for the medium and high density residential uses. This is because the signatures of medium and high density residential parcels are very similar to non-residential parcels such as those for commercial or institutional purposes. Moreover, visual interpretation to the spatial arrangement of residential parcels shows that almost all the residential parcels including R1 (low density), R2 (medium density), and R3 (high density) classes are close to each other. Misclassi fi cations arising from the morpholo-gical analysis are then considered in a post-classi fi cation correc-tion process using spatial arrangement analysis.

Spatial arrangement analysis proposed in Section 4.4.3 is used to correct the misclassi fi cations occurred in the morphological analysis. In this regard, parcels are clustered through the Gabriel
Graph, based on the decision rule set de fi ned, in order to create residential clusters. First, based on the LU class of the majority of parcels within each extracted cluster, a given cluster is labeled as either residential or non-residential class. Afterwards, based on the rule of majority, those parcels labeled with a different LU tag (than their associated clusters) are relabeled with the LU class of their clusters. The accuracy assessment after applying the spatial arrangement analysis is summarized in Table 3 for the sample area. The results clearly show that this exercise can increase the accuracy of extracting residential and non-residential parcels when compared to Table 2 . The overall residential classi accuracy is increased by 1.6% through such an analysis when compared to the results from the morphological analysis only.
Below is an example showing how a misclassi fi ed parcel, resulted from the morphological analysis, is correctly reclassi fi LU class of its cluster through the spatial arrangement analysis.
Fig. 9 illustrates a residential cluster which is identi fi separated from its neighbor non-residential clusters (institutional in this case) through the Gabriel Graph analysis. As shown in
Fig. 9 (a), the probability of a parcel to be in the residential class is calculated as .25 through the morphological analysis, which is less than the cut-off value (.5). Therefore, this parcel would be classi fi ed as the  X  non-residential  X  using morphological analysis alone, but it is an error. Over the spatial arrangement analysis, this parcel is found to be located in the residential cluster (shown as green in the fi gure), which means most of the surrounding parcels are residential. Using the rule of majority in the post-classi correction step, the misclassi fi ed parcel is correctly reclassi
LU class of its cluster, in this case, residential (see Fig. 9 (b)). 5.2. Results of commercial LU extraction
Five steps are used in the stepwise regression to search the independent variables which are more effective for developing the commercial LU classi fi cation model. Considering the percentage correct and the signi fi cance of each indicator (which should be less than the signi fi cance level speci fi ed (.05)), it is found that the model based on the variables identi fi ed from the Step 5 offers the best overall accuracy of 93.52% (see Table 4 ).
 Parcel  X  s properties, including Dis_CBD, Dis_Local, Dis_Collector, Dis_Freeway, Veg_Ratio, and Park_Ratio, are selected as the best indicators for the commercial LU classi fi cation. The probability of a parcel being in the commercial class is calculated based on the model of the Step 5 as the following: Pr Com  X  X  X  1 Exp  X  15 : 168  X   X  14 i  X  1 where  X  i are the coef fi cients of independent variables estimated by the model and v i are independent variables/indicators selected through the Step 5 of the above step-wise regression, which are listed in Table 4 . The above commercial LU classi fi cation model is then veri fi ed with the testing data set. The accuracy assessments against the training and the testing datasets are performed and then summarized in Table 5 .

The results show that the designed classi fi cation model can accurately classify the parcels into commercial and non-commercial LUs. The accuracy of extracting commercial parcels through the developed model is 94.0% for the training and 88.2% for the testing datasets. The results of accuracy assessment for extracting non-Com parcels for training and then testing the classi fi cation model is 93.1% and 89.2% respectively. The overall accuracy for training and testing the model is 92.4%. It should be noted that this prediction accuracy is judged as  X  high  X  training and testing datasets used here are fairly small and they cover various development forms.

Visual interpretation to the commercial LU classi fi cation results from the above morphological analysis indicates that most of misclassi fi ed commercial parcels are those with small buildings. Further, most of misclassi fi ed commercial parcels are close to other commercial parcels which are correctly classi fi ed. Therefore, it appears that spatial arrangement analysis can be used to correct such misclassi fi cations. In this regard, based on the decision rule set de fi ned in Section 4.4.2 , parcels are connected or disconnected using Gabriel Graph, in order to best extract commercial clusters.
In the morphological analysis, each parcel is independently classi fi ed into the commercial or non-commercial class. In the spatial arrangement analysis, commercial clusters are extracted. The next step is to correct misclassi fi cations arising from morphological analysis through spatial arrangement analysis.
Similar to the exercise applied to the residential parcels, based on the LU class of the majority of parcels within each extracted cluster, a given cluster is labeled as either commercial or non-commercial class. Afterwards, based on the rule of majority, those parcels labeled with a different LU tag than their associated clusters are relabeled with the LU class of their cluster. The results of accuracy assessment after the corrections are summarized in
Table 6 for the sample area. The results show a signi fi cant improvement in extracting commercial and non-commercial LUs.
The overall accuracy for extracting commercial LU increases by 4.8% through the above exercise when compared to the results of the morphological analysis for commercial parcels (see also Table 5 ).
 resulted from the morphological analysis for commercial parcels, is correctly relabeled with the LU class of its cluster. separated from its neighbor non-commercial parcels through Gabriel Graph analysis. As shown in Fig. 10 (a), there are two parcels within the commercial cluster which were classi fi non-commercial LU during the morphological analysis, where the probabilities of the two parcels belonging to the commercial class were calculated as .31 and .11 (less than the cut-off value
However, visual examination shows that these parcels were misclassi fi ed. During the spatial arrangement analysis, the mis-classi fi ed parcels are found to be in the commercial cluster, which means most of the surrounding parcels are for the commercial purpose. Using the rule of majority in the post-classi fi correction process, the misclassi fi ed parcels are relabeled auto-matically with the LU class of their associated clusters, in this case commercial (see Fig. 10 (b)). 6. Conclusions, discussions, and future plan
A principal problem faced by researchers, practitioners, and policy/decision maker in different urban applications (such as transportation planning, transportation modeling, urban policy analysis, and urban planning and modeling) is the lack of detailed/timely information regarding how urban activities and corresponding LUs distribute and evolve. The consequence is that, in most cases, planners and modelers have to work with aggre-gated LU information in their modeling exercises and therefore, suffer from the errors or inaccuracies incurred by such aggrega-tions. Most existing land use/transportation models use large zone systems, such as Census Sub-Division (CSD) and Census Tract (CT). Because of this, the accuracy of these models is often compro-mised as the economic activities are usually mixed within zones and corresponding intra-zone travel/exchanges are all ignored.
Extracting detailed subzonal LU information using remotely sensed imageries and geographic data is a choice to overcome the above issue. However, LUs, particularly in urban areas, exhibits unique natures, such as heterogeneity, complexity and abstract, which make LU classi fi cation a very challenging process. It is concluded that extracting LU information is the most challenging part of the entire image classi fi cation process, and it requires auxiliary data and additional spatial analysis. The main hypothesis of this research is that there is association/correlation rules between different man-built features and their corresponding LU structures. To understand LU patterns and feature associations, the morphological and the spatial arrangement analysis at the parcel-level are used in this study. In this regard, a hierarchical rule-based LU extraction system is developed to extract residential and commercial LUs. LU extraction at the parcel-level proposed con-sists of the following two steps: (1) parcels are fi rst classi residential or commercial LUs based on the morphological analysis and (2) misclassi fi cations occurred in the morphological analysis are corrected through post spatial arrangement analysis.
The developed LU extraction system starts to differentiate residential (Res) vs. non-residential (non-Res) parcels. Binary logistic model is regressed with the geographic and RS data to extract residential LUs. The results of residential LU classi show that the designed model can accurately classify parcels into residential vs. non-residential LUs with an overall accuracy of 97.5%. Spatial arrangement analysis further enhances the accuracy of residential LU classi fi cation to 99.1%.

The non-residential parcels identi fi ed from the above residen-tial LU classi fi cation process are then further examined to extract commercial LU. Binary logistic model is developed based on the geographic and RS data to classify commercial LU. The overall accuracy for training and testing the commercial classi fi model is 93.5% and 89.2% respectively. Extracted commercial parcels are, again, considered in a post-classi fi cation correction process using a spatial arrangement analysis. The overall accuracy for extracting commercial LU increases by 4.8% after the correction from the spatial arrangement analysis.

The above exercises show that the LU classi fi cation process at the fi ne spatial level  X  parcel can divide large zones with mixed
LUs into subzones with single/pure LUs. Dividing the zones with mixed LUs into single-LU subzones would eventually solve the intra-zonal travel and mixed activity distribution issues encoun-tered in the traditional urban modeling process. The LU extraction framework developed and reported in this paper shows a high accuracy in extracting detailed urban LUs, including residential and commercial, and therefore, it has a signi fi cant value to address the above persistent issues in the traditional modeling process. In this regard, the extracted single-LU subzones from this study can serve as the basis for an expert system to automatically design land use zones (LUZs) or traf fi c analysis zones (TAZs), so that each designed zone only contains a single LU (e.g., residential or commercial). It should be noted that developing an automated expert system for designing  X  single-LU  X  LUZ or TAZ is out of the scope of this study, which will be pursued in a future study.
The system being proposed is believed to be useful for many organizations, such as metropolitan planning of fi ces, environmen-tal protection agencies, and highway &amp; transportation authorities.
It will help the above agencies to collect detailed land cover/use information in a fast, accurate and consistent way. Heavy burden of collecting these data can be eliminated. Planning process will be expedited and improved, and consequent bene fi ts are expected. Acknowledgments This study was primarily funded by a Natural Science and
Engineering Research Council (NSERC) Strategic Project grant (STPSC 358742). The authors would like to thank NSERC, Canada for the fi nancial aid and City of Fredericton for the data used in this study.
 References
