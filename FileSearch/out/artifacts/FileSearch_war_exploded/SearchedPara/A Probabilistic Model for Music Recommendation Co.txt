 A recommender system has an obv i ous appeal i n an env i ronment where the amount of be i ng an i ntegral part of e-commerce s i tes such as Amazon, Yahoo and CDNow .

At the i n i t i al stage, a recommender system mostly rel i ed on a content-based f i lter-i ng (CBF) mechan i sm . It selects the r i ght i nformat i on for a user by match i ng the user preference aga i nst databases, wh i ch may be i mpl i c i t or expl i c i t . For example, a search eng i ne recommends web pages whose contents are s i m i lar to a user query [22] . De-sp i te the eff i c i ency of a CBF i n locat i ng textual i tems relevant to a top i c, i t i s a l i ttle descr i pt i ons such as a mus i c genre, t i tle, composer, or s i nger . In add i t i on, represent i ng a user preference or query for non-textual features i s also a b i g challenge for a mus i c recommender system (MRS) . Some researchers [6] suggested a method of query i ng an aud i o database by humm i ng . Not all users, however, have a g i ft of humm i ng the melody of the i r favor i te songs for search i ng .

Collaborat i ve f i lter i ng (CF), as i n GroupLens [16] and R i ngo [19], has been con-s i dered a ma i nstream techn i que for recommender systems for a long t i me unt i l now . aga i nst the database of user h i stor i es to d i scover other users, called ne i ghbors, who have h i stor i cally s i m i lar tastes . Items that the ne i ghbors l i ke are then recommended to the target user . For i nstance, the GAB system [22] recommends web pages based on the bookmarks ; Jeter system recommends j okes [7] ; Mov i eLens recommends mov i es ; and Flycast i ng recommends onl i ne rad i o . Most of prevalent CF systems focus on calculat i ng the user-user s i m i lar i ty to make pred i ct i ons, wh i ch i s so called user-based CF . However, Sarwar [17] has proved that i tem-based CF i s better than user-based CF on prec i s i on and computat i on complex i ty .

Desp i te the popular i ty of CF techn i ques, researchers also real i zed that the content i nformat i on of i tems d i d help prov i d i ng a good recommendat i on serv i ce . The i dea of a hybr i d system cap i tal i z i ng on both CF and CBF has been suggested . Examples i n-clude Fab[2], ProfBu i lder[21] and RAAP[4] systems .

The Fab [2] system uses content-based techn i ques i nstead of user rat i ngs to create user prof i les . S i nce the qual i ty of pred i ct i ons i s fully dependent on the content-based techn i ques, i naccurate prof i les result i n i naccurate correlat i ons w i th other users, y i eld-i ng poor pred i ct i ons . ProfBu i lder [21] recommends web pages us i ng both content-based and collaborat i ve f i lters, each of wh i ch creates a recommendat i on l i st sepa-rately to make a comb i ned pred i ct i on . Claypool [3] descr i bes a hybr i d approach for an onl i ne newspaper doma i n, comb i n i ng the two pred i ct i ons us i ng an adapt i ve we i ghted average . As the number of users access i ng an i tem i ncreases, the we i ght of the col-laborat i ve component tends to i ncrease . However, the authors do not clearly descr i be how to dec i de the we i ghts of collaborat i ve and content-based components . RAAP[4] i s a content-based collaborat i ve i nformat i on f i lter i ng system that helps the user clas-s i fy doma i n spec i f i c i nformat i on found on the WWW, and also recommends those among users, a scalable Pearson correlat i on algor i thm based on the web page category i s used .

Cluster i ng i s the key i dea of CF and a hybr i d system that rel i es on CF . The i dea of n i ques . A p i oneer i ng CF method called Pearson correlat i on coeff i c i ent method a i ms at group i ng the l i ke-m i nded users for an act i ve user . It f i rst calculates the s i m i lar i t i es between the act i ve user and others, and then clusters users i nto groups w i th s i m i lar tastes .

Probab i l i st i c models explo i t expl i c i t cluster i ng to model the preferences of the un-derly i ng users, from wh i ch pred i ct i ons are i nferred . Examples i nclude the Bayes i an cluster i ng model [1], the Bayes i an network model [1], and the Aspect model [10] . The bas i c assumpt i on of the Bayes i an cluster i ng model i s that rat i ngs are observat i ons of the mult i nom i al m i xture model w i th parameters, and the model i s est i mated by us i ng EM . The Bayes i an network model a i ms at captur i ng i tem dependency . Each i tem i s a node and dependency structure i s learned from observables . The aspect model i s based on a latent cause model that i ntroduces the not i on of user commun i t i es or groups of i tems .

Bes i des the above methods where cluster i ng i s i ntegrated i nto some probab i l i st i c or memory-based techn i ques, some researchers also apply a data cluster i ng algor i thm to the process of rat i ng data i n CF as an i solated step . O ' Conner [11] uses ex i st i ng data cluster i ng algor i thms to do i tem cluster i ng based on user rat i ngs, and then pred i ct i ons are calculated i ndependently w i th i n each part i t i on . SWAMI [5] appl i es the meta-user mechan i sm for recommendat i on by f i rst group i ng users to create the prof i le for each cluster as a meta-user, and then pred i ct i ons are calculated w i th a Pearson correlat i on method where only meta-users are cons i dered as potent i al ne i ghbors . L i [12, 14] sug-gests apply i ng a cluster i ng method to i nclude content i nformat i on for CF .

Wh i le the aforement i oned systems and methods cluster users or i tems, most of them fa i l to handle well-known problems i n CF, non-assoc i at i on, user b i as, and cold start . S i nce those three problems occur on both i tem-based and user-based CF, we address them i n the context of i tem-based CF .

The f i rst challenge i s non-assoc i at i on . For i nstance, i f two s i m i lar i tems have never been wanted by the same user, the i r relat i onsh i p i s not known expl i c i tly . In pure i tem-based CF, those two i tems can not be class i f i ed i nto the same commun i ty .
 The second one i s user b i as i n the past rat i ngs . For example, as shown i n Table1, Mus i c 3 and 4 have the same h i story i n rat i ngs . In i tem-based CF and thus have the same opportun i ty to be recommended to the user Jack by the system . If the system knows that Mus i c 1 and Mus i c 2 fall i nto the Rock category and Mus i c 3 i nto the Rock category, however, i t can recommend Mus i c 3 to Jack w i th a h i gher pr i or i ty, prov i ded that he i s known to l i ke Rock mus i c i n the past .

The th i rd one i s the cold start problem . It i s hard for pure CF to recommend a new i tem where there i s no h i story and hence no user op i n i ons on i t . Mus i c 5 i n Table 1 i s an example .
 Mus i c 1 5 4 3 Y N Mus i c 2 4 4 3 Y N Mus i c 3 4 3 Y N Mus i c 4 4 3 N Y Mus i c 5 Y N Mus i c 6 4 Y N 
In th i s paper, we descr i be a collaborat i ve mus i c recommender system (CMRS) based on our proposed i tem-based probab i l i st i c model, where i tems are clustered i nto groups and pred i ct i ons are made us i ng both the i tem cluster i nformat i on and user rat i ngs . Th i s model prov i des a way to d i rectly apply the aud i o features of mus i c ob-calculat i on of CF . Th i s method can be eas i ly extended to recommend other i tems such as mov i es, books and etc . It i s usual that rat i ng i nformat i on i n a real-world recommendat i on system i s qu i te sparse . As a result the three problems ment i oned i n the prev i ous sect i on occur qu i te often and negat i vely affect the cluster i ng result and hence recommendat i on . As shown i n Table 1, the attr i butes of i tems such as the i r genre would help us allev i ate those problems . For the non-assoc i at i on case, for i nstance, the relat i onsh i p between Mus i c 6 and others i s unknown . However, w i th the help of the mus i c genre i nforma-p i eces except Mus i c 4 . Other two challenges are s i m i larly handled by the v i rtue of genre i nformat i on .

The probab i l i st i c model we propose for our CMRS can adopt var i ous cluster i ng al-gor i thms to est i mate the parameters . Although some advanced methods such as an i ncremental cluster i ng algor i thm can be potent i ally appl i ed for a better performance and flex i b i l i ty, we use a s i mple k-Medo i ds 1 [8] cluster i ng method i n the current work . The K-Medo i ds algor i thm makes each cluster to be represented by one of the ob j ects i n the cluster, whereas a cluster i s represented by the center i n the well-known K-means algor i thm . Thus i t i s less i nfluenced by outl i ers or other extreme values than a mean . Both rat i ngs and i tem attr i butes such as genre are used as features for cluster i ng i tems i n our approach .

Observ i ng the rat i ngs of each user i n an i tem commun i ty that i n i tem-based CF sat-for CF, where i tems are class i f i ed i nto groups based on both content i nformat i on and rat i ngs .
 = and a set of poss i ble rat i ngs the rat i ng v i s based on a numer i cal scale, i t i s appropr i ate to def i ne the determ i n i st i c pred i ct i on funct i on (, ) gu y that i nd i cates the user X  X  rat i ng on the i tem y as follows: where (|,) pv u y denotes a probab i l i ty mass funct i on (d i screte case) or a cond i t i onal probab i l i ty dens i ty funct i on (cont i nuous case) dependent on the context . We i ntroduce a var i able z wh i ch can be treated as a group of i tems w i th s i m i lar features or attr i b-utes . Therefore, (|,) pv u y can be calculated as : 
S i nce i tems shar i ng s i m i lar preferences from users are clustered i nto one i tem commun i ty, most of the rat i ngs from one user i n the commun i ty w i ll fall i nto the same rat i ng range . We assume that the rat i ngs from a certa i n user on all i tems i n the commun i ty sat i sfy a Gauss i an d i str i but i on: 
Therefore, the determ i n i st i c pred i ct i on funct i on (, ) gu y that pred i cts the user X  X  rat-i ng on i tem y can be computed as: 
The user X  X  rat i ng on i tem y can be regarded as the sum of the product of , uz  X  (the average rat i ng of user u i n commun i ty z ) and the poster i or i probab i l i ty (| ) pz y wh i ch depends on the relat i onsh i p between i tem y and i tem commun i ty z . There are var i ous ways to est i mate the parameters . One of the ways to est i mate the poster i or i probab i l i ty (| ) pz y i s to use Bayes X  rule . where y V denotes the rat i ng vector of i tem y and z V denotes the centre vector of var i able z . z C and y C are the set of the commun i ty z and the set of all i tems, re-spect i vely . ( . ) ED  X  i s a funct i on of ad j usted Eucl i dean d i stance between i tems . () pz i s computed as the rat i o of the i tems fall i ng i nto the commun i ty z over all i tems . We assume that the relat i onsh i p between the i tem y and the i tem commun i ty i s deter-m i ned by the Eucl i dean d i stance . A shorter d i stance represents a closer relat i onsh i p . We found i t helpful to ad j ust the Eucl i dean d i stance of two i tems based on rat i ngs made by the same user ; i f the number of common rat i ngs made by the same user was below a certa i n threshold  X  : where yz VV h i s the number of common rat i ngs made by the same user . By do i ng th i s, the i tems w i th more common rat i ngs i n calculat i ng Eucl i dean d i stance have a h i gh cred i t . 3.1 Creat i on of Aggregate Features In order to get z V , we should create the i tem commun i ty z . A data cluster i ng method obv i ously plays an i mportant role i n creat i ng such a commun i ty . To deal w i th the three challenges i n CF i n general and cluster i ng i n part i cular, we group i tems not only based on user rat i ngs but also on the attr i butes of i tems . Our CMRS i s developed for recommend i ng r i ng tones for cell phone users . Most of r i ng tones are not tagged w i th abstract attr i butes such as genre i nformat i on . It i s also t i me-consum i ng and ted i ous to manually tag the genre i nformat i on for each r i ng tone . Therefore, we cluster i tems (r i ng tones) based on the phys i cal features such as t i mbral texture, rhythm i c content and p i tch content features to create some aggregate features, wh i ch can be treated more or less as the genre attr i bute . The cluster i ng method to transfer phys i cal features i nto aggregate features i s der i ved from K-means Cluster i ng Algor i thm [8], wh i ch i s extended i n such a way that we apply the fuzzy set theory to represent the aff i l i at i on of ob j ects w i th cl i ques (aggregate features) . The probab i l i ty of one ob j ect j (here one ob j ect denotes a p i ece of mus i c) ass i gned to a certa i n cl i que k i s where the (, ) DS j k denotes the Eucl i dean d i stance between ob j ect j and the centre of cl i que k ; (, ) Max DS i k denotes the max i mum Eucl i dean d i stance between an ob j ect and the centre of cl i que k . 3.2 Item Commun i ty Creat i on After gett i ng the aggregate features of i tems, we attach those aggregate features to the user-rat i ng matr i x as shown i n F i g 1 . As a result, we are able to bu i ld the i tem com-mun i ty z based on both rat i ngs and aggregate features .
 Our cluster i ng method for bu i ld i ng commun i ty z i s der i ved from the well-known k-Medo i ds cluster i ng algor i thm [8] . Informally, our algor i thm creates a f i xed number k , wh i ch i s the number of commun i t i es, and then creates a compos i te ob j ect prof i le for each commun i ty as the representat i ve of a commun i ty . The representat i ve i s a compos-i te i tem that i s the average of correspond i ng user rat i ngs from the members of the commun i ty . The measure we use to compute the s i m i lar i ty between ob j ects i s the Pear-son correlat i on coeff i c i ent . In effect, we are comput i ng the extent to wh i ch two i tems are s i m i lar based on the extended rat i ng matr i x as shown i n F i g . 1, wh i ch conta i ns both user rat i ngs and aggregate features . In add i t i on, we do not cons i der the effect of nega-t i ve correlat i ons, because the cluster i ng algor i thm cons i dered i s not des i gned to handle negat i ve s i m i lar i t i es . Follow i ng i s the deta i l of our cluster i ng algor i thm: 3.3 Feature Extract i on Aud i o phys i cal features extracted to create aggregate features should be helpful to d i st i ngu i sh mus i c p i eces . They can express some aspects of aud i o such as genre and rhythm . Our CMRS i s des i gned for recommend i ng r i ng tones for cellphone users, who usually select a r i ng tone by i ts rhyme . In th i s case, the aggregate features ob-ta i ned from the v i v i d rhythm i c, t i mbral and p i tch content phys i cal features are more mean i ngful to users than the textual descr i pt i on of genre .

Many of the prev i ous reports on aud i o features are based on the retr i eval of data from MIDI (Mus i cal Instrument D i g i tal Interface) corpora, where the f i les are sym-bol i zed by mus i cal scores . However, cons i der i ng the popular i ty of MP3 (MPEG Layer 3) d i g i tal mus i c arch i ves, we bu i ld our system based on aud i o features ex-tracted from a MP3 mus i c corpus .

Mus i cal genre class i f i cat i on of aud i o s i gnals has been stud i ed by many researchers [20], wh i ch gave us some h i nts i n select i ng aud i o features to d i st i ngu i sh mus i c ob j ects i n our CMRS . Three feature sets for represent i ng t i mbral texture, rhythm i c and p i tch content were proposed, and the performance and relat i ve i mportance of the proposed features was exam i ned by our system us i ng real-world MPEG aud i o corpus .
 Timbral Texture Features. are based on the standard features proposed for mus i c-speech d i scr i m i nat i on [20] as follows .  X  Mel Frequency Cepstral Coeff i c i ents (MFCC): They are a set of perceptually  X  Spectral Centro i d: It i s the balanc i ng po i nt of the subband energy d i str i but i on  X  Spectral rolloff po i nt: It i s used to d i st i ngu i sh vo i ce speech from unvo i ced  X  Spectral Flux: It determ i nes changes of spectral energy d i str i but i on of two  X  Sum of scale factor (SSF): the loudness d i str i but i on for whole durat i on .
 Rhythmic Content Features. for represent i ng rhythm structure are based on detect i ng the beat h i stogram, from wh i ch s i x features are calculated to represent rhythm i c content .  X  A0, A1: relat i ve ampl i tude of the f i rst and second h i stogram peak ;  X  RA: rat i o of the ampl i tude of the second peak d i v i ded by the ampl i tude of the  X  P1, P2: per i od of the f i rst, second peak i n bpm ;  X  SUM: overall sum of the h i stogram ( i nd i cat i on of beat strength) .
 Pitch Content Features. descr i be the melody and harmony i nformat i on about mus i c s i gnals and are extracted based on var i ous p i tch detect i on techn i ques [20] . Bas i cally the dom i nant peaks of the autocorrelat i on funct i on, calculated v i a the summat i on of envelopes for each frequency band obta i ned by decompos i ng the s i gnal, are accumu-lated i nto p i tch h i stograms and the p i tch content features are then extracted from the p i tch h i stograms . The p i tch content features typ i cally i nclude: the ampl i tudes and per i ods of max i mum peaks i n the h i stogram, p i tch i ntervals between the two most prom i nent peaks, the overall sums of the h i stograms . Because the d i fferent magn i tude of features, we mapped all aud i o features i nto [0 1] . Exper i ments were carr i ed out to observe the recommendat i on performance of our approach, espec i ally i n compar i son w i th other methods, and to determ i ne the parame-ter values i n our approach . Exper i mental data came from a real-word mus i c corpus that cons i sts of sample f i les of mob i le phone r i ng tones for campus users of Harb i n Eng i neer i ng Un i vers i ty . It has 760 p i eces of mus i c and 4,340 i nteger rat i ngs rang i ng from 1~5 made by 128 users . The mus i c i s stored as 22050Hz, 16-b i t, mono MP3 aud i o f i les . Each p i ece of mus i c lasts for about 10~20 seconds wh i ch i s extracted from i ts correspond i ng ent i re song . The ent i re mus i c data i s categor i zed i nto 9 genres (Class i cal, Jazz, Rock, H i p-Hop, Country, D i sco, Metal, Ch i nese Popular, and Ch i -nese Trad i t i onal Class i cal) . 4.1 Evaluat i on Metr i cs MAE (Mean Absolute Error) has w i dely been used i n evaluat i ng the accuracy of a recommender system . It i s calculated by averag i ng the absolute errors i n rat i ng-pred i ct i on pa i rs as follows: between the test data and the pred i ct i on result . A lower MAE means a greater accu-racy . Allbut1 [1] protocol was appl i ed to evaluate the obta i ned pred i ct i on accurac i es . More prec i sely, we randomly left out exactly one rat i ng for every user who possesses at least two rat i ngs . Not i ce that th i s uses somewhat less data than requ i red, but allows us to use a s i ngle model to evaluate the leave-one-out performance averaged over all users . We have repeated the leave-one-out procedure 25 t i mes w i th d i fferent random seeds . The reported numbers are the mean performance averaged over those runs . 4.2 Commun i ty S i ze cluster i ng phase, we class i fy the ob j ects i nto k groups . In the case that k equals to 1, i t means that all ob j ects are treated as one commun i ty . In f i gure 2, i t i s observed that the number of commun i t i es affects the qual i ty of pred i ct i on to a great extent, and the opt i mal performance i s ach i eved w i th k=50 .
 4.3 Aud i o Features The performance of our CMRS rests on the valuable i nformat i on extracted from aud i o features . In our approach, we i ntegrate th i s i nformat i on by creat i ng aggregate fea-tures . Another factor that had to be determ i ned was the number of aggregate features wh i ch m i ght be also sens i t i ve to the performance . However, we found that the rec-ommendat i on performance i s not very sens i t i ve to the number of aggregate features . It only makes the performance d i fference of less than 0 . 02, as shown i n F i gure 3 . In our exper i ments, we set i t to 40 .
 4.4 Overall Performance In order to observe the contr i but i on of content i nformat i on of mus i c ob j ects, we i m-plemented a standard memory-based method, a S i mple Pearson method [1], and a standard i tem-based CF [17] method to be compared w i th our approach . As shown i n Table 2, our approach has a better performance than the others, wh i ch i nd i cates we can get useful i nformat i on from aud i o features of mus i c .
 How Do the Audio Features Affect Performances? In order to observe the perform-ance and relat i ve i mportance of the proposed features, we carr i ed out a ser i es of ex-per i ments . In other words, we constructed the aggregate features by i nd i v i dual aud i o phys i cal features . As shown i n F i gure 4, i t i s clear to observe that MFCC, Centro i d and RollOff are a l i ttle more effect i ve than other feature sets .

We then carr i ed out a ser i es of exper i ments w i th a comb i nat i on of two aud i o fea-tures to construct the aggregate features . From these exper i ments, we f i nd that the comb i nat i on of MFCC and Rhythm ach i eve a better performance than other comb i na-t i ons . We further carr i ed out our exper i ments us i ng the comb i nat i on of three aud i o features to construct the aggregate features . The conclus i on i s that the comb i nat i on of MFCC, RollOff and Rhythm shows the best performance over all other comb i nat i ons of three aud i o features, as shown i n F i gure 5, where No . 1, 2and 3 refer to MFCC, RollOff and Rhythm accord i ngly . In F i gure 5, the word "Genre" represents that us i ng the textual genre descr i pt i on for recommend i ng the r i ng tone i nstead of the aggregate features of aud i o p i eces . The aggregate features obta i ned from the phys i cal features of aud i o p i eces shows a better performance than the textual genre descr i pt i on . It reveals that mob i le phone users select the i r preference not based on the genre i nformat i on but on other phys i cal features such as rhythm, t i mbre and p i tch . By real i z i ng th i s, our CMRS i s des i gned to apply both phys i cal features of mus i c and user rat i ngs for better personal i zed recommendat i on .
 In th i s paper, we descr i bed a collaborat i ve mus i c recommender system for onl i ne mob i le phone r i ng tones . It i s based on our proposed i tem-based probab i l i st i c model, where i tems are class i f i ed i nto groups or commun i t i es and pred i ct i ons are made for users cons i der i ng the Gauss i an d i str i but i on of user rat i ngs . Th i s model prov i des a way user b i as from h i stor i cal rat i ngs, and cold start problems, by d i rectly apply i ng the phys i cal aud i o features of mus i c ob j ects for personal i zed recommendat i on . Our ex-per i ments show that the proposed method outperforms the two other standard meth-ods . In add i t i on, we learned that the number of commun i t i es resulted from cluster i ng i s an i mportant factor for effect i veness of the proposed method .

