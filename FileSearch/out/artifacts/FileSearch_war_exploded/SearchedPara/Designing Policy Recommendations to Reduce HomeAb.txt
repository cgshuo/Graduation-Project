 Infonavit 1 , the largest provider of mortgages in Mexico, as-sists working families to obtain low-interest rate housing so-lutions. An increasingly prevalent problem is home aban-donment: when a homeowner decides to leave their property and forego their investment. A major causal factor of this outcome is a mismatch between the homeowner X  X  needs, in terms of access to services and employment, and the location characteristics of the home.

This paper describes our collaboration with Infonavit to reduce home abandonment at two levels: develop policy rec-ommendations for targeted improvements in location char-acteristics, and develop a decision-support tool to assist the homeowner in the home location decision. Using 20 years of mortgage history data combined with surveys, census, and location information, we develop a model to predict the probability of home abandonment based on both indi-vidual and location characteristics. The model is used to develop a tool that provides Infonavit the ability to give ad-vice to Mexican workers when they apply for a loan, evaluate and improve the locations of new housing developments, and provide data-driven recommendations to the federal govern-ment to influence local development initiatives and infras-tructure investments. The result is improving economic out-comes for the citizens of Mexico by pre-emptively identifying at-risk home mortgages, thereby allowing them to be altered or remedied before they result in abandonment.  X  This work was done at the 2015 Eric &amp; Wendy Schmidt Data Science for Social Good Summer Fellowship at the Uni-versity of Chicago.
Instituto del Fondo Nacional de la Vivienda para los Tra-bajadores (National Institute of Housing Fund for Workers) Figure 1: Abandoned and vandalized house (Zumpango, Mexico)
Home abandonment refers to a homeowner X  X  decision to leave their property and forego the financial investment they have already made in the home. This decision imposes nega-tive financial and economic consequences for both individu-als and mortgage-financing institutions in Mexico, as well as imposing significant negative externalities on the neighbor-hood. To date, home abandonment has affected more than 200,000 homes, representing approximately 5% of the homes financed by Infonavit. As the largest provider of mortgages in Mexico, Infonavit serves approximately 70% of the mort-gage market in the country. It was created as a public in-stitution for the purpose of assisting lower-income families, who cannot obtain financing from private financing institu-tions, with home acquisition and other housing solutions.
In Mexico, every employer registered in the National So-cial Security Institute is required to contribute 5% of each worker X  X  salary to Infonavit, which administers the contri-butions as a savings account. When employees meet certain Figure 2: Neighborhoods with high abandonment rate have also high crime rates, which forces the local population to gate entire streets (Zumpango, Mexico) criteria, they are eligible to apply for a credit, typically to buy a new house.[4]
Most workers who acquire a house through an Infonavit loan come from low-income families. Faced with economic constraints, they tend to buy cheaper houses which are lo-cated at a distance from city centers, often in new housing developments in remote suburbs with limited infrastructure and limited access to services and amenities. At the time of purchase, workers may be poorly informed about the day to day realities of their choice. For example, they may fail to properly account for the time and cost involved in commut-ing to their employment or schooling. It is often the case that families only realize the location does not satisfy their needs after they have moved into their new home, leading to a decision to abandon the house. Previous research indi-cates that workers abandon their home for several reasons, including long distances to their workplaces and schools, a lack of services, finances, and security concerns.
Infonavit wants to reduce home abandonment, but the current process is reactive and often too late. Loan holders who stop making payments enter a portfolio of low perform-ing loans. Then, payment collectors visit each home and through a lengthy process of extensions and repeated home visits the home is marked as abandoned. This process takes approximately 12-18 months. At this stage the abandoned houses may have already motivated neighbors to leave their house behind as well and neighborhood regeneration pro-grams may be too late to be effective.
This project has the primary objective of reducing home abandonment in Mexico. We address this in two ways: 1. Enable Infonavit to predict the risk of home abandon-2. Provide policy recommendations to the government us-
The first objective is achieved by building a machine learn-ing model that, given an individual applying for a loan and a home location, can predict the risk of abandonment. By evaluating the risk scores over the homes in the individual X  X  choice set, Infonavit can provide advice by identifying which homes would have a lower risk of abandonment in the future. The second objective is to understand the impact of specific location features on home abandonment. Extensive research carried out by Infonavit indicated that distance to employ-ment, and access to facilities such as schools, hospitals and grocery stores were instrumental in the home abandonment decision. What was less well understood was the relative impact of each of these factors, and the maximum distance thresholds that workers were willing to travel. Access to this information will enable Infovanit to improve the location of new housing developments, give data-backed recommenda-tions to the federal government to influence public policy, and provide guidance to improve the home location deci-sions of Mexican workers.

We believe that these two actions will help prevent the es-tablishment of settlements with high abandonment rates as portrayed in figure 1 and 2. Currently, revitalization eforts in areas with high abandonment rates only begin after the problem has become apparent for years.
Overall, we formulate the abandonment risk prediction problem as a binary classification problem where the out-come variable is whether a person abandons their house. We model this outcome for each year after the loan is granted, either until the end of the observation period or until the home is abandoned.

An alternative is to model the percentage of abandonment for a specific colonia 2 . This would not serve our objectives since the analysis would no longer be focused on the individ-ual decision of a person to abandon their house. Estimation at the colonia level would also require aggregating individual level data to a representative average person, and we would lose the information from individual level variation. Fur-thermore, as the specific addresses of houses are unknown for a large portion of the data, attempts to geocode these houses were unsuccessful due to the low quality of the ad-dress fields 3 .
To investigate the factors that contribute to home aban-donment, we combined data from multiple sources. The pri-mary level of observation is at the individual home owner. This is supplemented with multiple data sources that cap-ture the location characteristics of the house.
The primary data provided by Infonavit includes personal, loan, and house characteristics for every loan granted in the last 20 years. The personal characteristics include demo-graphics such as age and marital status, and financial infor-
Neighborhood
It X  X  important to note that while we are predicting at a home level (to asess which homes are likely to be abandoned in the next year) many of our features are at different levels of aggregation, from the home level up to the municipality level mation such as wage and the value of accumulated savings. The data also includes a Risk Index computed by Infonavit which estimates the risk of employment loss for every credit-holder. The information on the terms of the loan included the interest rate, the value of the loan, and the value of any subsidy received.

We transformed the data so that the unit of observation is at the house level rather than the individual loans, since it is possible for a family to have two loans for a house. We combined their savings and assets so that each observation is representative of one home with its associated character-istics. We excluded joint loans that had mismatched years or prices for the same house. Loans cofinanced with pri-vate banks, loans that were granted for the purpose of home improvement, and loans with entries that did not match up with other data sources provided by Infonavit (such as guide-lines corresponding to the age of the loan holder) were also excluded. After this cleaning process, we have 4.1 million observations at the house level.

One field in the data that is often missing is the exact location of the house. Unfortunately, geo-coordinates were only available for loans granted in the last 7 years (since 2008), and attempts to geocode the rest of the houses were unsuccessful due to the low quality of the address field. To deal with this practical constraint, we matched loans to colo-nias 4 using different approaches. A detailed description of this process is described in section 4, Location Matching.
Home abandonment is recorded as a flag in our data but the exact date of abandonment is often unknown. Our loan data (where the abandonment label is located) presents a snapshot of the state of abandonment as of May 2015 and the abandonment flag tells us whether the home is abandoned as of that date. neighborhoods in Mexico
The abandonment flag can be triggered by different cir-cumstances. The loan repayment occurs through the social security system directly from the employer. Payments cease when a person loses their job, and continue with the up-take of new employment. It is also possible that the person never regains any form of formal employment and joins the informal sector in Mexico. In the first case, a house will be marked as abandoned or vandalized when an inspector visits a colonia. In the second case of no payments, after a grace period an inspector visits the house and tries to locate the owners. Both circumstances are equally devastating for the livelihood of their former owners as well as the remaining occupants in the colonia.

Approximate dates of home abandonment were calculated based on supplemental payment data provided by Infonavit, which recorded payments made for every active loan dur-ing the 2010-2014 time period. We assumed that the first interruption in the payments represented the date of home abandonment. There were 4 types of events which were used to identify an interruption in payments: 1. Date of the application for loan extension granted (59%) 2. Date of the first interruption in the payment stream 3. Date of last payment received (11%) 4. Date the home is marked as abandoned but no single For 14% of the data we could not find a pattern and excluded these observations from the study.
Infonavit also shared the results of home surveys (ECUVE 5 conducted by licensed inspectors. This measured housing quality at the municipality 6 level. ECUVE provides an in-
Evaluaci  X on cualitativa de la vivienda y su entorno (Quan-titative evaluation of housing and its environment)
Municipality is the administrative division of states in Mex-ico dex of housing quality based on factors such as construc-tion quality, reliable water and power supply, local access to schools and hospitals, and availability of parks and markets.
Previous research conducted by Infonavit indicated that distance to employment was among the top factors that drive home abandonment. To account for this, we incorpo-rated data from DENUE 7 in our analysis. Every five years, INEGI 8 conducts a census of businesses in Mexico, covering businesses from small grocery stores to multinational cor-porations. For each business, information such as industry, number of employees, owner, address, and geolocation co-ordinates is recorded. The data also includes schools and hospitals. The study is updated annually. 9
Finally, we included extensive data on the folliwing mu-nicipality characteristics:
All the municipality level data comes from INEGI (except for the natural disasters incidence data, which comes from Desinventar [1]). INEGI X  X  datasets are publicly available for download [2].
Most of the data available to us is collected annually, except for the Population Census, which occurs every five years. This represented a challenge for feature creation, de-scribed in the next section. The loans dataset spans the last 20 years, but house coordinates were only available for loans granted after 2008. Given that location features were crit-ical to our objectives, the scope of the project was limited to loans granted from 2008 to 2015. A timeline of the data is presented in Figure 4.
One of the biggest challenges for our project was to ge-olocate granted loans. Since our model depends on spatial-temporal features (e.g. number of schools within 5 Km), we need to obtain coordinates for each loan to be able to com-pute those features.

Our loans dataset contains more than 4.1 million rows, but location information (coordinates and/or address) is avail-able for only 2 Million (49%) observations. To geolocate
Directorio Estad  X  X stico Nacional de Unidades Econ  X omicas (National Statistical Index of Economic Units)
Instituto Nacional de Estad  X  X stica y Geograf  X  X a (National In-stitute of Statistics and Geography)
Every five years the study is carried out from scratch and every year only a subset of the data (80% of the GDP) is updated. For detailed methodology information refer to [3] address data, a common approach is to obtain geographi-cal coordinates using a geocoding service. In the U.S., for example, the Census Bureau has a geocoding API[7] that given an address returns its coordinates.

Unfortunately, there is no official service for geocoding ad-dresses in Mexico. One of the alternatives is to use Google Maps Geocoding API[6]. The first limitation with Google X  X  service is the rate limit of 2,500 requests per day. Further-more, the service is not as accurate as in the U.S., mostly because many Infonavit housing developments were built re-cently and are still not mapped by Google.

With that in mind, we decided to geolocate at the colonia-level only and group together all houses in the same colonia in a point located at the colonia X  X  centroid.
The first step to match loans (4.1 million) with their corre-sponding colonia, is to filter those that have at least address information (some have coordinates).

The next step was to match loans that had geographical coordinates with their corresponding colonia, this was done using PostGIS spatial queries. We matched 740 000 loans using this method. After that we tried locating non-matched loans by finding their closest matching-loan and assigning the same colonia, this process was limited to a distance up to 1km.

The next step to attempt to locate more loans was to use the address field. For each non-matched loan, we compared it to the matched ones and assign the same colonia if the address was the same. We made this comparison using a simple string comparison. Due to time constraints we didn X  X  implement a more robust approach such as entity resolution. In the end we were able to geolocate 2.4 million records (58.5% of total loans).
Once we received and cleaned the data (preprocessing such as translation and deflation to account for time variation) and finished the location matching process, we proceeded to build features. Each type of features required a different process, which is described in the following subsections.
Except for the Population Census, all municipality fea-tures are collected yearly. Since some years were missing, the missing values were imputed using linear extrapolation (e.g. to impute a feature for 2010, extrapolate using data from 2008 and 2009). Another approach could be to use interpolation (e.g. to impute a feature for 2010, interpolate using data from 2009 and 2011), this method was rejected since using data from the future (in 2010, we don X  X  know the value for 2011 features) would violate our testing and training split paradigm.

Municipalities in Mexico do not have a uniform distri-bution in terms of area or population. For example, the most populated municipality (Ecatepec) has more than 1.5 million inhabitants, whereas the least populated one (Santa Magdalena Jicotl  X an) has only 102 inhabitants, in term of land area, the biggest municipality (Ensenada) has an area of roughly 52,000 km 2 and the smallest municipality (San Lorenzo Axocomanitla) has only 4.2 km 2 . To account for this, features involving discrete counts were normalized over 100,000 inhabitants (e.g. number of homicides, births, deaths, households). 10
Location features were critical to our project. They were of strategic value to provide actionable policy recommenda-tions to our partner. Our personal impressions supported this during a site visit to a neighborhood with high aban-donment (Zumpango, Mexico). The requirement is to have features that capture the state of the local services and in-frastructure in a comparable way across Mexico. We chose to aggregate several types of businesses separately for each colonia, and at various radii (from 0 to 5 km, 5 to 10 km, up to 45 to 50 km). The number of employees for busi-nesses within each concentric circle was also counted. It is an approximation of the actual infrastructure, nevertheless it should be representative across the state.

The accurate distance calculation between approximately 50,000 colonias, spanning some 4 million businesses across Mexico is an extensive endeavor. As we had no road net-work data to calculate the actual walking or driving time we relied on the air distance corrected by the spheroid distance. Without accounting for the curvature of the earth we might introduce noise in our geometrical aggregation bins, when a business might be counted differently depending on the distance. The challenge that arose was that a single feature calculation for a colonia took between 1 to 5 seconds, de-pending on the density of businesses. We developed a plsql extension parallelsql 11 for PostgreSQL that allows these dis-tance calculations to be executed in parallel, decreasing the required calculation time by the number of cores available to the database. The input data is partitioned by the primary key in split up in chunks of colonia groups. A load bal-ance implementation submits the chunks to the cores of the database and waits until a sub part is finished and submits the next one until all features are calculated.
Personal and loan features were used for each observa-tion with new aggregate features created to characterize each
INEGI 2010 Population census https://github.com/k1aus/parallelsql colonia, taking the colonia average, minimum and maximum for both personal and loan features.
Following the feature engineering step, a master feature table was built to contain all features, with each row having one single loan-year and the following features: Our model was created to answer the following question: What is the risk of abandonment for an existing loan in the next year?
We trained a variety of machine learning models on dif-ferent years and then tested on active loans in the following year (e.g. training from 2008 to 2014 and testing on loans active during 2015). The algorithms tested were Support Vector Machines, Random Forests, AdaBoost, and Logistic Regression.
In order to accurately model the effect of loan duration on home abandonment and to be able to easily split our training and testing sets correctly, we duplicated records for each loan from the granting time until the abandonment year (e.g. for a loan granted in 2008 but abandoned in 2010, there will be 3 rows, one for each year), with the most recent row having the abandoned flag as true.
To evaluate our models, we had to ensure that we were not violating time-dependent knowledge restrictions between our training and test set. This means using the known economic conditions at the time of evaluation rather than at testing Figure 5: Training (2008-2013)/Testing (2014-2015) splitting example time. For example, if we wanted to predict home abandon-ment for 2015, the only information available would be up until 2014, since later information would be using data from the future.

Figure 5 shows a data split using data from 2008 to 2013 for training and 2014 to 2015 for testing. A continuous line means the observation is considered to be inhabited, while a dashed line means the observation is considered abandoned.
To train our models we used scikit-learn[5], a Python li-brary that contains many algorithms for binary classifica-tion.
Because of the time restrictions on accurate home loca-tion data, and our approximation of dates of home aban-donment (explained in previous sections), our final models was trained using data from 2008 to 2014 and tested on 2015. This resulted in a 95 to 5 negative to positive class ratio. To tackle this imbalance we oversampled the positive class in our training set to have 50% positive observations, while leaving the test set untouched. Our main evaluation metric was chosen to be AUC given it X  X  interpretation as the probability that a classifier will rank a randomly chosen positive instance higher than a randomly chosen negative one, which could be directly applied to the ranking of risk for multiple loans.
Our best performing model was a Random Forest which achieved an AUC of 0.70 as shown in Figure 6. With a 0.5 threshold, the model captured 55% of abandoned houses. Given the inherent imbalanced nature of the data, this model produced 266,670 false positives in comparison to 4602 true abandoned houses.

While the predictive power of our model is limited, the top predictors (see subsection 7.2) provide substantial deep insights into the data and provide guidance on where re-sources need to be allocated to address the problem of home abandonment (see section 8.2).

Several factors contribute to the model X  X  limited perfor-mance (see subsection 7.3), and suspect that the vast ma-jority of them relate to the fidelity and quality of the data. To address this, we provided Infonavit with a series of data collection recommendations (see section 8.1) to aid in the improvement of the performance of the current model.
Trained models consistently show the same sets of fea-tures as important to predict home abandonment. Table 1 shows the top features regarding inherent personal and loan characteristics and Table 2 shows the top features that can potentially be impacted through policy.
Determining accurate coordinates of homes was a ma-jor limitation we encountered while attempting to precisely compute location features (such as distance to nearest em-ployment areas). Since we only had exact coordinates for about 740,000 of 4.1 million loans, the most accurate loca-tion we could calculate for homes with missing location data was the center of the colonia in which they were located. Using various fuzzy matching methods we retrieved colo-nia locations for 2.4 million loans, still missing around 1.7 Table 2: Top predictors that can be improved through policy changes million. This location approximation introduced a substan-tial amount of noise into our location features since colonias can stretch multiple kilometers and we had no indication of where a given home was located inside each colonia.
The poor location information created two problems for our analysis. First, we were unable to compute actual dis-tances to nearby businesses in meters, and instead opted to count the number of businesses within distance rings. Sec-ond, since we were unable to locate an individual loan within a colonia, we could not compute intra-colonia features which could have helped our model distinguish between homes (es-pecially those with similar loan information) in a given colo-nia.

Related to the distance features, our model strongly de-pends on DENUE. This process to update this dataset is carried out every 5 years, so it is possible that the current model does not capture all the economic changes that occur year to year.

Limitations related to data acquisition include our inabil-ity to obtain public transportation information (e.g. loca-tion of bus stops) and an inability to obtain accurate em-ployment information and location for each loan holder.
Another limitation is the uncertainty of abandonment date within official Infonavit records. Home abandonment is a complex process, so establishing the exact timestamp of when a home was abandoned would is difficult if not im-possible without all houses being checked consistently. The only timestamp we had originally from the raw data was the year in which the loan was granted. For our models, the abandonment year needed to be estimated from the loan payment history data.
The predictive model (Figure 7) was deployed as a web application which estimates the risk of abandonment for the next year based only on personal characteristics and a se-lected colonia for the home. The process to make a predic-tion is as follows: 1. User selects a colonia 2. User inputs personal characteristics (age, Risk Index 3. The web application retrieves the loan characteristics 4. Municipality and location features are retrieved from 5. The aggregated features are run through the trained
Our model made a modest but substantive improvement in home abandonment prediction compared to a baseline model of Infonavit X  X  internal Risk Index alone. Before our project, the institute had no way to estimate the risk of home abandonment at the loan level. Taking advantage of the insights found, Infonavit will be able to take the following actions: 1. Advise Mexican workers when they are applying for 2. Prevent the spread of home abandonment in certain 3. Improve planning for new developments. Infonavit 4. Influence public policy at the federal level. Solving
To improve the model X  X  ability to accurately predict aban-donment, we recommend Infonavit make certain improve-ments in the data collection process. Most important is to collect precise geographic coordinates for all houses. Since location related features are important predictors of home abandonment, it is critical to improve the quality of this data.

The second recommendation is to start collecting the loan holder X  X  employment location and school location data. Ac-cording to previous Infonavit research, commuting time is a top reason for home abandonment, so incorporating this information in the model will provide new insight and may have a significant effect in the model performance.
The interval ECUVE score created at Infonavit is a top predictor of home abandonment but there were many miss-ing values in some component variables (ECUVE measures different variables such as transportation, access to water, parks, markets and aggregates them to provide an overall score). Some were unsuitable for use in our models. Given the promise of the overall ECUVE score as a predictor, it is important to improve the quality of the ECUVE data. One priority could be to increase the sample size to include more municipalities in the country.
 Our last recommendation is in regards to the time records. Since the desired output of a model is the risk of abandon-ment with respect to a change in time (in the current model we predicted abandonment in the next year), it is important to improve the temporal data quality, meaning that Infon-avit needs to record important events with more precision such as month of loan granting and if possible, the month of abandonment. At the start of the project the only raw timestamp recorded at Infonavit was the loan granting year. We thus needed to approximate the date of abandonment in order to accurately consider the change in our features over time (e.g. number of jobs within 10 km in 2012 versus 2013). This introduced noise in our model, thus severely affecting the performance.
Infonavit cannot change public policy as an individual ac-tor, but has a close relationship with the federal government and can advise the them and influence other players to do so. With a considerable spectrum of possible policy changes yet limited resources to deploy them, having a data-backed starting point is crucial to tackling home abandonment.
Our recommendation pinpoints the need for a focus on local rather than regional growth. Our model found that the critical distance for services is within 5 km, so creating large centralized employment and educational centers at distances further than 5km from colonias would not have a significant impact on reducing home abandonment.

Home abandonment is not an intermittent phenomenon across time, instead it spreads inside neighborhoods, so we encourage Infonavit to allocate resources for urban regener-ation and intervention programs in neighborhoods that al-ready have higher percentages of abandonment.
This project would not have been possible without the financial support provided by the Schmidt Family Founda-tion, making not only this project possible, but also another eleven in the Data Science For Social Good (DSSG) pro-gram.

We would also like to thank DSSG staff for making the program possible and for all the support provided through-out the summer. Their hard work inspired us every day to do our best and to make an impact.

Finally, we are grateful to Infonavit for trusting and ac-tively working with the team to provide valuable insights. We hope our results help the institution better accomplish its social mission and improve the quality of life for many families in Mexico.
Rayid Ghani (University of Chicago, email: rayid@uchicago.edu ) and Jos  X e Carlos Gonz  X alez (Infonavit, email: josecarlosgonz@gmail.com ). [1] Desinventar. Inventory system of the effects of [2] INEGI. Descarga masiva. [3] INEGI. Directorio estad  X  X stico nactional de unidades [4] Infonavit. Qu  X e hago para cumplir. http: [5] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, [6] Google. The Google Maps Geocoding API. [7] United States Census Bureau. Geocoder.
