 Assessing the association between DNA variants and disease has been used widely to identify regions of the genome and candidate genes that contribute to disease [1]. 99.9% of one individual X  X  DNA sequences are identical to that of another person. Over 80% of this 0.1% difference will be Single Nucleotide Poly-morphisms, and they promise to significantly advance our ability to understand and treat human disease. In a short, an SNP is a single base substitution of one nucleotide with another. Each individual has many single nucleotide polymor-phisms that together create a unique DNA pattern for that person. It is impor-tant to study SNPs because they represent genetic differences among humans. Genome-wide association studies requir e knowledge about common genetic vari-ation and the ability to genotype a sufficiently comprehensive set of variants in a large patient sample [2]. High-throughput SNP genotyping technologies make massive genotype data, with a large number of individuals, publicly available. Accessibility of genetic data make genome-wide association studies for complex diseases possible.

Success stories when dealing with dis eases caused by a single SNP or gene, sometimes called monogenic diseases, were reported. However, most complex diseases, such as psychiatric disorders, are characterized by a non mendelian, multifactorial genetic contribution with a number of susceptible genes interacting with each other [3,4]. A fundamental issue in the analysis of SNP data is to define the unit of genetic function that influences disease risk. Is it a single SNP, a regulatory motif, an encoded protein subunit, a combination of SNPs in a combination of genes, an interacting protein complex, or a metabolic or physiological pathway [5]? In general, a single SNP or gene may be impossible to associate because a disease may be caused by completely different modifications of alternative pathways, and each gene only makes a small contribution. This makes the identifying genetic factors difficult. Multi-SNP interaction analysis is more reliable but it X  X  computationally infeasible. In fact, a 2-SNP interaction analysis for a genome-wide scan with 1 million SNPs requires 10 12 pairwise tests. An exhaustive search among multi-SNP combination is computationally infeasible even for a small number of SNPs. Furthermore, there are no reliable tools applicable to large genome ranges that could rule out or confirm association with a disease.
 It X  X  important to search for informative SNPs among a huge number of SNPs. These informative SNPs are assumed to be associated with genetic diseases. Tag SNPs generated by multiple the linear regression based method [6] are good in-formative SNPs, but they are reconstruction-oriented instead of disease-oriented. Although the combinatorial search method [7] for finding disease-associated multi-SNP combinations has a better result, the exhaustive search is still very slow.

Multivariate adaptive regression splines models [8,9] are related methods used to detect associations between diseas es and SNPs with some degree of success. However, the number of selected predictors is limited and the type of possible interactions must be specified in advance. Multifactor dimensionality reduction methods [10,11] are developed specifica lly to find gene-gene interactions among SNPs, but they are not applicable to a large sets of SNPs.

The random forest model has been expl ored in disease association studies [12]. It was applied on simulated case-control data in which the interacting model among SNPs and the number of associated SNPs were specified, thus making the association model simple and the association relatively easier to detect. For real data, such as Crohn X  X  disease [13], multi-SNP interaction is much more complex which involves more SNPs.

In this paper, we first propose an optimum random forest model for searching the most disease-associated multi-SNP combination for given case-control data. In the optimum random forest model, we gen erate a forest for each variable (e.g. SNP) instead of randomly sel ecting some variables to grow the classification tree. We can find the best classifier (a combination of SNPs) for each SNP, then we may have M classifiers if the length of the genotype is M . We rank classifiers according to their prediction rate and assign a weight for each SNP, and in such way we can decide which SNP is more disease-associated.
 We next address the disease susceptibility prediction problem [14,15,16,17]. This problem is to assess accumulated information targeted to predicting geno-type susceptibility to complex diseases with significantly high accuracy and sta-tistical power. We use the most disease-associated multi-SN Ps (generated from the optimum random forest) to grow a random forest and make the genetic sus-ceptibility prediction. The proposed method is applied to two publicly available data: Crohn X  X  disease [13] and autoimmune disorder [18]. The accuracy of the prediction based on the optimum random forest is higher than the accuracy of all previously known methods implemented in [14,15].

In the next section we will overview th e random forest tree and classifica-tion tree, describe the genetic model, address the problem of searching of most disease-associated multi-SNP and propose the optimum random forest algorithm to find the combination of SNPs which are most associated with diseases. In Section 3 we give the disease susceptibility prediction problem formulation and describe the random forest algorithm. In Section 4 we describe the two real case/control population samples and discuss the results of our experiments. In this section we first give an overview of the random forest tree and classi-fication tree, then we will describe the genetic model. Next we formulate the problem of searching for the most disease-associated multi-SNP and propose the optimum random forest algorithm. 2.1 Classification Trees and Random Forests In machine learning, a Random Forest is a classifier that consists of many clas-sification trees. Each tree is grown as follows: 1 If the number of cases in the training set is N ,sample N cases at random 2Ifthereare M input variables, a number m M is specified such that at 3 Each tree is grown to the largest extent possible. There is no pruning [19]. A different bootstrap sample from the original data is used to construct a tree. Therefore, about one-third of the cases are left out of the bootstrap sample and not used in the construction of the tree. Cr oss-validation is not required because the one-third oob (out-of-bag) data is used to get an unbiased estimate of the classification error as trees are added to the forest. It is also used to get estimates of variable importance. After each tree is built, we compute the proximities or each terminal node.
In every classification tree in the forest, put down the oob samples and com-pute the importance score for each tree based on the number of votes cast for the correct class. This is the i mportance score for variable m . All variables can be ranked and those important variables can be found in this way.

Random forest is a sophisticated method in data mining to solve classification problems, and it can be used efficiently in disease association studies to find most disease-associated variables such as SNPs that may be responsible for diseases. 2.2 Genetic Model Recent work has suggested that SNP X  X  in human popul ation are not inherited independently; rather, sets of adjacent SNP X  X  are present on alleles in a block pattern, so called haplotype . Many haplotype blocks in human have been trans-mitted through many generations without recombination. This means although a block may contain many SNP X  X , it takes only a few SNP X  X  to identify or tag each haplotype in the block. A genome-wide haplotype would comprise half of a diploid genome, including one allele from each allelic gene pair. The geno-type is the descriptor of the genome which i s the set of physical DNA molecules inherited from the organism X  X  parents. A pair of haplotype consists a genotype.
SNP X  X  are bi-allelic and can be referred as 0 for majority allel and 1, other-wise. If both haplotypes are the same allele, then the corresponding genotype is homogeneous, and can be represented as 0 or 1. If the two haplotypes are different, then the genotype is represented as 2.

The case-control sample populations consist of N individuals which are rep-resented in genotype with M SNPs. Each SNP attains one of the three values 0,1, or 2. The sample G is an (0 , 1 , 2)-valued N  X  M matrix, where each row corresponds to an individual, each column corresponds to a SNP.

The sample G has 2 classes, case and control ,and M variables, and each of them is represented as a SNP. To constr uct a classification tree, we split the sample S into 3 child nodes, depending on the value (0 , 1 , 2) of the variable (SNP) on split site (loci). We grow the tree to the largest possible extent. The construction of the classification tree for case-control sample is illustrated in Fig. 1 . The relationship of a leaf to the tree on which it grows can be described by the hierarchy of splits of branches (starting from the trunk) leading to the last branch from which the leaf hangs. The collection of split site is a Multi-SNPs combination (MSC), which can be viewed as a multi-SNP interaction for the disease. In this example, MSC = { 5 , 9 , 3 } and m = 3, which is a collection of 3 SNPs, represented as its loci. 2.3 Most Disease-Associated Multi-SNPs Problem To fully understand the basis of complex diseases, it is important to identify the critical genetic factors involved, which is a combination of multiple SNPs. For a given sample G , S is the set of all SNPs (denoted by loci) for the sample, and a multi-SNPs combination (MSC) is a subset of S . In disease associations, we need to find a MSC which consists of a combination of SNPs that are well associated with the disease. The problem can be formulated as follows: Most Disease-associated Multi-SNPs Problem. Given a sample G with a set of SNPs S , find the most disease-associated multi-SNPs combination (MDMSC) such that the sample is classified correctly by the MDMSC with high confidence.

Although there are many statistical methods to detect the most disease asso-ciated SNPs, such as odds ratio or risk rates, the result is not satisfactory [15]. We decide to search the MDMSC based on the random forest. 2.4 Optimum Random Forest We generate a MSC for each SNP, the size of the MSC should be much less than the number of SNPs set S ( m M ). The MSC i ( i =1 , 2 ,...,M ) must include the i th SNP and the other ( m  X  1) SNPs can be randomly chosen from S .In this way, the M MSCs will cover all SNPs in the sample.

For each MSC, we grow many trees, by permuting the order of the MSC and the training sample. We run all the testing samples down these trees to get the classifier for each sample in the training set, then we can get a classification rate for each tree of a MSC. The classification rate for the MSC is that of the tree whose rate is the highest, and this tree is the best tree. Each member(SNP) of the MSC i is assigned a weight w i,j ( j  X  MSC ) based on the accuracy. The weights for SNPs in the same MSC are the same. All SNPs in all other MSCs will be assigned a weight too. If a SNP is not a member of MSC i ,then w i,j =0.
The weight for each SNP W j ( j =1 , 2 ,...,M )in M is the sum of weights from all MSCs.

In the general random forest (GRF) algor ithm, the MSC is selected completely randomly and m M .ItmaymisssomeimportantSNPsiftheyarenotchosen for any MSC. In our optimum random forest (ORF) algorithm, this scenario is avoided because we generate at least one MSC for each SNP. On the other hand, in GRF, the classifier (forest) consi sts of trees where there is a correlation between any two trees in the forest, and the correlation will decrease the rate of the classifier. But in ORF, we generate a cluster by permuting the order of the MSC and samples for each tree and the prediction for testing samples is on this cluster only, which is completely independent from the other trees. In this way, we extinguish the correlation among trees.
 All SNPs are sorted according to their weights. The most disease-associated SNP is the one with the highest weight. The contribution to diseases of each SNP is quantified by its weight, but in GRF there is no way tell the difference of contribution among SNPs. In this section we first describe the input and the output of prediction algorithms and then we show how to apply the optimum random forest to the disease susceptibility prediction.

Data sets have n genotypes and each has m SNPs. The input for a prediction algorithm includes: (G1) Training genotype set g i =( g i,j ) ,i =0 ,...,n,j =1 ,...m , g i,j  X  X  0 , 1 , 2 } (G3) Testing genotype g t without any disease status.

We will refer to the parts (G1-G2) of the input as the training set and to the part (G3) as the test case. The output of prediction algorithms is the disease status of the genotype g n , i.e., s ( g t ).
 We use leave-one-out cross-validation to measure the quality of the algorithm. In the leave-one-out cross-validation, the disease status of each genotype in the data set is predicted while the rest of the data is regarded as the training set.
Below we describe several universal pr ediction methods. These methods are adaptations of general computer-intelligence classifying techniques. Closest Genotype Neighbor (CN). For the test genotype g t , find the closest (with respect to Hamming distance) genotype g i in the training set, and set the status s ( g t )equalto s ( g i ).
 Support Vector Machine Algorithm (SVM). Support Vector Machine (SVM) is a generation learning system based on recent advances in statistical learning theory. SVMs deliver state-of-the-art performance in real-world appli-cations and have been used in case/contr ol studies [17,21]. There are some SVM softwares available and we decide to use libsvm-2.71 [22] with the following radial basis function: This is the kernel function, where  X  is 0.0078125.
 General Random Forest (GRF). We use Leo Breiman and Adele Cutler X  X  original implementation of RF version 5.1 [19]. This version of RF handles unbal-anced data to predict accurately. RF tries to perform regression on the specified variables to produce the suitable model. RF uses bootstrapping to produce ran-dom trees and it has its own cross-validation technique to validate the model for prediction/classification.
 Most Reliable 2 SNP Prediction (MR2) [23] . This method chooses a pair of adjacent SNPs (site of s i and s i +1 ) to predict the disease status of the test genotype g t by voting among genotypes from the training set which have the same SNP values as g t at the chosen sites s i and s i +1 . They choose the 2 adjacent SNPs with the highest prediction rate in the training set.
 LP-based Prediction Algorithm (LP). This method is based on a graph X = { H, G } , where the vertices H correspond to distinct haplotypes and the edges G correspond to genotypes connectin g its two haplotypes. The density of X is increased by dropping SNPs which do not collapse edges with opposite status. The linear program assigns weights to haplotypes such that for any non-diseased genotype the sum of weights of its haploptypes is less than 0.5 and greater than 0.5 otherwise. We maximize the sum of absolute values of weights over all genotypes. The status of the testing genotype is predicted as sum of its endpoints [14].
 Optimum Random Forest(ORF). In the training set, we use random forest to choose those most disease-associated SNPs . The selected di sease-associated multi-SNPs combination (MDMSC) (a collection of m SNPs) is used to build the optimum random forest. The m variables are used to split the sample. We may use the same MDMSC to grow many different trees (Tree T 3 , 5 , 8 is different from Tree T 8 , 3 , 5 ) and choose the best tree (classifier) to predict the disease status of the testing genotype. The best tree has the highest prediction rate in the training set. Since the training set is different when the testing individual is left out, the MSC and the best classifier are different too. The Optimum Random Forest algorithm is illustrated in Fig.2. In this section we describ e the two real case/control population samples and the results of optimum random forest based susceptibility prediction method on these sets. 4.1 Data Sets The data set Daly et al [13] is derived from the 616 kilobase region of human Chromosome 5 q 31 that may contain a genetic variant responsible for Crohn X  X  disease by genotyping 103 SNPs for 129 trios. All offspring belong to the case population, while almost all parents belong to the control population. In the entire data, there are 144 case and 243 control individuals. The missing genotype data and haplotypes have been inferred using the 2SNP phasing method [20].
The data set of Ueda et al [18] are sequenced from 330kb of human DNA containing genes CD28, CTLA4 and ICONS which are proved related to autoim-mune disorder. A total of 108 SNPs were genotyped in 384 cases of autoimmune disorder and 652 controls. Similarly, the missing genotype data and haplotypes have been inferred. 4.2 Measures of Prediction Quality To measure the quality of prediction methods, we need to measure the deviation between the true disease status and the result of predicted susceptibility, which can be regarded as measurement error. We will present the basic measures used in epidemiology to quantify accuracy of our methods.
 The basic measures are:
Sensitivity: the proportion of persons who have the disease who are correctly identified as cases.

Specificity: the proportion of people who do not have the disease who are correctly classified as controls.

The definitions of these two measures of validity are illustrated in the following contingency table.

In this table: From the table, we can compute Sensitivi ty (accuracy in classification of cases, Specificity (accuracy in classific ation of controls) and accuracy:
Sensitivity is the ability to correctly detect a disease. Specificity is the ability to avoid calling normal as disease. Accuracy is the percent of the population that are correctly predicted. 4.3 Results and Discussion In Table 2 We compare the optimum random forest (ORF) method with the other 5 methods we described above. The best accuracy is achieved by ORF -74.4% and 72.1%, respectively. From the results we can find that the ORF has the best result since we select the most disease-associated multi-SNPs to build the random forest for prediction. Because these SNPs are well associated with the disease, the random forest may produce a good classifier to reflect the association.
 Fig. 3 shows the receiver operating charac teristics (ROC) curve for 6 methods. A ROC curve represents the tradeoffs between sensitivity and specificity. The ROC curve also illustrates the advantage of ORF over all previous methods.
IfthesizeofMDMSCis m , and the total number of SNPs is M , to get a good classifier, then m should be much less than M . The prediction rate depends on the size of MDMSC, as shown in Fig. 4. In our experiment, we found that the best size of MDMSC is 19 for Crohn X  X  Disease (103 SNPs) and 24 for autoimmune disorder (108 SNPs ), respectively. In this paper, we discuss the potential of applying random forest on disease association studies. The proposed genetic susceptibility prediction method based on the optimum random forest is shown to have a high prediction rate and the multi-SNPs being selected to build the r andom forest are well associated with diseases. In our future work we are going to continue validation of the proposed method.

