 Sauravjyoti Sarmah, Rosy Das Sarmah, and Dhruba Kumar Bhattacharyya According to [2], most data mining algorithms developed for microarray gene expression data deal with the problem of clustering. Clustering groups of genes with similar expression patterns into the same cluster based on a proximity mea-sure. One of the characteristics of gene expression data is that it is meaningful to cluster both in terms of genes or sampl es. Co-expressed genes can be grouped into clusters based on their expression patterns ([3], [4]). In gene-based cluster-ing, the genes are treated as the objects, while the samples are the features. In sample-based clustering, the samples can be partitioned into homogeneous groups where the genes are regarded as features and the samples as objects. Both the gene-based and sample-based clustering approaches search exclusive and exhaus-tive partitions of objects that share the same feature space. Apart from these, a third category, that is subspace clustering ,capturesclustersformedbyasubset of genes across a subset of samples. For subspace clustering algorithms, either genes or samples can be regarded as objects or features. The goal of gene ex-pression clustering is to group co-expre ssed genes together. Co-expressed genes indicate co-function and co-regulation [5]. The purpose of clustering gene expres-sion data is to reveal the natural structure inherent in the data. A good clustering algorithm should depend as little as possible on prior knowledge, for example requiring the pre-determined number of clusters as an input parameter. Cluster-ing algorithms for gene expression data should be capable of extracting useful information from noisy data. Gene exp ression data are often highly connected and may have intersecting and embedded patterns [6]. Therefore, algorithms for gene-based clustering should be able to handle this situation effectively. Finally, biologists are not only interested in the clusters of genes, but also in the re-lationships ( i.e. , closeness) among the clusters and their sub-clusters, and the relationship among the genes within a cluster ( e.g. , which gene can be consid-ered as the representative of the cluster and which genes are at the boundary area of the cluster). A clustering algorithm, which also provides some graphi-cal representation of the cluster structure is much favored by the biologists and therefore a tree structured clustering of gene expression data helps biologists to identify the inherent details. A large number of clustering techniques have been been reported for analyzing gene expr ession data, such as Partitional clus-tering such as K-means [7], Fuzzy c-means [8], Quality Threshold Clustering [9] and Self Organizing Maps (SOMs) [10], Hierarchical clustering (Unweighted Pair Group Method with Arithmetic Mean, UPGMA) [4], Self-Organizing Tree Algo-rithm [11], Divisive Correlation Clustering Algorithm (DCCA) [12] and Dynami-cally Growing Self-Organizing Tree (DGSO T) [13], Density-based clustering such as Kernel Density-based [14], Density-ba sed Hierarchical Clustering (DHC) [6], Regulation based density clustering (RDC lust) [15], a recent density gene cluster-ing (DGC) [16] and Shared nearest neighbor based clustering [17], Model-based methods like Self-Organizing Maps [10], neural networks [18], Graph-theoretic clustering (Cluster Affinity Search Techniques (CAST) [3], CLuster Identifica-tion via Connectivity Kernels (CLICK) [19], E-CAST [20] and graph clustering algorithm [21]. A recent gra ph based automated clustering technique (GCE) is presented in [22]. In [23], a two stage clustering algorithm for gene expression data using genetic algorithms is present ed. A novel multi-objective genetic fuzzy clustering followed by support vector mach ine based classification is presented in [24]. Recently, a subspace clustering algorithm, CLIC, has been proposed in [25]. Majority of the clustering techniques are dependent on a choice of proximity measure. Also, due to the inherent high dimensionality and presence of noise in gene expression data, it is a challenging task to find the clusters inherent in the subspaces of the dataset. The hierarchical approach of clustering genes helps in visualizing the clusters at different levels of hierarchy. Also, it is important to establish that the clusters obtained are biologically relevant. In this paper, we introduce an effective clustering technique ( GeneClusTree ), which attempts to find all the possible clusters over subspaces and represents the results in a tree based structure. The proposed GeneClusTree can be found significant in view of the following basic advantages: (i) capable of identifying biologically relevant clusters of all shapes in presence of noise, (ii) does not require the number of clusters apriori, and (iii) free from the restrictions of using any specific proximity measure.
 GeneClusTree is a gene based clustering technique which attempts to cluster the gene dataset using a tree-based density approach. GeneClusTree groups together genes with similar expression patterns and the tree structure provides a natural way to graphically represent the data set. At first, the gene expression data is normalized to have mean 0 and standard deviation 1. Expression data having a low variance across conditions as well as data having more than 3-fold variation are filtered out. Discretization is then performed on this normalized expression data by retaining the up-or down-regulation information in each of the condi-tions for a particular gene. Also, to avoid the restrictions caused due to the use of any normal proximity measure, it exploits the angle information computed over the normalized expression values. 2.1 Regulation Information Extraction Let G be the set of all genes, T be the set of all conditions with cardinality n T . The regulation information extraction for a gene g i  X  G is carried out as follows: (i)  X  of gene g i at the first condition, i.e. ,at t 1 is: We see in the above discretization process that the first condition, t 1 ,istreated as a special case and it X  X  discret ized value is directly based on  X  g i ,t 1 i.e., the expression value at condition t 1 . For the rest of the conditions the discretized regulation value is calculated by comparing its expression value with that of the previous expression value. This helps in finding whether the gene is up-(1) or down-(-1) regulated at that particular condition. Each gene will now have a regulation pattern (  X  ) of 0, 1, and -1 across the conditions or time points and is represented as a string. Next, GeneClusTree computes the angle information condition-wise for each of the gene profil e based on their normalized expression values. The angle information gives the trend angle between each pair of condi-tions. We illustrate the whole gene-condition space as a graph with conditions across x -axis and expression levels along y -axis. Let the x -axis for a gene g i be denoted as x t j for condition t j and its corresponding y -axis be denoted by the expression value  X  g i ,t j .Now,forthegene g i , the angle information for each of its n
T conditions is computed according to the formula 1 given in Equation below. Each gene g i will now have a pattern of angle information  X  g i consisting of n
T values. This angle information is then further discretized by dividing it into discrete equal intervals depending on their angle values where the width of the interval is a user input. After discretization of the angle values, each gene, g i , will have a pattern of angle id s(  X  g the k th condition is denoted as  X  g angle patterns are used together to cluster the gene expression dataset using a tree-based density approach. A string matching approach is used for matching the regulation and the discretized angl e patterns of two genes. Next, we give some definitions which provide the foundation of GeneClusTree .
 Definition 1. Matched Subspace: The matched subspace ( M ( g i ,g j ) )istheset of k conditions where both the genes g i and g j match and  X   X  k  X  n T and  X  is a user defined parameter.
 Definition 2. Maximal Matched Subspace: A matched subspace is called maxi-mal if no superset of this can be found to be a matched subspace.
 Definition 3. Neighbor of a gene: A gene g j is said to be a neighbor of gene g i i.e., g j  X  N l ( g i ) ,iff i. g i and g j are in the same level, say, l , ii. | M ( g i ,g j ) | X   X  ,and iii.  X  g For regulation matching, GeneClusT ree initially attempts to find neighbors of agene g i over full set of conditions i.e., n T number of conditions. If no match is found, the number of conditions is decremented by 1 at each step upto a certain threshold (say,  X  ) till a match occurs i.e.,  X  ( g i )  X   X  ( g j ). However, at each subsequent step, the previously computed matching information is used which makes the searching more efficient.
 Definition 4. Initiator: A gene g i in the l th level is said to be an initiator if | N l ( g i ) | X   X  .
 The neighborhood of a gene g i is searched for genes satisfying the initiator condition. If no neighbor gene is found, then the process is repeated with another unclassified gene. In our experiments we have obtained good results for  X  =2. Definition 5. Node: A node n i in the l th level is a non-empty subset of genes of G where, any gene g j  X  n i is either (i) itself an initiator gene, or (ii) is within the neighborhood of an initiator gene g i  X  n i i.e., g j  X  N l ( g i ) . Definition 6. Node Reference Vector: Reference Vector of a node is the subset of conditions where all the genes belonging to that node match maximally. The Reference Vector of a node n i ( RV n i ) to which, say, genes g i and g j belong to is computed as follows: Definition 7. Intra-node reachability: A pair of genes ( g i ,g j ) in any level, say l , is said to be intra-node reachable if, (i) one of them is an initiator and the other is a neighbor of it, or (ii) another gene g k is an initiator and g i ,g j  X  N l ( g k ) ,or (iii) both g i ,g j are initiators and they are neighbors to each other i.e., either g  X  N The intra-node reachable genes satisfy the condition that they match in the same subset of conditions of regulation pattern.
 Definition 8. Inter-node Reachability: A gene g j  X  n c is said to be inter-node reachable from another gene g i  X  n p ,where n p is the parent of n c ,if  X  g j matches of n c .
 Finding subspace clusters in different levels gives different level of finer clustering of a dataset which may be useful for the biologists.
 Definition 9. Maximal-Space cluster: A node n i is said to be maximal-space cluster if n i is created at the first level (i.e., level 1) and the set of genes in n i match in a set of k conditions, where  X   X  k  X  n T .
 Definition 10. Reduced-Space cluster: A node n i is a said to be a reduced-space cluster if n i is created in the j th level and the set of genes in n i match in a set of ( k  X  ( j  X  1)) conditions where k is cardinality of the set of conditions in which the genes in the parent node of n i match in the ( j  X  1) th level where 2  X  j  X  ( k  X  (  X   X  1)) .
 Definition 11. Noise Genes: Let n 1 ,n 2 ,  X  X  X  n p be the set of subspace clusters of G , then noise genes in G is the set of genes not belonging to any subspace cluster n , i.e. , noise = { g x  X  G | X  i : g x /  X  n i } In the rest of the paper, we will use the terms node and subspace cluster inter-changeably to represent a cluster over a subset of conditions.
 GeneClusTree starts by creating a tree structure in a depth-first manner with an empty node as the root. The root is at level 0 and is connected to all the nodes in level 1. The nodes in level 1 are created by a density based approach and each of these nodes is the basis of formation o f the reduced-space clusters of the sub-tree. The process of creating a level 1 nod e i.e., a maximal space cluster starts with an arbitrary unclassified gene g i and the neighborhood of g i is searched to check whether it is an initiator. If no gene is found to satisfy the neighborhood condition with g i , then the process restarts with another unclassified gene. On the other hand, if g i is an initiator gene it initiates the process of creating a new node with a node reference vector form ed according to Definition 6. Then the process proceeds with finding all the genes that satisfies the intra-node reacha-bility condition with g i in terms of the node reference vector and are assigned to the same node to which g i belongs. If any gene g j from the set of intra-node reachable genes of g i satisfies the initiator gene condition, then the node expan-sion proceeds with the gene g j . The process continues till no more genes can be assigned to the node. Each of the nodes in level 1 is a maximal-space cluster and determines the nodes to be formed as redu ced-space clusters, across different subset of conditions, in the next level of the sub-tree. After completion of the formation of the node(s) of a particular level in a sub-tree, the value of level is incremented by 1. Each of the nodes formed at level 1 becomes the parent node of the sub-trees formed at the next level ( i.e. , level 2). Similarly, for the nodes in level i , their parents will be in level ( i -1). Also, with the increase in the height of the tree, the cardinality of the matched condition set decreases from parent to child by 1 at each level. For a p articular sub-tree, the genes in each of the i th nodes agrees over a set of ( k  X  ( l  X  1)) conditions of the parent node X  X  reference vector. Genes belonging to the sibling node(s) at the same level in a particular sub-tree have the same cardinality of matched conditions, however the match is over different set(s) of conditions. On completion of the child nodes along with their sibling nodes of a par ticular node in a sub-tree, the process continues similarly in the next level until the sub-tree reaches a depth of  X  or no more nodes can be added to the sub-tree. The process then backtracks to level 1 and finds the next maximal subspace cluster and inserts it as a child of the root. The sub-tree of this node is created in the similar manner as de-scribed before. The whole process repea ts itself until no more maximal subspace clusters are inserted in level 1 of the tr ee. All the remaining unclassified genes are treated as noise genes. An implementation of GeneClusTree is available at: http://202.141.129.18/  X  dkb/resources/gene clus tree.rar. The following lemmas are formulated from the definitions of GeneClusTree .
 Lemma 1. A gene g i belonging to n 1 ,i ( n 1 ,i is the i th subspace cluster of level 1) cannot be a neighbor of any gene g j  X  n 1 ,j ,where n 1 ,j is the j th subspace cluster of level 1.
 reachable from g j according to Definition 7. Therefore, both g i and g j belongs to the same node (subspace cluster). Therefore, we come to a contradiction and hence the proof.
 Lemma 2. A gene g j belonging to n i,j may not belong to n ( i  X  1) ,k (i = 2, 3,  X  X  X  , X  )where n Proof. Let g j  X  n i,j , then according to Definition 8, g j is inter node reachable a total of ( n T  X  (( i  X  1)  X  1) ) conditions, i.e., one condition less than g k .The reference vector of n i,j will be same as that for n i  X  1 ,k except for the condition where g k and g j do not match. Therefore, g j /  X  n i  X  1 ,k and hence the proof. Lemma 3. If g i  X  n i and g j  X  n j where n i and n j are two subspace clusters, then g i and g j are not intra-node reachable.
 Proof. Let g i and g j be two intra-node reachable genes and g i  X  n i and g j  X  n ,where n i and n j are two subspace clusters at any level. Then, according to Definition 7, either they are neighbors or both of them are neighbors of another initiator gene, that is, g i and g j must be in the same subspace cluster according to Definition 5. Therefore, g i and g j are not intra-node reachable. Lemma 4. Assume g i  X  n i and g j  X  n j where n i and n j are two subspace clusters ( n i and n j are not parent-child or vice versa), then g i and g j are not inter-node reachable.
 Proof. Let g i and g j be two inter-node reachable genes and g i  X  n i and g j  X  n ,where n i and n j are two subspace clusters but do not share a parent-child relationship between them. However, according to Definition 8, two genes are inter-node reachable if one of them belongs to a parent node and the other to its child. Therefore, n i and n j should be parent-child or vice versa and hence, are not inter-node reachable.
 Theorem 1. Two genes g i and g j belonging to two different nodes are not coherent.
 Proof. Let g i  X  n i and g j  X  n j .Now,asperlemma1, g i cannot be a neighbor of g j . Again, since genes g i and g j are not neighbors, then the conditions given in Definition 2 do not satisfy and hence they are not coherent.
 Theorem 2. A gene g i without a neighbor is a noise.
 Proof. A gene g i without a neighbor is neither intra-node nor inter-node reach-able from any other node, hence such a gene g i can be trivially proved to be a noise gene according to Definition 11, lemma 3 and lemma 4.
 where B is the total number of branches in the tree and n c avg is the average number of genes corresponding to a branch and level max is the maximum depth of the tree. GeneClusTree was implemented in Java in Windows environment and evaluated with several real-life datasets. Of the various datasets, the results of some of the datasets as reported in Table 1 are presented next. All the datasets are nor-malized to have mean 0 and standard deviation 1. The clusters formed from Dataset 1 and 2 are shown in Figure 1 (a) and (b). Figure 3 (a), shows some of the maximal space and reduced space clusters of Dataset 1. The maximal and reduced space clusters of Dataset 3 reported in [28] are shown in Figure 3 (b). In order to validate our clustering result, we employ z-score [29] as the measure of agreement.
 Z-score [29] is calculated by investigating the relation between a clustering result and the functional annotation of the genes in the cluster. We have used Gibbons ClusterJudge [29] tool to calculate the z-score. A higher value of z indicates that genes would be better clustered by function, indicating a more biologically relevant clustering result. To test the performance of the clustering algorithm, we compare clusters identified by GeneClusTree with the results from RDClust, DCCA and UPGMA. In this paper, the reported z-score is averaged over 10 repeated experiments. The res ult of applying the z-score on Dataset 1 is shown in Table 2. In this table the proposed algorithm has been compared with the well known agglomerative hierarchical algorithm, UPGMA, DCCA and RDCLust. Table 2 clearly shows that GeneClusTree outperforms UPGMA, RD-Clust and DCCA w.r.t. the cluster quality. We note here that unlike k-means our method does not require the number of clusters as an input parameter. It detects the clusters present in the dataset automatically and gives the rest as noise. However, the algorithm UPGMA requires the input parameter cutof f . The biological relevance of a cluster can be verified based on the gene ontology (GO) annotation database http://db.yeastgenome.org/cgi-bin/GO/goTermFind er . It is used to test the functional enrichment of a group of genes in terms of three structured contro lled ontologies, viz. , associated biological p rocesses, molecular functions and biological components. The functional enrichment of each GO category in each of the clusters obtained is calculated by its p-value [30]. A low p -value indicates the genes belonging to the enriched functional categories are biologically significant in the corresponding clusters. To compute the p -value, we used the software FuncAssociate [30]. Due to the constraint in the page limit, the enriched functional categories for some of the clusters obtained by GeneClusTree on Dataset 1 are partially listed in Table 3. The functional enrichment of each GO category in each of the clusters is calculated by its p -value. Cluster C2 contains genes involved in DNA replication with the highly enriched category being  X  X CM complex X  with a p -value of 1 . 1  X  10  X  12 . The highly enriched categories in C5 is the  X  X ellular bud X  with a p -value of 7 . 0  X  10  X  07 . The genes in cluster C10 are involved in cell cycle. C10 contains the highly enriched cellular components of  X  X NA metabolic process X ,  X  X NA replication X ,  X  X hromosome X ,  X  X hromosomal part X , and 8 . 8  X  10  X  19 being the highly enriched one. To restrict the size of the article we have reported the p -values of only three clusters obtained from Dataset 1. From the Table 3, we can conclude that GeneClusTree shows a good enrichment of functional categories and therefore project a good biological significance. This work presents a tree-based density approach which finds useful subgroups of genes within a cluster and obtains a tree structure of the dataset where the clusters at the top level gives the finer clustering of the dataset. GeneClusTree does not require the number of clusters apriori and the clusters obtained have been found satisfactory on visual inspection and also based on z-score as well as p -values for three real datasets. However, work is going on for establishing the effectiveness of GeneClusTree over more real-life human gene datasets. In our future work, we plan to fuse the analysis of gene expression datasets with biological information during node expansion to identify the co-regulated genes. Acknowledgement. This work is an outcome of the research project in col-laboration with CSCR, ISI, Kolkata funded by DST, Govt. of India.

