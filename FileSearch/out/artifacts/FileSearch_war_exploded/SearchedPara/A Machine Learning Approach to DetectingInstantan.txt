 The study of human brain functions has dramatically increased in recent years greatly due to the advent of Functional Magnetic Resonance Imaging (fMRI). While fMRI has been used extensively to tes t hypothesis regarding the location of activation for different brain functions, the problem of automatically classifying cognitive states has been little explored. The study of this problem is important because it can provide a tool for detectin g and tracking cognitive processes (i.e. sequences of cognitive states) in order to diagnose difficulties in performing a complex task.

In this paper we describe an approach to detecting the instantaneous cognitive state of a person based on her Functional Magnetic Resonance Imaging data. We present a machine learning approach to the problem of discriminating in-stantaneous cognitive states produced by different auditory stimuli. We present the results of two case studies in which we have trained classifiers in order to dis-criminate whether a person is (1) listening to melodic tonal stimuli or listening to nonsense speech, (2) listening to an auditory stimulus or mentally rehears-ing the stimulus, (3) listening to melody, speech or rehearsing, (4) listening to a pure tone or a band-passed noise burst, and (5) listening to a low-frequency tone or a high-frequency tone. The problem investigated in this paper is also in-teresting from the machine learning point of view since it provides an interesting case study of training classifiers with extremely high dimensional (10,000-15,000 features), sparse (32-84 examples) and noisy data.

We apply and compare different machine learning techniques to the task of predicting a subject cognitive state gi ven her observed fMRI data. We associate a class with each of the cognitive state s of interest and given a subject X  X  fMRI data observed at time t , the classifier predicts one of the classes. We train the classifiers by providing examples consist ing of fMRI observations (restricted to selected brain areas) along with the known cognitive state of the subject. We select the brain areas by applying feature selection methods tuned to the data characteristics.

The rest of the paper is organized as follows: Section 2 sets out the back-ground for this research. In Section 3, we describe our approach to the problem of detecting the instantaneous cognitive state of a person based on her Func-tional Magnetic Resonance Imaging data. Section 4 presents two case studies. In Section 5 we discuss the results of the case studies, and finally Section 6 presents some conclusions and indicates some areas of future research. Functional Magnetic Resonance Imaging is a brain imaging technique that allows the observation of brain activity in human subjects based on the increase in blood flow to the local vasculatu re that accompanies neural activity in the brain. It produces time-series data that represe nts brain activity in a collection of 2D slices of the brain. The collection of the 2D slices form a 3D image of the brain containing in the order of 12000 voxels, i.e. cubes of tissue about 3 millimeters on each side. Images are usually taken every 1-5 seconds. Despite the limitations in temporal resolution, fMRI is arguably the best technique for observing human brain activity that is currently available. Figure 1 shows a fMRI image showing the instantaneous activity of a section of the brain and the activity over time of one of its voxels (white voxels are those with highest activity while dark voxels are those with lowest activity).

Functional Magnetic Resonance Imaging has been widely applied to the task of identifying the regions in the brain which are activated when a human per-forms a particular cognitive function (e.g. visually recognizing objects). Most of the reported research summarizes average fMRI responses when a human is presented with a particular stimulus repeatedly. Regions in the brain activated by a particular task are identified by comparing fMRI activity during the pe-riod where the stimulus is presented with the activity detected under a control condition. Other research describes the effects of varying stimuli on activity, or correlations among activity in different brain regions. In all these cases, the results are statistics of eff ects averaged over multiple trials and multiple subjects.
Haxby et al [4] detect different pattern s of fMRI activity generated when a human views a photograph of different o bjects (e.g. faces, houses). Although this information was not specifically used for classifying subsequent fMRI data, Haxby et al reported that they could automatically identify the data samples related to the same object category. Wagn er et al [9] reported that they have been able to predict whether a v erbal experience is to be remembered later based on the amount of activity in particular bra in regions during the experience. Closer to the work reported in this paper is the work by Mitchell et al [6,7] who have applied machine learning methods to the same problem investigated here. In particular, they have trained classifiers to distinguish whether a subject is looking at a picture or a sentence, reading an ambiguous or non-ambiguous sentence, and the type of word (e.g. a word describin g food, people, etc.) to which a subject is exposed. Cox et al [2] applied support vector machine to fMRI data in order to classify patterns of fMRI activation produced by presenting photographs of various categories of objects. In this section we present our approach to training and evaluating classifiers for the task of detecting the instantaneous cognitive state of a person. Given a person X  X  observed instantaneous fMRI data at time t , we train a classifier in order to predict the cognitive state that gave rise to the observed data. The training data is a set of examples of fMRI observations along with the known cognitive state. 3.1 Learning Algorithms In this paper we explore different machine learning techniques to induce a clas-sifier of the following form.

Classif ier ( fMRIdata ( t ))  X  CognState where fMRIdata ( t ) is an instantaneous fMRI image at time t and CognState is a set of cognitive states to be discrimin ated. For each subject in the fMRI data sets we trained a separate classifier. We explored a number of classifier induction methods, including:  X  Decision Trees . A decision tree classifier recu rsively constructs a tree by  X  Support Vector Machines (SVM) . SVM [3] take great advantage of using a  X  Artificial Neural Networks (ANN) . ANN learning methods provide a robust  X  Lazy Methods . Lazy Methods are based on the notion of lazy learning which  X  Ensemble Methods . One obvious approach to making more reliable decisions 3.2 Feature Selection As the classification task reported in this paper clearly involves a high dimen-sional training data, it is necessary to apply feature selection methods before training the classifiers. In this paper, we consider two feature selection strate-gies:  X  select features according to how well th ey discriminate the classes of interest.  X  select features according to how well th ey discriminate each class of interest
The feature selection strategies are motivated by the fact that fMRI binary classification problems naturally give rise to three types of data: data corre-sponding to the two target classes, C 1 and C 2 , and data corresponding to the fixation condition. Data corresponding to C 1 and C 2 is composed of signal plus noise, while data corresponding to the fixation condition contains only noise, i.e. it contains no relevant signal. Thus, two natural feature selection methods are voxel discriminability , i.e. how well the feature discriminates C 1 and C 2 ,and voxel activity , i.e. how well the feature distinguishes C 1 or C 2 from the fixation class [6]. While the former selection met hod is a straightforward method for se-lecting voxels which discriminate the two classes, the later focuses on choosing voxels with large signal-to-noise ratios, although it ignores whether the feature actually discriminates the two classes. Within the fMRI community it is com-mon to use voxel activity to select a subset of relevant voxels. In more detail, the voxel discriminability and voxel activity feature selection methods are as follows:  X  voxel discriminability . For each voxel and target class, a t -test is performed  X  voxel activity . For each voxel and target class, a t -test is performed comparing 3.3 Classifier Evaluation We evaluated each induced classifier by performing the standard 10-fold cross validation in which 10% of the training set is held out in turn as test data while the remaining 90% is used as training data. When performing the 10-fold cross validation, we leave out the same number of examples per class. In the data sets, the number of examples is the same for e ach class considered, thus by leaving out the same number of examples per class we maintain a balanced training set. In order to avoid optimistic estimates of t he classifier performance, we explicitly remove from the training set all images occurring within 6 seconds of the hold out test image. This is motivated by the fact that the fMRI response time is blurred out over several seconds. In this section we describ e two case studies on training classifiers using fMRI data. We summarize the results we have obtained and postpone the discussion of the results to the next section. 4.1 Melody, Speech and Rehearsal Study In this fMRI study [5] a total of 6 right handed subjects with a mean age of 27 (3 men and 3 women) participated. Twenty-one short unfamiliar piano melodies, each of 3 seconds duration, were recorded using a MIDI synthesizer. Melodies consisted of 5 to 17 notes in the C key (i.e. white keys on the piano). Note durations ranged from 106 to 1067 msec and patterns were chosen to be rhythmical according to W estern music. An equal number of nonsense sentences (nouns and verbs were replaced by pseudo words), also approximately 3 seconds long, were recorded and digit alized. Each trial in this experiment consisted of an initial stimulus presentation (music or sentence; 3 seconds duration), followed by a 15 second rehearsal period, a representation of the stimulus (signaling the subject to stop rehearsing), and ended with 15 seconds of rest. The next trial was then initiated by a new stimulus item. Thus, each full trial extended over a period of 36 seconds. fMRI images wer e acquired every 2 seconds. The voxel dimensions were set to 6 x 4 x 4 mm.

We used this data to investigate the feasibility of training successful classifiers to detect whether a subject is listening to melodic tonal stimuli, listening to non-sense speech, mentally rehearsing a melody or simply resting (control condition). In particular, we trained classifiers for the tasks of distinguishing among the cog-nitive states for (1) listening to a melody versus listening to nonsense speech, (2) listening to an auditory stimulus (a melody or nonsense speech) versus mentally rehearsing the stimulus, and (3) listening to a melody versus listening to nonsense speech versus mentally rehearsing the auditory stimulus (i.e. a three class clas-sifier). This is, given the general classifier of the form Cl ( fMRIdata ( t ))  X  CS , we are interested in the set CS of cognitive states to be discriminated to be { melody, speech } , { audition, rehearsal } ,and { melody, speech, rehearsal } ,re-spectively for (1), (2) and (3) as above.

Initially, we filter the fMRI data by eliminating voxels outside the brain. This is done by discarding the voxels below an activation threshold. The average number of voxels per subject after filtering was approximately 12,000 (although this varied significantly from subject to subject). Once the fMRI data is sifted, we proceed to select voxels based on both the voxel discriminability and voxel activity feature selection methods described in the previous section. We average the activity values of contiguous voxels representing brain regions. We restricted the amount of features for training the classifiers to 10-22.

There were a total of 84 examples availa ble for each subject for the two-class classification tasks (i.e. 42 examples for each class), and 126 examples for the three-class classification task (i.e. 42 examples for each class). For the two-class classification tasks, the expected classi fication accuracy of the default classifier (one which chooses the most common class) is 50% (measured in correctly clas-sified instances percentage), while for the three-class classification task, the ex-pected accuracy is 33%. For the melody-vers us-speech, audition-versus-rehearsal, and melody-versus-speech-versus-rehears al classifiers the ave rage accuracies ob-tained for the most successful trained classifier using the most successful feature selection strategy were 97.19%, 84.83%, and 69.44%, respectively. For these clas-sifiers the best subject X  X  accuracies were 100%, 98.57%, and 81.67%, respectively. The results are statistically significant which indicates that it is indeed feasible to train successful classifiers to distingu ish these cognitive states. The correctly classified instances percentage for each s ubject and each learning method is pre-sented in Tables 1-4.
 4.2 Pure Tones and Band-Passed Noise In this fMRI study [10] twelve subjects with normal hearing listened passively to one of six different stimulus sets. These se ts consisted of either pure tones (PTs) with a frequency of 0.5, 2 or 8 kHz, or band-passed noise (BPN) bursts with the same logarithmically spaced center frequencies and a bandwidth of one octave (i.e. from 0.35-0.7, 1.4-2.8, and 5.6-11.2 kHz, respectively). All stimuli were 500 msec in duration including 50 msec rise/fall times to minimize on/offset artifacts. Stimuli were presented at a rate of 1Hz during the  X  X timulus-on X  intervals of the functional scans. The subjects underwent 12 functional runs consisting of four 32 sec cycles divided into two 16-sec  X  X  X timulus-on X  and  X  X timulus-off X  epochs. During six runs each PT and BPN bursts were the on-stimuli. The voxel size was 3.75 x 3.75 x 4.4 mm 3 .

We used this data to train classifiers to detect whether a subject is listening to a high or low frequency tone, and whether the subject is listening to a pure tone or a band-passed noise burst. In particular, we trained classifiers for the tasks of distinguishing among the cognitive states for (1) listening to a high frequency PT versus listening to a low frequency PT, (2 ) listening to a PT versus listening to a BPN burst (both in a middle frequency). Given the general classifier of the form Cl ( fMRIdata ( t ))  X  CS , we are interested in the set CS of cognitive states to be discriminated to be { PTHigh,PTLow } ,and { P T M iddle, BP N M iddle } .
We select voxels in the same manner as in the previous case study. This is, we initially filter the fMRI data by eliminating voxels outside the brain by discarding the voxels below an activation threshold. The average number of voxels per subject after filtering was approximately 14,000 (it varied significantly from subject to subject). Once the fMRI data is sifted, we proceed to select voxels based on both the voxel discriminability and voxel activity feature selection methods described before. We average the activity values of contiguous voxels representing brain regions. We restricted the amount of features for training the classifiers to 12-25.

There were a total of 32 training examples available for each subject (i.e. 16 examples for each class). The expected co rrectly classified instances percentage of the default classifier (selecting the most common class) is 50%. For the both PT-High versus PT-Low, and the PT versus BPN classifiers we obtained average accuracies of 100% for the SVM, k -NN and voting. These results are clearly statistically significant and indicate that it is feasible to train successful classifiers to distinguish these cognitive states. The c orrectly classified i nstances percentage for each subject and each learning method is presented in Table 5 and Table 6. Similar results were obtained using voxel activity feature selection (we omit the presentation of the corresponding tables due to space limitations). The difference between the results obtain ed and the accuracy of a baseline clas-sifier, i.e. a classifier guessing at random (50% and 33% in the case of the two-class and three-class classification tas k, respectively) indicates that the fMRI data contains sufficient information to distinguish these cognitive states, and machine learning methods are capable of learning the fMRI patterns that distin-guish these states. It is worth noting that every learning algorithm investigated (decision trees, SVM, ANN, k-NN and the reported ensemble methods) pro-duced significantly better than random cla ssification accuracies for every study. This supports our statement about the feasibility of training classifiers for the case studies reported. However, note tha t this does not necessary imply that it is feasible to train classifiers for arbitrary tasks.

The results also indicate that certain tasks seem to be more difficult to dis-criminate than others. For example, the average accuracy of the melody-versus-speech classifiers is consistently higher than that of the audition-versus-rehearsal classifiers. This may seem to indicate, as previously suggested, that there is more commonality in the underlying brain processes of audition and rehearsal, than in the underlying processes of listening to different types of auditory stimuli. Currently, the general question of exactly which cognitive states can be reliably discriminated remains an open question.

The accuracy of the classifiers for differen t subjects varies significantly, even within the same study and using the same learning method. Subjects producing high accuracies with one learning met hod tend to produce high accuracies with the other learning methods. These uneven accuracies among subjects may be due to the data being corrupted (e.g. by head motion during scanning). In any case, it has been reported that there exists considerable variation in fMRI responses among different subjects.

We have selected the number of features n , i.e. regions raging from 1 to 12 voxels, empirically. We incrementally considered different values for n and stop when average classifier accu racy stops improving. The number of features used ranged from 10 to 15 and from 18-22 for the two-class classification and three-class classification tasks, respectively.

It is worth mentioning that in all the experiments performed we provided no information about relevant brain regions involved in the tasks performed by the subjects. This contrasts with other approaches (e.g. [6,2]) where the input to the classifiers is the set of voxels in the regio ns of interests (ROIs) selected for each particular study. Here, we have treated equally all voxels in the fMRI studies regardless of which brain region they belong to. Incorporation information about the ROI for each fMRI study would very likely improve the accuracies of the classifiers. We decided not to provide any ROIs information in order to eliminate any feature selection bias.

We expected the k -NN classifier to underperform the other classifiers given the high dimensional and sparse training sets ( k -NN is known to be very sensitive to irrelevant features). However, the results show no clear trend in this respect. This led us to think that our feature selectio n process indeed eliminated irrelevant features.

Mitchell et al [6] reported that voxel ac tivity feature selection widely out-performed voxel discriminability feature selection in several fMRI studies. This result may be explained by the high dimensionality, noisy and sparseness char-acteristics of the fMRI data. Typically, in fMRI data only a few voxels contain a signal related to the stimulus under study and given the noisy characteristics of the data it is expected to select irrelevant voxels which appear good discrim-inators. Thus, choosing voxels with high signal-to-noise ratios (as it is the case with voxel activity feature selection) would eliminate a considerable number of irrelevant voxels. However, in the two case studies reported in this paper there is no clear accuracy difference between the c lassifiers trained with voxels selected by voxel activity feature selection and those trained using voxel discriminability feature selection. This may be due to the fact that, in contrast with the results reported by Mitchell et al, we have trained our classifiers with a substantially smaller number of voxels (approximately 40 compared to 800). While voxel dis-criminability feature selection may select irrelevant voxels, voxel activity feature selection may choose high signal to noise voxels that cannot discriminate the target classes. It may be the case that by choosing a smaller number of features the irrelevant voxels selected by voxel discriminability feature selection are re-moved, which in turn minimizes the difference of the results for the two feature selection methods. Also, the fact that classification was done using only a small set of features, classification could, in principle, be used to extract information about a subjects cognitive state on a near real-time basis. In this paper we have explored and compared different machine learning tech-niques for the problem of classifying the instantaneous cognitive state of a per-son based on her functional Magnetic Resonance Imaging data. The problem provides a very interesting instance of tr aining classifiers with extremely high dimensional, sparse and n oisy data. We presented successful case studies of in-duced classifiers which accurately discri minate between cognitive states involv-ing different types of auditory stimuli. Our results seem to indicate that fMRI data contains sufficient information to distinguish these cognitive states, and that machine learning techniques are capable of learning the fMRI patterns that distinguish these states. Furthermore, we proved that it is possible to train successful classifiers using only a small number of features (i.e. 12-15 voxels) extracted from the studied fMRI data, and with no prior anatomical knowledge. This contrasts previous approches in which a large number of voxels is consid-ered (e.g. 800 voxels) and which consider regions of interest in the brain in order to simplify the problem We considered two feature selection strategies: voxel discriminability feature selection and voxel activity feature selection. Contrary to previous results, we found no clear accu racy difference between the classifiers trained with voxels selected by voxel activ ity feature selection and those trained using voxel discriminability feature selection, in the two case studies described. This result deserves further investigation. As future work, we are particularly interested in exploring rule-based machine learning techniques (e.g. Inductive logic programming) in order to explain the predictions of the classifiers and to incorporate domain knowledge into the learning process.
 Acknowledgments. This work was supported by the Spanish Ministry of Ed-ucation and Science under Grant TIN2006-14932-C02-01 (ProSeMus Project). We would like to sincerely thank the fMRI Data Center for providing the fMRI data.

