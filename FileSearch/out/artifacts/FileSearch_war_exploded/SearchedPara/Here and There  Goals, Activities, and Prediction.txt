 A significant portion of Web search is performed in mobile settings. We explore the links between users X  queries on mobile devices and their locations and movement, with a focus on interpreting queries about addresses. We find that users tend to have a primary location, likely corresponding to home or workplace, and that a user X  X  loca-tion relative to this primary location systematically influences the patterns of address searches. We apply our findings to construct a statistical model that can predict with high accuracy whether a user will be soon observed at an address that had been recently retrieved via search. Such an ability to predict that a user will transition to a location can be harnessed for multiple uses including provision of directions and traffic information, the rendering of competitive advertising, and guiding the opportunistic completion of pending tasks that can be accomplished en route to a target location. Categories and Subject Descriptors: H.3.3 [ Information Stor-age and Retrieval ]: Information Search and Retrieval X  search pro-cess, selection process .
 Keywords: mobile search, user mobility, log analysis.
Web search on mobile devices, such as smartphones, is becom-ing increasingly popular. 1 Research has demonstrated that search on mobile devices differs significantly from search in desktop set-tings. For example, Teevan et al. [7] show that queries on such de-vices are frequently issued while people are in transit and are often related to in-world destinations such as businesses. A user X  X  cur-rent location influences search, as information goals may be driven by surrounding entities and resources. Conversely, search can pro-vide information about a user X  X  forthcoming locomotion and en-gagement with physical surroundings.

Geolocation information captured by GPS receivers within smart-phones can be used to build predictive models that link online inter-actions to forthcoming transitions among locations in the physical world. Related prior work studied the relationship between queries  X 
Research done during an internship at Microsoft Research. http://www.comscore.com/Insights/ Presentations_and_Whitepapers/2011/Mobile_ Search_Techniques_and_Tactics_for_Marketers about concerning health symptoms and about proximal medical fa-cilities [9] and has demonstrated with mobile data when intentions expressed in search queries may translate into healthcare utiliza-tion, with evidence of near-term travel to medical facilities [10]. However, mobile search is still poorly understood. Understanding the interplay of queries and the physical world promises to help with improving the quality of mobile search, e.g., by consider-ing geography, proximity, and predictions about future locations as critical aspects of the context of searches [2]. As a concrete ex-ample, consider a user who is querying for MEGAMART . If we can infer from the user X  X  recent queries and her recent locations that she intends to go to the closest Megamart store, we can rank driving di-rections highest, whereas otherwise the Megamart website might be more appropriate. A service could also provide traffic updates and status information about the target location, such as the density of crowds, lengths of lines, and specials at Megamart. Knowledge that a user is heading to a location can also be used in competitive advertising campaigns X  X imed at persuading the searcher to shift destinations to an alternate business. In another scenario, an oppor-tunistic planning application tied to search could provide guidance on visiting locations and addressing tasks on a pending to-do list (e.g., deposit checks at a bank located next to Megamart) on the way to the location [5].

We present a study of user location and locomotion as captured in geotagged queries logged from a large set of consenting mobile users. We make two main contributions. First, we show that people tend to have a primary or dominant location where they use their device (perhaps home or workplace), and that the search behavior of users changes when they are not at the primary location and also as a function of distance from that location. For example, we found that address queries become more common as users move further away from their primary location, suggesting that address queries are used more in less familiar settings. Address queries (e.g., 1 PLAZA , NYC ) are particularly interesting, as they have an obvious connection to the physical world. Second, we characterize empiri-cally how address queries are used, and we construct and evaluate a statistical model capable of predicting if an address query will be followed by the user being observed (via their geotagged queries) visiting the searched location. Finally, we discuss, in the context of prior work, the potential applications enabled by these results.
We collected datasets of location and search activities of users with consent via logs of a major mobile search provider. The data was provided via a widely available mobile search and navigation application installed on the iPhone and Android platforms. Users agreed to share their geotagged queries with the host service of the application in accordance with a published privacy statement. The log includes about a year of data logged from approximately 140K consenting users and consists of millions of search entries stored on Figur e 1: (a) Histogram of percentage of queries from primary location. (b) Percentage of queries from primary location as a function of users X  overall numbers of queries;  X  X ynamic X  users are those with less than 95% of queries from primary location (standard error bars smaller than dot size). a secure server. Each entry corresponds to a search interaction with the mobile application issued by an anonymized user (represented by a unique numerical identifier), which contains the search query, time, and GPS coordinates (i.e., when and where the query was submitted). Location information was recorded only if and when a search query was issued.
We found that people have regular patterns of mobility, charac-terized by a small number of spatial anchors at several primary lo-cations that are regularly visited X  X otentially representing such re-current locations as home, work, gyms, restaurants, clubs, and bars. Even though users X  lives may revolve around several frequent loca-tions, we simplify our analysis by considering as a reference point in our analyses the location where most querying is performed.
We divide the Earth X  X  surface into discrete cells and define the cell from which a user queries most as their primary location. We map GPS latitude/longitude coordinates to discrete map cells by rounding the GPS coordinates to three decimal places. Due to the Earth X  X  spherical shape, the resulting cells vary in size across the planet; for reference, cells are 84 meters by 110 meters in New York City. We consider in our analyses only those users who have issued at least 100 queries during the course of the logging, such that reliable primary locations could be computed.

Referring to Fig. 1(a), we observe two classes of users: (1) those who query only from their primary location, and (2) those who also query from other locations. The latter group vary by the portion of queries made from the primary location. The distribution of this percentage is very broad, with most users spending a large percent-age of their time at their primary location.

Fig. 1(b) shows the relationship between users X  overall numbers of queries and the fraction of queries made from the primary loca-tion. We see that, the higher a user X  X  absolute number of queries, the higher typically the fraction of queries from the primary loca-tion. There may be several reasons. One possibility is that heavy users may employ their mobile devices as substitutes for desktop computers at home. Another explanation could be that users have only limited information needs or cognitive capacity while mobile, whereas searching at home or at work is less constrained.
Per our definition, most queries are made from users X  primary locations. However, it is unclear what happens as users stray ever further from their respective primary locations. As a thought ex-periment, if each user visited everywhere on Earth with uniform probability, we would expect the number of queries made at dis-tance d from the primary location to increase in d , as the number of places at distances d grows with d . However, the uniform assump-tion is unrealistic, and Fig. 2(a) shows that, rather than increasing, Figur e 2: (a) Queries are more frequent closer to the primary location. (b) Probability of query being an address query in-creases with user X  X  distance from primary location. we observe a smooth decay in the number of queries as d increases. At least two factors may play a role in this diminishment: (1) Users are more likely to stay in places close to than far away from their primary location. (2) Even when conditioned and renormalized for the likelihood of a user being at a given location, the probability of querying there might be smaller the further away that location is from the primary location. Unfortunately, as we only observe locations at query time, we have no ground truth about actual user motion, so we cannot characterize the influence of these factors.
In the last section, we showed that query volume decreases as users travel further from their primary locations. We observe in the data that, in addition to quantity, the qualitative nature of queries also varies spatially. We classified the queries into 48 categories of query intent, using a proprietary classifier, where queries could be classified into multiple categories (e.g., WEATHER , HOWTO For example, we found that the fraction of queries tagged as adult content is higher at the primary location, while queries for street ad-dresses, among others, are more likely at other locations. Fig. 2(b) shows that the probability of a query being an address query rises steadily as a function of the distance between the location where the query is issued and the primary location. We consider address queries particularly interesting as they may reveal an intention to move in the physical world, in contrast to most other queries, which often signal an intention to navigate among locations on the Web. We do not know from the logs whether address queries are input to access information about entities at locations or as a means of accessing mapping and routing services. We now characterize the nature of address queries more fully. We define as an address query those queries which receive a high score for being an address by the query classifier (e.g., 47 MUNICH , ND 58352) and that could also be resolved to GPS coor-dinates by a proprietary mapping API. Each address query provides us with three locations (cf. Fig. 5(a)): the user X  X  primary location ( P ), the location at query time ( Q ), and the location of the desti-nation address ( D ). Several ways of entering address queries are conceivable: e.g., users might enter the address manually, or they might copy X  X aste it from a Web page, email, etc. Our log data does not specify details about how users input queries.

Fig. 2(b) shows that queries are more likely to be address queries as the distance to the primary location increases, up to around 100 km. The increase is intuitive: the further you are from the place you stay at most, the less likely you are to be familiar with your surroundings, and the more likely you will need to travel to unfa-miliar locations from a current location. The address query proba-Figur e 3: Histograms of distance DP from primary location to destination, (a) including all address queries, (b) stratified by distance QP from current to primary location; vertical lines mark lower bounds d on QP (cf. Section 4.1). bility peaks around 100 km, then drops and remains constant. In-terestingly, previous work [3, Fig. 2(b)] has found that the distribu-tion of distances between homes resembles the inverse of Fig. 2(b). This might indicate that users are more likely to query for addresses when they are outside of residential neighborhoods.

Next, consider Fig. 3(a), which shows a histogram of DP , the dis-tance from the primary location to the queried location. The find-ing that small values are most probable implies that users are most likely to query for locations in the immediate vicinity of their pri-mary locations. Interestingly, there is a local maximum at around 4 km from the primary location. For distances larger than this we observe ever fewer address queries. Interpreting these findings is complicated by the fact that Fig. 3(a) is based on all address queries, regardless of where they are made. To further investigate, we group address queries by their distance QP from the user X  X  primary loca-tion. In Fig. 3(b), we repeat the histogram of Fig. 3(a), but now only for address queries made at a distance of at least d from the user X  X  primary location ( QP  X  d ), for different values of d . Qualitatively, these stratified histograms are similar to the overall histogram of Fig. 3(a). In particular, destinations very close to the primary lo-cation are still most likely, regardless of how far away a query is made from the primary location. However, the 4 km hump shifts with d : now the local maximum lies at around d + 4 km.

Ignoring the uptick on the far left of Fig. 3(b), the distributions roughly resemble log normals (downward-sloped parabolas on log axes), i.e., they are long-tailed, with traveled distances normally being short but sometimes extremely long. The modes of d + might result from 4 km being a conveniently traveled distance, tak-ing just under an hour by foot or 5 min by car. We may then in-terpret the curves of Fig. 3 as the overlay of two dominant motifs on queried locations. We find that they are: (1) close to the user X  X  primary location (the far-left uptick in the figures), and (2) that they are close to the current location (the long-tailed part to the right).
To conclude our characterization of address queries, we seek to understand how prominent these two motifs are as a function of dis-tance from the primary location. Fig. 4(a) pertains to motif 1 and plots the probability that a queried address is essentially the user X  X  primary location (which we define as lying within a 100-m radius from there), as a function of how far away the user is from the pri-mary location. This probability is highest when the user queries from a location proximal to the primary location, reaches a mini-mum at around 1 km from there, and then increases with distance. The final increase may be expected as the farther away one is from one X  X   X  X ome turf X  the more likely help would be needed to find one X  X  way home. Perhaps more surprising is the finding that users often query for their primary locations while they are at the loca-tion. This may be caused by users X  exploring their neighborhood, rather than looking up a predetermined destination. Motif 2 is ex-Figur e 4: (a) Probability of a destination being very close to the primary location (defined as DP &lt; 100 m) as a function of the current distance from the primary location. (b) Probability of a destination being very close to the current location (defined as QD &lt; 100 m). Queries made from the primary location are not considered in the black curves. plored further in Fig. 4(b). The x -axis is again the distance between the user X  X  current and primary locations; the y -axis shows the prob-ability that the destination lies within 100 m from the current loca-tion. This probability is highest very close to the primary location (due to the same queries causing the high values on the far left of Fig. 4(a)) and roughly constant everywhere else.
We now apply the characterizations from above to construct a statistical model with the ability to predict whether a user will fol-low up on an address query by going to the queried destination. Such a classifier would allow us to infer near-term intentions to uti-lize a real-world resource rather than access information about it (cf. Sec. 5). As we can only sense user locations when queries are issued, we cannot identify each instance in which the user moves to the destination. We can only note the subset of instances in which the user moves to the destination and then issues a query from there. Setup. We consider for predictions address queries that are issued at least 100 m away from the destination. This ensures that the user can really move towards the destination, rather than query for it while already there, as we showed was fairly common in the pre-vious section. Next, we divide these queries into two groups of address queries: (1) Queries for which we see another query from the same user on the same day, issued from within 50 m from the destination address. A radius, such as the 50 m we chose, is neces-sary because the exact destination is a single point, with a vanish-ing probability of observing a query from exactly there. (2) Queries for which we see no such query from the same user. This distinc-tion defines the positive and negative classes for our binary classi-fication task. The resulting dataset contains around 60K address queries and is highly unbalanced, with only 4.2K (7%) positive examples. We compose features based on insights gleaned in the characterizations above, and build a binary classifier with multiple additive regression trees [4] to predict follow-up visitation. Features. We now describe the features used in the classifier. We use A to denote the user issuing the query. (U) User features (Q) Query features (including features of the destination) (C) Context features (the first seven features are present for each of the three queries preceding the input address query) Results. We evaluate our method via 10-fold cross validation. To avoid overfitting, we include all queries by the same user in the same cross-validation fold. As the dataset is unbalanced, trivially predicting a  X  X o X  on every input would result in an accuracy of 93%. To better assess the classifier X  X  power, we create a balanced dataset by subsampling negative examples randomly without replacement. We assess prediction quality in terms of area under the ROC curve (AUC). A random classification achieves an AUC of 0.5.

We evaluate different combinations of the feature groups. The most basic classifier uses no information about the input query but only characteristics of the user X  X  overall behavior (i.e., the U fea-tures). Then, we incrementally add features from the two remain-ing groups (Q and C). The observed boost in AUC provides in-sights on the utility of the additional features. The resulting ROC curves and AUC values are displayed in Fig. 5(b). We note that user features alone perform significantly better than random (AUC 0.821). Query and especially context features further improve per-formance, resulting in a maximum AUC of 0.867 when using all features. The steep initial increase of all ROC curves implies that the top-ranked predictions are particularly reliable. Also, the corre-sponding examples appear particularly obvious to predict, as even the classifier using only user features gets them right. The addi-tional feature groups are most effective farther down in the rank-ing, which follows from the ROC curves diverging more when true positive rate (i.e., recall) is high. We also evaluated our classifiers on the unbalanced dataset, obtaining similar ROC curves.
We described a study of search queries issued by people on the move, focusing on queries about addresses. We are not the first to use geotagged log data; cf. [1] for a recent survey. Venetis et al. [8] use historical address queries for ranking potential places of interest in the vicinity of the user X  X  current location. However, our characterizations and analysis of address queries are distinct from prior research. For example, we assume a single place of interest (the queried location) as given and try to predict whether the user will transition to that place.
 Figur e 5: (a) Three locations associated with each address query: the user X  X  current location Q , user X  X  primary location P , and destination location D . (b) ROC curves using different feature sets, averaged over the 10 cross-validation folds (AUC in parentheses). For feature-class abbreviations, cf. Sec. 4.2. AUCs differ significantly at p &lt; 10  X  6 for all feature set pairs.
Short-and long-term patterns of human movement are investi-gated by Sadilek and Krumm [6] and Cho et al. [3]. However, in these efforts, future locations are predicted based only on the user X  X  previous locations, independent of search queries. We anticipate that combining our query-centric approach with ideas from these works could further increase accuracy by leveraging information present in historical long-term patterns of users X  movements.
Given the potential sensitivity of location data, applications need to be aware of users X  privacy preferences and to seek their consent for different uses of location. Beyond sharing location information with service providers, privacy-sensitive applications can feasibly provide such operations as location-sensitive ranking and filtering of results while limiting access of location data to local devices.
We see rich possibilities ahead for harnessing inferences about users X  interests and forthcoming engagements with in-world re-sources. Inferences about near-and longer-term Web-to-world tran-sitions can be leveraged to provide a range of services in search and advertising, including provision of information about direc-tions and traffic information, wait times, special offers, and tasks that might be accomplished along the way.
