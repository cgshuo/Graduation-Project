 Clustering analysis has been a widely-used tool for in-silico analysis of microarray or gene expression data [9]. In real applications, however, some constraints on which genes can or cannot reside in the same cluster are often known from background knowledge. COP-k -Means [11] is a constrained version of k -Means, while COP-COBWEB [10] is a constrained version of COBWEB [6]. Constrained-k -Means [1] is a constrained version of Seeded-k -Means, which is a semi-supervised clustering algorithm. Constrained Complete-Link (CCL) [8] utilizes triangle inequality to adjust the proximity matrix according to the pair -wise constraints and then supplies the adjusted matrix to Complete-Link (CL) hierarchical agglomerative clustering. Davidson and Ravi [5] presented a constrained version of k -Means that attempts to minimize the proposed constrained vector quantization error. Although some constrained clustering algorithms have been proposed, they are mostly k -means-like methods. Consequently, they can process data with distance-based similarity measures and can not process data with non-distance-based similarity measures like correlation coefficients, which are popularly used for gene expression analysis. In this paper, we propose a new constrained clustering method, namely Correlational-Constrained Complete Link (C-CCL) , to improve the quality of hierarchical clustering for microarray data analysis with consideration of pair-wise constraints among genes, while using correla tion coefficients as similarity measure. The main idea of C-CCL is based on the Constrained Complete-Link (CCL) algorithm proposed by Klein et al. [8]. The proposed method, C-CCL, was evaluated for the performance with the correlational version of CKM (C-CKM) on a real yeast microarray dataset. The evaluations show that C-CCL outperforms C-CKM substantially in terms of clustering quality. 
The rest of the paper is organized as follows: In section 2, we demonstrate our proposed method for constrained clustering in detail. Experimental evaluations of the proposed methods are illustrated in section 3. Finally, conclusions and future work are stated in section 4. 2.1 Imitative Triangle Inequality with Respect to Correlation Coefficient Given a normalized gene expression matrix, microarray experiments. Each element e g,k means the expression value of gene g at microarray experiment k . Let X and Y denote two gene expression vectors, which are distance between vectors X and Y is defined as follows: The Pearson X  X  correlation co efficient between vectors X and Y is defined as follows: where X and Y denote the sample means of the entries of vectors  X  and  X  , respectively. Pearson X  X  corre lation coefficient only measures the degree of linear relationship between two vectors. The correlation takes values ranging from -1 (perfect negative correlation) to 1 (perfect positive correlation). The value 0 of correlation means that there is no linear relationship between two genes. 
The uncentered correlation coefficient is similar to the Pearson X  X  correlation coefficient, but is evaluated without centering: A summary of other types of distance and similarity measure can be found in [7]. The Euclidean distance measure satisfies the triangle inequality: It means that the distance between two points is the shortest distance along any path. Klein et al. utilized this property to adjust the proximity matr ix according to the pair-wise constraints [8]. However, none of the correlation-based similarity functions satisfy the triangle inequality and hence are known as semi-metric. Therefore, we shall define an imitative triangle inequality with respect to the Pearson X  X  correlation and the uncentered correlation coefficients in the following. 
Let correlation coefficient (Equation 2) can be rewritten as follows: 
Similarly, let the uncentered correlation coefficient (Equation 3) can be rewritten as Equation 5. By substituting (5) into (1), we have the form of square of Euclidean distance as follows: 
By substituting (4) and (6) into (2), we have the form of Pearson X  X  correlation and the uncentered correlation coefficients as follows: 
Therefore, the imitative triangle inequality with respect to the Pearson X  X  correlation and the uncentered correlation coefficients is defined as follows: 2.2 Algorithm of Correlational-Constrained Complete-Link (C-CCL) The main idea of the proposed C-CCL method is based on Constrained Complete-Link (CCL) algorithm [8], which utilizes triangle inequality with respect to Euclidean distance to adjust the proximity matrix acco rding to the pair-wise constraints. We extend the principle of CCL to meet the requirement for using the Pearson X  X  correlation or the uncentered correlation coefficients as similarity measure. First, we adjust the similarity matrix on the basis of the constraints and their implications. Second, we supply this adjusted matrix to a hierarchical clustering algorithm named Complete-Link (CL) hierarchical agglomer ative clustering for obtaining the final clustering results. 
There are two steps in the adjustin g process. The fi rst step is to impose the specify genes known in the same class as very similar, while two genes in different classes should be very dissimilar. In the seco nd step, we further distort other entries in the similarity matrix to reflect the following two arguments: 1. If genes X and Y are very similar, then genes that are very similar to gene X are 2. If genes X and Y are very dissimilar, then genes that are very similar to gene X are 
The pseudo-code of constraining an input similarity matrix is shown in Figure 1. In case of must-link constrains, we impose th e constraints by increasing the correlation between the must-linked pair to 1. This means that the genes in the must-linked pair are equivalent. Hence, the edge directly connecting two genes is a longest path between those genes. Notice that the weight of the edge indicates the correlation between those genes. 
After imposing the constraints, we might incur violations on the imitative triangle inequality with respect to the Pearson X  X  correlation co efficient and the uncentered correlation. For example, genes that were previously dissimilar may now become more similar along some path which skips through the constrained pairs. Therefore, we can run an all-pairs-longest-paths algo rithm to adjust the imposed matrix. Some simple modifications on the Floyd-Warshall algorithm [4] allow us to do the all-pairs-longest-paths computation. Notice that the path must satisfy the imitative triangle inequality, i.e. equation 8. 
For cannot-link constrains, we impose th e constraints by setting the correlation between the cannot-linked pair as -1, meaning that the genes in the cannot-linked pair are most dissimilar. However, we will probably violate the imitative triangle inequality, i.e. Equation (8). Therefore, we must adjust the imposed matrix to satisfy the imitative triangle inequality. Unfortunately, it is a NP-complete problem to determine whether a satisfying assignment exists when cannot-links are present [8]. 
Hence, we choose an algorithm that implicitly produces the same effect during the clustering process. The Complete-link (CL) hierarchical agglomerative clustering algorithm provides a good solution, which merges clusters in order of similarity such that the more similar clusters are merged earlier. After each merging process, CL computes similarities between the new cluster and each of the old clusters. Since CL defines the similarity between two clusters as the minimum similarity from any member of one cluster to any member of the other clusters, the propagation of the cannot-link constraints can be implied through the merging. We conducted a series of experiments to evaluate the accuracy of the C-CCL by C-CCL is compared with the C-CKM (Correlational COP-K -Means) [11], which was extended from CKM so that it can proce ss correlational data. The major modification is that the Pearson X  X  correla tion coefficient is used as similarity measure when assigning each gene to its most similar clus ter. For C-CCL, we also use the Pearson X  X  correlation coefficient as similarity measure for all experimental datasets. The quality of clustering results was measured by using Rand index and Jaccard index . 
The tested yeast sporulation data set [3] consists of expression data of 6118 yeast genes, which were sampled at seven different time points during sporulation. According to their sequential induction patterns during sporulation, Chu et al. identified and grouped some genes in the data into seven groups, namely Metabolic (52 genes), Early I (61 genes), Early II (45 genes), Early-Mid (95 genes), Middle (158 genes), Mid-Late (62 genes), and Late (4 genes). We take these 477 genes as the tested data and the seven groups as the standard for the clustering results. For the C-CCL and the C-CKM, the input parameters k (cluster number) is set as 7. We tested several different mixtures of constraints, including 1) 100% must-links (ML), 2) 100% cannot-links (CL), 3) Equal proportion (Equal Prop.) and 4) Proportion to the relative number of pair types (Data Prop.). We first obtain all must-link and cannot-link constraints for all data pairs, then we generate the tested constraint sets by randomly choosing constraints from all must-link and cannot-link constraints according to the proportion of different mixed types. The same experiment was done for 10 times and the average was taken for a statistical purpose. 
Figure 2 and 3 show the results of the C-CCL and the C-CKM for several different constraint mixes, respectively. It is obser ved that there is no sizable improvement over the unconstrained accuracy in all cases of the C-CKM. It means that C-CKM fails to take advantage of the constraints over a wide range of mix types. For C-CCL, the accuracy assessed by the Rand index rises quickly, as constraints are added in all cases except  X  X ust-Link Only X . And the C-CCL X  X  accuracy assessed by the Jaccard index rises quickly, as constraints are added in cases of  X  X qual Proportion X  and  X  X ata Proportion X . Especially, the Jaccard index rises sharply in case of  X  X qual Proportion X . By comparing all cases of the C-CCL in Figure 2 and 3, we infer that  X  X qual Proportion X  might be the best mix type and  X  X ata Proportion X  is the next best mix type for this yeast sporulation data set.  X  X ust-Link Only X  and  X  X annot-Link Only X  may not be appropriate mix types, because the problem of inappropriate merging described previously might take place. It is shown that the C-CCL takes advantage of the constraints more efficiently than C-CKM. Moreover, the correlational propagation of C-CCL allows it to substantially outperform C-CKM. Average accuracy In this paper, we propose a new constrained clustering method, namely C-CCL, to improve the quality of hierarchical clustering for microarray data analysis in the similarity measure. Through empirical evaluations on a real yeast dataset, C-CCL was shown to utilize the given gene-pair constraints effectively such that the clustering accuracy is highly enhanced in terms of the Rand and Jaccard indexes. 
In the future, we will explore some further issues. First, we will seek an imitative triangle inequality or a method to adjust the proximity with respect to the absolute correlation coefficients. Second, we will extend the C-CCL to capture the pattern structure embedded in the gene expression data sets. This might provide more insights for the functional relationships between genes. This work was supported by the Landmark Project of National Cheng Kung University, Taiwan, R.O.C. 
