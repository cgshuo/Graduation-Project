 When people plan to travel to somewh ere, the first thing comes up to their mind might be how the weather is there (e.g., Is it raining now? Or will it rain in the near future?). The weather forecast for a city is summarized from different regions which belong to this city. It cannot reflect the regional variation individually. For example, in a city, it might rain in some places while it might not rain in other places. Or some places may be located at the boundary between two cities. However, most weather stations on ly provide weather forecast for cities or famous scenic spots. There are no weather data for local areas which lie in the city. It is therefore infeasible for pe ople to obtain exact weather conditions for local regions.

That is now changing. Data from increasingly popular online social network sites (e.g., Twitter) allow us to study th e detection of rain event duration in real time in a way that is both fine-grained and massively global in scale [14]. Twitter, as a popular microblogging service, has become a new information channel for users to receive and share information. As of March 2012, there are more than 140 million active users and over 340 million tweets are created and redistributed a day[10]. Compared to news or blogs articles, Twitter messages(tweets) have 140-character-message limit in length, resulting in a short and ungrammatical textual feature. Twitter users tend to use abbreviations and acronyms (e.g., IC refers to I see, BTW refers to By the way). To detect the rain events by using tweets collected from Twitter is therefore a rea l challenge due to the heterogeneous and noisy nature of the data. On the contrary, such limitation enables users to update information instantly. With the popularity of mobile device, Twitter users worldwide act as a group of sensors, forming a social sensor network to share what is happening around (e.g., tsunami, rain, personal status), making it possible to real-time report the rain event which happened anywhere at any time.

However, except the limitations of Twi tter in nature mentioned above, the rain event detection might still be potentially influenced by many external factors (e.g., geo-location, time, human behavior). By considering the time and location information, we can detect target events and estimate location of target events. As a tweet is often associated with a post time and a geo-location, we can detect when and where a rain event happens. For example, a user might make a tweet such as  X  X ow it is rainin g X  at 7:13pm on December 24. Consequently, if a rain event happens in an oceanic area, it is more difficult to locate it precisely from tweets. It also becomes more difficult to make good estimation in less populated areas. These two cases imply that practicability of detection of rain events mainly relies on the number and spatial dispersion of Twitter users. The way people post tweets changes dynamically during a day. The number of tweets grows from the early morning and peak at midnight. It should be noted that tweets around the time and geographically close to such areas would be considered alternatively as approximate indicators to detect rain ev ents happened in such queried areas at a given time.

As mentioned above, we conjecture that the spatial and temporal features may play the important role in rain event detection. However, to the best of our knowledge, there are no previous resear ch studies targeted to a spatiotemporal issue in detection of rain events. Thus, it remains unclear to what extent and in what way the effects of time and geography would be imposed on the detection of rain event. In this paper, we therefore focus on understanding the influence of time and geographic on the detection of rain event by aggregating Twitter messages (tweets). Our study provides clea r evidences that the spatiotemporal feature is an essential factor in detection of rain event duration. In the literature, several approaches a re proposed to detect events. Allan [1] studied the topic detection and tracking from documents. Allan et al. [3] and Yang et al. [15] also use documents to do the on-line event detection. They calculate similarity among the existing documents and new coming one by the incremental clustering to d etermine a new generated event. Besides, there are many previous works studied the event de tection on web pages. However, their proposed methods might not be applicable to deal with the detection of the rain events from microblogs. Microblogs are often shorter and more frequent updated than documents and blogs. Therefore, conventional statistic-based term weighting strategies like frequency might not reliable in analyzing microblog contents.

Some researches studied the event detection problem from the view of signal by analyzing the frequency of the time series data. Chen et al. [5] and Jianshu et al. [9] consider words on Twitter and tags of photos on Flickr as the energy, the events are then detected by analyzin g the energy distribution with wavelet transform. He et al. [7] analyzed words in both time and frequency domain with Fourier transform. Such methods can detect well while signal alters suddenly. However, the rain events usually have the duration such that we need not only detect the beginning but the ending whose variation is not obvious. Cataldi et al. [4] introduced the aging theory to emerged terms and group them into some topics. Sakaki et al. [12] studied whethe r users observe the effect of earthquake and locate it in a probability-based approach. The same idea can also be applied to other short length document. Teevan et al. [13] traced the trajectory of storm by the query logs of a search engine.
 Various studies have been made of the analysis of microblogging data (e.g., Twitter) from spatial and temporal perspectives. Sakaki et al. [12] introduced a concept of social sensors to detect eart hquake event in real time. They examined the time-series data to create a temporal model to calculate the probability of an event occurrence. Spatial models such as Kalman filtering and particle filtering are then proposed to estimate the locati ons of events. Java et al. [8] considered both geographical and topological properties from twitters to analyze the distri-bution of users and their tweets. MacEachren et al. [11] used the geographical information of tweets to visualize the location and content of tweets.
Even different from general events, weather events are usually related to re-gional and local information [13]. Cox and Plale [6] used the Twitter data to improve the weather observation. Sakaki et al. [12] determined whether a user observes the earthquake. But the weather events are always with the duration such that we cannot detect only the hap pening of an event like first story in topic detection and tracking problem (TDT problem) [2] but all process of the event. Unlike the traditional TDT problem, the duration of rain events are usu-ally shorter. The strength of signal is a lso weaker than usual events in the later stage in the duration. Our goal is using the twitter data to determine whether it rains or not for anywhere and anytime. For any locations we are interested in their weather conditions, we collect tweets nearby them a nd use corresponding tweets to create their own signals so as to detect the rai n events. In the rest of this paper, we use L j and T i to represent locations and tweets, respectively. 3.1 Uniform Weighted Signal As shown in Figure 1, we segment time line into equal size. The value in each time slot is the summation of score ( T i ), where T i is tweets posted in the period and score ( T i ) is defined as follows: The score function preserves all rain rela ted tweets and views them identical. In the implementation, we construct a classifier trained by support vector machine (SVM) to filter out the tweets not talking about rain. The signal in Figure 1 now reflects the probability of the whether it rains in L j in each time slot to a certain extent. The higher the value in a time slot, the higher the chance that it rains in L j at that time.
 3.2 Temporal and Geographical Weighted Signal We furthermore take time and geographic factors into consideration.
 Temporal Aspect. For the same location but different time, we observe that the number of rain-related tweets in a day changes significantly (Figure 2). Many twitter users like to post tweets in the night and the number of tweets drops dramatically in the early morning. The phenomenon probably makes detecting rain event in those  X  X nactive X  period hard . Moreover, the durations of rain events are often less than a day, also highlighting the importance of daily dynamics. Geographical Aspect. For the same time but different locations, we also find the similar situation. Figure 3 is the sampling tweets distribution of several locations. In this example, we find the distributions in these locations are not uniform. Tweets in some sub-regions are quite dense while some are very sparse. The serious unbalance may make the outcome be dominated by dense sub-regions and thus can X  X  determine the weather condition objectively.

We also observe an interesting phenomenon that the degree of people X  X  in-terest in rain( RID ( L j )) varies in different regions. Before further discussing the relation between them, we need to define how to measure the  X  X egree of interest X  first. For each location L j , we calculate the number of rain related tweets, divided by the number of the tweets in each raining time slot, and then set RID ( L j )by averaging the values over all of the raining time slots. The measurement assumes users post more rain related tweets if the y are more interested in rain events. Using normalization instead of frequency is more proper to measure RID ( L j ) since the population varies among regions. Figure 4 shows the relation between RID ( L j ) and their corresponding raining frequency. After taking logarithm, we find they have negative correlation with R 2 =0.73. Surprisingly, it quite fits power law. The finding suggests if it seldom rains in a region, the rain events tend to catch one X  X  eye. Thus, more infor mation about weather condition will be shared on microblogging. The experiment demonstrates how geographical factor influences the signals in Figure 1 again.
 Weighted Score Function. All of above observations suggest temporal and geographical factors affect signals, we therefore tune the score function score ( T i ) to reflect their influences. The updated score function is named weighted score, donated as WScore ( T i ), and defined as follow: where Tmp ( T i )and Geo ( T i ) are the temporal and geographical weights, respectively.
 In our weighting function Tmp ( T i ),  X  X he users X  who are interested in rain are those users posting rain related tweets, which can be learned from training data. Geo ( T i ) contains two parts. In the denominator, we divide location L j into 4 by 4 sub-regions. Then a tweet T i is normalized according to the population of a sub-region where it is posted. The numerator is a function proportional to probability density function of a exponential distribution. It considers the distance between L j and T i (i.e., the location where T i is posted). The farther the distance between L j and T i is , the lower reliability of T i is to identify the weather condition of L j . The parameter  X  (  X   X  0) is used to control the weight. The distance factor will be emphasized if we decrease  X  . 3.3 Event Detection and Modeling Now we use the weighted signal to detect rain events and model their life cycles. Here we borrow the aging theory based method proposed in [14]. The method uses a wavelet based method to detect the burstiness of signal as the beginning of rain events. Since users don X  X  always k eep their interest in the rain event, the signal will decrease as time goes by. In this duration of rain, exponential function is applied to model the decay of signal. To determine when the rain ends, finally a threshold based method is proposed. The illustration of the model is shown in Figure 5.
 To evaluate the performance of our system, we gather the weather informa-tion(rain event) from thirteen weather stations in American and tweets posted around these stations(20 miles  X  20 miles) over a period of three months, from November 1, 2011 to January 31, 2012. We measure the performance by three-fold cross validation on four indicators including precision, recall, F1-score and accuracy. The definitions of four indicators are defined as follows: We compare our performance with a threshold based method[14]. If the value of uniform weighted signal in any time slot is larger than the threshold, then the method judges the time slot as raining. We hope the system alarms everytime when it rains, but we do not expect many fa lse alarms. Therefore, F1-score is adopted as the main indicator. Results are shown in Table 1. We can see that the performance of T-Signal is improved on recall. When we add the time factor into our model, the more desolate time slot will be more sensitive and more raining slots can be detected. Inversely, G-Signal improves uniform-Signal on precision. It is caused by weighting tweets with the geographical factor, and thus closer users have larger weights . Then the model can detect events more exactly. Overall, our experiments show that the spatiotemporal factor is helpful to detect the duration of a rain event.

We also repeat the experiments under various  X   X  X  (in Geo ( T i )) to see how the region size we use to crawl data aff ects the performance. The tendency in precision and recall is plotted in Figure 6. Smaller regions lead to lower recall and higher precision. For location L j , merely using its nearby tweets is better in identifying its weather condition. However, not every location L j always has sufficient nearby tweets, which will lead to the low recall.

We further categorize rain as heavy, normal and light, and then examine their properties. In our experiment, recall values for three are 0.9173(heavy), 0.7200(normal) and 0.6633(light) using T+G-Signal. The average number of rain related tweets normalized by the numbe r of total tweets during heavy rain is 0.0598, which is greater than 0.0404 and 0.0301 for normal rain and light rain respectively. More tweets are posted dur ing the more serious events, making it easier to detect in these periods.

As we discussed in Section 3.2 (geographical aspect), the location of users is an important factor to measure reliabilities of tweets. It also suggests that the bias of location affects performance a lot. For instance, station 0 and station 2 are near to each other, but their perfo rmance is quite different (Table 2). As shown in Figure 3, the users in station 2 are bias to upper right, namely, the direction of station 0. In contrast, the us ers in station 0 are closer to the center. This example may suggest the performan ce will be better if the users are closer to the station. In the case of station 7, it is limited by the topography(Figures 3 and 8) but it also has the good performance. The station 9 is another extreme instance. The users of station 9 are very close to the center and it results in a great performance.
 In the previous section, we have showed th at our system is pract ical for detecting the rain events. Here we further want to understand whether we can predict weather conditions in the next n time slots. In Figure 9 we plot the signal during a rain event. From our observation, we believe there are two possible directions for weather prediction. First, the signal of L j in this example starts to rise before it starts raining in L j . A possible explanation is that before it rains in L j ,itrains near L j so the users nearby post rain-relat ed tweets. We therefore can detect rain events before it occurs. Second, whether it rains or not in consecutive time slots is not independent, making it possible to use previous data to infer the weather conditions in the near future.

We extend the aging based model [14] an d construct a simple weather predic-tion system by modeling the life cycles of rain events. For a location L j ,after catching the beginning of a rain event, we start to monitor its signal. The signal generally doesn X  X  reach maximum at once since users need time to respond the new event. To predict if it is still raining in the following time slots, we always assume the signal will decay exponentia lly(see Figure 5). This is because we have a few hints about future. What we know is how many tweets in the current time slot. If the current signal is strong enough, the decayed signal we expect in the next slot will not be lower than a given threshold. Then we predict the rain event will continue; otherwise, it will stop. Table 3 displays the results.
As we expect, the performance drops when the time we X  X  like to predict is farther from now, but it doesn X  X  drop dramatically. We get 0.579 in F1-score for predicting if it still rains two hours later. One way to improve the performance is considering meteorologi cal knowledge simultaneous ly. For instance, the length of rain in one location may vary with season and thus we can use an adaptive threshold instead a static one. In this paper, we discuss the influence of spatiotemporal factor on rain events detection and prediction. The number of tweets changes in a day, making it hard to detect events on those  X  X nactive X  periods. The different distribution of population also leads to similar problem. M oreover, the degree of users X  interest in rain varies with regions. We, therefore, re-weight tweets according to their spatial and temporal properties. Our ex periment show its effectiveness in the detection of rain event duration. Differe nt settings have been carefully examined. Finally, a simple prediction model is proposed to forecast weather conditions.
