 Paddy sustains two-thirds of the world X  X  population, so the paddy quality is very important. During the storage, a number of physicochemical and physiological changes occur, which is usually termed aging. These changes that include pasting properties, colour, flavour, and composition affect rice quality directly [1]. So a quick, accurate and nondestructive way is needed to classify the paddy seeds of dif-ferent storage periods. Near infrared spectroscopy is the electro-magnetic wave from 780 to 2526 nanometers. The analytical capabilities of NIRS rely on the broad and repetitive absorption bands of carbon-hydrogen, oxygen-hydrogen, and nitrogen-hydrogen bands. It reflects the information of the structure, composition and state information of molecule. The overlapping of absorption bands makes direct interpre-tation of absorption spectra difficultly. So pattern recognition will play a more important role in the Vis/NIR technique development. Coffee varieties [2], melon genotypes [3], apple varieties [4], waxberry varieties [5], were classified using pat-tern recognition tools based on near infrared spectroscopy technique. However, few researches focused on discriminating the paddy seeds of different storage periods based on Vis/NIR spectroscopy technique. 
NIR spectroscopy technique has been effectively combined with pattern recogni-tion tools, such as multiple partial least squares (MPLS), principal component analy-sis [6][7] and discriminant analysis for classification, discrimination and authentica-tion purposes. Linear discriminant analysis (LDA) [8] [9] failed with many variables, common solutions are to reduce the dimension of the predictor matrix by using data compressed arithmetic and then apply LDA. Wavelet transform is a very effective way to extract the useful information from mass spectral data [10] [11]. PCA can visualize the variability in a dataset, which can lead to the discovery of unknown structures [6][7]. In qualitative and quantitative analysis, artificial neural networks are more and more widely applied during the past several years [12]. Compared with SIMCA, PLS, DPLS, QDA and LDA et al method, the advantage of ANN is its anti-jamming, anti-noise and robust nonlinear transfer ability [12] [13]. But the shortcom-ing of ANN is difficult to be convergent when the input data are too mass. So the spectral data must be compressed as low-dimension data before ANN. 
Inspired by this, we presented a novel pattern recognition tool for differentiating the paddy seeds of different storage periods by integrating wavelet transform, princi-pal component analysis, and artificial neural network models. The wavelet transform was used to eliminate noises and extract features from the spectra, and the features were visualized in PCs space by principal component analysis, then the PCs which were closely correlative with the classes of these samples were used as the input of an ANN model for discriminating the classes of samples with different storage periods. 2.1 Materials A total of 210 samples of paddy seeds were prepared for this experiment, they were obtained from Grain Supply Center of Hangzhou, Zhejiang province, China. These samples were harvested in four consecutive years from 2002 to 2005. The correspond-ing samples have been stored for one year (OYS), two year (TWYS), three year (THYS) and four year (FYS) (Table 1). All these samples were stored without any chemical or biological preservative treatment. Two year early-indica type rice Jiangxi,China Hangzhou,China 51 Three year early-indica type rice Jiangxi,China Hangzhou,China 52 
Four year early-indica type rice Jiangxi,China Hangzhou,China 53 2.2 Vis/NIR Spectra Collection A Vis/NIR spectroradiometer (H andheld FieldSpec) was used to collect spectra from 325 to 1075 nm at 3.5 nm bandwidth. Then all data were interpolated to 1-nm inter-vals. The uniform glass vessel (diameter: d=60mm, height: h=14mm) was used to load the paddy seeds, and the vessel was filled with samples. The spectroradiometer was fixed at 120 mm above the surface of the sample with the field of view (FOV) of 25 X . The light source of a Lowell pro-lam 14.5 V Bulb tungsten halogen that could be used both in the visible and near infrared region was placed 100 mm above the sample surface. The angle between the incident ligh t and the spectroradiometer detector was about 45 o . 
A 100 mm 2 thick Teflon  X  disk was used as the optical reference standard for the system. A reflectance (R) was calculated by comparing spectral energy reflected from the sample with the standard reference. In order to reduce the operating error, for each sample, three reflection spectra were taken at three equidistant rotation positions of approximately 120 o around the center of the sample. For each reflection spectrum the scan number was 10 at exactly the same position, a total scan for each example was 30. Due to the imperfection in the own system, a big scattering affected the accuracy of measurement could be observed at the beginning and the end of the spectral data, considerations were based on this range of wavelengths. The absorbance spectra of the four classes can be seen in fig. 1. 2.3 Pattern Recognition Tools The wavelet transform (WT) enables the signal (spectrum) to be analyzed as a sum of functions (wavelets) with different spatial and frequency properties [11]. The gener-ated waveforms are analyzed with wavelet multiresolution analysis to extract sub-band information from the spectral signal. Principal component analysis (PCA) is a very effective data reduction technique for spectral data. It summarizes data by form-study, the spectral data was analyzed by principal component analysis (PCA) and defective information was eliminated. Artificial neural networks (ANN) are known as useful tools for pattern recognition, identification, and classification. A neural net-work model can determine the input-output relationships for a complicated system. And such a model can provide data approximation and signal-filtering functions be-yond optimal linear techniques [14]. PCA was performed using the Unscrambler 9.5 software (CAMO). The matlab Wavelet Toolbox was used to perform the standard wavelet transform using the pre-defined wavelet filters. The matlab Neural Networks Toolbox was used to build the back-propagation neural network model. Fig.1 shows the average absorbance spectra of samples of four different storage peri-ods: (a) paddy seeds of one year storage (OYS) (b) paddy seeds of two year storage (TWYS) (c) paddy seeds of three year storage (THYS) and (d) paddy seeds of four year storage (FYS). Seemingly, there isn't a remarkable difference among these four classes in these spectral range. After comparing in detail, some differences can be detected from 600 nm to 700 nm, which makes it possible to discriminate the sam-ples with difference aging. The differences may be caused by the different internal spectra (shown in fig.1.) is mostly due to system noise, which can be eliminated by wavelet transform. 3.1 Noises Removal and Dimension Reduction by Wavelet Transform In this research, the wavelet transform was used to eliminate noises and select fea-tures from the raw spectra. The WT was implemented using a dyadic filter tree. After trying, daubechies2 (db2) wavelet was selected as the suitable function to decompose the spectral signal. Then the spectral data, which have 210 rows and 601 columns, were decomposed at third level by db2 wavelet. To see the effect of WT, the signal was reconstructed with low-frequency coefficient (cA 3 ) and high-frequency coeffi-cient (cD 1 , cD 2 , cD 3 ). The reconstructed signal based on wavelet coefficients at third level decomposition can be seen in fig.2. The first layer plot X is a raw spectra. The second layer plot cA 3 ' is the reconstructed signal based on low-frequency coefficient coefficient (cD 3 ). The fourth layer plot cD2' is the reconstructed signal based on high-frequency coefficient (cD 2 ). The fifth layer plot cD 1 ' is the reconstructed signal based on high-frequency coefficient (cD 1 ). It can be seen that the signals cD 3 ', cD 2 ' and cD 1 ' contain mass high-frequency noise, especially at the beginning and end of this curve. The high-frequency coefficients contain ma ss noise and repeated information; it can barely give any help to classify the samples of different storage periods [15]. The signal cA3' reconstructed by low-frequency coefficient (cA 3 ) is very similar with the raw signal X. So the low-frequency coefficient (cA 3 ) (77-dimension) was used to replace the spectra. 3.2 Data Visualization by Principal Components Analysis The principal component analysis aimed to mapping the wavelet coefficients in PCs space with the largest variability. PCA was performed on the 77-wavelet components of each sample, the dimensionality of the wavelet components was reduced from 77 to 20 by PCA, and hence 20 principal components could be achieved. If the scores of a principal component were organized according to the number of the sample, a new image could be created. The new image was then called  X  X CA scores image X . The advantage of using principal components scores image was that it could display the clustering information of classes from multiple variables. 
The scatter image of PC1 (variability, 84.4%) vs. PC2 (variability, 9.7%) vs. PC3 three principal components were 98.3%( seen in Table 2). In other words, the PC1,PC2 and PC3 accounted for 98.3% of the data variance. The image gives distrib-uting information of four classes samples. In this scatter image, the four classes sam-are composed as four well-defined groups. The differences among OYS samples, TWYS samples, THYS samples and FYS samples are pronounced. While, the boundaries of samples of four classes aren X  X  clear in fig.1. It means that spectral diag-nostic information can be showed clearer in PCs space than in raw spectral absorb-ance image. It can be concluded that the spectral diagnostic information can be ex-tracted from raw spectra by WT and PCA. The extracted diagnostic information is strong correlation with storage period. But the TWYS and FYS samples are over-lapped in the image. A more accuracy and clear separation need to be made. So, an artificial neural network algorithm was applied to classify the four classes with digital discriminative result. PCA shows that the cumulative reliabilities of the first 8 princi-pal components are 99.9%. It means these components can explain 99.9% of the data variances, and the rest components don't give more useful information for detecting the classes. 3.3 Discriminating Samples by ANN The design process of this BP neural network model consists of neural network topo-logical architecture design, training data collection, neural network training and vali-dation. A typical topological structure for a BP network consists of an input layer, at least one hidden layer and an output layer. For a BP network, a very important theo-rem is that a BP network with one hidden layer can approach any consecutive func-tion in closed interval. The whole samples were separated randomly into two parts, the randomly selected 170 samples were used as calibration samples, and the remains 40 were used as prediction samples. 
The first eight principal components from PCA were used as input vector. So the node of input layer was 8. As there were samples of four different classes, the output vectors of ANN were assumed to be binary system vectors of four bits. The node of output layer was 4. The transfer function of hidden layer was tansig function. The The goal error was set as 0.001. The maximum time of training was set as 2000. The threshold value of error was 0.1. The number of neurons in hidden layers was opti-mized by "trial-and-error" method. It can be found that there was a smaller error and fewer training cycles when the node number of hidden layer was set as 8. A BP neural network model with three-layers was built. The optimal topology structure was 8-8-4 for three-layer neural network. 
The discrimination results of calibration sample set and prediction sample set are summarized in table 2. The neural network yielded a very high discrimination accu-racy, all of the OYS, TWYS and THYS samples were correctly classified for the 
Note: OYS: paddy seeds of one year storage, TWYS: paddy seeds of two year stor-age, THYS: paddy seeds of three year storage, FYS: paddy seeds of four year storage, No.: number, FNo.: fault No., Ar: accuracy rate. calibration and prediction sample sets respectively. The FYS paddy seeds were more difficult to classify in prediction. However, 90% of FYS samples were correctly clas-sified in the prediction set. The total accuracy rate was 97.5% for all the four classes. The hybrid pattern recognition obtained wonderful performance for discriminating paddy seeds of four different storage periods based on Vis/NIRS technique. The reali-zation of hybrid pattern recognition needed two steps, the first step was noise removal and feature extraction, which was implemented by wavelet transform and principal component analysis. Subsequently, the characteristic spectral information was used as input of an ANN model. This model achieved a very good result for discriminating the four classes, which meant Vis/NIR spectroscopy could be used to classify paddy seeds of different storage periods non-destructively. In short, the hybrid pattern rec-ognition has substantial potential for mining information from spectral data and dis-criminating different classes. 
