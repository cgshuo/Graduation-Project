 In this paper, we develop a time series approach, based on Dynamic Linear Models (DLM), to estimate the impact of ad impressions on the daily number of commercial actions when no user tracking is possible. The proposed method uses aggregate data, and hence it is simple to implement without expensive infrastructure. Specifically, we model the impact of daily number of ad impressions in daily number of commercial actions. We incorporate persistence of campaign effects on actions assuming a decay factor. We relax the assumption of a linear impact of ads on actions using the log-transformation. We also account for outliers with long-tailed distributions fitted and estimated automatically without a pre-defined threshold. This is applied to observational data post-campaign and does not require an experimental set-up. We apply the method to data from one commercial ad network on 2,885 campaigns for 1,251 products during six months, to calibrate and perform model selection. We set up a randomized experiment for two campaigns where user tracking is feasible. We find that the output of the proposed method is consistent with the results of A/B testing with similar confidence intervals.
 J.4 [ Computer Applications ]: Social and Behavioral Sci-ences X  Economics ;G.3[ Mathematics of Computing ]: Probability and Statistics X  Time Series Analysis Algorithms, Economics, Management, Measurement Attribution, DLM, Marketing, Online Display Advertising  X  Main contact.
 on actions that automatically provides different lags. Our approach process outliers and account for non-linear impact of impressions using a logarithmic model.

This paper is organized as follows. In section 2, we present the proposed model. We also define the measures to evalu-ate campaigns. In section 3, we provide results for several variants of the method under different assumptions. We compare our results with A/B testing for two campaigns. In section 4 we discuss the main findings and future work.
Let T be the total number of days we observe commercial actions and impressions, and N the number of advertising campaigns running during the observed time period. The in-dices: t denotes discrete time in days, c denotes a particular campaign, and k refers to the number of forecast look ahead steps. Let X ( c ) t be the number of ad impressions at time t for campaign c ,and Y t be the number of actions at time t for a given product. Y 1: t represents the vector of [ Y 1 ,...,Y t ].
We define a latent state  X  t to be a stochastic process de-scribing the behavior of the series. Let Y t be normally dis-tributed given  X  t ,and  X  t be normally distributed given  X  t  X  1 : G t is the evolution matrix, F t is the observation matrix,  X  t is the observational noise with variance V t ,and w t is the state evolution with covariance matrix W t . This is denoted as a Dynamic Linear Model (DLM) [12]. By choosing G t and F t , we can model different types of behavior of the series.
To model the effect of impressions on the actions, we as-sume a persistence component as suggested in previous work [5]. To verify this effect, we estimate the distribution of the number of days before the last impression is delivered to a user who performs a commercial action. Fig 1 shows this distribution for two campaigns.

Let  X  ( c ) t be the effect of ad impressions on the number actions at time t for campaign c .  X  ( c ) represents the constant rate of decay of this effect.  X  ( c ) t is the dynamic impact per impression. For N campaigns we have: By defining  X  ( c ) t , we automatically fit the number of previous days with impact on Y t through  X  ( c ) unlike modeling a fixed lag in autoregressive models [5]. We incorporate indepen-dent  X  ( c ) and  X  ( c ) t for each campaign. Then, we write this model as a DLM, based on the definition of Eq 1, as follows:
To relax the assumption of a linear impact of ad impres-sions on actions, we use the log transformation for both vari-ables. We consider the following model for one campaign: If  X  t &lt; 1, the effect of ad impressions on actions decreases as more of them are shown. As depicted in Fig 5, the daily number of impressions is more dynamically changing than the number of commercial actions. By assuming this model, we smooth these changes of the time series of impressions. Since this is a monotonic function f ( Y t ), the cumulative dis-tribution for Y t is the same as the cumulative distribution of the inverse transform of the Z t , cdf ( Y t )= cdf ( f ( Y t )). Thus, for model fitting we transform X 1: T ,Y 1: T to the new space X
Given that commercial action data is collected by adver-tisers, there is no control over this process by the Ad net-work [9]. Then, we often observe drastic changes in the daily number of actions that can increase the estimation variance. One approach to handle outliers is to weight the observations based on the variance modeled for each output Y t [12]. For this analysis, we use a simplification of the model presented in [10]. We switch from using the Normal distribution for Y t to using a t -distribution with a set of degrees of free-dom to choose from. We use the Normal-Gamma mixture to represent this t -distribution.

Fig 2(b) shows the graphical model for all campaigns with outliers handling. Main changes are introduced at the ob-servation level with a hierarchical model to handle individ-ual number of degrees of freedom for each Y t . Algorithm 1 shows the generative model for the observational variance when we process the outliers. We now have independent variances for each observation. Given on  X  1: T ,wehavea DLM model M (0: M ) with V  X  t =  X   X  1 t V for t =1 ,...,T .The possible  X  t values are predefined a priori.
We assume all parameters to be random variables and fol-low a Bayesian approach. Observations are the daily number of actions and impressions for each campaign. Algorithm 2 defines the Gibbs sampling approach to fit the model. We sample  X  1: T |  X  ,  X  ,D 1: T based on Forward Filtering Backward Sampling (FFBS) method explained in Appendix A. To find under-estimate the model fitting. To evaluate model pre-diction, we use one-step-ahead forecast estimates  X  Y k =1 t to calculate MRSE , denoted as MRSE k =1 .

We analyze all the transactions for 2 , 885 campaigns asso-ciated with 1 , 251 products during six months, from January 1 st to June 31 st , 2011. We measure campaign performances for each product independently. We use N 0 = 1000 samples for burn-in and N s = 4000 for the posterior distribution.
We show qualitative results to analyze the model perfor-mance and the outlier handling. We test different variants, displayed in table 1. M Agg is the model where impressions from all campaigns are aggregated. Our goal is two fold: 1)Modeling the impact of the set of campaigns as a whole. 2)Hierarchically disaggregating campaigns to evaluate the impact in detailed. Finally, we evaluate the fitting improve-ment provided by campaigns using R 2 .

Fig 4 shows the model fitting and proportion of actions attributed to the campaign shown in Fig 3 using M s  X  log. The seasonal base model seems to be a good choice given the weekly periodicities in the action series. Fig 5 shows the actions and impressions with the model fitting for a prod-uct with outliers Y t is likely to be an outlier when  X   X  t is low. If sudden changes are observed in the daily actions, the outlier handling weights these changes automatically. Table 2 shows the fitting and prediction results. Perfor-mance estimates based on MRSE instead of MRSE  X  =1 are better because they diminish the effect of the outliers on the measure. We observe better performance when we in-clude the log transformation consistently. We observe that weekly seasonal base model results show significantly better fitting than the random walk. The predictive power of both models is equivalent. The fitting performance of the con-strained models is lower than without this constraint. This is expected as the imposed constraint might not be optimal for the MRSE . Table 3 shows the campaign performance. tor) or not (exposed and non-actor). For the control group, we select the users who are targeted first but are not se-lected for exposure randomly. We find if the user performs an action (actor and non-exposed) or not (non-actor and non-exposed). We use standard Beta conjugate prior dis-tribution to find the probability of action by sampling. We estimate the change in action probability respect to the con-trol group (lift). For our method, we find the mean increase of actions attributed to the campaign respect to those at-tributed to other components. Table 5 shows the compari-son. Even when a controlled experiment is run, sparsity of actions is an issue. We have one positive significant cam-paign at the 90% confidence level and one leaning towards positive effect for both A/B testing and M  X  log. For posi-tively constrained contributions, we have similar estimates but with larger confidence interval. The median estimates for the two variants tested fall in the confidence interval of A/B testing, except M  X  log for campaign 2. Similarly, the median estimates for A/B testing fall in the confidence in-tervals of the proposed method.
We have presented a time series based approach to mea-sure the effects of online display marketing campaigns when user tracking is not available. We have modeled the effect of ad impressions on commercial actions through a DLM, and provided daily effect estimates. We have incorporated per-sistence of campaign effects, through a decay factor, and accounted for outliers automatically without any thresh-old. We have presented several different campaign evalu-ation measures. These are intended to provide a spectrum of choices at the time of evaluating a campaign. We have found that a model in the log-scale is more effective to de-scribe the relationship between ad impressions and commer-cial actions. Results indicate that a seasonal base model will give less attribution to campaigns. We observed several campaigns where the effect is not statistically significant. This is consistent with A/B testing results. We consider this challenge as future work for commercial actions. Com-bining A/B testing and the dynamic analysis of campaign effects is a direction for improvement when user tracking is available. Our ultimate goal is to provide daily significant estimates of the campaign effects on commercial actions.
This work is partially funded by CONACYT UC-MEXUS grant 194880, CITRIS and AOL Faculty Award.
