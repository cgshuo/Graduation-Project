 Department of Mathematics, Stanford University Facundo M  X  emoli MEMOLI @ MATH . OSU . EDU Alejandro Ribeiro, Santiago Segarra { ARIBEIRO , SSEGARRA } Given a network of interactions, hierarchical clustering methods determine a dendrogram, i.e. a family of nested partitions indexed by a resolution parameter. Clusters that arise correspond to sets of nodes that are more similar to each other than to the rest and, as such, can be used to study the formation of communities ( Shi &amp; Malik , 2000 ; Newman works, in which the dissimilarity from node x to node x 0 may differ from the one from x 0 to x ( Saito &amp; Yadohisa , 2004 ) , the determination of said clusters is not a straight-forward generalization of the methods used to cluster sym-&amp; Pentney , 2007 ; Zhao &amp; Karypis , 2005 ) . This difficulty motivates formal developments whereby hi-erarchical clustering methods are constructed as those that are admissible with respect to some reasonable properties damental distinction between symmetric and asymmetric networks is that while it is easy to obtain uniqueness results of methods that are admissible for the latter ( Carlsson et al. , 2013 ) . Although one could conceive of imposing further restrictions to winnow the space of admissible methods for clustering asymmetric networks, it is actually reasonable that multiple methods should exist. Since dendrograms are symmetric structures one has to make a decision as to how to derive symmetry from an asymmetric dataset and there are different stages of the clustering process at which such symmetrization can be carried out ( Carlsson et al. , 2013 ) . In a sense, there is a fundamental mismatch between having a network of asymmetric relations as input and a symmetric dendrogram as output.
 This paper develops a generalization of dendrograms and hierarchical clustering methods to allow for asymmetric output structures. We refer to these asymmetric structures as quasi-dendrograms and to the procedures that gener-ate them as hierarchical quasi-clustering methods. Since the symmetry in dendrograms can be traced back to the symmetry of equivalence relations we start by defining a quasi-equivalence relation as one that is reflexive and transitive but not necessarily symmetric (Section 3 ). We then define a quasi-partition as the structure induced by a quasi-equivalence relation, a quasi-dendrogram as a nested collection of quasi-partitions, and a hierarchical quasi-clustering method as a map from the space of networks to the space of quasi-dendrograms (Section 3.1 ). Quasi-partitions are similar to regular partitions in that they con-tain disjoint blocks of nodes but they also include an influ-ence structure between the blocks derived from the asym-metry in the original network. This influence structure de-fines a partial order over the blocks ( Harzheim , 2005 ) . We proceed to study admissibility of quasi-clustering meth-ods with respect to the directed axioms of value and trans-formation. The Directed Axiom of Value states that the quasi-clustering of a network of two nodes is the net-work itself. The Directed Axiom of Transformation states that reducing dissimilarities cannot lead to looser quasi-clusters. We show that there is a unique quasi-clustering method admissible with respect to these axioms and that this method is an asymmetric version of the single link-age clustering method (Section 3.4 ). The analysis in this section hinges upon an equivalence between quasi-dendrograms and quasi-ultrametrics (Section 3.2 ) that gen-eralizes the well-known equivalence between dendrograms and ultrametrics ( Jardine &amp; Sibson , 1971 ) . Exploiting the fact that quasi-dendrograms can be repre-sented by quasi-ultrametrics, we propose a quantitative no-tion of stability of quasi-clustering methods (Section 3.5 ). We prove that the unique method from Section 3.4 is sta-ble in the sense that we propose. We also establish several invariance properties enjoyed by this method.
 In order to apply the quasi-clustering method to real data, we derive an algorithm based on matrix powers in a dioid algebra ( Gondran &amp; Minoux , 2008 ) (Section 3.6 ). As an example, we cluster a network that contains information about the internal migration between states of the United States for the year 2011 (Section 4 ). The quasi-clustering output unveils that migration is dominated by geographical proximity. Moreover, by exploiting the asymmetric influ-ence between clusters, one can show the migrational influ-ence of California over the West Coast.
 Proofs of results in this paper not contained in the main body can be found in the supplementary material. A network N is a pair ( X,A X ) where X is a finite set of points or nodes and A X : X  X  X ! R + is a dissimilar-ity function. The value A X ( x,x 0 ) is assumed to be non-negative for all pairs ( x,x 0 ) 2 X  X  X and 0 if and only if x = x 0 . However, A X need not satisfy the triangle in-equality and may be asymmetric in that it is possible to define N as the set of all networks. Networks N 2 N can have different node sets X and different dissimilarities A A conventional non-hierarchical clustering of the set X is a partition P , i.e., a collection of sets P = { B 1 ,...,B which are pairwise disjoint and required to cover X . The sets B 1 ,B 2 ,...B J are called the blocks of P and repre-sent clusters . A partition P = { B 1 ,...,B J } of X induces and is induced by an equivalence relation  X  on X such that for all x,x 0 ,x 00 2 X we have that x  X  x , x  X  x 0 if and only if x 0  X  x , and x  X  x 0 combined with x 0  X  x 00 im-single partition P but a nested collection D X of partitions D
X ( ) of X indexed by a resolution parameter 0 . For a given D X , we say that two nodes x and x 0 are equiv-alent at resolution 0 and write x  X  D only if nodes x and x 0 are in the same cluster of D X ( ) The nested collection D X is termed a dendrogram ( Jardine &amp; Sibson , 1971 ) . The interpretation of a dendrogram is that of a structure which yields different clusterings at different resolutions. At resolution =0 each point is in a cluster of its own and as the resolution parameter increases, nodes start forming clusters. We denote by [ x ] the equivalence class to which the node x 2 X belongs at resolution , i.e. [ x ] := { x 0 2 X x  X  D Given a network ( X,A X ) and x,x 0 2 X ,a chain C ( x,x 0 is an ordered sequence of nodes in X , which starts at x and ends at x 0 . We say that C ( x,x 0 or connects x to x 0 . The links of a chain are the edges connecting consecutive nodes of the chain in the direction given by the chain. We define the cost of a chain ( 1 ) as the maximum dissimilarity max i | x encountered when traversing its links in order. A partition P = { B 1 ,...,B J } of a set X can be inter-preted as a reduction in data complexity in which varia-tions between elements of a group are neglected in favor of the larger dissimilarities between elements of different groups. This is natural when clustering datasets endowed with symmetric dissimilarities because the concepts of a node x 2 X being close to another node x 0 2 X and x 0 being close to x are equivalent. In an asymmetric network these concepts are different and this difference motivates the definition of structures more general than partitions. Considering that a partition P = { B 1 ,...,B J } of X is induced by an equivalence relation  X  on X we search for the equivalent of an asymmetric partition by removing the symmetry property in the definition of the equivalence re-lation. Thus, we define a quasi-equivalence as a binary relation that satisfies the reflexivity and transitivity proper-ties but is not necessarily symmetric as stated next. Definition 1 A binary relation between elements of a set X is a quasi-equivalence if and only if the following properties hold true for all x,x 0 ,x 00 2 X : (i) Reflexivity. Points are quasi-equivalent to them-selves, x x . (ii) Transitivity. If x x 0 and x 0 x 00 then x x 00 . Quasi-equivalence relations are more often termed pre-orders or quasi-orders in the literature ( Harzheim , 2005 ) .We choose the term quasi-equivalence to emphasize that they are a modified version of an equivalence relation. We define a quasi-partition of the set X as a directed, un-weighted graph  X  P =( P, E ) with no self-loops where the vertex set P is a partition P = { B 1 ,...,B J } of the space X and the edge set E  X  P  X  P is such that the following properties are satisfied (see Fig. 1 ): (QP1) Unidirectionality. For any given pair of distinct blocks B i , B j 2 P we have at most one edge between them. Thus, if for some i 6 = j we have ( B i ,B j ) 2 E then ( B j ,B i ) / 2 E . (QP2) Transitivity. If there are edges between blocks B i and B j and between blocks B j and B k , then there is an edge between blocks B i and B k .
 The vertex set P of a quasi-partition  X  P =( P, E ) repre-sents sets of nodes that can influence each other, whereas the edges in E capture the notion of directed influence from one group to the next. In the example in Fig. 1 , nodes which are drawn together can exert influence on each other. This gives rise to the blocks B i which form the vertex set P of the quasi-partition. Additionally, some blocks have influence over others in only one direction. E.g., block B can influence B 4 but not vice versa. This latter fact moti-vates keeping B 1 and B 4 as separate blocks in the partition whereas the former motivates the addition of the directed influence edge ( B 1 ,B 4 ) . Likewise, B 1 can influence B 2 can influence B 3 and B 4 can influence B 5 but none of these influences are true in the opposite direction. Block B 1 need not be able to directly influence B 5 , but can in-fluence it through B 4 , hence the edge from B 1 to B 5 , in accordance with (QP2). All other influence relations are not meaningful, justifying the lack of connections between the other blocks.
 Requirements (QP1) and (QP2) in the definition of quasi-partition represent the relational structure that emerges from quasi-equivalence relations as we state in the follow-ing proposition.
 Proposition 1 Given a node set X and a quasi-equivalence relation on X [cf. Definition 1 ] define the relation $ on X as for all x, x 0 2 X . Then, $ is an equivalence relation. Let P = { B 1 ,...,B J } be the partition of X induced by $ . Define E  X  P  X  P such that for all distinct B i ,B j 2 P for some x i 2 B i and x j 2 B j . Then,  X  P =( P, E ) is a quasi-partition of X . Conversely, given a quasi-partition  X  P =( P, E ) of X , define the binary relation on X so that for all x, x 0 2 X where [ x ] 2 P is the block of the partition P that con-tains the node x and similarly for [ x 0 ] . Then, is a quasi-equivalence on X .
 Proof: See Theorem 4.9, Ch. 1.4 in ( Harzheim , 2005 ) .  X  In the same way that an equivalence relation induces and is induced by a partition on a given node set X , Proposition 1 shows that a quasi-equivalence relation induces and is in-duced by a quasi-partition on X . We can then adopt the construction of quasi-partitions as the natural generaliza-tion of clustering problems when given asymmetric data. Further, observe that if the edge set E contains no edges,  X  P =( P, E ) is equivalent to the regular partition P when ignoring the empty edge set. In this sense, partitions are particular cases of quasi-partitions having the generic form  X  P =( P, ; ) . To allow generalizations of hierarchical clus-tering methods with asymmetric outputs we introduce the notion of quasi-dendrogram in the following section. 3.1. Quasi-dendrograms Given that a dendrogram is defined as a nested set of par-titions, we define a quasi-dendrogram  X  D X of the set X a nested set of quasi-partitions  X  D X ( )=( D X ( ) ,E X indexed by a resolution parameter 0 . Recall the def-inition of [ x ] from Section 2 . Formally, for  X  D X to be a quasi-dendrogram we require the following conditions: (  X  D1) Boundary conditions. At resolution =0 all nodes are in separate clusters with no edges between them and for some 0 sufficiently large all elements of X are in a single cluster, (  X  D2) Equivalence hierarchy. For any pair of points x,x for which x  X  D x  X  D (  X  D3) Influence hierarchy. If there is an edge ([ x ] classes [ x ] at any resolution 2 &gt; 1 we either have ([ x ]
E X ( 2 ) or [ x ] (  X  D4) Right continuity. For all 0 there exists  X  &gt; 0 such that  X  D X ( )=  X  D X ( 0 ) for all 0 2 [ , +  X  ] . Requirement (  X  D1) states that for resolution =0 there should be no influence between any pair of nodes and that, for a large enough resolution = 0 , there should be enough influence between the nodes for all of them to be-long to the same cluster. According to (  X  D2), nodes become ever more clustered since once they join together in a clus-ter, they stay together in the same cluster for all larger res-olutions. Condition (  X  D3) states for the edge set the analo-gous requirement that (  X  D2) states for the node set. If there is an edge present at a given resolution 1 , that edge should persist at coarser resolutions 2 &gt; 1 except if the groups linked by the edge merge in a single cluster. Requirement (  X 
D4) is a technical condition that ensures the correct defi-nition of a hierarchical structure [cf. ( 8 ) below]. ties defining a dendrogram ( Carlsson &amp; M  X  emoli , 2010 ) im-plies that given a quasi-dendrogram  X  D X =( D X ,E X ) on a node set X , the component D X is a dendrogram on X . I.e, the vertex sets D X ( ) of the quasi-partitions ( D X ( ) ,E X ( )) for varying form a nested set of parti-tions. Hence, if the edge set E X ( )= ; for every reso-lution parameter,  X  D X recovers the structure of the dendro-gram D X . Thus, quasi-dendrograms are a generalization of dendrograms, or, equivalently, dendrograms are particular cases of quasi-dendrograms with empty edge sets. Regard-ing dendrograms D X as quasi-dendrograms ( D X , ; ) with empty edge sets, we have that the set of all dendrograms D is a subset of  X  D , the set of all quasi-dendrograms. A hierarchical clustering method H : N ! D is defined as a map from the space of networks N to the space of den-drograms D . This motivates the definition of a hierarchical quasi-clustering method as follows.
 Definition 2 A hierarchical quasi-clustering method  X  H is defined as a map from the space of networks N to the space of quasi-dendrograms  X  D , Since D  X   X  D we have that every clustering method is a quasi-clustering method but not vice versa. Our goal here is to study quasi-clustering methods satisfying desirable ax-ioms that define the concept of admissibility. In order to facilitate this analysis, we introduce quasi-ultrametrics as asymmetric versions of ultrametrics and show their equiv-alence to quasi-dendrograms in the following section. Remark 1 Unidirectionality (QP1) ensures that no cy-cles containing exactly two nodes can exist in any quasi-partition  X  P =( P,E ) . If there were longer cycles, transi-tivity (QP2) would imply that every two distinct nodes in a longer cycle would have to form a two-node cycle, con-tradicting (QP1). Thus, conditions (QP1) and (QP2) imply that every quasi-partition  X  P =( P,E ) is a directed acyclic graph (DAG). The fact that a DAG represents a partial or-der shows that our construction of a quasi-partition from a quasi-equivalence relation is consistent with the known set theoretic construction of a partial order on a partition of a set given a preorder on the set ( Harzheim , 2005 ) . 3.2. Quasi-ultrametrics We define a quasi-ultrametric  X  u X on a given node set X follows.
 Definition 3 Given a node set X , a quasi-ultrametric  X  u is a non-negative function  X  u X : X  X  X ! R + satisfying the following properties for all x,x 0 ,x 00 2 X : (i) Identity.  X  u X ( x,x 0 )=0 if and only if x = x 0 . (ii) Strong triangle inequality.  X  u X satisfies Quasi-ultrametrics may be regarded as ultrametrics where the symmetry property is not imposed. In particular, the space  X  U of quasi-ultrametric networks, i.e. networks with quasi-ultrametrics as dissimilarities, is a superset of the space of ultrametric networks U  X   X  U . See ( Gurvich &amp; Vya-lyi , 2012 ) for structural properties of quasi-ultrametrics. The following constructions and theorem establish a struc-ture preserving equivalence between quasi-dendrograms and quasi-ultrametrics. Consider the map :  X  D !  X  U defined as follows: for a given quasi-dendrogram  X  D X = ( D X ,E X ) over the set X write (  X  D X )=( X,  X  u X ) we define  X  u X ( x,x 0 ) for each x,x 0 2 X as the smallest resolution at which either both nodes belong to the same equivalence class [ x ] =[ x 0 ] , i.e. x  X  D exists an edge in E X ( ) from the equivalence class [ x ] the equivalence class [ x 0 ] , We also consider the map  X  :  X  U !  X  D constructed as fol-lows: for a given quasi-ultrametric  X  u X on the set X and each 0 define the relation  X   X  u Define further D X ( ):= X mod  X   X  u edge set E X ( ) for every 0 as follows: B 1 6 = B 2 2 D
X ( ) are such that ( B 1 ,B 2 ) 2 E X ( ) () min Finally,  X  ( X,  X  u X ):=  X  D X , where  X  D X := ( D X Theorem 1 The maps :  X  D !  X  U and  X  :  X  U !  X  D are both well defined. Furthermore,  X  is the identity on  X  U and  X  is the identity on  X  D .
 Theorem 1 implies that quasi-dendrograms  X  D X can be rep-resented as quasi-ultrametric networks defined on the same underlying node set X . This allows us to reinterpret hier-archical quasi-clustering methods [cf. ( 6 )] as maps from the space of networks to the space of quasi-ultrametric networks. Apart from the theoretical importance of The-orem 1 , this equivalence result is of practical importance since quasi-ultrametrics are mathematically more conve-nient to handle than quasi-dendrograms. However, quasi-dendrograms are more convenient for representing data as illustrated in Section 4 .
 Given a quasi-dendrogram  X  D X =( D X ,E X ) , the value  X  u
X ( x,x 0 ) of the associated quasi-ultrametric for x,x 0 is given by the minimum resolution at which x can influ-block of D X ( ) or when they belong to different blocks B,B 0 2 D X ( ) , but there is an edge from the block con-taining x to the block containing x 0 , i.e. ( B,B 0 ) 2 E Conversely, given a quasi-ultrametric network ( X,  X  u X a given resolution the graph  X  D X ( ) has as a vertex set the classes of nodes whose quasi-ultrametric is less than in both directions. Furthermore,  X  D X ( ) contains a directed edge between two distinct equivalence classes if the quasi-ultrametric from some node in the first class to some node in the second is not greater than . In Fig. 2 we present an example of the equivalence be-tween quasi-dendrograms and quasi-ultrametric networks stated by Theorem 1 . At the top left of the figure, we present a quasi-ultrametric  X  u X defined on a three-node set X = { x 1 ,x 2 ,x 3 } . At the top right, we depict the den-drogram component D X of the quasi-dendrogram  X  D X = ( D X ,E X ) equivalent to ( X,  X  u X ) as given by Theorem 1 . At the bottom of the figure, we present graphs  X  D X ( ) a range of resolutions 0 . To obtain  X  D X from  X  u X , we first obtain the dendrogram component D X by sym-metrizing  X  u X to the maximum [cf. ( 9 )], nodes x 1 and merge at resolution 2 and x 3 merges with { x 1 ,x 2 } at res-olution 3. To see how the edges in  X  D X are obtained, at resolutions 0  X  &lt; 1 , there are no edges since there is no quasi-ultrametric value between distinct nodes in this range [cf. ( 10 )]. At resolution =1 , we reach the first non-zero values of  X  u X and hence the corresponding edges appear in  X  D X (1) . At resolution =2 , nodes x 1 and x 2 merge and become the same vertex in graph  X  D X (2) . Finally, at resolution =3 all the nodes belong to the same equivalence class and hence  X  D X (3) contains only one vertex. Conversely, to obtain  X  u X from  X  D X as de-picted in the figure, note that at resolution =1 two edges ([ x 1 ] 1 , [ x 2 ] 1 ) and ([ x 3 ] 1 , [ x 2 ] 1 ) appear in  X  corresponding values of the quasi-ultrametric are fixed to be  X  u X ( x 1 ,x 2 )=  X  u ( x 3 ,x 2 )=1 . At resolution when x 1 and x 2 merge into the same vertex in  X  D X (2) an edge is generated from [ x 3 ] 2 to [ x 1 ] 2 the equivalence class of x 1 at resolution =2 which did not exist before, implying that  X  u X ( x 3 ,x 1 )=2 . Moreover, we have that [ x 2 ] 2 =[ x 1 ] 2 , hence  X  u X ( x 2 ,x 1 )=2 . Finally, at  X  there is only one equivalence class, thus the values of  X  u that have not been defined so far must equal 3. 3.3. Admissible quasi-clustering methods We encode desirable properties of quasi-clustering meth-ods into axioms which we use as a criterion for admis-sibility. The Directed Axiom of Value (  X  A1) and the Di-rected Axiom of Transformation (  X  A2) winnow the space of quasi-clustering methods by imposing conditions on their output quasi-ultrametrics which, by Theorem 1 , is equivalent to imposing conditions on the output quasi-dendrograms. Defining an arbitrary two-node network ~ 2 (  X  , ):=( { p,q } ,A p,q ) with A p,q ( p,q )=  X  and A p,q ( q,p )= for some  X  , &gt; 0 , (  X  A1) Directed Axiom of Value.  X  H ( ~ 2 (  X  , )) = ~ (  X  A2) Directed Axiom of Transformation. Consider two networks N X =( X,A X ) and N Y =( Y,A Y ) and a dissimilarity-reducing map : X ! Y , i.e. a map
A Y ( ( x ) , ( x 0 )) . Then, for all x,x 0 2 X , the outputs ( X,  X  u X )=  X  H ( X,A X ) and ( Y,  X  u Y )=  X  H ( Y,A isfy The Directed Axiom of Transformation (  X  A2) states that no influence relation can be weakened by a dissimilarity re-ducing transformation. That is, if relations in the network are strengthened, the tendency of nodes to cluster cannot decrease. The Directed Axiom of Value (  X  A1) simply recog-nizes that in any two-node network, the dissimilarity func-tion is itself a quasi-ultrametric and that there is no valid justification to output a different quasi-ultrametric. 3.4. Existence and uniqueness of admissible We call a quasi-clustering method  X  H admissible if it satis-fies axioms (  X  A1) and (  X  A2) and we want to find methods that are admissible with respect to these axioms. This is not dif-ficult. Define the directed minimum chain cost  X  u  X  all chains connecting x to x 0 . Formally, for all x,x 0 2 X Define the directed single linkage (DSL) hierarchical quasi-clustering method  X  H  X  as the one with output quasi-ultrametrics ( X,  X  u  X  minimum chain cost function  X  u  X  and admissible as we show in the following proposition. Proposition 2 The hierarchical quasi-clustering method  X  H quasi-ultrametric and  X  H  X  satisfies axioms (  X  A1)-(  X  We next ask which other methods satisfy (  X  A1)-(  X  A2) and what special properties DSL has. As it turns out, DSL is the unique quasi-clustering method that is admissible with respect to (  X  A1)-(  X  A2) as we assert in the following theorem. Theorem 2 Let  X  H be a valid hierarchical quasi-clustering method satisfying axioms (  X  A1) and (  X  A2). Then,  X   X  H ultrametrics as in ( 13 ) .
 age is the only admissible hierarchical clustering method for finite metric spaces. Admissibility was defined by three axioms, two of which are undirected versions of (  X  A1) and (  X 
A2). In ( Carlsson et al. , 2013 ) , they show that when replac-ing metric spaces by more general asymmetric networks, the uniqueness result is lost and an infinite number of meth-ods satisfy the admissibility axioms. In our paper, by con-sidering the more general framework of quasi-clustering methods, we recover the uniqueness result even for asym-metric networks. Moreover, Theorem 2 shows that the only admissible method is a directed version of single link-age. In this way, it becomes clear that the non-uniqueness result for asymmetric networks in ( Carlsson et al. , 2013 ) is originated in the symmetry mismatch between the in-put asymmetric network and the output symmetric dendro-gram. When we allow the more general asymmetric quasi-dendrogram as output, the uniqueness result is recovered. DSL was identified as a natural extension of single linkage hierarchical clustering to asymmetric networks in ( Boyd , 1980 ) . In our paper, by developing a framework to study hierarchical quasi-clustering methods and leveraging the equivalence result in Theorem 1 , we show that DSL is the unique admissible way of quasi-clustering asymmetric net-works. Furthermore, stability and invariance properties are established in the following section.
 Remark 2 (Axiomatic strength and chaining effect) DSL, having a strong resemblance to single linkage hierarchical clustering on finite metric spaces, is likely to be sensitive to a directed version of the so called chaining effect ( Jain &amp; Dubes , 1988 ) . By requiring a weaker version of (  X  A2), the most stringent of our two axioms, the uniqueness result in Theorem 2 is lost and density aware methods, that do not suffer from the chaining effect, become admissible. This direction, shown to be successful to be an interesting research avenue. 3.5. Stability and invariance properties of DSL DSL is stable in the sense that if it is applied to similar networks then it outputs similar quasi-dendrograms. This notion has been used to study stability of clustering meth-precisely, we define a notion of distance between networks d
N which is an analogue to the Gromov-Hausdorff distance ( Gromov , 2007 ) between metric spaces and defines a legiti-mate metric on N (see A.4 in supplementary material for details). Since we may regard DSL as a map N !  X  U and  X  U is a subset of N , we are in a position in which we can use d N to express the stability of  X  H  X  .
 Theorem 3 For all N X ,N Y 2 N , Theorem 3 states that the distance between the output quasi-ultrametrics is upper bounded by the distance be-tween the input networks. Thus, for DSL, nearby networks yield nearby quasi-ultrametrics. In particular, Theorem 3 ensures that noisy dissimilarity data has limited effect on quasi-dendrograms. Also, the theorem implies that DSL is permutation invariant; see A.7 in supplementary material. For a non-decreasing function :[0 , 1 ) ! [0 , 1 ) such that ( a )=0 if and only if a =0 , and N X =( X, A X ) 2 N we write ( N X ) to denote the network ( X, ( A X )) . Any such will be referred to as a change of scale func-tion . Then, DSL is a scale invariant method as the follow-ing proposition asserts.
 Proposition 3 For all N X 2 N and all change of scale functions one has  X  H  X  ( N X ) =  X  H  X  ( N X ) . Since Proposition 3 asserts that the quasi-ultrametric out-come is transformed by the same function that alters the dissimilarity function in the original network, DSL is invariant to change of units. More precisely, in terms of quasi-dendrograms, a transformation of dissimilari-ties through results in a transformed quasi-dendrogram where the order in which influences between nodes arise is the same as in the original one while the resolution at which they appear changes according to . For further invariances of DSL, see A.7 in the supplementary materials. 3.6. Algorithms In this section we interpret A X as a matrix of dissimi-larities and  X  u  X  sponding to the quasi-ultrametric values  X  u  X  x, x 0 2 X . By ( 13 ), DSL quasi-clustering searches for directed chains of minimum infinity norm cost in A X to construct the matrix  X  u  X  algorithmically using matrix powers in the dioid algebra (
R + [ { + 1 } , min , max) ( Gondran &amp; Minoux , 2008 ) In the dioid algebra ( R + [ { + 1 } , min , max) the reg-ular sum is replaced by the minimization operator and the regular product by maximization. Using and  X  to denote sum and product on this dioid algebra we have a b := min( a, b ) and a  X  b := max( a, b ) for all a, b 2 R + [ { + 1 } . The matrix product A  X  B is therefore given by the matrix with entries  X 
A  X  B Dioid powers A ( k ) dissimilarity matrix are related to quasi-ultrametric matri-ces  X  u . For instance, the elements of the dioid power  X  u a given quasi-ultrametric matrix  X  u are given by Since  X  u satisfies the strong triangle inequality we have k = j we have that max(  X  u ij ,  X  u jj ) = max(  X  u ij , 0) =  X  u ij . Combining these two observations it follows that the result of the minimization in ( 15 ) is [  X  u (2) ] ij This being valid for all i, j implies  X  u (2) =  X  u . Further-more, a matrix satisfying  X  u (2) =  X  u is such that  X  u [  X  u all k , which is just a restatement of the strong triangle in-equality. Therefore, a non-negative matrix  X  u represents a finite quasi-ultrametric space if and only if  X  u (2) =  X  u only the diagonal elements are null. Building on this fact, we develop the following algorithm to implement DSL. Proposition 4 For every network ( X, A X ) with | X | = n the quasi-ultrametric  X  u  X  where the operation (  X  ) ( n 1) denotes the ( n 1) st matrix power in the dioid algebra ( R + [ { + 1 } , min , max) with matrix product as defined in ( 14 ) .
 Matrix powers in dioid algebras are tractable operations. Indeed, there exist sub cubic dioid power algorithms ( Vas-silevska et al. , 2009 ; Duan &amp; Pettie , 2009 ) of complexity O( n 2 . 688 ) . Thus, Proposition 4 shows computational tractability of DSL. There exist related methods with lower complexity. For instance, Tarjan X  X  method ( Tarjan , 1983 ) , which takes as input an asymmetric network but in contrast to our method enforces symmetry in its output, runs in time O( n 2 log n ) for complete networks. It seems of interest to ascertain whether Tarjan X  X  method can be modified to suit our (asymmetric) output construction. In the following sec-tion we use ( 16 ) to quasi-cluster a real-world network. The number of migrants from state to state in the U.S. is published yearly ( United States Census Bureau , 2011 ) . We de-note by S the set of all states and by A S : S  X  S ! R + a migrational dissimilarity such that A S ( s, s )=0 for all s 2 S and A S ( s,s 0 ) for all s 6 = s 0 2 S is a monotonically decreasing function of the fraction of immigrants to s 0 that come from s (see A.9 in supplementary material for de-tails). A small dissimilarity from state s to s 0 implies that, among all the immigrants into s 0 , a high percentage comes from s . We then construct the network N S =( S,A S ) with node set S and dissimilarities A S . The application of hier-archical clustering to migration data has been extensively investigated by Slater, see ( Slater , 1976 ; 1984 ) . The outcome of applying DSL to the migration network N
S is computed via ( 16 ). By Theorem 1 , the output quasi-ultrametric is equivalent to a quasi-dendrogram  X  D  X  ( D  X  S ,E  X  S ) . By analyzing the dendrogram component D of the quasi-dendrogram  X  D  X  proximity in migrational preference is evident; see Fig. 4 in Section A.9 of the supplementary material.
 To facilitate display and understanding, we do not present quasi-partitions for all the nodes and resolutions. Instead, we restrict the quasi-ultrametric to a subset of states rep-resenting an extended West Coast including Arizona and Nevada. In Fig. 3 , we depict quasi-partitions at four rele-vant resolutions of the quasi-dendrogram equivalent to the restricted quasi-ultrametric. States represented with the same color in the maps in Fig. 3 are part of the same clus-ter at the given resolution and states in white form singleton clusters. Arrows between clusters for a given resolution represent the edge set E  X  grational influence relation between the blocks of states. The DSL quasi-clustering method  X  H  X  captures not only the formation of clusters but also the asymmetric influence be-tween them. E.g. the quasi-partition in Fig. 3 for resolu-tion =0 . 859 is of little interest since every state forms a singleton cluster. The influence structure, however, reveals a highly asymmetric migration pattern. At this resolution California has migrational influence over every other state in the region as depicted by the four arrows leaving Califor-nia and entering each of the other states. This influence can be explained by the fact that California contains the largest urban areas of the region such as Los Angeles. Hence, these urban areas attract immigrants from all over the coun-try, reducing the proportional immigration into California from its neighbors and generating the asymmetric influence structure observed. Since this influence structure defines a partial order over the clusters, the quasi-partition at reso-lution =0 . 859 permits asserting the reasonable fact that California is the dominant migration force in the region. At larger resolutions we can ascertain the relative impor-tance of clusters. At resolution =0 . 921 we can say that California is more important than the cluster formed by Oregon and Washington as well as more important than Arizona and Nevada. We can also see that Arizona pre-cedes Nevada in the migration ordering at this resolution while the remaining pairs of the ordering are undefined. At resolution =0 . 922 there is an interesting pattern as we can see the cluster formed by the three West Coast states preceding Arizona and Nevada in the partial order. At this resolution the partial order also happens to be a total order as Arizona is seen to precede Nevada.
 For further applications, refer to Section A.9 in the supple-mentary material. When clustering asymmetric networks, requiring the out-put to be symmetric  X  as in hierarchical clustering  X  might be undesirable. Hence, we defined quasi-dendrograms, a generalization of dendrograms that admits asymmetric re-lations, and developed a theory for quasi-clustering meth-ods. We formalized the notion of admissibility by intro-ducing two axioms. Under this framework, we showed that DSL is the unique admissible method. We pointed out that less stringent frameworks that give rise to new admissible methods can be explored by weakening the Directed Ax-iom of Transformation. Furthermore, we proved an equiv-alence between quasi-dendrograms and quasi-ultrametrics that generalizes the well-known equivalence between den-drograms and ultrametrics, and established the stability and invariance properties of the DSL method. Finally, we illus-trated the application of DSL to a migration network. Boyd, J.P. Asymmetric clusters of internal migration re-gions of france. Ieee Transactions on Systems Man and Cybernetics , (2):101 X 104, 1980.
 Bureau of Economic Analysis. Input-output accounts: the use of commodities by industries before redefinitions.
U.S. Department of Commerce , 2011. URL http:// www.bea.gov/iTable/index_industry.cfm .
 Carlsson, G. and M  X  emoli, F. Characterization, stability and convergence of hierarchical clustering methods. Journal of Machine Learning Research , 11:1425 X 1470, 2010. Carlsson, G. and M  X  emoli, F. Classifying clustering schemes. Foundations of Computational Mathematics , 13(2):221 X 252, 2013.
 Carlsson, G., Memoli, F., Ribeiro, A., and Segarra, S. Ax-iomatic construction of hierarchical clustering in asym-metric networks. In Acoustics, Speech and Signal Pro-cessing (ICASSP), 2013 IEEE International Conference on , pp. 5219 X 5223, 2013.
 Duan, R. and Pettie, S. Fast algorithms for (max, min)-matrix multiplication and bottleneck shortest paths. Sym-posium on discrete algorithms , 2009.
 Gondran, M. and Minoux, M. Graphs, dioids and semi rings: New models and algorithms . Springer, 2008. Gromov, M. Metric structures for Riemannian and non-Riemannian spaces . Birkh  X  auser Boston Inc., Boston, MA, 2007. ISBN 978-0-8176-4582-3; 0-8176-4582-9. Gurvich, V. and Vyalyi, M. Characterizing (quasi-) ultra-metric finite spaces in terms of (directed) graphs. Dis-crete Applied Mathematics , 160(12):1742 X 1756, 2012. Harzheim, E. Ordered sets . Springer, 2005.
 Hubert, L. Min and max hierarchical clustering using asymmetric similarity measures. Psychometrika , 38(1): 63 X 72, 1973.
 Jain, A.K. and Dubes, R. C. Algorithms for clustering data . Prentice Hall Advanced Reference Series. Prentice Hall Inc., 1988.
 Jardine, N. and Sibson, R. Mathematical taxonomy . John
Wiley &amp; Sons Ltd., London, 1971. Wiley Series in Prob-ability and Mathematical Statistics.
 Lance, G. N. and Williams, W. T. A general theory of classificatory sorting strategies 1. Hierarchical systems. Computer Journal , 9(4):373 X 380, 1967.
 Meila, M. and Pentney, W. Clustering by weighted cuts in directed graphs. Proceedings of the 7th SIAM Interna-tional Conference on Data Mining , 2007.
 Murtagh, F. Multidimensional clustering algorithms.
Compstat Lectures, Vienna: Physika Verlag, 1985 , 1, 1985.
 Newman, M. and Girvan, M. Community structure in so-cial and biological networks. Proc. Ntnl. Acad. Sci. , 99 (12):7821 X 7826, 2002.
 Newman, M. and Girvan, M. Finding and evaluating com-munity structure in networks. Phys. Rev. E , 69, 026113, 2004.
 Ng, A., Jordan, M., and Weiss, Y. On spectral clustering:
Analysis and an algorithm. In T.K. Leen, T.G. Dietterich and V. Tresp (Eds.), Advances in neural information pro-cessing systems 14, MIT Press, Cambridge , 2:849 X 856, 2002.
 Pentney, W. and Meila, M. Spectral clustering of biological sequence data. Proc. Ntnl. Conf. Artificial Intel. , 2005. Saito, T. and Yadohisa, H. Data analysis of asymmet-ric structures: advanced approaches in computational statistics . CRC Press, 2004.
 Shi, J. and Malik, J. Normalized cuts and image segmen-tation. IEEE Transactions on Pattern Analysis and Ma-chine Intelligence , 22(8):888 X 905, 2000.
 Slater, P.B. Hierarchical internal migration regions of france. Systems, Man and Cybernetics, IEEE Transac-tions on , (4):321 X 324, 1976.
 Slater, P.B. A partial hierarchical regionalization of 3140 us counties on the basis of 1965-1970 intercounty mi-gration. Environment and Planning A , 16(4):545 X 550, 1984.
 Tarjan, R. E. An improved algorithm for hierarchical clus-tering using strong components. Inf. Process. Lett. , 17 (1):37 X 41, 1983.
 United States Census Bureau. State-to-state migration flows. U.S. Department of Commerce , 2011. URL http://www.census.gov/hhes/migration/ data/acs/state-to-state.html .
 Vassilevska, V., Williams, R., and Yuster, R. All pairs bot-tleneck paths and max-min matrix products in truly sub-cubic time. Theory of Computing , 5:173 X 189, 2009. Von Luxburg, U. A tutorial on spectral clustering. Statistics and Computing , 17(4):395 X 416, 12 2007.
 Zhao, Y. and Karypis, G. Hierarchical clustering algo-rithms for document datasets. Data Mining and Knowl-
