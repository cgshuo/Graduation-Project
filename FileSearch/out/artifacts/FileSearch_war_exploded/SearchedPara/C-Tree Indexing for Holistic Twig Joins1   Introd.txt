 T he pr o b l em o fma n ag in ga n dquer yin g XML d o cume n ts effic i e n t ly p o ses in-terest in gcha ll e n ges f o r database researchers .XML d o cume n ts ha v earather c o mp l e xin ter n a l structure ;in fact ,XML d o cume n ts ca n be m o de l ed as o rdered trees ,w here no des represe n te l eme n ts , attr i butes a n dte x tdata .

Twi g patter n bec o mes a n esse n t i a l part o f XML quer i es .A t wi g patter n ca n be represe n ted as a no de l abe l ed tree w h o se edges are e i ther pare n t -ch il d (P-C ) o ra n cest o r -desce n da n t (A-D) re l at ion sh i p .Fo re x amp l e , //S [ //C ] //A//B .T h i s e x press ion ca n be represe n ted as a no de -l abe l ed t wi g patter n( sh own in Fi g .1( b )) wi th e l eme n ts a n dstr in g v a l ues as no de l abe l s .

Fin d in ga ll o ccurre n ces o fat wi g patter nin a database i sac o re o perat ion in XML quer y pr o cess in g [ 2 , 4 ,6]. B ef o re the Holi st i ct wi g join a l g o r i thm [1] w as pr o p o sed , s o me t y p i ca l a l g o r i thms ha v ebee n used t o break the t wi gquer yin t o aset o fb in ar y re l at ion sbet w ee n pa i rs o f no des .T he Holi st i c Twi g Join de v e lo ps a n e w e y esh o tt o at wi gquer y, w h i ch ca n reduce the s i ze o f in termed i ate resu l t , espec i a lly t o the quer i es wi th only A-D re l at ion sh i ps .T here are ma ny wo rks that f o cus on the in de xin g XML data t o acce l erate the pr o cess in g o rb oo st h oli sm in XML t wi g patter n match in g [ 7 , 8 ,9]. In pract i ce ,XML data ma y ha v ema ny deep n ested e l eme n ts , a n ds o met i mes ha v e l arge fa n-o uts .T heref o re ,i t will great ly i mpr ov etheperf o rma n ce ,i fa n e ff ect iv e in de x ca n be des i g n ed t o sk i p l arge n umber o fe l eme n ts w h i ch d ono tpart i c i pat in g in afi n a l t wi gmatch .
B ear in gth i s in m in d ,w epr o p o se a n e win de x ca ll ed C -T ree that captures the c on te x t o fthe in de x ed e l eme n ts a n dde v e lo paser i es o f n e w a l g o r i thms t o pr o cess h oli st i ct wi g join seffic i e n t ly based on C -T ree .By C -T ree ,w eca n get the c on te x t o fe l eme n ts fr o m same tag stream o rfr o md iff ere n t tag streams . T he t wo pr o p o sed a l g o r i thms , NestTwigStack a n d ADTwigStack , ca n speed up the pr o cess in g o fh oli st i ct wi g join s , because e no rm o us use l ess e l eme n ts ca n be sk i pped wi th the c on te x t in C -T ree .

T he ma in c on tr i but ion s o fth i s paper are sh own be low:  X  W epr o p o se a n e win de xn amed C-Tree that c on ta in sc on te x tre l at ion sh i ps  X  F r o me x per i me n ts w estud y the perf o rma n ce o f o ur a l g o r i thms on b o th rea l In th i s sect ion, w ed i scuss the c on te x t in tag streams w h i ch ca ni mpr ov ethe perf o rma n ce o fthet wi gquer y. Fi rst ly, w e in tr o duce s o me defi ni t ion s wi th respect in tag streams are f ollow ed . 2.1 Preliminary Definitions Definition 1 (Transorder). Given two elements in tag stream T with region E i ( StartPos i ,EndPos i ) and E j ( StartPos j ,EndPos j ) , E i is said to be trans-migrated by E j ,or E j transmigrates E i ,if(1) EndPos i &lt;StartPos j and (2)  X  X  E k  X  T : EndPos i &lt;StartPos k &lt;StartPos j The relation between the E i and E j is a kind of Partial Ordering Relation, which we call it Transorder . I t i s wo rth no t in gthat , transorder i sdefi n ed e x c l us iv e ly on aset o fe l eme n ts E o fthesametag .T he transorder ca n be ill ustrated in Fi g . 2 .T here are se v e n e l eme n ts wi th reg ion s [ StartPos i , EndPos i ](1  X  i  X  7 )in the tag stream S E ,in w h i ch e l eme n ts are o rdered b y StartPos .T here are ma ny transorder re l at ion s , fr o mthestream S E .I t  X  seas y t o see that the e l eme n ts bet w ee n each P art i a l Order in gRe l at ion pa i r i s the desce n da n ts o f the first e l eme n t in the pa i r . Definition 2 (FarthestAnc). Given an element E i of tag stream T D with re-gion ( StartPos i ,EndPos i ) , and an element E j from the tag stream T A with re-gion ( StartPos j ,EndPos j ) , where tag A is the ancestor of the tag D in DTD. if (1) StartPos j &lt;StartPos i  X  EndPos i &lt;EndPos j and (2)  X  X  E k  X  T A : StartPos k &lt;StartPos j  X  EndPos j &lt;EndPos k , E j is the FarthestAnc of the E i .
 Definition 3 (NextDesc). Given an element E m of tag stream T A with region ( StartPos m ,EndPos m ) , and an element E n from the tag stream T D with region ( StartPos n ,EndPos n ) , where tag A is the ancestor of the tag D in DTD. If (1) StartPos m &lt;StartPos n  X  EndPos n &lt;EndPos m and (2)  X  X  E l  X  T D : StartPos m &lt;StartPos l  X  StartPos l &lt;StartPos n E n is the NextDesc of the E m .
 T he FarthestAnc a n d NextDesc are re l at ion sthataree x c l us iv e ly defi n ed on t wo e l eme n ts w h o se tags are A-D o r P-Cre l at ion s in DTD. I fe l eme n t E A i s E
D  X  s FarthestAnc , there ma y be s o me o ther e l eme n ts w h i ch are fr o mthestream w here E A c o mes .T hese e l eme n ts are the E D  X  sa n cest o rs t oo, h ow e v er no e l eme n t w h o se S tart Po s i ssma ll er tha n E A e xi sts .Fo re x amp l e ,inFi g .1( a ), S 9 i s C 7  X  s FarthestAnc ,w h il e S 10 i s no t . A 6 i sthe NextDesc o f S 5 , a n d A 7 i sthe NextDesc o f S 9 . 2.2 SelfTagContext Streaming T he transorder c on te x t in the tag streams i sre v ea l ed b y the SelfTagContext S tream in gscheme ,w here the e l eme n t in streams f o cuses on the c on te x t o f i tse l f  X  s tag .T he e l eme n t o f SelfTagContext S tream i sa w are o fthep o s i t ion o fthee l eme n t w h i ch has Transorder re l at ion wi th i t .T heref o re the SelfTagPointer stream in g c on ta in sthec on te x t o fe l eme n ts w h i ch are o fthesametag n ame .

T he SelfTagContext S tream in gscheme i sam o de lin c on cept , a n d w eca n defi n e nextP o perat ion s on i ts streams .T he nextP retur n sthep o s i t ion o fthe e l eme n t w h i ch tra n sm i grates curre n t XML e l eme n t in the stream .W eca n sa y that the c on te x t o fthe transorder in tag streams ca n be re v ea l ed b y the o perat ion nextP .Fo re x amp l e ,inFi g .3, nextP ( S 1 )i s S 4 , a n d nextP ( C 1 )i s C 4 .W eca n see that the e l eme n ts bet w ee n S 1 a n d S 4 are the desce n da n ts o f S 1 . 2.3 ADTagContext Streaming T he ADTagContext stream in gc on ta in sm o re c on te x t o fthee l eme n ts .T he AD-TagContext stream in ge x te n ds SelfTagContext stream in gb y appe n d in gthec on-te x t o f FarthestAnc in stream o fpare n ttag in DTD, a n d NextDesc in streams o f ch il dre n tag in DTD. Fi g . 4sh ow sthe ADTagContext S tream in g o fthed o cume n t in Fi g .1, a n dd o es n X  tsh ow a ll the re l at ion sf o rs i mp li ficat ion.
T he e l eme n t o f ADTagContext S tream c on ta in sthep o s i t ion s o fthee l eme n ts that are in the pare n t tag streams a n dthech il dre n tag streams .B ecause a tag in DTD ma y ha v emu l t i p l ech il dre n, the e l eme n tc on ta in smu l t i p l ep o s i t ion st o e l eme n ts fr o mstreams o fch il dre n tags in DTD. W eca n defi n es o me o perat ion s on the ADTagContext S tream : getA ( T,T P ) a n d getD ( T,T C ). G iv e n a n e l eme n t E fr o mstream o ftag T ,w eca n get E  X  s FarthestAnc in the c o rresp on d in gstream o f T P w h i ch i s the pare n ttag o f T , a n d E  X  s NextDesc in the c o rresp on d in gch il d stream o ftag T C w h i ch i s on e o f T  X  sch il d in DTD. I ftag T has n ch il dre nin the DTD, the e l eme n t in T  X  s tag stream ca n get n NextDesc e l eme n ts .In th i s w a y, a ll the p o ss i b l equer i es ca n be e v a l uated b y the ADTagContext S tream -in g .Fo re x amp l e in Fi g . 4 , S 5 has t wo p oin ters because tag S in DTD has t wo desce n da n ts ( A a n d C ). In th i s sect ion, w eprese n t the structure o fC -T ree , a nin de x spec i a lly des i g n ed t oin de xXML d o cume n ts f o reffic i e n tt wi g join s .T he nw ed i scuss h ow t o get the c o mp l ete c on te x t o f no des in a ny t wi gquer y patter n b y us in gtheC -T ree in de x. 3.1 Data Structure of C-Tree Wi th the ab ov e in tr o duct ion, w edefi n eC -T ree , a nin de x structure that e n ab l es e l eme n ts in tag streams a w are o f i ts c on te x t (in c l ud in g transorder , FarthestAnc a n d NextDesc ), a n dfac ili tates t wi g join pr o cess in g o f XML d o cume n ts . mu l t i-d o cume n t databases i str ivi a l. Si m il ar ly, w ec on ce n trate on the a n cest o r -desce n da n t join; the pare n t -ch il d join i sas i mp l ee x te n s ion us in gthe l e v e ln um -bers .(H e n ce in the rest , the DocID , Level attr i butes are no tsh own but are i mp li c i t ly assumed .) C -T ree i sa B+T ree , a n d i ts l eaf no de has the structure ( currentT ag , StartPos , desT ag , RT ype , SPos ). s ow eca n st o re the re l at ion s defi n ed ab ov e .T he desT ag mea n sdest in at ion tag , a n d RT ype i sthere l at ion t y pe bet w ee n e l eme n t o f currentT ag a n de l eme n t o f desT ag in c l ud in g transor-der , FarthestAnc a n d NextDesc , the SPos i sdest in at ion e l eme n t  X  sp o s i t ion in desT ag stream , a n d i t i sthep o s i t ion in the respect iv e tag stream o f desT ag in the ADTagContext S tream in g o r SelfTagContext S tream in g .W e assume that a separate in de xi susedt o c l uster e l eme n ts fr o mthe currentT ag .T h i s in de x o rga ni zat ion has bee n sh own t o be v er y effic i e n tf o rs o me quer i es .In prac -t i ce these mu l t i p l e in d i ces ca n be c o mb in ed in t o as in g l e in de x, b y add in g the StartPos , desT ag , RT ype in the search ke y. So the in de xi sbu il t on the ( currentT ag , StartPos , desT ag , RT ype ) c o mb in at ion. W edefi n ethe o perat ion getSP os on the C -T ree .I ts parameters are ( currentTag,StartPos,desTag, RT ype ) a n d i tretur n sthe SPos .So that , g iv e n ae l eme n tefr o mstream currentT ag ,w eca n get i ts n e x te l eme n t in stream o f desT ag o fa ny k in d o f the re l at ion ( Transorder , FarthestAnc ,o r NextDesc ). W he n the RT ype i s Tran-sorder re l at ion, the desT ag i sthesameasthe currentT ag . 3.2 Complete Context of FarthestAnc and NextDesc Fo ra n s w er in ga ll the p o ss i b l equer i es , g iv e n at wi gquer y patter n Q a n da no de N in Q ,w e n eed t o get the c on te x t o f FarthestAnc fr o m the tag stream o f N  X  pare n t no de in Q a n dthec on te x t o f NextDesc fr o m the tag streams o f N  X  ch il dre nno des in Q .W h il e in ADTagContext S tream in g ,w eca nonly get th o se c on te x tfr o m the tag streams o f N  X  spare n ta n dch il dre ninDTD.Fo re x amp l e , in Fi g . 4 , e l eme n t B 7 ca n get D 7 the FarthestAnc in tag stream D fr o mC -T ree in de x d i rect ly, because no de D i s the pare n t o f no de B in DTD, but i tca nno t ach i e v ethe FarthestAnc c on te x ts o ftag A a n d S d i rect ly.
 T he c o mp l ete c on te x t o f FarthestAnc a n d NextDesc c on ta in sa ll the c on te x t o f FarthestAnc a n d NextDesc bet w ee n a ny t wo no des in quer yw h i ch ha v ea n cest o r -desce n da n tre l at ion sh i ps .By us in gthec on te x ts bet w ee n a ny t wo pare n t -ch il d no des in DTD w h i ch are c on ta in ed in C -T ree ,w eca n deduce the c o mp l ete c on-te x t o f FarthestAnc a n d NextDesc .Fo re x amp l e ,inFi g .5, e l eme n t B 7 ca n get e l eme n t A 7 the FarthestAnc in tag stream A a n d S 9 the FarthestAnc in tag stream S , m o re ov er the e l eme n t A 6 ca n get e l eme n t B 6 the NextDesc in tag stream B b y search in gtheC -T ree in de x t wi ce .In th i s w a y, a ll the p o ss i b l e quer i es ca n be e v a l uated b y the C -T ree w h i ch i sbased on the m o de lo f ADTag-Context S tream in g .
 Al g o r i thm NestTwigStack ,w h i ch pr o cesses the t wi g join, i sprese n ted in Al g o-r i thm 1. In o ur a l g o r i thms ,w ee n c o de the XML e l eme n tb y us in gthereg ion c o d in g [3,5]. I fthestreamsc on ta in no des fr o mmu l t i p l e XML d o cume n ts , the a l g o r i thm i seas ily e x te n ded t o test equa li t yo f DocId bef o re ma ni pu l at in gthe no des in the streams a n d on the stacks . IsPCedge ( tagP, tagC ) retur n strue w he n tagP i s tagC  X  pare n t in DTD o r S chema , a n d isADedge ( tagA, T agD ) retur n s true w he n tagA i s tagD  X  spare n t in DTD. advanceN est ( T q ,num )) sk i ps num e l eme n ts in stream T q .
 Algorithm 1. NestTwigStack ( q )
In ma ny cases , NestTwigStack ca n sk i pma ny e l eme n ts w h i ch d on X  tpart i c i pate in the fi n a l resu l tb y the n ested re l at ion sbet w ee n the e l eme n ts o f same tag . (1) G iv e n a ny structura ljoin A//D in the t wi gquer y patter n, tag A i s n ested in the DTD o r S chema , a n d curre n te l eme n t e in T A has ma ny desce n da n ts in T A . I fe l eme n t e in T A ca n X  tpart i c i pate in the fi n a l resu l t , the e l eme n ts w h i ch are the desce n da n ts o f e ca n X  tc on tr i bute themse lv es t o the a n s w ers t oo. ( 2 ) G iv e n the structura ljoin A//D w here D i sthe l eaf no de in the t wi gquer y patter n, tag D i s n ested in the DTD o r S chema , a n d the curre n te l eme n t e in T D has ma ny desce n da n ts in T D .I fe l eme n t e in T D c on tr i bute i tse l ft o the a n s w ers , the e l eme n ts w h i ch are desce n da n ts o f e c on tr i bute themse lv es t o the a n s w ers o b vio us ly. (3) G iv e n a ny P-Cedge in the t wi gquer y patter n, such as the P/C ,i f the tag C i s n ested in the DTD o r S chema , a n d the curre n te l eme n t e in T C has ma ny desce n da n ts in T C ,I fe l eme n t e in T C ca n match the t wi gquer y patter n, the e l eme n ts w h i ch are the desce n da n ts o f e ca n X  tbethech il dre no fthee l eme n t in the t o p o f T P .
 Algorithm 2. getN extN est ( q ) Example 1. In Fi g .1, w he n S 1 in T S i s n X  tf o u n d in a ny a n s w er o fthequer y, the C d i rect ly. I fthequer y patter n cha n ges t oS[/ C ]//A//B, w he n C 1 i s o utput as the in termed i ate resu l t , C 2 , C 3 are sk i pped because the l e v e lo fthemd ono tequa l t o( S 4 .l e v e l+1). In th i s subsect ion, w ebr i e fly in tr o duce a l g o r i thm ADTwigStack ,w h i ch i spart ly in sp i red b y TwigStack a l g o r i thm pr o p o sed in [1].

T he getDes ( e, q )inAl g o r i thm 3 retur n sthep o s i t ion o fthee l eme n t w h i ch i s the desce n da n t o fe in T q , a n d getF arthestAnc ( e, q )inAl g o r i thm 4 retur n s the p o s i t ion o fthee l eme n t w h i ch i sthea n cest o r o fe in T q .By the fu n ct ion advanceJumpT o ( T q ,num ), w eca n fi n dthe n e x te l eme n tt o dea lwi th in T q , a n d num i s i ts p o s i t ion.

Fo reacha x e in t wi gquer y patter n, ADTwigStack ca n sk i pb o th the a n cest o r a n d the desce n da n t .U s in g getDes(e,q) ,w eca n ach i e v e the desce n da n tc on te x t o f the e l eme n tfr o mthe ADTagContext S treams .Sow eca nj ump t o the first desce n-da n t o fthee l eme n t e in e  X  s desce n da n tstream .Ino rder t o a voi dthe lo ss o fthe usefu l resu l ts ,w eha v et o determ in ate the prese n tstack o f e w hether i t i sempt y o r no tbef o re j ump in gt o the desce n da n tstream .W he n e has a n cest o r in stack , sce n da n tstreamma y be in the resu l t , theref o re w eca n X  t j ump the e l eme n tt o the on e w h o has the sma ll est start p o s i t ion w h i ch i s l arger tha n e .W ea l s o ca n get the c on te x t o fa n cest o rfr o mthestreams , s ow eca nj ump the e l eme n t e  X  sa n cest o r stream T A t o the farthest a n cest o r o f e max w h o se start p o s i t ion i sthema xi mum o fth o se e l eme n ts in the ch il dstreams o f e  X  stag , t o sk i pthea n cest o rs in T A that are sure ly no t in the resu l t o fthequer y. In th i spart w e must determ in ate w hether the e l eme n t w h i ch i sg oin gt oj ump t oi s after the curre n te l eme n t in tag stream T
A o r no t .W he n e has a n a n cest o r in d o cume n t e a , a n dthee l eme n ts d wi th ma x-e l eme n t d i stheh i ghest a n cest o r o f d , that i s e a .B ut e a i sbef o re e in stream .T he a l g o r i thm ma y ru nin t o e n d l ess loo p ,wi th o ut j udgeme n t .
 Algorithm 3. ADT wigStack ( q ) Example 2. In Fi g .1, w he n the getN extC fu n ct ion retur n stag A , the t o pe l eme n t in tag stream T A i s A 4 ,w h o se e n dp o s i t ion i ssma ll er tha n S 5  X  sstartp o s i t ion. S  X  s desce n da n tc on te x tc on ta in sthep o s i t ion o f S 5  X  s n e x t desce n da n t o ftag A , a n d A 6 i safter A 4 in tag stream T A , s o e l eme n t A 5 i ssk i pped , a n dthe n e x t e l eme n tt o be sca nn ed in stream T A i s A 6 ;Wi th the a l g o r i thm ru nnin g , the t o p e l eme n ts in the respect iv estreamsare S 6 , A 7 , B 6 a n d C 5 .T he ch il dre no f S in t wi gquer y Q are A a n d C , s o the e l eme n t wi th ma xi mum p o s i t ion i s A 7 .T he a n cest o rc on te x t o f A 7 t o tag S i s S 9 ,w h i ch i s A 7  X  sfarthesta n cest o r , a n d S 9 i safter S 6 in T S , theref o re the a l g o r i thm sca n s S 9 in T S on the n e x tstep , a n d ma ny e l eme n ts in stream T S are sk i pped .
 Algorithm 4. getN extC ( q ) In th i s sect ion, w eprese n te x per i me n ta l resu l ts on the perf o rma n ce o fthet wi g patter n match in ga l g o r i thms .W ef o cus on three k in ds o fa l g o r i thms : TwigStack , NestTwigStack a n d ADTwigStack .W ee v a l uate the perf o rma n ce o fth o se join a l g o r i thms us in gthef ollowin gt wo metr i cs , the n umber o fe l eme n ts sca nn ed a n d the ru nnin gt i me o f first phase in th o se a l g o r i thms . 6.1 Experiment Setup W e i mp l eme n ted a ll a l g o r i thms in JDK 1. 4 .Allo ur e x per i me n ts w ere perf o rmed on 3. 2G H z P e n t i um 4 pr o cess o r wi th 51 2 MB R AM ru nnin g on win d ow s XP s y stem .W eusedthef ollowin grea l-wo r l da n ds yn thet i cdatasetsf o r o ur e x per -i me n ts :  X  DBLP . W e o bta in ed the DBLP data set fr o mthe Univ ers i t yo f W ash in gt on  X  Synthetic data . T he defi ni t ion o fthetag section i s n ested in b oo k DTD. 6.2 NestTwigStack Vs. TwigStack W ec on trasted a l g o r i thm TwigStack wi th NestTwigStack on s yn thet i cdatasets o fd iff ere n t n ested l e v e l s .W ee v a l uated t wo quer i es : Q 1 : section [ /title ] /f igure/image a n d Q 2 : section [ //title ] //f igure
Q 1 only has P-Cedges , a n d Q 2 only has A-D edges .A ssuch ,w eca n e v a l uate Q 1 are sh own in Fi g .6( a ) a n d ( b ), a n dtheresu l ts o f Q 2 are sh own in the Fi g .6( c ) a n d ( d ). T he ratio of the Time benefits i stherat io o fthet i me be n efits fr o m F r o m Fi g .6( a ) a n d Fi g .6( c ), w eca n eas ily fi n d o ut NestTwigStack o utperf o rms TwigStack , because NestTwigStack ca n sk i pma ny use l ess e l eme n ts .W he n there i s no n ested e l eme n t in the data sets , such as the DBLP data set , there i s no be n efits that w eca n get t o speed up the pr o cess in g o fquer y. F r o m Fi g .6( b ) a n d ( d ), w eca n see that the rat io o fthebe n efits in creases as the depth o f d o cume n t in creases .T he deeper the n ested l e v e lo fdataset i s , the better the NestTwigStack perf o rms .

C on s i der in gthe A-D o r P-Cedges ,w eca n see that o ur a l g o r i thm has better perf o rma n ce w he ni te v a l uates quer i es wi th A-D edge only. B ut w ea l s o see that ,no matter w hat quer yi t i s , the rat io o fthet i me be n efits in crease as the depth in creases , a n dthetre n d i ss i m il ar .In summar y, a l g o r i thm NestTwigStack perf o rms better tha n Twi g S tack on the n ested data set . 6.3 ADTwigStack Vs. TwigStack To c o mpare the perf o rma n ces o f TwigStack a n d ADTwigStack ,w ech oo se DBLP data sets o fd iff ere n ts i ze , a n de v a l uate the f ollowin gt wi gquer y. Q 3 : //inproceedings [ //author ] //title//i I tca n be o bser v ed , fr o me x per i me n tresu l ts on Fi g . 7 , that ADTwigStack a l g o-r i thm i susua lly much m o re effic i e n ttha n TwigStack . ADTwigStack i s n ear ly three t i mes faster tha n the o r i g in a l TwigStack , a n d TwigStack  X  s n umbers o fe l-eme n ts sca nn ed are te n t i mes m o re tha n the ADTwigStack  X  s .W ea l s o ca n see that the NestTwigStack on the DBLP d o cume n ts ha v eab o ut ha l fthee l eme n ts sca nn ed . 6.4 Performance Analysis T he ADTwigStack perf o rms v er yw e ll aga in st the TwigStack w h il ee v a l uat in g quer i es on DBLP data set .T hat i s because the ADTwigStack a l g o r i thm makes use o fthec on te x t o fb o th a n cest o ra n d desce n da n t . E l eme n ts in desce n da n t stream ca n ad v a n ce the a n cest o rstreamb yi ts a n cest o rc on te x t , a n dthe n the curre n tt o p o fthea n cest o rstreamca n ad v a n ce the desce n da n tstreamb yi ts desce n da n tc on te x t .So ADTwigStack ca n sk i pm o st o f the use l ess e l eme n ts . NestTwigStack d o es no t o utperf o rm TwigStack t oo much , h ow e v er ,w he n ad o c -ume n t i s deep ly n ested , NestTwigStack perf o rms much better tha n TwigStack .
F r o mthee x per i me n ts w eca n c on c l ude that the ADTwigStack i sc o mm only su i tab l ef o ra ll k in ds o f XML d o cume n ts , espec i a lly f o rthed o cume n ts wi th l arge fa n-o uts o r wi de breadth ,w h il ethe NestTwigStack su i ts f o rthed o cume n ts wi th n ested e l eme n ts deep ly. In th i spaper ,w e addressed the pr o b l em o feffic i e n t ly e v a l uat ion o fh oli st i ct wi g join sb y us in gC -T ree in de x. P art i cu l ar ly, w epr o p o sed a n e w ser i es o fstream -in g schemes that are a w are o fe l eme n ts  X  c on te x t in the streams .An dthe nw e pr o p o sed t wo a l g o r i thms t o speed up the pr o cess in g o ft wi g patter n quer i es b y sk i pp in gthee l eme n ts w h i ch d ono tpart i c i pate in a ny t wi g join. T he a l g o-r i thm NestTwigStack w h i ch i sbased on SelfTagContext S tream in gm o de l has better perf o rma n ce on th o se XML d o cume n t wi th deep ly n ested e l eme n ts , a n d the a l g o r i thm ADTwi g S tack w h i ch i sbased on ADTagContext S tream in gm o de l th o se d o cume n t wi th l arge fa n-o uts o r wi de breadth .T hese a l g o r i thms no t only acce l erate quer i es o ft wi g patter nwi th only a n cest o r -desce n da n tedges , but a l s o acce l erate quer i es o ft wi g patter nwi th pare n t -ch il dedges .
 Acknowledgement. T h i s research i s supp o rted b y the N at ion a lN atura lS c i e n ce Fo u n dat ion o fCh in a ( Gra n t No. 60 87 3011, 60 77 3 22 1, 60 77 3 2 19 a n d 60 8 030 2 6), N at ion a lB as i c Research P r o gram o fCh in a ( Gra n t No. 2 006 C B303103), a n dthe 8 63 Hi gh T ech ni que P r o gram ( Gra n t No. 2 00 7 AA01 Z 19 2 ).

