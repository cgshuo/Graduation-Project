 1. Introduction
Computational Intelligence (CI) is a new paradigm that provides intelligence to systems and machines. Nowadays, CI is a relatively new field that integrates several synergistic areas that have an impact on machine intelligence ( Fogel and Robinson, 2003 ). Two of the most prominent areas that are part of CI are
Artificial Neural Networks (ANN) and Fuzzy Logic (FL). Neural networks models date from the work of McCulloch X  X itts model in 1943. However, the boost of this area is related to the 1980s where we found works like the backpropagation algorithm by Werbos (1994) . Fuzzy logic theory was proposed by Professor
Lotfi Zadeh in the 1960s ( Zadeh, 1965 ), but the takeoff of this area starts also in the 1980s. The cut edge in the theory of these areas report works in unimaginable topics like, intuition, imagination, and creativity ( Duch, 2007; Li et al., 2003; Foo, 2000; Yu-Jia and
Ding-Li, 2009 ). As we are aware, a huge progress has been reached in neural networks and fuzzy logic theories, and it is expected that new theories will be developed in following years. However, this progress in theoretical aspects requires an adequate balance between theory and applications.

Our motivation in this paper is to address real world applications based on neural networks and fuzzy logic to provide justification on keeping a balance between the theoretical research and real world applications on these two fields. The contribution of this work is to present how CI can simulate human behavior in quality subjective inspection tasks in industrial environment using visual information. Another contribution is a novel automatic determination of the number of clusters in the fuzzy neural model proposed in the paper.

The paper addresses the situations of how to deal with subjective measurements implicit in inspection tasks. In indus-trial environments, these types of tasks are generally achieved by human inspectors. In this type of inspection, the quality of a product is defined by the appreciation of a specific property of the product by the human inspector like, surface features ( Wiltschi et al., 2000 ), shape description ( Chacon-Murguia et al., 2009 ), bottle finish inspection ( Duan et al., 2007 ) ripeness ( Kosak Polder et al., 2002 ), skin color ( Vezhnevets et al., 2009 ), shape description texture analysis ( Boukouvalas et al., 1999; Ferreira et al., 2009 ), automatic micromanipulation technologies ( Zhang et al., 2009 ), manipulation hand X  X ye for generating calibration parameters ( Motai and Kosaka, 2008 ), fabric inspection ( Sari-Sarraf and Goddard, 1999; Cho et al., 2005; Hong-gang and Jun, 2009 ), etc. The decision about the quality of the product is obtained by the human inspector based on a measurement of the aspect of the product property. Measure in this case, means perception or appreciation of such property. Therefore, the process involves a high degree of subjectivity ( Takemae et al., 2000 ). This kind of inspection usually represents a great point of controversy between the production and the quality departments, and this controversy results in negative economical consequences for the company.

The work presented in this paper deals with two inspection tasks, the first one is related to the classification of two cosmetic defects found during the fabrication of ophthalmic lenses. The second one concerns the detection of non-uniform color regions in translucent film used in the fabrication of polarized lenses.
According to our knowledge, there are no identical works reported in the literature. This may be because the problem covered in this paper is a real world problem or because other companies that have worked in these problems do not wish to release the information, which in turn makes this paper an important contribution for the industrial community. The closer work related to the cosmetic defects on lenses is reported briefly in Curran (1997) and it is reported only from a communication point of view.
With respect to the topic of the detection of non-uniform color regions in translucent film, the most related work found is the researcher on the  X  X  X ooking curve X  X  ( Hamey et al., 1998 ).
The design of vision systems able to work on these kinds of tasks is a promissory field to experiment with new vision and pattern recognition techniques. By their natural characteristics, uncertainty management, learning and generalization, evolution, etc. Computational Intelligence techniques represent an interest-ing alternative in the design of such vision systems. Furthermore, there may be situations where the complexity of the task requires the fusion of the advantages of neural networks and fuzzy logic.
The hybrid approach incorporates the benefits of a better uncertainty management with fuzzy logic ( Zadeh, 1996 ), and the learning and generalization characteristic of neural networks ( Egmont et al., 2002; Cao and Lin, 2008; Li and Hori, 2006 ).
This paper presents, in Section 2, the definition of a Computa-tional Intelligence model with neural networks and fuzzy logic oriented to the solution of industrial application inspection tasks.
In Section 3, the model is illustrated in the solution of two problems, recognition of cosmetic defects presented in ophthalmic lenses and detection of non-uniform regions on translucent film.
Finally, the results and conclusions are discussed in Section 4. 2. Computational Intelligence model
In this section we try to formalize a Computational Intelligence scheme based on fuzzy logic and/or ANN for subjective inspection tasks in industrial applications. The general function achieved by a human inspector may be defined by
H  X  l  X  : O ) D  X f A , R g X  1  X  where H ( l ) is a mapping function of l , product property definition measured by perception, that maps a product O to the set D with elements, accepted A , rejected R . H ( l ) can be decomposed into two functions
H ms  X  l  X  : O ) m l  X  O  X  and H mA  X  l  X  : m l  X  O  X ) D  X  2  X  where H ms ( l ) maps the product O into a degree of satisfaction of the property l . Finally, the function H mA ( l ) maps this degree of satisfaction to A or R .

Considering the Computational Intelligence scheme, the pre-vious functions can be represented by the following functions.
The general function is similar to (1) but now H ( l ) is achieved through the following functions:
S  X  l  X  : O ) X  X  3  X 
S ( l ) is a feature extraction function that maps the product property into a feature vector X
S  X  l  X  : X ) m l  X  X  X  X  4  X 
S 2 ( l ) maps the feature vector X to a degree of satisfaction, m the property l . Finally S 3 ( l ) maps that satisfaction degree to A or R S 3  X  l  X  : m l  X  X  X ) D  X  5  X 
S 1 ( l ) and S 2 ( l ) can be considered as the perceptual functions achieved by the human inspector. S 2 ( l ) and S 3 ( l ) can be incorporated into fuzzy, ANN and/or fuzzy-ANN schemes as follows:
S 2  X  l  X  , S 3  X  l  X  X  where f R represents a fuzzy rule system, DOF stands for the degree of fulfillment. f C is a fuzzy clustering algorithm. A S is a supervised
ANN, and A US is an unsupervised ANN. In the next section, two inspection problems solved with Computational Intelligence are presented. The methodology applied follows the CI model presented in this section. 3. Cosmetic defect classification presented in ophthalmic lenses 3.1. Cosmetic defects and feature vector definition during ophthalmic lens fabrication are the CF and FP defects. The
CF defect is generated by textile particles that fall into the molds of the lens during the fabrication process. The FP defect is generated by chemical reactions between the polymer used to fabricate the lens and unknown particles during the fabrication process. Illustrations of t hese two defects are shown in Fig. 1 aandb. The defect images were acquired with a vision camera with a magnification of 10 , using a workstation designed for this purpose, Fig. 1 c. The size of both defects is around 0.5 X 1.5 mm.
Detection and classification of these defects is important because by knowing the frequency of occurrence of the CF and
FP defects it can be used to improve the fabrication process. The nucleus of the system used to classify these defects is an ANN. The
ANN approach was selected by its learning and generalization properties, and has proved to be efficient for intensity classifica-tion of cosmetic defects ( Chacon et al., 2005 ). The ANN classifica-tion scheme also avoids the problematic work involved in statistical classifiers related to the determination of probability distribution functions and the corresponding complex mathema-tical treatment of multivariate functions.

In order to extract features to represent the defects, the images are processed by the algorithm shown in Fig. 2 and described in detail in Chacon et al. (2005) . The feature vector to represent the
CF and FP defects were determined by analysis of the shape of the defects. Some of these features were previously used in works reported in Zhao et al. (2005) , Geng et al. (2003) , and Ruberto and
Dempster (2001) to represent objects like, cells, proteins, microscopic worms, diatoms, with a reasonable recognition performance. The first nine features were taken from Geng et al. (2003) . The tenth feature was reported in Rosin (2003) . The eleventh feature comes from Rosin (2003) , and the moment invariants from Zhu et al. (2002) and Hu (1962) . Some examples of their applications can be found in Amaral et al. (2002) and Mery and Filbert (2002) . The features are listed in Table 1 , where x and y represent pixel coordinates, p ( x , y ) is a pixel gray level, B is an object blob, that is a defect. M A is the major axis, Mi A to the minor axis. The number of blobs in the defect is N their number of holes is h . P is the perimeter of the object. E is the number of pixels that form the object skeleton. The area of the convex polygon is A c . E r defines the number of points of ramifications of the skeleton, and the minimum rectangle is A
MR . Fig. 3 illustrates some of the previous features. 3.2. Classifier design and experiments The classification problem was faced with an ANN, classifier. Based on the features described in Section 3.1, Table 1 , the feature vector to represent a defect is defined by (7) x  X  A b , E c , E u , R d , E l , R 1 , R 2 , R 3 , F F , R
The defect samples considered in this work were 170 of CF, and 170 of FP.

The design of the classifier was based on a feedforward neural network architecture. The first step was to select the best two ANN based on the architecture size. Then three different experiments using random selection samples were achieved with each ANN. Each experiment consisted of training and testing, therefore there is performance information for 12 different experiments. The number of epochs for the trainings varied from 26 to 345 for the best ANN and from 56 to 247 for the second best ANN. The classes targets used during the training were defined by certified human inspectors. That is, the ANN performance is measured against a human inspector. The best results were obtained with a three-layer FFBP ANN with 17 X 17 X 2 neurons in each layer. This ANN reached a performance of 100% of recognition during training and 92.35% during testing. The hidden layer has sigmoidal functions and the output layer linear activation functions. The second best ANN was a three-layer FFBP with 17 X 10 X 2 neurons in each layer. The training algorithm employed was the Levenber X  X arquardt . Its performance was 98.66% and 89.46% of recognition during training and testing, respectively. The number of training samples was also changed to find the best architecture (Ramirez-Alonso, 2004). Table 2 shows the performance reached by these FFBP ANNs. An unsupervised
ANN scheme was also investigated through a SOM network. The best architecture turned out to be a Self-Organizing Map, SOM with a hexagonal grid of 4 4 neurons. This experiment was performed only for a brief comparative case. This SOM reached its training in 100 epochs, using 50% of the training samples. The performance of the SOM is shown in Table 2 .

From Table 2 it is observed that the best feedforward and the best SOM ANNs reached the same performance during testing.
Similar performances maybe related to the aspect that the features selected have good discrimination power. However, a notorious difference between the FFBP and SOM is that the performance of the SOM is more consistent during training and testing than the FFBP. The FFBP had more problems to identify the
CF defects in training. However, during testing the FFBP had more problems with the FP defect. The SOM contrary to the FFBP, performed better with the CF during training. Considering that a human inspector reaches a performance between 85% and 90%, the performances reached by the ANNs are acceptable. An advantage of the ANN classifiers is that their approach is completely free of changes in the decision it makes, contrary to a human inspector that can change his or her mind due to subjective influences.

Other classification experiments with fuzzy clustering approaches were achieved. The fuzzy clustering algorithms used were Gustafson X  X essel, GK ( Ram X   X  rez-Alonso, 2004 ) and the Gath X 
Geva modified by Abonyi et al., GG&amp;AS ( Abonyi et al., 2002 ). These experiments were performed only for a brief comparative case in order to have a quick idea of the possible performance of other alternatives and not for an exhaustive study. Table 3 shows the fuzzy clustering results compared with the ANN results. The ANN classifiers turned to have better performance. 4. Detection on non-uniform color regions in translucent film 4.1. Defect and feature vector definition color uniformity of some products by human inspection. For example, polarized ophthalmic lenses require of such inspection for the original polarizing film, Fig. 4 a, or the formed polarizing film Fig. 4 b. A more drastic case, shown for the sake of explanation, is illustrated in Fig. 5 . If a person analyzes the translucent films shown in Fig. 5 a, he or she may perceive the non-uniform regions that could correspond to the colors shown in
Fig. 5 b. This inspection attempts to determine if the color in a surface has some degree of consistency and if it is possible to define the colors. In consequence, this subjectivity produces a high degree of sample inconsistency when a set of samples labeled by a human inspector is generated in order to design a vision inspection system based on a supervised scheme. Thus, in this case we propose a method to find non-uniform regions based on an unsupervised approach. The expected result of the inspection system is to determine the different level color regions, if they exist, in the translucent film. The method described here is based on the fusion of two Computational
Intelligence techniques, a combination of two fuzzy clustering algorithms and a SOM. The proposed method attempts to incorporate the advantages of each technique.
 corresponding to the color pixels of the film images. The color pixels are represented in the CIELab color space. Although there exists many color spaces, the CIELab is recommended because it provides information of color that mimics the human visual perception of color ( Gehlhar and Archer, 2006 ). In The CIELab represents how red or green the objects looks, and b n corresponds to how yellow or blue the object is perceived. Because the CIELab is perceptually uniform, if there are differences in its space, these differences can be perceived by human observers.
 The feature vector in Lab space is defined by X  X  p L  X  x , y  X  , p a  X  x , y  X  , p b  X  x , y  X   X  T  X  8  X  p ( x , y ) is the luminescence component, p a ( x , y ) is the red X  X reen component, and p b ( x , y ) is the blue X  X ellow component of the color information of a pixel at coordinates ( x , y ). 4.2. Classifier design and experiments
In this problem, the classifier system has to assign color pixel to possible class colors that may represent non-uniform regions. The system consists of two main modules. First, the optimal number of clusters and the best centroids representing different colors in translucent film samples are determined based on a combined fuzzy clustering algorithm, that includes the Fuzzy
C-means, FCM ( Bezdek and Pal, 1991 ) and Gath X  X eva, GG ( Abonyi et al., 2002 ) clustering algorithms. The FCM and the GG are selected because they are two of the best fuzzy clustering algorithms with complementary characteristics reported in the literature ( Xu and Wunsch, 2005 ). According to the literature, the
FCM and the GG algorithms have been reported as two of the best fuzzy clustering algorithms. However, each algorithm presents different tradeoffs. The FCM is fast and less sensitive to initialization values, like number of clusters, than the GG algorithm. The GG algorithm on the other hand, is very sensitive to the initialization with respect to the number of clusters ( Balasko et al., 2009 ), but it performs well on clusters with different geometrical form, density and size. Based on this analysis, the FCM was used to determine the optimal number of clusters and the GG is used to define the best centroids. Once the best guest of centroids has been determined, its final determina-tion is accomplished by the SOM. The centroid representation by the SOM is finally used to map the color pixels in the translucent films into non-uniform region representation.

There does not exist a unique form to determine the best number of cluster from a population; therefore, the FCM algorithm is used to determine the best number of clusters M for each translucent film sample I i ( x , y ) based on the following steps:
Consider a set of translucent film images I i ( x , y ) for i  X  1, 2, y , N find the j number of clusters that corresponds to the number of clusters that minimize each cluster validation function min ( SC ), min ( S ), min ( XB ) where min corresponds to the minimum of the validation functions. SC , S , XB are the validation cluster indices functions proposed by Zahid, and Xie X  X eni ( Balasko et al., 2009 ), respectively. This validation functions are defined by SC  X  c  X  X  S  X  c  X  X  XB  X  c  X  X  where m is the degree of fuzzyfication, in this work equal to 2, v the centroid of cluster i , m ik are considered as the membership that the ^ x k data is generated by the i th cluster (posterior probabilities of the sample x k assuming the i th cluster was selected). The number of clusters M i considered for each I correspond to M proposed method in this work to determine M i because there is no clear evidence in the literature to obtain M i with a specific validation index ( Xie and Beni, 1991 ). In order to validate the performance of the proposed method to find the number of best number of clusters it was tested with random samplin g selection in 10 experiments as well as with other known databases ( Perez, 2007 ).

At this point, the optimal number of clusters, M i , for each I are defined. The next step is to apply the GG algorithm to each I ( x , y ) image. The GG algorithm is initialized with its correspond-ing M i value to find the best centroids, C i , of each I to Balasko et al. (2009) , the GG algorithm is defined as follows. Assume a data set X of feature, specify the best number of clusters c , and choose a termination tolerance e 4 0. Initialize the U  X  [ m ik ] c N partition matrix randomly, where m ik denotes the membership that the ^ x k data is generated by the i th cluster. Repeat until the termination tolerance e is met
Step 1: Calculate the clusters centroids v
Step 2: Compute the distance D 2 i , k  X  ^ x k , r i  X  , based on the covariance matrix of the cluster F D where a i is the a priori probability  X 
Step 3: Update the partition matrix m  X  Until : U  X  l  X  U  X  l 1  X  : o e  X  16  X  Once all I i ( x , y ) samples are processed with the GG, we end up with a new set of the best clusters C . This set of centroids, C ,is later analyzed with a SOM to organize the C centroids into a set of k new centroids that will finally represent the complete popula-tion of colors presented in the I i ( x , y ) samples. Following the same criterion as for the clustering algorithms of not including human subjectivity to the method, an unsupervised ANN is used. The
SOM was selected due to its training simplicity and fast training, and because of its good results reported in other works ( Chacon-Murguia et al., 2009 ).

The centroids generated by the FCM-GG methodology are analyzed by the SOM to generate a new set C k of centroids represented by the neurons of the SOM, that is SOM : C ) C , where k ) 9 C 9 , 99 stands for cardinality. The scheme of the complete segmentation method is shown in Fig. 6 .

The neurons of the SOM are distributed in a hexagonal grid with n neurons. The parameters for th e design were; ordering phase learning rate 0.9, ordering phas e steps 1000, tuning phase learning rate 0.02, and tuning phase neigh borhood distance 1. In order to analyze the color generation with respect to the size of the SOM several experiments using different values of n were achieved. The range of n , 12 X 30, was defined by analysis of the M i values generated in the FCM-GG stage. Examples of trained SOMs using the CIELab color space information are shown in Fig. 7 . Observation of Fig. 7 shows that in this application, the color distribution is defined by the grid distribution after the traini ng process. It is important to note that the number of neurons does not necessary correspond to the color resolution; however, better resolution can be achieved with large values of n if this resolution exists in the data.
Fig. 8 illustrates the mapping process of a color pixel through the SOM into its corresponding class color. The black circle simulates the neuron that is activated and generates the new color mapping. 4.3. Results Some examples of the segmentation results are shown in
Figs. 9 X 11 . Fig. 9 corresponds to an exaggerated non-uniform translucent film. This image is shown for the sake of illustrating what a human inspector is looking for. Other real situations that will be hard to solve for a human inspector are illustrated in
Figs. 10 and 11 . A comparison between the proposed segmen-tation method result of images ( Fig. 10 a) are shown, in Fig. 10 b. The segmentations using only the K-means are shown in Fig. 10 c. The segmentations with the FCM algorithm are shown in Fig. 10 d.
The K-means and FCM were initialized with the number of clusters corresponding to the number of neurons of the SOM. It is observed that the proposed method generates better non-uniform regions because the proposed method defines regions in more detail. These details provide more important information from the inspection point of view than most of the general regions obtained with the K-means and FCM.
 central area of Fig. 10 a that is not captured by the K-means . The
FCM captures this region but loses many other regions. In this same image there is a region on the left side with at least two different colors that the FCM maps into one yellow region. The proposed method is the only one that was able to resolve the previous cases having the advantage of being an unsupervised method. The same behavior can be observed in the second row in
Fig. 10 . The original image shows a region of at least two regions on the upper left side that is not resolved by neither the K-means nor the FCM.
 Only the central part of the translucent film is processed because it is the most important region. Fig. 11 b shows the decomposition of non-uniform regions that are present in that sample.
In general, the SOM used for the final centroids definition and image segmentation produced acceptable results considering the human inspector expected results in practical tests. That is, the system was evaluated according to the criterion of a qualified human inspector. 5. Results and conclusions
In this paper we presented a formal Computational Intelli-gence scheme to deal with a human inspection task in industrial applications. The proposed scheme was applied to solve two subjective inspection tasks, classification of cosmetic defects presented in ophthalmic lenses and detection of non-uniform regions in translucent film. The first problem was faced with a supervised and non-supervised ANN. Both ANNs, supervised and unsupervised, have the same performance in testing conditions, 92.35, which is better than human performance. Moreover, the ANN approach has the advantage of being consistent, which is free of situations that influence the decision of a human inspector. The second problem was solved with a hybrid system based on fuzzy clustering and a SOM. The hybrid approach involves management of uncertainty through fuzzy theory and unsuper-vised training supported by the SOM. The proposed method besides being a total unsupervised methodology turned out to produce better results than the two of the most used clustering algorithms, the K-means and FCM algorithms. Furthermore, the proposed scheme also showed a higher level of sensitivity than a simple fuzzy approach. The proposed system is able to find non-uniform regions with similar resolution than a human inspector would be able to find. This proposed method may be trained to detect non-uniform regions like the illustrated Fig. 11 . This figure shows original films, Fig. 11 a, with a black mark indicating the non-uniform region detected by a certified human inspector and the corresponding color mapping generated by the segmentation, Fig. 11 b. Changes between red and white in the segmented image correspond to the non-uniform region detected by the human inspector.

The Computational Intelligence scheme and the results obtained in the industrial applications described may encourage theses CI techniques for the solution of more industrial applications. Acknowledgement
The authors appreciate the support of SEP-DGEST for the support of this research under grants 445.05-P and 833.08-P. References
