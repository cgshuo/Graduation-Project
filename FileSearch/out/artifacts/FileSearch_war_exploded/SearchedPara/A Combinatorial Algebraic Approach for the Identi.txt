 Franz Kir  X aly franz.j.kiraly@tu-berlin.de and FU Berlin, Discrete Geometry Group, Arnimallee 2, 14195 Berlin Ryota Tomioka tomioka@mist.i.u-tokyo.ac.jp Tokyo 113-8656, Japan Reconstruction of a low-rank matrix from partial mea-surements arises naturally in many practically rele-vant problems, such as imputation of missing features, multi-task learning (Argyriou et al., 2008), transduc-tive learning (Goldberg et al., 2010), as well as collab-orative filtering (Srebro et al., 2005).
 Following the success of the nuclear norm heuristic for matrix completion (Srebro et al., 2005; Candes &amp; Recht, 2009), considerable effort has been devoted to understand the performance of such a procedure. Previous studies can be classified by the assumptions about the sampling procedure and the underlying low-rank matrix. (Candes &amp; Recht, 2009) analyzes the noiseless setting, and have shown under uniform sam-pling that incoherent low-rank matrices can be recov-ered with large probability. (Salakhutdinov &amp; Sre-bro, 2010) considered the more realistic setting where the rows/columns are non-uniformly sampled. (Ne-gahban &amp; Wainwright, 2010) showed under the same row/column weighted sampling that non-spiky low-rank matrices can be recovered with large probabil-ity. (Foygel &amp; Srebro, 2011) have shown under uni-form sampling that the max-norm heuristic (Srebro &amp; Shraibman, 2005) can achieve superior reconstruc-tion guarantee without the non-spikiness assumption on the underlying low-rank matrix.
 All the above theoretical guarantees are built on some assumption on the sampling procedure, e.g., uniform sampling. Nevertheless, in a practical setting, we al-ways know which entries we can observe and which entries we cannot (the so-called mask). One may ask if we could obtain a stronger theoretical guarantee (of success or failure) conditioned on the mask we have. On the other hand, all the above theories are also based on some assumptions on the underlying low-rank matrix, which are usually uncheckable. Although it is clear that we cannot recover arbitrary low-rank ma-trices (see Candes &amp; Recht, 2009), one may ask if we could build a theory for matrix completion for almost all matrices, depending only on the mask.
 Until now, all Machine Learning approaches have been mostly agnostic to the deep connections between ma-trix completion and the fields of combinatorics and algebraic geometry. Indeed there are at least two ex-isting independent strains of work related to matrix completion outside the Machine Learning community: the first is rigidity theory, a branch of combinatorics concerned with realizing partially known distance ma-trices which is subtly different from matrix completion, but is closely related, see (Singer &amp; Cucuringu, 2010) for an overview. The second strain, in algebraic ge-ometry, is the study of determinantal varieties. A de-terminantal variety is a set of low rank matrices with possible additional properties, considered as a mani-fold. The results closest to matrix completion in pure algebraic geometry are on sections of determinantal varieties (Giusti &amp; Merle, 1982; Gonciulea &amp; Miller, 2000; Boocher, 2011). Moreover, determinantal vari-eties frequently expose combinatorial structure which is studied in field of combinatorial algebra. Connec-tions between combinatorics and algebra have already been observed in rigidity theory, crucially contribut-ing to recent developments. We will show that matrix completion is also related naturally to both algebra and combinatorics.
 We believe that using and combining these disjoint techniques may be highly beneficial for the Machine Learning community in both theoretical and applied algorithmical ways. In this paper, we demonstrate the strength of the algebraic combinatorial approach by applying it to the basic theoretical questions in ma-trix completion. We derive necessary and sufficient conditions for when a matrix of arbitrary rank can be reconstructed from a set of entries. As special cases, we derive central results for matrix completion in terms of these entries, which can be seen as analoga of re-sults in rigidity theory. We also give a new algorithm, inspired by the newly derived criteria, which can be used to reconstruct matrices where the state-of-the-art algorithms may fail. We conclude with numerical simulations, comparing the novel criteria and matrix completion algorithm to state-of-the-art methods. Summing up, our novel contributions are:  X  Introduction of a combinatorial algebraic frame- X  The first necessary and sufficient identifiability  X  Formulation of a constructive combinatorial alge-Before we continue with stating the results, we want to give a brief overview of the main ideas of the paper. Suppose the truth, or generative model, is given by a 3  X  3 matrix, say The entries a ij may be interpreted as class or index dependent observations. The matrix M has rank 1, so the entries are highly dependent; for example, one single entry in a row can be used to predict the whole row if an arbitrary other row is known. In the ma-trix completion setting, only some of the entries are known -the so-called measurements. Suppose we make five measurements. Two possible scenarios are that we measure the entries in
A If we know that the original matrix A had rank one, we can reconstruct A from A 1 . Namely, the column space is one-dimensional, so the entries of each column are determined by a unique scaling factor. The scaling factor can be determined for each of the two missing columns in A 1 by computing a 22 /a 21 , resp. a 31 /a Algebraically, this corresponds to successively solving all minor equations or, as above, expressed as fractions, the equations If we try this approach to reconstruct A from A 2 , it fails. Indeed, it turns out that it is impossible to recon-struct A from A 2 . One possible way to see this is that the entry a 12 can be chosen independently to be any-thing, and then continuing the strategy for A 1 gives a valid matrix completion for any choice of a 12 . Thus, the set of valid completions is highly non-unique -it has one degree of freedom -or, algebraically spoken, (Krull) dimension one.
 Alternatively, the problem can be regarded combina-torially. To both the matrices A 1 ,A 2 , we can associate bipartite graphs G 1 ,G 2 in the following way: the bi-partite vertex sets are the columns ( X  X ed vertices X ) and the rows ( X  X lue vertices X ) of A k . An edge ( i,j ) is in G k if the entry a ij is known in A k , i.e. A k has no  X  at that position. Above is a depiction of G 1 and G 2 . One can see that G 1 is connected, while G 2 is not. In-tuitively, the edges one can add by virtue of the minor equations correspond to  X  X ossibilities to reconstruct X . One can show that one can add exactly the edges be-tween vertices in the same connected component; thus, for a unique reconstruction of A , the graph must be connected.
 This shows that matrix completion has intrinsically both algebraic and combinatorial features; the phe-nomena above have indeed interesting generalizations. In the following sections, we will give a more rigorous exposition which will lead to novel types of theoretical results and algorithms. 2.1. Matrix Completion -an Algebraic First we introduce some definitions and notations which allow us to formulate the problem of matrix completion and later enable us to state our results. The central observation is that the relevant occurring sets and maps in matrix completion are all algebraic (i.e. defined by polynomials) and thus give rise to an algebraic formulation of matrix completion. The gen-eral setting for matrix completion is the following: one starts with a low-rank ( m  X  n ) matrix A , say of rank rank A = r . However, only a fixed subset of the en-tries of A is known. The task is now to reconstruct A uniquely from the known entries, and the fact that A has rank r . Whether this is possible depends ob-viously on the known entries, and in this paper, we will investigate this question. We model the choice of entries as follows: Definition 2.1. A map  X  : C m  X  n  X  C  X  which sends a matrix to a fixed tuple of its entries, i.e.
 where the bituples ( i ` ,j ` ) are all different, is called masking . Such a map is uniquely defined by the set of entries i k j k in the image set. We call the unique matrix which has ones at those entries, and zeroes elsewhere, the mask of  X  and denote it by M ( X ) .
 Note that a masking  X  can be interpreted as tak-ing the Hadamard product of the argument with the mask M ( X ). Matrix completion requires one to re-strict maskings to the set of low rank matrices, for which we introduce notation: Notations 2.2. We will denote the set of ( m  X  n )-matrices with rank at most r as In the following, we assume r  X  m  X  n without loss of generality. A classical result in algebraic geome-try states that M ( r ; m  X  n ) is an algebraic variety, the so-called determinantal variety (of low-rank matri-ces); that is, the set M ( r ; m  X  n ) is a closed subset of C m  X  n , defined by the vanishing of a set of polynomials -namely, the ( r + 1)-minors. The variety M ( r ; m  X  n ) is known to be irreducible, i.e., it cannot be written as the proper union of two algebraic varieties. Moreover, the dimension of the determinantal variety is known to be With these notations, the identifiability problem of matrix completion can be reformulated as follows: Problem 2.3. Let  X  be a masking. When is its re-striction to the (at most) rank r matrices invertible? That is, when is it uniquely possible to identify a matrix A  X  M ( r ; m  X  n ) from its masking  X ( A ) , depending on m,n,r and M ( X ) ? Alternatively formulated: when does it hold that Note that in this formulation, invertibility may also depend a-priori on the choice of the matrix A . We will synonymously use the term completability when A can be uniquely identified. One might now naively think that invertibility does not depend on the choice of A ; however, the following result shows that this is not the case in general: Proposition 2.4. Let r  X  2 . Then the restricted masking  X  : M ( r ; m  X  n )  X  X  X  C  X  is injective if and only if  X  = mn.
 Proof. Clearly, if  X  = mn ; then  X  is injective, as it is the identity map. So it suffices to prove: if r  X  2 and  X  &lt; mn , there exists a matrix A such that { A }6 =  X   X  1 ( X ( A )) . Now since  X  &lt; mn , there exists an index ij such that M ( X ) ij = 0. Let A be any matrix whose columns, except the j -th, span an ( r  X  1)-dimensional vector space. Since X is of (at most) rank r , the set  X   X  1 ( X ( A )) contains any matrix  X  A which is identical to A but has an arbitrary entry at the index ij . That, in general, not all matrices can be reconstructed is a known result, see (Candes &amp; Recht, 2009); indeed, Proposition 2.4 may seem to imply that we have to look for additional properties or sampling assumptions on the possible A to obtain firm results -which is the rationale behind introducing spikiness or incoherence. However, the pathologies presented in the proof can be remedied by a slight relaxation to all matrices but a zero set, which is formally modelled by the  X  X eneric X  property: Definition 2.5. A generic ( m  X  n )-matrix of rank r is a positive, continuous, M ( r ; m  X  n )-valued random variable. By convention, we will say that a statement is true for a generic matrix, if it is true with probability one.
 Note that in the definition, we have assumed nothing on the distribution of the random variable. In fact, a statement is true with probability one for one particu-lar positive continuous distribution if and only if it is true with probability one for all such distributions, as being true generically is equivalent that the exception set to the statement is a zero set in M ( r ; m  X  n ). More-over, there is a purely algebraic concept of  X  X eneric X  in algebraic geometry, which is -under certain con-ditions -equivalent to our probabilistic formulation. Details can be found e.g. in the appendix of (Kir  X aly et al., 2012a). Under the slight relaxation provided by genericity, it can be proved that the completability of a matrix depends only on the chosen mask (Recall that our convention in Definition 2.5 allows for a possible zero set of exceptional matrices): Theorem 2.6. Let A be a generic ( m  X  n ) matrix of rank r . Then the dimension of the algebraic set  X   X  1 ( X ( A )) depends only on the mask M ( X ) . More-over, if the dimension is zero, that is, the number of possible completions in  X   X  1 ( X ( A )) is finite, then this number also depends only on the mask M ( X ) . In par-ticular, the completability of the matrix A depends only on the chosen mask.
 Proof. As A is a positive continuous random vari-able, the statement above is equivalent to showing that there is an open dense set U in C m  X  n , such that for all matrices B in U , the set of possible completions  X   X  1 ( X ( B )) has the same dimension and cardinality. But this is exactly what is stated in the generic fiber theorem or upper semicontinuity theorem (see e.g. I.8, Corollary 3 in (Mumford, 1999)), when applied to the algebraic map  X  : M ( r ; m  X  n )  X  X  X  C  X  , considering that M ( r ; m  X  n ) is irreducible.
 Theorem 2.6 motivates the following relaxations of in-jectivity and finiteness: Definition 2.7. A masking  X  is called generically injective on M ( r ; m  X  n ) if for generic A , one has { A } =  X   X  1 ( X ( A )) . A masking  X  is called generi-cally finite on M ( r ; m  X  n ) if for generic A , the set { A } =  X   X  1 ( X ( A )) is finite. Abbreviatingly, we will also say that  X  is generically injective (or finite) in rank r if m,n is arbitrary.
 Note that generic finiteness is a necessary condition for generic injectivity. With the result of Theorem 2.6 and this notation, we arrive at the definitive formulation of the identifiability of matrix completion: Problem 2.8. When is a masking  X  generically in-jective on M ( r ; m  X  n ) , given m,n,r and M ( X ) ? We will investigate this question in greater detail in the next section. Also note that a generic matrix in M ( r ; m  X  n ) always has the maximal rank r (i.e., with probability one). Before continuing, we mention an important detail: Remark 2.9. A necessary condition for  X  to be gener-ically injective is that it is generically finite. The latter is, by Definition 2.7, equivalent to the fact that for a generic matrix A  X  M ( r ; m  X  n ) . A classical result in algebraic geometry relates the generic fiber dimension to the dimensions of range and image: it equates to as the determinantal variety M ( r ; m  X  n ) is irreducible; see e.g. I.8, Theorem 3 in (Mumford, 1999) for a proof. The generic fiber dimension is also the same as the rel-ative tangent space dimension at the generic point of the map  X . For fixed  X , this dimension can be cal-culated by determining the rank (or co-rank) of the Jacobi matrix over a randomly chosen A -this is a classical task in computational algebra. In (Singer &amp; Cucuringu, 2010), a probabilistic algorithm along these lines is provided for the rigid realization prob-lem -the vanishing of the dimension is called  X  X ocal completability X ; the same techniques can be used to construct an algorithm for testing generic injectivity, or generic finiteness of a mask. A more detailed discus-sion of the relation between rigid realization and ma-trix completion can be found in the supplement (Kir  X aly &amp; Tomioka, 2012). 2.2. Matrix Completion -a Combinatorial We continue by deriving combinatorial conditions for a mask to be completable. We will show that com-pletability is encoded in the combinatorial properties of a specific graph: Definition 2.10. Let  X  be a masking with mask M ( X ). We will call the unique bipartite graph G ( X ) which has adjacency matrix M ( X ) the adjacency graph of  X . Recall that to the ( m  X  n )-matrix M ( X ), the associated bipartite graph G ( X ) = ( V 1 ,V 2 ,E ) is de-fined as follows: The two sets of vertices are the num-bers V 1 = { 1 ,...,m } and V 2 = { 1 ,...,n } ; an edge ( i,j )  X  V 1  X  V 2 is in E if and only if M ( X ) ij = 1 . We will denote the above edge set E of G ( X ) by E ( X ). In the following, for convenience of reading, we will refer to the elements of V 1 as the red , and to the elements of V 2 as the blue vertices of G ( X ).
 A sufficient condition for matrix completability can be formulated in terms of a generalized closure: Definition 2.11. Let G be a bipartite graph. Let us denote by K  X  r +1 ,r +1 the complete bipartite graph K r +1 ,r +1 minus one edge 1 . If G does not contain a vertex set whose induced subgraph is isomorphic to K r +1 ,r +1 ; we call G an r -closed bipartite graph, and G is its own r -closure . If G contains a vertex set whose induced subgraph is isomorphic to K  X  r +1 ,r +1 , denote by G 0 the graph which is obtained from G by adding the missing edge in G . In this case, the r -closure of G is recursively defined as the r -closure of G 0 . If the r -closure of a bipartite graph G with m red and n blue edges is K m,n , we call G an r -closable graph. The recursive definition of r -closure is well-defined, as the possible number of edges in G is finite, and by adding edges one arrives always at the same unique r -closed graph. Also, the 1-closure of a bipartite graph is its bipartite transitive closure. One can show that a bipartite graph is connected if and only if it is 1-closable.
 In this terminology, we may formulate a necessary con-dition for generic injectivity: Proposition 2.12. A masking  X  is generically injec-tive in rank r if G ( X ) is r -closable.
 Proof. The proof uses that r -closability is the combi-natorial counterpart of being able to subsequently find ( r + 1)  X  ( r + 1)-blocks in the mask containing exactly one zero. For each of these blocks, the missing entry can be calculated using the vanishing minor condition in the generic situation. Details can be found in the supplement (Kir  X aly &amp; Tomioka, 2012).
 Similarly, one can derive necessary conditions for generic injectivity by combining combinatorial and al-gebraic considerations: Proposition 2.13. A masking  X  is generically injec-tive, or generically finite, on M ( r ; m  X  n ) only if: (i) # E ( X )  X  r  X  ( m + n  X  r ) (ii) Each vertex of G ( X ) has degree at least r (iii) G ( X ) is r -connected, i.e., G ( X ) is connected after (iv) For a vertex partition of G ( X ) into N bipartite Proof. The proof follows the lines Remark 2.9 which states that  X  is generically injective only if the generic fiber dimension is zero, and provides a formula to ob-tain the generic fiber dimension from the dimension of the image and the range. This implicitly gives a way to bound the generic fiber dimension in terms of the number of known entries of the mask. The calculations and the proof are carried out in the supplement (Kir  X aly &amp; Tomioka, 2012).
 Interestingly, neither in the sufficient nor in the neces-sary condition is it used that the graph G ( X ) arises as the adjacency graph for a matrix completion problem. So, as sufficient conditions imply necessary ones, we may formulate a purely graph theoretic result: Theorem 2.14. Any r -closable bipartite graph is r -connected. Moreover, any r -closable bipartite graph G with m red and n blue vertices fulfills conditions (i) to (iv) from Proposition 2.13.
 We conclude with a result which relates the necessary and sufficient condition in special cases: Proposition 2.15. For r = 1 and r = m  X  1 (recall that we have assumed r  X  m  X  n ), the necessary and sufficient conditions in Propositions 2.13 and 2.12 co-incide. In particular, a 1 -connected bipartite graph is 1 -closable, and any bipartite graph fulfilling conditions (i) and (ii) from Proposition 2.13 with r = m  X  1 is ( m  X  1) -closable.
 Proof. The proof is carried out in detail in the sup-plement (Kir  X aly &amp; Tomioka, 2012). For r = 1, the statement follows from the purely graph-theoretical fact that 1-closability is equivalent to 1-connectedness -that implies the equivalence of the necessary condi-tion (iii) in Proposition 2.13 and the sufficient condi-tion from Proposition 2.12. For r = m  X  1, the state-ment follows from a combinatorial pigeonhole-type ar-gument which shows that conditions (i) and (ii) in Proposition 2.13 already imply r -closability.
 We want to mention that the result for r = 1 is the ma-trix completion analogue of Proposition 5.6 in (Singer &amp; Cucuringu, 2010) for rigid realization; the result for r = m  X  1 is similar to Corollaire 1.5 of (Giusti &amp; Merle, 1982) which is for coordinate sections. More-over, for r  X  2, the conditions in Propositions 2.13 and 2.12 are not equivalent for generic injectivity, as the following example shows: Example 2.16. Consider the case of rank r = 2, m = n = 4 and the masks M Both matrices M 1 and M 2 fulfill the necessary condi-tions given in Proposition 2.13. For example, Condi-tion (i) is fulfilled, as both matrices contain r  X  ( m + n  X  r ) = 12 entries. However, only M 1 fulfills the sufficient condition in Proposition 2.12: M 1 is 2-closable and thus defines a generically injective masking by Proposi-tion 2.12 with unique completion; the matrix M 2 is not 2-closable. Indeed, for a generic matrix in M (2; 4  X  4) masked by M 2 , there exist two distinct completions, as an elementary calculation of the vanishing minor condition shows.
 However, we cannot exclude that Propositions 2.13 is equivalent to generic finiteness, which -after adding one suitable edge -implies generic injectivity. So it may be that the necessary and sufficient conditions for generic injectivity are tight up to one edge. 2.3. An Algebraic Combinatorial Algorithm The necessary and sufficient conditions given in Propo-sitions 2.12 and 2.13 give theoretical bounds for the success of matrix completion. We wish to demonstrate that these conditions can be also used constructively to obtain novel matrix completion algorithms. First we describe an algorithm for noise-free entries with Algorithm 1. It is based on the sufficient condition in Proposition 2.12 which is essentially algorithmic and, with a slight modification, yields an explicit procedure that completes the matrix by explicitly calculating en-tries for the r -closure.
 Algorithm 1 Matrix completion by r -closure.
 Input: A masked rank r matrix  X ( A ).
 Output: The complete matrix A , or nil. 1: Optional: Check whether some necessary condi-2: Find a bipartite subgraph of G ( X ) isomorphic to 3: Compute the missing element of A by (numerically 4: Add the missing element to A ; add the entry to 5: Repeat 2-4 until G ( X ) = K m,n .
 Algorithm 1 computes a completion, whenever the suf-ficient conditions in Proposition 2.12 holds. If not, th algorithm will return nil. In line 1, the algorithm checks necessary conditions for completability. Alter-natively, one could use the algorithm given in (Singer &amp; Cucuringu, 2010) to obtain a definite answer -de-pending on available computational time. In lines 2-4, an entry is added to A using the determinantal condi-tion. The computationally critical step in this part is finding a subgraph isomorphic to K r +1 ,r +1 minus one edge. While the subgraph problem is known to be com-putationally hard, heuristics (e.g. random sampling on a subset) can speed up this part considerably under the cost of correctness, or termination. However, if the algorithm terminates, the found completion is a valid solution. If the matrix is r -closable, repetition of 2-4 then leads to reconstructing the whole matrix. This algorithm for the noise-free case can be extended to cope with noise, using methods from approximate linear algebra and approximate commutative algebra as in (Kir  X aly et al., 2012b). Due to space limitations, we refrain from doing so, and will present the results in a future paper.
 As already noted, it cannot be a-priori excluded that Proposition 2.12 fails even if there is a finite comple-tion; as Proposition 2.12 is not proven to be necessary. However, in our experiments, this seems to be never the case for complete subgraph search. In our simulations, we investigate the necessary and sufficient conditions from Propositions 2.12 and 2.13 in comparison to our new Algorithm 1.
 The presented version of Algorithm 1 uses a heuristic to find the r -closable subgraphs of G ( X ): for each edge in the bipartite graph G ( X ), the vertex degree is deter-mined. Then, the algorithm tries to construct closable subgraphs from the highest degree neighbor vertices. If this fails for a fixed number of trials, the algorithm goes to the next vertex.
 We also include two state-of the-art algorithms in our comparison: the nuclear norm heuristic (Fazel et al., 2001; Srebro et al., 2005) and OptSpace (Keshavan &amp; Oh, 2009; Keshavan et al., 2010). The nuclear norm heuristic solves the convex minimization problem where  X  A is the matrix of measurements. We use the alternating direction method of multipliers (Gabay &amp; Mercier, 1976) to solve the above minimization prob-lem. The second algorithm, OptSpace, solves the non-convex minimization problem using gradient descent on the Grassmann mani-fold (Keshavan &amp; Oh, 2009). We compare the nec-essary condition, and the algorithms in three experi-ments. For each experiment, we first fix the matrix size m,n and the matrix rank r . Then, we vary the number of measurements, i.e. the number of known entries in  X ( A ), or in previous notation, # E ( X ) . For each number of measurements, we randomly and uni-formly sample N = 100 masks without replacement, and for each mask, a random ( m  X  n ) rank r matrix A . We then calculate the ratio of masks for which  X  The necessary condition of Propositions 2.13 (iii)  X  Algorithm 1 is able to compute the completion A ,  X  The OptSpace algorithm is able to compute the  X  The nuclear norm heuristic is able to compute the The results are shown in Figure 1. For small rank r = 3, Algorithm 1 outperforms the state-of-the art methods for the small (10  X  15) as well as for the big (40  X  50)-matrices. For (40  X  50)-matrices with rank 10, r -closure is comparable to Nuclear Norm and out-performs OptSpace. In the cases with small rank, r -connectivity and r -closability seem to be close to each other, but become less close with increasing rank. In all cases, Algorithm 1 is at least competitive with the existing state-of-the-art methods. In this paper, we have introduced a basic combina-torial algebra framework for the matrix completion problem. With this framework, we were able to de-rive the first known necessary and sufficient conditions for completability of a matrix in terms of the set of known entries, building on the introduced techniques which link matrix completion to combinatorial graph theory and algebraic geometry. As a by-product, we have also obtained graph theoretical results. Following the sufficient condition, we were also able to formu-late an algorithm for the matrix completion problem, which we have shown to be competitive with known matrix completion algorithms and which performs bet-ter than state-of-the art methods for small rank. The obtained results lead us to argue that studying the interactions between machine learning, algebraic ge-ometry, and combinatorics bears the potential to be highly beneficial for the problem of matrix comple-tion, regarded from the viewpoint of any of the three fields. These links are not yet fully explored; however, the presented results suggest a fruitful interaction. We conclude that future work on matrix completion can only benefit from an interdisciplinary connection of machine learning and combinatorial algebra.

