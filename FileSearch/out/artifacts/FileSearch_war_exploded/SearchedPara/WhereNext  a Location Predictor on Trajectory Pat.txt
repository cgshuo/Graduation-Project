 The pervasiveness of mobile devices and location based ser-vices is leading to an increasing volume of mobility data. This side effect provides the opportunity for innovative meth-ods that analyse the behaviors of movements. In this paper we propose WhereNext , which is a method aimed at pre-dicting with a certain level of accuracy the next location of a moving object. The prediction uses previously extracted movement patterns named Trajectory Patterns ,whichare a concise representation of behaviors of moving objects as sequences of regions frequently visited with a typical travel time. A decision tree, named T-pattern Tree , is built and evaluated with a formal training and test process. The tree is learned from the Trajectory Patterns that hold a certain area and it may be used as a predictor of the next loca-tion of a new trajectory finding the best matching path in the tree. Three different best matching methods to classify a new moving object are proposed and their impact on the quality of prediction is studied extensively. Using Trajectory Patterns as predictive rules has the following implications: (I) the learning depends on the movement of all available ob-jects in a certain area instead of on the individual history of an object; (II) the prediction tree intrinsically contains the spatio-temporal properties t hat have emerged from the data and this allows us to define matching methods that striclty depend on the properties of such movements. In addition, we propose a set of other measures, that evaluate a priori the predictive power of a set of Trajectory Patterns .This measures were tuned on a real life case study. Finally, an exhaustive set of experiments and results on the real dataset are presented.
 H.2.8 [ Database Applications ]: Data mining Copyright 2009 ACM 978-1-60558-495-9/09/06 . . . $ 5. 00. Algorithms Trajectory patterns, Spatio-temporal data mining
The last few years, have witnessed a considerable increase in the number of mobile devices along with the use of wire-less communication, such as Bluetooth, Wi-fi and GPRS. Such mobile devices are often equipped with positioning sen-sors that utilize Global Positioning Systems (GPS) to accu-rately provide the location of a device. This means that the movement of people or vehicles within a given area can be observed from the digital traces left behind by the per-sonal or vehicular mobile devices, and collected by the wire-less network infrastructures. For instance, mobile phones leave positioning logs, which specify their localization, or cell, whenever they are connected to the GSM network. Likewise GPS-equipped portable devices can record their latitude-longitude position and transmit their trajectories to a collecting server. The pervasiveness of such ubiqui-tous technologies guarantees that there will be an increasing availability of large amounts of data on individual trajecto-ries, with increasing precision in term of localization. Knowledge about the positions of mobile objects has led to location-based services and applications, which need to know the approximate position of a mobile user in order to operate. Examples of such services are navigational ser-vices, traffic management and location-based advertising. In a typical scenario, a moving object periodically informs the positioning framework of its current location. Due to the un-reliable nature of mobile devices and the limitations of the positioning systems, the location of a mobile object is often unknown for a long period of time. In such cases, a method to predict the possible next location of a moving object is required in order to anticipate or pre-fetch possible services in the next location. Several proposals in the literature use only the history of movements of the individual object on the basis of which future location is simply guessed. The innovative aspect of our work, on the other hand, is in the use of the movements of all objects in a certain area to learn a classifier. Our basic assumption is that people often fol-low the crowd: individuals tend to follow common paths. For example, people go to work every day by similar routes, and public transport crosses similar routes in different time periods. Thus, if we have enough data to model typical be-haviors, we can use such knowledge to predict the future movement of most individuals: at least those whose past movements are fairly typical.
 Our method uses the movement patterns previously extracted by using the Trajectory Pattern algorithm developed in [2]. The Trajectory Pattern algorithm mines movement patterns as sequences of regions where typical travel times are fre-quently followed.
 The four main steps of our approach are as follows: Data Selection : by using spatio-temporal primitives, we Local Models Extraction :the Trajectory Pattern algo-T-pattern Tree Building : the extracted local models, Prediction :The T-pattern Tree is used to predict the The performance of the classifier is evaluated against a real dataset of 17000 cars equipped with GPS. The results of the experiments show that the prediction is of a good qual-ity when high spatio-temporal precision is required. Clearly this is holds for a specific set of moving objects. In fact the precision decreases as the number of moving objects for which a prediction is possible grows.
 The rest of the paper is organized as follows. In Section 2 we review the most recent literature regarding location pre-diction methods. In Section 3 we introduce the Trajectory Pattern mining method. Section 4 is the core of the paper, where the innovative aspects of our work are presented. We describe how to build the T-pattern Tree and present our prediction algorithm. In Section 5 a method to evaluate the strength of prediction of the extracted patterns before building the tree is presented. Some experimental results are presented in Section 6. Section 7 concludes the paper and highlights the most promising future lines of research.
There are several studies that address the problem of pre-dicting future locations. Most of them use a model based on frequent patterns and association rules and define a trajec-tory as an ordered sequence of locations, where the time is used as a time-stamp [8, 9, 13, 5]. Moreover, some of these approaches try to predict the next location of a moving ob-ject by using the movements of all the moving objects in a database [8, 9], while others base the prediction only on the movement history of the object itself [13, 5]. In [8, 9] Morzy introduces a new method for predicting the location of a moving object. In particular, he extracts the associ-ation rules from the moving object database. Then, given a trajectory of a moving object, using matching functions he selects the best association rule that matches this trajec-tory, and then uses it for the prediction. In [8] Morzy uses a modified version of Apriori algorithm to generate associa-tion rules, and in [9] he uses a modified version of PrefixSpan algorithm. All the matching functions in these papers are based on the notions of support and confidence and do not consider any notion of spatial and temporal distance. In [13] the authors propose a method to predict user move-ments in a mobile computing system. This algorithm is based on three steps: mining the mobility patterns of an in-dividual user, forming association rules from these patterns, and finally predicting a mobile user X  X  next movements by using these rules. In order to select the rule used for the prediction, the authors consider the notions of support and confidence. The support of each candidate is computed by a distance based on the notion of string alignment. Jeung et al. in [5] present an innovative approach which forecasts future locations of an object in a hybrid manner. They combine predefined motion functions with the movement patterns of the object, extracted by a modified version of the Apriori algorithm. The motion functions are linear or non-linear models that capture the object X  X  movements by sophisticated mathematical formulas and are an input of the method decided by the analyst.
 In [12] the authors use a time-series analysis with travel speed simulations to predict future trajectories. They use a process based on range querying with spatial-temporal con-straints on a moving object database. The prediction is represented by the locations that satisfy the spatio-temporal constraints.
 Frequent patterns are also used to build a classification model. An interesting approach based on a framework of frequent pattern-based classification is presented in [1]. There are essentially three steps: feature generation, feature selection and model learning. In the first step, frequent patterns are generated with a specified minimum support. In the second step, feature selection is applied on frequent patterns and finally, a classification model is built from frequent patterns selected.
Over the last five years, attempts have been made to ex-tend many techniques for knowledge discovery in classical relational or transactional data to knowledge discovery in the context of movement data [10]. Some of the typical techniques adapted to the spatio-temporal context are asso-ciation rule mining, frequent pattern discovery, clustering, classification, prediction, and time-series analysis. Most approaches tend to define clustering algorithms, which group together moving object trajectories using some notion of trajectory similarity, which is typically distance-based. When searching for concise representations of interesting be-haviors of moving objects, we define local patterns. These are patterns that aim at characterize small portions of the data space. T-pattern was originally introduced in [3], where the authors developed an extension of the sequential pat-tern mining paradigm, introduced in [2], which analyzes the trajectories of moving objects. A trajectory of a moving object is a sequence of time-stamped locations, representing the traces collected by some wireless/mobility infrastruc-ture (GSM, GPS, etc). The location is abstracted by using ordinary Cartesian coordinates, as formally stated by the following definition:
Definition 1. A Trajectory or spatio-temporal sequence is a sequence of triples where t i ( i =0 ...n ) denotes a timestamp such that  X  0 t &lt;t i +1 and ( x i ,y i ) are points in R 2 .

Intuitively, each triple &lt;x i ,y i ,t i &gt; indicates that the ob-ject is in the position ( x i ,y i )attime t i .
 Trajectory Pattern is an efficient algorithm to extract a set of frequent temporally-annotated sequences of dense spa-tial regions extracted from trajectories with respect to two thresholds  X  and  X  : the former represents the minimum sup-port and the latter a temporal tolerance. The threshold  X  denotes the minimum support as well as in the standard fre-quent sequential pattern algorithms. In the case of a Trajec-tory Pattern , it is also used as a spatial density threshold. In fact, the algorithm discretizes the working space through a regular grid with cells of a user-set size. Then the density of each cell is computed by considering each single trajectory and incrementing the density of all the cells that contain any of its points. Finally, a set of the most frequent regions is extracted by means of a simple heuristics considering only the cells with a density greater than  X  . Each T-pattern extracted is a concise description of frequent behaviors, in terms of both space (i.e. the regions of space visited during movements) and time (i.e. the duration of movements). As an example, consider the following T-pattern over re-gions of interest in the center of a town: RailwayStation 15 min  X  X  X  CastleSquare 50 min  X  X  X  Museum Intuitively, people typically move between the railway sta-tion to Castle Square in 15 minutes and then to the Museum in 50 minutes. Now we recall the T-patterns definition in-troduced in [3]: Algorithm 1 : PrefixTreeBuilding( T p Set ) Input : A Set of T-patterns T p Set Output : A T-pattern Tree PT
PT = new T-pattern Tree(); foreach T p in T p Set do end return PT Definition 2. A T-pattern, is a pair ( S, A ) ,where S = &lt; R ,...,R n &gt; is a sequence of regions, and A =  X  1 ,... X  R + is the (temporal) annotation of the sequence. A T-pattern is also represented as ( S, A )= R 0  X  1  X   X   X 
As explained in [2], the extraction of a representative tran-sition time as an annotation is formalized as a density es-timation problem. Therefore the resulting set of temporal annotations of a sequence is a set of temporal intervals, each of which represents one side of a dense (hyper)cube. An ex-ample of a T-pattern is shown in Fig.1.
The goal of the prediction method WhereNext is as fol-lows: given a database of trajectories D construct a predic-tive model WN D using the set of T-patterns extracted by D ; given a new trajectory T use WN D to predict the next location of T .
 WhereNext consists of several steps. First of all, we select the set of interesting trajectories, namely those crossing a specific area and a specific temporal window defined by a spatio-temporal query. In the second step, the Trajectory Pattern mining algorithm is applied to the selected trajec-tories and a set of T-patterns is extracted with respect to a temporal threshold  X  and a minimum support  X  . Different settings of the two parameters  X  and  X  return different col-lection of T-patterns. In order to choose the best T-pattern collection from the extracted ones their predictive power is measured following an evaluation function defined in Section 5. Finally, the selected collection of extracted T-patterns is used to build the predictive model. Below we describe these steps in detail.
The use of association rules is a consolidated method to build classifiers. The prediction phase consists in matching the  X  X uple X  to be classified against the body of the rule. If a matching is found, the tuple is classified according to the value of the head [7, 6]. Following this direction, the first problem in our case is how to generate Body  X  Head rules from a T-pattern of the form R 0  X  1  X   X   X  R 1  X  2  X   X   X  ... Clearly, many possible Body  X  Head rules can be derived from a T-pattern. For example, from R 0  X  1  X   X   X  R 1  X  2  X   X   X  R 3 we can generate the rules Thus, the predicted next location of the trajectory ( l 0 ( l ,t 1 )  X  ( l 2 ,t 2 ) is the region R 3 if some spatio-temporal matching holds with the body of the rule (1), while the predicted next location of the trajectory ( l 0 ,t 0 )  X  ( l R 2 if some spatio-temporal matching holds with the body of the rule (2).
 To avoid generating several rules from each T-pattern and to make the prediction phase efficent we adopted a prefix tree, named T-pattern Tree , to compactly represent a collection of T-patterns. Hereafter the path of a T-pattern Tree indicates arule.

The T-pattern Tree is a prefix tree and is defined as a triple PT =( N, E, Root ( PT )), where N is a finite set of nodes, E is a set of labeled edges and Root ( PT )  X  N is a fictitious node, that represents the root of the tree. Each edge belonging to E is labeled with a time interval int .The triple ( u, v, int )  X  E denotes the edge labeled with the time interval int between the parent node u and the child node v . The time interval int has the form [ time min ,time max The edges taht link the root node to its child nodes are the only edges of the tree labeled with an empty time interval, denoted by int . Each node of the tree (except the root) has exactly one parent and it can be reached through a path, which is a sequence of labeled edges starting with the root node. An example of a path for the node c (denoted by P ( c, PT )) is:
P ( c, PT )=( Root ( PT ) ,a,int ) , ( a, b, int 1 ) , ( b, c, int Each node v  X  N ,except Root ( PT ), contains entries of the form id, region, support, children ,where: Given a path P ,if( u, v, [ time min ,time max ]) is an edge of P ,then[ time min ,time max ] intuitively represents the travel time interval of the transition from the region of the node u to the region of v .

The PrefixTreeBuilding algorithm (see Algorithm 1) de-scribes how to build the T-pattern Tree given a set of T-patterns T p Set . The following definition introduces the no-tion of prefix of a T-pattern.

Definition 3. Let ( S, A ) and ( S ,A ) be two T-patterns such that ( S, A )= R 0  X  1  X   X   X  R 1  X  2  X   X   X  ...  X  n  X   X   X  R and only if k  X  n and  X  i =1 ...k  X  i is included in  X  i .
In order to simplify the description of the algorithm we consider that a T-pattern is a sequence of pairs interval, region . Specifically, given the sequence i 1 ,r 1 ... i n ,r n we use i to denote the interval of time to reach the region r k from r  X  1 . In this representation the first interval i 1 is fictitious and equal to [0 ,  X  ].
 Each T-pattern belonging to T p Set , is inserted into the T-pattern Tree . Intuitively, given a T-pattern T p ,inthetree we search for the path that corresponds to the longest prefix of T p . Next, we append a branch, which represents the rest of the elements of T p in this path. A T p is appended to a path in the tree if this tree is a prefix of T p . The findChild ( node, r ) function returns the child of node that has the region equal to r and a connection edge. The U pdateInterval ( edge, i )and UpdateSupport ( n, T p .supp )pro-cedures update the label of edge ,iftheinterval i is larger than the interval of edge , and the support of n , if its support is smaller than T p .supp .

Example 1. We present an example of T-pattern Tree built on a set of T-patterns. Consider the following T-patterns: where, capital letters represent different region. Figure 2 shows the corresponding T-pattern Tree. Notice that a path may group together several T-patterns. For instance, the fol-lowing path of the T-pattern Tree: represents both the T-patterns:
In this section we show how to predict the next locations for a given moving object in space and time using the T-pattern Tree . The main idea behind our prediction is to find the best path on the tree, namely the best T-pattern that matches the given trajectory. Hence, for a given trajectory we compute the best matching score of all the admissible paths of the T-pattern Tree . The children of the best node that produces a prediction are selected as next possible lo-cations. Before computing the score of a whole path we compute a local score for each node of this path: we call it punctual score .
The punctual score pScore r indicates the goodness of a node w.r.t. a trajectory. It measures the level of reachability of a node r by a trajectory T that has already reached the parent node r  X  1. Considering the moving object that fol-lows the trajectory T , we introduce the notation of W hereNext to identify a spatio-temporal window where the moving ob-ject will be after the time interval specified in the edge towards r . For example, the Figure 3 the segment [be-gin,end] is the W hereNext r  X  1 while [nextBegin, nextEnd] identifies the W hereNext r . We then define the punctual score of r according to the spatio-temporal distance between W hereNext r  X  1 and the spatial region of the node r specified by the following three different possible cases: Case a :the W hereNext r  X  1 intersects the region of the Case b :the W hereNext r  X  1 enlarged by temporal toler-Case c :the W hereNext r  X  1 enlarged by temporal toler-
Here th t is a parameter that defines the tolerance for the time window during the process. If W hereNext r does not Algorithm 2 : Prediction( PT ,traj, th )
Input : A T-pattern Tree PT ,ATrajectory traj ,A
Output : A set of predictions { location, score } candidate = Visit( PT , traj , th ); best = findBest( candidate ); return predictions ; exist when the trajectory ends, the punctual score is not defined.
The overall score of a path is based on the value of the punctual score for each node of the path. We studied three different functions:
Definition 4 (Score functions). Given a trajectory tr ,apath P =[ p 1 , ..., p n ] and a punctual score pScore defined on each p k  X  P , we define:
Each method produces a different behavior in term of pre-diction. The avgScore is the natural measure, which tries to generalize the concept of similarity as the average distance between the trajectory and each node. The sumScore is based on the concept of depth, i.e. it gives priority to the longest path that matches the trajectory. The maxScore is optimistic: if a trajectory has a good match with a node, this has priority over the other ones.
The Prediction algorithm (Algorithm 2) uses a set of input parameters described below: time tolerance ( th t ) : represents the tolerance to enlarge space tolerance ( th s ) : represents the admissible spatial TrajectoryPattern score threshold ( th score ) : if the best prediction score is aggregation function ( th agg ) : represents the type of ag-
Given a trajectory T and a T-pattern Tree PT ,theloca-tion Prediction algorithm (Algorithm 2) computes the path score for each path of the PT relative to T , in accordance with the aggregation function selected. When there is no punctual score for a node, such a node is a candidate for the prediction with a score equal to the path score from the root to its parent node. When the tree as been completely visited, the best match is computed by selecting those can-didates with the best score, and the region associated whit the candidates is returned as the prediction. There may be several predictions with the s ame score corresponding to all the children in the last node of the path with the best score.
In this section, we define an evaluation function for esti-mating the predictive power of the collection of T-patterns before the creation of the T-pattern Tree and the quality measures of the performance of the prediction to be done a posteriori.
Unfortunately, there are three cases that make our system unable to predict as it fails against the score threshold: 1. the given trajectory is longer than every T-pattern in 2. the given trajectory is too far away in space from every 3. the given trajectory is too far away in time from every
The presence of a great quantity of these cases decreases considerably the performance of our predictor (prediction rate and accuracy). It is a direct consequence of quality of the T-pattern collection selected to build the predictor. Therefore, it is necessary to evaluate a priori the predictive power of a T-pattern set.
 To this aim, we have been inspired by the work [1], where the authors proposed an interesting methodology establish-ing a correspondence between the accuracy and the support threshold of a set of association rules to be used as predic-tive rules. In our case, the ability to make a good prediction also depends on the spatial characteristics of a set of T-patterns and not only on the support (data coverage). The patterns/rules, considered in our work, are sequences of spa-tial regions with different size and time interval. Indeed, the size of regions and their incidence over the considered space (spatial coverage) is a key point in the prediction quality. For example, if our set of T-pattern covers only a small portion of the overall space, surely there will be many tra-jectories for which no prediction will be possible as no useful model (T-pattern) exists. On the other side, if the coverage of the space is obtained with regions of big size, the pre-dicted locations are too wide and therefore not useful for any services. Our evaluation function takes into considera-tion these three aspects: the spatial coverage, the dataset coverage and the spatial separation. The spatial coverage measures the fraction of space covered by the set of T-patterns. Let space ( T p ) denote the function which returns the space covered by a single T-pattern and totalSpace denote the space covered by the area where we select the dataset of trajectories. A high value of this func-tion means the possibility to predict almost all the locations in space, while with a low value only a small portions of the space can be predicted. The data coverage measures the support, namely the frac-tion of trajectories covered by the set of T-patterns. Let T be the set of trajectories used to extract the T-pattern set T p Set and T T p Set be the trajectories that support at least one T-pattern in the set. Intuitively, this function computes the coverage of the local model on the training dataset. This function considers both the two aspects of
Figure 5: The process flow of our experiments the problem, i.e., it counts not only how many trajectories match the spatial constraints of the model but also the time constraints represented by the intervals between the regions of T p .
 The region separation measures the fraction of regions crossed by the analyzed T-patterns. Let MinimalRegion be the minimal spatial granularity in the considered space. The re-gion separation represents two important aspects: the pre-cision during the prediction (smaller regions lead to a more specialized local patterns) and the granularity of our predic-tion (larger regions lead to less accurate predictions). Rate = spatialCoverage  X  dataCoverage  X  regionSeparation The overall evaluation is the combination of all these mea-sures. All measures and the overall pattern quality have values within 0 and 1. The behavior of these measures have been strongly experimented over the dataset described in Section 6. Here we anticipate few results of that section just to highlight different behaviors. In Fig.4(a) the three functions are shown with their values increased by 10000. In particular, we note that the spatial coverage decreases with high value of support, because some regions become not dense enough to survive. Data coverage has a similar behavior, although in some cases it increments with a lower value of support. Instead region separation increases with low value of support because the regions become isolated and then Trajectory Pattern mining algorithm can not ag-gregate them. The Rate function shows some local optima that represents good configurations of Trajectory Pattern mining algorithm to obtain a set of T-patterns useful for prediction.
 To validate this evaluation functions, we tested the algo-rithm using two different configurations of Trajectory Pat-tern algorithm corresponding to the two peaks of Fig.4(a); the results obtained are in Fig.4(b) where the Model1 is ob-tained using support 1.85 and Model2 using the value 2.0.
In order to asses the quality of the prediction of our algo-rithm we use three performance measures: Prediction rate : the number of predicted trajectories over Accuracy : the rate of the correctly predicted locations Average Error : the average spatial distance between the
In order to appreciate the quality of the results we also define a spatial tolerance that is used as an acceptable dis-tance between the predicted location and the real position of the trajectory. The spatial tolerance is expressed in units, where a unit is the minimum granularity in the considered space. For our experiments, we used a dataset provided by the GeoPKDD project[4], a set of trajectories of cars equipped with a GPS receiver moving in the city of Milan over a week. In Figure 5 we show the process flow of the experiments. First, we performed a selection in time and space, taking only the trajectories on Wednesday and Thursday in the city center between 7 am and 10 am. On the basis of this subset, we used all the Wednesday data (4000 trajectories) as a training set, and a part of the Thursday data as a test set (a sampling of 500 trajectories). We used two differ-ent days of the week for training and testing to evaluate our algorithm in the same time period but with some dif-ferent local behaviors. After the data preparation from the training set, we extracted different sets of T-patterns us-ing the Trajectory Pattern algorithm [11] and changing the support value, the temporal threshold and the resolution. By evaluating the discriminative power of these sets, we selected the local optimum corresponding to the following configuration: a temporal threshold equal to 200 seconds, a resolution of the regions of 100 meters and a support thresh-old of 1.85%. This configuration extracted 7039 T-patterns, which we used to build the T-pattern Tree used in our ex-periments. The results of the first set of experiments are shown in Figure 6. These summarize the accuracy of the model w.r.t. the prediction rate. Note how the prediction accuracy changes while the number of predicted trajectories grows without any particular thresholds settings, thus sum-marizing the general trend of the model. The three groups of curves represent the three values of tolerance used: 0, 2, 4. The three curves of each group represent the use of a dif-ferent aggregation function. The best result is obtained with the tolerance threshold set from 0 to 4 and using the sum as an aggregation function. This result justifies the quality of our approach showing the desirable behavior for a pre-dictor, i.e., if we want to predict more cases we clearly lose accuracy. We obtain very good results in terms of accuracy when the algorithm predicts 45.7% trajectories; up to this value we predict with an accuracy greater than 40% without any tolerance, if we consider some tolerance the results are greater than 54%. This is a suitable trend for the model, for instance, in a streaming context: a traffic analyst might be more interested in getting a higher accuracy rather than predicting each individual trajectory.
 We performed another set of experiments in order to under-stand how the introduced thre sholds work with respect to the quality of the results, i.e. accuracy, and the number of predicted trajectories, i.e. Prediction Rate. Figure 8 (a,b) shows the impact of the different set up of the spatial thresh-old th space w.r.t. the prediction rate and the prediction ac-curacy. In Figure 8 (a) the prediction rate increases when we adopt a greater spatial threshold. In Figure 8 (b) accuracy descreases when setting a higher value of the th space .Both represent an understandable behavior of the model. The en-largement of the spatial threshold allows the punctual score computation in more situations. This means that we can predict more trajectories but, at same time, we introduce noise into the prediction results. A similar trend is shown in Figure 7(a,b), in fact the th score has the same influence on the algorithm, i.e. a low value of this threshold entails selecting cases when the spatio-temporal distance between the trajectory segment and a region is high. Therefore, by increasing this threshold we are able to predict a greater number of trajectories but with less accuracy. Moreover, the average error is the target of a further analysis  X  see Figure 8(d), which shows the increase in the average error with a larger amount of predicted trajectories. This behaves in accordance with the accuracy trend.

In general, the prediction rate is never below 20%. This is probably due to the dataset coverage of the set of T-patterns used with respect to the test set adopted, i.e. at least 20% of the trajectories in the test set are completely covered by the set of T-patterns that we selected.
 The various values of the thresholds influence the quality of the overall results; however they are very useful for allowing end-users to drive the analysis. Indeed, a traffic analyst may be interested in testing different results and playing with the thresholds in order to obtain the desired level of accuracy, average error and prediction rate. Tollerance has a high im-pact on the results: the most accurate results are obtained with higher values of the tolerance.
 Throughout this paper, we have stated that we use the be-havior of a population to predict the next location of a mo-bile object. To justify this hypothesis, we tested our predic-tion algorithm in a different context. In fact, we built the model taking into account only the history of a user and we predicted his/her next location. We divided the user X  X  his-tory into a training set (90%) and test set (10%) and then we applied the same process described in Figure 5. The result in Figure 8(d) shows that, in this context, the quality of the result is not high, thus reinforcing our theory. In fact, the Trajectory Pattern algorithm cannot detect many frequent user behaviors that only have a few trajectories. Moreover, the unavailability of direct competitors in either of the two contexts [12, 13] means that we cannot compare the how our approach performs against other methods.
We have introduced a new technique to predict the next location of a moving object. Our definition of a future loca-tion prediction for a moving object is based on the previous movements of all moving objects in a certain area without considering any information about the user.
 Previously proposed methods use temporal information only to order events, while we used T-patterns which are intrinsi-cally equipped with temporal information. Furthermore, we have defined an evaluation function for a T-pattern set in order to allow us to choose the best one for the construction of a good T-pattern Tree .
 Our experiments demonstrated that our technique gives rea-sonably accurate prediction and allows end users to tune the algorithm using a set of thresholds.
 Further research will investigate the possibility of using this approach in real-time contexts, where next location predic-tion is useful. In fact, in real-time services knowing in ad-vance the most likely position of an object may improve the quality of service, e.g. by pre-fetching queries or other resources. Another possible deployment would be in intel-ligent transportation systems, where the joint location pre-diction of many vehicles may trigger the dynamic readjust-ment of road network controllers or alert systems. A very Figure 8: (a,b,c) Accuracy and Prediction rate w.r.t th score andaverageerrorstudy . (d) Accuracy and Prediction rate in users context critical point of our approach is the fact that the defined score functions give priority to frequency as an attractor of movements. However this can be risky since if there is a T-pattern with a high frequency it will dominate the other ones. Using some context dependent score function might mitigate this risk, and this would be very interesting aspect of a broader real case study. [1] H.Cheng,X.Yan,J.Han,andC.-W.Hsu.
 [2] F. Giannotti, M. Nanni, and D. Pedreschi. Efficient [3] F. Giannotti, M. Nanni, F. Pinelli, and D. Pedreschi. [4] F. Giannotti, D. Pedreschi, and et al. Geopkdd: [5] H. Jeung, Q. Liu, H. T. Shen, and X. Zhou. A hybrid [6] K. Kianmehr and R. Alhajj. Effective classification by [7] B.Liu,W.Hsu,andY.Ma.Integratingclassification [8] M. Morzy. Prediction of moving object location based [9] M. Morzy. Mining frequent trajectories of moving [10] M.Nanni,B.Kuijpers,C.Korner,M.May,and [11] R. Ortale, E. Ritacco, N. Pelekis, R. Trasarti, [12] B. Xu and O. Wolfson. Time-series prediction with [13] G. Yavas, D. Katsaros,  X  O. Ulusoy, and
