 To address secur i t y pr o b l ems in se n s o r n et wo rks , ma ny mecha ni sms ha v ebee n pr o p o sed t o defe n d aga in st v ar io us k in ds o f attacks in se n s o r n et wo rks .How e v er , ap o te n t i a lly m o re se v ere attack has no t y et dra wn t oo much atte n t ion, w h i ch i sca ll ed sensor worm attack [1]. Mo re spec i fica lly, se n s o r wo rms are defi n ed as crafted messages that e x p loi ts o ft w are v u ln erab ili t yo fse n s o r no des in ase n s o r n et wo rk , caus in gse n s o r no des t o crash o rtak in gc on tr ol o fthem .

Sin ce the H ar v ard arch i tecture has separated mem o r i es f o rpr o gram a n ddata [ 2 ], inj ected ma l-c o des that are c o mm only f o u n d in wo rm packets are hard t o be e x ecuted in se n s o r no des .How e v er , a n e x per i me n t on Mi ca2 m o tes has bee n c on ducted a n dabu ff er ov er flow v u ln erab ili t y has bee n f o u n d in the wo rk o f [1]. T he v u ln erab ili t y c o u l dresu l t in the tra n sfer o fpr o gram flow t o atra n sm i ss ion c o mp on e n t in the c o de space .T heref o re , th i s l eads t o the pr o pagat ion o fthe wo rm packet ov er the e n t i re n et wo rk .In add i t ion, i t i se v e n eas i er f o rse n s o r no des t o be c o mpr o m i sed b ywo rm attacks c o mpared wi th regu l ar c o mputer s y stems , because se n s o r no des in the same n et wo rk are m o st ly us in gh o m o ge -n e o us de vi ces a n ds o ft w are , a n da n attacker ca n capture on ese n s o r no de a n d read app li cat ion c o des o ut fr o ma JTA G in terface (w h i ch ca n be f o u n d in m o st embedded s y stems ). A saresu l t ,i f on ese n s o rca n be c o mpr o m i sed due t o a v u ln erab ili t y, a ll o ther se n s o rs that use the same de vi ces a n dc o des in the same n et wo rk ca n be c o mpr o m i sed due t o the same v u ln erab ili t y. T heref o re , se n s o r wo rm i saser io us threat .

T he m o st i mp o rta n tre l ated wo rk w ek now t o defe n d aga in st se n s o r wo rm attack i sthes o ft w are d iv ers i t y-based se n s o r wo rm i mmu ni t y appr o ach [1]. I t des i g n ed a n backtrack in gc olo ra l g o r i thm t o ass i g n the appr o pr i ate s o ft w are v ers ion t o se n s o r no des , a n de x am in ed the i mpact o fse n s o r no de dep loy me n t err o rs on wo rm pr o pagat ion. How e v er , the t i me c o mp l e xi t yo fthea l g o r i thm i s O ( sN 2 ), s i sthe n umber o fs o ft w are v ers ion sa n d N i sthet o ta ln umber o fce ll s in the dep loy me n tarea .H ere , ce ll de no tes a set o f no des ass i g n ed wi th the same s o ft w are v ers ion. How e v er , N ca n be a l arge n umber s in ce the n umber o fse n s o r no des in on ece ll sh o u l dbekeptsma ll er b y se l ect in ga l arger n umber o f N . Mo re ov er , the ce ll s i ze L sh o u l dbech o se n carefu lly, s in ce the ma xi mum n umber o f no de c o mpr o m i sed that c o u l dhappe n at on et i me v ar i es as a fu n ct ion o f L . T h i s i s no teas y t o be app li ed in s o me se n s o r n et wo rks , e . g ., se n s o r n et wo rks dep loy ed in cr i t i ca lo rh o st il eareas .

To address the pr o b l ems in se n s o r wo rm defe n se , th i spapera i ms t o a n s w er the f ollowin gce n tra l quest ion:
Is it possible to propose an provable and effective sensor worm defense scheme, which is easy to be applied in sensor networks?
To a n s w er th i squest ion, w ee n c o mpass t wo ke y tech ni ques , random sensor node scheduling [3] a n d software diversity [1], t o pr o p o se a nov e lS e n s o r W ORm D efe n se S cheme ,n ame ly SW OR DS. O non eha n d ,w e l e v erage ra n d o mse n s o r no de schedu lin gt o ach i e v e low er act iv e no de de n s i t y u n der guara n teed c onn ec -t ivi t y, w h i ch c o u l d i mpr ov edefe n s iv e capab ili t y aga in st se n s o r wo rm attacks ;on o f SW OR DS thr o ugh a sma ll e x amp l e : adep loy ed se n s o r no de ma y ha v ete no r t w e n t yn e i ghb o r in g no des , but only t wo o rthree o fthemare wo rk in gatthe same t i me due t o ra n d o mse n s o rschedu lin g .I f w ech oo se three o rf o ur s o ft w are v ers ion s in o ur scheme , the n umber o f n e i ghb o r in g no des ass i g n ed wi th the same s o ft w are v ers ion c o u l dbe li m i ted b low on e ,w h i ch mea n s that the pr o bab ili t yo f se n s o r wo rm pr o pagat ion thr o ugh n e i ghb o r in g no des i squ i te sma ll. W e will g iv e the deta il s o fpr oo f in S ect ion III.

To the best o f o ur k nowl edge , th i spaper i s the first research wo rk that in tr o-duces the no de schedu lin g in t o se n s o r wo rm defe n se scheme .SW OR DS has the f ollowin gsa li e n tfeatures :  X  SW OR DS ca n defe n d aga in st se n s o r wo rm e ff ect iv e ly a n dca n be app li ed in  X  SW OR DS makes the se n s o r n et wo rk m o re e n erg y effic i e n t due t oin tr o duc in g  X  SW OR DS i st o ta lly d i str i buted , a n dd o es no t n eed accurate lo cat ion in f o r - X  SW OR DS pr ovi des guara n tee that a ll the act iv ese n s o r no des are c onn ected , T he rest o fth i spaper i s o rga ni zed as f ollow s .W eprese n tthere l ated wo rk in S ect ion II. S ect ion III descr i bes the deta il s o f SW OR DS, a n dpr ovi des a n a ly s i st o ill ustrate SW OR DS X  seffic i e n c y c l ear ly. T he n, the s i mu l at ion meth o d olo g y a n d e v a l uat ion resu l ts are d i scussed in S ect ion IV. Fin a lly, w eprese n tc on c l us ion in S ect ion V. 2.1 Worm Defense In [ 4 ], no de c o mpr o m i se spread in wi re l ess se n s o r n et wo rks i sm o de l ed ut ili z -in gep i dem i cthe o r y, a n dke y fact o rs determ inin gp o te n t i a lo utbreaks are a l s o i de n t i fied .In[ 2 ], ara n ge o f attack appr o aches are pr o p o sed t o ill ustrate that a ma l-packet ,w h i ch only carr i es spec i a lly crafted data , ca n e x p loi tmem o r y-re l ated v u ln erab ili t i es .An dthema l-packet ut ili zes e xi st in gapp li cat ion c o des in ase n-the secur i t yo fse n s o r no des , amem o r y pr o tect ion s y stem that pre v e n ts ma ny f o rms o fmem o r y c o rrupt ion i spr o p o sed in [5]. An d in [6], c o de o bfuscat ion a n d ra n d o m i zat ion are c o mb in ed t o pr o tect the secret ke y s o fse n s o r no des .S pec i fi -ca lly, as y stemat i c w a y t o e n ha n ce se n s o r n et wo rk i mmu ni t y u n der wo rm attack i spr o p o sed in [1] rece n t ly, w h i ch e x p lo res the tech ni que o fs o ft w are d iv ers i t y t o c o mbat se n s o r wo rms a n de x am in es the i mpact o fse n s o r no de dep loy me n t err o rs on wo rm pr o pagat ion. How e v er , the no de dep loy me n tmeth o d i smuch c o mp l e x a n dthece ll s i ze sh o u l dbech o se n carefu lly, these sh o rtc o m in gs make i ts app li cat ion in se n s o r n et wo rks no tqu i te rea li st i c . 2.2 Sensor Node Scheduling S e n s o r no de schedu lin g i satrad i t ion a l research area f o re n erg y effic i e n c yo fse n-s o r n et wo rks .SPANi spr o p o sed in [ 7 ], w h i ch i sap ow er sa vin gtech ni que f o r mu l t i-h o padh o c wi re l ess n et wo rks that reduces e n erg y c on sumpt ion wi th o ut s i g ni fica n t ly d i m ini sh in g the capac i t yo rc onn ect ivi t yo fthe n et wo rk .AS CE NT [ 8 ] ch oo ses s o me se n s o r no des t o be act iv easr o uters w h il ea llow s o thers t o s l eep t o sa v ee n erg y, i tse l ects a n act iv er o uter depe n d in g on lo ca l c onn ect ivi t y a n d the o bser v ed data lo ss rates .ST E M[9] puts se n s o r no des in t o s l eep state m o re aggress iv e ly. S e n s o r no des w ake up only w he n the y ha v edatat o tra n sfer o rthe y rece iv erequestsfr o mthe i r n e i ghb o rs .T heref o re ,ST E M trades l ate n c y f o rfur -ther e n erg y sa vin g .In[10],i t i spr ov ed that t o e n sure that a fu ll c ov erage o fa c onv e x area a l s o guara n tees the c onn ect ivi t yo ftheact iv e no des in s i de the area , the c o mmu ni cat ion ra n ge sh o u l dbeat l east t wi ce o fthese n s in gra n ge .An d in [11], the auth o rs e n ha n ce the wo rk in [10] b y re l eas in gthec on stra in t .S pec i fi -ca lly, the appr o ach in [3] ut ili zes a nin tegrated meth o dthatpr ovi des stat i st i ca l se n s in gc ov erage a n dguara n teed n et wo rk c onn ect ivi t y. T he meth o d i st o ta lly d i str i buted , a n d i sab l et o d yn am i ca lly ad j ust se n s in gc ov erage wi th guara n teed n et wo rk c onn ect ivi t y.
 2.3 Software Diversity ta n ts o urce o fr o bust n ess in c o mputer s y stem .S e v era l meth o ds o fach i e vin gs o ft -w are d iv ers i t y based on ra n d o m i zat ion are d i scussed in [1 2 ], such ra n d o m i zat ion c o u l dp o te n t i a lly in crease the r o bust n ess o fs o ft w are s y stems wi th m ini ma li m -pact on c onv e ni e n ce , usab ili t y a n deffic i e n c y. T he research wo rk in [13] assumes the a v a il ab ili t yo fd iv erse s o ft w are package f o reachs y stem a n dthe n seeks t o puter n et wo rk .Av ar i et yo ftech ni ques ha v ebee n pr o p o sed in [1 4 ] t o e n ha n ce the in trus ion res i sta n ce o fc o mputer s y stems b yin creas in gs o ft w are d iv ers i t y. T he research wo rk in [15] descr i bes the da n ger p o sed b yP 2 Pwo rms a n d ini t i ates the stud yo fp o ss i b l em i t i gat ion mecha ni sms .Mo re ov er ,i tsuggeststhatd iv ers i t yi s a n e ff ect iv e deterre n ce t oP 2 Pwo rms . 3.1 Notations and Scheme A s descr i bed in [16], w ec on s i der stat ion ar y se n s o r n et wo rks in at wo-d i me n s ion a l fie l d .B ef o re dep loy me n t , each se n s o r no de i sra n d o m ly ass i g n ed only on es o ft -w are v ers ion fr o m v s o ft w are v ers ion s .W e assume that se n s o r no des are ra n d o m ly a n d in depe n de n t ly dep loy ed in afie l d , a n dthatase n s o r no de  X  srad io tra n sm i s -s ion ra n ge i sfi x ed .B ut w ed ono t assume accurate g lo ba l t i me s yn chr oni zat ion, w h i ch i sa n e x treme ly hard task f o r l arge -sca l ese n s o r n et wo rks .

Fo r ease refere n ce , a ll no tat ion sused in SW OR DS are li sted in T ab l e 1. In o ur scheme , t i me i sd ivi ded in t o s lo ts , a n d in each t i me s lo t , k  X  n no des are ra n d o m ly se l ected t owo rk ,w h il ethe o ther no des will be tur n ed off. W he n the n et wo rk i ssuffic i e n t ly de n se ,wo rk in g no des will be c onn ected wi th a h i gh pr o ba -b ili t y. T h i sra n d o mschedu lin gmeth o d w as st i mu l ated b y the wo rk in [3]. T here i satrade -off here : a l arger v a l ue o f k guara n tees h i gher c onn ect ivi t y pr o bab ili t y; h ow e v er , a l arger v a l ue o f k resu l ts in m o re n e i ghb o r in g no des f o r wo rm pr o pa -gat ion. A saresu l t ,w esh o u l dse l ect a pr o per v a l ue o f k f o rb o th se n s o r wo rm defe n se a n dguara n teed c onn ect ivi t yin te n s i t y. T hus ,w e n eed t o c l ear ly defi n e the connectivity intensity .
 Definition 1. Connectivity Intensity for a Specific Node: c . For a given node in the deployment field, we define c as the probability that at least one active sensor node locates in the given node X  X  communication area.
 I t i s o b vio us that c depe n ds on b o th the n umber o fse n s o r no des dep loy ed in the n e i ghb o rh oo da n d o ur schedu lin gscheme .W e assume that there are i no des lo cated in ag iv e nno de  X  sc o mmu ni cat ion area , the n the pr o bab ili t y that these i no des are a ll s l eep in g i s (1  X  k ) i .T heref o re , the pr o bab ili t y that at l east on e n e i ghb o r in g no de i s wo rk in g i s 1  X  (1  X  k ) i .So,w epr ov ethat c =1  X  (1  X  k ) i .
D ue t o the ra n d o m n ess in the se n s o rdep loy me n tstrateg y a n d o ur schedu lin g scheme , c i sara n d o m v ar i ab l e .No tab ly, the e x pectat ion o f c f o ra ny no de in s i de the fie l d i sequa l, s in ce no des are in depe n de n t ly a n du ni f o rm ly d i str i buted a n d schedu l ed (Fo rs i mp li c i t y, w e i g no re the edge e ff ect f o r l arge dep loy me n tarea ). T heref o re , the e x pectat ion o f c i sa n et wo rk -wi de c on s i ste n tmetr i ca n dc o u l dbe used t o e v a l uate the c onn ect ivi t y qua li t yo fthe w h ol e n et wo rk .
 Definition 2. Network Connectivity Intensity: C . We define C as the expecta-tion of c . That is C = E [ c ] .
 C c o u l dbeca l cu l ated as Sin ce se n s o r no des sh o u l d no t be separated fr o mthe n et wo rk after app lyin g schedu lin gscheme , the i dea lv a l ue o f C i s 1, w h i ch in d i cates that e v er yno de in the fie l d has at l east on e n e i ghb o r in g no de .How e v er , ach i e vin gth i s i dea lv a l ue ma y requ i re v er y de n se dep loy me n ta n d i se x treme ly e x pe n s iv e .B ecause d iff ere n t app li cat ion sha v ed iff ere n trequ i reme n ts on acceptab l ec onn ect ivi t yin te n s i t y, a g oo dschedu lin gschemesh o u l dse l ect a pr o per v a l ue o f k .Fo rag iv e n n , the low er b o u n d on the v a l ue o f k t o pr ovi de a n et wo rk c onn ect ivi t yin te n s i t yv a l ue o f C i s Fo re x amp l e ,w eset C =0 . 9, n = 2 000, q =  X  400 ,w eca n get k =0 . 1 4 66 wi th Equat ion 1. F r o mth i se x amp l e ,w ec o u l dseethat o ur ra n d o mschedu lin g scheme ca n ach i e v eareas on ab ly h i gh c onn ect ivi t y requ i reme n tb y se l ect in ga pr o per v a l ue o f k . 3.2 Analysis on Sensor Worm Defense Capability So far w eha v ebee n f o cus in g on ra n d o ms o ft w are ass i g n me n ta n dra n d o mschedu l-in gscheme ;w eha v e no t y et d i scussed w hether SW OR DS ca n e ff ect iv e ly i mpr ov e the se n s o r n et wo rk defe n s iv e capab ili t y. To pr ov e i t ,w efirsta n a ly ze the n umber o f n e i ghb o r in g no des due t oi ts i mp o rta n ce in se n s o r wo rm pr o pagat ion. Theorem 1. Without SWORDS, the expectation of number of neighboring nodes l = nq .
 Proof. I fase n s o r no de i sdep loy ed in s i de a spec i fic no de  X  sc o mmu ni cat ion area , th i s no de i sthespec i fic no de  X  s n e i ghb o r in g no de .D ue t o the ra n d o m n ess in no de dep loy me n t , the n umber o f n e i ghb o r in g no des i sara n d o m n umber .T heref o re , i ts e x pectat ion, l , c o u l dbeca l cu l ated as A fter app lyin gra n d o mschedu lin gscheme wi th guara n teed c onn ect ivi t y, the n umber o f n e i ghb o r in g no des ca n be reduced .In add i t ion, w ee x p lo re s o ft w are d iv ers i t y t o c o mbat se n s o r wo rms , s in ce d iff ere n t v ers ion s o fthesamefu n ct ion-a li t y will no tha v ethesame v u ln erab ili t y f o r the attacker t o e x p loi t .A saresu l t , the n umber o f n e i ghb o r in g no des ,w h i ch c o u l dbe in fected ,i sfurther li m i ted . Theorem 2. After applying SWORDS, the expectation of the number of neigh-boring nodes that could be infected m = n (1  X  n Proof. B ased on Equat ion 1 a n d T he o rem 1, m c o u l dbeca l cu l ated as Fo re x amp l e ,w eset C =0 . 9, n = 2 000, v = 4 ,w eca n get m =0 . 5 7 53. F r o m th i se x amp l e ,w ec o u l d see that the n umber o f n e i ghb o r in g no des ,w h i ch c o u l d be in fected ,i squ i te sma ll ( usua lly sma ll er tha non e ) after app lyin g SW OR DS. To e v a l uate the e ff ect iv e n ess o fse n s o r wo rm defe n se scheme ,w eca n a n a ly ze the number of sensor nodes that can be compromised at one time by the worm attack as descr i bed in [1].
 Theorem 3. The maximum number of node compromises that could happen at Proof. Sin ce the v a l ue o f m i susua lly sma ll er tha non e , f o rs i mp li c i t y, w etake m as the pr o bab ili t y that a spec i fic in fected no de c o u l dfi n da n e i ghb o r in g no de , w h i ch i sass i g n ed wi th the same s o ft w are v ers ion. A ssh owninFi gure 1, a nin-fected no de (no de 0) has a pr o bab ili t yo f m t o fi n da n e i ghb o r in g no de (no de 1) f o r wo rm pr o pagat ion; a n d no de 1 a l s o has a pr o bab ili t yo f m t o fi n da n-o ther n e i ghb o r in g no de (no de 2 ) f o r wo rm pr o pagat ion, a n ds oon.H e n ce , the pr o bab ili t yo fc o mpr o m i s in g on e no de at on et i me i s m ; a n d the pr o bab ili t yo f c o mpr o m i s in gt wo no des at on et i me i s m 2 , a n ds oon.Noww eca l cu l ate s as So W eca n get Fin a lly, w eca l cu l ate Fo re x amp l e ,w eset C =0 . 9, n = 2 000, v = 4 ,w eca n get s =3 . 1 8 96. T hat mea n s in ase n s o r n et wo rk wi th the requ i red c onn ect ivi t yin te n s i t yv a l ue o f 0.9, c on ta inin g2 000 no des a n dass i g n ed wi th 4 s o ft w are v ers ion s ,only ab o ut three no des c o u l dbec o mpr o m i sed a v erage ly in on ese n s o r wo rm attack after app lyin g SW OR DS. 3.3 Practical Issue A fter app lyin g SW OR DS, se n s o r no des ha v e the pr o bab ili t yo f k t o be wo rk in g in each t i me s lo t , a n dthese wo rk in g no des c on s i st o fa subnetwork .To guara n tee a ll the se n s o r no des in the sub n et wo rk are c onn ected wi th each o ther ,w eb o rr ow the i dea o f extra-on rule fr o m the stud yin[3].I t i s assumed that the o r i g in a l n et wo rk bef o re app lyin g SW OR DS i sc onn ected a n deachse n s o r no de k now s i ts m ini ma l h o pc o u n tt o the s in k no de .A se n s o r no de A i sca ll ed the upstream no de o fa no ther se n s o r no de B ,i f no de A a n d no de B are n e i ghb o r in g no des a n d the m ini ma l h o pc o u n t o f no de A t o the s in k no de i s on e l ess tha n that o f no de B .No de B i sa l s o ca ll ed no de A  X  sd own stream no de .

Extra-on Rule :In aspec i fic t i me s lo t ,i fase n s o r no de A has a d own stream no de B , a n d non e o f no de B  X  s upstream no des i sact iv e , the nno de A sh o u l d a l s owo rk .Ino ther wo rds , bes i des wo rk in g in the dut y t i me s lo ts ( ra n d o m ly schedu l ed t i me s lo ts ), no de A i srequ i red t owo rk in e x tra t i me s lo ts ( schedu l ed t i me s lo ts due t o guara n teed c onn ect ivi t y).

In [3], i t i spr ov ed that app lyin gthee x tra -on ru l et o each sub n et wo rk c o u l d e n sure i ts c onn ect ivi t y. An dthe n umber o fe x tra no des n eeded t o tur non f o r c onn ect ivi t y ma in te n a n ce i s v er y sma ll, c o mpared t o the t o ta ln umber o fact iv e no des . In th i s sect ion, w e will v a li date o ur a n a ly t i ca l m o de l a n dsh ow the perf o rma n ce o f o ur scheme u n der d iff ere n t parameter sett in gs . 4.1 Simulation Setup In the s i mu l at ion, the se n s o r no des are ra n d o m ly dep loy ed ov er the dep loy me n t area o f 100 m  X  100 m .T he t o ta ln umber o fse n s o r no des in the e n t i re n et wo rk v ar i es fr o m2 000 t o 10000. T he tra n sm i ss ion ra n ge i s 10 m , a n dthe n umber o f fr o m 0. 8 5 t o 0.95. No te that each p oin t in the f ollowin gfigures i sa v eraged ov er 100 r o u n ds , each o f w h i ch c on ta in s2 000 se n s o r wo rm attacks . 4.2 Simulation Results W estud y the ma xi mum n umber o f no de c o mpr o m i ses ( s ) that c o u l dhappe n at on et i me .A ssh own in Fi gure 2 ,3 a n d Fi gure 4 , s cha n gesasafu n ct ion o fthe n et wo rk c onn ect ivi t yin te n s i t y( C ), the n umber o fs o ft w are v ers ion s ( v ), a n dthet o ta ln umber o fdep loy ed se n s o r no de ( n ). Un der a certa in n umber o f v a n d n ,w he n C i s l arger , the ma xi mum n umber o f no de c o mpr o m i ses s bec o mes l arger .W he n C i s l arger tha n athresh ol da n d v i sre l at iv e ly sma ll, s are in creased e . g . ab o ut 0.9 2 , s o that se n s o r wo rms ca nno tpr o pagate ov er the dep loy me n t area .Un der a certa in n umber o f C a n d n ,w he n v i s l arger , the ma xi mum n umber o f no de c o mpr o m i ses s bec o mes sma ll er .In rea li t y, th i smea n s that app lyin g m o re s o ft w are v ers ion sc o u l d i mpr ov e the defe n s iv e capab ili t y aga in st se n s o r wo rm .How e v er ,w efi n dthat s i s no tcha n ged dramat i ca lly, w he n the v a l ue o f n v ar i es fr o m2 000 t o 10000. In summar y, the ab ov eresu l ts in d i cate that o ur scheme wi th pr o per parameters ca n e ff ect iv e ly pre v e n t the pr o pagat ion o fse n s o r wo rms , a n dthes i mu l at ion resu l ts match o ur a n a ly t i ca l resu l ts w e ll. In th i spaper ,w epr o p o se SW OR DS, a n e ff ect iv ea n dpr ov ab l ese n s o r wo rm defe n se scheme , based on the i dea o fra n d o mse n s o r no de schedu lin ga n ds o ft w are d iv ers i t y. W earethefirstt oin tr o duce the no de schedu lin gmeth o d in t o se n s o r wo rm defe n se scheme .W eha v epr ov ed that SW OR DS ca n s i g ni fica n t ly in crease the i mmu ni t yo fse n s o r n et wo rks u n der wo rm attacks , a n d o ur s i mu l at ion resu l ts match the a n a ly t i ca l resu l ts w e ll.

