 Time series has been a ubiquitous data in the real-world, e.g. daily temperature, stock prices, various sensor data etc. Th ere have been a lot of research works in searching and mining time series. Similarity measurement is a frequent subrou-tine in many applications. Due to the variety of different data, it is difficult to design a direct distance function to obta in better performance. As a preprocess-ing step, representation, which transforms time series into more meaningful and usable format, is a suitable solution.

Many popular representations are based on the segmentation of time domain, e.g. Symbolic Representation, Piecewis e Linear Representation (PLR). Gener-ally, the time series is segmented into many subseries. Then the original one is represented by the resulting segmentation based on the content of each sub-series or the distribution of the values using various techniques, e.g. clustering or statistic etc. And other methods give the new representation using frequency transforms, e.g. Fourier Transforms [1], Wavelets [2]. But they are not enough to solve the similarity problem of time series, due to their ignoring on the hierarchy of each point in time serie s according to importance.

The accurate and suitable representation problem has brought challenges in the research on time series. So, it is by no means trivial to study this problem and put forward an effective solution tha t represents time series accurately and usably for similarity measurement. In this paper, we propose a novel approach, called Multi-Hierarchical Representation (MHR), to fill this gap. Our strategy is to partition the points into different hierarchies using Fast Fourier Transform (FFT). Then the time series is represent ed by the Multi-Hierarchical subseries, which consist of the points in the same hi erarchy. The distance between the new representations can be computed by the s um of distances of the subseries in dif-ferent hierarchies. We used best match s earching and clustering experiments on both synthetic and real data sets to evaluate the effectiveness of MHR comparing with other methods. And the comparison o f their efficiencies was also performed on the real data set. All the results show ed the superiority of ours in terms of effectiveness and efficiency.

The rest of the paper is organized as follows. Sect. 2 provide some background materials. Sect. 3 introduces MHR and it s similarity measurement. In Sect. 4, we give the exhaustive performance comparisons between ours and other methods. Finally, in Sect. 5 we offer some conclusion remarks. 2.1 Related Work Many representations of time series h ave been proposed in searching or min-ing applications. Symbolic representation is a popular method to transform the numerical series into symbolic sequence. The simple is to automatically cluster all the subseries in a fixed-window into some classes, and then use the sym-bols standing for the classes, to replace each subseries [3]. The method may be disabled due to the inaccuracy of the interval boundaries, e.g. a whole shape (or content) is segmented. Recently in [ 4], the Symbolic Approximation (SAX) has been proposed with an approximate distance function that lower bounds the Euclidean Distance. In [5], a new method for meaningful unsupervised sym-bolization of time series, called Persist, was proposed utilizing incorporation of temporal information. Clipped representation has attracted much interest [6, 7], and it has superior space benefits due to only saving 0 and 1. In [8], a multireso-lution symbolic representation was proposed, and Hierarchical Histogram Model was used as the distance function. It integrated the segmental results of several fixed-window. The multiresolution seems similar to MHR, but, actually, we have the essential difference that we emphasize th e corresponding hierarchical relation of the points in similarity measure, and they used the multiresolution segmental windows to solve the inaccuracy using only one fixed-window.

Dimensionality reduction is also one kind of representation, representing the time series with a multidimensional vector. In [1], the Discrete Fourier Trans-form (DFT) was utilized to perform the dimensionality reduction, and other techniques have been suggested, including Singular Value Decomposition (SVD) [9] and the Discrete Wavelet Transform (DWT) [2]. In [10], an extended repre-sentation of time series using piece-wise linear segments was proposed, as well as a weight vector that contains the relative importance of each individual linear segment, which allows fast and accurate cl assification, clustering and relevance feedback. In [11, 12], Piecewise Aggre gate Approximation (PAA) was proposed, and in [13], a more effective method Ada ptive Piecewise Constant Approxima-tion (APCA) was proposed with segments of varying lengths of each time series.
All the methods above is to find a new representation that can represent the time series accurately with simple format or high level content to obtain the preferable results in the relevant pos t-process, e.g. similarity measurement, searching, clustering etc. Most of them are based on the local information. In this paper, we focus on the accurate and s uitable representation based on the global consideration. 2.2 Preliminaries In this subsection, we start with some basic definitions. A time series X = x ,x 2 , ..., x n is a sequence of real values in which each value corresponds to a time point. x i (or X [ i ]) stands for the value at i -th sampling time. The value might be of various dimensions. | X | = n denotes the length of X .Wegivethe definitions of two kinds of subseries for our approach as follows: Definition 1. Sequential Subseries: A sequential subseries from time point s to Definition 2. Unsequential Subseries: An unsequential subseries is formalized by X ( S )where S = S (1) ,S (2) , ..., S ( m ) is the ordered subset of natural number by the formula X ( S ) i = X [ S ( i )].
 Then we introduce DFT, which transforms a time series from time domain into frequency domain. The contrary pro cess is named Inverse Discrete Fourier Transform (IDFT). Formally, the DFT of X is defined to a sequence X f = X 1 ,X 2 , ...X n consists of n complex numbers. An d FFT and Inverse Fast Fourier Transform (IFFT) are the faster algorithms with O ( nlog ( n )) time performance corresponding to DFT and IDFT with O ( n 2 ). The hierarchical strategy is adopted in our approach. Firstly, the time points in time series are partitioned into different hierarchies. In each hierarchy, an unsequential subseries defined in Definition 2 is formed by the values on the time points belong to the hierarchy. Then a time series can be represented by the unsequential subseries of all the hierarchies. Table 1 shows the main symbols used in this paper. Then we introduce our approach detailedly in the following. 3.1 Hierarchical Representation Given a time series X with length n and a hierarchy parameter h ( h&lt;n ), we use FFT to generate h waves as Fig. 1(a). Then we combined linearly the first i waves, labelled as X i with the same length as X , like the five curves in Fig. 1(b). The larger i is, the more similar X i is to the original X , which can be found from Fig. 1(b).

Then we can get the unsequential subseries of each hierarchy. In i -th (1  X  i  X  h ) hierarchy, S xi consists of the time points with extremum in X i , i.e. the black points in Fig. 1(b). The unsequential subseries can be formed according to Definition 2 as shown in Fig. 1(c). In addition, if a time point has been in the higher hierarchy, it will not be added in the lower, even if it is also the extremum point in any lower hierarchy. The first and last time points are initialized as the points in first hierarchy. Choosing the extremum points is due to their importance in the whole series. The algorithm generating each S xi is illustrated formally in Fig 2, and then MHR of X can be formed using Definition 2. 3.2 Distance Measurement In this subsection, we give the distance measurement of MHR. After hierar-chical partition of two time series, we can compute the distance between the unsequential subseries in each hierarchy using a distance function that allows time warping, e.g. DTW. And then the sum of distances of all h hierarchies is calculated as the distance of the two time series. Given two time series X and Y with lengths n x and n y respectively, the hierarchy parameter h ( h&lt;n x ,n y ), and a warping distance function D w . Formally, the MHR Distance (MHRD) can be defined as follows: MHRD(X , Y , h) = h i=1 D w (X(S xi ) , Y(S yi )). We take DTW as the distance function to analysis the time performance of MHRD. The time consumption of calculating the distance of two time series is O ( h i =1 n xi n yi ) with obvious superiority over DTW with O ( n x n y )( n xi n x and h i =1 n xi &lt;n x ). Mostly, it is more accurate with larger h , but with more time consumption. So h can be selected according t o the particular require-ment. We performed the experiment to s how the time performances of ours and others. 3.3 Additional and the Expansion In our approach, there might be the case that n xi = 0 but n yi = 0, i.e. the extremum points in i -th hierarchy of X are also with extremum in k -th hierarchy ( k&lt;i ). We use the unsequential subseries in the ( i  X  1) hierarchy of X instead of that of the i -th in this case. This is the important addition for our approach.
Our approach can be expanded in the following directions: ordering the waves, and giving a gradual segmentation approach using the time points in each hi-erarchy. We can reset the order of the w aves with decreasing amplitude of the corresponding Fourier coefficients of X f .Then X i can be got by the linear combi-nation of the first waves with the largest i Fourier coefficients. Then the following process is as same as the description above. Using the extremum points in each hierarchy, we can segment the time ser ies gradually. Then it can be used in many methods,whicharebasedonsegmentationoftimeseries. In this section, we used best match searc hing and clustering experiments to test the accuracies of ours and o thers on both synthetic an d real data sets. In the experiments, DTW was selected as the warping distance function D w in our approach (MHRD), because it is widely used in many applications. The com-petitors included Euclidean Distance and DTW. Finally, we give the efficiency comparison in Sect. 4.4. 4.1 Datasets The synthetic data set is Synthetic Control Chart Time Series (SYNDATA) data set which was downloaded from the UCI KDD archive 1 . It contains 600 examples of synthetic control charts belong to 6 different classes, and each class consists of 100 time series. The length of each time series is equal to 60.

The real data set is the Standard and Poor 500 index (S&amp;P) historical stock data from Mar. 27, 2004 to Mar 26, 2005 2 . We chose the opening price as our experimental data. Each stock data is a series of length d ,where d  X  252 ( d might be smaller if the company is removed from the Index). We only used the stocks whose length is 252. Based on the official S&amp;P clustering information, we divided the stock data into the classes. Finally, 50 classes contain 442 stock data were used by removing the classes which contain only one stock. 4.2 Best Match Searching Evaluation method. Best match searching is the process to find the time series whose distance with the given one is below a predefined threshold, or the most similar k matches in database. Because the threshold is difficult to set for different measurements with different value ranges, we used KNN searching for the experiment. The accuracy evaluati on is following, which was also adopted in [8]: The standard (right) searching result of a query Q , labelled as std( Q ), is the set of time series which belong to the same class as Q , which can be got by the apriori classification information, and the results by different methods are marked knn( Q ). The accuracy (precision) related to Q is defined as follows:
In our experiment, we set the number of time series belong to the same class as the query as the value of k . In the experiment, each time series is treated as a query. The average of the accuracies is calculated as the final result. Experiment on SYNDATA. We show the matching accuracies of the meth-ods on SYNDATA in Fig. 3. In the experiment, we also realized the piecewise normalization in Euclidean Distance, which can get better clustering results than plain Euclidean Distance on stock data proofed in [14]. When window is set to 60 (252) in Fig. 3 (Fig. 4), it is the plain Euclidean Distance. The results of ours with different h are given, as well as that of Euclidean distance and DTW. From the results, we can get that DTW obtains a much better result. And the results of Euclidean Distance are the worst, so we can conclude that the data are not sensitive to time warping. Our results are approximative to that of DTW, but more efficient. When h in ours is set as 17, we can get the best result of all. Experiment on S&amp;P. Fig. 4 show the matching accuracies of the methods on S&amp;P data. The results display that ours is the best of all, though ours is inferior to the Euclidean Distance only in a few cases, e.g. h = 5 or 7. The result of DTW is the worst, so we can conclude that the stock data is sensitive to time warping. The results also demonstrated that Euclidean Distance with the piecewise normalization is an a ccepted method on stock data. 4.3 Clustering Experiment Evaluation method. We used Hierarchical Agglomerative Clustering (HAC) to realize the clustering experiment. The clustering result can be taken with the predefined clustering number. We used the complete distance to compute the distance between two classes. We co mputed the clustering accuracy using the method, which is adopted in many applications [8, 14]. Given the standard clustering result C = C 1 ,C 2 , ..., C k from the apriori classification information and the clustering result using each method C = C 1 ,C 2 , ..., C k , compute the accuracy by the following formulas: sim( C ,C ) above can be calculated similarly as sim( C, C ) in Eq 3. We computed both sim( C ,C )andsim( C, C ), because they are not symmetric. The clustering numbersusedinHACweresetto6and50onSYNDATAandS&amp;Pdataset respectively as same as their class numbers.
 Experiment on SYNDATA. The clustering results on SYNDATA are given in the Fig. 5. From the figure, we can observe that the best result is also obtained by ours as best match searching experiment, when h = 17. The results of Euclidean Distance are also the worst, and DTW can get much better results. Our approach can be seen a  X  X nsequential piecewise X  DTW algorithm, and it have better accuracy and efficiency than DTW.
 Experiment on S&amp;P. The experimental results on S&amp;P are listed in Fig. 6. From the figure, we can find that Euclidea n Distance with piecewise normaliza-tion is superior to DTW. It is the further proof to confirm that the stock data is sensitive to time warping. But ours with time warping, when h = 17, is the best due to its hierarchical strategy. And the results of ours with other parameters also gain the advantages over other methods.
 4.4 Time Performance Comparison Experiment In this subsection, we tested time performances of the methods using 1-NN queries with sequential scan in the S&amp;P data set. The time consumption of each method was the time in 442 times queries corresponds to each time series, and we assume that each time series had been preprocessed for each method. The experiment were conducted on the machine with CPU of Celeron 1.70Ghz and 512 MB of physical memory, running Microsoft Windows Server 2003. We only counted the time consumption of distance calculation for exact comparison except accessing the disk. In Fig. 7, we give the experimental results, which show that DTW is much shower than others. The time of MHRD increases linearly along with h . Though Euclidean Distance is faster than ours, considering the accuracy and efficiency, our approach is superior to it. In this paper, we introduce a new representation of time series that can be used in similarity measurement with better e ffectiveness and efficiency, named Multi-Hierarchical Representation (MHR). Our idea is based on the opinion that the points of one time series should be compared with the ones of another with the same importance in similarity measurement. The unsequential subseries is defined in time series different from the general sequential subseries. In our approach, firstly, we partition the time points into different hierarchies. Then time series is represented by the Multi-Hierarchical subseries consisting of points in each hierarchy. The sum of distances be tween subseries in all hierarchy can be taken as the measuring result using a distance function that allows time warping. We used best matching searching and clustering experiments on both SYN-DATA and S&amp;P to evaluate the effectiveness of our approach comparing with other methods. The results showed the superiority of ours on accuracy over oth-ers. There are some cases t hat the effectiveness of our s is little inferior to the others. But in most cases, MHR is a more a ccurate representation for measuring the similarity of time series. And we also tested the time performances of ours and other competitors. The results demo nstrated that ours is slower than Eu-clidean Distance but much faster than DTW. In the future, we will continue to research the extensive problems. And in our approach, the weight of the distance in each hierarchy is same. We will also study further in this aspect. The work was supported by the NSFC 60403021 and the 973 Program 2004CB-719400. We thank the anonymous reviewers for their helpful comments.
 Time series has been a ubiquitous data in the real-world, e.g. daily temperature, stock prices, various sensor data etc. Th ere have been a lot of research works in searching and mining time series. Similarity measurement is a frequent subrou-tine in many applications. Due to the variety of different data, it is difficult to design a direct distance function to obta in better performance. As a preprocess-ing step, representation, which transforms time series into more meaningful and usable format, is a suitable solution.

Many popular representations are based on the segmentation of time domain, e.g. Symbolic Representation, Piecewis e Linear Representation (PLR). Gener-ally, the time series is segmented into many subseries. Then the original one is represented by the resulting segmentation based on the content of each sub-series or the distribution of the values using various techniques, e.g. clustering or statistic etc. And other methods give the new representation using frequency transforms, e.g. Fourier Transforms [1], Wavelets [2]. But they are not enough to solve the similarity problem of time series, due to their ignoring on the hierarchy of each point in time serie s according to importance.

The accurate and suitable representation problem has brought challenges in the research on time series. So, it is by no means trivial to study this problem and put forward an effective solution tha t represents time series accurately and usably for similarity measurement. In this paper, we propose a novel approach, called Multi-Hierarchical Representation (MHR), to fill this gap. Our strategy is to partition the points into different hierarchies using Fast Fourier Transform (FFT). Then the time series is represent ed by the Multi-Hierarchical subseries, which consist of the points in the same hi erarchy. The distance between the new representations can be computed by the s um of distances of the subseries in dif-ferent hierarchies. We used best match s earching and clustering experiments on both synthetic and real data sets to evaluate the effectiveness of MHR comparing with other methods. And the comparison o f their efficiencies was also performed on the real data set. All the results show ed the superiority of ours in terms of effectiveness and efficiency.

The rest of the paper is organized as follows. Sect. 2 provide some background materials. Sect. 3 introduces MHR and it s similarity measurement. In Sect. 4, we give the exhaustive performance comparisons between ours and other methods. Finally, in Sect. 5 we offer some conclusion remarks. 2.1 Related Work Many representations of time series h ave been proposed in searching or min-ing applications. Symbolic representation is a popular method to transform the numerical series into symbolic sequence. The simple is to automatically cluster all the subseries in a fixed-window into some classes, and then use the sym-bols standing for the classes, to replace each subseries [3]. The method may be disabled due to the inaccuracy of the interval boundaries, e.g. a whole shape (or content) is segmented. Recently in [ 4], the Symbolic Approximation (SAX) has been proposed with an approximate distance function that lower bounds the Euclidean Distance. In [5], a new method for meaningful unsupervised sym-bolization of time series, called Persist, was proposed utilizing incorporation of temporal information. Clipped representation has attracted much interest [6, 7], and it has superior space benefits due to only saving 0 and 1. In [8], a multireso-lution symbolic representation was proposed, and Hierarchical Histogram Model was used as the distance function. It integrated the segmental results of several fixed-window. The multiresolution seems similar to MHR, but, actually, we have the essential difference that we emphasize th e corresponding hierarchical relation of the points in similarity measure, and they used the multiresolution segmental windows to solve the inaccuracy using only one fixed-window.

Dimensionality reduction is also one kind of representation, representing the time series with a multidimensional vector. In [1], the Discrete Fourier Trans-form (DFT) was utilized to perform the dimensionality reduction, and other techniques have been suggested, including Singular Value Decomposition (SVD) [9] and the Discrete Wavelet Transform (DWT) [2]. In [10], an extended repre-sentation of time series using piece-wise linear segments was proposed, as well as a weight vector that contains the relative importance of each individual linear segment, which allows fast and accurate cl assification, clustering and relevance feedback. In [11, 12], Piecewise Aggre gate Approximation (PAA) was proposed, and in [13], a more effective method Ada ptive Piecewise Constant Approxima-tion (APCA) was proposed with segments of varying lengths of each time series.
All the methods above is to find a new representation that can represent the time series accurately with simple format or high level content to obtain the preferable results in the relevant pos t-process, e.g. similarity measurement, searching, clustering etc. Most of them are based on the local information. In this paper, we focus on the accurate and s uitable representation based on the global consideration. 2.2 Preliminaries In this subsection, we start with some basic definitions. A time series X = x ,x 2 , ..., x n is a sequence of real values in which each value corresponds to a time point. x i (or X [ i ]) stands for the value at i -th sampling time. The value might be of various dimensions. | X | = n denotes the length of X .Wegivethe definitions of two kinds of subseries for our approach as follows: Definition 1. Sequential Subseries: A sequential subseries from time point s to Definition 2. Unsequential Subseries: An unsequential subseries is formalized by X ( S )where S = S (1) ,S (2) , ..., S ( m ) is the ordered subset of natural number by the formula X ( S ) i = X [ S ( i )].
 Then we introduce DFT, which transforms a time series from time domain into frequency domain. The contrary pro cess is named Inverse Discrete Fourier Transform (IDFT). Formally, the DFT of X is defined to a sequence X f = X 1 ,X 2 , ...X n consists of n complex numbers. An d FFT and Inverse Fast Fourier Transform (IFFT) are the faster algorithms with O ( nlog ( n )) time performance corresponding to DFT and IDFT with O ( n 2 ). The hierarchical strategy is adopted in our approach. Firstly, the time points in time series are partitioned into different hierarchies. In each hierarchy, an unsequential subseries defined in Definition 2 is formed by the values on the time points belong to the hierarchy. Then a time series can be represented by the unsequential subseries of all the hierarchies. Table 1 shows the main symbols used in this paper. Then we introduce our approach detailedly in the following. 3.1 Hierarchical Representation Given a time series X with length n and a hierarchy parameter h ( h&lt;n ), we use FFT to generate h waves as Fig. 1(a). Then we combined linearly the first i waves, labelled as X i with the same length as X , like the five curves in Fig. 1(b). The larger i is, the more similar X i is to the original X , which can be found from Fig. 1(b).

Then we can get the unsequential subseries of each hierarchy. In i -th (1  X  i  X  h ) hierarchy, S xi consists of the time points with extremum in X i , i.e. the black points in Fig. 1(b). The unsequential subseries can be formed according to Definition 2 as shown in Fig. 1(c). In addition, if a time point has been in the higher hierarchy, it will not be added in the lower, even if it is also the extremum point in any lower hierarchy. The first and last time points are initialized as the points in first hierarchy. Choosing the extremum points is due to their importance in the whole series. The algorithm generating each S xi is illustrated formally in Fig 2, and then MHR of X can be formed using Definition 2. 3.2 Distance Measurement In this subsection, we give the distance measurement of MHR. After hierar-chical partition of two time series, we can compute the distance between the unsequential subseries in each hierarchy using a distance function that allows time warping, e.g. DTW. And then the sum of distances of all h hierarchies is calculated as the distance of the two time series. Given two time series X and Y with lengths n x and n y respectively, the hierarchy parameter h ( h&lt;n x ,n y ), and a warping distance function D w . Formally, the MHR Distance (MHRD) can be defined as follows: MHRD(X , Y , h) = h i=1 D w (X(S xi ) , Y(S yi )). We take DTW as the distance function to analysis the time performance of MHRD. The time consumption of calculating the distance of two time series is O ( h i =1 n xi n yi ) with obvious superiority over DTW with O ( n x n y )( n xi n x and h i =1 n xi &lt;n x ). Mostly, it is more accurate with larger h , but with more time consumption. So h can be selected according t o the particular require-ment. We performed the experiment to s how the time performances of ours and others. 3.3 Additional and the Expansion In our approach, there might be the case that n xi = 0 but n yi = 0, i.e. the extremum points in i -th hierarchy of X are also with extremum in k -th hierarchy ( k&lt;i ). We use the unsequential subseries in the ( i  X  1) hierarchy of X instead of that of the i -th in this case. This is the important addition for our approach.
Our approach can be expanded in the following directions: ordering the waves, and giving a gradual segmentation approach using the time points in each hi-erarchy. We can reset the order of the w aves with decreasing amplitude of the corresponding Fourier coefficients of X f .Then X i can be got by the linear combi-nation of the first waves with the largest i Fourier coefficients. Then the following process is as same as the description above. Using the extremum points in each hierarchy, we can segment the time ser ies gradually. Then it can be used in many methods,whicharebasedonsegmentationoftimeseries. In this section, we used best match searc hing and clustering experiments to test the accuracies of ours and o thers on both synthetic an d real data sets. In the experiments, DTW was selected as the warping distance function D w in our approach (MHRD), because it is widely used in many applications. The com-petitors included Euclidean Distance and DTW. Finally, we give the efficiency comparison in Sect. 4.4. 4.1 Datasets The synthetic data set is Synthetic Control Chart Time Series (SYNDATA) data set which was downloaded from the UCI KDD archive 1 . It contains 600 examples of synthetic control charts belong to 6 different classes, and each class consists of 100 time series. The length of each time series is equal to 60.

The real data set is the Standard and Poor 500 index (S&amp;P) historical stock data from Mar. 27, 2004 to Mar 26, 2005 2 . We chose the opening price as our experimental data. Each stock data is a series of length d ,where d  X  252 ( d might be smaller if the company is removed from the Index). We only used the stocks whose length is 252. Based on the official S&amp;P clustering information, we divided the stock data into the classes. Finally, 50 classes contain 442 stock data were used by removing the classes which contain only one stock. 4.2 Best Match Searching Evaluation method. Best match searching is the process to find the time series whose distance with the given one is below a predefined threshold, or the most similar k matches in database. Because the threshold is difficult to set for different measurements with different value ranges, we used KNN searching for the experiment. The accuracy evaluati on is following, which was also adopted in [8]: The standard (right) searching result of a query Q , labelled as std( Q ), is the set of time series which belong to the same class as Q , which can be got by the apriori classification information, and the results by different methods are marked knn( Q ). The accuracy (precision) related to Q is defined as follows:
In our experiment, we set the number of time series belong to the same class as the query as the value of k . In the experiment, each time series is treated as a query. The average of the accuracies is calculated as the final result. Experiment on SYNDATA. We show the matching accuracies of the meth-ods on SYNDATA in Fig. 3. In the experiment, we also realized the piecewise normalization in Euclidean Distance, which can get better clustering results than plain Euclidean Distance on stock data proofed in [14]. When window is set to 60 (252) in Fig. 3 (Fig. 4), it is the plain Euclidean Distance. The results of ours with different h are given, as well as that of Euclidean distance and DTW. From the results, we can get that DTW obtains a much better result. And the results of Euclidean Distance are the worst, so we can conclude that the data are not sensitive to time warping. Our results are approximative to that of DTW, but more efficient. When h in ours is set as 17, we can get the best result of all. Experiment on S&amp;P. Fig. 4 show the matching accuracies of the methods on S&amp;P data. The results display that ours is the best of all, though ours is inferior to the Euclidean Distance only in a few cases, e.g. h = 5 or 7. The result of DTW is the worst, so we can conclude that the stock data is sensitive to time warping. The results also demonstrated that Euclidean Distance with the piecewise normalization is an a ccepted method on stock data. 4.3 Clustering Experiment Evaluation method. We used Hierarchical Agglomerative Clustering (HAC) to realize the clustering experiment. The clustering result can be taken with the predefined clustering number. We used the complete distance to compute the distance between two classes. We co mputed the clustering accuracy using the method, which is adopted in many applications [8, 14]. Given the standard clustering result C = C 1 ,C 2 , ..., C k from the apriori classification information and the clustering result using each method C = C 1 ,C 2 , ..., C k , compute the accuracy by the following formulas: sim( C ,C ) above can be calculated similarly as sim( C, C ) in Eq 3. We computed both sim( C ,C )andsim( C, C ), because they are not symmetric. The clustering numbersusedinHACweresetto6and50onSYNDATAandS&amp;Pdataset respectively as same as their class numbers.
 Experiment on SYNDATA. The clustering results on SYNDATA are given in the Fig. 5. From the figure, we can observe that the best result is also obtained by ours as best match searching experiment, when h = 17. The results of Euclidean Distance are also the worst, and DTW can get much better results. Our approach can be seen a  X  X nsequential piecewise X  DTW algorithm, and it have better accuracy and efficiency than DTW.
 Experiment on S&amp;P. The experimental results on S&amp;P are listed in Fig. 6. From the figure, we can find that Euclidea n Distance with piecewise normaliza-tion is superior to DTW. It is the further proof to confirm that the stock data is sensitive to time warping. But ours with time warping, when h = 17, is the best due to its hierarchical strategy. And the results of ours with other parameters also gain the advantages over other methods.
 4.4 Time Performance Comparison Experiment In this subsection, we tested time performances of the methods using 1-NN queries with sequential scan in the S&amp;P data set. The time consumption of each method was the time in 442 times queries corresponds to each time series, and we assume that each time series had been preprocessed for each method. The experiment were conducted on the machine with CPU of Celeron 1.70Ghz and 512 MB of physical memory, running Microsoft Windows Server 2003. We only counted the time consumption of distance calculation for exact comparison except accessing the disk. In Fig. 7, we give the experimental results, which show that DTW is much shower than others. The time of MHRD increases linearly along with h . Though Euclidean Distance is faster than ours, considering the accuracy and efficiency, our approach is superior to it. In this paper, we introduce a new representation of time series that can be used in similarity measurement with better e ffectiveness and efficiency, named Multi-Hierarchical Representation (MHR). Our idea is based on the opinion that the points of one time series should be compared with the ones of another with the same importance in similarity measurement. The unsequential subseries is defined in time series different from the general sequential subseries. In our approach, firstly, we partition the time points into different hierarchies. Then time series is represented by the Multi-Hierarchical subseries consisting of points in each hierarchy. The sum of distances be tween subseries in all hierarchy can be taken as the measuring result using a distance function that allows time warping. We used best matching searching and clustering experiments on both SYN-DATA and S&amp;P to evaluate the effectiveness of our approach comparing with other methods. The results showed the superiority of ours on accuracy over oth-ers. There are some cases t hat the effectiveness of our s is little inferior to the others. But in most cases, MHR is a more a ccurate representation for measuring the similarity of time series. And we also tested the time performances of ours and other competitors. The results demo nstrated that ours is slower than Eu-clidean Distance but much faster than DTW. In the future, we will continue to research the extensive problems. And in our approach, the weight of the distance in each hierarchy is same. We will also study further in this aspect. The work was supported by the NSFC 60403021 and the 973 Program 2004CB-719400. We thank the anonymous reviewers for their helpful comments.

