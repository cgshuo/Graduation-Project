 Demographics are widely used in marketing to characterize differ-ent types of customers. However, in practice, demographic infor-mation such as age, gender, and location is usually unavailable due to privacy and other reasons. In this paper, we aim to harness the power of big data to automatically infer users X  demographics based on their daily mobile communication patterns.

Our study is based on a real-world large mobile network of more than 7,000,000 users and over 1,000,000,000 communication records (CALL and SMS). We discover several interesting social strategies that mobile users frequently use to maintain their so-cial connections. First, young people are very active in broaden-ing their social circles, while seniors tend to keep close but more stable connections. Second, female users put more attention on cross-generation interactions than male users, though interactions between male and female users are frequent. Third, a persistent same-gender triadic pattern over one X  X  lifetime is discovered for the first time, while more complex opposite-gender triadic patterns are only exhibited among young people.

We further study to what extent users X  demographics can be in-ferred from their mobile communications. As a special case, we formalize a problem of double dependent-variable prediction X  inferring user gender and age simultaneously. We propose the WhoAmI method, a Double Dependent-Variable Factor Graph Model, to address this problem by considering not only the effects of features on gender/age, but also the interrelation between gender and age. Our experiments show that the proposed WhoAmI method significantly improves the prediction accuracy by up to 10% com-pared with several alternative methods.
 J.4 [ Social and Behavioral Sciences ]: Sociology; H.2.8 [ Database Management ]: Database Applications Demographic prediction, Social strategy, Mobile social network, Human communication From a recent report by the International Telecommunications Union (ITU) at the 2013 Mobile World Congress, the number of mobile-phone subscriptions reached 6.8 billion, corresponding to a global penetration of 96%. As of 2014, the number of mobile subscriptions across the globe has exceeded the world population. These mobile devices record huge amounts of user behavioral data, in particular users X  daily communications with others. This pro-vides us with an unprecedented opportunity to study how people behave differently and form different groups.

Previous work on mobile social networks mainly focuses on macro-level models, like network formation [26], scale free [5], duration distribution [4, 29], and mobility modeling [30, 33]. Re-cently, however, researchers have started to pay more attention to the micro-level analysis of the mobile networks. For example, Ea-gle et al. [6] studied the friendship network of 100 specific mobile users (students or faculties at MIT). They investigated human inter-actions (what people do, where they go, and with whom they com-municate) based on the machine-sensed environmental data col-lected by mobile devices. However, they do not consider the user demographics. More recently, Nokia Research organized the 2012 Mobile Data Challenge to infer mobile user demographics by using communication records of 200 users [21, 35]. However, the scale of the network is very limited. In this paper, we aim to leverage a large-scale mobile network to study how users X  communication behaviors correlate with their demographic information.

Demographic information is often available in the telecommuni-cation industry. For example, a postpaid mobile user 1 is required to create an account by providing detailed demographic information (e.g., name, age, gender, etc.). However, a recent report that there is still a large portion of prepaid users 3 (also commonly referred to as pay-as-you-go) who are required to purchase credit in advance of service use. Statistics show that 95% of mobile users in India are prepaid, 80% in Latin America, 70% in China, 65% in Europe, and 33% in the United States. Even in the U.S., the switch to prepaid plans is accelerating during the economic recession from 2008. Prepaid services allow the users to be anonymous X  X o need to provide any user-specific information. However, building de-mographic profiles for all customers is critical to mobile service providers. This can help them make better marketing strategies (e.g., identify potential customers and prevent customer churns). Moreover, by using demographic information, service providers can supply users with more personalized services and focus on en-hancing the communication experience. Therefore, one interesting but challenging question is the extent to which user demographic http://en.wikipedia.org/wiki/Postpaid_mobile_phone http://www.itu.int/ http://en.wikipedia.org/wiki/Prepaid_mobile_phone Figure 1: Ego Network. Red circle: female; blue square: male; MMM: Male-Male-Male; FFF: Female-Female-Female. profiles can be inferred from their mobile communication interac-tions.

In this paper, we employ a real-world large mobile network com-prised of more than 7,000,000 users and over 1,000,000,000 com-munication records (CALL and SMS) as the basis of our study, which we use to systematically investigate the interplay of user communication behaviors and demographic information. Through the study, we first reveal several intriguing social strategies that users of different ages and genders use to maintain their social con-nections. Based on the discoveries, we then develop a unified prob-abilistic model to predict users X  demographics based on their com-munication behaviors. To the best of our knowledge, we are the first to study the problem of inferring user demographics and social strategies in such a real-large mobile network.

To highlight several of our key findings, we discovered that young people are very active in broadening their social circles, while seniors have the tendency to maintain small but close con-nections. We found that male users maintain broader social connections than female users when they are young. We also found that cross-gender communications are more frequent than those between same-gender users. We also observed frequent cross-generation interactions that are essential for bridging age gaps in family, workplace, education, and human society as a whole [20]. We discovered significant gender differences in hu-man interactions throughout their lives, which reflects dynamic gender-biased social strategies. Figure 1 shows examples of both female and male ego networks. Human social behaviors reveal both same-gender relationships X  X  X FF X  (Female-Female-Female) and  X  X MM X  (Male-Male-Male) triads X  X nd opposite-gender so-cial groups ( X  X MM X  and  X  X FM X  triads) during the dating and re-productively active period (18-34 years old). Upon entering into middle-age, people X  X  attention to opposite-gender triads quickly disappears. However, the insistence and social investment on same-gender social groups ( X  X FF X  and  X  X MM X ) lasts for a lifetime. Fi-nally, our analysis shows strong interrelations between users X  age and gender. For example, a 20-year-old female X  X  behaviors are dis-tinct from not only a 20-year-old male X  X , but also from a 50-year-old female X  X .

Based on these interesting discoveries, we further study to what extent users X  demographic information can be inferred by mobile social networks. We formally define a double dependent-variable classification problem. The objective is to infer users X  gender and age simultaneously by leveraging their interrelations. This prob-lem is very different from traditional classification problems, where only the correlations between the dependent variable Y and feature vector X are considered. In this problem, we are given two depen-dent variables Y (gender) and Z (age), and feature vector X . We aim to capture the correlations between X and Y , X and Z , and the Figure 2: Demographic prediction performance of comparison methods (Cf.  X 5 for details of the comparison methods). interrelations between Y and Z to infer Y and Z simultaneously. To address this problem, we present the WhoAmI method, whereby the interrelations between two dependent variables are modeled. The WhoAmI method is able to infer user gender and age simul-taneously. On both the CALL and SMS networks, the proposed method can achieve an accuracy of 80% for predicting users X  age and gender according to their daily mobile communication patterns, significantly outperforming (by up to 10% in terms of F1-Measure shown in Figure 2) several alternative methods (Cf.  X 5 for details of the comparison methods). To scale up the proposed method to han-dle large-scale networks, we further develop a distributed learning algorithm, which can reduce the computational time to sub-linear speedup (9 X 10  X  with 16 cores) by leveraging parallel computing. Organization. We introduce the mobile networks in Section 2. Followed by the interesting discoveries in Section 3, we formalize the double dependent-variable demographic classification problem and present our solution in Section 4. Prediction results are shown in Section 5. Finally, we summarize the related work in Section 6 and conclude this work in Section 7. Data. The dataset used in this paper is extracted from a collection of more than 1 billion (1,000,229,603) call and text-message events from an anonymous country [26, 17], which spans from Aug. 2008 to Sep. 2008. We construct two undirected and weighted mo-bile communication networks from the deidentified and anonymous data: call network (referred to as CALL) and messaging network (referred to as SMS). Specifically, we view each user as a node v and create an edge e ij between two users v i and v j if and only if they made reciprocal calls ( v i called v j and also v j called v least one time during the observation period) or messages between each other. The strength w ij of the edge is defined as the number of communications between v i and v j . Then we extract the largest connected components from each network as our experimental net-works: CALL and SMS. The resultant CALL network consists of 7,440,123 nodes and 32,445,941 edges and the SMS network is composed of 4,505,958 nodes and 10,913,601 edges. The data also does not contain any communication content.
 Demographics. In this dataset, around 45% of the users are fe-male and 55% are male. We compare the demographic population distribution of mobile users in the dataset with the 2008 global pop-ulation distribution. We found that both female and male users be-tween the ages of 20 and 55 are strongly overrepresented in the mo-bile population compared to the global population. This is reason-able, because teenagers (under 18 years old) and the elderly (aged 80 or over) use mobile phones less frequently. Thus in our study, we focus on users aged between 18 and 80 years old. To simplify the notations, we use F and M to respectively denote the female and male users. Following [10, 3], we also split users into four groups according to ages: Young (18-24), Young-Adult (25-34), Middle-Age (35-49), and Senior ( &gt; 49).
 Network Characteristics. We present a basic correlation analysis between network characteristics and user demographics to see how people of different gender and age maintain their mobile social net-works. In particular, we consider the following network metrics:
Figure 3 plots the correlations between the four network metrics and the user age. From sub-figures 3(a)-3(b), we observe that the degree and neighbor connectivity of both female and male users achieve peak values around 22 years old, then decrease with valleys around 38-40 years old. An interesting phenomenon is that before this valley, the males have clearly higher scores on both metrics (degree and neighbor connectivity), while the situation is reversed after this point.

From sub-figures 3(c)-3(d), we see that both triadic closure and embeddedness increase when users become older. Similar to the first two metrics, there is also a reversion phenomenon at age 38-40. The difference lies in that the male X  X  triadic closure and embedded-ness are at first smaller than the female X  X , and then become larger after the reversion point. All four network metrics are observed at a 95% confidence interval.
 Social Strategies. From a sociological perspective, the analysis that results in Figure 3 can be also explained by different social strategies that people use to maintain their social connections. It seems that young people (who have higher degree scores) are very active in broadening their social circles, while seniors (who have higher triadic closure scores cc ) tend to keep small but more stable connections.
Human communications form the structural backbone of human societies, in the shape of networks [26]. The mobile data provides rich information for understanding human communications in real-world daily life. In this section, we focus on the individual level to study how a user communicates with others in her/his ego net-work . To be precise, one X  X  ego network is defined by viewing her-self/himself as the central node and her/his directed friends as sur-rounding nodes. Clearly, the ego network is a sub-network of the original network. Figure 1 gives two examples of ego networks. Herein, we investigate the interplay of human communication in-teractions and demographic characteristics in ego networks. Three social strategies are revealed from the data, including homophily Figure 3: Correlations between demographics and network characteristics. on gender and age, cross-generation communication, and demo-graphic dynamics of social relationships. We present the discov-eries in the CALL network due to the page limit, and the SMS network shows the similar results.
 Homophily on Gender and Age. The principle of homophily suggests that people tend to be connected with those who are sim-ilar to them [14]. It has been extensively studied and verified in online social networks [16, 19] and mobile networks [4, 12]. With the ego network of each user, we study the demographic homophily on both gender and age. Figure 4 shows friends X  demographic dis-tribution for female and male users of different ages. The X-axis represents central users X  age from 18 to 80 years old and the Y-axis represents the demographic distribution of users X  friends, in which positive numbers denote female friends X  ages and negative numbers denote male friends X . The spectrum color, which extends from dark blue (low) to red (high), represents the probability of one X  X  friends belonging to the corresponding age (Y-axis) and gender (positive or negative). Interestingly, there exists a highlighted diagonal line in each figure, which suggests that people tend to communicate with others of similar age. In particular, the age homophily is much stronger for people aged between 35 to 55 years old. Simultane-ously, the highlighted diagonals appear in the same gender range, i.e. females appear in the positive Y range (F) and males in the negative Y range (M), which shows the existence of a high degree of gender homophily.
 Cross-generation Communication. The analysis above confirms the existence of demographic homophily in mobile social networks. But what are the patterns underlying cross-generational communi-cation, e.g., parents and kids? In fact, the cross-generational com-munication is a fundamental issue in sociology. The bulk of re-search [20, 28] has been conducted toward bridging age gaps in human society at large.

In Figure 5, we use heat maps to visualize the communication frequencies for different demographics. Figure 5(a) reports the av-erage number of calls per month between people. Figures 5(b)-5(d) detail the analysis by reporting the average numbers of calls between two male users, two female users, and one male and one Figure 4: Friends X  demographic distribution. X-axis: (a) fe-male age; (b) male age. Y-axis: age of friends (positive: female friends, negative: male friends). The spectrum color represents the friends X  demographic distribution. female user, respectively. Again, we discover highlighted diagonal lines in Figures 5(a)-5(c), which correspond to the gender and age homophily. We also notice that there are highlighted areas corre-sponding to cross-generational communications. In Figure 5(a), the color of cross-generation areas that extends from green to yellow indicates that on average 13 calls per month have been made be-tween people aged 20-30 and those aged 40-50 years old. This cor-responds to communications between parents and children, man-agers and subordinates, advisors and advisees, etc.

In addition, we observe that the communications between fe-male users seem to be much more frequent than those between male users (Cf. Figures 5(b) and 5(c)). This is possibly because communications between mothers and daughters are more frequent than those between fathers and sons. Moreover, we find a  X  X roth-ers X  phenomenon among male users. In Figure 5(b), the diagonal highlights from 18 to 34 years (Young and Young-Adult) are much larger and denser than the corresponding area in Figure 5(c). This indicates that male users tend to maintain broader social connec-tions than female users when they are young. Finally, from Fig-ure 5(d), we observe a highlighted red area between people aged 18-34 years old, which means that cross-gender communications are more frequent than those between users of the same gender. A similar observation has also been reported in [16].
 Demographic Dynamics. Human interactions between demo-graphics reveal homophily or cross-generation phenomena not only in topologically but also in their dynamics. Evolutionary theory suggests that one X  X  social strategy on her/his ego network vary and evolve across her/his lifetime as a function of the tradeoff between different social needs [27]. Herein, we focus our attention on the demographic dynamics in ego networks.

In Figure 6, we first report the friends X  demographic distribution in one X  X  ego network as a function of the central user X  X  age. The X-axis denotes the central user X  X  age x , and the Y-axis denotes the proportion of the age-groups her/his friends belong to, including the same generation ( x  X  5 to x + 5 ), older generation ( x + 20 to x + 30 ), and younger generation ( x  X  30 to x  X  20 ). From this, it is apparent that strong demographic dynamics exist in hu-man interactions. First, the young and young-adult put increasing Figure 5: Strength of social tie. XY-axis: age of users with specific gender. The spectrum color represents the number of calls per month. (a), (b), and (c) are symmetric. focus on the same generation ( X  X lue X  and  X  X ed X  lines) and main-tain decreasing interactions with the older generation ( X  X reen X  and  X  X ink X  lines). Second, the middle-aged and seniors start to devote more attention to the new generation ( X  X lack X  and  X  X yanine X  lines) even despite the sacrifice of homophily (the decreasing of  X  X lue X  and  X  X ed X  lines). Third, during middle-age, the connections with the age-matched opposite-gender in ego networks ( X  X lue X  in Figure 6(a),  X  X ed X  in Figure 6(b)) decrease, and the proportion of same-gender friends ( X  X ed X  in Figure 6(a) and  X  X lue X  in Figure 6(b)) stay relatively stable.

In Figure 7, the heat map visualizes the distribution of minimum age (X-axis) and maximum age (Y-axis) of three users in a close social triad structure. Figures 7(a) and 7(d) show the same-gender triads:  X  X FF X  and  X  X MM X , and Figures 7(b) and 7(c) present the age distribution for users in opposite-gender triads:  X  X FM X  and  X  X MM X . When people are young, the strong triadic relationships are revealed in all four kinds of gender-triads:  X  X FF X ,  X  X MM X ,  X  X FM X  and  X  X MM X  by highlighted red areas at the left-bottom cor-ners. More excitingly, when entering middle-age, people only maintain the same-gender triadic relationships, which is revealed by the red diagonal lines in Figure 7(a) and Figure 7(d). However, the opposite-gender triadic relationships vanish when people pass 34 years old in Figure 7(b) and 7(c). The instability of opposite-gender triadic relationships and the persistence of same-gender tri-adic relationships across one X  X  lifetime are novel discoveries and reveal human social strategy dynamics that are more complex and crucial than can be revealed by a static view.
 Social Strategies. First, Figure 4 confirms that people have the tendency to interact with others with similar gender and age. Sec-ond, Figure 5 shows that the cross-generation interactions are main-tained to pass the torch of family, workforce, and human knowledge from generation to generation in social society. Third, human in-teractions reveal striking gender differences in social triadic rela-tionships across one X  X  lifespan, which reflects dynamic gender-bias of human behaviors from young to old. Figure 7 shows that peo-ple tend to expand their social connections with both females and Figure 6: Dynamics of friends X  demographic distribution in ego networks. X-axis: (a) female age; (b) male age. Y-axis: Propor-tion of friends X  age groups. males during the dating and reproductively active period, and put more social investment on maintaining same-gender social groups after entering into middle-age.
All the observations above clearly demonstrate the strong demo-graphic interrelations between users X  gender and age. For exam-ple, a 20-year-old female X  X  behaviors are distinct from not only a 20-year-old male X  X , but also from a 50-year-old female X  X . Based on this, we formalize the demographic prediction as a double dependent-variable classification problem, i.e., we infer gender and age simultaneously. The WhoAmI method, a Double Dependent-Variable Factor Graph Model, is proposed to solve this problem by leveraging not only the correlations between features and gen-der/age, but also the interrelations between gender and age.
Let G = ( V,E,Y,Z ) denote the undirected and weighted mo-bile network, where V is a set of | V | = N users and E  X  V  X  V is a set of communication edges (CALL or SMS) between users. Each user v i  X  V is associated with demographic information, i.e., Gender y i  X  Y and Age z i  X  Z . X is the attribute matrix, where each row x i represents an | x i | dimensional feature vector for user v . Given this, we define our problem below.

Problem 1. Demographic Prediction: Given a partially labeled network G = ( V L ,V U ,E,Y L ,Z L ) and the attribute matrix X , where V L is a set of users with labeled demographic information Y
L and Z L , and V U is a set of unlabeled users, the objective is to learn a function to predict users X  gender and age simultaneously, where Y U the demographic information for the unlabeled users V U .
Different from previous work on demographic prediction [3, 10], where users X  gender and age are inferred by modeling P ( Y | G, X ) and P ( Z | G, X ) separately, our problem here is to model P ( Y,Z | G, X ) and predict users X  gender and age simulta-neously. We leverage not only the correlation between X and Y / Z but also the interrelations between gender Y and age Z . The mo-tivation here comes from the fact that Section 3 reveals strong de-mographic interrelations in human communication behaviors.
In this work, we infer gender as a binary classification problem, i.e., Female or Male, and infer age as a four-class classification Figure 7: Demographic distribution in social triad. X-axis: minimum age of three users in a triad. Y-axis: maximum age of three users. The spectrum color represents the distributions. problem by splitting users X  age into four groups: Young (18-24), Young-Adult (25-34), Middle-Age (35-49), and Senior ( &gt; 49).
Our goal is to design a unified model to capture not only users X  attributes on demographics but also the interrelations between users X  gender and age. We propose the WhoAmI method, a Dou-ble Dependent-Variable Factor Graph Model. To handle large-scale networks, we further develop a distributed learning algorithm.
We define an objective function by maximizing the conditional probability of users X  gender Y and age Z given their corresponding attributes and the input network structure, i.e., P  X  ( Y,Z | G, X ) . The factor graph [13] provides a way to factorize the  X  X lobal X  prob-ability as a product of  X  X ocal X  factor functions, which makes the maximization simple, i.e., P ( Y,Z | G, X ) = P ( X ,G | Y,Z ) P ( Y,Z ) where P ( Y c ,Z c ) denotes the probability of labels given the struc-ture c of the network and P ( x i | y i ,z i ) is the probability of generat-ing attributes x i given the label y i and z i .

In this model, we design three kinds of factors. The first is an attribute factor f ( y i ,z i , x i ) for capturing correlations between users X  demographics and communication attributes. The second is a dyadic factor g ( y e , z e ) for modeling correlations between users X  demographics and their direct relationships in ego networks, where Y in Eq. 2 is represented as y e ( y i ,y j ), and Z c is denoted by z and z j ) iff e ij  X  E . The third is a triadic factor h ( y relating users X  demographics and triadic relationships in their ego Figure 8: An illustration of the proposed model. y networks. Similarly, y c means y i ,y j ,y k and z c is z three users v i ,v j ,v k form a close triangle structure. Therefore, the joint distribution can be further factorized as:
Figure 8 shows an illustration of our proposed model, which con-sists of two layers of nodes. The bottom layer contains random variables and the upper layer contains the three kinds of factors in-troduced above. The joint distribution over the whole set of random variables can be factorized as the product of all factors. Specifi-cally, we instantiate the three factors as follows.
 Attribute factor. We use this factor f ( y i ,z i , x i ) to represent the correlation between user v i  X  X  demographics and her/his network characteristics x i . More specifically, we instantiate the factor by an exponential-linear function: where  X  is one parameter of the proposed model, and W v is a nor-malization term. For each pair of ( y i ,z i ) ,  X  y i z vector, where the k -th dimension indicates how x ik distributes over ( y ,z i ) . For example, let X  X  say x ik represents the degree of user v This factor can capture the fact that people with different gender and age have the different network properties shown in Figure 3. Traditional probabilistic graphical models can only model the cor-relations between features and one single type of dependent vari-able, while our proposed model captures how the features distribute over two types of dependent variables jointly.
 Dyadic factor. We next define the dyadic factor g ( y e , z e ij  X  E , to represent the correlation between user v i and v mographic information. Specifically, we have where  X  p is the model parameters for this type of factor, g defined as a vector of indicator functions, and W e p is the normal-ization term. We can enumerate in total 6 different combinations of each pair of demographic variables from ( y i ,y j ,z i ,z ition behind is that v i  X  X  friends X  demographics distribute differently by varying either v i  X  X  own age or gender, as Figure 6 suggests. Triadic factor. We finally define the triadic factor h ( y represent the correlation among the demographics of social triads, where c = { v i ,v j ,v k | e ij ,e jk ,e ik  X  E } indicates the triangle structure in G . More specifically, we have where h 0 q (  X  ) is the vector of indicator functions and W malization term similar with W e p . There are 20 different kinds of three-variable enumerations from ( y i ,y j ,y k ,z i ,z these triadic factors to model the distributions of users X  age and gender within a social triangle. See details in Figure 7.
Finally, combing Eq. 4, 5, 6 into Eq. 3, we define the objective function as the log-likelihood of the proposed model as: where W = W v W e W c is the global normalization term, W Q
The technical novelty of the proposed model is that it considers two types of labels in a unified framework, which differentiates our model from traditional classification models. By considering two types of labels, the main advantage is that our model can charac-terize the correlations between gender/age and features more pre-cisely.
Given a network with labeled and unlabeled users, the goal is to infer unlabeled users X  demographic information. This scenario sat-isfies a real-world application for mobile operators. There are three kinds of features designed in our experiments, namely attribute fea-tures, friend features, and circle features. Specifically, given an ego network with one central user v and her/his direct friends, we ex-tract three kinds of features for this central user v as follows:
Individual feature. Characteristic attributes are extracted based on the network topological properties discussed in Section 2. It includes the degree, neighbor connectivity, clustering coefficient, embeddedness, and weighted degree ( # calls or # messages).
Friend feature. There are two types of friend features, includ-ing friend attributes and dyadic factor. First, friend attributes are used to model the demographic distribution of v  X  X  direct friends in her/his ego network, including the number of connections to fe-male, male, young, young-adult, middle-age, and senior friends. In the prediction scenario, not all friends of the central user v are labeled with gender or age information, so we extract the friend at-tributes only based on her/his labeled friends. Second, to further model the distribution of unlabeled and labeled friends together, dyadic factor is used as the other type of friend feature (Cf. Eq. 5).
Circle feature. Similarly, it also contains two kinds of fea-tures: circle attributes and triadic factor. First, circle attributes refer to the triadic demographic distribution of v  X  X  ego network. Because we aim to infer the central user v  X  X  demographics, we count the numbers of different gender triads, i.e.,  X  FF -v  X ,  X  FM -v  X ,  X  MM -v  X , and different age-group triads. Let A/B/C/D denote the young/young-adult/middle-age/senior age-groups, respectively. There are in total ten kinds of triads based on age-groups:  X  AA - X  CD -v  X ,  X  DD -v  X . Second, triadic factor is used to model the demo-graphic distributions over triangles with both unlabeled and labeled users (Cf. Eq. 6).

The individual, friend, and circle attributes are captured by the attribute factor in our DFG (Cf. Eq. 4). There are in total 24 attribute features used in our models.
The goal of learning the DFG model is to find a configuration for the free parameters  X  = {  X , X , X  } that maximize the log-likelihood of the objective function O (  X  ) in Eq. 7 given by the training set, i.e., Learning. We first introduce how we learn the model in a single-processor configuration, and then explain how to extend the learn-ing algorithm to a distributed one for handling large-scale net-works.

To solve the optimization problem, we adopt a gradient decent method (or a Newton-Raphson method). Specifically, we derive the objective function with respect to each parameter with regard to our objective function in Eq. 7. where in the first Equation of Eq. 8, E [ P v expectation of the summation of the attribute factor functions given the data distribution over Y , Z , and X in the training set, and E mation of the attribute factor functions given by the estimated model. The other expectation terms have similar meanings in the other two equations. As the network structure in the real-world may contain cycles, it is intractable to estimate the marginal prob-ability in the second terms of Eq. 8. In this work, we adopt Loopy Belief Propagation (LBP) [23] to calculate the marginal probability of P ( Y,Z ) and compute the expectation terms.

The learning process then can be described as an iterative algo-rithm. Each iteration contains two steps: First, we call LBP to cal-culate marginal distributions of unknown variables P Second, we update  X  ,  X  , and  X  with the learning rate  X  by Eq. 9. The learning algorithm terminates when it reaches convergence. Distributed learning. We further develop a distributed algorithm to scale up our model to handle these large-scale networks. Our distributed learning algorithm utilizes a Message Passing Interface (MPI) framework, by which we can split the network into small parts and learn the parameters on different processors. As most computing time is consumed in the first step of our learning algo-rithm introduced above, we speed up this learning processes by dis-tributing multiple  X  X lave X  computing processors for this step. The second step is calculated in the  X  X aster X  processor by collecting the results from all  X  X lave X  processors on the first step.

Specifically, our distributed learning algorithm based on the master-slave framework can be described in two phases. At the first phase, the large-scale network G is partitioned into K sub-networks G 1 ,  X  X  X  ,G k ,  X  X  X  ,G K , and the K sub-networks are dis-tributed to K  X  X lave X  processors. At the second phase, we itera-tively learn the parameters in two steps. First, each processor can compute the local marginal probability on its sub-network G ond, the  X  X aster X  processor collects all gradients obtained from dif-ferent subgraphs and updates all parameters. The second phase is repeated until convergence.

There are two notes for our model implementation. At the first phase, different from partitioning the large network based on communities in previous work [31], we partition the country-wide mobile network based on different administrative regions, i.e., provinces or states. The mobile operator can obtain this informa-tion when its users first register their mobile phones. The other one is that we first extract all features for each user from the original large network. We then split it into sub-networks that are handled by each  X  X lave X  processor.
 Prediction. With the estimated parameter  X  , we can now assign the value of unknown labels Y,Z by looking for a label configura-tion that will maximize the objective function, i.e.
In this paper, we use the max-sum algorithm [18] to solve the above problem.
We present the effectiveness and efficiency of our proposed DFG model on demographic prediction by various experiments. The code used in the experiment is publicly available. 4 Data and Evaluation. We use two large-scale mobile networks, CALL and SMS, to infer users X  gender and age. Detailed data in-formation is introduced in Section 2. To infer user demographics effectively for mobile operators, we only consider active users who have at least five contacts in two months. After filtering, there are 1.09 million and 304,000 active users in CALL and SMS networks, respectively. We repeat the prediction experiments ten times, and report the average performance in terms of weighted Precision, Re-call, and F1-Measure. We consider weighted evaluation metrics because every class in female/male or young/young-adult/middle-age/senior is as important as each other. It is worth noting that the weighted Recall has the same score as Accuracy.

All code is implemented in C++, and experiments are performed in a server with four 16-core 2.4 GHz AMD Opteron processors with 256GB RAM. We use the speedup metric with different num-bers of computing cores (1-16) to evaluate the scalability of our distributed learning algorithm.
 Comparison methods. We compare our proposed DFG model that can capture the interrelation between two dependent variables http://arnetminer.org/demographic (gender and age) with different classification algorithms, includ-ing Logistic Regression ( LRC ), Support Vector Machine ( SVM ), Naive Bayes ( NB ), Random Forest ( RF ), Bagging ( Bag ), Gaussian Radial Basis Function Neural Network ( RBF ), and Factor Graph Model ( FGM ). For LRC, NB, RF, Bag, RBF, we employ Weka 5 and use the default setting and parameters. For SVM, we use lib-linear 6 . For FGM, the model proposed in [19] is used. Note that our proposed DFG model is equal to FGM if we do not consider the interrelations between gender and age.

For all comparison methods, we use the same unstructured fea-tures (characteristic, friend, and circle attributes) introduced in Sec-tion 4.2.2. For the graphical models, FGM and DFG , the structure features (dyadic and triadic factors) are further used to model user demographics on network structure. The major difference between our DFG and FGM model is that DFG can capture not only the cor-relation between different users, but also the interrelation between two dependent variables of each user, i.e., gender and age.
We report the demographic prediction performance for different methods in the CALL and SMS networks as follows. In prediction experiments, we use 50% of the labeled data in each network as a training set and the remaining 50% for testing.
 Predictive performance. Table 1 shows the prediction results of different algorithms on the four prediction cases, i.e., gender and age predictions in the CALL and SMS networks, respectively. Clearly our DFG model yields better performance than the other alternative methods in the four cases. The Bag algorithm achieves the best prediction results among all non-graphical methods. The FGM model outperforms a series of non-graphical algorithms by modeling the correlations among structured nodes via dyadic and triadic factors. The DFG model outperforms FGM by further lever-aging the interrelations between user gender and age. In terms of weighted Precision, Recall, and F1-Measure, DFG achieves up to 10% improvements compared with the baselines for the prediction of users X  gender and age. As for Accuracy, the DFG model can in-fer 80% of the users X  gender in the CALL network and 73% of the users X  age in the SMS network correctly. Finally, we observe that the CALL network can reveal more users X  gender information than the SMS network, as the overall performance of gender prediction in CALL is about 5% higher than that in SMS. However, predicting age from SMS behaviors is relatively easier than predicting it from CALL communications.
 Effects of demographic interrelation. We evaluate the effects of demographic interrelation on the predictions. Without modeling the interrelation between gender and age, our proposed DFG model degenerates to a basic factor graph model (FGM/DFG-d). From Ta-ble 1, we clearly observe the 2% to 4% improvements achieved by DFG to FGM on weighted F1-Measure. We further analyze feature contributions for demographic prediction. Recall that in Section 4.2.2, besides the individual features, we introduced the friend fea-tures (friend attributes and edge factor) and circle features (circle attributes and triad factor). By removing either friend or circle fea-tures, we evaluate the decrease in predictive performance in terms of weighted F1-Measure, plotted in Figure 9. DFG-df, DFG-dc and DFG-dfc stand for the removing of friend features, circle features, and both, conditioned on DFG-d without modeling gender and age interrelations. Clearly, we can see that for inferring gender, the performance when removing circle features drops more than when http://www.cs.waikato.ac.nz/ml/weka/ http://www.csie.ntu.edu.tw/ cjlin/liblinear/ Figure 9: Feature Contribution Analysis. DFG is the proposed model. TFG-d is the basic version of DFG without modeling the correlation between gender and age. DFG-df stands for further ignoring friend features. DFG-dc stands for further ignoring circle features. DFG-dcf stands for ignoring both friend and circle features. removing friend features, which indicates a stronger contribution of circle features to gender prediction than friend features. How-ever, for inferring user age, friend features contribute more than cir-cle features. The feature contribution analysis further validates our observations of demographic-based social strategies, and demon-strates that the proposed model works well by capturing the ob-served phenomena.
 Training/test ratio. We provide further analysis on the effects of training ratio on predictive performance. Figure 10 shows the prediction results when varying the percentage of labeled users in the training set. Clearly, we can see rising trends as the training set increases in Figure 10(a) and 10(b). This indicates the positive ef-fects of training data size on predicting the gender of mobile users. The smooth lines in Figure 10(c) and 10(d) reveal the limited con-tributions of training data size on predicting age. We can see that in all cases, obvious improvements can be obtained by our proposed DFG model with different sizes of training data.
 Scalability. We verify the distributed learning algorithm by parti-tioning the original large-scale network into multiple sub-networks based on different administrative areas. We determine users X  ar-eas by their postal code information during registration. Each sub-network in one area is used as the input for a given core. By utiliz-ing MPI, our distributed algorithm can achieve 9-10  X  speedup with 16 cores with &lt; 2% drop in performance. Basically, our learning algorithm can converge in 100 iterations, and each iteration costs about 2-5 minutes for one single processor. By leveraging a dis-tributed learning algorithm, our DFG model is efficient even for large-scale networks with millions of nodes.
The availability of mobile phone communication records has of-fered researchers many ways to analyze mobile networks, greatly enhancing our understanding of human mobile behaviors.

To better model the macro properties of mobile communication networks, Onnela [26] and Nanavati et al. [24] examine the lo-cal and global structure of a society-wide mobile communication network. Faloutsos et al. [29] first propose the double pareto-lognormal distribution to model the macro properties in call net-works, which is beyond power-law and lognormal distributions. They further discover that not only the node properties but also to the Accuracy score. The number in parentheses is the standard deviation. CALL clique structures follow the power-law distribution in mobile net-works [5]. Dong et al. [4] investigate the mobile call duration be-haviors in mobile social networks and find that people who are familiar with each other tend to make short calls. Recently, the emergence of work on mobility [30, 33, 8, 36] and location-based mobile networks [7, 2, 1], where human movements or locations are tracked by mobile phones, provides us a means of understand-ing and predicting mobile social behaviors. Eagle et al. [6] try to infer the friendship network in mobile phone data. As for mobil-ity applications, mobile patterns are applied to predict the future location of users in [22, 25, 34]. However, most previous work focuses on scaling the macroscopic properties of mobile networks, while our work incorporates the micro-network structure to model human communication behaviors in mobile networks.

Furthermore, there are several works on user demographic and profile modeling. Existing works try to infer user demograph-ics based on their online browsing [10] and search [3] behav-iors. Leskovec and Horvitz [16] examine the interplay of the MSN network and user demographic attributes. Tang et al. extract and model the researcher profiles in large-scale collaboration net-works [32]. Additionally, researchers have used network informa-tion to identify user status differences in email [11] and LinkedIn networks [37]. Nokia research organized the 2012 Mobile Data Challenge to infer mobile user demographics by using 200 individ-ual communication records without network information [21, 35]. Kovanen et al. [12] utilize temporal motifs to reveal demographic homophily in dynamic communication networks. The main dif-ference between existing work and our efforts lies in that exist-ing work mainly analyzes demographics (gender, age, status, etc.) separately, while our analysis and model consider the correlation among different demographic attributes.
In this paper, we study human interactions on demographics by investigating a country-wide mobile communication network. From this, we discover a set of social strategies stemming from human communications. First, young people put more focus on enlarging their social circles; as they age, they have the tendency to maintain small but close social relationships. Second, we ob-serve a strong homophily of human interactions on gender and age simultaneously. Third, beyond these observations, we find that the frequent cross-generation interactions are maintained to pass the torch of family, workforce, and human knowledge from generation to generation in social society. Finally, we observe striking gender differences in social triadic relationships across individuals X  lifes-pans, which reflects dynamic gender-bias of human behaviors from young to old.

Through these observations, we engage in answering the ques-tion of to what extent individual demographic can be revealed from mobile communication interactions. We formalize a demographic prediction problem to infer user gender and age simultaneously, and further propose the WhoAmI method to solve this problem by modeling not only the correlations between gender/age and fea-tures, but also the interrelations between gender and age. Exper-imental results in the CALL and SMS networks demonstrate the effectiveness and efficiency of our proposed model.

Detecting user demographics makes social networks more color-ful and closer to our real human networks. For future work, some other social theories and strategies can be explored and validated for modeling human mobile social interactions. In addition, exam-ining how the inferred demographic can help other topics in social network analysis, such as influence propagation, community detec-tion, and network evolution, would also be very meaningful.
