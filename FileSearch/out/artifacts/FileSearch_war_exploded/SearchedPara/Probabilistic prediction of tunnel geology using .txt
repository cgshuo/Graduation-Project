 Sou-Sen Leu, Tri Joko Wahyu Adi n 1. Introduction
Geological uncertainty is the primary source of risk in under-ground tunnel construction. It often leads to the assumption of the worst possible ground conditions and thus to inflated costs ( Riwanpura et al., 2003 ). These conditions are not known prior to construction and must be inferred based on general information describing the geologic formations near the project and on location-specific observations provided by sub-surface explora-tion programs. Tunnel designers and contractors use this infor-mation to develop a geologic description of the project that quantifies the inherent uncertainty present in the data due to the extent and reliability of available information. The geologic project description generated can then be used for practical decision making.

The foremost challenge in a tunnel construction project is to reduce problems due to unexpected geological issues. This challenge can be surmounted by providing a more accurate geology profile.
This paper proposes a new geological prediction model that can be used as a basis for developing more effective decision support systems for tunneling design and construction. The proposed model is based on a Hidden Markov Model (HMM) and a neural network (NN).

The model X  X  objectives are to (1) formalize the prediction procedure using automation, (2) develop a description of the geology that reflects the uncertainty in the information, on which it is based, and (3) provide necessary input data to other decision support systems. This model refines the existing geological prediction models by combining the advantages of HMMs and
NNs to provide more accurate prediction results. 2. Literature review
Many studies, including hard and soft methods, have been developed and implemented to minimize uncertainties regarding geological conditions in tunnel projects. All of these methods aim to determine the geological conditions ahead of the tunnel face to avoid unexpected changes in geologi cal conditions. Hard, or explora-tory methods, such as pilot tunnel drilling and advanced geophysical survey techniques including Hor izontal Seismic Profiling (HSP),
Tunnel Seismic Predicting (TSP), and Receptivity Image Profiling (RIP) ( Baecher, 1972 ; Inzaki et al., 1992 ; Chang and Yu, 2005 ;
Yu, 2005 ; Klose, 2006 ; Hwang and Lu, 2007 ; Mito et al., 2003 ) utilize on site equipment to obtain information about geological conditions along the tunnel line. Klose (2002) proposed a fuzzy rule-based expert system for short-range seismic predictions, which describes an approach to the geological interpretation of seismic diffraction stack images using fuzzy logic. The above methods can provide a macroscopic picture of a geological profile; however, for more detailed information about the geological conditions in a specific location inside the tunnel line, core sample tests (borehole) should be conducted ( FSTT, 2004 ).

To complement the results of hard (exploratory) methods, several geology prediction models, known as soft methods, have been developed. Qin et al. (2008) and Yang et al. (2009) proposed a method, ARMA, to predict ground deformation in tunnel con-struction based on time series analysis. Time series methods are generally used when there is a large amount of information describing the processing of generating the underlying variables. In their paper, the deformation of surrounding rock during tunnel excavation was regarded as a time sequence. Tian et al. (2004) and Zhao (2004) also predicted soil deformation in tunnel con-struction using a support vector machine (SVM). An SVM is a set of related supervised learning methods that analyze data and recognize patterns, used for classification and regression analysis. However, in predicting soil deformation, the SVM could not give satisfactory results due to problems in choosing an appropriate kernel function ( Yang et al., 2009 ).

Recently, many geology prediction models have been devel-oped, which make use of neural networks (NNs) to predict geological conditions during tunnel construction. Previous appli-cations have included predictions of geological hazards at the tunnel face ( Alimoradi et al., 2008 ) and prediction of tunnel settlement or deformation ( Santos and Tarc X  sio, 2008 ; Zang et al., 2005 ; Chen and Wang, 2009 ; Xuan and Xuhui, 2009 ; Kim et al., 2009 ; Lee et al., 2008 ). Neural Networks are suitable tools for use in the prediction of geological parameters because they can analyze non-linear patterns and trends common in geologic data. Despite its limitations  X  including model transparency and knowledge extraction  X  it has been widely used and has gener-ated many successful results as a mapping and prediction tool in geological engineering ( Shahin et al., 2001 ).

Another approach is the Markov process. It is one of the well-known stochastic processes and is sophisticated enough to deal with complex systems like geologic environments. The distin-guishing characteristic of a Markov process is single-step mem-ory: history apart from the most recent event is neglected in forming predictions about the future. A significant advantage of using single-step memory instead of multiple step memory is that probability calculations are considerably simpler and a full prob-ability distribution can often be found. The Markov process is suitable for tunnel geology prediction models because it involves not only uncertain ground parameters along the tunnel line but also their locations. Therefore, the concept of a stochastic process can be used.

Previously, Chan (1981) and Ioannou (1987) predicted the uncertainty of geological parameters along the rock tunnel line using a discrete-state Markov process. In their model the para-meters were assumed to be independent. However, geological parameters can be correlated such that the prediction of one parameter may depend on the status of the other parameters.
Liu et al. (2009) proposed a method of geologic prediction for analyzing the stochastic characteristics of the geologic spatial tendency. This model also used a Markov process to determine state probability along the horizontal alignment of a tunnel and applied a stochastic cyclic network simulation (CYCLONE) to analyze geological risk, which traditional methods have difficulty in measuring. Sutanto (2008) used real time Bayesian analysis to develop a geological profile of the  X  X  X rainage Water Tunnel Project X  X  in Taiwan; however, this model also failed to consider dependency between observation variables.

Recently, Hidden Markov Models (HMMs) have been proposed to analyze problems with uncertainty in transportation engineer-2007 ) and water resource engineering ( Thyer and Kuczera, 2003 ; Julian et al., 2004 ; Peter and Bertug, 2004 ). HMMs are extensions of Markov models. In a regular Markov model, the state is directly visible to the observer, and therefore the state transition prob-abilities are the only parameters. In a HMM each observation is the result of a stochastic process in one of several unobserved states. The challenge is to determine the hidden parameters from the observable data ( Xuan, 2004 ). The advantage of using a HMM in tunnel construction is that errors in geology prediction can be reduced by updating the states as soon as new observation information is obtained during the construction process.
The geological prediction model proposed in this paper was designed using a Hybrid Neural-Hidden Markov Model (Neural-HMM). Its architecture is a combination of a HMM and a back propagation neural network (BPNN). This model overcomes the deficiencies of existing models by readily incorporating all avail-able geologic information, considering interdependency among geologic parameters, and updating geologic predictions based on observations given by the BPNN. The architecture of a Neural-HMM is detailed in the next section. 3. Model architecture
The Neural-HMM is a hybrid model of hidden Markov chains and a back propagation neural network. This model overcomes the deficiencies of the above-mentioned models by combining the advantages of a HMM and a NN and is shown in Fig. 1 . The hidden Markov chain captures the probability characteristics of the transitions between the underlying states, while the neural net-work structure is used to determine the non-linear pattern of soil parameters and allow the existence of dependency between observations along the tunnel line. The main advantages of using a Neural-HMM are as follows: (1) the calculation of the posterior probability of states, not only evaluated a priori from a probability distribution function (PDF) of the states but also updated by observational data given by the neural network; this provides more-accurate predictions in real time. (2) It also considers interdependency between parameters and observational data along the tunnel line.

In the tunneling case, hidden states ( x 0: k ) represent the geology class ( GC ) along the tunnel line, while ^ y 1: k observations obtained from the core sampling points. A back propagation neural network (BPNN) is used for interpolating the soil properties measured at distinct core sampling points. In this way, each time a new geology class prediction is required, the operator does not need to measure the soil properties along the tunnel line, as the NN trained model can be used instead. This study developed and implemented a neural network with input nodes representing the location at which the core sample test was conducted; a hidden layer with differentiable transfer functions (Log-sigmoid); and output which represents the observations. Using this model, any soil parameters related to the tunnel geology such as N value, % clay content, % sand, and % gravel can be used as observations. Both input and output data are normalized. 3.1. Model input
There are 3 inputs required for the model that must be derived before it can be used to make predictions: model states ( x transition probability matrix ( P ij ) and the likelihood matrix ( L The states of a random variable are the possible values that it can take ( Chan, 1981 ). In this model, the states ( x i ) are defined as conditions along the tunnel line. Our goal is to evaluate the conditional PDF of the states ( x i ) at every time k in a Markovian fashion.

The discrete-state continuous-time (DSCT) Markov chain is completely described by the transition probability matrix: A  X  X  a ij ; i , j  X  1 , 2 , ... , n where a ij  X  p and c i are the two main elements of the discrete-state contin-uous-time Markov process: the transition probabilities and transition intensity coefficients , respectively. The transition probability, p that it is in state i at the current location l 0 ( l ^ l intensity coefficient is the expected distance over which the para-meter X ( l ) will remain in a particular state. Under the Markovian assumption of single-step memory, c i follows an exponential dis-process satisfy the Kolmogorov differential equation: dP  X  l  X  dl  X  P ij  X  l  X  A where P ij  X  l  X  X  e
In Eq. (2) the transition probability matrix of the model will change dynamically according to the length of tunneling progress continuous time Markov chain. A Markov process is usually associated with a random variable, which assumes different states at different points in time ( t ). In this paper  X  X  X ime X  X  is equivalent to the position along the tunnel axis, the location of which is identified by the  X  X  X istance X  X , l from a fixed point, e.g. the portal of the tunnel (see Fig. 2 ).

In general, there are two ways of assessing the values of p the frequency-based method and the subjective judgment method. geology maps and existing tunnel profiles from a region with similar geology to the tunnel region. The proposed model assessed p based on the available historical data around the tunnel line. c estimated by computing the average length of each state while p was estimated by computing the ratio between the number of transitions from states i to j and the total number of transitions out of state i . The proposed model also adjusted the value of the transition probability matrix, P ij , by tuning the distance between boreholes to achieve the optimal result.
 Network
Transition Likelihood matrix
The likelihood (reliability) matrix of a particular exploration method is defined as L that the true parameter is j; n is the number of possible states for geological parameters X i ; and m is the number of possible observation states ( ^ y k ).

In general, the number of observation states m does not have to equal the number of geological parameters n and higher m / n ratios will imply more accurate observation. In practice, however, a different likelihood matrix must be defined for every particular combination of exploration method and geologic parameter. The likelihood matrix is also assumed to be a function of location ( l ) since the reliability of the observation method is dependent on the geology of the project area, not just on the parameters being observed. 3.2. Model inference
To determine the posterior probability, i.e. the PDF, of the states, consider the following discrete-time state-space model of a dynamic system x  X  f k 1  X  k k 1 , u k 1 , w k  X  , y k  X  h k  X  k k , u k , v
The two variables, x k and y k in Eq. (4) are called the state transition evolution (or predictor equation) and the observation output (or corrector equation), respectively. In this equation, x k A R n , and y k A R q is the system state and the observed output at time k ; w k A R l and v k A R m are introduced to account for unknown disturbances, model errors, and measurement noise; f k is the prescribed state transition function at time k ; and h k is the prescribed observation function at time k . The values of the initial state x 0 and the variables w k and v k at each time k are uncertain and are described by probability models which, when combined with Eq. (4), prescribe the one-step ahead predictive PDFs p ( x k 9 x k 1 , u k 1 ) and p ( y k 9 x k , u k ) in addition to p ( x PDFs give a complete description of the stochastic state space model and play the major role in the theory that follows ( Arulampalam et al., 2002 ).

The goal of a HMM is to evaluate the conditional PDF p  X  x That is, to update this PDF sequentially, using the observed system inputs and outputs up to the current time, but only using information produced at the end of the previous time step and observation data from the current time step. The data are evaluated using prescribed probabilistic models for w k and v From this conditional PDF, some important features of the state, such as the conditional expectation E  X  x k 9 ^ y k , u k covariance matrix cov  X  x k 9 ^ y k , u k  X  , can be estimated.
From now on, the conditioning of every PDF on U k is left as implicit in the notation. The basic equations for updating p  X  x equations that follow from the Theorem of Total Probability and Bayes X  Theorem, respectively: p  X  x k 9 ^ y k 1  X  X  p  X  x k 9 ^ y k  X  X  where ^ y k 1 is dropped in p ( x k 9 x k 1 ) and p  X  ^ y models for the state transition and observation PDFs make it irrelevant. An alternative formulation of the basic equations will prove useful in the next section. Let the state history be from Bayes X  Theorem, as in the second equation in Eq. (5): p  X  x k 9 ^ y k  X  X 
Note that p  X  ^ y k 9 x k , ^ y k 1  X  X  p  X  ^ y k 9 x k  X  and p  X  x p  X  x k 9 x k 1  X  . Evaluating the recursive equation in Eq. (6) entails that p  X  x k 9 ^ y k  X  X  p  X  x 0  X 
However, these basic equations cannot be readily evaluated to An alternative way to solve this problem is to use a Particle Filter (PF) algorithm to conduct a stochastic simulation by drawing samples from the conditional PDF, which can then be used to consistently estimate the conditional expectation of any function of x k . A PF is a sequential Monte Carlo algorithm, i.e. a sampling method for approximating a distribution that makes use of its temporal structure ( Arulampalam et al., 2002 ). Without restric-tive linear Gaussian assumptions regarding the transition and Instead, it will be represented by using a collection of N weighted samples or particles, x  X  i  X  k , p  X  i  X  k p  X  x
Consider the integration that had to be performed at each filtering step: p  X  x
As before, this recursive definition can be used to compute the With a particle representation for p  X  x k 1 9 ^ y 0 : k 1 approximated as p  X  x
To create the  X  X  X ight X  X  set of particles to represent the distribu-importance sampler on this distribution. The technique of impor-tance sampling is a method for generating fair samples of a is difficult to draw samples, but for which it is easy to evaluate p ( x i ) for some particular x i . Then an approximation to p ( x ) can be given by p  X  x  X  where p  X  i  X   X  P  X  x  X 
Note that any distribution q (.), known as a proposal distribu-tion, can be used here. In particular, a uniform sampling of state space x could be used. However, with such a uniform sampling strategy, most samples will be wasted, having small p ( i )
Instead, a more direct proposal distribution can be used: an proposal distribution, the weights p ( i ) become relatively simple due to cancellation.

The PF consists of the following steps: 1. Draw N samples x  X  j  X  k from the proposal distribution q ( x x k q  X  x k  X  X  by selecting a random number r uniformly from [0, 1], choosing the corresponding particle i , and then sampling from model, but any model, from which samples can easily be drawn will suffice. 2. Set the weight p  X  i  X  k as the likelihood: p  X  k  X  p  X  ^ y k
The samples f x  X  j  X  k g above are fair samples from p  X  x
Re-weighting them in this fashion accounts for evidence ^ y 3. Normalize the weights f x  X  j  X  k g p  X 
The most important property of the PF is its ability to handle complex, multi-modal posterior distributions. However, it has difficulty when x k is high-dimensional as the number of particles
N required to adequately approximate the distribution grows exponentially with the dimensionality of the state space. 4. Case study
This section presents the application of the model in a real case, the  X  X  X rainage Water Tunnel Project X  X , located at Zhong-He,
Taipei, Taiwan. This project was constructed using the pipe jacking method. Pipe jacking is a trenchless method of tunnel construction whereby hydraulic jacks are used to push specially made pipes through the ground behind a tunnel-boring machine or shield. This technique has been commonly used to create tunnels under existing structures, such as roads or railways.
The actual tunnel length is over 1500 m. This example con-siders only 525 m from boreholes PB001 to PB016 as shown in
Fig. 3 . Two soil parameters  X  N value (SPT) and % clay content  X  are used as an example to describe geology classes along the tunnel line. In a Neural-HMM we can use any geological para-meter as a model input, depending on the on-site macroscopic geology conditions such as rock or soil, and the selected tunneling method. These parameters are chosen because pipe jacking productivity is mostly influenced by these two soil parameters is also formed based on the combination of these parameters ( Sutanto, 2008 ). In Fig. 3 , for example, an arrow indicates that borehole no. 5 (PB012) is located 126 m from the tunnel portal, and has soil properties: N value  X  6, Clay content  X  13.4%. It can be classified as geology class 3 ( GC (3) ). The  X  X  X ot X  X  indicates that this information is assumed unknown and will be predicted by the Neural-HMM model.

Over 200 historical core sample data around the location of the project were also collected. These data were used to train the neural network. Among the data points that were available, 80% were arbitrarily selected for training and the rest (20% of the data) were used for testing. The performances of the trained and testing networks are measured with the coefficient of determination ( R and standard error of network prediction (MSE) as shown in
Fig. 4 . It can be seen that R 2 for both training and testing networks shows a high accuracy rate (91.3% and 95.6%, respectively).
The model X  X  states are classified by using  X  X  X eology class X  X   X  GC
Table 1 , for example, shows that geology class 1, GC (1) from a combination of  X  X  X ow N value and Low % clay content X  X .
Observation data such as borehole core samples, which were obtained during the pre-construction phase, were discretized into 3 categories, Low , Medium ,and High as shown in Table 2 .
Tables 3 and 4 show the transition probability matrix ( p estimated likelihood matrix ( L jk ) for each geological parameter.
The data from 100 boreholes around the tunnel line were used to calculate p ij and c i with a 95% confident interval, while likelihood probabilities were derived from the judgments of an  X  X  X xpert X  X  geologist, based on the available site-specific information. Table 3 , for example, indicates that the probability that a geology class 1 structure will be followed by a geology class 2( P 12 )structureis0.45, and the average length over which the parameter GC (1) will remain probability that a borehole core sample would indicate N low that the geology class  X  1, P ( ^ y  X  N low 9 x  X  GC (1) )  X  0.85. 4.1. Prediction result Fig. 5 shows the model output, calculated and simulated using Eqs. (7) and (13) X (15), respectively. This output describes the states X  probability along the tunnel line. For example, an arrow mark indicates that 126 m from the tunnel X  X  portal the probability of 0.0%.

Based on the maximum probability of states (see Fig. 5 ), a geology class, GC ( i ) , along the tunnel line can be drawn as shown in Fig. 6 . Fig. 6 (a) shows the real on-site geological condition while Fig. 6 (b) and (c) shows geological information before and after the prediction, respectively. It can be seen that using the Neural-HMM model provides more detailed information to describe geological uncertainty.

The Hybrid Neural-HMM X  X  final outputs can be used directly as an input for other decision support systems such as scheduling. For instance, the model X  X  output, in the form of a probabilistic geology class profile, can be used to select appropriate drilling machines. Hence, based on the capacity of the selected machine, the expected duration and cost of the project can be estimated. 4.2. Validation and sensitivity analysis
To validate the model, this paper compared the Neural HMM X  X  prediction results with the results of previous models using the same case study data. In Table 5 , the  X  X  X riginal data X  X  represent the real site conditions used as a benchmark for validation.  X  X  X iscrete state Markov process X  X  ( Ioannou, 1987 ) and  X  X  X eal time Bayesian analysis X  X  ( Sutanto, 2008 ) are the previous models for which the results, in the form of geology class, are compared with the Neural-HMM algorithm. Because the model outputs are discrete, the model X  X  accuracy can be objectively calculated by comparing the model result with original benchmark data in terms of their class. It can be seen that the Neural-HMM achieves a satisfactory degree of accuracy.

This study also conducted a sensitivity analysis by changing the distance between prediction points to evaluate the robustness of the proposed model. The percentage prediction errors were recorded each time we tested the algorithm. The mean and the standard deviation of the errors were calculated after running the algorithm several times (see Table 6 ). Note that the model X  X  errors and variance increase 2 times after changing the point distance from 30 to 90 m. It indicates that the model is quite sensitive to the distance between prediction points due to changes in the transition probability matrix (see Eq. (2)). 5. Conclusions and future directions
The proposed model, the Neural-HMM, develops a description of local geology that reflects the uncertainty of the information on which it is based and can therefore help to reduce the risk in underground tunnel construction. Results from the case study show that the Neural-HMM successfully formalizes and expedites
B1 B2 B3 B4 B5 B6 B7 B8 B9 B10 B11 B12 B13 B14 B15 B16
B1 B4 B7 B10 B13 B16 the prediction procedure. The model can accurately predict a geological description that reflects ground uncertainty. The accu-racy of the model is improved because the calculation of posterior probability is not only evaluated from a prior PDF of states but also updated by observation data given by the neural network. Another advantage of this model is that the final result of the Neural-HMM  X  in the form of a probabilistic geology class profile  X  can be used directly as an input for other decision support systems, such as scheduling, to increase the value of information available to decision makers.

This model is under development and needs further modifica-tion to enhance its features. Firstly, various types of tunnel projects should be extensively analyzed and compared using different geological parameters to determine the appropriateness of applying the Neural-HMM model. Secondly, complex geological conditions such as extreme spatial conditions inside the tunnel line, which can cause difficulties and delays in the construction process, need to be taken into consideration in the model. This paper will provide the motivations for some of this work. References
