 Maintenance spare part[10,18] (hereafter r eferred to as spare part) is ubiquitous in mod-ern societies. Its demand arises whenever a component fails or requires replacement in the equipment. Whether a spare part deman d arises is totally decided by whether a component fails in the equipment. Meanwhile, an occurrence of the component failure is directly related with the working condition of the equipment. Effective prediction for the spare part demand can give strong suppor t to maintenance activities of the equip-ment in time, and also reduce the capita l for spare part inventory[18].

Most of the previous studies on the spare part demand prediction methods forecast spare part demands[2,3,14] mainly accordin g to the historical spare part demands, be-cause the working condition of equipment is difficult to grasp in the past. However, with the rapid development of the Internet of Things [5,17] technology, condition monitoring systems, e.g. KOMTRAX 1 and IEM 2 have been widely applied to monitor the working condition of equipment. A large variety of monitor data are generated simultaneously, which can help us better understand the wor king condition of equipment. Combining monitor data generated in the equipment, it can improve the prediction of spare part demands efficiently.

However, combining monitor data for spar e part demand prediction faces three main challenges. 1) Huge monitor data volume. As the sensor technology is becoming ubiqui-tous, increasing numbers of sensors are installed in the equipment to monitor the work-ing condition of different components thereof . For example, the volume of monitor data generated by the condition monitoring system IEM exceeds 30 GB in a workday, and the count is still growing. 2) Data sparseness. The working circumstances of equipment are unforeseen. There are a variety of unforeseen issues, e.g. illegal operations and ad-verse working circumstances, which prevent or affect the production of monitor data. Consequently, the data sparseness problem exists in the monitor data. 3) From monitor data to spare part demand. Although the spare parts demand is decided by the work-ing condition of equipment, the working c ondition of equipment depends on multiple factors, such as working time, working strength and the number of equipment, as well as weather conditions of working places. Unf ortunately, it is not easy to obtain enough training data to learn the mapping between working conditions and these factors. Hence, we can not simply use monitor data as a training set to learn the mapping.

Given the aforementioned challenges, existing methods for forecasting the spare part demand do not work well. In this paper, we propose a Spare Part Demand (SPD) model based on a context-aware matrix factorization approach. The SPD model takes not only historical spare part demands but also monitor data into consideration. Next, we use a context-aware matrix factor ization method to forecast the real spare part demands, and to tackle the data sparsity problem as well. In order to validate our proposed method, we conduct experiments on the real world data sets. The experimental results show that, our method outperforms the conventional methods when combining a large amount of monitor data.

Our work presents a context-aware matrix factorization method for spare part de-mand prediction, taking monitor data into consideration as well. Our main contributions are shown as follows:  X  We infer the spare part demand for multiple regions simultaneously, using a model  X  We apply a context-aware matrix factorization method for the SPD model infer- X  We evaluate the effectiveness and efficiency of our method by conducting extensive The rest of the paper is organized as follows. After reviewing related work in Section 2, Section 3 overviews our method. We detail the methodology in Section 4 and evaluate our approach in Section 5. Finally, we conclude this paper in Section 6. The spare part mainly consist of two types: productive spare part and maintenance spare part. The former spare part is used in the manufacturing phase of the equipment, and the latter one is used in the maintenance phase of the equipment. In this paper, we mainly talk about the maintenance spare part (hereafter referred to as spare part). 2.1 Spare Part Prediction Illustrated in Figure 1, the spare part demand prediction[1,18,20] (also called spare part forecasting in the literature) mainly contains two types: initial spare part demand predic-tion and subsequent spare part demand prediction. The initial spare part demand predic-tion methods forecast the spare part demand acco rding to different maintenance strate-gies from the beginning. As the initial spa re pare prediction methods lack of enough data, they mainly forecast the spare part demand using reliability model[2,6,9,19]. The subsequent spare part prediction[18] (also called mixture spare part demand prediction) mainly forecast the spare part demand accord ing the historical demand and other in-formation, which consists of four types of m ethods in the literature: time series based, regression analysis, exponential smoothing and others.
  X  Time series based methods[15,16] forecast the spare part demand according to the  X  Regression analysis[7,11] finds the relation between the spare part demands and  X  Exponential smoothing[8] is a specific technique that can be applied to the histori- X  Other methods, such as neural network[4], take the historical spare part demands 2.2 Matrix Factorization In a framework of collaborative filtering, a mat rix of observed matrix is represented as X  X  R n  X  m . The matrix factorization technology[12,13] aims to factorize the matrix of observed values X into two matrices Y  X  R n  X  d and Z  X  R m  X  d such that X := YZ T approximates X as much as possible. In most cases, the regular processing methods is to define and minimize a loss function L ( X : X ) between observed and predicted values, to get the optimal results, as well as tackling the data sparsity problem. In this section, we first give some definitions to help the readers better understand the problem settings.
 Definition 1 (Preparation cycle). An preparation cycle is a time period, that is used to count the spare part demand and to manufacture the spare part.
 The preparation cycle of the spare part is us ually determined by the manufacturers, e.g. the preparation cycle is set to ten days in our experiment. The setting of preparation cycle reflects manufacturing and management techniques of the spare parts, which are beyond the scope of this paper. In this pape r, we make a reasonable assumption that the manufacturer is able to manufacture enough spare parts to satisfy all kinds of spare part prediction demands.
 Definition 2 (Monitor data series). A monitor data series is a sequence of data points, sampled and captured by a sensor typically at successive points over a preparation cycle of the equipment.
 A monitor data series is akin to a time series, which reflects the working condition of one component in the equipment. As a monitor data series is corresponding to a sensor (one component of the equipment), we can combine a group of different monitor data series together to represent the working condition of the equipment approximately, which is closely related with the spare part demand in the same preparation cycle. Definition 3 (Region characteristics). The region characteristics of the equipment reflects the geographic position characteristics in the working place of the equipment, e.g., the altitude.
 The spare part demands of different regions ar e totally different, because different num-bers of the equipment have different working conditions in the different regions. Mean-while, the working condition of the equipment is also affected by the real region charac-teristics. Take the concrete pump truck as an example, the wear degree of the concrete pump truck in the high altitude is larger in a pumping concrete, as compared with that in the low altitude. In the real cases, the region characteristics consist of the weather characteristics, the number of equipment and so on. 4.1 Spare Part Demand Prediction Problem Generally speaking, the answers to the two following questions in the spare part demand prediction are essential: 1. how often is the spare part demand checked? 2. how many spare parts are ordered in the next cycle? The first question is to determine the order cycle of spare parts and the statistical cycle of parts that need replacement. As we analyzed before, the determination of the prepa-ration cycle is related with the manufactur e of the spare part, which exceeds the scope of this paper. This paper focuses on the second question, which is to forecast the real spare part demands in the present prepara tion cycle, with the help of historical spare part demands and monitor data collected in the equipment.

Figure 2 shows the all the related factors in the spare part demand prediction. For one part of the equipment in the present prepara tion cycle, the spare part demand is related with working conditions and region charact eristics for all the pieces of the equipment. The working conditions are approximately reflected by the monitor data series gen-erated in the equipment. The region characteristics consists of altitude characteristics, weather conditions and so on. Meanwhile, the spare part demand in the present prepa-ration cycle is also related with the historical spare part demands and historical working conditions. The previous spare part demands reflect the variation of spare part demands in the previous preparation cycles, and the historical working conditions reflect the us-age of the equipment in the previous preparation cycle. 4.2 The SPD Model Let M 1 ,M 2 , ..., M K represent K monitor data series, which are used to reflect the working conditions of the equipment in the r th ( r =1 , ..., R ) region. Suppose that there are T preparation cycles and the present preparation cycle is the T th preparation cycle.
 Definition 4 (Working condition matrix). A working condition matrix, denoted as M  X  R R  X  T  X  K , is a three dimensional matrix. Its element m r  X  t  X  k represents the characteristics of the k th monitor data series for the r th region in the t th preparation cycle.

In the real cases, the element m r  X  t  X  k consists of two characteristics for the k th monitor data series for convenience X  X he average value and the standard deviation of all sampled values in the r th region. Because there exist some missing monitor data series for some regions, therefore the working condition matrix is actually sparse.
For one spare part, its spare part demand is a lso affected by its historical spare part demands. Hence, we can use a spare part demand matrix to represent the variation of historical spare part demands.
 Definition 5 (Spare part demand matrix). A spare part demand matrix, denoted as C  X  R R  X  T , is a two dimensional matrix. Its element c r  X  t represents the real amount of the spare part for the r th region in the t th preparation cycle. The element c r  X  T which represents the prediction of the spare part demand for the r th region in the T th preparation cycle.

To sum up, these spare part demand related factors, such as working conditions, are variables that are varying with time, or with regions, or with both time and regions. As shown in Figure 3, we can use two matrices X  X reparation cycle dimensional matrix and region dimensional matrix, to represent spare part demand related factors respectively. Definition 6 (Preparation cycle dimensional matrix). A preparation cycle dimen-sional matrix , denoted as Y := [  X  M  X  C ]  X  R ( K +1)  X  T , is a two dimensional matrix, 1 , ..., T ) represents the characteristics of the k th monitor data series in the t th prepa-ration cycle. The element y ( K +1)  X  t in the last row represents the average spare part demands for all the regions in the t th preparation cycle.

The preparation cycle dimensional matri x summarizes all the time-dependent fac-tors, which contains the monitor data serie s and historical spare part demands. Mean-while, element y k  X  t ( k =1 , ..., K ; t =1 , ..., T ) is calculated from the aggregation of the working condition matrix. Hence, the characteristics also consist of the average and the standard deviation of all the k th monitor data series in the t th preparation cycle. Definition 7 (Region dimensional matrix). A region dimensional matrix , denoted as Z := [  X  M  X  D  X  C ]  X  R ( K + D +1)  X  R , is a two dimensional matrix, where  X  M = represents the characteristics of the k th monitor data series in the r th region. The el-the r th region. The element y ( K + D +1)  X  r in the last row of the region dimensional ma-trix represents the average spare part demands for all the previous preparation cycles in the r th region.

The region dimensional matrix summarizes all the region-dependent factors, which contains the monitor data series, region char acteristics and historical spare part demands in the regions. Meanwhile, element y k  X  r ( k =1 , ..., K ; r =1 , ..., R ) is calculated from the aggregation of the working condition matrix. Hence, the characteristics also consist of the average and the standard deviation of all the k th monitor data series for all the previous preparation cycles in the r th region. The region dimensional matrix  X  D also contains D region characteristics for each region, e.g. the altitude, the number of the equipment and the weather condition. 4.3 The Inference of SPD Model As illustrated in Figure 3, we formulate the preparation cycle dimensional matrix Y and the region dimensional matrix Z , which recode the related factors from the time dimension and from the region dimension respectively.  X  M  X  R T  X  K and  X  M  X  R R  X  K are both matrices built based on the working condition matrix M , which represents the working conditions for all the regions in all the preparation cycles.  X  C  X  R T  X  1 and  X  C  X  R R  X  1 are also matrices built based on the spare part demand matrix C .  X  D  X  R R  X  D represents the region characteristics matri x. Specially, all the matrices are sparse as we analyzed before, and the last column of the matrix C is the target of the prediction. Given the above settings, the inference can be converted into filling the missing values in the the matrices Y , Z and C , with the help of the existing values in the matrices.
Actually, we can achieve this goal through solely factorizing the matrix C into the product of two low-rank matrices based on the existing entries in the matrix C .How-ever, in the real cases, the spare part demand matrix C does not have enough existing entries due to the data sparsity problem, especially as well as the last column is miss-ing. In order to tackle this problem, we incorporate another two matrices Y and Z . Intuitively,  X  M and  X  M represent the working conditions, and  X  C and  X  C represent his-torical spare part demands. Putting Y together with Z reveals the relation between the related factors and the spare part demand in the present preparation cycle. As a result, the formulation of Y and Z can help factorize the matrix C .
 Precisely, we can factorize the three matrices C , Y and Z as follows: where T , W , R and F are all low-rank matrices representing latent factors. Y and C share the latent factor T . Z and C share the latent factor R . The collaborative Algorithm 1. Illustration for the inference of the SPD model factorization of C , Y and Z improves the accuracy of the approximation, as compared with the sole factorization of C . After the factorization, we can recover the spare part demand matrix C through the product of R and T . In order to optimize the above fac-torization, we define a loss function L ( T , W , R , F ) as an objective function as shown in the following Formula.
 where  X  denotes the Frobenius norm 3 . The first three terms in the objective function manage the loss in matrix factorization, and the last term controls the regularization over the factorized matrices so as to prev ent over-fitting. The parameters  X  1 ,  X  2 and  X  3 are artificially set according to the real experi mental cases. Hence, we have the gradients of the objective function for each matrix as follows:
However, we can find that, the objective function is not jointly convex for all the four matrices T , W , R and F . Hence, we cannot get closed-form solutions to minimize the objective function. As a consequence, we can get the approximate optimal solutions by iteratively minimizing the objective functio n according to the gradient descent of the four matrices. Finally, we can get the complete spare part demand matrix through the product of R and T . The last column of the spare part demand matrix is the prediction result of the spare part. The details are shown in Algorithm 1. We conducted the experiments on a real-world data set from a Chinese well-known construction machinery manufactur er. The data set, collected from R =30 regions, consists of two parts: the spare demands of one main component for more than 10 , 000 concrete pump trucks 4 in the previous successive 9 months (a preparation cycle is set to ten days), and K =10 categories of monitor data series collected from more than 1 , 000 in the successive 9 months. Meanwhile, we collected D =3 region characteristics for each region, which represent the average altitude, the number of concrete pump trucks and the average temperature of each region respectively. 5.1 Baselines In the experiments, we evaluated four groups of experiments, which used the data set in 9 months ( T =27 ).  X  Exponential Smoothing ( ES ) just uses the spare demands data of T  X  1 preparation  X  Moving Average ( MA ) uses the spare demands data of the last 3 preparation  X  Regression Analysis ( RA ) takes monitor data series together as the independent  X  Matrix Factorization ( MF ) takes both spare demands data and monitor data into 5.2 Evaluation Metrics The evaluation metrics of the spare part prediction consists of two parts: the evalua-tion of the accuracy for the prediction and the s pare part satisfied rate. The first metric reflects the real prediction ability for each method. In the real cases, we use the coef-ficient of variation ( CoV , denoted as V ) between the real spare demands c r  X  T and the prediction spare demands c r  X  T in all the regions to evaluate the accuracy. The CoV is the rate between the mean square error between and the average of the real spare demands. The less the CoV , the better the accuracy of the prediction. The second metric is the spare part satisfied rate ( SPR , denoted as S ), which is the rate between the prediction spare demands and the real spare demands.
 If the SPR is closer to 100% , the prediction is better. Meanwhile, the prediction with more than 100% SPR is better than the prediction with less than 100% SPR . 5.3 Experimental Results Table 1 shows the detailed statistics for the real and four prediction spare part demands in the T th =30 th preparation cycle. As the evaluation metrics shown in Figure 4, MF consistently outperforms the other approaches for all the metrics, demonstrating the importance and effectiveness of combining historical spare part demands and monitor data together to forecast the future spare part demands.

As illustrated in Figure 4, the CoV s for the prediction methods ES , MA , RA and MF ES , MA , RA and MF are 1 . 481 , 1 . 501 , 1 . 840 and 1 . 418 respectively. As the prediction results of ES and MA totally rely on the previous spare part demands, the prediction results may have significant fluctuations wh en the spare part demands changes greatly, such as the spare part demands in 2 th region as shown in Figure 4. Conversely, RA and MF have less significant fluctuations when th e spare part demands changes greatly, because they both takes the working conditi ons of equipment into consideration, such as the spare part demands in 5 th region as shown in Figure 4. Although RA and MF have approximate CoV s, the SPR of MF is much less than that of RA . The reason is that, although RA and MF both takes monitor data series into consideration, RA can not deal with the data sparsity problem. Hence, RA does not take enough monitor data series to fit the regression model, which makes the SPR of RA is much larger than that of the other methods. 5.4 Discussion Because all the experiment al methods forecast the spare part demands much or less according to the historical spare part demands , the performance of the prediction results will improve when more historical data ( 9 months X  historical data in the experiment) are used to train the model, especially RA and MF . When the period of the preparation cycle shortens, the spare part prediction will rely more on the monitor data and less on the historical data, because the spare part demands become more intermittent and more lumpy in a shorter preparation cycle. If so, MF will have a better performance as compared with the other methods. Especially, MF is even able to forecast the spare part demands per day or per hour, if enough monitor data are collected in the equipment. Accurate and efficient spare part demand prediction is important to the manufacturer. In this paper, we proposed a SPD model based on a context-aware matrix factorization ap-proach, which combines the h istorical spare part demands and monitor data together to forecast the spare part demand, and tackles the data sparsity problem in the framework of collaborative filtering as well. Our approach has promising performance in experi-mental studies, which leads us to conclude that our proposed SPD can indeed improve the spare part demand prediction in the real cases. Our future work will include opti-mization of the SPD model, selection of more factors and extensive applications of the SPD model.

