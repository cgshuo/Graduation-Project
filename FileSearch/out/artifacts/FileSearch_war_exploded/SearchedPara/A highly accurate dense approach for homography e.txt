 1. Introduction
In computer vision, the term homography is used to describe the relationship between two images of a 3D plane or two images captured from the same location ( Hartley and Zisserman, 2004 ).
Speci fi cally, the homography matrix is a reversible 3 3 matrix, which maps image points on one image plane to the other one.
One reason that homography estimation has drawn great attention from researchers is that the homography is ubiquitous in practice and it is useful for numerous applications such as camera calibra-1998 ), 3D reconstruction ( Kanatani and Niitsuma, 2010 ), image mosaicing ( Szeliski and Shum, 1997 ), and tracking applications ( Carloni et al., 2004 ). For example, given an image of a scene with projective distortion, metric recti fi cation can be used to get the fronto-parallel view of it, which leads to a number of practical and smart applications involving projector display ( Raskar and Beardsley, 2001 ; Sukthankar et al., 2001 ; Brown et al., 2005 ).
As for planar target tracking, since the homography between two images can be used to infer the transformation between planes, the target can thus be followed even when it is partially or fully occluded ( Agarwal et al., 2005 ).

As a crucial stage in numerous real-world applications invol-ving multi-view geometry, homography estimation has been widely studied for decades in computer vision community ( Hartley and Zisserman, 2004 ). Most existing algorithms exploit sparse information such as points, lines, conics and curves in the image to calculate homography ( Agarwal et al., 2005 ). While this type of methods is well-established and ef fi cient ( Claybrough and Defay, 2012 ; Marquez-Neila et al., 2013 ; Seo et al., 2013 ), it is case dense approach exploiting the information of the whole image is desired. In this paper, homography estimation is recast as an optimization problem, which is solved by a minimization framework based on modi fi ed differential evolution (DE) ( Price et al., 2005 ) with new acceleration strategies. The new method is able to account for both the color and gradient information in the whole image, thus generates homography estimate with higher accuracy.

The rest of this paper is organized as follows. In Section 2 ,we give a brief review of previous work on existing algorithms for estimating homography. Section 3 presents the preliminaries and notations used in this paper. In Section 4 , the two key components of our proposed approach including problem formulation and minimization procedure are presented in detail. In Section 5 , the performance of our method is evaluated qualitatively and quanti-tatively using synthetically rendered images. Two real-world applications (occlusion removal and image mosaicing) are also presented to verify the applicability of our method. Finally, the conclusion as well as future work is presented in Section 6 . 2. Related work
In the literature, researchers have proposed numerous tech-niques for homography estimation, which can be roughly classi-fi ed into two categories: feature based methods and featureless methods. A brief review is given in the following.

The most widely used and successful feature based method for homography estimation is the direct linear transformation (DLT) algorithm which requires only four point correspondences and minimizes the algebraic error ( Hartley and Zisserman, 2004 ).
In practice, tentative point correspondences are usually contami-nated with outliers, and a robust homography estimate is required ( Moisan et al., 2012 ). The accuracy of the homography estimated by DLT algorithm can be further improved by minimizing geo-metric error using the iterative gold-standard (GS) method itera-tively ( Hartley and Zisserman, 2004 ), which generates an optimal estimation in the sense of minimizing the reprojection errors.
Recently, research ( Niitsuma et al., 2010 ) shows that high accuracy in homography estimation can also be achieved by algorithms without iterations, especially when image data are corrupted by large amount of noise. In addition to point features, line features have also been exploited for the computation of homography ( Murino et al., 2002 ). Although feature based homography estima-tion methods are well studied, the accuracy of the estimated homography not only depends on the feature detectors ( Moller and Posch, 2009 ) but also on the spatial distribution of sparse features ( Bostanci et al., 2012 ). Moreover, feature based method may not be applicable when such sparse features are not available in some cases (e.g., textureless man-made objects).

Unlike feature based methods, featureless homography estima-tion methods aim to get a global estimate based on information of the whole image. Cordes et al. (2011) propose to use differential evolution (DE), which is a simple yet powerful evolutionary numerical optimizer ( Price et al., 2005 ), to minimize a new featureless cost function for homography estimation. The authors demonstrate experimentally that the dense approach is able to improve the accuracy of homography estimation and allows to construct more reliable feature evaluation benchmarks. There are two limitations of the above work: the gradient information of image is not considered in the problem formulation, thus it is not robust to illumination change; the use of the original DE framework leads to low computational ef fi ciency. Guerreiro and
Aguiar (2006) propose a hybrid method for homography estima-tion, which splits one image into four blocks and fi nds their correspondences in the other image using standard correlation techniques, from which a homography estimate is obtained. The fi rst image is then transformed according to the estimated homo-graphy and the whole procedure is repeated until the transformed image coincides with the second one. The above method combines the feature based simplicity and the featureless robustness.
Unfortunately, no quantitative evaluation and comparison of accuracy are given in Guerreiro and Aguiar (2006) .
 et al. (2011) and makes improvements on its robustness and ef fi ciency. We propose to solve the homography estimation problem by minimizing a two-objective function within a mod-i fi ed DE framework with integrated acceleration strategies. In fact, evolutionary algorithms (EAs) have been successfully applied to a variety of applications in image processing ( Shimodaira, 2000 ), in which global optimization is usually demanded. In particular, Falco et al. (2007) present an approach for satellite image registration by distributed differential evolution, and Cuevas et al. (2013) propose a new algorithm based on differential evolution to reduce the number of search locations in the block-matching (BM) process for motion estimation. Recent studies also demonstrate the applic-ability of DE to computer vision tasks such as camera calibration and metric 3D reconstruction ( de la Fraga and Silva, 2008 ; delaFraga and Sch X tze, 2009 ; Kang et al., 2012 , 2013 ). 3. Preliminaries and notations theoretical background and the notations used in this paper. More details on multi-view geometry and differential evolution can be found in Hartley and Zisserman (2004) and Price et al. (2005) , respectively. 3.1. Homography images. Throughout this paper, both x ( x  X  ) and X are represented by homogeneous coordinates ( Hartley and Zisserman, 2004 ).
Without loss of generality, the fi rst camera is aligned to the world coordinate, i.e., the rotation matrix and the translation vector of the fi rst camera become a 3 3 identity matrix I and a 3 1 zero vector 0 , respectively. Thus the camera projection process for the two cameras can be written as x C
K  X  I j 0 X  X  1  X  and x  X  C K  X   X  R j t X :  X  2  X 
Here, K and K  X  are the 3 3 calibration matrices of the two cameras, R the 3 3 relative camera rotation matrix, t the 3 1 translation vector between the two cameras, and the notation
C means equality up to scale ( Hartley and Zisserman, 2004 ).
Planar homography : The fi rst type of homography is induced by planar scene. As shown in Fig. 1 (a), let L be the light ray back-projected from the image point x . According to Eq. (1) ,any3D point
X  X  X  X  K 1 x  X  &gt; ;  X   X  &gt;  X  3  X  lies on L projects to x . Assume that the 3D point X is on a plane  X  X  v &gt; ; 1  X  &gt; , it follows that
X  X  0 ) X  X  X  X  K 1 x  X  &gt; ; v &gt; K 1 x  X  &gt; ;  X  4  X  which determines  X   X  v &gt; K 1 x for the scene point X corre-sponds to x . Projecting X onto the second image according to
Eq. (2) , we get x  X  C K  X   X  R j t  X  X  K 1 x  X  &gt; ; v &gt; K 1 x  X  &gt; C K  X  RK 1 x K  X  tv &gt; K 1 x
C  X  K  X  R K  X  tv &gt;  X  K 1 x :  X  5  X  Thus the planar homography H relates x  X  and x by x  X  C Hx with H  X  X  K  X  R K  X  tv &gt;  X  K 1 :  X  6  X 
Rotational homography : The other common type of homogra-phy is induced while camera is rotated about its optical center without translational motion (i.e., t  X  0 ). According to Eqs. (1) and (2) , the projection of X results in (see Fig. 1 (b)) x  X  C K  X   X  R j 0 X C K  X  RK 1 K  X  I j 0 X C K  X  RK 1 x :  X  7  X  Thus the rotational homography relates x  X  and x by x  X  C H  X  K  X  RK 1 :  X  8  X 
In both cases, the homography H corresponds to a 3 3 matrix de fi ned only up to scale, thus it has eight degrees of freedom.
Since each corresponding image point gives two independent linear constraints on H by x  X  C Hx , a minimal set of four image point correspondence is suf fi cient to compute H . 3.2. Differential evolution
Differential evolution (DE) is a simple yet powerful versatile global optimization technique ( Price et al., 2005 ). Similar to many other evolutionary algorithms, DE maintains a population of
N real-valued parameter vectors. N p new trial vectors are gener-ated from the perturbation of points in the current generation.
In particular, scaled difference of two randomly selected trial vectors is used in the mutation, and the i -th new trial vector at the g -th generation (denoted as  X  i ; g ) is generated by
Z  X  F
A  X  0 ; 1  X  is a positive scale factor controlling the rate of evolution.
The new trial vector is further perturbed via crossover and then competes against the population vector of the same index, and the vector with a large fi tness value survives in the next generation.
According to different schema of mutation and crossover opera-tions adopted in DE, several variants of DE have been proposed, calculation of fi tness of a trial vector is called individual evalua-tion, which is a problem dependent process. The evolutionary cycle terminates when some criteria are met, e.g., the prede tolerance between the obtained value and the known globally optimal value, or the maximum number of generations has been reached. 4. Proposed approach 4.1. Problem formulation
In order to utilize DE framework for homography estimation, two essential issues should be addressed. The fi rst issue is the parameterization of homography and the second one is the evaluation of trial vector. Recall that the homography H is a 3 3 matrix de fi ned only up to scale, thus it can be characterized by eight parameters. In this paper, a parameter vector is transferred into the corresponding H by H  X 
 X   X  X  Ideally, assume that the ground truth homography is known, then the cost function  X  should be zero. Here, I  X  X  is a 3-vector consisting of the RGB value at a given pixel location, J J 2 denotes the Euclidean norm, and O is a region consisting of image points in the fi rst image which are also visible in the second image. Thus a natural way for evaluating a given trial vector  X  is to calculate the error term: J where w x is a binary variable determined by w Note that the coordinates of H  X   X   X  x would not be integers in most neighborhoods of H  X   X   X  x for example by bilinear image inter-polation.

The above individual evaluation depends only on the color of image, which may vary due to the change of viewpoint and illumination conditions. In order to compensate for such changes to some extent, we take into account the gradient information of image as many optical fl ow estimation algorithms do ( Brox et al., 2004 ). Denote by  X  I  X  X  the 2-vector consisting of the gradient value in horizontal and vertical direction in the image I at x , we get the following error term: J Combining the two error terms for image color and gradient, the fi tness of a trial vector is determined by the following cost function: J where  X  4 0 is a regularization parameter.

In this paper, sparse feature point correspondences extracted from images, which we call sparse control points (SCPs), are used to reduce the search space and guide the search procedure. Denote spondences, we de fi ne another cost function J scp for a given trial vector  X  as
J
In the above equation, med fg denotes the median operation, which is able to accommodate up to 50% outliers in SCPs. The error term e  X 
 X  ; x is the geometric error of a point correspondence x i 2 x  X  trial vector  X  . It is noteworthy that J scp becomes to zero as soon as the median value of all geometric errors is below a threshold
T scp , because J scp is used only for reducing search space rather than minimizing it in our approach. Finally, the homography estimation problem is recast as a two-objective minimization problem, in which the cost function J scp has higher priority than
J 4.2. Minimization based on modi fi ed DE
According to the homography parameterization and individual evaluation method presented in Section 4.1 , a simple way for homography estimation is to search the best trial vector minimiz-ing the cost function J img de fi ned in Eq. (16) using DE. However, such straightforward strategy has been shown previously to be very computationally expensive due to the large amount of dense information involved (the experimental results presented in
Cordes et al. (2011) suggest that DE requires about 2 h to converge for an image pair with 800 640 pixels on a common PC). In this section, we present two effective ways to speed up the minimiza-tion procedure. 4.2.1. Pre-evaluation test for vector rejection The search space of the optimization problem constructed in
Section 4.1 is a 8-dimensional continuous space. In order to improve the ef fi ciency of the search in such a huge search space, we employ a fast pre-evaluation test to discard invalid trial vector before calculating its fi tness, which leads to superior performance by avoiding searching solutions in invalid regions.

Recall that homography is essentially a 2D projective transfor-mation, which preserves concurrency, collinearity, and cross ratio ( Hartley and Zisserman, 2004 ). Since images considered in this paper are of rectangular shape, it is easy to verify that the homography between two images maps the rectangular boundary
S of the fi rst image to a convex quadrilateral (denoted as the second image. Given a homography H , the intersection between two convex quadrilaterals (the rectangular boundary of the second image and the transformed boundary S  X  a ) can be ,
S  X  X  a \ S b  X   X  indicates an impossible solution, which leads to a simple and fast way for invalid homography rejection at an early stage.

In population initialization, the range of each element of trial vector is empirically chosen as 10 times to 10 times that of the value estimated using robust DLT algorithm ( Hartley and
Zisserman, 2004 ). For each trial vector in the fi rst generation, random initialization is performed repeatedly until it passes the pre-evaluation test. Moreover, the pre-evaluation is also integrated into the evolutionary cycle. Speci fi cally, pre-evaluation test is conducted before each individual evaluation. For a given trial vector, if the pre-evaluation test fails, the value of its objective functions is immediately set to a suf fi ciently large number without going through the subsequent computation. 4.2.2. Coarse-to-fi ne search scheme (C2F) search scheme is incorporated into our framework. The C2F search is a frequently used multiscale approach for improving the performance of optical fl ow estimation, which starts with solving a coarse version of the problem by working on smoothed images ( Memin and Perez, 2002 ). In our algorithm implementation, C2F search is realized by using decreasing sampling intervals when extracting a set of images with different scale.
 and the last generation ( g  X  G )is fi xed to  X  s and  X  t in our framework is controlled by  X   X  g  X  X 
In the above equation, G c A  X  1 ; G and  X  4 0 are two constant parameters, and  X  denotes the best trial vector found so far.
According to Eq. (19) , the search interval changes from  X  the number of generation increases. As will be shown in the experimental results, the incorporation of pre-evaluation test for vector rejection and C2F search scheme in the evolution can signi fi cantly improve the computational ef fi ciency of dense homo-graphy estimation. 4.2.3. Our dense approach for homography estimation approach for homography estimation is described in Algorithm 1 .
Algorithm 1. Dense homography estimation based on modi fi DE algorithm.
 Input : Two images related by homography.
 Output : Homography between the two images.
 Extract and match sparse point features in the two images;
Estimate homography based on point correspondences using robust DLT algorithm; Extract sparse control points; Setup parameters for DE, individual evaluation and  X  control; Generate the initial population f  X  i ; 0 ; 0 r i r N p 1 g ;
Update the best trial vector  X  0 and let 0  X  g ; while g o G do
Calculate the current search interval  X   X  g  X  ; for i  X  1to N p do
Generate new trial vector Z i ; g by DE = best = 1 = bin scheme if Z i ; g passes pre evaluation test then Calculate cost functions J scp  X  Z i ; g  X  ; J img  X  Z i ; g  X 
 X  ; end else end end else end end Update the best trial vector  X  g found so far ;
Let g  X  1  X  g ; end Output the homography H  X   X  G  X  5. Experimental results
In order to evaluate the performance of our proposed method, we implemented the algorithms using C  X  X  and carried out extensive experiments using both synthetic data and real images.
Throughout the experiments, point feature correspondences between two images are established by matching the fully af invariant image features ASIFT proposed in Morel and Yu (2009) . In our proposed framework, the initial homography estimate and
SCPs are obtained by running RANSAC (the threshold for outlier rejection is set to 8 pixels) with DLT homography estimation algorithm. All the experiments were carried out on a common
PC with 2.53 GHz Intel Dual Core processor and 2 GB of RAM running 32-bit Windows 7 operating system.
 parameters in our optimization framework. Throughout our experiments, parameters are fi xed for our approach. In particular, the DE settings are empirically chosen as follows: the size of population N p  X  60; the maximum number of generations G  X  300; the scale factor in mutation F  X  0.98; and the crossover rate
CR  X  1.0. The parameters for  X  search control is as follows: the initial search interval  X  s  X  10 pixels; the fi nal search interval  X  1 pixel; and the two adapting parameters G c  X  0 : 9 n G In addition, the regularization parameter  X  in the cost function
J de fi ned in Eq. (16) is set to 15, and the threshold T scp slightly different parameter settings (e.g., up to 10% difference) do not have noticeable in fl uence on the performance of our proposed method.

Error metrics : For synthetic data sets with ground truth, two error metrics are examined to assess the accuracy of homography estimation algorithm quantitatively. The fi rst error metric E calculated as the sum of the absolute values of the elements of the matrix H gt H est , where H gt and H est denote the ground truth homography and the estimated homography, respectively. The other metric is the root mean square (rms) geometrical mapping mapping error at a given pixel x is calculated as where  X  3 represents the third element of a vector.

In the following, we present both qualitative and quantitative evaluation of our proposed framework in Section 5.1 and then demonstrate the applicability of the new method by presenting results and comparison in two real-world applications involving homography estimation. 5.1. Synthetically rendered images
Using synthetically rendered images to test the performance of computer vision algorithms has many advantages, e.g., the ground truth camera parameters and scene structure are available for quantitative evaluation, and the synthetic image is realistic thus can provide an alternative way to evaluate the practical perfor-mance of algorithms extensively. In this experiment, we use a publicly available ray tracer POVRay ( http://www.povray.org )to generate photorealistic images with 1024 768 pixels (see Fig. 3 ). In order to evaluate the in fl uence of viewpoint and illumination change on the performance of our proposed method, we generate images under different illumination conditions and with wide base-line. In the following, we present experimental results of homography estimation for the two images in Fig. 3 (a) and (b) (denoted as SD a ), the two images in Fig. 3 (a) and (c) (denoted as SD b ), and the two images in Fig. 3 (a) and (d) (denoted as SD
Experimental comparison has been made with two most successful feature point based homography estimation methods and the featureless method proposed in Cordes et al. (2011) .For the comparative feature based methods, one uses DLT to minimize the algebraic error and the other one uses gold-standard (GS) algorithm to iteratively minimize the geometric error. In order to get robust homography estimate, a threshold T H is speci fi outlier rejection in the RANSAC scheme. Detailed comparison of the accuracy of homography estimation for image pairs SD a SD b is summarized in Table 1 . For image pairs SD a and SD b noticeable difference in accuracy between the results of our method and that of the method proposed in Cordes et al. (2011) is observed (thus is omitted from Table 1 ). This is because the objective function is essentially the same in the case of no illumination changes. The experimental results for SD c are also not included in Table 1 because both the DLT and GS methods fail even when using a T H as large as 8.0 pixels (rms E P projection error is larger than 13 pixels). In this challenge case, the results of our method are E H  X  0.7819 pixels and rms E P  X  0 : 3870 pixels, the results of the method proposed in Cordes et al. (2011) are E  X  1.3218 pixels and rms E P  X  1 : 0652 pixels. From the above com-parison, it is easy to see that (1) the accuracy of both DLT and GS algorithms depends on the choice of threshold for outlier rejec-tion; (2) the accuracy of both DLT and GS algorithms decreases for wide base-line images due to low accuracy of feature point localization; (3) for image pair without illumination changes, our proposed method and the method described in Cordes et al. (2011) achieve similar accuracy; and (4) our proposed method achieves higher accuracy than the method described in Cordes et al. (2011) for image pair with wide base-line and global illumination change.
To facilitate qualitative evaluation, we present some results of visualization of errors in homography mapping in Fig. 4 , where the images in the left column are the results of DLT method, the images in the middle column are the results of GS method and the images in the right column are the results of our proposed method. In particular, the images in the fi rst two rows of Fig. 4 visualize the absolute difference between the fi rst image and the interpolated version of the fi rst image via homography mapping.
The images in the third row of Fig. 4 are the visualization of the geometrical error of homography mapping at each pixel de fi
Eq. (20) . The results in Fig. 4 intuitively demonstrate that our proposed method can achieve higher accuracy than the widely used successful DLT and GS methods.

Next, we investigated the computational ef fi ciency of dense homography estimation on the three synthetic image pairs SD and SD c . For each image pair, 30 independent runs of our proposed method with acceleration strategies and the method described in
Cordes et al. (2011) without acceleration strategies were performed separately. The median value of the objective function J img number of iterations and vs. the elapsed time is reported in Fig. 5 (a) and (b), respectively. From Fig. 5 (a), we can see our proposed method converges after about 260 iterations. Note that the value of the objective function for image pair SD c is much higher than the other two image pairs due to dramatic change of illumination conditions. For all the three tested image pairs, our method converges after about 100 s, which performs about 15 times faster than the minimization procedure proposed in Cordes et al. (2011) . 5.2. Applications with real images
Unlike synthetically rendered images tested in the above subsection, ground truth homography for real images is not available, thus it is not straightforward to quantitatively evaluate the accuracy of estimated homography directly. For the above reason, we examine the practical performance of our proposed method in two real-world applications, namely occlusion removal and image mosaicing. The resolution of real images used in this subsection is 816 612 pixels.

In the fi rst application, we tested our method in occlusion removal for planar scene. In this experiment, we captured two images (one to remove the cactus from the image in Fig. 6 (a) using information marked out the occlusion region in the image in Fig. 6 (a), then estimated the homography between the two images in Fig. 6 (a) and interpolated from the image in Fig. 6 (b) via homography mapping. Shown in Fig. 6 (c) is the result of occlusion removal using the best homography obtained by our approach after running 100 iterations, where evident distortions can be seen in the zoomed in regions. Such distortions disappear as the number of iterations increases and the fi
In the second application, we tested our method in image mosai-cing to generate a larger fi eld of view using images captured by rotating a hand-held digital camera around its optical center. In this experiment, one urban scene (see Fig. 7 (a)) and one indoor scene (see image is obtained by mapping the other two images onto the third one (which is chosen as the middle frame). The result of image mosaicing for the urban scene using homography estimated by our approach is shown in Fig. 7 (b), from which we can see that the three images are seamlessly stitched together. The experimental results for the indoor scene using homography estimated by DLT algorithm and homography estimation using tradi tional sparse method decreases (see the zoomed in regions in Fig. 8 (b)) due to the lack of point correspondences. In comparison, no noticeable artifacts have been observed in the stitched image using our proposed method (Fig. 8 (c)). 6. Conclusions
This paper proposes a dense approach for homography estima-tion based on modi fi ed DE. The proposed method is able to obtain a global solution by taking the color and gradient information in the whole image into account. Based on the experimental results on both synthetically rendered images and real images captured by a hand-held digital camera, we show that our proposed method can consistently improve the accuracy of homography estimation compared with the most widely used successful sparse methods.
In addition, the experimental results show signi fi cant improve-ment (about 15 times) in terms of ef fi ciency over previous dense approach for homography estimation. The effectiveness of the new method has also been veri fi ed in two real-world applications, namely occlusion removal and image mosaicing.

While feature based homography estimation has been success-fully applied to many applications, our proposed high accuracy method is especially useful for images of textureless scenes. As for future work, we would further improve the ef fi ciency of our framework to enable real-time applications by employing more powerful optimization method processed in the parallel fashion.
Moreover, we plan to extend our proposed method for computer vision tasks such as fundamental matrix estimation and optical fl ow estimation.
 Acknowledgments This work was partially supported by the National Natural
Science Foundation of China (NSFC) under Grant nos. 61070140 and 61103081. The authors would like to thank the anonymous reviewers for their constructive comments, which have helped to improve the quality of this paper.
 References
