 Let V be a set of | V | = n nodes and B  X  X  1 / 2  X  X  be the following sets: A function f : B  X  R is called pseudo-boolean . In this paper we consider convex relaxations  X  f : K X  R of f which we call totally half-integral : Definition 1. (a) Function  X  f : P  X  R where P  X  K is called half-integral if it is a convex restrictions  X  f : P  X  R are half-integral for all subsets P  X  K obtained from K by adding an Here i,j denote nodes in V ,  X  denotes a constant in { 0 , 1 , 1 2 } , and z  X  1  X  z . of the minimization problem when  X  x 6 = 1 2 . The set of nodes with guaranteed optimal solution can sometimes be increased further using the PROBE technique [6], which also relies on persistency. The goal of this paper is to generalize the roof duality approach to arbitrary pseudo-boolean func-tions. The total half-integrality is a very natural requirement of such generalizations, as discussed later in this section. As we prove, total half-integrality implies persistency. We provide a complete characterization of totally half-integral relaxations. Namely, we prove in sec-and conversely any bisubmodular function can be extended to a totally half-integral relaxation. Definition 2. Function f : K 1 / 2  X  R is called bisubmodular if As our second contribution, we give a new characterization of bisubmodular functions (section 3). Using this characterization, we then prove several results showing links with the roof duality relax-ation (section 4). 1.1 Applications This work has been motivated by computer vision applications. A fundamental task in vision is to infer pixel properties from observed data. These properties can be the type of object to which the pixel belongs, distance to the camera, pixel intensity before being corrupted by noise, etc. The popular MAP-MRF approach casts the inference task as an energy minimization problem with the objective function of the form f ( x ) = P C f C ( x ) where C  X  V are subsets of neighboring pixels For some vision applications the roof duality approach [13] has shown a good performance [30, 32, 23, 24, 33, 1, 16, 17]. 1 Functions with higher-order terms are steadily gaining popularity in computer vision [31, 33, 1, 16, 17]; it is generally accepted that they correspond to better image models. Therefore, studying generalizations of roof duality to arbitrary pseudo-boolean functions large, then applying the roof duality relaxation to these terms would yield constraints x i = x j and be simulated via the roof duality, e.g. x i = x j ,x i = x j for the same pair of nodes i,j implies x 1.2 Related work Half-integrality There is a vast literature on using half-integral relaxations for various combina-torial optimization problems. In many cases these relaxations lead to 2-approximation algorithms. Below we list a few representative papers.
 The earliest work recognizing half-integrality of polytopes with certain pairwise constraints was perhaps by Balinksi [3], while the persistency property goes back to Nemhauser and Trotter [28] who considered the vertex cover problem. Hammer, Hansen and Simeone [13] established that these properties hold for the roof duality relaxation for quadratic pseudo-boolean functions. Their work was generalized to arbitrary pseudo-boolean functions by Lu and Williams [25]. (The relaxation details.) Hochbaum [14, 15] gave a class of integer problems with half-integral relaxations. Very recently, Iwata and Nagano [18] formulated a half-integral relaxation for the problem of minimizing submodular function f ( x ) under constraints of the form x i + x j  X  1 . In computer vision, several researchers considered the following scheme: given a function f ( x ) = binary variables, and then apply the roof duality relaxation to the latter. Woodford et al. [33] used this technique for the stereo reconstruction problem, while Ali et al. [1] and Ishikawa [16] explored different conversions to quadratic functions.
 To the best of our knowledge, all examples of totally half-integral relaxations proposed so far belong to the class of submodular relaxations , which is defined in section 4. They form a subclass of more general bisubmodular relaxations.
 Bisubmodularity Bisubmodular functions were introduced by Chandrasekaran and Kabadi as rank functions of (poly-)pseudomatroids [10, 19]. Independently, Bouchet [7] introduced the concept of  X  -matroids which is equivalent to pseudomatroids. Bisubmodular functions and their generaliza-tions have also been considered by Qi [29], Nakamura [27], Bouchet and Cunningham [8] and Fu-jishige [11]. The notion of the Lov  X  asz extension of a bisubmodular function introduced by Qi [29] will be of particular importance for our work (see next section).
 It has been shown that some submodular minimization algorithms can be generalized to bisubmod-ular functions. Qi [29] showed the applicability of the ellipsoid method. A weakly polynomial com-binatorial algorithm for minimizing bisubmodular functions was given by Fujishige and Iwata [12], and a strongly polynomial version was given by McCormick and Fujishige [26].
 Recently, we introduced strongly and weakly tree-submodular functions [22] that generalize bisub-modular functions. The first result of this paper is following theorem.
 modular. Conversely, if function f : K 1 / 2  X  R is bisubmodular then it has a unique totally half-integral extension  X  f : K X  R .
 will be convenient to work with functions  X  h : L X  R and h : L 1 / 2  X  R obtained from  X  f and f via transformed to totally integral relaxations: ordering of nodes the following functions of n  X  1 variables (if n &gt; 1 ) are totally integral: after replacements 0 7 X   X  1 , 1 2 7 X  0 , 1 7 X  1 . To prove theorem 3, it suffices to establish a link between totally integral relaxations  X  h : L  X  R and bisubmodular functions h : L 1 / 2  X  R . We can does not affect the theorem.
 A pair  X  = (  X ,  X  ) where  X  : V  X  { 1 ,...,n } is a permutation of V and  X   X  { X  1 , 1 } V will be called a signed ordering . Let us rename nodes in V so that  X  ( i ) = i . To each signed ordering  X  we associate labelings x 0 , x 1 ,..., x n  X  X  1 / 2 as follows: where nodes are ordered according to  X  .
 the following way [29]. Given a vector x  X  R V , select a signed ordering  X  = (  X ,  X  ) as follows: (i) choose  X  so that values | x i | , i  X  V are non-increasing, and rename nodes accordingly so that | x is not difficult to check that | x i +1 | for i = 1 ,...,n  X  1 ,  X  n = | x n | . The value of the Lov  X  asz extension is now defined as Theorem 5 ([29]) . Function h is bisubmodular if and only if its Lov  X  asz extension  X  h is convex on Let L  X  be the set of vectors in L for which signed ordering  X  = (  X ,  X  ) can be selected. Clearly, L of n + 1 points (3). Equations (4) imply that  X  h is linear on L  X  and coincides with h in each corner x ,...,x n .
 Lemma 6. Suppose function  X  h : L X  R is totally integral. Then  X  h is linear on simplex L  X  for each signed ordering  X  = (  X ,  X  ) .
 Proof. We use induction on n = | V | . For n = 1 the claim is straightforward; suppose that n  X  2 . L  X  \  X  L  X  which cannot be integral.
  X  of  X  h to L 1 / 2 and  X  h be the Lov  X  asz extension of h . Then  X  h and  X  h coincide on L . Theorem 5 and corollary 7 imply the first part of theorem 3. The second part will follow from totally integral. Proof. We use induction on n = | V | . For n = 1 the claim is straightforward; suppose that n  X  2 . totally integral. Consider the following functions h 0 : { X  1 , 0 , 1 } V \{ n }  X  R : It can be checked that these functions are bisubmodular, and their Lov  X  asz extensions coincide with respective functions  X  h 0 used in definition 4. The claim now follows from the induction hypothesis. In this section we give an alternative definition of bisubmodularity; it will be helpful later for de-scribing a relationship to the roof duality. As is often done for bisubmodular functions, we will following rules: where V = { i,i 0 | i  X  V } is a set with 2 n nodes. The node i 0 for i  X  V is called the  X  X ate X  of ( x , y ) . In the latter case we assume that the two components correspond to labelings of V and V \ V , respectively, and the order of variables in both components match. Using this convention, the function f : K 1 / 2  X  R we will work with the function g : X  X   X  R defined by (0 , 0) } , so function g : X  X   X  R can be viewed as a discrete relaxation of function g : X  X   X  R . Definition 9. Function f : X  X   X  R is called bisubmodular if where u u v = u  X  v , u t v = REDUCE ( u  X  v ) and REDUCE ( w ) is the labeling obtained from w by changing labels ( w i ,w i 0 ) from (1 , 1) to (0 , 0) for all i  X  V .
 ( u 0 ) i = u i 0 . Labels ( u i ,u i 0 ) are transformed according to the rules and ( u  X  v ) 0 = u 0  X  v 0 for u , v  X  X  . Next, we define sets Clearly, u  X  X   X  if and only if u 0  X  X  + . Also, any function g : X  X   X  R can be uniquely extended to a function g : X ?  X  R so that the following condition holds: Proposition 10. Let g : X ?  X  R be a function satisfying (8) . The following conditions are equiva-lent: A proof is given [20]. Note, an equivalent of characterization (c) was given by Ando et al. [2]; we state it here for completeness.
 Remark 1 In order to compare characterizations (b,d) to existing characterizations (a,c), we need are equivalent. Consider a submodular function g : X  X  R satisfying the following  X  X ymmetry X  condition: conditions of proposition 10, so g is also a bisubmodular relaxation of f . Furthermore, minimizing g is equivalent to minimizing its restriction g : X  X   X  R ; indeed, if u  X  X  is a minimizer of g then so are u 0 and u  X  u 0  X  X   X  .
 In this section we will do the following: (i) prove that any pseudo-boolean function f : B  X  R has a submodular relaxation g : X  X  R ; (ii) show that the roof duality relaxation for quadratic pseudo-boolean functions is a submodular relaxation, and it dominates all other bisubmodular relaxations; (iii) show that for non-quadratic pseudo-boolean functions bisubmodular relaxations can be tighter than submodular ones; (iv) prove that similar to the roof duality relaxation, bisubmodular relaxations possess the persistency property.
 Review of roof duality Consider a quadratic pseudo-boolean function f : B  X  R : where ( V,E ) is an undirected graph and x i  X  { 0 , 1 } for i  X  V are binary variables. Hammer, Hansen and Simeone [13] formulated several linear programming relaxations of this function and showed their equivalence. One of these formulations was called a roof dual . An efficient maxflow-based method for solving the roof duality relaxation was given by Hammer, Boros and Sun [5, 4]. We will rely on this algorithmic description of the roof duality approach [4]. The method X  X  idea can be summarized as follows. Each variable x i is replaced with two binary variables u i and u i 0 corresponding to x i and 1  X  x i respectively. The new set of nodes is V = { i,i 0 | i  X  V } . Next, function f is transformed to a function g : X  X  R by replacing each term according to the following rules: g is a submodular quadratic pseudo-boolean function, so it can be minimized via a maxflow al-gorithm. If u  X  X is a minimizer of g then the roof duality relaxation has a minimizer  X  x with  X  x and g are equivalent when u i 0 = u i for all i  X  V , i.e. Invariance to variable flipping Suppose that g is a (bi-)submodular relaxation of function f : boolean function and g is its submodular relaxation constructed by the roof duality approach, then applying the roof duality approach to f 0 yields function g 0 . We will sometimes use such  X  X lipping X  operation for reducing the number of considered cases.
 Conversion to roof duality Let us now consider a non-quadratic pseudo-boolean function f : B  X  R . Several papers [33, 1, 16] proposed the following scheme: (1) Convert f to a quadratic pseudo-duality relaxation to  X  f ; then (3) Obtain function g by minimizing out auxiliary variables: g ( x , y ) = it may not be a relaxation of function f , i.e. (13) may not hold; we are only guaranteed to have g ( x , x )  X  f ( x ) for all labelings x  X  X  .
 Existence of submodular relaxations It is easy to check that if f : B  X  R is submodular the form c  X  i  X  A x i where c  X  0 and A  X  V have submodular relaxations. Using the  X  X lipping X  operation x i 7 X  x i , we conclude that submodular relaxations also exist for monomials of the form c  X  i  X  A x i  X  i  X  B x i where c  X  0 and A,B are disjoint subsets of U . It is known that any pseudo-boolean function f can be represented as a sum of such monomials (see e.g. [4]; we need to represent  X  f as a posiform and take its negative). This implies that any pseudo-boolean function f has a submodular relaxation.
 relaxation proposed in [25] is equivalent to the submodular relaxation constructed by the scheme above (we omit the derivation).
 Submodular vs. bisubmodular relaxations An important question is whether bisubmodular relaxations are more  X  X owerful X  compared to submodular ones. The next theorem gives a class of functions for which the answer is negative; its proof is given in [20].
 Theorem 11. Let g be the submodular relaxation of a quadratic pseudo-boolean function f defined bisubmodular relaxation  X  g of f , i.e. g ( u )  X   X  g ( u ) for all u  X  X   X  .
 For non-quadratic pseudo-boolean functions, however, the situation can be different. In [20]. we give an example of a function f of n = 4 variables which has a tight bisubmodular relaxation g (i.e. g has a minimizer in X  X  ), but all submodular relaxations are not tight.
 Persistency Finally, we show that bisubmodular functions possess the autarky property, which implies persistency .
 [Autarky] Let y be a labeling in B . Consider labeling z = ( y t x ) t x . Then z  X  B and f ( z )  X  f ( y ) . [Persistency] Function f : B  X  R has a minimizer x  X   X  B such that x  X  i = x i for nodes i  X  V with integral x i .
 yields persistency. We showed that bisubmodular functions can be viewed as a natural generalization of the roof duality approach to higher-order cliques. As mentioned in the introduction, this work has been motivated by computer vision applications that use functions of the form f ( x ) = P C f C ( x ) . An important open question is how to construct bisubmodular relaxations  X  f C for individual terms. For terms of low order, e.g. with | C | = 3 , this potentially could be done by solving a small linear program. Another important question is how to minimize such functions. Algorithms in [12, 26] are unlikely to be practical for most vision problems, which typically have tens of thousands of variables. How-ever, in our case we need to minimize a bisubmodular function which has a special structure: it is represented as a sum of low-order bisubmodular terms. We recently showed [21] that a sum of low-order submodular terms can be optimized more efficiently using maxflow-like techniques. We conjecture that similar techniques can be developed for bisubmodular functions as well.
