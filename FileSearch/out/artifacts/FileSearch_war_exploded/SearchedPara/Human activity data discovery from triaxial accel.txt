 1. Background
The past two decades have seen an increase in research activity in the field of human activity recognition. With activity recognition having considerably growing so did the number of challenges in developing, implementing and evaluating  X  solutions that may help the medical diagnosis of chronic motor diseases. A major challenge in our networked world is the and extraction of relevant information.

The constant concern with the human physical and psychological well being has been the drive for research studies that have led to promising advances in medicine and engineering. In Biomedical Engineering, the demand for objectivity in clin-ical diagnosis of pathologies so subjective and hard to trace such as Obsessive Compulsive Disorder ( National Institute of usually relies on observation and therefore a highly experienced analyst is always needed. Analysing human action is par-ticularly challenging due to its complexity in the non rigid and self occluding nature of articulated human motion. Human body movement shows up to 244 degrees of freedom ( C.H., 2006 ), which leads the modelling of structural and dynamic fea-tures for human activity recognition to a complex task.

The current research arises the hypothesis of accelerometry (ACC) as suitable technique for monitoring movement pat-terns in freely moving subjects during long periods of time. This technique can be used to measure quantitative parameters which may provide clinical insight into the subject health.

This study aims to understand the signals produced by a triaxial accelerometer through the human movement interpre-tation and clinical relevant parameters identification from the data. Signal processing techniques are implemented with the purpose of examining accelerometer data and finding new information that is difficult to identify from the raw data. We present a method for convenient monitoring of ambulatory movements in daily life, using a portable measurement device employing a single triaxial accelerometer.
 rithms. To achieve the proposed goals, the following steps were implemented:
Acquire and analyse the data produced by a triaxial accelerometer, placed on different parts of the body, during human movement, creating a database and proposing an annotation structure for motion data;
Develop a framework for the interpretation of the data provided by an accelerometry monitoring system: design a set of time, statistical and frequency domain features from several research areas such as speech recognition and activity recognition; Develop algorithms to extract relevant information from the data; Apply clustering techniques based on feature representation of accelerometer data; Explore the choice of features and signals window size on the performance of different clustering algorithms; Develop a framework to differentiate human activities, such as sitting, walking, standing, running and lying; discovery; Implement a new metric based on classification performance evaluation: classification-based evaluation.
We present a method for convenient monitoring of detailed ambulatory movements in dailylife through a portable mea-surement device which employs a single triaxial accelerometer and machine learning techniques. 2. Related work
Most approaches to activity recognition, using body-worn accelerometers, involve a multi-stage process ( Ghahramani, 2004 ). Firstly, the sensor signal is divided into a number of small time segments, referred to as windows, each of which is considered sequentially. For each window, one or more features are derived to characterize the signal. These features are then used as input to a clustering algorithm which associates each window with a cluster. 2.1. Composition of triaxial accelerometer signal
Before using the accelerometer system in any monitoring context, and before the algorithms development to interpret data The signal measured by each fixed-body accelerometer is a linear sum of, approximately, three components ( Mathie, 2003 ): Acceleration resulting from body movement  X  Body Acceleration Component; Acceleration resulting from gravity  X  Gravitational Acceleration Component; Noise intrinsic to the measurement system.

The first two components provide different information about the wearer of the device: the gravitational acceleration (GA) provides information about the space orientation of the device, and the body acceleration (BA) provides information about the movement of the device. The separation of the information regarding the movement of the device is important, however these two components have overlapping frequency spectra. According to previous studies, the BA component range overlaps the area covered by the GA component, which goes from 0 to 0.3 Hz. It is possible to approximately separate the BA and the GA components by filtering techniques. Fig. 1 represents the motion data processing of a typical recording from the accelerometer, showing several minutes of recorded data during a supervised test where the subject performs spe-dowing percentages in order to determine their ability to differentiate the components of the acceleration signal. In the present study, in order to isolate the body acceleration component, a second-order Butterworth High-Pass filter with cut-off frequency of 0.25 Hz was used, as in Mathie (2003) . 3. Methodology
Triaxial accelerometers produce three separated accelerometer data time series, one time series for acceleration on each axis ACC x ; ACC y and ACC z . Complementary to the three axes data, an additional time series, ACC computing the magnitude of the acceleration: component and the high frequency component, as suggested in Mathie (2003) and Mannini and Sabatini (2010) . This way, component. Finally, the features for each time series are extracted. 3.1. Feature extraction
Features can be defined as the abstractions of raw data since they are reduced sets of original raw data which represent Tests are performed in order to assess the following parameters: The influence of the signal window size on the clustering performance.
 The influence of the free parameters in that same performance.
 The best feature combination that leads to a better performance of the implemented algorithm.

The present study investigates a new method of feature extraction for clustering problems. A dictionary of features
Source and Reference, as shown in Table 1 . 3.2. Relevant features for activity recognition systems
Recognizing human activities depends directly on the features extracted for motion analysis. People tend to perform the same movement in many different ways, which can lead to substantial variability in the features derived from body-fixed sensor data. Therefore, to achieve effective clustering, the identification of features with high discriminative ability is important. A good feature set should show little variation between repetitions of the same movements performed by the same individual but should vary between different subjects performing the same task. This set must also show considerable variations between different activities. Table 2 shows the list of features considered in this study.
The developed dictionary divides the features into the following categories: statistical, temporal and spectral. Some of them have been intensively investigated in previous studies and proved to be useful for activity recognition. Others, like an adapted Mel-frequency cepstral coefficients (MFCC) have appeared for the first time in activity recognition and have ture information per window, another with the names of the features that were extracted in the respective clustering test dimensional feature vector is obtained: from each one of the four signal vectors, we compute fifteen features with only one output and three features (histogram, cepstral coefficients and mel-frequency cepstral coefficients with ten outputs each. implements a specific clustering algorithm. 3.3. Feature normalization
The obtained features all have different magnitudes. This can cause problems for some machine learning algorithms, proceeding to the feature selection stage, all features are normalized to zero mean and unit variance. 3.4. Graphical perception of feature visualizations: The Horizon Plot
Previous studies investigated techniques for the visualization of time series data and evaluate their effect in value com-parison tasks. Line charts were compared with horizon graphs  X  an efficient time series visualization technique across a those who do not change their value between activities and those who only add redundant information.
In a 180th-dimensional feature vector, it becomes difficult to have a relative perception of the importance of each feature into bands and overlaid, again halving the height. 3.5. Feature selection techniques and free parameters
To systematically assess the usefulness and identify the most important features to discriminate different activities, a ables may be redundant or even irrelevant.

The feature selection stage chooses a smaller subset of the original features, which is useful to identify the informative features, and to limit computational demands when executing the recognition system on new observations. A matrix with were made in order to infer the impact of the window size and to obtain a better performance of the implemented algorithm. The free parameters are those used as input to the features algorithms such as the number of bins in the histogram.
The choice of features acquired from a data set and the window length over which these features are computed is of high importance. For activity recognition, where accelerometer data from PA is windowed, the choice of the number of frames is were performed with window size ranging from 1000 to 4000 samples, in a logarithmic scale due to its detailed study on the lower frequencies than in the higher frequencies. For each window size, different clustering performances were obtained that allow the choice of an appropriate window size to feature extraction. 3.6. Signal annotation method
In the present study, an aspect of activity recognition that was explored was the method applied to annotate sample data, which can be used to compute the performance of the activity model. Most of the researchers have published results of experiments in which the participants are required to manually annotate each activity performed in a given moment collected. Still in other studies, the raw sensor data was manually inspected in order to annotate it with a corresponding created, as shown in Fig. 1 .

In the presented study, participants were continuously observed during experiments and an observer was stating start-ing/ending time of each activity. The subjects know in which order the specified activities should be performed and latter, raw sensor data was manually inspected in order to annotate it with a corresponding activity label. The annotation dictio-nary has information about the number and label of the movements that took place and the time intervals that delimit them. size of the signal whose features will be extracted and the overlap percentage of the signal to be considered. 4. Experimental setup 4.1. Unsupervised learning
Machine learning algorithms based on the feature representation of accelerometer data have become the most widely ferent activities. Clustering mechanisms separate and organize unlabeled data into different groups whose members are sim-gation, the Mean Shift and the Spectral Clustering techniques.

The affinity propagation method separates the dataset into clusters through messages between data samples which charac-relative high density corresponds to the clusters centres. This method computes the mean between each maximum point and each data sample. The window between these two points is moved to the mean value. The process is iterative and ends it uses the similarity matrix between data samples to compute the best eigenvalues for posterior clustering ( Liao, 2005 ). 4.2. Classification-based evaluation: Proposed metric
Evaluation of unsupervised approaches is usually difficult due to the lack of ground truth to which one can compare the discovered structure. The presented activity recognition method includes three stages: Clustering the data into homogeneous groups.
 Creating rules that connect instances to the correct clusters.
 Recognizing activities inside the clusters.

A confusion matrix contains information about true and predicted labels from a clustering system. The performance of such systems is commonly evaluated using the data in the matrix. Once the clustering algorithm randomly associates the clustering results to non-annotated groups, a novel algorithm, that links these groups to their corresponded activity, is implemented. This function receives the confusion matrix of random assignment and goes through each row of the matrix and stores the index that contains the maximum value of each row. It is checked whether the index is unique throughout the ment vector, the matrix with the labels already associated is reconstructed (see Fig. 3 ).

In unsupervised learning, unlabelled data is grouped into different clusters that reflect the underlying structure of the set of features: mean, autocorrelation, root mean square and Mel-Frequency Cepstral Coefficients (MFCC). standing, are also very hard to discriminate as they overlap significantly in the feature space.
 5. System architecture and data acquisition
In the present study, the experiments have been carried out with a group of 8 volunteers within an age bracket of 16 X  44 years. All procedures were approved by the Ethics Committee of the Champalimaud Foundation. The first test consisted in the performing of a gym circuit, in a supervised atmosphere and this signal acquisition stage used the software OpenSig-nals ( Gomes, Nunes, Sousa, &amp; Gamboa, 2012 ).

Each person performs seven activities in sequence lasting about one minute each  X  standing, sitting, walking, running and lying down (belly up, right side down and left side down)  X  wearing an accelerometer on the waist and another on the wrist. stant rate of 800 Hz and 12 bits of resolution was acquired ( Motionplux, 2014 ).

Firstly, the clustering performance for each feature was obtained. Then, tests were carried out with the best set of fea-tures. Given the knowledge of the ground truth class assignments (labels true) and the clustering algorithm assignments of the same samples (labels predicted), the Adjusted Rand Index (ARI) is a function that measures the similarity of the two assignments, ignoring permutations and with chance normalization ( Pedregosa et al., 2011 ). 5.1. Influence of window length on the K-Means performance
Different segmentation methods can be applied to time-series data which enhance signal behaviour and enable the gath-acceleration stream into frames. In this framework, each segment consists of 1000, 2000 or 4000 samples. This time interval shows the obtained performance for each value of window size, considering the best implemented set of features: mean, autocorrelation, root mean square and MFCC. An average of the performances obtained for the 8 subjects was calculated.
Based on these results, the Human Activity Recognition (HAR) system reaches a clustering accuracy between 89.46  X  0.4% and 99.14  X  0.6%, with 1000 and 4000 samples, respectively, and a classification accuracy between 81.94  X  0.7% and 99.29  X  0.5%. If the subject is performing a single activity for a long time interval, a long window will include more information about that activity. In this study, the windowed data contains a single activity during about one minute, which performance. 6. Results and discussion
The performance of the proposed HAR system was validated in two studies: subject-independent context and subject-dependent context. Different features and free parameter combinations were explored in order to improve the classification accuracy on physical activity measured from waist accelerometer data. The conditions in which data was collected from movements performed in a supervised laboratory setting are described in this section. 6.1. Clustering evaluation for subject-independent context
The subject-independent performance was evaluated using the K-Means Clustering Algorithm. Even in the case of healthy people, the performed movements can be highly individualistic. Nonetheless, there are a set of basic parameters that are similar to all instances of these movements. A person-independent accuracy of 88.57% and standard deviation of 4.0% was obtained, with window size of 4000 samples and the best set of features: mean, autocorrelation, root mean square and MFCC. Compared to the subject-dependent case, the accuracy is much lower which can be explained by the variations in human motion for different subjects. Each experiment was repeated eight times.

In addition to the K-means application, other clustering methods have been used to corroborate the obtained results, such 32.74%, the Mean Shift shows 44.01% and with the Spectral Clustering 45.74%, for inter subject context.
A confusion matrix contains information about true and predicted labels done by a clustering system. Table 6 shows the algorithm confuses sitting with standing position. 6.2. Clustering evaluation for subject-dependent context
This procedure investigates how the recognizer performs in a subject X  X  dependent context. To evaluate the subject-depen-dent accuracy of the proposed algorithm, the K-Means Clustering Algorithm ( Pedregosa et al., 2011 ) was performed for each subject data. An average person-dependent accuracy of 99.29% and standard deviation of 0.5% were obtained, with window size of 4000 samples and the best set of features: mean, autocorrelation, root mean square and MFCC. On the other hand, the ing 93.96  X  4.87 %. 7. Conclusions
The major achievements of this work are: the design of a gesture recognition system based solely on data from a single 3-dimensional accelerometer which finds the best free parameters and window sizes to clustering analysis; the new set of features extracted from wearable data able to ensure high classification results; and the clustering method application in intra and inter subject context.

The experimental results presented here suggest that using only one waist-worn accelerometer can adequately identify in system acceptance. Furthermore, the present study investigated several combinations of features used for activity recog-compared to the most commonly features used in literature for activity recognition ( Mannini et al., 2013 ). The techniques any value for window length, or overlap percentage, but searches the best parameters that define the specific data. A clus-human activities recognition with ARI in K-means application were very encouraging. An average person-dependent ARI of 99.29% and a person-independent ARI of 88.57% were reached. Compared to the subject-dependent case, the accuracy of all subjects for the Affinity propagation, the Mean Shift and the Spectral Clustering applications is much lower as it was expected from the previous results with K-means. The obtained results may be explained by the variations in human motion for different subjects.
 Competing interests The authors declare that they have no competing interests.
 Author X  X  contributions
IPM carried out the human activity recognition studies, participated in the algorithm implementation, performed the sta-manuscript composition. HG conceived the study, and participated in its design and coordination and helped to draft the manuscript. VBP conceived the study, and participated in its design and coordination and helped to draft the manuscript.
RMC participated in the design of the study and helped to draft the manuscript. All authors read and approved the final manuscript.
 Availability and requirements
The algorithm described in the manuscript is available for testing by reviewers at: https://www.dropbox.com/sh/ 3fkil2tws7z101g/J0pTQTmCXw .
 Acknowledgements
We thank Plux-Wireless Biosignals who provided the biosensors for the accelerometry signals acquisition. RMC and VBP are supported by Human Brain Project and BrainFlight grants.
 References
