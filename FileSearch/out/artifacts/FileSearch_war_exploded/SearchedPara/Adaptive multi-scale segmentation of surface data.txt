 1. Introduction
Surface segmentation for automatic or interactive data inter-pretation is encountered in many engineering applications, which deal with three-dimensional (3D) data obtained by scanning objects of interest. A typical application example, which is the subject of this paper, belongs to the LiDAR (Light Detection and Ranging) technology in remote sensing. This technology can provide a high-resolution representation of object and terrain surfaces in the form of a digital surface model (DSM), which is the height map of 3D LiDAR data ( Campbell, 2002 ). Consequently, digital image processing techniques such as the image segmenta-tion can be applied to segment 3D objects based on their detailed DSM images. The possibility of automatic (remote) height mea-surements makes this technique attractive for engineering pro-jects connected with size measurements of particular objects of interest. Another example of surface segmentation is the auto-matic segmentation of range images, which are reconstructed from distance data of range scanners ( Bab-Hadiashar and Gheissari, 2006 ). A different potential application is the industrial and medical diagnostic imaging based on ultrasound images of objects surfaces. The method presented in this paper focuses on LiDAR image segmentation of mostly natural scenes such as forests, parks and residential areas with buildings and trees.
The method of seeded region growing stands out from the multitude of image (surface) segmentation techniques due to its simplicity, time-efficient implementation and relatively good segmentation results ( Adams and Bischof, 1994 ). Its theoretical foundation lies in the data clustering approach to image segmen-tation ( Pal and Pal, 1993 ). The direct application of data clustering to image segmentation, however, does not take into account the spatial adjacency of regions and pixel connectivity, and it often results in noisy and sparse segmented regions. Advantageously, the region growing procedure as an iterative label-assignment algorithm directly analyzes region adjacency and connectivity of pixels belonging to the same region. Several algorithmic versions of the seeded region growing exist and they differ by the label-assignment procedure. For instance, the popular watershed seg-mentation algorithm can also be classified as a region-growing method ( Beucher and Meyer, 1993 ). The weak side of the region growing approach is the seed-point selection, which is interactive or heuristic if based on a fully automatic procedure. Another problem, which may appear when applying a classical clustering approach to regional segmentation, is the presence of multiple regions (objects of interest) with close values of image attributes, e.g., the height attribute in the case of LiDAR data. They will be labeled as a single region, although in reality they are different isolated regions corresponding to distinct objects of interest.
Some modifications of the region-growing method were made in order to automatically select seed points. One of the existing methods consists in selecting seed locations at the regional borders using an edge detection operator ( Fan et al., 2001 ). This procedure requires a heuristic and time-consuming post-proces-sing to remove irrelevant seeds or merge over-segmented regions.
In another similar method, a probability map is constructed to select seeds as the local minima points of an edge probability score ( Mic  X  u  X  s X   X  k and Hanbury, 2006 ). However, the seed selection by this method allocates multiple seeds at quasi-regular positions and requires sophisticated and time-consuming post-processing algorithms to select the optimal segmentation case. As opposed to the edge-area selection, a seed selection scheme using centers of flat areas has been proposed in Brunner and Soille (2007) . A pre-segmentation by thresholding is used in the segmentation algo-rithm ( Shan et al., 2008 ) to score the relevance of the obtained regions. This method is based on several existing image analysis methods, which are also present in the probability map method ( Mic  X  u  X  s X   X  k and Hanbury, 2006 ). A novel image segmentation scheme based on case-based reasoning was proposed to improve the performance of the watershed segmentation method ( Frucci et al., 2008 ). It selects particular cases from a case base, which have image characteristics similar to that of the current input image. The segmentation parameters associated with the most similar case are then applied to the current image. The approach of case-base reasoning for seed selection requires a case base of segmentation outcomes, which is not always available in practice.
LiDAR data, there are two major approaches. One is to process directly 3D LiDAR data and perform segmentation of surface point clouds in the 3D space ( S  X  oderman et al., 2004 ; Zhang et al., 2006 ).
A significant part of the existing algorithms is based on 3D geometrical models of LiDAR surfaces, which limits their applica-tion scope to man-made or highly structured object surfaces only.
Another approach, which is also adopted in this paper, is to implement a data segmentation method on the DSM image obtained from the initial LiDAR data by surface point triangula-tion and subsequent smoothing ( Tiede et al., 2005 ). This method relies on the extraction of local maxima on the canopy surface to locate seed points. A different method of individual tree segmen-tation in forest areas is the crown delineation method based on the valley following algorithm ( Leckie et al., 2003 ). However, this algorithm is not fully automatic since it requires a preliminary determination of forest areas and prior knowledge of key algo-rithm parameters. Another example is the method of gray-scale morphology used to segment treetops in a dense forest area ( Andersen et al., 2001 ). A texture segmentation method using a seeded region growing was applied to segment coastal landforms in LiDAR imagery ( Lucieer and Stein, 2005 ). In order to determine seed points, this method identifies image locations with mini-mum local variances similarly to the seed selection method ( Brunner and Soille, 2007 ).
 method is a fully automatic selection of seed points for reliable image segmentation. Another goal is to obtain estimates for the threshold value for accurate region growing. In particular, the thresholds have to be estimated as functions of image local statistics in the neighborhoods of the seed points. The adaptive approach to surface (image) segmentation outlined in this paper can also be considered as an unsupervised learning of seed positions through local clustering of surface data with the con-straint of region adjacency and pixel connectivity. The seed points are selected as the centers of local sub-clusters with high homo-geneity and compactness with respect to their local inter-cluster distances.
 proposed approach, which provides invariance to variability of region sizes and their relative locations. The multi-scale and multi-resolution approaches to image segmentation are not new and many single-scale algorithms have been modified to imple-ment the multi-scale image segmentation ( Frucci et al., 2006 ;
Jung, 2006 ; Wang, 1997 ; Saha et al., 2000 ; Duarte-Carvajalino et al., 2008 ). The main difference between the multi-resolution image analysis and the multi-scale approach is that the multi-scale analysis is performed once but at different local scales simultaneously, which depend on the image locations, i.e., the local scale is a function of pixel coordinates. The existing methods mostly perform the classical multi-scale image analysis based on multiple Gaussian filters at various scales. Here, a completely different scale selection principle is adopted for image segmenta-tion, which is based on region homogeneity and its local contrast with adjacent regions. This principle substantially contributes to optimized selection of seed points and adaptive thresholds for the region growing.
 tation method with scale-adaptive selection of seed points and thresholds in the region growing. Section 2 describes a local clustering aspect of the conventional image segmentation, which is based on a two-criterion principle for optimized attribute clustering. The flowchart of the proposed region-growing seg-mentation is outlined in Section 3. Computation of local clustering map and selection of seed points are described in Sections 4 and 5, respectively. Section 6 describes a modified region-growing algo-rithm using scale-adaptive thresholds. The experimental results of
LiDAR surface segmentation are presented in Section 7 and concluding remarks are given in Section 8. 2. Local clustering aspect of the conventional image segmentation segmentation into homogeneous regions can also be used to solve the seed selection problem in LiDAR image segmentation ( Tou and Gonzalez, 1974 ). In the case of DSM images, which represent surfaces of real objects or their parts, the segmentation consists in labeling regions  X  one label per isolated region  X  in order to delineate objects of interest such as building, trees, forests, lakes, etc. on the background in LiDAR images. The region homogeneity is estimated in an N -dimensional space of surface attributes location ( m , n ). In the presented method (Section 3), a single surface attribute  X  the surface height as the image intensity function f ( m , n )  X  is taken into account for homogeneity estima-tion although a generalization to N -attribute space is straightfor-ward. More formally, the segmentation task of an image grid G (i.e., the set of all image points on a discrete square grid) into K regions as subsets of points, A 0 , A 1 , y , A K 1 , where A background region, can be formulated as follows:
A k \ A l  X  + , for k a l and [ K 1 where each region A k has a label usually meaning the object type that is identified with that region. Conditions of homogeneity are imposed on all the regions except for the background A 0 :
C  X  A k  X  X  1 , k  X  1 , ... , K 1 and C  X  A k [ A l 9 l A Y k  X  X  0 k  X  0 , ... , K 1  X  2 : 2  X  where C ( A k ) is the homogeneity predicate of the region A logical function of image attributes in A k and Y k is the set of adjacency indices identifying regions adjacent to A k ( Tou and
Gonzalez, 1974 ). Comparison of an attribute variance in the region A k with a homogeneity threshold is an example of the homogeneity predicate C ( A k ) by the chosen image attribute. In addition, connectivity of pixels belonging to the same region is requested: O  X  A k  X  X  1 for k  X  1 , ... , K 1  X  2 : 3  X  where O ( A k ) is the pixel connectivity predicate for the region A The connectivity predicate O ( A k ) states that for any two points in A there exists a path of points (i.e., a chain of locally connected points with a given connectivity pattern ( Pal and Pal, 1993 )), which belongs to A k . Intentionally, the background region A not included in the first condition of Eq. (2.2) and in Eq. (2.3) since A can be inhomogeneous and unconnected.

In the application of data clustering to image segmentation, the main task consists of automatic selection of cluster centers and determination of the total number of clusters. For example, the well-known clustering method, the K -means iterative algo-rithm, supposes a priori assignment of K initial values to the cluster means ( Kanungo et al., 2002 ). This is not acceptable in the considered image segmentation case (Eqs. (2.1) X (2.3)), because of the variability of attribute values from one image to another and the presence of multiple regions with the same mean value inside the background region. An improvement of the K -means clustering method can be achieved by the mean-shift algorithm ( Comaniciu and Meer, 2002 ), which iteratively finds cluster centers without imposing K initial values for the centers. How-ever, simultaneous clustering in the joint space of surface attri-butes and image plane coordinates is not contributing to unambiguous labeling of isolated regions.

Therefore, a procedure for automatic seed selection, which can work without prior knowledge about the total number of regions and attribute distribution parameters, is requested. The regional homogeneity of surface data and regional intensity contrast (i.e., height step in LiDAR surfaces) with respect to the adjacent regions has to be exploited for the seed selection. Consequently, a formal two-criterion measure has to be defined and used to measure the attribute clustering quality. There exist some formal criteria of clustering quality in the context of feature extraction and selection by their clustering merits ( Handl and Knowles, 2007 ; Rousseeuw, 1987 ). The average silhouette measure has to be highlighted among them since it involves two criteria and well reflects the clustering quality ( Rousseeuw, 1987 ). However, this measure is suitable only for the task of feature selection while considering the global clustering context. In our segmentation task, the total number of clusters is unknown and isolated image regions can form a single cluster of attributes if segmented without taking into account pixel connectivity. For this reason, we suggest to modify the average silhouette method ( Rousseeuw, 1987 ) in order to obtain a two-criterion quality measure, which can be applicable with minor modifications to the image seg-mentation task described in Eqs. (2.1) X (2.3). In particular, let us suppose a partition of a given data set { x 1 , x 2 , y , x { C , k  X  1, y , K } with the cluster centers as the attribute mean values { c k , k  X  1, y , K }. We also suppose that the adjacent data to a given cluster are known in the form of the adjacency sets { O 1 , y , O K }. In the context of image segmentation, the cluster adjacency is considered in the image grid space. Taking this into account, we have modified the silhouette method of clustering quality estimation and obtained the local score function to evaluate the l th cluster with respect to its adjacent clusters: D  X  C 1 , ... , C K  X  X  where d (.,.) is the Euclidian distance between two attribute vectors, p ( p Z 1) is the power parameter of the score function D (.), 9 C l 9 is the total number of attribute vectors in the cluster C and 9 O l 9 is the total number of attribute vectors in O belong to clusters adjacent to C l . According to Eq. (2.4), the two-criterion score function for a given cluster is directly proportional to the cluster distance to the adjacent clusters and inversely proportional to the mean distance of the attribute vectors to the cluster center. The power parameter p determines how important is the cluster homogeneity, relatively to the cluster distance to other clusters. If the parameter p is unknown, its default setting is p  X  2. The measure for the overall clustering quality over all K clusters will be the sum of the K individual score functions, D D , y , D K .

An important modification of the existing silhouette approach is the introduction of the local inter-cluster distance of a given cluster C l to its adjacent neighborhood set O l of attribute vectors in order to enhance the cluster separability (Eq. (2.4)). Thus the perturbation effect of a single remote cluster on the clustering score function is minimized. Fig. 1 shows this case in the space of two clustering attributes, x 1 , x 2 , when using different quality criteria as the clustering score functions.

It should be noted that the proposed modification of the silhouette measure as well as the original silhouette score function does not perform the data clustering per se . An algorithm to determine the cluster centers and assign data points to appropriate clusters is required before this score function can be applied.
The image segmentation context in Eqs. (2.1) X (2.3) together with the idea of two-criterion clustering suggests the following approach to the extraction of seed points. The seed points are selected as the centers of compact attribute sub-clusters asso-ciated with the corresponding image regions, which have high homogeneity and contrast with adjacent attribute sub-clusters of the adjacent image regions. Fig. 2 shows the seed point selection at the center of a sub-cluster of surface points in the example of a LiDAR image with a multi-level building. The image intensity in Fig. 2 is proportional to the surface height. The circular sub-region S ( i , j )in Fig. 2 satisfies the conditions of homogeneity outlined in Eq. (2.2) and the regional connectivity constraint in Eq. (2.3).
The result of the local score-function computation is shown in Fig. 2 b as a gray-scale image called the local clustering map. As it can be seen from Fig. 2 b, local maxima of the score function correspond to the centers of homogeneous regions in the image of Fig. 2 a. On the contrary, the regional edge locations provide incorrect seed positions, which correspond to local minima of the score function. considered in every image point ( i , j ), and the local homogeneity and contrast are estimated in a circular sub-region W r ( i , j )of diameter r ( Fig. 2 a) in order to calculate the local score function in that point. However, the locality diameter has to be variable since homogeneous regions may have different sizes. That leads us to the necessity of multi-scale image segmentation with the concept of local scale, which is equivalent to the diameter r of a homogeneous disk sub-region S r ( i , j ) centered at the candidate seed point ( i , j ), where r o r . Therefore, the underlying idea of the proposed method (Section 3) is to estimate the local homogeneity and local contrast in each point ( i , j ) over L pairs of different by size concentric sub-regions { S l ( i , j ), l  X  1, y , L } and { W centered at ( i , j ), where L is the total number of scales. 3. Multi-scale segmentation using adaptive region growing mentation of surface data, details of which are described in the following sections. Our multi-scale algorithm can be distinguished by two main phases: (1) selection of multi-scale seed points using a pre-computed local clustering map and local scale values and (2) scale-adaptive region growing from the selected seeds. The first phase is aimed at the solution of the seed selection problem: incorrect seed selection results in erroneous segmentation or substantial increase in the overall computation time to correct it by a proper post-processing technique. At the second phase, adaptive thresholds are assigned to the selected seed points and the region growing proceeds with these thresholds  X  one region at atime.

Multi-scale maps of local homogeneity and contrast are com-puted first in a computationally efficient mode in each image point and for all L scales (Section 4). The local homogeneity map at the l th scale serves to estimate the intra-cluster distance of a potential sub-cluster of attribute values within the disk S diameter r ( Fig. 2 ). The contrast map serves to estimate the mean distance of the potential attribute sub-cluster center to its adjacent sub-clusters. The local clustering map is computed as a linear normalized combination of the two maps at the local scale determined beforehand (Eq. (4.2)). The local clustering map is the output of the score function modified from Eq. (2.4) in order to perform a raster image segmentation.
 able positions for the seed points to be used in the region growing (Section 5). The order of the individual regions in the segmenta-tion process is determined by the saliency of the corresponding disk regions { S r ( i , j )} representing attribute sub-clusters. A region saliency level is defined as a ratio of its local contrast to the local variance in the region. The most salient region corresponds to the global maximum of the local clustering map. An additional seed-point condition (conditions) may be tested before accepting the current local maximum as a seed point. In particular, if the saliency level exceeds a threshold then this point is accepted as a good seed point.

The region-growing algorithm is applied to each available and unmasked seed. The value of the local variance as the local homogeneity measure provides an estimate for the threshold value, which is proportional to the local variance. The scale-adaptive threshold is a substantial improvement of the conven-tional region-growing algorithm, which gives poor results if the initial threshold value is not appropriate. After the segmentation of a current region, its binary map is added to the regional mask in order to exclude this region as well as other candidate seed points inside it from the ongoing segmentation process. The next maximum of the local clustering map, accepted as a seed point, will generate another homogeneous region of the given image and so on until no more unmasked seed points can be found. As a result, all ( K  X 1) object regions, A 1 , y , A K  X 1 , will be segmented (Eq. (2.2)) and the background region A 0 , will be defined as the complement of their union to the image grid G . In contrast to many existing algorithms for image segmentation, no post-pro-cessing procedures such as region merging or region splitting are required. 4. Time-efficient computation of local clustering map
Computation of the local clustering map is an extension of the score function estimation in Eq. (2.4) to the case of image segmentation. The local score function has to be modified in order to take into account the pixel connectivity on the image discrete grid and the region adjacency conditions in Eqs. (2.2) and (2.3). Similarly, the inter-cluster distance has to be substi-tuted by a multi-scale function serving as an estimator of the inter-cluster distance with respect to the current region and its adjacent regions. We compute the local clustering map using a modified version of the multi-scale isotropic matched filtering (MIMF) operator proposed for LiDAR image analysis ( Palenichka and Zaremba, 2007 ). The initial MIMF operator involves an estimation of the multi-scale contrast and homogeneity of image fragments, but cannot be directly applied to the general segmen-tation task outlined in Sections 1 and 2. In particular, the multi-scale contrast estimate is applicable only to the case of a two-level intensity contrast ( Palenichka and Zaremba, 2007 ). The two-level intensity model means that the region under segmen-tation within an image fragment has one dominant level of intensity (height), whereas the background has different domi-nant level of intensity (height). Therefore, we have used a of the local clustering map j ( i , j ) as follows:  X  i , j  X  X  F f  X  i , j  X  , r  X  i , j  X   X  and d ( i , j , r ) are the values of the local isotropic contrast and homogeneity (or non-homogeneity) measure at the scale r , a is the homogeneity coefficient and v ( i , j , r ) is the local variance in the circular region W r ( i , j ). The local variance at the scale r is used as the term d ( i , j , r ) in Eq. (4.1) ( Palenichka and Zaremba, 2007 ). we have used the variance over the entire window W r ( i , j ). The map provides invariance to image linear intensity changes. The coefficient a plays the role of the power parameter p in Eq. (2.4) and determines the weight of the region homogeneity relatively to the local contrast.

Estimation of the local scale r ( i , j ) in each point of the image grid produces the local scale map. According to the adopted morphological scale definition ( Maragos, 1989 ), the scale deter-mination consists in selecting the greatest structural element (a disk region), which is centered at ( i , j ) and inscribed into the corresponding homogeneous region ( Fig. 2 ). It is proposed to estimate the local scale as the maximum of the local isotropic contrast with a homogeneity constraint term over a given scale range L :  X  i , j  X  X  argmax The use of two terms in Eq. (4.2) simultaneously is justified by the fact that the contrast maximization only is not sufficiently accurate because of its weak response to larger homogeneous regions.

The local isotropic contrast e ( i , j , r ) in Eq. (4.1) is calculated as the mean square deviation of pixels in the background ring Q S ( i , j ): e  X  i , j , r  X  X  where f r ( i , j ) stands for the mean value of input image f ( u , v )in S ( i , j ), and 9 Q r 9 is the total number of points in Q represents an estimate for the inter-cluster distance in Eq. (2.4) between the current sub-cluster of a homogeneous region and its adjacent regions as other sub-clusters.

The homogeneity constraint coefficient a in Eqs. (4.1) and (4.2) can be estimated by applying the maximum likelihood rule with respect to the two terms in Eq. (4.2) under the condition of low local variance and high regional contrast at point ( i , j ). If assuming exponential distributions with the parameters l e and l d maximum-likelihood estimate for the constraint coefficient becomes a  X  l e = l d . The values of the constraint coefficient close to a  X  1 was used in practice as a good approximation of its maximum-likelihood estimate for the given set of test LiDAR images.
 The seed selection method using the raster-image version tionally justified if it can be time-efficiently implemented. Direct computation of the clustering map in Eq. (4.1) involves local contrast and homogeneity maps, which are the contrast and homogeneity estimates for each image point and computed in L co-centric neighborhood windows defined by the L uniform scales ( Maragos, 1989 ; Lowe, 2004 ). Computationally, it can be repre-sented as a combination of multi-scale linear 2D filters with the ity of a multi-scale linear non-recursive filter alone will be O ( M L ) operations per pixel if computed directly, where L is the total number of scales (windows) simultaneously used and M is the O  X  J  X  M  X  X  , denotes the collection of functions exhibiting a growth that is limited to that of the function J  X  M  X  .

Consequently, the computation of the local clustering map has to be organized in a time-efficient mode using recursive compu-tations. We propose an exact method to time-efficiently compute in Eq. (4.1) using pre-calculated L multi-scale linear 2D filters.
First of all, separable linear 2D filters are implemented as two one-dimensional linear filters, which reduce the computational complexity by one order per pixel ( Di Ges u and Palenichka, 2001 ).
The possibility of recursive implementation of a separable linear filter can be readily evaluated by applying the concept of primitive kernel functions ( Di Ges u and Palenichka, 2001 ). A primitive kernel function of the order p is a differentiable function with its p th derivative equal to a constant or a constant multiplied by the function itself. Typical examples of primitive kernel functions are the power functions { x p }, exponential functions { e o x } and trigonometric functions {cos( o x )} and {sin( o x )}. The general approach to fast recursive computation of the local of linear combinations of separable linear filters with the impulse responses as particular instances of primitive kernel functions.
The kernel of an averaging filter, which is used in the recursive primitive kernel function since it is a constant value. For example, the local isotropic contrast in Eqs. (4.1) X (4.3) is computed as a linear combination of averaging filters: e 2  X  i , j , r  X  X  f 2 r  X  i , j  X  2 f r  X  i , j  X  1 9 Q point ( i , j ) using the filter window S r . The last two terms in
Eq. (4.4) are the averaging filters of images f ( m , n ) and f within the ring window Q r ( i , j ). The both averaging filters are implemented as a difference between the results of two averaging filters with the windows W r and S r , respectively ( Fig. 2 ). The homogeneity term d ( i , j , r ) in Eqs. (4.1) and (4.2) is also computed recursively as a linear combination of averaging filters. square or rectangular windows in the filtering operator. In the case of a circular window, we have proposed to approximate the circular window by a set of squares with different sizes, the total number of which is relatively small and independent from L . The overall complexity is reduced to O ( L ) operations per pixel by linearly combining the fast recursive implementations of averaging filters. 5. Selection of seed points seed points, their extraction has to be based on some formal conditions for an image pixel to be a good seed point. The seed selection process usually means the determination of an image location, intensity of which can serve as the seed intensity value in the region-growing segmentation. It corresponds to the assign-ment of initial values to the cluster centers (Section 2, Fig. 2 ). We can define three goodness-of-seed conditions as follows: 1) The seed point has to be located inside a homogeneous image 2) Preference is given to the seed-point locations , which have high 3) For a non-compact region , the seed point has to be located at the
Eq. (4.1) are selected as the candidate seed points in order to satisfy all the goodness-of-seed conditions:  X  i , j  X  k  X  arg max where ( i , j ) k is the k th candidate seed point, G is the image grid and Z k 1 is the regional mask after selection of previous seed points. This is a sequential procedure of local maxima determina-tion and masking of the segmented regions { A k } by the updated regional mask: Z k  X  Z k 1 [ A k .
 measures in the local clustering map contributes to the fulfill-ment of the first two goodness-of-seed conditions. Maximization in Eq. (5.1) occurs at the centers of circular sub-regions with high regional contrast and homogeneity. Another two properties of the local clustering map contribute to the fulfillment of the third goodness-of-seed condition. First, the minimum scale size in the given scale range is selected to be equal to the diameter of potentially largest parts of homogeneous regions. Second, the use of the background ring with a proportional diameter con-tributes to an increase in the local contrast at large scale sizes. The proportional diameter in the contrast estimation in Eq. (4.3) means the larger is the disk S r the wider is the ring area Q around it.
 maximum condition of the local clustering map j ( i , j )  X  F [ f ( i , j ), r ( i , j )] in that location. Another seed-point condition to be tested is the local contrast-to-variance ratio, which has to exceed a given regional saliency level, y : e  X  i k , j k , r k  X  = d  X  i k , j k , r k  X  4 y  X  5 : 2  X  contrast and mean-square deviation in the k th maximum point
Eqs. (4.1) X (4.3). The saliency level y in Eq. (5.2) quantitatively determines the quality of a seed point in the first two goodness-of-seed conditions. It can be set to its minimum value, y  X  1, when it is not given explicitly. This is justified by the sequential determination of the local maxima according to the flowchart in selected as the seed points because of a low value of y , they will be further eliminated as being masked at the stage of region growing. 6. Scale-adaptive region growing growing algorithm ( Adams and Bischof, 1994 ) to improve image segmentation in the case of LiDAR surface data. The first mod-ification is to use an adaptive threshold in the basic condition for region growing, which depends on statistical characteristics of the region under growth. The second one is the simultaneous con-sideration of two basic conditions for stopping the region growing instead of using only one based on a single attribute. Extension to multiple basic conditions with multiple attributes is straightforward. Since all these conditions and adaptive thresh-olds rely on the local scale r ( i , j ) at the seed point, we call the region-growing algorithm scale-adaptive. For a pixel f ( i , j ) already labeled as belonging to k th region, A k , the condition that its nearest neighboring pixel belongs to the same region is if 9 f  X  m , n  X  a k  X  i , j  X  9 o Z U s k  X  i , j  X  then  X  m , n  X  belongs to A where ( m , n ) are the coordinates of the current pixel, which is the attribute mean in the k th region, s 2 k ( i , j ) is an estimate of the intensity variance for k th region and Z is the threshold coefficient. At the outset of the region growing, the point ( i , j ) coincides with the k th seed point, ( i , j ) k . The threshold coefficient Z in Eq. (6.1) can be determined when assuming a particular distribution for the selected attribute of a homogeneous region. A Gaussian distribution is a suitable choice since it describes quite well an attribute cluster in the clustering approach to image segmenta-mean value and variance of the Gaussian distribution calculated based on the surface attribute sample within S r ( i , j )( Fig. 2 ). Therefore, by setting the probability of correct labeling as the segmentation accuracy, we can determine the corresponding value of Z from the standard table of the normalized Gaussian distribution G (0;1).

For some cases of surface data such as the task of LiDAR image segmentation in forest areas, the homogeneity predicate in Eq. (6.1) is not sufficient alone to provide a reliable segmentation. For example, a too low threshold can lead to an over-segmenta-tion at smooth borders between image regions. Therefore, an additional condition has to be used to better distinguish adjacent regions. This condition can be formulated considering a different surface attribute. In particular, relatively high magnitude of the surface gradient r f ( m , n ) is the token of edge presence between adjacent regions: if 9 where r f  X  m , n  X  X  where f x ( m , n )  X  ( f ( m s , n ) f ( m  X  s , n ))/2 s and f f ( m , n  X  s ))/2s are the estimates of the image derivatives in ( m , n ), b ( i , j ) is the estimate for the gradient mean in the k th region, d ( i , j ) is the estimate of the gradient variance for k th region, 2 s is the differentiation step and m is the threshold coefficient. Simi-larly to Eq. (6.1) the threshold coefficient m can be determined assuming a Gaussian distribution for the gradient magnitude inside the region.

Simultaneous fulfilment of the two conditions in Eqs. (6.1) and (6.2) results in labeling the current pixel ( m , n ) as belonging to the region A k . Summarizing the proposed scale-adaptive region growing, the thresholds are calculated as proportional to the mean square deviations of the corresponding segmentation attri-butes in the circular region S r ( i , j ) with the diameter R differentiation step 2 s is also chosen to be directly proportional to the local scale. In our experiments, the differentiation step was set to s  X  R r /8 in order to distinguish the real gradient values from the intensity random fluctuations in the disk region S r ( i , j ) with the diameter R r .

Other surface attributes, which are relevant to a particular segmentation task, can be used besides the gradient magnitude in order to improve the segmentation accuracy. Assuming N attri-bute conditions, the decision of joining a point ( m , n ) to the current region A k can be formulated as follows: if f where x q ( m , n ) is the value of q th attribute in the point ( m , n ), a k , q ( i , j ) is an estimate for the q th attribute mean value in the the region A k and { Z q } are the threshold coefficients. A simple probabilistic analysis of Eq. (6.4) shows that an increment of the adaptation coefficients with the simultaneous use of multiple attribute conditions will decrease the error rate while keeping the false positive rate steady. The false positive case occurs when the point ( m , n ) does not belong to the current region A k inequalities in Eq. (6.4) hold. Some increase of { Z q , 8 q  X  1, will increase the threshold values, thus joining the pixel ( m , n )to the region A k . On the other hand, the constraint of simultaneous satisfaction of all the N conditions in Eq. (6.4) will reject pixels, which belong to the regions adjacent to the current region A latter will restrain the false positive rate from growing. 7. Experimental results
The main goal of the experiments was to evaluate the accuracy of the proposed multi-scale segmentation for the case of LiDAR images of natural scenes including forests, parks and individual trees in residential sub-urban areas. The main application is forestry, namely, segmentation of individual trees for automatic measurement of their characteristics. Majority of the testing areas are selected from forest stands located in a boreal forest. This is a natural terrain area without buildings and other structured features, which is challenging in terms of locating seed points for the segmentation of tree crowns. In particular, the variability of tree crowns by height, size and inter-tree distance creates difficulties in segmenting individual trees. Another testing site is a sub-urban residential area including houses, rivers, individual trees, etc. In the experimental data sets, the 3D coordinates of a surface point are determined by measuring the time delay in receiving the first return data pulse of an airborne LiDAR sensor ( Campbell, 2002 ). The scanning of the entire area provides 3D coordinates of surface points, which are visible to the scanner. The LiDAR scanner system used in the experiments provides the height accuracy of 0.2 m and spatial resolution 0.5 m per pixel in the DSM image. The DSM image is generated from the 3D points by applying the triangulated irregular network (TIN) method followed by the smoothing and image grid generation.

The image segmentation experiments for several test areas consisted of computation of the multi-scale local clustering map, seed selection and region segmentation using the scale-adaptive algorithm described in Section 6. In the case of forest areas, the objects of interest are tree crowns and no other objects are supposed to be located in the test area. In some particular cases of surface segmentation, additional constraints on seed points may be imposed. For the case of many object regions and a single background (Eqs. (2.1) and (2.2)), the condition of object presence as a positive height contrast with the background (e.g., the terrain surface) has also been exploited. This test allows us to avoid selecting seed points located in the background region.
The segmentation results shown in Figs. 4 X 7 demonstrate the effectiveness of the proposed method and its potential for LiDAR and other surface segmentation applications. The segmentation performance was numerically evaluated using two characteristics of the segmentation accuracy. The first characteristic is a coarse measure, which evaluates the segmentation result by a correct segmentation rate. If an object region was segmented as an isolated region from other objects of interest and the background, it represents a positive case; otherwise a gross segmentation error is occurred. In particular, if two individual tree crowns were segmented as one region, then the error count was also increased by one. In order to evaluate the correct segmentation rate, the outcome is compared with the ground truth data. An object presence such as a tree crown is verified based on the measure-ment data in the field. The correct segmentation rate is the ratio of all correctly segmented object regions to the total number of object regions in the considered test area. The results of the segmentation accuracy testing for the four test areas in Figs. 4 X 7 are given in Table 1 . As it can be seen from Table 1 , the use of two surface attributes in the region-growing algorithm enhances the segmentation accuracy as compared with the case of a single attribute, i.e., the surface height. We have complemented the correct segmentation rates in Table 1 by the false positive rates. The false positive rate is the ratio g of falsely segmented objects to the total number of negative cases as no-object areas, which is mostly an erroneous segmentation of objects in the background region. We have estimated the false positive rate as the maximal value among all partial false positive rates over the four test areas shown in Figs. 4 X 7 . Estimation of the confidence level for the correct segmentation rate as (1 X  g ) is suitable for the case of coarse segmentation accuracy measure since 100 g % charac-terizes the percentage of falsely segmented object regions.
The constraint coefficient a in Eqs. (4.1) and (4.2) was set to  X  1.0 and the scale range included 16 uniform scales in most of the experiments that we have conducted. The saliency condition in Eq. (5.2) was involved in the verification of candidate seed points. In particular, the saliency threshold y was set to be 35% of the saliency value at the global maximum of the local clustering map in Eq. (4.1). In the region growing algorithm, the threshold coefficients Z  X  2.4 and m  X  2.0 in Eqs. (6.1) and (6.2) have been used.

An accuracy characteristic at the fine level of errors  X  called block segmentation error  X  is introduced in order to evaluate the object region segmentation more precisely, i.e., on the level of individual image blocks containing I I pixels each, where I depends on the least scale size R 1 : I  X  R 1 /2. The block segmenta-tion error is computed by the normalized Hamming distance between the segmented binary image and the reference binary image of the object regions. The conventional Hamming distance is divided by the total number of blocks in the reference image for the normalization purpose. The Hamming distance between two binary images is the sum of exclusive OR operations taken pair-wise for all image blocks in the two images.

Since the reference image (ground truth) for given LiDAR data is problematic to obtain at the pixel level, a semi-synthetic image was used as follows. The reference segmentation result was obtained from a real DSM image by a simple thresholding with the threshold value set at the lowest acceptable tree-crown height. Before this, the terrain slope was eliminated from the DSM by the subtraction of the digital terrain map (DTM), which was also derived from the initial 3D LiDAR data set. In order to model natural variations of tree crown surfaces, a smoothing filtering combined with white noise model was implemented to obtain a representative sample of LiDAR semi-synthetic images. The terrain slope was modeled by adding a linear surface to the test image. The proposed segmentation algorithm was applied to each of the noisy images at different noise levels to estimate the segmentation error ( Fig. 8 ). As a result, the plot of the block segmentation error versus the signal-to-noise ratio was obtained ( Fig. 9 ). It characterizes the stability of the proposed multi-scale segmentation with respect to different image perturbations by noise, which also model the real variability of LiDAR images for the case of tree crowns. The signal-to-noise ratio in our modeling is the ratio of image intensity range to the noise mean-square deviation. The confidence interval for the block segmentation error is 7 0.11 of the estimate values in Fig. 9 at the 0.95 confidence level. It was determined as being based on the assumption of normal distribution for the block segmentation error estimate since it is the sum of a large number of individual block errors.

In the conducted experiments on tree-crown segmentation, the local scale range was chosen to cover all possible sizes of tree crowns shown by white circles in Fig. 8 b. Different gray levels in Fig. 8 c indicate the individual labels for the segmented tree crowns. The intensity level of segmented regions in Fig. 8 cis inversely proportional to the order of their sequential detection and region-growing from the seed points. The tree crown regions as white pixels in Fig. 8 d have been used to obtain the segmenta-tion error plot in Fig. 9 . For comparison, a conventional single-scale region-growing algorithm was also tested on the same semi-synthetic images. In particular, the existing region-growing algo-rithm ( Tiede et al., 2005 ) for tree crown segmentation in forest areas was implemented and tested ( Fig. 8 e). This algorithm is not scale-adaptive: it directly selects seed points at local maxima of the LiDAR image. The application of the existing algorithm ( Tiede et al., 2005 ) resulted in more segmentation errors than our normalized segmentation error method because of the inappropriate selection of seed points and threshold values. In particular, under-segmentation of tree crowns and some false object areas are visible in Fig. 8 e. We have obtained about 30% of the performance improvement over the region-growing segmentation ( Tiede et al., 2005 ) for moder-ate (middle) signal-to-noise ratio levels.
 containing a multi-level building ( Fig. 10 ) in order to visually illustrate the comparative performance of the proposed algorithm for the case of multi-level surfaces. The segmentation goal in this example is to segment buildings and high-tree regions from the terrain surface and other low-height objects on it, which are considered as the background. The seed points extracted with the proposed method are shown in Fig. 10 a with their local scale as the diameter of the red circles. The contours of segmented object regions are shown in Figs. 10 b and c. Multiple seed points for a single homogeneous region were eliminated during region growing by joining them to the current region as regular points.
Note that in this example the conventional region growing algo-rithm ( Pal and Pal., 1993 ) gave gross errors since a low-height building part (near the high rectangular building) was not segmen-ted ( Fig. 10 c). A large part of the terrain region was mistaken as an object region. These errors have o ccurred because of inappropriate selection of the seed points or threshold values in the region-growing algorithm. 8. Conclusions using seeded region growing is proposed. The seed points for region growing are selected as consecutive local maxima of the multi-scale clustering map, which indicate the centers of homo-geneous regions with high contrast. This method has several advantageous characteristics as compared with other existing techniques in the context of LiDAR image segmentation. First, the seed points can be localized in a computationally efficient manner without prior knowledge about the regional layout of the image plane and the distribution of the surface attributes. Second, the segmentation procedure is considered as a local clustering that takes into account not only the region homogeneity but also its local intensity contrast with the adjacent regions as other clusters. This contributes to an increase in the overall segmenta-tion accuracy and perceptive authenticity of the segmented images. Third, all the regions are sequentially segmented in a single mode, without using common post-processing procedures such as region merging or region splitting. Fourth, the proposed approach provides an automatic selection of thresholds in the region-growing algorithm. The experiments on LiDAR image segmentation in different test areas have shown good accuracy of the proposed method. Besides the LiDAR remote-sensing images, this method can effectively be applied to segmentation of range and ultrasound images representing object surfaces in industrial and medical diagnostic imaging.
 References
