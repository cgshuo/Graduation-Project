 The trading activities of materials retail is concerned wit h an extremely competitive market. However, business people are not well informed about how to proceed and what to do during marketing activities. Data mining methods could be interesting to generate substantial profits for decision ma kers and to optimize the choice of different marketing activities . In this paper, we propose an actionable knowledge discov-ery methodology, for one-to-one marketing, which allows to contact the right customer through the right communica-tion channel. This methodology first requires a measure-ment of the tendency for the customers to purchase a given item, and second requires an optimization of the Return On Investment by selecting the most effective communication channels for attracting these customers. Our methodology has been applied to the VM Mat  X eriaux company. Thanks to the collaboration between data miners and decision mak-ers, we present a domain-driven view of knowledge discovery satisfying real business needs to improve the efficiency and outcome of several promotional marketing campaigns. H.2.8 [ Database Applications ]: Data mining; I.2.6 [ Learning ]: Knowledge acquisition; J.1 [ Administrative Data Pro-cessing ]: Marketing Performance, Management, Experimentation Actionable knowledge discovery, domain-driven data min-ing, customer relationship management  X 
Thomas Piton is a CIFRE PhD student of the LINA labo-ratory and VM Mat  X eriaux company, 85260 L X  X erbergement, France.

Knowledge Discovery in Databases is the non-trivial pro-cess of identifying valid, novel, potentially useful, and u lti-mately understandable patterns in data [16]. Domain Driven Data Mining [10, 4, 8] targets the development of next gen-eration data mining methodologies, frameworks, algorithm s, evaluation systems, tools and decision support. It aims at promoting the paradigm shift from data-centered hidden pattern mining to domain-driven actionable knowledge dis-covery. Cao [5] proposes a methodology of Domain Driven Data Mining to narrow down the gap between academia and business. Moreover, Cao and Zhang [9] propose a practi-cal perspective in Australian Stock Exchange data, referre d to as domain-driven in-depth pattern discovery (DDID-PD), presenting a domain-driven view of discovering knowledge satisfying real business needs.

In the last 10 years, applications of data mining and knowl-edge discovery have been increasingly undergoing enormous transformation [27], influenced by seismic external forces such as the enormous growth of web/e-commerce, tremen-dous progress in biology, and frequently controversial use of data mining for homeland security [30]. Other domains of applications are financial data mining [28], actionable tra d-ing agents in capital markets [6], actionable trading strat e-gies and exceptional market microstructure behavior pat-terns [7]. Moreover, in the social security area, the concep t of activity mining [11] and combined mining [37] have been proposed. New algorithms suggest actions to change cus-tomers from an undesired status (such as attritors) to a de-sired one (such as loyal) while maximizing the expected net profit [35]. It is asserted that data mining should not only increase understanding, but should also assist managers to solve problems and reach decisions [17].

In recent years, data mining [12] has found numerous applications in industry and commerce [25] [26], many of which fall within the framework of Customer Relationship Management (CRM), i.e. mining customer data to cre-ate, develop and maintain profitable relationships with cus -tomers [29]. Methods such as regression analysis, decision trees, clustering, or association rules have been used in th is context [1]. They are generally complemented with postpro-cessing methods such as visualization [24] [15] and interes t ranking [36] [20] [18].
However, data mining has been applied to CRM in many industries with limited success [21]. In large organizatio ns, it is not very straightforward to collect and transform data to create systems that will support CRM [31]. Consequently, there is a consequent strong limitation in the number of cus-tomers that the company can take on. For each customer, there may be a large number of possible actions that can be applied [35]. But actions, such as emailing, direct mail-ing and salespersons X  visits cost the company money [34]. To overcome this drawback, marketing managers need to acquire relevant knowledge on a one-to-one basis to decide which are the most effective communication channels to use for each customer, while avoiding flooding customers with messages. Although finding customer patterns and trends is useful, formulating marketing, sales and customer support strategies requires knowledge that business experts can ap -ply directly ( X  X ctionable knowledge X  paradigm [4]).
This paper contributes to the latter task by proposing an actionable knowledge discovery methodology, for one-to -one marketing, which allows to contact the right customer through the right communication channel. The methodol-ogy reported in this paper focuses on the practical frame-work, called domain-driven in-depth pattern discovery [9]. DDID-PD highlights a process that discovers in-depth pat-terns from constraint-based context with the involvement of domain experts. Its main ideas include constraint min-ing [22], in-depth mining , human-cooperated mining [2], and loop-closed mining . Our methodology for CRM requires firstly to measure the tendency of customers to purchase an item, and secondly to optimize the Return On Investment (ROI) by selecting the most effective communication chan-nels for attracting these customers. Our methodology has been applied to the company VM Mat  X eriaux 1 , within the context of a wholesaler, for building materials retail. We were able to improve several promotional campaigns thanks the involvement of business experts.

The rest of the paper is organized as follows: Section 2 describes our actionable knowledge discovery methodology for CRM. Then, in Section 3, an application of the method-ology for improving a VM Mat  X eriaux promotional campaign with KXEN program is presented. Finally, conclusions and future work are summarized in Section 4.
This section presents our methodology which will be in-stantiated according to a concrete application in section 5 with KXEN program. KXEN program uses Vapnik X  X  Struc-tural Risk Minimization [33] for optimal accuracy and ro-bustness compromisation. The dataset is divided into three subsets for training, validation and the test to measure the performance of the final model [14]. The proposed method-ology consists of four steps: scoring customers for purchas es choosing marketing channels (Section 2.3) and the Return the business On Investment model (Section 2.4). Let us consider an array (Table 1) of customers for whom the binary target variable means the purchase in a promotional campaign (1 for pur-chase, 0 otherwise) and the continuous target variable mean s net margin generated by the visiting customer.

Customers Binary target Continuous target
To predict the binary target for purchases, we choose to calculate a tendency score with a ridge regression.
Ridge regression has the advantage of placing a penalty in the size of the coefficients and has the privilege of be-ing insensitive to correlations. When predictors are corre -lated least squares may use this correlation to balance out the effects of each predictor. Ridge regression can provide the contribution, i.e. a polynome weight W x , that is used to show the relative importance C x of a variable x in the model [32]: In our work, the purpose of ridge regression is to provide the potential buyers for a promotional campaign in a population . Given a threshold s , we predicted that a customer i is a buyer if the score s i calculated by the model is greater than s (Table 2). Let u ( s ) be the proportion of customers whose score calculated by the model is greater than s : Let v ( s ) be the real proportion of buyers identified by the model: Finally, ridge regression allows us to obtain a score func-tion s i in decreasing order for each customer i reflecting the probability p i (obtained by normalization of s i ) to purchase during the promotional campaign.
In order that decision makers can graphically visualize the accuracy and robustness of our models, we use lift curves (Curves C 3 and C 4 on Figure 1). A lift curve (variation of ROC curve) is a parametric curve representing the propor-tion of buyers detected v ( s ) with relation to the proportion of customers selected u ( s ) [19]. The accuracy and robust-ness of a model can be measured by comparing the lift curve to random and ideal curves (Curves C 2 and C 1 on Figure 1). The random curve is the curve y = x (we detect  X  % buy-ers selecting  X  % customers). The ideal curve is the one in which all buyers are selected first. From the lift curve, two indexes can be calculated. The first index is the Gini index [13], named KI in KXEN program. It corresponds to the area between the validation curve and the random curve, and measures the accuracy of the model, i.e. the ability of input variables to explain the target. The second indicator , named KR in KXEN program, corresponds to the difference in area between the estimation and the validation lift curve s. It measures the robustness of the model, i.e. its ability to provide the same level of quality on a new dataset, typically the validation dataset. 100 % of the target detected
This part of our methodology allows us to get a lift curve which is related to the quality of the model using the two indexes KI and KR (referred to in-depth pattern mining [9]). The naive profit curve in the next part allows us to introduce economic constraints in customer targeting.
In order to help decision makers estimate the ROI gener-ated by a model on a promotional campaign, we use naive profit curves on training or validation datasets. A naive profit curve is the transformation of a lift curve with a cost matrix (Figure 3) defined by the decision makers. The naive profit of the promotional campaign can therefore be defined as follows: the net margin achieved by contacting u ( s ) % customers. Let N be the number of customers in the sample studied, G the average net margin per customer and H the average spending communication per customer (Table 3). naiveP rofit ( s ) = N  X  [ P ( i = buyer | s ( i )  X  s )  X  ( G  X  H )
The theoretical maximum profit, profitMAX , is obtained with the model where all buyers are selected first. Thus, a naive profit curve (Figure 2) is a parametric curve represent -ing the profit rate ( naiveP rofit ( s ) /profitMAX ) according to the proportion of u ( s ) selected customers. This curve presents a different Y-axis of the lift curve with the percent -age of maximum profit in order to graphically measure the ROI of the promotional campaign. For example, the point N (Figure 2) means that on the validation dataset, we contact 48 % of the population to achieve a maximum profit equal to 82 % of maximum theoretical profit. Therefore, this part of our methodology allows us to obtain the optimal point (maximum Y-axis) on the curve indicating the proportion of the population to be contacted.
 100 profit rate
To predict net margin g i per customer i , we choose to use a second ridge regression.
Often the score generated by the ridge regression can be very ambiguous for an interpretation of decision makers. This restriction is solved by using a second result: the esti -mation of net margin generated per customer. We consider a continuous target variable representing the amount of net margin g i during the promotional campaign. The purpose of this second ridge regression is to provide the approximat e net margin g i per visiting customer. The training dataset is less important than in the case of a regression with a binary target variable. Moreover, important customers represent a small dataset and therefore it is more difficult to determine their purchasing behavior. Therefore, the model generated is less precise and constitutes a secondary opinion to sort the list. Using a ridge regression with a continuous target variable implies the absence of lift and naive profit curves (Figures 1 and 2).
We can combine the results of the two ridge regressions to optimize the routing of customers. The scores generated point) and allow us to classify customers in descending or-der. Then, we complete this classification with the result of the second regression, i.e. the net margin. For customers with very close scores, the classification is altered accord ing to their estimated net margin. For merging lists of rout-ing, the marketing manager and the purchasing director of VM Mat  X eriaux decided to attach more importance to a new customer (i.e. p i value) towards the development of the net margin per customer (i.e. g i value).
Despite the emerging challenge from new media, tradi-tional channels of salesperson sales, for example visit, ph one, mail, and mass media remain strongly in use [3]. The use of too many, or inadapted, channels may end up having a contrary effect on the promotional campaign. Which chan-nels are most effective in eliciting response (in our case to purchase)? The purpose of our methodology is to address all these issues to optimize the use of marketing channels according to scoring. In materials retail, customers are no t willing to communicate through all channels. Therefore, we chose the following channels: 1. Visit : a salesperson sales visit to the customer to in-2. Mail : a letter is designed by an external company and 3. E-mail : a message is designed by an external company 4. Phone : arguments are prepared by an external com-5. SMS : an SMS is designed by VM Mat  X eriaux and sent 6. Fax : a fax is designed by an external company and
In Tables 4 and 5, we distinguish fixed and variable costs for each marketing channel. These costs were defined by the marketing manager, the purchasing director of VM Mat  X eri-aux company and two external communication companies. As an example: the creation (fixed costs) of an e-mail will cost much more than sending (variable costs), depending on the number of customers n . Therefore, we can generalize the cost of using a marketing channel j as follows: with, F C j the fixed costs for channel j , V C j the variable costs per customer for channel j and n j the number of cus-tomers contacted through channel j .

Channel Fixed Justification
Channel Variable Justification
Considering that our customers contact information is complete and current, we measure three different criteria fo r estimating the customers X  response rate for each marketing channel j (Table 6).
These results are the findings of survey conducted inter-nally at VM Mat  X eriaux with the trading director, purchas-ing director and sales force teams. They can be adapted for other kinds of business domains. In in-depth mining , more attention should be paid to business requirements, domain knowledge and qualitative intelligence of domain experts f or their impact on mining deep patterns [9].

Channel Maximum Certainty Convincement E-mail 100 % 30 % 10 %
Let C be a channel class, i.e. a set of different compat-ible marketing channels. Using several channels improves the chance of reaching the different types of customers and convincing them. The channel class might be { Visit, Mail, SMS } . However, it is not desirable to over communicate with the customers. In order to choose the best channel class to use, we try to maximize the estimated profit per customer. If the channel class C is used, a profit estimation per customer i is: CustomerP rofit ( i, C ) = p i  X  g i  X  max The maximum max we do not take into account interactions between different marketing channels on the same customer. Then, for each customer i , we choose C i which maximizes the previous equation: Since the desire of VM Mat  X eriaux is to use all marketing channels, the fixed costs F C j will be paid anyway.
The methodology presented above allows us to propose an equation to calculate the expected ROI for our promotional campaign assuming that for each customer i , class C i has been decided (Equation 7).

ROI = X The average cost of data mining depends on the number of promotional campaigns processed with our methodology. In contrast, the marginal cost of a new campaign will be lower. The average cost decreases when the marginal cost is below the average cost. This example illustrates the  X  X cale-up X  and demonstrates the interest in increasing our production models to reduce our average cost [23].
The VM Mat  X eriaux trading group organizes two promo-tional days to promote all products in its material retail-ing. This promotional campaign is reserved for professiona l building workers and allows to obtain various gifts subject to their achievement of a limit net margin. Previously, sale s force teams approached all customers, who had achieved a net margin above a certain threshold, by one or several mar-keting channels. Now, we apply our methodology presented in section 2 to our promotional campaigns. Finally, we cre-ated a work cell consisting of decision makers and data min-ers. This cell was a synergy to find the business question:  X  Understanding and providing customer routing list for the next promotional campaign, and optimizing the use of mar-keting channels  X .
The involvement of domain experts and their knowledge can reduce the complexity of the knowledge discovery pro-cess in the constrained world. This section highlights the i m-portance of the decision makers during the knowledge data discovery process. The retail director, the marketing man-ager, the purchasing director and the sales force team of VM Mat  X eriaux company turn data into information and informa-tion into knowledge. These stages correspond to the concept  X  X uman Cooperated Mining X  proposed in the paper [9]:
We decided to collect data from our datawarehouse com-posed of approximately 61 000 mega-bytes and 140 tables. We created three distinct datasets: binary target training dataset , continuous target training dataset and application dataset .
The binary target training dataset contains 12 170 ob-servations (15.35 % with value 1). The continuous target training dataset contains 3 677 observations. The applica-tion dataset contains 16 500 observations.
Real world business problems and requirements are often tightly embedded in domain-specific business rules and pro-cesses with expertise (referred to constraint mining in [9]). Therefore, customers are described by three kinds of vari-ables.
This preprocessing of data produces a model with 173 variables (Table 7).
 Category Number Type External 15 spread-sheets, non structured Aggregates 144 continuous
The binary target model is accurate and robust with KI = 0 . 857 and KR = 0 . 975. 155 of 173 variables have been se-lected preserving the accuracy and robustness of the model. The two curves on Figures 3 and 4 allow us to judge the quality of the model.

The continuous target model is less accurate and less ro-bust than the first model with KI = 0 . 717 and KR = 0 . 968. In the following interpretation, we focus on the binary targ et model.
Let us visualize the contribution of variables (Section 2.1 .1) to indicate the variables contributing to the purchase (bin ary target) during the promotional campaign (Figure 5).
Figure 5: The eight most contributing variables.
Figures 6 and 7 represent the significance of the values of the variables. Y-axis indicates whether the value has a positive or a negative influence on the binary target variabl e. Figure 6: Significance of variable  X  X urnover X  for the month 5 (two months before the campaign).
Figure 7: Significance of variable  X  X alespersons X .
The application of the model is done on the application dataset (16 500 observations). We obtain two variables p i and g i allowing us to sort customers (Section 2.2.2). For example, customers PR032912 , PR032855 , PR033033 and PR159582 have the same probability p i (10  X  4 after decimal point) but PR032912 and PR159582 are higher in the list because their expected net margins g i are twice as high (Fig-ure 8). The combination of the two ridge regressions allows us to reach the two objectives of the campaign: to increase sales and to improve the ROI.

Customer Probability Expected p i  X  g i PR032912 0.964995889 4 384.68 4 231.20 PR159582 0.964965548 4 121.34 3 976.95 PR032855 0.964971733 2 240.29 2 161.82 PR033033 0.964968251 2 162.17 2 086.42
Let us generate a cost matrix to personalize naive profit curve (Section 2.1.3). To achieve this task, we must define the average net margin G achieved by a customer during the last campaign: about 1 500 = C . In the same way, we have to calculate the average spending communication H per customer: about 62.5 = C . The maximum of the naive profit curve on Figure 8 indicates the optimum proportion of customers to contact: 50.3 % with 88.14 % of the profit rate. Our routing list is composed of these 8 230 customers. Figure 8: Naive profit curve of binary target model.
The statistical validation of the model was verified in sec-tion 3.4 with two indexes KI and KR. However, we have to validate results by comparing sales force team list with our methodology list. Quantitatively, about 7 000 customer s were common to both lists. Moreover, all customers present in sales force team list are in our list. However, 1 175 cus-tomers are not included in the sales force team list. They represent very interesting but hardly-to-find customers: v ery recent customers and customers whose turnover has just been growing.
The experience gained over ten years of routing during promotional campaigns led us to define three channel classes with sales management (Section 2.3.4) representing a strat e-gic choice for VM Mat  X eriaux company. The sum of each variable costs, V C j , per channel class, C , was calculated using Table 5 and is expressed in Table 9. Moreover, the values for certainty, Ct j , and convincement, Cm j , per channel j are taken from Table 6, and the values for X , Y and Z are given in Table 10 (validated by VM Mat  X eriaux sales force team). The assignment of a customer, i , to the best channel class, C i , is obtained from Equa-tion 7 (Section 2.3.4) and summarized in Table 11. Also, the assignment is limited (roughly) by the maximum con-tacts property in Table 6.
 Table 9: Sum of variable costs of channel classes
Note that for VM Mat  X eriaux , a constraint coefficient,  X  is introduced in Equation 6 to multiply the variable costs V C j . Indeed,  X  ij is equal to 1 except for channel j = V isit for which the value depends on the turnover of the customer i . The goal is to encourage salespeople to visit customers presenting a good potential but a small penetration rate.
We applied the formula 8 of Section 2.4 to compute the ex-pected ROI. This estimation of profit was very good since it proved (after the campaign) to be equal to the effective profit (with less than 5 % of error margin). During the previous operation, the rate of buyers was 18 %. Whereas in the last one, by applying our methodology, the rate of buyers raised up to 22 %, the turnover was increased by 5 %, and 115 new customers participated, representing about 1 200 000 euros of additional turnover.
To improve customer relationship, the company must know what actions to take to optimize its communication with customers. In this paper, we propose an actionable knowl-edge discovery methodology for one-to-one marketing which endeavours to contact the right customer through the right communication channel. This methodology is referred to as domain-driven in-depth pattern discovery . Our method-ology applied to CRM first requires a measurement of the tendency for the customers to purchase a given item, and second requires an optimization of the Return On Invest-ment by selecting the most effective communication chan-nels for attracting these customers. The application of rid ge regression models built with KXEN has been able to high-light the richness of VM Mat  X eriaux datawarehouse to predict customers X  tendency to purchase an item during promotional campaigns and to choose the most suitable marketing class channels. The ROI was improved, with 115 new customers, representing about 1 200 000 euros of additional turnover. The construction of datasets and the production of models were automated in VM Mat  X eriaux company. We designed a prompt checking by decision makers and allowing to cre-ate datasets (Section 3.3.1) on the most active customers. Today, models are automated and results of the regressions are stored in the datawarehouse. The model is being gener-alized to three promotional marketing campaigns in April, September and November of each year.

From our experience, our methodology can be extensively used for any type of one-to-one multichannel promotional campaign. The actionable knowledge discovery was intro-duced in VM Mat  X eriaux datawarehouse with the aim of in-tegration into a CRM software program. The results dis-cussed in this paper offer effective solutions to extract ac-tionable knowledge to intelligent CRM for companies. In our future work, we will try to combine other methods of data mining to improve our methodology (associations rules for instance) with customer purchasing potential, with a view of preventing customer  X  X hurning X  during promotional cam-paigns, and of suggesting high profit materials to customers with the highest tendency. The authors would like to thank Pierrick Richard and Ga  X  etan Blain ( VM Mat  X eriaux company) for supporting this work. They also thank Laurent Tessier (KXEN company) for his comments. [1] R. Agrawal and R. Srikant. Fast Algorithms for [2] M. Ankerst. Report on the SIGKDD-2002 panel the [3] P. Barwise and J. U. Farley. The State of Interactive [4] L. Cao. Domain-Driven, Actionable Knowledge [5] L. Cao. Domain Driven Data Mining (D3M). In [6] L. Cao, C. Luo, and C. Zhang. Developing Actionable [7] L. Cao and Y. Ou. Market Microstructure Patterns [8] L. Cao, P. Yu, C. Zhang, and H. Zhang. Data Mining [9] L. Cao and C. Zhang. Domain-Driven Actionable [10] L. Cao and C. Zhang. Domain-Driven Data Mining: A [11] L. Cao and C. Zhang. Mining Impact-Targeted [12] H. M. David J. Hand and P. Smyth. Principles of [13] C. Drummond and R. Holte. Cost Curves: An [14] F. Fogelman-Souli  X e and E.Marcad  X e. Industrial Minin g [15] U. Fayyad, G. Grinstein, and A. Wierse. Information [16] U. M. Fayyad, G. Piatetsky-Shapiro, P. Smyth, and [17] W. Graco, T. Semenova, and E. Dussobarsky. Toward [18] R. Gras, E. Suzuki, F. Guillet, and Filippo. Statistical [19] Q. Gu, L. Zhu, and Z. Cai. Study on Measure Criteria [20] F. Guillet and H. Howard. Quality Measures in Data [21] S. H. Ha, S. M. Bae, and S. C. Park. Customer X  X  [22] J. Han, L. V. S. Lakshmanan, and R. T. Ng.
 [23] T. Highley and P. Reynolds. Marginal Cost-Benefit [24] D. A. Keim. Information Visualization and Visual [25] A. Kusiak. Data mining: Manufacturing and Service [26] C. X. Ling and C. Li. Data mining for Direct [27] M. Lobur, Y. Stekh, A. Kernytskyy, and F. Sardieh. [28] O. Maimon and L. Rokach. Data Mining and [29] C. L. Ming Ren, Zuoliang Chen and G. Chen. An [30] G. Piatetsky-Shapiro. Data mining and Knowledge [31] B. Rahul and Z. Yi. CRM Systems Used for Targeting [32] R. T. Trevor Hastie and J. Friedman. The Elements of [33] V. Vapnik. The Nature of Statistical Learning Theory . [34] Q. Yang, J. Yin, C. Ling, and T. Chen. Postprocessing [35] Q. Yang, J. Yin, C. Ling, and R. Pan. Extracting [36] Y. Zhao, C. Zhang, and L. Cao. Post-Mining of [37] Y. Zhao, H. Zhang, L. Cao, C. Zhang, and
