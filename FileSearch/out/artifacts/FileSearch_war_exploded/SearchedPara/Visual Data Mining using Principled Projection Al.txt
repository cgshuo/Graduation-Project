 We introduce a flexible visual data mining framework which combines advanced projection algorithms from the machine learning domain and visual techniques developed in the in-formation visualization domain. The advantage of such an interface is that the user is directly involved in the data min-ing process. We integrate principled projection algorithms, such as generative topographic mapping (GTM) and hierar-chical GTM (HGTM), with powerful visual techniques, such as magnification factors, directional curvatures, parallel co-ordinates and billboarding, to provide a visual data mining framework. Results on a real-life chemoinformatics dataset using GTM are promising and have been analytically com-pared with the results from the traditional projection meth-ods. It is also shown that the HGTM algorithm provides additional value for large datasets. The computational com-plexity of these algorithms is discussed to demonstrate their suitability for the visual data mining framework. G.3 [ Probability and statistics ]: Probabilistic algorithms; H.5 [ Information interfaces and presentation ]: User interfaces Algorithms, Design, Human factors Visual data mining, probabilistic projection algorithms, in-formation visualization techniques.
The wide availability of ever-growing datasets from dif-ferent domains has created a need for effective knowledge discovery and data mining. For data mining to be effective, it is important to include the domain expert in the data ex-ploration process and combine the flexibility, creativity, and Copyright 2006 ACM 1-59593-339-5/06/0008 ... $ 5.00. general knowledge of the domain expert with automated ma-chine learning algorithms for better results [10]. The princi-pal purpose of visual data exploration is to present the data in a visual form with interactive exploration facilities, al-lowing the domain expert to get insight into the data, draw conclusions, and understand the structure of the data.
The exploration of heterogeneous information spaces re-quires suitable mining algorithms as well as effective visual interfaces. Visual techniques on their own cannot entirely replace analytic nonvisual mining algorithms to represent a large high-dimensional dataset in a meaningful way. Rather, it is useful to combine multiple methods from different do-mains for effective data exploration [11].

Ankerst [1] classified visual data mining approaches into three categories. Methods of the first group apply visual methods independently of data mining algorithms. The sec-ond group uses visual methods in order to represent patterns and results from mining algorithms graphically. The third category tightly integrates both mining algorithms and vi-sual methods in such a way that intermediate steps of the mining algorithms can be visualized and further guided by the domain expert. This tight integration allows users to control and steer the mining process directly based on the given visual feedback. The approach we present here, be-longs to the third category where we introduce tight integra-tion between principled projection algorithms and powerful information visualization techniques.

Projection of high-dimensional data on a lower-dimension space is an important step to obtain an effective grouping and clustering of a complex high-dimensional dataset. Here, we use the term projection to mean any method of map-ping data into a lower-dimensional space in such a way that the projected data keeps most of the topographic proper-ties (i.e.  X  X tructure X ) and makes it easier for the users to interpret the data to gain useful information from it. Tradi-tional projection methods such as principal component anal-ysis (PCA), Sammon X  X  mapping and self-organizing maps (SOM) are widely used in the data mining domain [8].
For many real-life large high-dimensional datasets, the generative topographic mapping (GTM) [6], a principled projection algorithm, provides better projections than those obtained from the traditional projection methods [4] [16]. Moreover, since the GTM provides a probabilistic represen-tation of the projection manifold, it is possible to analyti-cally describe (local) geometric properties anywhere on the manifold. The usefulness of these geometric properties of manifold during visual data mining is discussed in Section 3. It has been also argued that a single two-dimensional projec-tion, even if it is non-linear, is not usually sufficient to cap-ture all of the interesting aspects of a large high-dimensional datasets. Hierarchical extensions of visualization methods allow the user to  X  X rill down X  into the data; each plot cov-ers a smaller region and it is therefore easier to discern the structure of the data.

The work presented here describes a flexible framework for visual data mining which combines principled projection algorithms and advanced visual techniques to achieve a bet-ter understanding of the data space. The framework follows Shneiderman X  X  mantra [18] to provide an effective user inter-face (a software tool). The advantage of such an interface is that the user is directly involved in the data mining process and by visualizing intermediate steps of the machine learn-ing algorithms, the user is able to better understand and control the mining process.

The results presented, on a real-life dataset from the chem-oinformatics domain, clearly show that this interface pro-vides a useful platform for visual data mining.

In the next Section, we briefly introduce the projection al-gorithms we use. The main information visualization tech-niques applied are described in Section 3. The integrated visual data mining framework we propose is discussed in Section 4. The results are presented in Section 5. Finally, we draw the main conclusions in Section 6. Generative Topographic Mapping (GTM): The GTM is a probability density model which describes the distribu-tion of data in a space of several dimensions in terms of a smaller number of latent (or hidden) variables. The map f : H X  X  between the latent space, H , and the data space, D , is non-linear, which implies that the image of the (flat) latent space is a curved and stretched manifold,  X , in the data space.

It uses Bayes X  theorem to invert the transformation f from the latent space H to the data space D . The posterior dis-tribution on H , given a data point t n  X  X  ,isasumofdelta functions centered at centers x i , with coefficients equal to the posterior probability R i,n that the i -th Gaussian (corre-sponding to the latent space center x i ) generated t n ,
The latent space representation of the point t n , i.e. the projection of t n , is taken to be the mean, posterior distribution on H . The parameters of the GTM (weights W and inverse variance  X  ) are learned from data using an Expectation Maximization (EM) algorithm. Fur-ther details in [6].
 Hierarchical GTM (HGTM): The HGTM arranges a set of GTMs and their corresponding plots in a tree structure T .Eachmodel M in the hierarchy, except for Root , has an associated parent-conditional mixture coefficient, or prior  X  (
M| Parent ( M )). The priors are non-negative and satisfy the consistency condition: Unconditional priors for the models are recursively calcu-lated as follows:  X  ( Root ) = 1, and for all other models where Path ( M )=( Root , ..., M )isthe N -tuple (
N = Level ( M )) of nodes defining the path in T from Root to M .

The distribution given by the hierarchical model is a mix-ture of leaf models of T ,
The HGTM is trained using the EM algorithm to max-imize its likelihood with respect to the data sample  X  = { t 1 , t 2 , ..., t N } . Training of a hierarchy of GTMs proceeds in a recursive fashion. Further details in [19].
In Section 4 we discuss the interaction provided to the domain experts during the intermediate steps of training an HGTM model and how the user controls the mining process.
Following specialized visual techniques are facilitate to support exploration of the projection obtained from the prin-cipled projection algorithms described in previous section to create a powerful visual data mining framework.
 Magnification Factors and Directional Curvatures: The Magnification Factors (MF) of a GTM projection man-ifold,  X , are calculated as the determinant of the Jacobian of the GTM map [5]. Magnification factors plots are used to observe the amount of stretching in a GTM manifold at different parts of the latent space, which helps in un-derstanding the data space, outlier detection, and cluster separation. Ti X  no et. al. [20] derived a closed-form formula for directional curvatures of the GTM projection manifold. Directional curvature plots allow the user to observe the di-rection and amount of folding in the GTM manifold. This can help the user detect regions where the GTM manifold does not fit the data well. It is possible that groups of data points far apart when projected onto the projection mani-fold are close together in the data space due to high folding in the manifold. This neighborhood preservation in the data space can be spotted with a strong curvature band on the corresponding directional curvature plot.

The MF are represented by color shading in the projec-tion manifold (e.g., see Figure 2(c)). The lighter the color, the more stretch in the projection manifold. The direction of folding in the projection manifold plot is presented us-ing a small line for each part of the projection manifold in the directional curvature plots (e.g., see Figure 2(d)). The length and the shade of the background color represents the magnitude of folding. The longer the line and the lighter the background color, higher the folding (curvature).
Local Parallel Coordinates: The parallel coordinates technique [9] maps the D dimensional data space onto two display dimensions by using D equidistant axes which are parallel to one of the display axes.

Instead of displaying parallel coordinates for all the data points together, which is impractical for a large dataset, we provide an interactive facility to let the user select a point on the projection manifold and display parallel coordinates for the n nearest neighbors of that selected point. We call this a local parallel coordinates technique. Using this facility, the user can study properties of a high-dimensional data point in the data space while working with the lower-dimensional latent (projection) space. This facility has proved very use-ful for the domain experts at Pfizer 1 to understand large high-dimensional datasets. A detailed example discussing how local parallel coordinates are used to explore a projec-tion manifold is presented in Section 5.
 Billboarding: For many real-life datasets which have a natural representation, e.g. chemical compound structure, handwritten digit recognition, face recognition, etc., using this natural representation of data points in the projection is more useful to understand the data compared with data represented by labelled and/or colored dots. Here the term  X  X illboarding X  means visualizing a natural representation of a data point in the form of an image, in such a way that the image always faces the viewer (even in 3D). A chemical com-pound structure or a hand written digit image is certainly more user-friendly than a dot.

The number of pictures that can be displayed at a time depends on how much graphics memory is present. Fig-ure 1(b) presents a close up of the points visualized for the MNIST database using Laplacian eigenmaps [3]. Billboard-ing presentation of images of the handwritten digits provides us an intuitive visualization and can help us to identify why certain data points are misclassified (e.g., notice that in Fig-ure 1(b), images of 7s and 9s on the top left corner of the plot are quite similar). We use Partiview [12] to support billboarding in our tool.
The integrated visual data mining framework combines principled projection algorithms, discussed in Section 2, and visual techniques, discussed in Section 3, to achieve a bet-ter understanding of the data space. It follows Shneider-man X  X  mantra, X  X verview first, zoom and filter, details on demand X , to develop an effective interface (tool).
To support the  X  X verview first X  stage of Shneiderman X  X  mantra, output of the projection algorithms and basic visu-
Pfizer Global Research and Development, Kent, UK. alization aids such as highlight, rotate, etc., are provided for exploring a large high-dimensional dataset. For the second stage,  X  X oom and filter X , visualization aids such as zooming, filtering interesting regions on the projection manifold with the use of magnification factor and directional curvatures plots, etc., are provided. This allows the user to identify and concentrate on interesting subsets of the projection we obtained in the first stage. The third stage,  X  X etails-on-demand X , is supported using local parallel coordinates and billboarding. Integration with other visualization tool is also possible at various stages.
 Interactive visual methods support the construction of HGTM models and allow the user to explore interesting re-gions in more detail. Visual aids described in Section 3 are provided at each stage of the HGTM model development. First, a base ( Root ) GTM is trained and used to visualize the data. Then the user identifies interesting regions on the visualization plot that they would like to explore in greater detail. In particular, the user chooses a collection of points, c  X  X  , by clicking on the projection plot. The  X  X egions of interest X  given by these points (centres) are then trans-formed into the data space as Voronoi compartments [2] de-fined by the mapped points f Root ( c i )  X  X  ,where f Root the map of the Root GTM. The child GTMs are initiated by local PCA in the corresponding Voronoi compartments. After training the child GTMs and seeing the lower level visualization plots, the user may decide to proceed further and model in greater detail some portions of the lower level plots. Thus, HGTM allows domain experts to segment the input space interactively using data visualization.
When the dataset is very large, the higher-level projection plots may be cluttered and confused (with densely clustered and overlapping projections). This makes it difficult for the user to select locations for submodels at the next level. In such cases, an alternative semi-automatic submodel initial-ization algorithm [17], based on minimum message length (MML) criteria, which decides both the number of submod-els and their location can be used for higher-level projections Table 1: Molecular physicochemical properties.
 of the visualization hierarchy and then the domain expert can take control to guide the lower-level projections.
We have developed an interactive software tool that sup-ports this framework [14]. The interface is developed in Matlab and is available as a binary. The tool supports other projection methods, such as PCA, Sammon X  X  mapping and SOM. The interface has proved useful for the domain experts at Pfizer to understand and mine large datasets.
Visualization is a valuable tool for exploring and under-standing data, but in many applications the fundamental task is one of prediction. It has been argued that a single global prediction model can rarely capture the full variabil-ity of a large multivariate dataset. Instead, local models, each focused on a separate area of input space (a cluster), often work better since the mapping in different areas may vary. The tool also supports the guided mixture of local ex-perts model, which uses the soft segmentation obtained us-ing probabilistic hierarchical visualization algorithms, such as HGTM [15]. Thus the visual mining framework is not just a visual exploration tool but also supports guided modelling where the domain expert is closely involved.
 Label description Marker Compounds Not active for any target  X  21540 Active for peptidergic type1 + 236 Active for peptidergic type2  X  362 Active for aminergic type1 100 Active for aminergic type2 818 Active for kinase 412
Active for &gt; 1 target  X  132
Experiments were carried out on a real-life dataset from the pharmaceutical domain. A typical challenge in the early stages of the drug discovery process is to understand and explore large datasets containing biological activity data alongside some whole-molecular properties. A chemist is interested in studying and exploring clusters of active com-pounds to make informed decisions for future screens. The Dataset:
The chemoinformatics dataset is composed of 23,600 com-pounds having biological activity data for five different bio-logical targets and 11 whole-molecular physicochemical prop-erties (listed in Table 1). The aim is to effectively visualize this 16 dimensional dataset on a 2-dimensional manifold.
Out of these five biological targets, two are peptidergic G-protein coupled receptor (GPCR) targets, two are aminergic GPCR targets, and one is a kinase target. The four GPCR targets are of related receptor types whilst the kinase is a unrelated enzyme target class. Table 2 lists the label infor-mation and distribution of compounds in different labels.
Since different input variables in the dataset have different ranges, before the development of visualization models we normalize the data using Z -score transformation. 50% of the dataset was used as the training set and the remaining 50% was used as the test set.
 Results:
Figure 2(a) shows the projection using the Neuroscale [13], a novel neural network implementation of Sammon X  X  map-ping, algorithm. The projection in Figure 2(a) is like a blob and does not help us to understand the  X  X tructure X  of data in data space. GTM visualization results are shown in Fig-ure 2(b). The GTM plot shows clear clusters for the com-pounds active for different targets. The GTM visualization is certainly more informative than the visualization results obtained from PCA, Neuroscale and SOM (PCA and SOM projection results are similar to those for Neuroscale. They are not shown because of the space constraint). Please see the plots in color in the electronic copy of this manuscript on the ACM digital library. Figure 2: Neuroscale and GTM projections for the chemoinformatics dataset with MF and DC plots for the GTM projection. Legend information for (a) and (b) is given in Table 2.
 Though visually we can easily observe the effectiveness of GTM projection on this dataset, to get an analytical mea-surement of the separation between different data classes in the projections, first we fit a Gaussian mixture model (GMM) on each class in the projection space and then we calculate the Kullback-Leibler (KL) [7] divergence between the fitted GMMs using D KL ( p a p b )= where p a and p b are the GMMs for classes a and b respec-tively. The higher the value of KL divergence, the greater the separation between classes.

Table 3 presents the sum of the entries in the KL di-vergence matrix for different visualization model outputs. GTM projection has a much higher KL divergence matrix sum, which is evidence for better separation using GTM.
Once the GTM projection is obtained, the user can study the dataset in more detail using different interactive visual aids. The corresponding magnification factor (MF) and di-rectional curvature (DC) plots of the GTM projection man-ifold (Figure 2(b)) are presented in Figure 2(c) and Fig-ure 2(d) respectively. Using the MF plot displayed in Figure 2(c), we observe the stretching in the data space. For ex-ample, higher value of MF in the bottom-right corner of the MF plot shows that compounds active for peptidergic type 2 target (marked as  X  ) are clustered far away from the bulk of the data. Visual inspection of the direction lines and back-ground color in the DC plot presented in 2(d) can help the user to understand the curvature directions and magnitude of the folding in the projection manifold.

Magnification factor and directional curvature plots are also useful for making decisions about number and the po-sitions of the centers for GTM subplots during the train-ing of an HGTM model. For example, the lighter bands at the bottom right corner in the directional curvature plot (see 2(d)) reveals a huge folding in the projection mani-fold to cover the data space. This helps us to understand that there could be a cluster there even though the data points are not marked (labeled) differently. Magnification factors and directional curvatures plots are mainly used to understand projection space and data space in detail. But if the data are not colored (labeled) (for example if we do the analysis on a virtual compound library), magnification factor and directional curvature plots can be used to detect and explore clusters.

Local parallel coordinate plots help us to observe varia-tions in the patterns in different regions of a projection plot. Figure 1(a) shows how patterns of physicochemical prop-erties vary in different regions of the GTM projection. A careful study with the parallel coordinate technique reveals interesting structures in the projection space. It can be ob-served that the active compounds for different targets are nicely clustered. Close study with the help of local parallel coordinate technique reveals that the compounds marked as  X   X   X , present in the clusters for peptidergic type 1 and pep-tidergic type 2, are the active compounds for both of the peptidergic targets. That is in line with the fact that some compounds are active for both of the peptidergic targets.
Billboarding is an effective way to display chemical com-pound structures in the projection manifold. Because of the confidentiality agreement with Pfizer, we are not able pro-duce billboarding results on the chemoinformatics dataset.
The HGTM visualization is presented in Figure 3. Ac-tive compounds can be seen in different clusters in the root GTM. The deeper level plots clearly separate interesting lo-cal regions. At each level, the magnification factor plots, di-rectional curvature plots, parallel coordinates, and the basic visual exploration facilities are used to make decisions about where to place the center of a subplot for the next level. Computational cost: Although the rapid development of high-performance computing has to some extent altered our perception of computational complexity, this issue cannot be ignored in a visual data mining framework where user interaction is important.

When updating parameters, the GTM requires a matrix inversion of an M  X  M matrix, where M is the number of basis functions, followed by a set of matrix multiplications. The matrix inversion scales as O ( M 3 ), while the matrix mul-tiplications scales as O ( LN D ) 2 ,where L is the number of grid points in the GTM latent space and D is the number of input dimensions. Once a GTM model is trained, the computational cost to project data for the subsequent test set scales as linear, O ( N ), in the number of data points ( in the test set.

Table 4 shows the time taken to train different projec-tion models on the chemoinformatics dataset using an Intel Pentium 4 -2.4GHz machine with 2GB of RAM. An imple-mentation of the algorithms in C/C++ instead of Matlab would further improve the speed.
 Table 4: Training time for different projection mod-els ( N = 11800 , D =16 , 20 iterations).

We proposed a visual data mining framework which closely integrates principled projection algorithms, such as GTM and HGTM, with advanced information visualization tech-niques to develop an effective interface (tool) for explor-ing large high-dimensional datasets. The results obtained on a real-life chemoinformatics dataset convincingly demon-strated that the framework is useful.

The GTM model provided a better projection (in terms of cluster separation) for the chemoinformatics dataset than the projections obtained from the traditional projection al-gorithms, such as PCA, Neuroscale and SOM. The KL diver-gence matrix sum clearly show the effectiveness of the strong class grouping we obtain using GTM. With the use of in-teractive visual aids provided during the projection output, we not only can characterize hit populations from different targets (i.e. peptidergic GPCRs vs. aminergic GPCRs vs. kinases) but can also understand areas of overlap. Magnification factor and directional curvature plots of GTM helped to provide a better understanding of the pro-jection manifold and its fitting on data in the data space. The local parallel coordinates technique proved to be a use-ful tool to understand data points in interesting regions of the projection manifold more in detail. Since the struc-ture of compounds is very impo rtant in drug discovery, bill-boarding could be a useful feature for the domain experts (chemists and screening scientists) at Pfizer to visualize chem-ical structures in the projection manifold.

HGTM models are useful to explore clusters and inter-esting local regions in details in a large dataset. Note that this results are only for 11,800 compounds. The number of compounds one has to consider during the drug discovery
To be exact, the matrix multiplications scales as O ( LM D LN D ), but normally the number of data points, N , exceeds the number of basis functions, M . process is enormous; in such situations, a single GTM pro-jection can look cluttered but a well trained HGTM model could be very useful to provide a better grouping.
The computational cost to train a GTM algorithm is ac-ceptable for inclusion in the visual data mining framework. The GTM and HGTM algorithms are scalable so having a large number of data points during training, however, causes no difficulty beyond increased computational cost.
D. M. Maniyar is grateful to Pfizer Central Research and the Overseas Research Scholarship award for funding his PhD. We thank Bruce Williams and Andreas Sewing of Pfizer for useful discussions and feedback on the results.
