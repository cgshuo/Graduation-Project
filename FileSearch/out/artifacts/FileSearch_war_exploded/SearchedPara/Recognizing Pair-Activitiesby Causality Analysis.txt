 YUE ZHOU University of Illinois at Urbana-Champaign BINGBING NI and SHUICHENG YAN
National University of Singapore and THOMAS S. HUANG University of Illinois at Urbana-Champaign 1. INTRODUCTION
Pair-activity analysis, namely the study of interactions between two humans, has great potentials in practical applications, for example, security surveil-lance systems and video indexing/searching. Human activity understanding is an important component for a surveillance system. Human activities can be rough divided into three groups, that is, solo-activities, pair-activities, and group-activities, among which the pair-activity analysis is the core from the research viewpoint, since they are generally more informative compared with solo-activities for surveillance purpose, and the understanding of pair-activities can naturally provide evidences for group-activity analysis. Also the pair-activities involved in videos are valuable clues for semantic video indexing and searching, and the automatic recognition of these activities shall segment videos into tagged short video clips, which may greatly facilitate video search process.

Previous research devoted to the human activity analysis problem can be roughly divided into two categories: parametric approaches and non-parametric ones. For parametric approaches [Ivanov and Bobick 2000], the activity models are explicitly built based on the visual features, such as po-sitions, velocities, and appearance, extracted by certain object detection and tracking algorithms [Haritaoglu et al. 2000; Viola and Jones 2004; Wren et al. 1997]. These models are either rule-based or learnt by using supervised learn-ing techniques, for example, probabilistic graphical models [Medioni et al. 2001;
Brand et al. 1997; Moore et al. 1999]. Non-parametric approaches, on the other hand, do not explicitly define the activity models, instead they learn the ac-tivity patterns from the statistical properties of the observed data. In Stauf-fer and Grimson [2000], joint co-occurrence statistics of the object trajectories over a codebook are accumulated, and the hierarchical classification method is applied to identify the activities. Zhong et al. [2004] proposed an unsuper-vised technique for detecting unusual activity in a large video set using many simple features. Zhou et al. [2007] used motion trajectory similarity to detect anomalous events. Boiman and Irani [2005] proposed to determine the video regularity by its probability to be composed from reasonably large chunks of spatial-temporal data.

Most previous research on activity analysis stems from the low-level visual information. Those harnessing the middle-level visual information emphasized on the scenarios with only a single active object and focused on the single-role scenarios. Recently, Wu et al. [2007] proposed an algorithm to classify the act-ivity of one object with the interactions with the circumambient appliances or articles, for example, microwave, coffee maker, and cups. Besides the single-role activities, many activities existing in real life involve two or even more active objects, for example, chasing and working together, and these activities are much more complicated than single-role activities. How to represent and properly model the activities involving two or more active objects is still an open problem. In this work, we focus on the pair-activities, which describe the relationship between two active objects, but all the techniques discussed in this work can be easily extended for group-activity analysis with multiple active objects. The most similar work with ours was proposed by Park and Ag-garwal [2004], and presented a hierarchical Bayesian network for recognizing two-person interactions by simultaneously tracking the the body parts of two persons, which requires reasonably high image resolution for human bodies and may be infeasible in surveillance videos, such as those depicted in Figure 1.
The study of the pair-activities is still at its preliminary stage for the com-puter vision research community although a large portion of the activities exist-ing in real life belong to this type. In this article, we contribute to this problem from the following aspects. First, we design two sets of features to characterize these pair-activities. More specifically, we first encode each pair-activity ex-ample as two trajectories, referred to as bi-trajectory in this work, extracted from the mean-shift tracking algorithm [Comaniciu et al. 2003; Collins 2003].
Then one set of features, for example, causality ratio and feedback ratio, are derived by the Granger Causality Test (GCT) [Granger 1969] based on the bi-trajectories, and another set of features, for example, the frequency responses are sampled based on the digital filter [Mitra 2005] with these two trajectories as input and output discrete signals respectively. Finally, the length-variable pair-activity sample obtained from video sensor is represented by these features along with the velocity and distance features conventionally used for single-trajectory analysis. It is observed that the extracted features are of multi-modalities, and often greatly different in scale and importance. How to weight and normalize these features is crucial for the subsequent classification step, since different weights result in different margins between different classes and the separation hyperplane will also be different. Thus, we then present a novel feature fusing procedure to learn the coefficients for weighting different features such that the weighted data will be good at discriminating power mea-sured by the correlation similarity. Finally, we collected a par-activity database with five categories of pair-activities, namely chasing, following, independent, meeting and together, each of which consists of averagely 170 instances. The ex-tensive experiments on this database validate the effectiveness of the designed features as well as the proposed feature fusing procedure.

The rest of the article is organized as follows. Section 2 introduces the details on feature extraction process from the Granger Causality Test and digital filter instantiation for pair-activity representation. The procedure to learn the feature weighting coefficients for enhancing the feature discriminating power is described in Section 3. Section 4 provides the details on database collection and the comparison experiments on pair-activity classification. The concluding remarks are given in Section 5. 2. PAIR-ACTIVITY REPRESENTATION BY CAUSALITY ANALYSIS
The success of a solution to a particular classification task generally relies on two aspects: (1) how to represent the objects, and (2) how to measure the similarity between the data pair. In this work, we discuss these two problems for the concerned pair-activity classification task. The first problem is discussed in this section, and we discuss the second problem in next section. 2.1 Pair-Activity Encoded as Bi-Trajectory
For a video with two active objects, there exist multiple levels of information for characterizing the involved activity. The low-level information, for exam-ple, color and local motion distribution, is useful for describing single active object, yet insufficient to reveal the relationship between two active objects.
The high-level information, for example, gender and identity information, also generally characterizes individual single object. Hence, in this work, we focus on the middle-level visual information, more specifically the bi-trajectory, for characterizing the relationship between two active objects in video.
Motion trajectory has proved effective in single-role activity analysis [Turaga et al. 2007]. Generally, the trajectory of a moving object is obtained by certain object tracking algorithm. Figure 1 depicts five examples corresponding to five categories of pair-activities concerned in this work, and the motion bi-trajectories are also imposed. From these bi-trajectories, we can intuitively observe that the bi-trajectory shapes of different categories are generally different, and the difference is even greater if the temporal information is also considered. Pair-activity itself is a high-level concept, and reflects both spatial and temporal information of two active objects. Conventionally, each point on a motion trajectory is characterized by its position, velocity, and curvature features. These features are useful for describing the activity of one object, but there still exists a large gap between the middle-level information and the high-level concept of pair-activity, which is much more complicated than single-trajectory based activity.

In this work, we use the concept of causality to describe the the relation-ship between two trajectories, and more specifically, the causality includes two aspects, namely, strength and style . The former characterizes how strong one trajectory affects another one, while the latter depicts the detailed mechanism for one trajectory to predict another one. We introduce in the next two sections how to utilize the Granger Causality Test [Granger 1969] and digital filter [Mitra 2005] to extract features on causality strength and style for pair-activity representation. 2.2 Causality Strength Features via Granger Causality Test
The Granger Causality Test (GCT) was originally proposed for uncovering the causality and feedback relationship between different economical factors. GCT was first proposed by Granger [1969] and then further popularized by Sims [1972]. In the cases with two variables, the GCT breaks the feedback mecha-nism into two causal relations, and each is closely connected with one of the causations.

Before we formally introduce how to utilize the Granger Causality Test to extract the semi-high-level features on causality strength for describing the pair-activities, we first define some terminologies as follows: (1) Let A t = ( a 0 , a 1 , a 2 ,..., a t )and B t = ( b 0 (2) Let P ( a t | B t  X  l (3) The prediction error is assumed to be of Gaussian noise with standard
To model P ( a t | B t  X  l and efficiency in parameter estimation, namely, where  X  p  X  X  are the regression coefficients, and  X  is the Gaussian noise. Similarly, we use the linear predictor to model P ( a t | A t  X  l where  X  p  X  X  and  X  p  X  X  are the regression coefficients, and The optimal parameters of the prediction function can be computed by Least
Square Error (LSE) approach. The GCT does not specify any particular predic-tion function for computing the standard deviation, and hence more complex prediction functions, for example, polynomial function and logistic function, can also be used for modeling P ( a t | B t  X  l
The computational complexity of GCT is relatively low. The regression pa-rameters can be computed using least-square estimator. A linear filter (gradient descent) can also be applied to solve the regression since the model parameters do not change significantly between consecutive frames. In terms of computa-tional complexity, the linear filtering method is more efficient on single proces-sor but hard to parallelize. In our implementation, we chose the least-square estimator.

By using GCT, we can obtain a set of features for measuring certain proper-ties within a bi-trajectory as follows: (1) Causality. If the prediction error  X  ( a t | A t  X  l (2) Feedback. If B t is Granger causal to A t and A t is Granger causal to B (3) Causality Ratio.  X  ( a t | A t  X  l (4) Feedback Ratio.  X  ( b t | B t  X  l
Defining causality and feedback as ratios can help reduce the affect of object tracking quality. Under the reasonable assumption that the tracking quality affects the prediction of two trajectories equally, the computation of causality and feedback are also affected equally and therefore the causality/feedback ratio would be stable and robust to tracking quality.

Intuitively, causality is an effective criteria in distinguishing different cat-egories of pair-activities. In this work, we are interested in five categories of pair-activities, and here we justify how these pair-activities can be character-ized by the causality strength features from GCT. (1) Chasing. One object tries to minimize the relative distance while the other (2) Following. One object tries to minimize the relative distance while another (3) Independent. Neither object is the causation of the other. In this case, the (4) Meeting. Both objects first try to minimize the relative distance, stay to-(5) Together. The distance between two objects is small or nearly constant at 2.3 Causality Style Features from Digital Filter Instantiation
The causality strength features, causality ratio and feedback ratio, can well characterize how forcefully one active object affects the moving of another one, but these features are still too rough, and cannot explain the detailed mecha-nism and style by following which one active object affects another one. In the
Granger causality test with linear predictor model, the underlying mechanism and style for the active object with trajectory B t to affect another one with trajectory A t can be instantiated as
This relationship can be naturally expressed by a digital filter [Mitra 2005] with the input discrete signal as B t ( x or y coordinate) and output discrete signal as the corresponding component of A t . A digital filter transforms one signal into another one with certain purpose, and such purpose is charac-terized by the so-called z -transform function. For the digital filer expressed in (3), the corresponding z -transform function can be computed as [Mitra 2005],
The causality strength features from GCT do not take the property of the above z -transform function into consideration, and intuitively, it involves more detailed information on how one active object affects another one. The usual way to characterize a z -transform is to explore its frequency response informa-tion. In this work, we use the magnitudes and the angles of the function values at a set of sampled responses to describe the digital filter. More specifically, we used the magnitudes of responses at the frequencies of 0,  X  , and the angles of responses at frequencies 1  X / 4,  X / 2, and 3
Finally, all the causality style features are represented as
The causality strength features from GCT and the causality style features from the digital filter instantiation characterize the casuality properties be-tween two trajectories from two mutually complementary aspects, and they are therefore integrated for representing the pair-activities. An illustration on their relationship is shown in Figure 2. Besides the proposed causality features, conventional features, for example, the velocity and relative distance features, also convey important information for distinguishing different pair-activities.
For example, the pair-activities of meeting and together heavily depend on the relative distances between two objects. Hence, the pair-activities are finally represented by combing the causality features and the conventional features.
Here, let { x i | x i  X  R m } N i = 1 be the pair-activity sample set, where x vector which combines the causality features and conventional velocity and po-sition features, and their corresponding class labels are where N c is the number of pair-activity categories.
 These m -dimensional vectors involve the features from different sources.
Their scales may be dramatically different, and their contributions to the clas-sification task may also be different. The scales of these features directly deter-mine the between-class margins, and hence are important for the consequent pair-activity classification. As mentioned previously, these features are pro-posed with different purposes and of multi-modalities, and hence it is desirable to have a procedure that can automatically determine the weights for different features, such that the resulting discriminating power of the weighted fea-tures is the best. Our procedure in the next section for feature fusing based on weighted correlation is proposed for such a purpose. 2.4 Generalizing the GCT to More than Two Objects The Granger Causality can be generalized to more than two moving objects. There are two possible ways to extend the model: (a) compute pair-wise Granger
Causality Ratio for every object pair(b) compute the Granger Causality Ratio of one object against the rest. More complicated object interaction can be de-fined using the generalized GCT. For simplicity, in this article, we restrict our discussion of GCT to 2-body interaction only. 3. FEATURE FUSING BY WEIGHTED CORRELATION
In this section, we study the underlying general machine learning problem on how to learn the coefficients for weighting the causality features and con-ventional trajectory features for enhancing the discriminating power of these features based on the weighted correlation similarity measurement. 3.1 Formulation for Feature Weighting
Correlation similarity (cosine distance) was reported to be generally more ro-bust and effective for classification tasks compared with the conventional met-rics such as L 2 and L 1 distances [Lin et al. 2005]. But most traditional al-gorithms for feature extraction or feature selection are based on Euclidean distances. In this section, we present a novel supervised feature weighting algorithm that characterizes discriminant power based on correlation similar-ity directly. The target is to search for a weighting vector p the weighted representation p x = ( p 1 x 1 , p 2 x 2 ,..., discriminating power.

To measure the discriminating power of the weighted feature space, intra-class compactness and inter-class separability are two most used criteria [Yan et al. 2007]. Here, we define them based on the correlation similarity.
Intraclass Compactness. For a representation with good discriminating power, it is desirable that the samples from the same class are close to each other as much as possible. On the other hand, it is often the case that there may exist large variations within individual class, and hence it is unnecessary that all sample pairs within same class labels are close to each other. A trade-off way is to ensure that the neighboring samples of the same class are close to each other [Yan et al. 2007]. The neighborhood relationship can be defined from the  X  k -nearest neighbors or -ball criteria in the original feature space. In this work, we use the  X  k -nearest neighbors criteria for measuring the intra-class compactness as where N +  X  and from the same class.

Interclass Separability. For good discriminating power, the sample pair from different classes should be far away to each other. Generally, the number of this kind of pairs is huge even for a moderate size of data set. To alleviate the computational cost, this kind of inhomogeneous pairs are considered mainly for marginal pairs. In this article, we also use the  X  k -nearest neighbors criteria for measuring the inter-class separability as where N  X   X  from difference classes. In this work, the  X  k is set as 10 for all the experiments.
The correlation similarity takes the value within [  X  1 , relative larger (or smaller) term will not dominate the value of S is the main superiority of correlation similarity over the L for measuring intra-class compactness and inter-class separability. Aiming at good classification capability, we maximize the intra-class compactness and at the same time also maximize the inter-class separability, and consequently we have the following objective function:
From (8) and (9), we can see that the S c and S p are invariant to the scaling of the weighting vector p . Hence, we add the constraint p function and this constraint can be easily satisfied by normalizing p after each iteration in the parameter optimization process as described in next subsection. 3.2 Parameter Optimization
The objective function of (10) is nonlinear, and hence we use the iterative gradient descent approach for optimization. The derivative of the objective function with respect to p is where
The derivative of f ij ( p ) with respect to p k is calculated as where
Based on the derivative, we can optimize the objective function in (10) with traditional gradient descend approaches, for example, Levenberg-Marquart, which is implemented in Matlab as lsnonlin function. 3.3 Leaning Based on Weighted Features
Based on the derived weighting vector p in the previous section, each datum x is reweighted as p x , and then we can directly classify the pair-activities with the Nearest Neighbor approach based on this rescaled feature space. We can also use other conventional multi-class learning algorithm to further improve the algorithmic performance. In this article, we choose the Linear Discriminant
Analysis [Belhumeur et al. 1997] to further reduce the feature dimension with the projection matrix P  X  R m  X  d (usually d m ). Then, when a new datum comes, its class label is predicted by using nearest neighbor approach. Also we evaluate the performance of Support Vector Machine (SVM) [Osuna et al. 1997] in pair-activity classification based on the derived normalized features, owing to its popularity in general classification problems. In this work, we use the one versus all approach to extend the basic two-class SVM for handling the multi-class problem. 4. EXPERIMENTS
In this section, we first introduce the details of the pair-activity database we collected, and then demonstrate the effectiveness of the designed causality features from Granger Causality Test and digital filter instantiation for pair-activity representation, and finally we evaluate the effectiveness of the pro-posed feature fusing procedure.
 4.1 Pair-Activity Database Construction
The database we used for the experiments was collected at the indoor environ-ment with a still sensor. The sensor (Sony 908E camera, 30f/s) was installed in the second floor of a building, and captures the hall area in the first floor from the top-view. The whole database consists of five categories of most com-mon pair-activities: chasing, following, together, meeting, and independent. For each category of pair-activity, multiple sessions with different character pairs are captured. Within each session, two characters continuously staged the same pair-activity and change the style frequently, and then the long video is divided into a series of clips with overlapping between successive clips. Finally, each category consists of 131 to 203 video clips of 8 seconds or longer, and altogether we have 867 video clips for all the five categories. The detailed information of session number and clip number for each category of the pair-activities is listed in Table I, and some example clips are depicted in Figure 1.

To estimate the trajectories of the two moving objects in the videos, we use the mean-shift tracking algorithm [Comaniciu et al. 2003; Collins 2003], and the tracker is automatically initialized from the Gaussian Mixture Models (GMM) based background subtraction algorithm. Manual re-initialization is required for few sessions with severe object occlusions. 4.2 Feature Effectiveness
The features we used for the experiments include: causality ratio, feedback ra-tio, sampled frequency responses, relative velocity and distance, and absolute velocities and positions for two objects. For the conventional features for single trajectory representation such as velocity and position, we compute both mean and variance of their magnitudes and orientations, so finally we have 34 fea-tures in total as shown in Table II. The causality ratio and feedback ratio are estimated using 10th order regression model, namely k = 10 for computing the casuality ratio value  X  ( a t | U t  X  l to the high frame rate of the video clips. The regression models are estimated from trajectories of lengths between 2 seconds and 3 seconds, during which the short-period motions can be assumed as stationary processes.

In Figure 3, we list the values of the causality ratio, feedback ratio, frequency response, and relative velocity features for five example pair-activity instances from five different categories. From these values, we can observe that: (1) the causality features are very useful in discriminating different categories of pair-activities; and (2) the relative velocity feature is not so important as the causality ratio feature, but also contributes greatly, especially for the pair-activities of independent and meeting. 4.3 Pair-Activity Classification
For pair-activity classification, the 34 features weighted by the derived vector p are fed into the Linear Discriminative Analysis (LDA) algorithm, and then the final classification is conducted based on the dimensionality reduced feature space with the Nearest Neighbor approach. Also these features can be used as inputs for SVM based classification. The experimental protocol is leave-one-session-out, namely, for each time, the samples within one session are used as testing data and all the others as training data, and the experiments are run for 24 times.

We compare the experimental results from LDA based on all original fea-tures with those from LDA based on all weighted features. The detailed results are listed in Table III, from which we can observe that the classification accura-cies are improved for most categories by the feature normalization procedure, especially for the together and independent categories. We also compare the experimental results from Gaussian-kernel based SVM with all original fea-tures and those from SVM with all weighted features, and the results listed in Table IV validate the effectiveness of the feature normalization process as well. Also the results show that SVM is more powerful for classification task as compared with LDA. There are two parameters while using RBF kernels: C and  X  , where C is the penalty term for error and  X  is the kernel bandwidth. The values of the two parameters are unknown beforehand and can be estimated by searching possible ( C , X  ) pairs [Chang and Lin 2001]. The examples on the incorrectly classified testing samples within a selected session for each cate-gory are depicted in Figure 4 and Figure 5 based on the results from WF-LDA with all features. From the experimental results by LDA and SMV in Table V,
Table VI, Table III, and Table IV we observe that the category  X  X eeting X  has relatively low recognition rate comparing to the other 4 categories. The reason of this is that the  X  X eeting X  trajectories have large variances of causality ratio and relative velocity, for example, the relative velocities before, in, after the meeting can be very different, and it is also true for causality ratio. In Table V, the  X  X ndependent-Chasing/Following X  classification has high error rate due to the lack of feature value normalization, especially for the velocity feature.
In addition, we run the above two sets of experiments by removing the casuality style features, which characterize the detailed underlying mechanism on how one trajectory affects another one, and the results are listed in Table VII and Table VIII. From these results, we can observe that (1) the causality style features are very useful in expressing the pair-activities, and the accuracies are generally dropped when the causality style features are removed, and (2) the feature fusing process can boost the performance as observed in above experiments.

We further evaluate the effectiveness of other features for pair-activity clas-sification, and here we focus on two most representative ones, namely causality ratio and relative velocity, one of which from Granger Causality Test and the other from the conventional single-trajectory representation. Their compari-son is conducted by removing the causality style features. The experiments are conducted based on LDA along with the feature fusing procedure, and
Table IX lists the detailed results. The observations can be made that: (1) when causality ratio features are removed, the classification performance degrades dramatically, especially for the categories of chasing, following and together, and hence the causality strength information is also significant in identifying the pair-activities; and (2) when the relative velocity feature is removed, the performance degrades, but not so greatly as for causality ratio feature, which means that the relatively velocity is important but less important than the causality ratio feature for pair-activity classification. (1) Feature normalization (mean 0, variance 1) helps, but not as good as our weighting algorithm. Note, for SVM, we actually used linear scaling (min, max toscaleto[  X  1,1]) as preprocessing (see Table X). It is similar to normalization, so the feature normalization does not help a lot in that case. (2) Coupled HMM does not work as well as SVM, seems to be better than LDA. We set the number of hidden state to be 5. We used standard EM (Baum-Welch) for training and forward-backward algorithm to compute the likelihood. In classification, the one with the largest likelihood is chosen as the output. 5. CONCLUSIONS AND FUTURE WORK
This work was devoted to the pair-activity classification problem from three aspects: database construction, feature design, and feature fusing for classifi-cation. To the best of our knowledge, the pair-activity database introduced in this work is the first one available for studying the pair-activities, and also it is the first work to study the pair-activity classification problem systematically. We are planning to further explore this topic in four aspects: (1) to extend the
GCT to more than two moving objects (2) to combine the middle-level visual information (trajectories) with the low-level (patch appearance) and high-level information (object categories) for better understanding the pair-activities; (3) to extend our proposed techniques for analyzing group-activities involving mul-tiple active objects; and (4) to extend the current work to a more general frame-work for automatic pair-activity detection, segmentation, and classification within a long video.

