 The Earth Mover X  X  Distance, proposed in computer vision as a distance-based similarity model reflecting the human perceptual similarity, has been widely utilized in numer-ous domains for similarity search applicable on both fea-ture histograms and signatures. While efficiency improve-ment methods towards the Earth Mover X  X  Distance were fre-quently investigated on feature histograms, not much work is known to study this similarity model on feature signa-tures denoting object-specific feature representations. Given a very large multimedia database of features signatures, how can k-nearest-neighbor queries be processed efficiently by us-ing the Earth Mover X  X  Distance? In this paper, we propose an efficient filter approximation technique to lower bound the Earth Mover X  X  Distance on feature signatures by restrict-ing the number of earth flows locally. Extensive experiments on real world data indicate the high efficiency of the pro-posal, attaining order-of-magnitude query processing time cost reduction for high dimensional feature signatures. H.3.3 [ Information Storage and Retrieval ]: Information Search and Retrieval; H.2.4 [ Database Management ]: Sys-tems X  Multimedia databases Theory, Performance, Experimentation Earth Mover X  X  Distance, Lower Bound, Filter Distance, Mul-timedia Databases
In the last decades, there has been a tremendous increase in the generation and collection of multimedia data compris-ing image, video, and audio contents. The arising enormous data explosion is often accompanied by the need of efficient similarity measures which are of crucial importance today.
The Earth Mover X  X  Distance (EMD) is a flexible distance-based similarity measure initially applied to problems in computer vision domain, defining image dissimilarity by the mimimum amount of work needed to transform one fea-ture representation into another one [15]. Beside its strong expressiveness of perceptual similarity, EMD is applicable to both feature histograms, i.e. database-oriented feature quantizations, and feature signatures relying on object-specific feature quantizations.
 As the theoretical and empiric time complexity of the EMD is exponential and super-cubic regarding the num-ber of representatives, respectively, researchers have been involved in the investigation of efficient query processing techniques for the EMD [2, 3, 16, 21]. While efficiency im-provement methods were frequently proposed on feature his-tograms, not much work is known to study the efficiency of query processing with the EMD on feature signatures ex-cept for the lower bound presented by Rubner et al. [15] applicable to feature signatures.

In this paper, inspired by the lower-bounding techniques in [2], we present how k-nearest-neighbor (k-nn) queries can be efficiently processed by using the EMD in very large mul-timedia databases of features signatures. This is achieved by utilizing constraint relaxation of flows among the fea-tures in the feature space, which restricts the number of earth flows locally. The number of exact distance compu-tations are considerably reduced within a filter-and-refine architecture, attaining order-of-magnitude query processing time cost reduction for high dimensional feature signatures. Our main contributions are summarized as follows:
The paper is structured as follows: Section 2 presents fea-ture representation, the EMD, and the efficient query pro-cessing regarding filter-and-refine architecture. Section 3 gives the related work, followed by Section 4 describing the proposed approach on feature signatures with theoretical in-vestigation. Section 5 deals with the utilization of IM-Sig on feature signatures with some shared representatives. Then, Section 6 gives the extensive experimental evaluation and finally the paper is concluded by Section 7.
The most frequently encountered approach to represent multimedia objects is carried out by means of a feature space . A feature space ( F , X  ) comprises a set of features F which is endowed with a function  X  : F  X  F  X  R for the comparison of two features. Frequently but not necessarily, the function  X  is supposed to be a metric distance function.

Given a feature space ( F , X  ), each multimedia object is represented by means of features f 1 ,...,f n  X  F . These fea-tures reflect the characteristic properties of a multimedia object and are additionally assigned to real-valued weights indicating their importance. This leads to the following for-mal definition of a feature representation .

Definition 1. Let ( F , X  ) be a feature space. A feature representation X is defined as X : F  X  R .

Mathematically, a feature representation X is a function which relates each feature f  X  F with a weight X ( f )  X  R where the weight of zero is designated for features which are not relevant for the representation of the corresponding multimedia object. Those features which are assigned non-zero weights are named as representatives and are defined as a set R X = { f  X  F | X ( f ) =0 } X  F . Restricting a feature representation X to a finite set of representatives R X  X  F yields a feature signature , formally given below.
Definition 2. Let ( F , X  ) be a feature space. A feature signature X is defined as X : F  X  R subject to | R X | &lt;
A feature signature X allows to define a finite set of con-tributing features, i.e. those features with a weight unequal to zero, individually for each multimedia object. A common restriction is to define the contributing features in advance by means of a finite set of shared representatives R  X  F . This leads to the concept of a feature histogram .
Definition 3. Let ( F , X  ) be a feature space. A feature histogram X R with respect to a finite set R  X  F  X | R | &lt; is defined as X R : F  X  R subject to X R ( F \ R) = 0 .
Feature histograms and feature signatures differ in the de-termination of the representatives. While feature signatures define their individual representatives, feature histograms are restricted to the shared representatives R, i.e. each mul-timedia object is characterized by the weights of the same shared representatives.

The definitions above unify the notions of feature signa-tures and feature histograms in a common mathematical feature representation model which has been proposed in the work of Beecks [5]. The class of feature signatures are defined as S = { X | X  X  R F  X | R X | &lt;  X  X  and the class of feature histograms as H R = { X | X  X  R F  X  X R ( F \ R) = with respect to a finite set R  X  F . In addition, the union of all feature histograms is defined by H = R  X  F  X | R | &lt;
Frequently encountered classes of feature representations for modeling the content of multimedia objects are that of | R
X | &gt; 0 } and that of positive feature histograms H + R {
X | X  X  H R  X  X ( F )  X  R &gt; 0 } with respect to  X  =R  X  F
The Earth Mover X  X  Distance is a transformation-based ap-proach which measures the cost of transforming one feature signature into another one. It is formally defined on the class of positive feature signatures below.

Definition 4. Let X,Y  X  S + be two feature signatures over a feature space ( F , X  ) and  X  : F  X  F  X  R be a distance function. The Earth Mover X  X  Distance EMD : S +  X  S +  X  R between X and Y is defined as a minimum-cost flow of all possible flows F = { f | f : F  X  F  X  R } = R F  X  F as follows: subject to the following constraints:
The EMD is defined as a linear optimization problem where the constraints guarantee a feasible solution. The computation can be restricted to the representatives R X and R
Y of both feature signatures and follows a specific variant of the simplex algorithm [11].
The question of how to process k -nn queries efficiently is of crucial importance for today X  X  multimedia databases. In or-der to avoid a time-consuming sequential scan, spatial access methods [8] and metric access methods [23] have been devel-oped with the goal of reducing both I/O and CPU costs.
A fundamental approach underlying many access methods is the multi-step approach which has been investigated in [1, 10, 13, 17, 14, 12]. This approach proposes processing k -nearest-neighbor queries in multiple steps generating can-didate objects which are subsequently refined to obtain the final results. Using a lower bound LB  X  of a distance function  X  ensures completeness , i.e. no false dismissals, since it holds  X  x, y :LB  X  ( x, y )  X   X  ( x, y ). An improvement in efficiency is obtained by meeting ICES criteria [4]: a lower bound should be indexable , complete , efficient ,and selective .
The multi-step algorithm proposed in [17] is proven to be optimal in the number of candidates, i.e. the algorithm is optimal in the number of distance computations. The algorithm first generates a ranking by means of the lower bound. Then, this ranking will be processed as long as the lower bound does not exceed the distance of the k th -nearest neighbor. The algorithm updates the result set as long as data objects with smaller distances have been found.
Efficient query processing techniques are of high impor-tance for the similarity search with the EMD on feature histograms. The methods in [2] aimed at proposing to lower bound the EMD via L p -based distances and constraint relax-ation. Another further work investigated a lower bound of the EMD in combination with R-tree and VA-file [3]. Fur-thermore, dimensionality reduction techniques were devel-oped for the EMD where reduced cost matrices are utilized relying on the original cost matrix [21]. The approach in [22] derived a lower bound of the EMD by utilizing the primal-dual theory in linear programming on top of B + -trees. An-other further method proposed to lower bound the EMD by projecting feature histograms on a vector and approximat-ing their distance by a normal distribution [16]. In [19], it is proposed to optimize the refinement phase of EMD-based similarity search by presenting a dynamic distance bound.
The aforementioned efficiency improvement approaches are mainly applicable to feature histograms sharing the same representatives. In fact, the lower bound presented by Rub-ner et al. [15] is also applicable to feature signatures with dif-ferent representatives. Given two feature signatures X,Y  X  S over a feature space ( F , X  ) with a norm-based distance function  X  , the Rubner lower bound LB Rubner : S  X  S  X  R between X and Y is defined as follows: LB Rubner ( X,Y )= It holds that LB Rubner ( X,Y )  X  EMD ( X,Y ) for any X,Y  X  S [15]. The computation time complexity of LB Rubner lies in O ( | R X | ) provided that | R X | X | R Y | .
Since data generation capabilities can vary for numerous purposes, data sets with numerical values exposing high ac-curacy are frequently required. This necessitates the uti-lization of individual partitioning approach leading to fea-ture signatures sharing no common feature representatives in various domains, such as multimedia, finance, and me-teorology. Not least, in prevalent application domains, it is still common to generate and process data in which common features play an important role. In particular, feature his-tograms which are often used in numerous application fields related with efficient query processing denote indeed fea-ture signatures whose all feature representatives are shared throughout the data set.

From a didactic point of view and for the sake of simplic-ity, this section will concentrate on the feature signatures sharing no common feature representatives. The case for the feature signatures sharing some feature representatives will be examined in Section 5.

In Section 4.1, the definition of the novel lower bounding technique IM-Sig is presented on feature signatures with the flow generation. Then, in Section 4.2, the feasibility of the proposed flow generation and the minimality of the overall cost are proven to show that IM-Sig lower bounds the EMD on feature signatures. Last, the algorithmic computation and complexity analysis are presented in Section 4.3.
IM-Sig lower bound is based on the relaxation of the tar-get constraint of the Earth Mover X  X  Distance by local ex-amination of each feature to be used as source nodes in the network flow problem. Recall that in a transportation prob-lem there exists a bipartite graph with source nodes and destination nodes where the aim is to minimize the overall cost with respect to the predefined constraints [20]. Here, the target constraint of the EMD is replaced by the one pointing out that each flow from a source feature may not exceed the capacity of the destination feature. This is car-ried out by restricting the number of earth flows locally for each representative from which earth is transferred to the corresponsing features. The formal definition of the IM-Sig lowerboundisgivenbelow.

Definition 5 (Lower Bound LB IM -Sig ). Let ( F , X  ) be a feature space with a distance function  X  and X,Y  X  S + be two non-empty positive feature signatures of equal total weight m = pendent Minimization for Signatures LB IM -Sig : S +  X  S +  X  R  X  0 between X and Y is defined as a minimization over all possible flows F = { f | f : F  X  F  X  R } : subject to non-negativity constraint  X  x, y  X  F : f ( x, y ) source constraint  X  x  X  F : constraint  X  x, y  X  F : f ( x, y )  X  Y ( y ) ,andflowconstraint
The IM-Sig target constraint is concerned in assuring for each feature no incoming flow may exceed the weight of that corresponding feature in the feature space.

As mentioned above, the computation of the flow regard-ing IM-Sig entails the need to define a set S of features whose total weight is greater than or equal to the weight of any fea-ture x  X  R X related with outgoing flows. This is achieved by utilizing the order of the nearest neighbors of x according to their distances in ascending order, as given below.
Definition 6 (The smallest feasible set). Given a feature space ( F , X  ) with a distance function  X  , two non-empty positive feature signatures X,Y  X  S + ,andafeature representative x  X  R X , the smallest feasible set S X,Y ( x ) R
Y is the smallest set of nearest neighbors of x in R Y whose total weight is greater than or equal to X ( x ) : S X,Y ( x ) = arg min where elements of S X,Y ( x )= { y 1 ,...,y l } are given accord-ing to their distances in ascending order: 1  X  i  X  j  X  l  X   X  ( x, y i )  X   X  ( x, y j ) ,and NN ( x,  X , R Y )= denotes the set of all non-empty nearest neighbor sets of x .
The definition above states that for each x  X  R X the smallest feasible set S consists of all feature representatives y  X  R y ordered according to the nearest neighbor distances, satisfying the constraint that the weight of x may not exceed the total weight of the set elements. Now, we can present the definition of the flow of LB IM -Sig , i.e. how the flow from X to Y can be computed appropriately. Figure 1: An example of the flow f IM -Sig between two feature signatures X and Y .

Definition 7 (IM-Sig flow). Given two non-empty positive feature signatures X,Y  X  S + ,let S X,Y ( x )= { y } be the smallest feasible set for any feature representative x  X  R X , satisfying 1  X  i  X  j  X  l  X   X  ( x, y i )  X   X  ( x, y flow f IM -Sig : F  X  F  X  R is defined as: f
In order to achieve the computation of LB IM -Sig , the flow f
IM -Sig takes for each feature representative x  X  R X its tion. Any y i except for y l receives earth of its maximum capacity, whereby the amount of earth y l receives is deter-mined by the difference between the weight of x and the sum of the capacity of the remaining features y 1 ,...,y l  X  1 ensures that the earth located in any x is fully transferred to its corresponding nearest neighbors in R Y .

Figure 1 shows an example to illustrate the flow f IM -Sig between two feature signatures X , Y with R X = { x 1 ,x 2 and R Y = { y 1 ,y 2 ,y 3 } . The indices of the features are de-noted by the numbers between 1 and 12 as shown in the figure, and the ground distance between any representatives with indices i and j is computed via | i  X  j | . The weights of the feature representatives are given as X ( x 1 )=4 ,X ( x 6and Y ( y 1 )=5 ,Y ( y 2 )=3 ,Y ( y 3 ) = 2 which can be inferred from the buckets, as well. The smallest feasible sets for x 1 and x 2 can easily be determined as S X,Y ( x { y fer proceeds from x 1 to its nearest neighbor y 2 ,withthe flow Y ( y 2 ). The remaining amount of earth is then moved to the next nearest neighbor y 1 ,andthereisnomoreearth to move any more. Similarly, the earth is transferred from x to the nearest neighbors in the order of y 2 , y 3 ,and y sum of whose capacities are sufficient to receive the earth located in x 2 . As a result, the amount of work to transfer all earth from X to Y with respect to IM-Sig constraints is calculated as 1 10  X  (1  X  3+2  X  1+2  X  3+4  X  2+5  X  1) = 2 . 4. In order to show that LB IM -Sig is a lower bound of the EMD on feature signatures, we first present the proof of the feasibility of f IM -Sig with respect to the constraints given in Definition 5, and then prove its minimum-cost flow property.
Theorem 1 (Feasible flow f IM -Sig ). Given two non-empty positive feature signatures X,Y  X  S + of equal total weight m = ing constraints:
Proof. The smallest feasible set S X,Y ( x )= { y 1 ,...,y of each x  X  R X will be used in the proof to show the fulfil-ment of the constraints.
 Non-negativity constraint :  X  x, y  X  F : f IM -Sig ( x, y ) There exist three cases to examine: Case 3 : y  X  S X,Y ( x )  X  y = y l By Definition 7, it holds f IM -Sig ( x, y )= X ( x )  X  and by Definition 6, S is the smallest set satisfying  X  X  X  y  X  S X,Y ( x ):  X   X 
X ( x )  X  As a result, we acquire  X  x, y  X  F : f ( x, y )  X  0. Source constraint :  X  x  X  F : There exist two cases to investigate: Case 1 : x/  X  R X x/  X  R X  X  X ( x ) = 0, and x/  X  R X  X  x/  X  R X  X  Case 2 : x  X  R X = = Equation (1) arises from Definition 7 denoting  X  x/  X  S X,Y f
IM -Sig ( x, y ) = 0, and the remaining equations make use of the definition of S in terms of the number of elements l .As a result, it holds  X  x  X  F : IM-Sig target constraint :  X  x, y  X  F : f IM -Sig ( x, y ) Y ( y ). There exist four cases to examine: Case 1 : x/  X  R X x/  X  R X  X  X  X  y  X  F f IM -Sig ( x, y )=0  X  Y ( y ) .
 Case 2 : x  X  R X  X  y/  X  S X,Y ( x ) x  X  R X  X  y/  X  S X,Y ( x )  X  f IM -Sig ( x, y )=0  X  Y ( y ). Case 3 : x  X  R X  X  y  X  S X,Y ( x )  X  y = y l By Definition 7 it holds f IM -Sig ( x, y )= Y ( y ). Case 4 : x  X  R X  X  y  X  S X,Y ( x )  X  y = y l By Definition 6, it holds: X ( x )  X   X  X ( x )  X  l  X  X ( x )  X  l  X  1 Definition 7.
 Consequently, it holds  X  x, y  X  F : f IM -Sig ( x, y )  X 
After the presentation of the feasibility of the proposed flow f IM -Sig with respect to the non-negativity, source, and IM-Sig target constraints, the minimization of the overall cost regarding LB IM -Sig is given below.

Theorem 2 (Minimum-cost flow f IM -Sig ). Given two non-empty positive feature signatures X,Y  X  S + of equal total weight m = possible flows F = { f | f : F  X  F  X  R } , f IM -Sig is the minimum-cost flow minimizing the overall cost with respect
The proof shows that the overall cost derived by the uti-lization of f IM -Sig is always less than or equal to that gen-erated by using any arbitrarily chosen feasible flow different
Proof. Let S X,Y ( x )= { y 1 ,...,y l } be the smallest feasi-ble set for any x  X  X . By Definition 6, it holds:  X  x  X  R x  X  y i  X  S X,Y ( x ) \{ y l } : f IM -Sig ( x, y i f feasible flow different from f IM -Sig ,i.e. f = f IM -Sig there exist two sets L X,Y ( x ) ,M X,Y ( x )  X  F including fea-tures to which f transfers less earth and more earth than f L
X,Y ( x ):= { y  X  S X,Y ( x ) | f ( x, y ) &lt;f IM -Sig M
X,Y ( x ):= { y  X  R Y | f ( x, y ) &gt;f IM -Sig ( x, y ) Furthermore, it holds for any x  X  R x :  X  y  X  S X,Y ( x ) \ L X,Y ( x ) \ M X,Y ( x ): f ( x, y )= f  X  y  X  R Y \ ( S X,Y ( x )  X  M X,Y ( x )) : f ( x, y )=0. tained that  X  x  X  R x  X  y  X  S X,Y ( x )  X  z  X  M X,Y ( x ): Since y l is the only element in S X,Y ( x ) which may receive more earth than before, i.e. with the fulfilment of the condi-y  X  M X,Y ( x )and y l  X  M X,Y ( x ). For the sake of readi-bility, the letters S , L and M are used instead of S X,Y L X,Y ( x ), and M X,Y ( x ), where necessary.
 Case 1 : y l /  X  M X,Y ( x ), i.e. f ( x, y l )  X  f IM -Sig S
X,Y ( x )  X  M X,Y ( x )=  X  . Since both feature signatures are of equal total weight, it holds: It remains to show the minimality of the overall cost;  X  x R
X it holds:  X  = =  X  = Consequently, it is obtained  X  f  X  F with f = f IM -Sig : Case 2 : y l  X  M X,Y ( x ), i.e. f ( x, y l ) &gt;f IM -Sig It holds that  X  y  X  S X,Y ( x ) \{ y l } : f ( x, y )  X  f lowing evidence, the proof proceeds further, analogous to case 1:  X  f  X  F Since both feature signatures are of equal total weight, it can be concluded  X  x  X  R X :  X   X   X  Now, the minimality of the cost is given.  X  x  X  R X it holds:  X  = =  X  = IMSigLowerBound 1: input: signature X, signature Y 2: result =0 3: for each x  X  R X 4: earthMoved =0 5: construct heap for R Y regarding distances to x 6: extract y with minimum distance minDist in heap 7: while x.weight  X  earthMoved &gt; y.weight 8: result += minDist  X  y.weight 9: earthMoved += y.weight 10: extract y with minDist in heap 11: result += minDist  X  ( x.weight  X  earthMoved ) 12: return result Figure 2: Algorithm for the computation of the lower bound LB IM -Sig between two feature signa-tures As a result, it is concluded  X  f  X  F with f = f IM -Sig :
So far, we have shown that f IM -Sig is a feasible minimum-cost flow minimizing the overall cost with respect to the corresponding constraints. On the basis of the evidence cur-rently available, now we present that LB IM -Sig lower bounds the Earth Mover X  X  Distance on feature signatures.
Theorem 3 ( LB IM -Sig lower bounds EMD). Let ( F , X  ) be a feature space with a distance function  X  . For any two non-empty positive feature signatures X,Y  X  S + of equal total weight, it holds:
Proof. Let f be a feasible flow for EMD.  X  X  X  y  X  F :  X  X  X  y  X  F : f ( x, y )  X  Y ( y ) (IM-Sig target constraint) Since the rest of the EMD constraints remain the same for LB IM -Sig , f is a feasible flow for LB IM -Sig .Asshownin Theorem 2, it holds  X  f  X  F with f = f IM -Sig :  X   X 
LB IM -Sig ( X,Y )  X  EMD ( X,Y )
The computational algorithm of the lower bound LB IM -Sig is presented in Figure 2 listing its pseudo code. As input parameters the algorithm receives two feature signatures X and Y between which the LB IM -Sig lower bound distance is desired to be computed (line 1). After the result distance is initialized as 0 (line 2), for each feature representative x  X  R X , the current amount of earth transferred away from x is initialized as 0 (line 4), and the distances between x and all y  X  R Y are computed for which a min-heap is con-structed (line 5). After the heap property is provided, the first element denoting the minimum distance to x is popped from the heap (line 6). The earth transfer from x to the feature representatives in the smallest feasible set comes up in the next step (lines 7-11) followed by the termination of the algorithm via returning the value of LB IM -Sig (line 12).
For the time complexity analysis of the proposed algo-rithm, it is assumed that X and Y to be of equal size n = | R X | = | R Y | . For any x  X  R X the distance compu-tation between x and all y  X  R Y , and the min-heap con-struction can be performed in computation time complex-ity O ( n ). Whenever the current minimum value is popped from the heap, it takes maximum log ( n ) many steps until the heap property is provided again. Since the number of the execution of this step primarily depends on the amount of earth X ( x ), the minimum value extraction theoretically needs to be executed for maximum n many times, i.e. if S
X,Y ( x )= R Y holds, until there is no more earth for x to transfer. Thus, for each x , the extraction of minimum values from min-heap and accordingly ensuring the heap property can be performed in O ( n  X  log n ), leading to O ( n 2  X  the computation of the LB IM -Sig between X and Y .
Since the computation of LB IM -Sig between the query fea-ture signature and feature signatures in the database DB is performed | DB | many times, the overall computation time complexity of the filter step in the optimal multi-step algo-rithm lies in O ( | DB | X  n 2  X  log n ).

It is worth noting that the above mentioned minimum value extraction only theoretically needs to be executed for maximum n many times. Nevertheless, for each x  X  R X the amount of earth X ( x ) is transferred from x to not all y due to the linear programming constraints in the transporta-tion problem, in particular the source and maximum-flow constraints. Hence, for each x  X  R X the number of the ex-traction of minimum values from min-heap and accordingly ensuring the heap property is at most n , depending upon the IM-Sig target constraint, the distribution of the feature representatives of X,Y , and their corresponding weights.
So far, we have investigated our approach on feature sig-natures sharing no common representatives. However, as mentioned before, feature signatures may have some com-mon representatives in various domains, exposing no restric-tion in terms of the computation of IM-Sig lower bound. On top of this, it can be shown that a much tighter lower bound can be attained when instead of signatures with some shared representatives, feature signatures with disjunct representa-tive sets are utilized, as given below.

Definition 8 (Disjunct Feature Signatures). Let (
F , X  ) be a feature space with a distance function  X  and X,Y S + be non-empty positive feature signatures of equal weight with at least one common representative. X ,Y  X  S + are defined as disjunct feature signatures, satisfying  X  x, y
X ( x ):=
Y ( y ):= Theorem 4 (IM-SIG and Disjunct Signatures). Let X,Y  X  S + be non-empty positive feature signatures of equal weight, and X and Y be their generated disjunct feature signatures. Let f be IM-Sig flow from X to Y . It holds:
Proof. Due to space limitation, we present the proof for the case that there exists only one common representative, i.e.  X  ! z  X  R X  X  R Y .Thecasethat X and Y have more than one common representative can be shown analogously. Let f be IM-Sig flow from X to Y .Let S X,Y ( x )= { y 1 ,...,y be the smallest feasible set of x  X  R X in R Y .As  X  ! z  X  R
X  X  R Y ,maximum Y ( z )= Y ( z )  X  min ( X ( z ) ,Y ( z )) earth units can be transferred from any feature x  X  R X to z after the generation of X and Y , where Y ( z ) &lt;Y ( z ).  X  x there exist three cases to examine: Case 1 : z  X  S X,Y ( x ) : As there is no change in the outgoing flows, in particular f ( x, z )= f ( x, z ) = 0, the summand re-mains unaffected: Case 2 : z  X  S X,Y ( x )and z = x : There is no change in out-0. As  X  ( z,z )=0, Case 3 : z  X  S X,Y ( x )and z = x :If z = y l and Y ( y l f ( x, y l )  X  Y ( z )  X  Y ( z ), then f ( x, y l )= f ( x, y Y ( z )) and it holds at least one representative y new  X  S X,Y ( x )with  X  ( x, y  X  ( x, y l ), thus it holds units need to be moved to at least one representative y new S
X,Y ( x )with  X  ( x, y new )  X   X  ( x, y l ), thus it holds
Figure 3(a) shows an illustration of two feature signa-tures X,Y with R X = { x 1 ,x 2 } and R Y = { y 1 ,y 2 ,y x = y 2 holds. The weights are presented on the correspond-ing buckets. The computation of the LB IM -Sig ( X,Y )lower bound is 1 10  X  (0  X  3+3  X  1+2  X  3+4  X  2+5  X  1) = 2 . 2. After the disjunct feature signatures X ,Y are generated, as presented in Figure 3(b), the set R Y does not consist of y 2 any more and the IM-Sig lower bound becomes tighter:  X  (3  X  1+4  X  2+5  X  4) = 3 . 1.
We use a large-scale image database ImageNet [9] com-prising millions of images. As given in [6, 7], we generated feature signatures of two million images by first extracting features via random sampling of 10,000 pixels and cluster-ing them with k -means algorithm. Each feature representa-tive comprises the dimensions of the relative spatial informa-tion of the corresponding pixel (x any y positional values), CIELAB color values, coarseness and contrast values denot-ing the first and second Tamura texture features [18]. Thus, each feature is represented by a 7-dimensional feature vector.
In order to achieve accurate experimental evaluation, we present results denoting the averages over a query workload of 100. The experiments were conducted on a single-core 2.2 GHz machine equipped with Windows Server 2008 OS and 6 GB of main memory. It is worth noting that no paral-lelization of the implementations was performed. As ground distance between the features, we utilize the Euclidean dis-tance. Furthermore, as signature size and database size, we execute our experiments with the parameters 10, 20, 30, 40, 50, and 100, 200, 500, 1000, 1500, 2000 (  X  10 3 ), respectively. In addition, due to space limitation we choose k as 100 for the optimal multi-step k-nn filter and refinement algorithm.
In the first set of experiments, we analyzed the impact of the signature size on the processing time of the single distance computation, which is reported in Table 1. As dis-cussed in previous sections, EMD computation exhibits at least cubic complexity, leading to much higher time cost than that of LB Rubner and LB IM -Sig . In addition, it is ev-ident that LB Rubner indicates a processing time at a lower rate, since it only takes the computation of average feature of the corresponding signature into consideration. The deto-riation of efficiency with increasing signature size can be ex-plained by rising number of the features from which earth needs to be transferred. The ratio of the maximum number of (destination) features receiving earth from (source) fea-tures gradually decreases for LB IM -Sig with respect to the signature size: analyzed for a database of 1,000,000 objects, maximum 10 and 20 (destination) features are filled up with earth for the signature size 10 and 50, respectively, i.e. the Thus, the query time cost only rises at a small rate. Table 1: Effect of signature size on average single distance computation time values in milliseconds Distance 10 20 30 40 50 EMD 0.0820 0.2468 0.6795 1.5490 3.0907 LB IM -Sig 0.0064 0.0198 0.0399 0.0690 0.1069 LB Rubner 0.0014 0.0018 0.0023 0.0027 0.0031
In the further experiments below, we aim at analyzing the results with respect to the proposal LB IM -Sig , the existing lower bound LB Rubner , and the composition method allow-ing for the efficient query processing in the optimal multi-step algorithm in which LB Rubner and LB IM -Sig serve as the first and second filter, respectively. As presented in Fig-ure 5, LB Rubner is utilized to filter the data objects in the database and generate a candidate set on which LB IM -Sig applied to further reduce this set. Then, EMD is computed for all filtered objects which provides the end result.
In the second set of experiments, we measured the over-all query time, the number of EMD computations, and se-lectivity of the aforementioned lower bounding techniques while varying the signature size and fixing the database size to 1,000,000. Figure 4(a) summarizes the query pro-cessing time for 100 nearest neighbors over different signa-ture size. Obviously, LB IM -Sig and composite multistep ap-proach (denoted as Rubner and IM-Sig in the figure) show a higher efficiency with slowly increasing time cost than that of LB Rubner ,inparticular6.6and3.8secondsforsigna-ture cardinality 10, respectively, while LB Rubner requires 17.4 seconds. The efficiency of LB Rubner deteriorates more apparently after signature cardinality 30. The reason for this drop-off is the expensive EMD computation exhibiting higher computation time with increasing signature size (cf. Table 1). The better efficiency performance of the compos-ite multistep approach can be elucidated by the fact that it generates a smaller candidate set than that of LB IM -leading to a shorter refinement step in the multistep query processing. In order to explicate this issue, we below analyze the number of EMD computations in each query processing.
As given in Figure 4(b), it is observed that LB Rubner shows a very high number of distance computation, namely over 200,000 remaining almost constant regardless of the sig-nature size. In contrast, the number of data objects passing LB IM -Sig is considerably lower (8007 at sig. size 10), and the cost is related with a linearithmic time complexity be-tween linear and quadratic with respect to the signature size, as argued in Section 4.3. Another further result matching our expectation is that the composite multistep approach shows the lowest cost in all signature cardinalities (7166 computations at sig. size 10). This fact can be expounded bythegenerationofasmallercandidatesetviatwofilters, speeding up the whole query process. Moreover, it exhibits a much smaller growth than the other filters, depicting again a linearithmic time complexity in terms of signature size.
Figure 4(c) illustrates that irrespective of the signature size the selectivity of LB Rubner remains above 20%, while LB IM -Sig and the composite multistep approach show much better performance, e.g. 0.8% and 0.71% at signature size 10, respectively. The results provide confirmatory evidence that the selectivity of the proposed approach lies only slightly above that of the composite multistep approach, relying on a better pruning of the unpromising data objects.
In the third set of experiments, we analyzed the effect of the data cardinality on the overall query time and the number of EMD computations by fixing the signature size to 30. The results presented in Figure 6(a) match our ex-pectation: LB IM -Sig outperforms LB Rubner and shows a relatively smooth behavior exposing a much smaller slope, growing linearly in the size of the database cardinality. For 100,000 data objects, the query time (14.6 sec) is lower than for Rubner X  X  approach (21.9 sec), and the difference becomes more apparent with increasing data cardinality. For 2,000,000 data objects, LB Rubner requires roughly three times more query processing time (284.5 sec) than for the proposal (108 sec), exposing a steeper slope due to large number of EMD computations performed. Furthermore, searching for 100 nearest neighbors in the database of 2,000,000 objects with the composite multistep approach takes almost 6.5 times faster than Rubner X  X  approach (44 sec vs. 284.5 sec). As mentioned above, the results presented in Figure 6 are for signature size 30 showing higher query time costs than those with lower signature sizes, which we omit due to space limitations. Not least, regarding the latter high data cardinality of signature size 10, Rubner X  X  approach, the pro-posed method, and the composite approach require 35 sec, 13.1 sec, and 5.9 sec, respectively.

Figure 6(b) summarizes that LB Rubner shows the highest number of EMD computations with increasing data cardi-nality with a fixed signature size of 30. For the search in 100,000 data objects, it requires on average 33,221 computa-tions, while the proposed and the composite approaches need 16,432 and 10,975 distance computations. Obviously, the re-quired number of exact distance computations for Rubner X  X  approach grows linearly with the number of database size with a much steeper slope than for the other filters. Inter-estingly, the selectivity performance of the remaining filters expose very similar behavior with a very slightly increasing slope. Furthermore, from data cardinality 500,000 on Rub-ner X  X  approach suffers a quick linear increase on both query time and number of EMD computations. For data cardinal-ity of 2,000,000, searching with Rubner X  X  approach requires roughly 12.8 and 9.7 times more EMD computations than for LB IM -Sig and the composite multistep approach, respec-tively (422,745 vs. 33,164 and 43,286 computations). These results clarify the behavior of the overall query time curves in Figure 6(a) where it is realized that the expensive EMD computations show a high impact on query processing time.
In the last set of experiments, the underlying reasons of the overall query time results were investigated in detail with a fixed data cardinality 1,000,000. Recall that the distance-based filter approaches entail the aforementioned steps in which first the filter is applied, and then the unpromising objects are discarded via the exact distance computation.
In Figure 7, it is observed that the filter step of LB Rubner requires only slightly increasing query processing time which is bound to remain under 4 sec, while the refinement step indicates a linearly increasing time cost (665 sec for sig. size 50, i.e. 192 times more than for filter step). The reason for this quick efficiency drop-off in spite of the slightly increas-ing number of EMD computations is the high number of candidates passing the filter (over 200,000) and the expen-sive EMD distance computation of at least cubic complexity, showing higher time cost with increasing signature cardinal-ity (cf. Table 1), leading to a remarkable time cost difference to both LB IM -Sig and composite multistep approach.
Figure 7: Filter and refinement time of LB Rubner Figure 8: Filter and refinement time of LB IM -Sig
As shown in Figure 8, LB IM -Sig filterstepexhibitsmore elapsed time than for the refinement step for signature size 10-40 (6 sec vs. 0.6 sec for sig. size 10), while this behav-ior changes for the signature size 50 (108.3 sec vs 151.1 sec). The reasons are that the number of objects passing the filter shows a linearithmic time complexity with respect to the sig-nature size and the computation of EMD requires more time with increasing signature cardinality, as mentioned above. Figure 9: Filter and refinement time of two filters
Figure 9 exhibits the results for the composite multistep approach where it is observed that Rubner filter step shows faintly more elapsed time than for IM-Sig filter and the re-finement step for signature size 10 (1.7 sec vs. 1.4 sec and 0.7 sec). However, with increasing signature cardinality, Rub-ner filter step requires considerably less time than for the other steps (4 sec vs. 24 sec and 107.3 sec for sig. size 50), showing directly similar behavior regarding filter step in Figure 7. Since the number of the candidates filtered by LB Rubner only changes at a small rate, the signature size is concerned in the increasing elapsed time for IM-Sig fil-ter step (cf. Table 1). Another further observation is the increasing time cost for the refinement step with respect to the signature size, exhibiting similar behavior regarding refinement step in Figure 8, relying on the same reasons: the linearithmic time complexity of promising objects pass-ing LB IM -Sig ,aswellastheknownhightimecostofEMD computation with increasing signature cardinality. Based on these facts, the composite multistep approach exhibits less filter and refinement time costs than the other filters, leading to lower overall query time costs (cf. Figure 4(a)). To sum up, the proposed approach LB IM -Sig outperforms LB Rubner on feature signatures with respect to efficiency and number of EMD computations. The multistep approach with both Rubner and IM-Sig filters exhibits the highest efficiency with increasing signature and data cardinality.
In this paper we presented how k-nearest-neighbor queries can be efficiently processed by using the Earth Mover X  X  Dis-tance in a very large multimedia database of features signa-tures. To this end, we explicated an efficient filter approx-imation technique which is applicable on feature signatures and lower bounds the Earth Mover X  X  Distance. We theo-retically investigated the computation of the flow by prov-ing its feasibility and minimum-cost properties. Moreover, conducted experiments on real data point out the high effi-ciency of the proposal outperforming the previous existing approach by considerably reducing the number of exact dis-tance computations and attaining order-of-magnitude query processing time cost reduction for high dimensional feature signatures.

As future work, we intend to extend this research to fur-ther domains, such as audio and video fields where new ef-ficiency methods are required to be developed.
This work is funded by DFG grant SE 1039/7-1. [1] R. Agrawal, C. Faloutsos, and A. N. Swami. Efficient [2] I. Assent, A. Wenning, and T. Seidl. Approximation [3] I. Assent, M. Wichterich, T. Meisen, and T. Seidl. [4] I. Assent, M. Wichterich, and T. Seidl. Adaptable [5] C. Beecks. Distance-based similarity models for [6] C. Beecks, M. S. Uysal, and T. Seidl. A comparative [7] C. Beecks, M. S. Uysal, and T. Seidl. Signature [8] C. B  X  ohm, S. Berchtold, and D. A. Keim. Searching in [9] J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and [10] C. Faloutsos, M. Ranganathan, and Y. Manolopoulos. [11] F. Hillier and G. Lieberman. Introduction to Linear [12] M. E. Houle, X. Ma, M. Nett, and V. Oria.
 [13] F. Korn, N. Sidiropoulos, C. Faloutsos, E. L. Siegel, [14] H.-P.Kriegel,P.Kr  X  oger, P. Kunath, and M. Renz. [15] Y. Rubner, C. Tomasi, and L. Guibas. A metric for [16] B. E. Ruttenberg and A. K. Singh. Indexing the earth [17] T. Seidl and H.-P. Kriegel. Optimal multi-step [18] H. Tamura, S. Mori, and T. Yamawaki. Textural [19] Y.Tang,L.H.U,Y.Cai,N.Mamoulis,and [20] R. J. Vanderbei. Linear Programming: Foundations [21] M. Wichterich, I. Assent, P. Kranen, and T. Seidl. [22] J. Xu, Z. Zhang, A. K. H. Tung, and G. Yu. Efficient [23] P. Zezula, G. Amato, V. Dohnal, and M. Batko.
