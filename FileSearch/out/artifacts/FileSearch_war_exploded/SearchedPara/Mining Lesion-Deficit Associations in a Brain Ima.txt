
This is a difficult task because of the different image-file formats, the spatial and contrast resolutions, and the large amount of space that image data need. BRAID is implemented in Illustra, a commercial object-relational database management system (ORDBMS), mainly be-cause it provides an efficient query language based on extensions to SQL, the ability to create new abstract data types, and operators for them, and supports encap-sulation, inheritance and polymorphism that make ap-plications easier to develop and maintain. This is done through the development of datablades. We developed an image datablade that manages images extending the 
SQL language with an image datatype and operators like summation, intersection, type casting (e.g., con-version of images from the internal format to GIF), thresholding, scaling, volume calculation, etc. Statis-tical operators that operate on images were also im-plemented. To perform structure-function analysis, for example, one can submit an SQL query that will dis-play the distribution of lesions for all subjects that have a certain deficit (see Figure 2 for the sum of lesions for subjects that did and did not develop Attention Deficit 
Hyperactivity Disorder (ADHD)). X  Most of the capa-bilities of BRAID are available through a web interface (see http://braid.rad.jhu.edu/interface.html). mation from over 700 subjects from two different stud-ies: the Cardiovascular Health Study (CHS) and the 
Frontal Lobe Injury in Children (FLIC) study. It also includes 5000 artificial subjects that were generated us-ing our lesion-deficit simulator [MHD99] which is based on the bayesian network model. The artificial subjects were used to test not only the scalability of our meth-ods but also to evaluate different lesion-deficit analysis methods as a function of the number of samples needed, the strength and complexity of lesion-deficit associa-tions, the spatial distribution of brain lesions, and the registration method used [MHD99]. structure-function associations, such as chi-square anal-ysis, log-linear analysis, logistic regression, and others, presented next. The chi-square test [And971 returns a p-value for each pair of structure and deficit; the lower the pvalue the stronger the evidence against the hy-pothesis of independence. Alternatively, one may use the Fisher exact test. 3.1 The preprocessing phase 
After the 3-D MR image is collected for each subject, each lesion is delineated by a neuroradiologist, as a 
Figure 1: The (a) original MR image, (b) atlas, and (c) atlas image overlaid on the deformed MR image. region of interest (ROI) on each slice using thresholding and segmentation. Each ROI is reconstructed in three dimensions. The ROIs are then registered to the 
Talairach anatomical atlas. We use a nonlinear method based on a three-dimensional elastically deformable model [Dav97]. The effect of registration of an MR image to the Talairach atlas is presented in Figure 1. 3.2 The mining methods 
After the segmentation of lesions and registration of the binary images to a common standard, the binary images consist of voxels that are either normal or abnormal (i.e., part of a lesion). These binary images are stored in the database as line segments mainly to reduce the space requirements. This structural image data combined with the functional variables form the data for each patient. Mining methods can operate on a resolution range from the spatially distinct structures of an anatomical atlas (atlas-based analysis) to the voxel level (voxel-based analysis). 3.2.1 Atlas-based analysis 
In the case where anatomical structures represent func-tional units, the atlas-based analysis is more sensitive than voxel-based analysis since the atlas provides sig-nificant prior knowledge. 
The first step in the atlas-based analysis is to calculate for each patient, pi, and structure, sj, the fraction of lesioned volume, fP,,sj. We present methods for continuous and categorical structural variables. In the second case we define a structure as lesioned or not based on the fraction of it that is lesioned. The conditional probability of abnormality of a structure sj given fPz,Sj, P(Sj Ifp,,sj), is expected to be a sigmoid function. For simplicity, in the case of categorical structural variables, a patient is treated as having a lesion in a structure if the intersection of all his lesions with the structure is at least one voxel. To remove the effect of thresholding we also analyze the atlas structures as continuous variables, considering for each one, the fraction that is abnormal (lesioned). 
In the case where the search of the model that ex-plains the data observed can be directed through spe-cific hypotheses or prior knowledge, the situation is eas-ier. The hypotheses can be formed after using explo-rative visualization or other methods, and can be tested using statistical tests. An example where visualization helps to reduce the search space for a model is shown in Figure 2. If there is little preconception about the relationships between the variables, all the possibilities have to be explored. This exploratory, or data mining, analysis is presented below. There are two approaches one can follow: the bivariate (pairwise) and the multi-variate analysis. Let F be the number of functional and 5 X  be the num-ber of structural variables respectively. In the case of categorical structural variables we construct F x S two-way contingency tables and we compute for each one the Fisher exact test. The associations between struc-tures and deficits are sorted in increasing order of the p-values returned from the exact tests and the ones with the lowest p-values are reported. For continuous struc-tural variables we use the Mann-Whitney test and lo-gistic regression analysis. The Mann-Whitney statis-tic is used because the distributions of the fractions of lesioned volumes are not Gaussian. In exploratory analysis of either categorical or continuous structural variables, computing a statistic for many pairwise tests creates the multiple comparison problem, i.e., certain portion of the tests to be positive by chance. Since a standard Bonferroni correction [And971 overestimates the number of independent tests performed in this case, we use a heuristic modification, the sequential Bonfer-roni correction [And971 to get more reasonable results. Complex multivariate associations may not be found by multiple use of bivariate statistics. For example con-sider a deficit that is associated with two structures and appears only when both of them are lesioned. Also, multivariate analysis is free of the multiple compari-son problem since it evaluates an entire model with one statistic. A multivariate extension of the chi-square test for categorical variables is the log-linear analysis. Logis-tic regression is another multivariate method that can be used to relate the log-odds of having a particular deficit to the fra.ction of lesioned structures. We use the stepwise logistic regression, where the algorithm that is used for discovering the model that explains the interac-tions, starts with no associations and a greedy approach is applied to add (or delete) associations based on their relative strength. The atlas-based analysis results are as good as the atlas that is being used. Instead of imposing a model on the image data, one can analyze them on a voxel-by-voxel basis. A voxel can be either normal X  X r abnormal so, in this case, the structural variables are categorical. Given that the number of voxels that we consider are on the order of lo7 we have to perform so many (i.e., 107) 
Fisher exact tests for each of the functional variables that we examine. For each deficit, d, we create two image files. Each voxel of the first (second) file is the sum of the corresponding voxels in the binary images for patients who have (do not have) the deficit. The calculation of the contingency table and of the Fisher exact test is computationally tractable if these two image files can be efficiently constructed. The multiple-comparison problem is even more intense here due to the large number of tests we perform. However, in this case, it can be attacked with clustering analysis since random false positives will not tend to cluster. 
We also use voxel-based regression analysis to deter-mine whether voxels in a certain region are associated with a functional variable. We construct a regression equation that relates lesions in a sphere of a given ra-dius and center to a deficit. Let 1 be a lesion, o be a sphere, v(r) denote the volume of a region T, and i(rr , ~2) denote the intersection of two regions ~1 and 73. The identification of the causal region is done by calculating the optimal center and radius for the logis-tic regression equation: where oddsd = a, pd(.) is the probability of having a certain deficit d (e.g., ADHD), fs = w is the fraction of the sphere that is lesioned, a =(log odds of d)/(lesioned fraction of sphere volume), and b the prior log odds of deficit d. Given the center (2, y, .z) and the radius T of the sphere, solving this equation, we can find values for the parameters a and b such that the sum of squares of residuals is minimized. The goal is to optimize the sphere parameters (x:, y, Z, r) to obtain the best fit of the data to the regression line. We use simulated annealing for the optimization. The solution is the sphere that best discriminates between lesions that are and are not associated with deficit d. This nonlinear optimization procedure is computationally intensive. 
Visualization applied prior to the analysis procedure can help direct the analysis by choosing certain struc-tures of the anatomical atlas to examine further us-ing the statistical tests. In Figure 2 we present the sum of images of all lesions over subjects that did and did not develop ADHD (ADHD+ and ADHD-, respec-tively) . Based on these images and on previous research implicating a frontal lobe-basal ganglia-thalamic path-way, we choose the right putamen and the left thalamus 
