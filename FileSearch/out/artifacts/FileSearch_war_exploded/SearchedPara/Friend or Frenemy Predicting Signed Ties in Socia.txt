 We study the problem of l abeling the edges of a social net-work graph (e.g., acquaintance connections in Facebook) as either positive (i.e., trust, true friendship) or negative (i.e., distrust, possible frenemy) relations. Such signed relations provide much stronger signal in tying the behavior of online users than the unipolar Homophily effect, yet are largely un-available as most social graphs only contain unsigned edges.
We show the surprising fact that it is possible to infer signed social ties with good accuracy solely based on users X  behavior of decision making (or using only a small frac-tion of supervision information) via unsupervised and semi-supervised algorithms. This work hereby makes it possible to turn an unsigned acquaintance network (e.g. Facebook, Myspace) into a signed trust-distrust network (e.g. Epinion, Slashdot). Our results are based on a mixed effects frame-work that simultaneously captures users X  behavior, social interactions as well as the interplay between the two. The framework includes a series of latent factor models and it also encodes the principles of balance and status from Social psychology. Experiments on Epinion and Yahoo! Pulse net-works illustrate that (1) signed social ties can be predicted with high-accuracy even in fully unsupervised settings, and (2) the predicted signed ties are significantly more useful for social behavior prediction than simple Homophily. Categories and Subject Descriptors H.5.3 [Information Systems]: Web-based Interaction ; H.3.3 [Information Search and Retrieval]: Information fil-tering H.2.8 [Database Management]: Data Mining General Terms : Algorithms, Performance Keywords : Social ties, edge labeling, signed network, social behavior prediction, Homophily, sociological principles
Social networks are playing an increasingly important role i n shaping the business models of today X  X  internet industry. Not only are most emerging online services providing func-t ionality to facilitate social interactions in their systems (e.g. last.fm, slashdot, Flikr, Yelp), but even many traditional internet systems are actively exploiting social networks to enhance their services, marketing and revenue, e.g., search engines (e.g., Bing), online retailers (e.g., Amazon), Web portals (e.g., Yahoo!). This is partly due to the widespread faith in the social effect of Homophily [20] that people so-cially acquainted tend to behave similarly. However, the ex-tent to which this belief holds true is debatable  X  after all, it is unreasonable to expect two users who know each other (e.g., who are connected in Facebook) to behave alike in ev-ery aspect of their online decision making (e.g., purchase, ad click, movie rental, search intent, political view, senti-mental moods). Instead, a much stronger signal of social ties is the network of trust relationships, since in many de-cisions we make, the opinions from the people we trust are what we really care about and what our decisions usually get influenced by. Unfortunately, this information is largely unavailable given the fact that the vast majority of social networks only contain acquaintance relationships, without distinguishing whom you trust from whom you don X  X .
Quite surprisingly, we show it is possible to infer a signed label for an acquaintance relationship  X  positive as trust (true friendship), negative as distrust (possible frenemy). In this way we make possible to turn an unsigned acquaintance network (e.g. Facebook, Myspace) to a signed trust-distrust network (e.g. Slashdot, Epinion). Moreover, by allowing us to tie the behavior of an online user to whom he trusts rather than whom he knows , the predicted signed relations are significantly more informative than Homophily for the purpose of behavior prediction.
The main focus of this paper is ( i ) to predict the signed social ties (i.e., trust/distrust) out of the unsigned (i.e., ac-quaintance) relationships in social networks; and ( ii ) to ex-amine how the predicted signed ties help behavior predic-tion. In particular, given that two users are socially con-nected (i.e., know each other), we would like to infer whether the connection is positive (e.g., trust, true friendship) or negative (e.g., distrust, possible frenemy); Furthermore, by tying the behavioral activities of online users with the in-ferred signed relationships, we examine how social targeting can be improved to promote online services, for example, to provide better matched search results, News articles, games, advertisements, or products [21, 18, 17, 26].

By predicting signed social ties, we enable the social con-nections in a traditional social network to capture much richer relationships reflecting either positive (e.g. trust, ap-proval, true friendship) or negative (e.g. distrust, opposi-tion, frenemy) interactions. This will substantially extend the acquaintance relationship in standard social networks (e.g. Facebook), and also the unipolar tie-strength analysis of traditional link prediction [19, 22, 5], to a meaningful new dimension  X  we are able to en-sign 1 an unsigned network by t urning it to a signed network. Moreover, models designed for signed social ties also have the potential to improve our understanding of social relations and the structure of our society, shedding light to sociological principles in general [6, 22, 5, 15].
The interplay between social relations and user X  X  behavior o f decision making is a key driving force underlying social ac-tivities [21, 18, 17]. On the one hand, social interactions can influence individual X  X  behavior of decision making [10, 1]  X  for instance, users can learn from each other, following their trusted friends X  good decisions and avoiding their mistakes. On the other hand, a user X  X  behavior could in turn impact his relationships with others  X  for instance, a user with ma-licious behavior turns to get bad reputations from others. In this paper, we present a framework for predicting the signed social ties by capturing such interplay. Specifically, we ex-plore the following  X  X ixture of effects X  assumptions about social relations and users X  behavior of decision making: 1. The decision of a user is not decided solely by his own 2. The social relationship between two users depends not
It is desirable to distinguish these two groups of factors when modeling behavior and social relationships. We present the Behavior Relation Interplay (BRI) model, a latent fac-tor model that leverages behavioral evidence to infer social interactions and at the same time exploits the learned re-lations to tie users X  behavior. The key idea in BRI is to associate latent factors with both users and items and to define coupled models to simultaneously characterize both the social interactions and behavioral evidences.
A key question is whether it is possible at all to infer signed ties in the absence of any labels. One of the more surprising results of our work is that it is, indeed, possi-ble. To achieve this we design both unsupervised and semi-supervised algorithms for signed social tie prediction. In the unsupervised setting, we only observe the acquaintance con-nections but none of the sign labels, as is the typical case in the vast majority of the acquaintance social network sites such as Facebook. We show that BRI achieves fairly accu-rate predictions. The key idea is a mechanism called  X  auto-matic sign determination  X  that discovers the signs of social ties automatically from user activity data. We also examine semi-supervised prediction, where a small fraction of the sign
With slight abuse of expression, here by  X  X n-sign X  we mean  X  to assign a sign to X  something that is unsigned. labels are given. We show that BRI model provides com-parable performance to the leave-one-out prediction results (i.e. all but one sign are observable) of the topology-based algorithm [14].

To further improve the prediction accuracy and deepen our understanding of signed social ties, we extend the BRI model to encode general sociological principles, particularly the theories of status and structure balance [6, 15]. One nice property of our model is that it naturally provides a mapping from a user to his social status and an interest-ing visualization of the network. We show the sociological principles are useful for signed social tie prediction.
Finally, we show that by predicting signed social ties, BRI models achieve significantly better performance in behavior prediction than models equipped with Homophily. In partic-ular, BRI gains 5.8% improvement of RMSE in rating pre-diction on Epinion data, and 6.9% improvement of nDCG in top-k ranking on Yahoo! Pulse data.

As the paper consists of a series of progressive models, experimental results are presented right after each model is developed so as to motivate further enhancements. The paper is structured as follows: we first define the task and briefly reviews existing works in  X  2; the plain BRI model and learning algorithms are presented in  X  3; then  X  4 extends the model to encode sociological principles;  X  5 tests the proposed models in behavior prediction and  X  6 concludes.
We consider a typical scenario in social networks where u sers routinely make decisions while actively interacting with one another. This motivates us to analyze the interplay be-tween an individual user X  X  behavior of decision making and the tie between users. Suppose we are given a set of users and a set of items (e.g., News articles, advertisement, retail-ing products, movies) The users are connected by a social network represented by the graph G ( U , C ). Here C = { c uv } d enotes the set of edges, i.e., c uv  X  { 1 , m issing } defines the acquaintance connection between a pair of users ( u,v )  X  U 2 . In the network, users a ctively make decisions, for example, by clicking links, pur-chasing products, rating movies. Formally, a decision is a mapping That is: user u makes a decision regarding item i with a response y ui  X  Y ( e.g. u rates movie i with a score of y F or convenience, hereafter we use u and v to index users, and i and j for items unless stated otherwise.
 We are motivated by the following two tasks: En-signing social relations. A signed social tie is a map-Figure 1: An illustration of decision making in so-cial networks: users make decisions with respect to items (e.g. by rating movies); simultaneously users also interact with one another exerting positive or negative social ties.
 Behavior prediction. We are also interested in predicting W e focus on the more challenging task of sign labeling in  X  3 and  X  4, and defer the second goal to  X  5.
To provide a context of our work, we briefly review exist-i ng research on behavior prediction and relation analysis. Behavior Prediction. Behavior prediction aims at pre-dicting future (unseen) decision responses y ui of a user u w .r.t an item i . We consider collaborative filtering (CF) approaches [12, 27], which tackle the problem by learning from past behavior. A widely used approach to CF learns informative compact latent factors to uncover the dyadic in-teractions. The basic idea is to associate latent factors with each user and each item, and let the decision be explained by the interactions (e.g., multiplication) of these terms.
While CF approaches gain a lot success in recommender systems, they may be insufficient in the context of social networks where user interactions influence decision making dramatically [10]. For example, instead of making decisions purely by following his own taste as in recommender sys-tems, in a social network, a user can achieve more produc-tive decisions by learning from his friend X  X  experiences. This aspect has been rapidly increasing in importance as many online services are starting to add a social network aspect to their system (e.g. last.fm, Yelp, Flikr) or directly rent existing social networks (e.g. Amazon, Netflix, Bing). Our recent work [26] exploited Homophily for behavior predic-tion, where the behavior of two socially-connected users is tied and reinforced by each other. This work further inves-tigates a more realistic case where acquainted users are not necessarily reinforcing each other in decision making. We do so by modeling the signed social ties, a much stronger signal that allows us to tie the behavior of a user to whom he trusts rather than whom he knows.
 Unsigned Relation Analysis. Traditional relation analy-sis [16, 23, 19, 5] focuses on unsigned relations and estimates the tie strength between two users by propagating the ob-served links through the network topology. For a pair of users ( u,v ) the observation whether they are connected (i.e., know each other) is binary s uv  X  { 1 , m issing } . Many exist-ing methods employ random walk or spectral algorithms. A random walk on the graph G is a reversible Markov chain on the vertices U . Vertices are considered close whenever the hitting time is small or whenever the diffusion proba-bility is large. In some cases spectral smoothness is used to obtain similarity via the associated graph Laplacian [24]. This yields the intrinsic kinship defined by the dominant eigenvectors of the graph [16].
 Signed Relation Analysis. Social relations are complex and subtle [15, 6], reflecting interactions that could be ei-ther positive (e.g. trust, agreement, approval) or negative (e.g. distrust, disagreement, opposition). Yet until recently a number of authors began to investigate signed relations by examining the links in emerging signed social networks (e.g., Slashdot, Epinion). [6] applied random walk algorithms to propagate both positive and negative links on Epinion net-work. [13] conducted similar experiments on Slashdot data. [15] examined the applicability of social psychology theories at multiple signed networks. [14] further applied classifi-cation approaches to predict the sign of social relationships. While the goal of [14] is seemingly similar to the sign-labeling task we explore here, this work is still within the scope of link analysis since the focus there is solely on the network topology. Furthermore, they adopted a leave-one-out set-ting  X  a rather optimistic scenario where the sign labels for all but one edge are observable. Instead, our focus is not on network topology, but rather on discovering the interplay between relations and behavior. Also, we require no or fewer labels to obtain comparable prediction as [14].
Before providing a formal description of our approaches l et us briefly discuss the data, which we will use to draw intuitions for model development, test proposed models and motivate further enhancements.
 Epinion We use data from www.epinion.com for our analy-sis as it is the only publicly available dataset we are aware of that contains both signed social relationship and user behav-ioral data. Epinion is a well-known knowledge and opinion sharing web site, where users post reviews and assign ratings (on a scale from 1 to 5) to various of items such as retailing products, companies, or movies. More interestingly, the site maintains a signed social network that allows each user to in-dicate explicitly other users that he is connected to as either positive (trust) or negative (distrust). We apply our mod-els to predict the trust/distrust relationships. The data set contains 132 thousand users, 1560 thousand items, 13.6 mil-lion ratings and 850 thousand signed relationships. Both the user-item matrix and the user-user network are very sparse, with densities of only 0 . 014% and 0 . 0048% respectively. Yahoo! Pulse pulse.yahoo.com is an unsigned social net-work that allows users to communicate with friends and also express their preference for items with explicit indications of  X  X ike X . We examine data collected over one year, involv-ing 10 8 users and a large collection of items, such as games, s ports, News feeds, finance, travel, shopping, and local infor-mation services. Our evaluation focuses on a random subset consisting of about 400 items, 1.2 million users and 29 mil-lion  X  X ike X  indications. Due to the unsigned characteristic of this network, we are not able to use this data set to evaluate Figure 2: Histograms of behavioral correlations for positively and negatively connected users on epinion.com . edge-sign prediction. Instead, we will use this data set for behavior prediction evaluation (Section 5).
This paper attempts to predict signed social ties by cap-t uring the interplay between behavioral and social inter-actions. A key insight is that we consider the behavioral data (e.g. the ratings) to be useful for predicting signed so-cial interactions. This is reasonable as in reality we are often willing to follow the opinions from a trusted friend and fight against those from a foe. As a result, decisions of positively-connected (i.e., trust) friends are more likely to agree, whereas for frenemies the chance of disagreement would be considerably higher. Here we empirically validate this intuition on the Epinion data, as can be seen in Figure 2. In particular, we quantify behavioral agreement using the Pearson correlation score between the ratings of two users, and we compare this between users with positive and nega-tive links. The Pearson score is defined as follows: where O [ uv ] denote the set of items that both u and v rate. Figure 2 plots the distribution of  X  uv for positive-r elationships ( u trusts v ) and negative-relationships ( u dis-trusts v ). We can see that the behavioral correlation is highly predictive for signed relations. Specifically, the ma-jority (almost 90%) of the positive links indeed show positive behavioral correlations. The case for negative links is a bit more complicated  X  the distribution peaks at both -1 and +1, indicating that users with distrust relationships could agree or disagree with each other. But even in this case, we can still observe that for almost 40% of the negative edges, the signs of relations are consistent with the signs of behav-ioral correlations.
The nontrivial relationship between behavioral correlatio n and the sign of social relations motivates us to leverage both social and behavioral evidences when predicting signed so-cial ties (and/or behavior vice versa). In this section, we present models to capture the interplay between users X  be-havior of decision making and social interaction in the con-text of social networks. Figure 3: Illustration of behavior-relation interplay. (Left): user u makes a decision w.r.t. item i by ei-ther following his own interest in i or taking a friend v  X  X  opinion to i ; (Right): social relation between u and v is a mixture of their prior impressions to each other and the calibration based on their behavioral agreement w.r.t. decision items.
Similar to the latent factor CF models for behavior predic-t ion, we devise a latent factor model for user behavior data { y ui } . We associate latent factors  X  u with user u a nd  X  with item i . For notation convenience we require that each latent factor contains a constant component so as to absorb user/item-specific offset into latent factors. In particular, we assume the following model for behavior (The gist of our approach is captured by Figure 3): Intrinsic taste We assume user u  X  X  interest in item i is T rust credit Similarly, we assume user u trusts an acquainted S ocial decision making Furthermore, we assume that user H ere p  X  [0 , 1] encodes the the probability with which a user X  X  behavior is decided by his own taste.

The same model can be applied to incorporate social re-lations among users. We assume a user u is fully character-ized by its latent factor  X  u and devise the following model t o characterize the relationships of user u to user v : Prior impression We assume user u trusts an acquainted B ehavior agreement User u calibrates his impression re-
Note that a dynamic model, i.e., h uv ( t ) over time t , is pos-sible if we have access to the time stamp of each activity. Social tie We assume the social interaction is a mixture H ere q  X  [0 , 1] defines the mixture probability of prior im-pression. Unlike in random walk models where proximity in a graph is simply used to smooth secondary estimators of parameters (e.g. reachability, hitting times), we make direct use of it to model the latent variables  X  s.

Based on the above descriptions, we specify the proba-bilities with spherical Gaussian distributions (extensions to other distributions are straightforward) and we summarize the overall model in the table below.
 Here  X  I ,  X  U ,  X  S ,  X  Y are scalars specifying the variance.
W e develop inference algorithms for the proposed model, relying on three types of dyadic evidences: 1. The user behavior trace { y ui } i n the form of user-item 2. The unsigned user-user social connections (e.g., the ac-3. The signed connections { s uv } , s uv =  X  1 or missing, We refer to c uv as u nlabeled tie and to s uv as l abeled tie . Our goal is to infer the labels of social ties using none (i.e. unsupervised) or only a fraction (i.e. semi-supervised) of the label observations by fitting the latent factor model BRI on the above three sources of evidences.
We first consider the case where no label is observed. This i s a typical setting for the majority of social network sites such as Facebook. Our key idea is to use an absolute-value link function |  X  | , which bridges the hidden signed-ties we aim to infer, h uv , to the unsigned acquaintance connections w e actually observed, c uv . In this way, we enable the mech-a nism of automatic sign determination in the same spirit as the maximum margin clustering of [25]  X  we assume the objective function achieves optimality at either h uv = +1 or h uv =  X  1 ; through optimization, the model will automat-ically determine the optimal sign for h uv because different s igns correspond to different objective values.
 Formulation. Given the observations of user-item behav-ioral interactions ( u,i )  X  X  y and unsigned user-user connec-t ions ( u,v )  X  X  c , we have the following optimization: w here  X  U ,  X  I ,  X  c ,  X  y are trade-off parameters, f ui are defined according to Eq(3) and Eq(5).
 P rediction. Given an incoming pair of users, ( u,v ), we predict the sign of the social tie (i.e., trust or distrust) as follows: H ere h 0 is a threshold which suitably determines the fraction o f positive and negative ties. Whenever we have access to some labels on a validation set, it is straightforward to deter-mine h 0 via line search: simply sort h uv by magnitude and c ompute the balanced error for each distinct value of h uv T his is in complete analogy to the line search procedure of [8] for F  X  scores.
 O ptimization. Eq(6) is minimized by stochastic gradient descent. Strictly speaking the objective does not decouple entirely in terms of  X  and  X  due to the matrices M y and M N onetheless we found that an approximation which performs stochastic gradient descent on  X  and  X  while keeping M y ,M fixed produces good results. Also, it can be decomposed into s essions and parallelized using the MapReduce framework.
The stochastic gradient descent procedure is entirely stan-dard: the algorithm processes all observations and updates the parameters in the direction of the negative gradient. For instance, for O y the updates are as follows:  X  u  X  ( 1  X   X   X   X  U )  X  u  X   X  ( f ui  X  y ui )( p  X  i + (1  X  p ) M  X  i  X  ( 1  X   X   X   X  I )  X  i  X   X  ( f ui  X  y ui )( p  X  u H ere  X   X  U and  X   X  I are regularization constants suitably ad-j usted with respect to the prediction accuracy (they are ob-tained by normalizing Eq(6) in terms of size). The learning rate  X  is annealed with a discount factor after each iteration, as suggested by [12].
 Algorithm 1 Stochastic gradient descent learning initialize M y = M s = I , random  X  u and  X  i for t = 1 to T do end for
The absolute-value link function |  X  | is approximated by a smooth variant (  X   X  1 log 2 cosh  X   X  ) with  X  = 100. This approximation avoids non-differentiability in the objective function and aids convergence of the optimization.
We conducted experiments on the Epinion data set. The s ocial relationships in Epinion are dominated by positive ones (over 85% of the edges are positive). Following the settings of [14, 6], we derive a balanced dataset contain-ing equal numbers of positive and negative relations by ran-domly down-sampling the positive edges. Moreover, because Figure 4: Unsupervised sign prediction performance on Epinion. From left to right: random guess, be-havioral correlation based method, the Friendship-Interest Propagation (FIP) model [26], and the pro-posed BRI model. Results are reported with latent dimensionality k = 5, 10 and 50 respectively. the behavioral data in this dataset is extremely skewed (the mean value of the ratings is around 4 . 6), we standardize all the ratings to the range [  X  1 , 1] by applying a transforma-tion: ( y  X  3 . 0) +  X  1 . 0 .

We evaluate the BRI model in terms of its unsupervised sign prediction accuracy. For this purpose, we hide the signs of all the relationships in the training set, i.e., all the edges are treated as  X  X cquaintance X  regardless whether they were originally trust or distrust. For comparison, we also evaluate the following three unsupervised methods: Throughout this paper, all the models are evaluated by using the 1-dimensional prediction scheme Eq(7). In particular, for the output score  X  uv of a model, we predict the sign as  X  s uv = sign(  X  uv  X   X  0 ), where  X  0 is an optimal threshold scalar f ound by line search on validation data.

The prediction accuracy is depicted in Figure 4, where the results of BRI and FIP are reported at latent dimen-sionality k = 5, 10 and 50 respectively. As can be seen from the figure, BRI achieves up to 71% accuracy in this unsu-pervised setting and it significantly outperform all the three baselines. In particular, BRI gains 42% improvement over Random , 21% over Fip and 11% over Correlation . The result is quite promising especially considering that all the signs are hidden in training. It also proves the BRI model is potentially usable in practice for en-signing unsigned so-cial networks, given that we can predict trust/distrust from acquaintance relationships with over 70% accuracy.
One key notion that motivates our work is that we assume the behavioral data should be useful for tie-sign prediction. Figure 5: Top: Unsupervised sign prediction accu-racy as a function of the coloring proportion p = q ; Bottom: the same statistic for the weight for behav-ioral data,  X  Y .
 A s can be seen from Figure 4, using the behavioral data alone, the simple correlation-based predictor achieves the second best performance among all the four models. This observation validates our hypothesis and indicates that be-havioral information is indeed highly predictive for signed social ties. In Figure 5 (b), we further report the accu-racy of BRI as a function of the weight for behavioral data, i.e.,  X  y in Eq(6). As we can see, while the best result is a chieved at a moderate value of  X  y , interestingly, the per-f ormance does not degrade badly if we further increase  X  I n contrast, if  X  y is decreasing toward 0, the performance de-g rades quickly towards that of random prediction  X  in an extreme, BRI trained on unsigned social data alone does not perform substantially better than Random . These observa-tions reveal that, in the unsupervised setting, the behavioral information is even more predictive than the topology of the acquaintance graph.

Note that although the Fip model also leverages the be-havioral data, it is ineffective in sign prediction. Fip esti-mates the unipolar (i.e., in the interval [0, 1]) tie-strength indicating whether two users know each other . Nonetheless, it is incapable to predict whether they trust or distrust each other , i.e. Fip cannot discern the sign of a connection. From another prespective, this comparison between Fip and Bri confirms that the proposed mechanism of automatic sign de-termination is effective for sign prediction.

The performance of the BRI model is affected by the pa-rameters of mixture probabilities, i.e., p and q in Eq(3-5). Model Rand Fip Corr Loo-LR Bri Labels 0 0 0 All -1 0 100 1% 5% 10% 20% 30% 50% 70% 90% In Figure 5, we illustrate how the prediction accuracy of BRI changes with these two parameters, where for simplic-ity p and q are set to the same values. As can be seen from the figure, the accuracy curve is typically in a inverted U-shape with the optimal performance achieved at around 0.2. This observation suggests that both the two groups of factors (i.e. intrinsic taste vs influence, prior impression vs behavior agreement) are important and should be taken into account simultaneously as what we do in the BRI model.
We now consider semi-supervised formulation, where part o f the labels for social ties are observed  X  in practice, these labels could be obtained directly from users through an on-line survey or simply by manual annotations. In particular, assume that in addition to the behavioral observations O y and the acquaintance relations O c , we also have access to a small set of labeled relations (i.e., trust-distrust) on pairs ( u,v )  X  X  s . In this case we add t o the objective function of Eq(6). This formulation has a close connection with the semi-supervised classification model of [2]. It maximizes the fidelity to the target out-put (e.g. s uv ) of the labeled data, while approximating the t arget output for unlabeled data up to an arbitrary sign. A notable distinction is that we are learning latent factor models (e.g., the BRI model) rather than a global feature mapping (i.e., the classifier of the form w  X  x + b i n [2]).
The learning algorithm and prediction formula are similar to the unsupervised case and therefore are omitted.
Table 1 gives the overall results of semi-supervised sign p rediction on Epinion data, where we report the perfor-mance of the BRI model that are trained using progres-sive proportions (1% to 90%) of the labeled data. As a reference, we also report the results obtained by Random guessing, Correlation -based 1-dimensional classifier, the Friendship-Interest Propagation ( Fip ) model of [26] and the leave-one-out logistic regression model (denoted Loo-LR ) of [14].

Our first observation from the table is that the perfor-mance of the BRI model is approaching that of Loo-LR . As we increase the labeled data used for training, we see that the prediction accuracy of the BRI model is steadily improving, indicating that the labeled data can indeed be used to improve the prediction ability of BRI, somewhat as we expected. In particular, with 1% of labeled data, we gain over 3% improvement of accuracy; and if we use over 90% of the labeled data, BRI can achieve comparable per-formance as the leave-one-out prediction of [14] but using far less supervision information compared to the latter.
Interestingly, it seems that the labeled data are not always helpful for BRI. For example, the model trained using 100 (i.e. less than 0.05%) labeled edges does not perform sig-nificantly better (in some cases, even slightly worse) than the unsupervised model. This observation suggests that the amount of the labeled data should exceed a minimum threshold in order for it to take effect. This is quite differ-ent from the traditional semi-supervised learning in which labeled data, whenever available, seems to always help pre-diction. Nonetheless, it is reasonable in our context because we are learning a latent factor model over extremely large user/item spaces  X  the model is almost inevitably overpa-rameterized and with a lot of local optima due to the non-convexity; the labeled data cannot guarantee to drive the model toward a right direction if there is too little of it.
Theories from social psychology [6] provide profound per-s pectives for understanding the formation of signed relations in social networks. According to [15, 14], satisfactory sign prediction accuracy could be obtained by applying social psychology principles. For example, [14] constructed local topology-based features according to status and balance the-ories and employed a logistic regression classifier based on these features to predict the signed relationships. In a leave-one-out setting, their model achieves up to 93% sign predic-tion accuracy on Epinion data. In this section, we extend the basic Bri models to encode social psychological principles, especially the theories of status and structural balance.
The first theory we try to encode is that of s tructural bal-ance [7, 15]. Roughly speaking it implies the intuition that  X  X  friend X  X  friend is a friend X  and that  X  X n enemy X  X  enemy is a friend X . Basically, it considers the balance of signs on a triad involving three users. It states that a triad is balanced if and only if it contains an odd number of positive edges. Balance theory [7, 15]: A triad (u,v,w) is balanced in either of the two cases: (1) if s uv = 1 a nd s uw = 1 , then s vw = 1 ; (2) if s uv =  X  1 a nd s uw =  X  1 , then s vw = 1 . T o encode the balance theory, we introduce an additional (1-dimensional) latent factor  X  u for each user u . Unlike the latent profiles  X  ,  X  is only used to capture the structural balance of the network topology. In particular, we assume an additional component: The social tie is modeled using the following mixture-of-effect model: where q 1 , q 2 , q 3  X  [ 0 , 1] and q 1 + q 2 + q 3 = 1.
T he new mixture component encodes the status theory because it implies: if g uv &gt; 0 and g uw &gt; 0 , then g ( i.e. a friend X  X  friend is a friend); if g uv &lt; 0 and g then g vw &gt; 0 (i.e. an enemy X  X  enemy is a friend). This rank-1 parametrization of structural balance matches the models used in collaborative filtering, albeit with reduced dimensionality. Effectively we are setting aside a subspace of the latent factors exclusively for social interactions.
In the previous sections we implicitly viewed the social n etwork as an undirected graph. Here, we extend the Bri model to encode status theory [6, 15], which was developed for directed networks. That is, from now on, the social ties are viewed as asymmetric relationships. Basically, status theory assumes that there exists a partial order over the user space such that positive edges only goes from low-status nodes to nodes with higher status; therefore, the relation-ships are transitive, i.e., if s uv = +1 and s vw = +1 then s uw = +1, and vice versa.
 S tatus theory [6, 15]: A positive directed link s uv = +1 i ndicates that the head node u has a higher status than the tail node v ; a negative link s uv =  X  1 i ndicates that u has a lower status than v .
 To encode status theory we introduce a global user-independent parameter  X  to capture the partial ordering of users.  X  maps the latent user profile  X  u to a scalar quantity  X  u =  X   X  w hich reflects the corresponding user u  X  X  social status . Ac-cording to status theory, we characterize social ties from u to v by modeling the relative status difference between user u and user v : Note that status theory implies that the social tie is typi-cally an antisymmetric relationship, i.e. if s uv = +1, then s vu =  X  1 . This implication is, however, too strong. For example, in the Epinion case, only 2% of the bi-directional relationships are truly antisymmetric. To relax this assump-tion, we therefore use a mixture of effects model as in the previous section. This yields: Since  X  u , X  v induce a total order on users it satisfies the re-q uirements of social status theory: by transitivity  X  uv a nd  X  vw &gt; 0 imply  X  uw &gt; 0 .
We evaluate the two extended B ri models in the semi-supervised setting and report the results in Tabel 2. As a reference, we also report the performance of the balance model and the status model on its own. As can be seen from the table, by encoding the status theory, we achieve results that are comparable with the leave-one-out predic-tion of [14], but we use far less supervision, i.e. observed tie labels. Also note that encoding the balance theory only leads to very marginal improvements. The latter is to be Table 2: Semi-supervised sign prediction perfor-mance on Epinion. We compare the following mod-els: Structural balance ( Bal ), Status ( Sta ), basic Bri model and combinations of these models, denoted by Bri+Sta and Bri+Bal respectively. %Labels 0% 1% 5% 20% 50% 90% Bal 0.539 0.557 0.582 0.601 0.662 0.735 Sta 0.617 0.719 0.757 0.799 0.824 0.843 Bri 0.709 0.731 0.747 0.818 0.869 0.912 Bri+Bal 0.711 0.734 0.751 0.821 0.870 0.912
Bri+Sta 0.714 0.739 0.763 0.833 0.884 0.925 expected since adding a small subspace to an already ex-isting multiplicative latent factor model will not change the expressive richness of the model significantly.

Among all the methods, the rank-1 balance model per-forms the worst, e.g., in the unsupervised case, it performs even much worse than Fip and the correlation-based ap-proach. Somewhat surprisingly, the plain status model per-form quite satisfactorily. In most cases, the accuracy scores achieved by the status model are very close to those obtained by the basic Bri model. This observation is consistent with the empirical insight reported in [15] that status theory turns to explain the signed relationship better. However, these re-sults do not entirely invalidate the balance theory because we use a rank-1 model that could be too simplistic for any practical network topology.

It is worth noting that the status model provides a sta-tus mapping  X  u =  X   X   X  u that embeds the users into a 1-d imensional space with the coordinates corresponding to users X  social status . In Figure 6, we visualize the Epinion network by randomly sampling 0.1% edges as a bipartite graph based on this embedding. In particular, the upper and lower horizontal lines denote the embedding spaces for head nodes and tail nodes respectively; edges that match the status theory (i.e., s uv = +1 while  X  u &gt;  X  v or s w hile  X  u &lt;  X  v ) are plotted as green lines; in contrast, edges m ismatch the theory are depicted as red lines; to give a clear illustration, negative edges are inverted, i.e., s uv a re replaced by s vu = +1. This figure shows a clear picture a bout social status and signed relations. Over 84% of signed relations, i.e., trust/distrust, are indeed consistent with the theory, going from higher-status head nodes to lower-status tails. Noticeably, while there are confusions, they are mainly in the middle area between users with relatively small dif-ference of social status. Also note that the confusions are becoming increasingly sparse for high-status head users, in-dicating that these users are more likely to be trusted by most other users, which is intuitively reasonable. An in-teresting investigation would be to examine how the social status discovered by this work relates to the well-known con-cept of authority [11] in social networks. We would like to leave such investigation for future research.
A direct motivation of this work was to take advantage o f signed relationships, when available, for behavior predic-tion purposes. The reasonable expectation in this context was that a stronger social signal would allow us to obtain better behavior prediction than what can be achieved via Figure 6: A visualization of social status and signed social ties for s tatus theory are denoted as green lines, or otherwise as red lines. Table 3: Behavior prediction performance on Epin-ion and Yahoo! Pulse: comparison among collabora-tive filtering ( Svd ), the Fip model [26] and our Bri model. Performance is evaluated in terms of rating prediction on Epinion, and top-k ranking on Pulse. Model RMSE MAE AP@5 AR@5 nDCG@5 Svd 0.556 0.387 0.726 0.208 0.734 Fip 0.553 0.386 0.761 0.225 0.767
Bri 0.524 0.350 0.778 0.232 0.785 unipolar Homophily. In this section, we test whether, even in the absence of explicitly available signed social ties, we are able to improve behavior prediction estimates. For this purpose, we compare three models: a plain collaborative fil-tering approach ( Svd ), the Homophily-based model ( Fip ) [26] and the proposed Bri model. We evaluate these mod-els on both Epinion and Yahoo! Pulse data. For Epinion, we evaluate the rating prediction performance in terms of root mean square error (RMSE) and mean absolute error (MAE). For Pulse, because the behavior data is binary (ei-ther 1 or missing), we evaluate the top-k ranking perfor-mance, i.e. we compare the top suggestions of the model with the true actions taken by a user (i.e. whether he liked the item). We use the following three metrics commonly used in the IR community: AP is the average precision . AP@ k averages the precision AR or average recall of the top-k rank list of each query. nDCG or normalized Discounted Cumulative Gain is the In all three metrics we use k = 5 since most social networks use a similar number of items for service recommendation. For the Pulse data, we also implement the bias correction procedure suggested by [26].

The overall results are reported in Table 3. For both data sets we see that the Bri model consistently outperform the two baselines in all the measures. In particular, it improves the RMSE by 5.8% on Epinion, and the nDCG@5 score by 6.9% on Yahoo! Pulse. Note that Bri also significantly out-performs the Fip model. In terms of methodology, both Fip and Bri exploit social relations to improve behavior pre-diction; the difference, however, lies in how they leverage the social relations: Fip models the unsigned tie-strength between users which is then used to reinforce the decision making behavior of connected users; in contrast, Bri mod-els the signed ties , distinguishing those whom we truly trust from those we do not. In this way, although behavior of two connected users is tied to each other, but not necessarily re-inforcing. Bri therefore provides a mechanism that allows social users to follow the opinions from people they trust while at the same time fighting against the viewpoints of their foes. Our results suggest that signed social ties, such as trust-distrust relations, are a substantially more predic-tive signal in tying and regularizing social behavior than Homophily.
We examined the problem of predicting signed social ties, s uch as trust and distrust, based on the acquaintance rela-tionships in social networks. This allows us to determine, with surprising accuracy, whether a link corresponds to a trustworthy friend or rather a frenemy. We present mod-els that infer signed ties by capturing the interplay between social relations and users X  behavior of decision making, and extend the models to encode general principles from social psychology. We investigate sign prediction in both unsu-pervised and semi-supervised settings, conduct experiments in a variety of perspectives and report promising results. We demonstrate that the predicted signed ties are much stronger signals for relating social behavior than traditional Homophily.
 We thank Su-Lin Wu for helpful discussions. Part of this w ork was supported by NSF Grants IIS-1049694 and IIS-1116886, and NSFC grant 61129001/F010403. [1] B. Awerbuch and R. Kleinberg. Competitive [2] K. Bennet and A. Demiriz. Semi-supervised support [3] M. J. Brzozowski, T. Hogg, and G. Szabo. Friends and [4] Y. Chen, D. Pavlov, and J. Canny. Large-scale [5] E. Gilbert and K. Karahalios. Predicting tie strength [6] R. Guha, R. Kumar, P. Raghavan, and A. Tomkins. [7] F. Heider. Attitudes of cognitive organization. Journal [8] T. Joachims. A support vector method for [9] O. Kallenberg. Probabilistic symmetries and [10] T. Kameda, Y. Ohtsubo, and M. Takezawa. Centrality [11] J. M. Kleinberg. Hubs, authorities, and communities. [12] Y. Koren, R. Bell, and C. Volinsky. Matrix [13] J. Kunegis, A. Lommatzsch, and C. Bauckhage. The [14] J. Leskovec, D. Huttenlocher, and J. Kleinberg. [15] J. Leskovec, D. Huttenlocher, and J. Kleinberg. Signed [16] D. Liben-Nowell and J. Kleinberg. The link prediction [17] H. Ma, M. Lyu, and I. King. Learning to recommend [18] P. Massa and P. Avesani. Trust-aware recommender [19] M. Newman. Detecting community structure in [20] M. McPherson, L. S. Lovin, and J. M. Cook. Birds of [21] J. O X  X onovan and B. Smyth. Trust in recommender [22] J. P. Onnela, J. Saram  X  aki, J. Hyv  X  onen, G. Szab  X o, [23] M. Rosvall and C. T. Bergstrom. Maps of random [24] A. J. Smola and R. Kondor. Kernels and regularization [25] L. Xu, J. Neufeld, B. Larson, and D. Schuurmans. [26] S.-H. Yang, B. Long, A. Smola, N. Sadagopan, [27] S.-H. Yang, B. Long, A. Smola, H. Zha, and Z. Zheng.
