 Microblogging platforms have become an important information source for late-breaking news and hot topics[1]. To bring an order to the big and chaotic world of mi-croblogging, users adopt hashtags to mark key points of their messages. However, diffi-culties in providing or selecting appropriate hashtags often force users to give up using them. Researches[2, 3] report that only a few users (much less than 20%) add hashtags actively. In fact, it would be quite helpful to recommend hashtags. Existing recommen-dation methods can be roughly divided into two kinds: content-based methods[2 X 7] and collaborative filtering methods[8]. The for mer techniques achieve success by measur-ing content relevance between a tweet and has htags, while the latter further consider user preference based on collaborative filtering. But, a single microblog is too short to capture the accurate topic semantics and user preference[9]. How to combine effec-tive topic understanding and user prefere nce modeling for hashtag recommendation is a challenging task.
To solve the problems mentioned above, we propose a collaborative hashtag recom-mendation method that leverages 1) global content information for modeling topical semantics of messages (topic relevance model) and 2) users X  preference background from other like-minded users (user preference model). We summarize our contributions as follows. First, we introduce a novel filtering method that integrates topic semantic dependency and hashtag usage preference from users seamlessly. Second, we prove that information integration contributes to content topical discrimination of microblogs and enhances semantic understanding of hashtags. Third, we explore and discuss three kinds of user preference on hashtag selection and adoption. Finally, we verify our model on a real data set collected from microblogging platforms. The experimental results indi-cate that our model significantly improves recommendation precision (MRR is around 96%), and outperforms the state-of-the-art methods.
 The rest of our paper is organized as follows. We discuss related work in Section 2. Section 3 introduces a clear definition of hashtag recommendation task and shows de-tails of the recommendation process based on topic analysis and user preference model-ing. We present experiments and empirical analysis of our models in Section 4. Finally, conclusions are given in Section 5. Many researchers have realized the value an d significance of hashtags, and study how to help users to select hashtags more efficiently (hashtag recommendation). The pro-posed practical strategies can be roughly divided into two categories: content-based methods[2 X 7] and collaborative filtering methods[8]. Content-based methods take dif-ferent techniques to build semantic bridges between hashtags and messages, such as the TFIDF scheme[2], Bayes rules[3], WordNet similarity information with the Eu-clidean distance metric[4] and topic translation methods[5 X 7]. Collaborative filtering mechanism is a traditional technique for r ecommending[10], where Kywe[8] combines hashtags of similar users and similar messages to propose a more personalized set of tags to meet both user preference and content information.

Currently, content analysis approaches are dominant strategies for this problem. But short and unconstrained texts suffer from sparseness of co-occurrence words. For man-made hashtags, user preference is one of th e decisive factors for message description. Drawing on the experience of predecessors, we take advantages of both local (the current microblog content and the user) and global (hashtag-related content and like-minded users X  usage preference) information. In this section, we introduce our recommendation strategy in details. 3.1 A Framework of Our Hashtag Recommendation Model terms and hashtags that have appeared in datasets separately. A common microblog d posted by user u contains a set of hashtags h d . We represent a post d as a  X  X ag of words X  with term frequency d = { n d , i } v i = 1 . The task of hashtag recommendation is to output a set of semantic related hashtags H rec according to a specific microblog d postedbya specific user u . The framework of our model is shown in Fig. 1.

For a given microblog, recommendation is based on two kinds of off-line processed profiles: hashtag profiles (constructed by using content of all previous messages con-taining a specific hashtag) and user profiles (constructed for each user, including all messages a specific user has posted). The computation framework of recommendation follows the steps below. Firstly, we get hashtag candidates based on topic analysis be-tween hashtag profiles and the current microblog ( 1 -, details in Section 3.2). Secondly, we get hashtag candidates according to user p reference and collaborative filtering tech-niques ( 2 -, details in Section 3.3). Thirdly, we recommend hashtags from two candidate sets by a hybrid function ( 3 -, details in Section 3.4). Finally, we return the top-K results to users ( 4 -). 3.2 Topic Semantic Modeling A hashtag shows us topic information in messages, thus it X  X  vital to model topic se-mantic relevance between a post and hashtags when recommending. Due to short and casual texts, we notice that modeling topic relevance information from a single post probably captures weak semantic description, not the topic representation. In fact, ag-gregated messages give us more accurate and comprehensive topic illustration of high quality[9, 11]. So we collect all microblogs containing a specific hashtag h together as profile. So, each hashtag is a distribution v ector over terms from related messages. Dif-ferent distributions re flect different topic semantic info rmation of hashtags. The accu-mulative representation for each hashtag mak es themes more clearly, enhances semantic signal and decreases the risk of concept or key point drift.

Hence, we measure semantic relevancy sco re by using the cosine similarity between the input message d and the hashtag profile D h : In the aspect of content, we get hashtag candidates with semantic relevancy scores. Each hashtag X  X  profile can be constructed independently, so it X  X  easy to be implemented in parallel and processed in linear time. 3.3 User Preference Modeling User preference shows personal character istics when selecting and adopting hashtags. Users X  historical behaviors reflect degree of their interests. In this part, we focus on se-lecting hashtags based on user profiles under an improved collaborative filtering scheme. Due to the concept of user interest groups, we mine near neighbors for discovering a specific user X  X  hashtag preference.

We construct each user profile with one X  X  historical microblogs. And then we take three user interest description matrices M for user representation, where each row m i represents the interest vector of user i . M CT , M HT , M TK are a content representation matrix, a hashtag representation matrix and a topic representation matrix respectively, distribution of topic i for user u based on information in user profiles respectively. The topic distribution is trained by a famous topic model called Latent Dirichlet Allocation (LDA)[12] with words in user u  X  X  profile. For lack of sp ace, topic model parameter estimation method is not stated here (see more detailed derivation in [13]).
With user interest description matrices mentioned above, we can easily apply a com-mon measurement to find like-minded users. Here we calculate user pair-wise similarity by using the cosine value between their representation vectors:
We further represent relationships between users and hashtags under one extension of collaborative filtering schema to find hashtags that are right up their alley. The pref-erence for hashtags with users X  intere st group considered is represented as p ( h | u ) : that are used by user u , n u , h is frequency of hashtag h used by user u , n u is average hashtag usage times of user u . Until now, we complete predicting user preference on hashtags, and get a set of hashtag candidates with user preference degree. 3.4 Fusion Strategy of Topic Relevance and User Preference As the methods mentioned above, we have already achieved content topic relevance via topic semantic analysis, denoted as p ( h | d ) , and user preference via considering user interest groups, denoted as p ( h | u ) . The two scores are both probability value between 0 and 1. The higher the value is, the more relevance the message and hashtag are.
We apply a linear combination between sema ntic relations and user preference re-lations, marked as  X  F unction-based H ybrid M odel X . For a specific post written by a specific user, the score for a hashtag h is: where  X  is a balance factor for two parts. It repr esents how great content information has impact on the final score. So far, the hybrid model integrates topic bias of content and user preference, which is more suitable and feasible for users to adopt the recom-mendation. 4.1 Data Collection Our data is drawn from a large snapshot of microblogs generated from August 26th, 2009 to February 9th, 2012 by Chinese users in Sina-Weibo ( http://weibo.com ). After removing microblogs with no hashtags, we get 21,992 posts, 2,179 relevant users and 3,762 distinct hashtags. The average length of one post is 30.34.
 We divide our data set into a training set (21,742 posts) and a testing set (250 posts). The training set is used for constructing user profiles and hashtag profiles. For evalua-tion, we randomly sample 250 original microblogs as our testing set, posted by 23 users, marked with 106 distinct hashtags, containing 53.48 available characters on average. 4.2 Evaluation Metrics and Comparison Models For each microblog, we consider the rate of accurate recommendation and position related evaluation metrics. We choose Precision , Top-k Accuracy , At-k Accuracy and MRR to measure the performance of our model. In the testing microblogs, the hashtags actually used by users serve as our ground truth.

Precision is a positive predictive value, percentage of correctly hashtags among all hashtags recommended by the model. Top-k Accuracy is percentage of microblogs correctly marked by at least one of the top k hashtags in the recommended list. At-k Accuracy is percentage of microblogs correctly marked by the k th hashtags in the rec-ommended list. MRR stands for Mean Reciprocal Rank. The reciprocal rank of a post response is the multiplicative inverse of the rank of the first correct hashtag. The Mean Reciprocal Rank is the average reciprocal rank of all microblogs in testing sets.
In the following sections, we abbreviate our model  X  F unction-based H ybrid M odel X  to FHM . We compare FHM with two state-of-the-art hashtag recommendation mod-els ( C ontent-based C ollaborative F iltering[2] ( CCF )and M ajority V ote-based H ybrid M odel[8] ( MVHM )) and one classical U ser-based C ollaborative F iltering model ( UCF ) on the same microblogs collection. Here, MVHM is a hybrid model. 4.3 Experimental Results We firstly compare FHM with three other recommendation models, and then go through two major components of the model, recommendation based on topic semantic and recommendation based on user preference, respectively.
 (1) Personalized Hashta g Recommendation Model For each model, we find optimal parameters by the way of grid search. In CCF, we take TFIDF hashtag profiles to describe hashtags, use M HT as the user interest description matrix, and choose 1-nearest neighbor for calculating user hashtag preference. We set balance factor  X  as 0.5, which allows us to best leverage topic semantic relevance and user preference. For MVHM, we set the number of nearest neighbors as 1 and the number of similar microblogs as 10.

The MRR of four models is shown in the Table 1. From Table 1, We can draw the fol-lowing conclusions. (1) Both hybrid models, MVHM and FHM, outperform the single component models CCF and UCF respectively. (2) Our model with aggregated hash-tag topic semantic modeling and user near neighbor relevancy modeling achieves the best performance. Fig. 2 depicts performance of four methods on three position-related evaluation metrics at position from 1 to 10. It obviously shows that our model has more notable advantages at the top of the recomme ndation list and achieves the highest accu-racy at position 1. (2) Hashtag Recommendation Based on Topic Semantic In this part, we discuss two weighing ways of describing profiles (TF and TFIDF) and two ways of constructing hashtag profiles (MB and HtPro). Here, MB denotes tak-ing a single microblog as its hashtag profile just like [2] does. While, HtPro denotes using all historical microblogs containing the same hashtag as profiles as Section 3.2 describes. We suggest hashtags by their Cosine relevance scores to get the recommen-dation list. According to different representation methods (TF, TFIDF) and different similarity metrics (MB, HtPro), we get four content-based recommendation methods. Meanwhile, our method is TFIDF HtPro, and CCF[2] can be denoted as TFIDF MB. The results are shown in Table 2.
From Table 2, we have following observations. (1) TFIDF representation models outperform the TF representation models. (2) HtPro models further improve the per-formance of MB models. (3) Our TFIDF HtPro model can successfully boost other semantic analysis methods, with a MRR of 65.77%. (3) Hashtag Recommendation Based on User Preference In this part, we evaluate how different use r representation matrices fulfil the task of hashtag recommendation. We determine near neighbors by three user information ma-trices: content representation matrix ( CT ), hashtag representation matrix ( HT )and topic representation matrix ( TK ). The results are shown in Fig. 3. As Fig. 3 shows, information from the nearest neighbors has contributed to hashtag recommendation. We have got the highest MRR when considering the nearest neighbor. The position of the first accurate recommendation moves b ackwards as the number of nearest neighbor increases. Especially, content description shows a preference bias for this task. As to topic interest representation, we can get a better MRR when latent number of topics is 50 or 400.
 This paper studies how to recommend appropriate hashtags for a specific microblog written by a specific user. The recommend strategy characterizes topic semantic by global content information and considers usage preference by the local user interest group. Besides, our fusion model (named FHM) can seamlessly associate these two factors for recommending. The results demonstrate that our proposed method outper-forms the state-of-the-art approaches with a large margin.

Our work can directly provide at least two benefits. For microbloggers, it helps them to join topic discussion, to promote interaction activities and to make microblogs eas-ier to retrieve. For researchers, credible complementary hasht ags for microblogs can promote researches in social media, such as topic detection and tracking, text classifi-cation, community detection and etc. Under our framework, we will further introduce explicit social relations for users X  interest group modeling and explore generative topic modeling techniques for modeling relevance between a short message and hashtags. Acknowledgments. This research is supported by the National Natural Science Foun-dation of China (No. 61105049 and No. 61300166), Open Project Foundation of In-formation Technology Research Base of Civil Aviation Administration of China (No. CAAC-ITRB-201303 and No. CAAC-ITRB-201204), Science and Technology Plan-ning Project of Tianjin, China (No. 13ZCZDGX01098) and Tianjin Research Program of Application Foundation and Advanced Technology (No. 14JCQNJC00600).

