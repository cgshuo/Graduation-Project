 We study the extent to which the formation of a two-way relation-ship can be predicted in a dynamic social network. A two-way (called reciprocal) relationship, usually developed from a one-way (parasocial) relationship, represents a more trustful relationship be-tween people. Understanding the formation of two-way relation-ships can provide us insights into the micro-level dynamics of the social network, such as what is the underlying community structure and how users influence each other.

Employing Twitter as a source for our experimental data, we propose a learning framework to formulate the problem of recipro-cal relationship prediction into a graphical model. The framework incorporates social theories into a machine learning model. We demonstrate that it is possible to accurately infer 90% of reciprocal relationships in a dynamic network. Our study provides strong ev-idence of the existence of the structural balance among reciprocal relationships. In addition, we have some interesting findings, e.g., the likelihood of two  X  X lite X  users creating a reciprocal relation-ships is nearly 8 times higher than the likelihood of two ordinary users. More importantly, our findings have potential implications such as how social structures can be inferred from individuals X  be-haviors.
 H.2.8 [ Database Management ]: Data Mining; J.4 [ Social and Behavioral Sciences ]: Miscellaneous; H.4.m [ Information Sys-tems ]: Miscellaneous Algorithms, Experimentation social network, reciprocal relationship, social influence, predictive model, link prediction, Twitter
Authors are in alphabetic order. The work were done when the last two authors were visiting Cornell University.

Online social networks (e.g., Twitter, Facebook, Myspace) sig-nificantly enlarge our social circles. One can follow any elites (celebrities), e.g., politicians, models, actors, and athletes, or close friends in her physical social network. An interesting question here is: when you follow a number of users, who will follow you back? A more specific question is: if you follow those celebrities (elite users) on Twitter, do you think they will follow you back? The answer is often No, but also Yes sometimes. There are a number of top users with tens of thousands of followers, who will follow everyone back. Some even use tools to do follow-back automati-cally, while others go through the following list and add their new followers manually. 1 Awareness of how these relationships are cre-ated can benefit many applications such as friend suggestion, com-munity detection, and  X  X ord-of-mouth X  product promotion.
In social science, relationships between individuals are classified into two categories: one-way (called parasocial) relationships and two-way (called reciprocal) relationships [9]. The most common form of the former are one-way relationships between celebrities and audience or fans, while the most common form of the lat-ter are two-way relationships between close friends. Twitter and Facebook are respectively typical examples of the two types of so-cial relationships. Social relationships form the basis of the social structure. Indeed, social relationships are always the basic object of analysis for social scientists, for instance, in Max Weber X  X  theory of social action [29]. Understanding the formation of social rela-tionships can give us insights into the micro-level dynamics of the social network, such as how an individual user influences her/his friends through different types of social relationships [26], and how the underlying social structure changes with the dynamics of rela-tionship formation [23].

Employing Twitter as the basis of our analysis, we study how a two-way (reciprocal) relationship has been developed from a one-way (parasocial) relationship. Specifically, we try to answer:  X  X hen you follow a particular user (either an elite user or an ordi-nary user), how likely will she/he follow you back? X . This problem also implicitly exists in other social networks such as Facebook and LinkedIn: when you send a friend request to somebody, how likely will she/he confirm your request?
Previous research on social relationships can be classified into three categories: link prediction [2, 16, 17, 23], relationship type inferring [4, 5, 27], and social behavior prediction [1, 25, 33]. Backstrom and Leskovec [2] proposed an approach called super-vised random walks to predict and recommend links in social net-works. Crandall et al. [4] investigated the problem of inferring social ties between people from co-occurrence in time and space. http://socialnewswatch.com/top-twitter-users/ Wang et al. [27] proposed an unsupervised algorithm to infer advisor-advisee relationships from a publication network. How-ever, little research systematically studies how two-way relation-ships can be developed from one-way relationships. More funda-mentally, what are the underlying factors that essentially influence the formation of two-way relationships? and how existing social theories (e.g., structural balance theory and homophily) can be con-nected to the formation process?
In this paper, we try to conduct a systematic investigation on the problem of two-way (reciprocal) relationship prediction. We pre-cisely define the problem and propose a Triad Factor Graph (TriFG) model. The TriFG model incorporates social theories into a semi-supervised learning model, where we have some labeled training data (two-way relationships) but with low reciprocity [13]. Given a historic log of users X  following actions from time 0 to t ,wetryto learn a predictive model to infer whether user A will add a follow-back link to user B at time ( t +1) if user B creates a new follow link to user A at time t . We evaluate the proposed model on a Twitter data consisting of 13,442,659 users and their profiles, tweets, fol-lowing behaviors (new following or follow-back links) for nearly two months.
 Results We show that incorporating social theories into the pro-posed factor graph model can significantly improve the perfor-mance (+22%-+27% by F1-Measure) of two-way (reciprocal) re-lationship prediction compared with several alternative methods. Our study also reveals several interesting phenomena: 1. Elite users tend to follow each other. The likelihood of an 2. Two-way relationships on Twitter are balanced, but one-way 3. Social networks are going global, but also stay local. No mat-Organization Section 2 formulates the problem. Section 3 in-troduces the data set and our analyses on the data set. Section 4 explains the proposed model and describes the algorithm for learn-ing the model. Section 5 presents experimental results that validate the effectiveness of our methodology. Finally, Section 6 reviews the related work and Section 7 concludes this work.
In this section, after presenting several definitions, we formally define the targeted problem in this work. We formulate the problem in the context of Twitter to keep things concrete, though adaptation of this framework to other social-network settings is straightfor-ward.

The Twitter network can be modeled as a directed graph G = {
V,E } ,where V = { v 1 ,v 2 ,...,v n } is the set of users, and E V  X  V is the set of directed links between users. Each directed link e ij =( v i ,v j )  X  E indicates that user v i follows user v
The Twitter network is dynamic in nature, with links added and removed from over time. However, our preliminary statistics on a large Twitter data set show that users tend to add new links much more frequently than to remove existing links (e.g., 97% of changes to links are adding new links). Therefore, adding new links forms the structure of the Twitter network. A new link results when a user performs a behavior of following another user (back) in Twitter. Particularly, we define two types of the link behavior:
Definition 1. New-follow and Follow-back: Suppose at time t , user v i creates a link to v j , who has no previous link to v say v i performs a new-follow behavior on v j .Whenuser v a link to v j at time t , who already has a link to v i before time t ,we say v i performs a follow-back behavior on v j .

The new-follow and follow-back behaviors respectively corre-spond to the one-way (parasocial) relationship and the two-way (reciprocal) relationship in sociology. In this work, we focus on investigating the formation of follow-back behaviors. For simplic-ity, let y t ij =1 denote that user v i follows back v j at time t and y ij =0 denote user v i does not follow back. We are concerned with the following prediction problem:
Problem 1. Follow-back prediction. Let &lt; 1 ,...,t &gt; be a sequence of time stamps with a particular time granularity (e.g., day, week etc.). Given Twitter networks from time 1 to t , ( V t ,E t ,Y t ) } ,where Y t is the set of follow-back behaviors at time t , the task is to find a predictive function: such that we can infer the follow-back behaviors at time ( t +1) .
It bears pointing out that our problem is very different from exist-ing link prediction [2, 17, 23] and social action prediction problems [25, 33]. First, as the twitter network is evolving over time, it is in-feasible to collect a complete network at time t . Thus it is important to design a method that could take into consideration the unlabeled data as well. Second, it is unclear what are the fundamental fac-tors that cause the formation of follow-back relationships. Finally, one needs to incorporate the different factors (e.g., social theories, statistics, and our intuitions) into a unified model to better predict the follow-back relationship.
We aim to find a large set of users and a continuously updated network among these users, so that we can use the data set as the gold-standard to evaluate different approaches for our predic-tion. To begin the collection process, we selected the most popular user on Twitter, i.e.,  X  X ady Gaga X , and randomly collected 10,000 of her followers. We took these users as seed users and used a crawler to collect all followers of these users by traversing follow-ing edges. We continue the traversing process, which produced in total 13,442,659 users and 56,893,234 following links, with an av-erage of 728,509 new links per day. The crawler monitored the change of the network structure from 10/12/2010 to 12/23/2010. We also extracted all tweets posted by these users and in total there are 35,746,366 tweets.

In our analysis, we also consider the geographic location of each user. Specifically, we first extracted the location from the profile of each user 2 , and then fed the location information to the Google Map API to fetch its corresponding longitude and latitude values. In this For example, Lady Gaga X  X  location information is:  X  X ocation: New York, NY X . Figure 1: Geographic distance correlation. X-axis: time zone way, we obtained the longitude and latitude of about 59% of users in our data set. More detailed analysis and an online demonstration is publicly available. http://arnetminer.org/reciprocal/
We first engage in some high-level investigation of how different factors influence the formation of follow-back (reciprocal) relation-ships, since a major motivation of our work is to find the underly-ing factors and their influence to this task. In particular, we study the interplay of the following factors with the formation of follow-backs: (1) Geographic distance: Do users have a higher probability to follow each other when they are located in the same region? (2) Homophily: Do similar users tend to follow each other? (3) Implicit network: How does the following network on Twitter correlate with other implicit networks, e.g., retweet and reply network? and (4) Social balance: Does the two-way relationship network on Twitter satisfy the social balance theory [6]? To which extent? Geographic distance Figure 1 shows the correlation between geo-graphic distance and the probability that two users create a two-way relationship (i.e., follow back each other). Interestingly, it seems that online social networks indeed go global: Figure 1(b) shows the likelihood of a user following another user back when they are from the same time zone or from different time zones. Clearly, the geographic distance is already not a factor to stop users from devel-oping a trustful (reciprocal) relationship. Figure 1(a) shows another statistic which indicates a different perspective that the Twitter net-work (in some sense) still stays local: the average number of two-way (reciprocal) relationships between users from the same time zone is about 50 times higher than the number between users with a distance of three time zones.
 Homophily The principle of homophily [15] suggests that users with similar characteristics (e.g., social status, age) tend to asso-ciate with each other. In particular, we study two kinds of ho-mophilies on the Twitter network: link homophily and status ho-mophily. For the link homophily, we test whether users who share common links (followers or followees) will have a tendency to as-sociate with each other. Figure 2 clearly shows that the probability of two users following back each other when they share common neighbors is much higher than usual. When the number of common neighbors with two way relationships increases to 3, the likelihood of two users following back each other also triples. The effect is more pronounced when the number increases to 10. But it is worth noting that this only works for two-way (reciprocal) relationships Figure 2: Link homophily. Y-axis: probability that two users follow and does not hold for the one-way (parasocial) relationship (as in-dicated in Figure 2).

For the status homophily, we test whether two users with simi-lar social status are more likely to associate with each other. We categorize users into two groups (elite users and ordinary users) by three different algorithms: PageRank [22] 3 , #degree, and (  X ,  X  ) algorithm [8] 4 . Specifically, with PageRank, we estimate the im-portance of each user according to the network structure, and then select as elite users with the top 1% users 5 who have the highest PageRank scores and the rest as ordinary users; while with #de-gree, we select top 1% users with the highest number of indegree as elite users and the rest as ordinary users. For (  X ,  X  ) , we input the size of the core community as 200 , and after running the algorithm, we use users selected in the core community as elite users and the rest as ordinary users. Then, we examine the difference of follow back behaviors among the two groups of users. Figure 3 clearly shows that, though the three algorithms present different statistics,  X  X lite X  users have a much stronger tendency to follow each other: the likelihood of two elite users following back each other is nearly 8 times higher than that of ordinary users (by the (  X ,  X  ) algorithm). The (  X ,  X  ) algorithm seems able to better distinguish elite users from ordinary users in our problem setting. This is because besides the global network structure, the (  X ,  X  ) algorithm also considers the community structure among elite users.
 Implicit structure On Twitter, besides the explicit network with following links, there are also some implicit network structure that can be induced from the textural information. For example, user A may mention user B in her tweet, i.e.  X  X  B  X , which is called a reply link; user A may forward user B  X  X  tweet, which results in a retweet link. We study how the implicit links correlate with the formation of the follow-back relationship on Twitter. Figure 4 clearly shows that when users A and B retweet or reply each other X  X  tweet, the likelihood of their following back each other is higher (3 times than chance). Another interesting phenomenon is that compared with replying someone X  X  tweet, retweeting (forwarding) her tweet seems to be more helpful (15% vs. 9%) to win her follow-back. Structural balance Now, we connect our work to a basic social psychological theory: structural balance theory [6]. Let us first ex-plain the structural balance property. For every group of three users
PageRank is an algorithm to estimate the importance of each node in a network.  X ,  X  ) algorithm is designed to find core members (elite users) in a social network.
Statistics have shown that less than 1% of the Twitter users pro-duce 50% of its content [31]. Figure 3: Status homophily by different algorithms. Y-axis: Figure 4: Implicit network correlation. Y-axis: probability that (called triad), the balance property implies that either all three of these users are friends or only one pair of them are friends. Fig-ure 5 shows such an example. To adapt the theory to our problem, we can map either the two-way relationship or the one-way rela-tionship on the friendship. Then we examine how the Twitter net-work with (only two-way relationships or one-way relationships) satisfy the structural balance property. More precisely, we compare the probabilities of the resultant triads that satisfy the balance the-ory based on two-way relationships and one-way relationships on Twitter. Figure 6 clearly shows that it is much more likely (88%) for users to be connected with a balanced structure of two-way rela-tionships. While with one-way relationships, the resultant structure is very unbalanced. This is because two users are very likely to fol-low a same movie star, but they do not know each other, which results in a unbalanced triad (Figure 5 (C)).

In summary, according to the statistics above, we have the fol-lowing observations: 1. Geographic distance has a pronounced effect on the number 2. Users with common friends of two-way relationships have a 3. Elite users have a much stronger tendency (status homophily) 4. The implicit networks of retweet or reply links have a strong Figure 5: Illustration of structural balance theory. (A) and (B) Figure 6: Structural balance correlation. Y-axis: probability 5. The network of two-way relationships on Twitter is balanced
In this section, we propose a novel Triad Factor Graph (TriFG) model to incorporate all the information within a single entity for better modeling and predicting the formation of two-way (follow-back) relationships.

For an edge e ij  X  E ,ifuser v j follows v i at time t , our task is to predict whether user v i will follow v j back, i.e. y ij For easy explanation, We introduce a slight change of notation. We write each edge as e i with its two end users as v s i and v follow-back prediction task, we assume that v s i follows v t , and our task is to predict whether v u i will follow v ( t +1) . Based on the observations in  X 3, we define a number of attributes for each edge, denoted as x i .The | E | X  d attribute matrix X describes edge-specific characteristics, where d is the number of attributes. For example, on Twitter, an attribute can be defined as whether two end users are from the same time zone. An element x ij in the matrix X indicates the j th attribute value of edge e
We propose a Triad Factor Graph (TriFG) model. The name is derived from the idea that we incorporate social theories (structural balance and homophily) over triads into the factor graph model.
Figure 7 shows the graphical structure of the TriFG model. The left figure shows the following network of six users at time t . Blue arrows indicate new follow actions, black arrows indicate follow actions performed before time t , and blue indicates user v not follow user v s i back at time t . The right figure is the factor graph model derived from the left input network. Each gray eclipse indi-cates an relationship ( v u i ,v s i ) between users and each white circle indicates the hidden variable y i , with y i =1 representing v u forms a follow-back action, y i =0 not, and y i =? unknown, which actually is the variable we need to predict. Factor h ( . ) represents Figure 7: Graphical representation of the TriFG model. The left a balance factor function defined on a triad; and f ( v s f ( x i ,y i ) ) represents a factor to capture the information associated with edge e i .

Given a network at time t , i.e., G t =( V t ,E t ,X t ) with some known variables y =1 or 0 and some unknown variables y =? , our goal is to infer values of those unknown variables. For simplicity, we remove the superscript t for all variables if there is no ambiguity. We begin with the posterior probability of P ( Y | X ,G ) , according to the Bayes X  theorem, we have P ( Y | X ,G )= P ( where P ( Y | G ) denotes the probability of labels given the structure of the network and P ( X | Y ) denotes the probability of generating the attributes X associated with each edge given their label Y .As-suming that the generative probability of attributes given the label of each edge is conditionally independent, we get where P ( x i | y i ) is the probability of generating attributes the label y i . Now, the problem is how to instantiate the probabilities P ( Y | G ) and P ( x i | y i ) . In principle, they can be instantiated in different ways. In this work, we model them in a Markov random field, and thus by the Hammersley-Clifford theorem [7], the two probabilities can be instantiated as: where Z 1 and Z 2 are normalization factors. Eq. 3 indicates that we define a feature function f j ( x ij ,y i ) for each attribute x ciated with edge e i and  X  j is the weight of the j th attribute; while Eq. 4 represents that we define a set of correlation feature functions { h k ( Y c ) } k over each triad Y c in the network. Here  X  k of the k th correlation feature function.

Based on Eqs. 2-4, we define the following log-likelihood objec-tive function O (  X  )=log P  X  ( Y | X ,G ) :
O (  X  )= where Y c is a triad derived from the input network, Z = Z a normalization factor and  X  =( {  X  } , {  X  } ) indicates a parameter configuration. One example of factor decomposition is shown in Figure 7. There are six edges, three with known variables (two y =1 and one y =0 ) and three with unknown values ( y =? ). We have four triads (e.g., Y c =( y 1 ,y 2 ,y 3 ) ) based on the structure of the input network. For each edge, we define a set of factor functions f ( v s i ,v u i ,y i ) (also written as f ( x i ,y i ) ).
We now briefly introduce possible ways to define the factor func-tions f j ( x ij ,y i ) and h k ( Y c ) . f j ( x ij ,y i tion. It can be defined as either a binary function or a real-valued function. For example, for the implicit network feature, we simply define it as a binary feature, that is if user v s i forwarded (retweeted) v  X  X  tweet before time t and user v u i follows user v s i back, then a feature f j ( x ij =1 ,y i =1) is defined and its value is 1; other-wise 0. (Such a feature definition is often used in graphical mod-els such as Conditional Random Fields [14]. For the triad factor function h ( Y c ) , we define four features, two balanced and two un-balanced factor functions, as depicted in Figure 5. The triad func-tion is defined as a binary function, that is, if a triad satisfies the structural balance property, then the value of a corresponding triad factor function is 1, otherwise 0. More details of the factor function definition are given in Appendix.
We now address the problem of estimating the free param-eters and inferring users X  follow-back behaviors. Learning the TriFG model is to estimate a parameter configuration  X  = ( {  X  } , {  X  } ) to maximize the log-likelihood objective function O (  X  )=log P  X  ( Y | X ,G ) , i.e.,
To solve the objective function, we adopt a gradient decent method (or a Newton-Raphson method). We use  X  as the exam-ple to explain how we learn the parameters. Specifically, we first write the gradient of each  X  k with regard to the objective function (Eq. 5): where E [ h k ( Y c )] is the expectation of factor function h the data distribution (essentially it can be considered as the average value of the factor function h k ( Y c ) over all triads in the training tion h k ( Y c ) under the distribution P  X  k ( Y c | X ,G ) givenbythees-timated model. A similar gradient can be derived for parameter  X  .
 One challenge here is that the graphical structure in the TriFG model can be arbitrary and may contain cycles, which makes it intractable to directly calculate the marginal distribution P  X  k ( Y c | X ,G ) . A number of approximate algorithms can be con-sidered, such as Loopy Belief Propagation (LBP) [20] and Mean-field [32]. We chose Loopy Belief Propagation due to its ease of im-plementation and effectiveness. Specifically, we approximate the marginal distribution P  X  k ( Y c | X ,G ) using LBP. With the marginal probabilities, the gradient can be obtained by summing over all tri-ads. It is worth noting that we need to perform the LBP process twice in each iteration, one time for estimating the marginal distri-bution of unknown variables y i =? and the other time for marginal distribution over all triads. Finally with the gradient, we update each parameter with a learning rate  X  . The learning algorithm is summarized in Algorithm 1.
 Predicting Follow-back With the estimated parameters  X  ,we can predict the label of unknown variables { y i =? } by finding a label configuration which maximizes the objective function, i.e., Y  X  =argmax O ( Y | X ,G, X  ) . It is still intractable to obtain the exact solution. Again, we utilize the loopy belief propagation to approximate the solution, i.e., to calculate the marginal distribution of each relationship with unknown variable P ( y i | x i ,G ) and finally assign each relationship with label of the maximal probability.
In this section, we first describe our experimental setup. We then present the performance results for different approaches in differ-ent settings. Next, we present several analyses and discussions. Finally, we use a case study further to demonstrate the advantage of the proposed model. Prediction Setting We use the data set described in  X 3 in our ex-periments. To quantitatively evaluate the effectiveness of the pro-posed model and compare with other alternative methods, we care-fully select a sub network from the data set, which has a completely historic log of link formation among all users, i.e., each user is as-sociated with a complete list of followers and users they are follow-ing at each time stamp. The sub network is comprised of 112,044 users, 468,238 following links among them, and 2,409,768 tweets. Averagely there are 3,337 new follow-back links per day. We di-vide the sub network into 13 time stamps by viewing every four days as a time stamp.

Our general task is to predict whether a user will follow another user back at the next time stamp when she received a new follow-ing link from the other user. By a more careful study however, we
Figure 8: Follow-back probability for different time stamps. found that it is very challenging if we restrict the prediction just for the next time stamp. Figure 8 shows the distribution of time span in which a user performs the follow-back action, which in-dicates that 60% of follow-backs are performed in the next time stamp though, 37% of the follow-backs would be still performed in the following three time stamps. A further data analysis, shows that active users often either perform an immediate follow-back (at the next time stamp) or reject to follow-back; while some other (in-active) users may not frequently login into Twitter, thus the time span of follow-backs varies a lot. According to this observation, in our first experiment, we use a network of the first 8 time stamps for training and predicate follow-back actions in the following 4 (9th-12th) time stamps (Test Case 1). Then we incrementally add the network of the 9th time stamp into the training data and again use the following 4 (10th-13th) time stamps for prediction (Test Case 2). We respectively report the prediction performance of different approaches for the two test cases.
 Comparison Methods We compare the proposed TriFG model with the following methods:
SVM: it uses the same attributes associated with each edge as features to train a classification model and then employs the clas-sification model to predict edges X  label in the test data. For SVM, we employ SVM-light.

LRC: it uses the same attributes associated with each edge as features to train to train a logistic regression classification model [16] and then predict edges X  label in the test data.

CRF-balance: it trains a Conditional Random Field [14] model with attributes associated with each edge. The difference of this method from our model is that it does not consider structural bal-ance factors.

CRF: it trains a Conditional Random Field model all factors (including attributes and structural balance factors) and predicts edges X  label in the test data.

TriFG: the proposed model, which trains a factor graph model with unlabeled data and all factors we defined in  X 4.

Weak TriFG (wTriFG): the difference of wTriFG from TriFG is that we do not consider status homophily and structural balance here. We use this method to evaluate how social theories can help this task.

In the five methods, SVM and CRF-balance only considers at-tribute factors; wTriFG further considers unlabeled data. CRF con-siders all factors we defined, but does not consider unlabeled data. Our proposed TriFG model considers all factors as well as the un-labeled data.
 Evaluation Measures We evaluate the performance of different approaches in terms of Precision (Prec.), Recall (Rec.), F1-Measure (F1), and Accuracy (Accu.). Table 1: Follow-back prediction performance of different methods in the two test cases. Test Case 1: predicting follow-back Table 2: Follow-back prediction performance of TriFG with three different algorithms (#degree, PageRank and (  X ,  X  ) )for finding elite users from ordinary users.

All algorithms are implemented in C++, and all experiments are performed on a PC running Windows 7 with Intel(R) Core(TM) 2 CPU 6600 (2.4GHz and 2.39GHz) and 4GB memory. All algo-rithms have a good efficiency performance: the CPU time needed for training and prediction by all methods on the Twitter network ranges from 2 to 5 minutes.
We now describe the performance results for the different meth-ods we considered. Table 1 show the results in the two test cases (prediction performance for the 9th-12th time stamps and that for the 10th-13th time stamps).

It can be clearly seen that our proposed TriFG model signif-icantly outperforms the four comparison methods. In terms of F1-Measure, TriFG achieves a +27% improvement compared with the (SVM). Comparing with the other three graph-based methods, TriFG also results in an improvement of 22-25%. The advantage of TriFG mainly comes from the improvement on recall. One im-portant reason here is that TriFG can detect some difficult cases by leveraging the structural balance correlation and homophily corre-lation. For example, without considering the two kinds of social correlations, the performance of wTriFG decreases to 70-72% in terms of F1-Measure in the two test cases. Another advantage of TriFG is that it makes use of the unlabeled data. Essentially, it fur-ther considers some latent correlation in the data set, which cannot be leveraged with only the labeled training data. Now, we perform several analyses to examine the following as-Figure 9: Factor contribution analysis. TriFG-B stands for ig-pects of the TriFG model: (1) contribution of different factors in the TriFG model; (2) convergence property of the learning algorithm; (3) Effect of different settings for the time span; and (4) Effect of different algorithms for elite user finding.
 Factor Contribution Analysis In TriFG, we consider five differ-ent factor functions: Geographic distance (G), Link homophily (L), Status homophily (S), Implicit network correlation (I), and struc-tural Balance correlation (B). Here we examine the contribution of the different factors defined in our model. We first rank the indi-vidual factors by their predictive power 6 , then remove them one by one in reversing order of their prediction power. In particular, we first remove structural balance correlation denoted as TriFG-B, followed by further removing the implicit network correlation de-noted as TriFG-BI, status homophily denoted as TriFG-BIS, and finally removing link homophily denoted as TriFG-BISL. We train and evaluate the prediction performance of the different versions of TriFG. Figure shows the average F1-Measure score of the dif-ferent versions of the TriFG model. We can observe clear drop on the performance when ignoring each of the factors. This indicates that our method works well by combining the different factor func-tions and each factor in our method contributes improvement in the performance.
 Convergence Property We conduct an experiment to see the ef-fect of the number of the loopy belief propagation iterations. Figure 10 illustrates the convergence analysis results of the learning algo-rithm. We see on both test cases, the BLP-based learning algorithm can converges in less than 10 iterations. After only seven learning iterations, the prediction performance of TriFG on both test cases becomes stable. This suggests that learning algorithm is very effi-cient and has a good convergence property.
 Effect of Time Span Figure 8 already shows the distribution of follow-backs in different time stamps. Now, we quantitatively ex-amine how different settings for the time span will affect the pre-diction performance. Figure 11 lists the average prediction perfor-mance of TriFG in the two test cases with different settings of the time span. It shows that when setting the time span as two or less time stamps, the prediction performance of TriFG drops sharply;
We did this by respectively removing each particular factor from our model and evaluated the decrease of the prediction performance by the TriFG model. A larger decrease means a higher predictive power. Figure 10: Convergence analysis of the learning algorithm.
Figure 11: Follow-back prediction for different time stamps. while when setting it as three time stamps, the performance is ac-ceptable. The results are consistent with the statistics in Figure 8: more than 90% of follow-back actions are performed in the first three time stamps, and only about 80% of the follow-back actions are in the first two time stamps.
 Effect of different algorithms for elite user finding The status homophily factor depends on results of elite user finding. We use three different algorithms, i.e., PageRank, #degree, and (  X ,  X  ) al-gorithm, to find elite users. Now we examine how the different algorithms would affect the prediction performance. Table 2 shows the prediction performance of TriFG with different elite user find-ing algorithms in the two test cases. Interestingly, though TriFG with the (  X ,  X  ) algorithm achieves the best performance, the dif-ference of performance among the three algorithms, especially in the second test case is not that pronounced (with a difference of 1%-4% in terms of F1-measure score). This confirms the effec-tiveness and generalization of incorporating the status homophily factor into our TriFG model.
Now we present a case study to demonstrate the effectiveness of the proposed model. Figure 12 shows an example generated from our experiments. It represents a portion of the Twitter network from the 10th-13th time stamps. Black arrows indicate following links created 4 time stamps (we use 4 time stamps as the time span for prediction) before. Blue arrows indicate new following link in the past 4 time stamps. Dash arrows indicate follow-back links in our data set (a), predicted by SVM (b), and predicted by our model TriFG (c), with green color denoting a correct one and red color denoting a mistake one. Red colored indicates there should be a follow-back link, which the approach did not detect.

We look at specific examples to study why the proposed model can outperform the comparison methods.  X  X  X ,  X  X  X , and  X  X  X  are three elite users identified using the (  X ,  X  ) algorithm [8]. SVM correctly predicts that there is a follow-back link from  X  X  X  to  X  X  X , but misses predicting the follow-back link from  X  X  X  to  X  X  X . Our model TriFG correctly predicted both the follow-back links. This is because TriFG leverages the structural balance factor. The result-ing structure among the three users by SVM is unbalanced. TriFG leverages the structural balance factor and tends to result in a bal-anced structure.

It is also worth looking at the situation of user 9 and 10. TriFG made a mistake here: it does not predict the follow-back link, while the link was correctly predicted by SVM. User 9 and user 10 have a similar social status (similar indegree) and also they are from the same time zone, thus SVM successfully predicted the follow-back link. However, as the resulting structure is unbalanced, TriFG made a compromise and finally resulted in a mistaken prediction. In this section, we review related work on link prediction and Twitter study in social networks.

Our work is related with link prediction, which is one of the core tasks in social networks. Existing work on link prediction can be broadly grouped into two categories based on the learning methods employed: unsupervised link prediction and supervised link predic-tion. Unsupervised link predictions usually assign scores to poten-tial links based on the intuition -the more similar the pair of users are, the more likely they are linked. Various similarity measures of users are considered, such as the preferential attachment [21], and the Katz measure [12]. A survey of unsupervised link prediction can be found in [17]. Recently, [18] designs a flow based method for link prediction.

There are also a number of works which employ supervised ap-proaches to predict links in social networks, such as [28, 18, 2, 16]. Backstrom et al. [2] propose a supervised random walk algo-rithm to estimate the strength of social links. Leskovec et al. [16] employ a logistic regression model to predict positive and negative links in online social networks. The main differences between ex-isting work on link prediction and our work are about two aspects. First, existing work handles undirected social networks, while we address the directed nature of the Twitter network and predict a directed link between a pair of users given an existing link in the another direction. Secondly, most existing models for link predic-tion are static. In contrast, our model is dynamic and learned from the evolution of the Twitter network. Moreover, we combine social theories (such as homophily and structural balance theory) into a semi-supervised learning model.

Another type of related work is social behavior analysis. Tang et al. [26] study the difference of the social influence on different top-ics and propose Topical Affinity Propagation (TAP) to model the topic-level social influence in social networks and develop a par-allel model learning algorithm based on the map-reduce program-ming model. Tan et al. [25] investigate how social actions evolve in a dynamic social network and propose a time-varying factor graph model for modeling and predicting users X  social behaviors. The proposed methods in these work can be utilized in the problem de-fined in this work, but the problem is fundamentally different.
There is little doubt that Twitter has intrigued worldwide neti-zens, and the research communities alike. Existing Twitter study is mainly centered around the following three aspects: 1) the Twit-ter network . Java et al. [11] study the topological and geograph-ical properties of the Twitter network. Their findings verify the homophily phenomenon that users with similar intentions connect with each other. Kwak et al. [13] conduct a similar study on the entire Twittersphere and they observe some notable properties of Twitter, such as a non-power-law follower distribution, a short ef-fective diameter, and low reciprocity, marking a deviation from known characteristics of human social networks. 2) the Twitter users . Work of this category mainly focus on identifying influen-tial users in Twitter [30, 3, 13] or examining and predicting tweet-ing behaviors of users [10, 25]. 3) the Tweets . Sakaki et al. [24] propose to utilize the real-time nature of Twitter to detect a target event; while Mathioudakis and Koudas [19] present a system, Twit-terMonitor, to detect emerging topics from the Twitter content.
In this paper, we study the novel problem of two-way relation-ship prediction in social networks. We formally define the problem and propose a Triad Factor Graph (TriFG) model, which incorpo-rates social theories into a semi-supervised learning model. We evaluate the proposed model on a large Twitter network. We show the proposed factor graph model can significantly improve the per-formance (+22%-+27% by F1-Measure) for two-way relationship prediction comparing with several alternative methods. Our study also reveals several interesting phenomena.

The general problem of reciprocal relationship prediction rep-resents a new and interesting research direction in social network analysis. There are many potential future directions of this work. First, some other social theories can be further explored and vali-dated for reciprocal relationship prediction. Looking farther ahead, it is also interesting to develop a real friend suggestion system based on the proposed method. We can validate the proposed method based on user feedbacks. We can also further study the-oretical methodologies for improving the predictive performance by incorporating user interactions. Finally, building a theory of why and how users create relationships with each other in different kinds of networks is an intriguing direction for further research. Acknowledgements John Hopcroft was partially supported by the U.S. Air Force Office of Scientific Research under Grant FA9550-09-1-0675. Jie Tang is supported by the Natural Science Founda-tion of China (No. 61073073) and Chinese National Key Foun-dation Research (No. 60933013, No.61035004 ). Tiancheng Lou is supported in part by the National Basic Research Program of China Grant 2007CB807900, 2007CB807901, the National Natu-ral Science Foundation of China Grant 61033001, 61061130540, 61073174. [1] L. Backstrom, R. Kumar, C. Marlow, J. Novak, and [2] L. Backstrom and J. Leskovec. Supervised random walks: [3] M. Cha, H. Haddadi, F. Benevenuto, and P. K. Gummadi. [4] D. J. Crandall, L. Backstrom, D. Cosley, S. Suri, [5] N. Eagle, A. S. Pentland, and D. Lazer. Inferring social [6] D. Easley and J. Kleinberg. Networks, Crowds, and Markets: [7] J. M. Hammersley and P. Clifford. Markov field on finite [8] J. He, J. E. Hopcroft, H. Liang, S. Suwajanakorn, and [9] D. Horton and R. R. Wohl. Mass communication and [10] B. Huberman, D. M. Romero, and F. Wu. Social networks [11] A. Java, X. Song, T. Finin, and B. L. Tseng. Why we twitter: [12] L. Katz. A new status index derived from sociometric [13] H. Kwak, C. Lee, H. Park, and S. B. Moon. What is twitter, a [14] J. D. Lafferty, A. McCallum, and F. C. N. Pereira. [15] P. F. Lazarsfeld and R. K. Merton. Friendship as a social [16] J. Leskovec, D. Huttenlocher, and J. Kleinberg. Predicting [17] D. Liben-Nowell and J. M. Kleinberg. The link-prediction [18] R. Lichtenwalter, J. T. Lussier, and N. V. Chawla. New [19] M. Mathioudakis and N. Koudas. Twittermonitor: trend [20] K. P. Murphy, Y. Weiss, and M. I. Jordan. Loopy belief [21] M. E. J. Newman. Clustering and preferential attachment in [22] L. Page, S. Brin, R. Motwani, and T. Winograd. The [23] D. M. Romero and J. M. Kleinberg. The directed closure [24] T. Sakaki, M. Okazaki, and Y. Matsuo. Earthquake shakes [25] C. Tan, J. Tang, J. Sun, Q. Lin, and F. Wang. Social action [26] J. Tang, J. Sun, C. Wang, and Z. Yang. Social influence [27] C. Wang, J. Han, Y. Jia, J. Tang, D. Zhang, Y. Yu, and [28] C. Wang, V. Satuluri, and S. Parthasarathy. Local [29] M. Weber. The N ature of Social Action in Runciman, W.G. [30] J. Weng, E.-P. Lim, J. Jiang, and Q. He. Twitterrank: finding [31] S. Wu, J. M. Hofman, W. A. Mason, and D. J. Watts. Who [32] E. P. Xing, M. I. Jordan, and S. Russell. A generalized mean [33] Z. Yang, J. Guo, K. Cai, J. Tang, J. Li, L. Zhang, and Z. Su. This section depicts how we define the factor functions in our ex-periments. In total, we define 25 features of five categories: Ge-ographic distance, Link homophily, Status homophily, Structural balance, and Implicit network correlation.
 Geographic distance We use Google Map API to get the exact locations (longitude and latitude) of some users. Based on the two values, we define the following three features : the absolute dis-tance and the time zone difference between two users, and whether or not the two users are from the same country.
 Link homophily First, we treat each link as undirected link, and define the following four features : the number of com-mon neighbors, percentage of common neighbors of the two users(respectively) and the average percentage.

Then we consider directed links and define another three fea-tures : the number of common two-way links, number of common followers and number of common followees.
 Status homophily We also test whether two users have similar social status, and define the following three features : whether or not the two users are both elite users, an ordinary and an elite, and both ordinary users.
 Implicit network correlation We consider the interaction be-tween user A and user B , and define the following four features respectively represent the number of retweets(replies) from A to B and from B to A .
 Structural balance Based on the structural balance theory, as in Figure 5, we define eight features capturing all situations of struc-tural balance theory for each triad.
