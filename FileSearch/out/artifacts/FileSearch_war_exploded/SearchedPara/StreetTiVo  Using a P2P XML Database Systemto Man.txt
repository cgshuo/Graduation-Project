 T h in gs are cha n g in g in the livin gr oo m , u n der the TV set :TVi sg oin gd i g i ta l a n dc on sumer e l ectr oni cs gets n et wo rked .T he s o-ca ll ed  X  set -t o p  X  b ox es that are n eeded f o rd i g i ta l te l e vi s ion ha v eappeared in the h o uses o fma ny; a n d , ma ny o f these set -t o pb ox es are rather p ow erfu l c o mputers c onn ected t o the In ter n et , ru n-nin g Win d ow s M ed i aCe n ter o r i ts o pe n-s o urce My th TV equ iv a l e n t .A re l ated tre n d i sthe in creas in gdema n df o rmu l t i med i a in f o rmat ion access .P rese n t ly,  X  X  rd in ar y X  pe o p l e own hu n dreds o fg i gab y tes o fmu l t i med i adata , resu l t in gfr o m the i rd i g i ta l ph o t o cameras , hard -d i sk vi de o rec o rders , etc .How e v er , search -in gmu l t i med i afi l es i susua lly restr i cted t o s i mp l e loo kup in the meta -data o f fi l es , such as fi l e n ames a n d ( huma n-ed i ted ) descr i pt ion s .Mo re ad v a n ced mu l-( e . g ., speech rec o g ni t ion a n d i mage pr o cess in g ). A sar o ugh est i mat ion, i ttakes am o derate c o mputer m o re tha non e o rder o fmag ni tude m o re t i me t o der iv ethe au xili ar y data that wo u l de n ab l e better search fac ili t i es .

T he i dea o f StreetTiVo i st o u ni te the c o mput in gp ow er o fth o se M ed i aCe n-ter de vi ces ( peers )in the livin gr oo ms .By d i str i buted a n dpara ll e l e x ecut ion o f in de xin g o fthec on te n tca n be pr ovi ded us in g j ust the o rd in ar y hard w are a v a il-ab l e in the n et wo rk .S treet TiVo d ivi des the M ed i aCe n ter de vi ces in t o gr o ups d i g i ta l streets a n dare vi rtua ln e i ghb o urs o feach o ther .No te that S treet TiVo uses the P 2 P c on cept in astr i ct ly l ega lw a y, as i t i s no tusedt o d i str i bute the vi de o fi l es themse lv es .U sers ca nonlyw atch the c on te n t that the y ha v erec o rded themse lv es .W hat i se x cha n ged b yS treet TiVo are only the resu l ts o fmu l t i med i a a n a ly s i s o fth o se vi de o s ,i. e ., ge n erated meta -data .

S ummar i z in g , the g o a lo fthe S treet TiVo pr oj ect i s : unite Media Center de-vices using P2P technologies to cooperatively run compute intensive multimedia analysis applications just in everybody X  X  living room so that they could produce results in near real-time .

I mag in ef o re x amp l e ,i f only at iny fract ion o fthem illion s o fpe o p l erec o rd -in gtheChamp ion s L eague s o ccer c o mpet i t ion wo u l dpart i c i pate in S treet TiVo ! U sefu l med i aa n a ly s i st ool s wo u l d in c l ude the tra n scr i pt ion o fthete x tsp o ke n b y the prese n ters dur in gthematch , but a l s o the cr o ss -med i aa n a ly s i st o rec o g -ni ze g o a l sa n d o ther e x c i t in gm o me n ts ( e . g ., fr o maud io vol ume a n d /o rcamera m o t ion patter n s ). A fter each gr o up o fmed i ace n ters has e x cha n ged i ts part i a l a n a ly s i sresu l ts wi th the o ther gr o ups ( that rec o rded the same match ), a ll S treet -TiVo part i c i pa n ts o bta in the c o mp l ete set o faut o mat i ca lly der iv ed a nno tat ion s , o f the game ,o r , the aut o mat i cge n erat ion o f a summar yin c l ud in ga ll h i gh li ghts . In this paper w e descr i be the P 2 P data ma n ageme n t appr o ach o f S treet TiVo in S ect ion 2 .T he curre n ts y stem arch i tecture i sprese n ted in S ect ion 3. W e br i e fly descr i be the three ma jo rc o mp on e n ts :X R P C ,AS Ra n d PF/Tij ah .T h i s first v ers ion o f S treet TiVo w as ch o se n t o be s i mp l e , s o that w ec o u l dqu i ck ly dem on strate the c oo perat ion bet w ee nX R P C ,AS R ,PF/Tij ah in a non-tr ivi a l app li cat ion sett in g .A d i str i buted arch i tecture i sad o pted ,inw h i ch a ll S treet TiVo users (i. e ., c li e n ts ) are ma n aged b y ace n tra l ser v er .InS ect ion 4 ,w ee x p l a in the e nvi s ion ed P 2 P m o de l a n dd i scuss the cha ll e n ges on o ur w a y t o make S treet TiVo atru ly P 2 P app li cat ion. W ec on c l ude in S ect ion 5. F r o ma n et wo rk c o mmu ni cat ion perspect iv e ,DHT-based ov er l a y sha v ega in ed much p o pu l ar i t yin b o th research pr oj ects a n drea l-wo r l d P 2 P app li ca -sca l ab l e ( guara n tees O ( logN ) sca l ab ili t y) in vol at il e WA N e nvi r on me n ts [6,13]. F r o madatama n ageme n t perspect iv e ,XML has bec o me the de fact o sta n-dard f o rdatae x cha n ge ov er the In ter n et , a n d X Quer y the W3 Csta n dard f o r quer yin g XML data .T he in frastructure o f S treet TiVo i stheref o re pr ovi ded b y MonetDB/XQuery [1 4 ], a P 2 P XML DBMS that supp o rts d i str i buted e v a l-uat ion o f X Quer y[15] quer i es ov er DHT n et wo rks [1,3, 4 ,6]. Each peer ru n s a nXDBMS, MonetDB/XQuery [16], t o ma n age i ts lo ca l data . C o mmu ni ca -t ion am on g peers i sd on eb y rem o te e x ecut ion o f X Quer y fu n ct ion sus in g XRPC [1 7 ,1 8 ], as i mp l e X Quer y e x te n s ion f o rRem o te P r o cedure Ca ll s ( R P C ) that e n ab l es efficient d i str i buted quer yin g o f heterogeneous X Quer y data s o urces . T he curre n t i mp l eme n tat ion o f S treet TiVo as X Quer y e x press ion sapp li es a D utch aut o mat i c speech rec o g ni t ion s y stem ( ASR )[19] t o the rec o rded pr o-grammes , a n dpr ovi des a fu ll-te x tretr i e v a l ser vi ce o fthe AS R o utput b y em -p loyin gthe Mon et DB/X Quer y e x te n s ion PF/Tijah [ 2 0]. W he n a TV pr o gram i sbr o adcast , a ll part i c i pa n ts ( peers that are rec o rd in gth i s TV pr o gram )join t ly e x tract the (D utch ) sp o ke n te x tus in gthe AS Rc o mp on e n t , a n de x cha n ge lo ca l part i a lAS Rresu l ts wi th each o ther .AS Rpr o duces XML d o cume n ts c on ta in-in g speech te x ts a n ds o me meta -data , f o re x amp l e , start / e n dt i mestamp o fa se n te n ce in the vi de o fi l e . Each part i c i pa n tst o res all resu l t in g XML d o cume n ts o ftherec o rd in g in i ts lo ca lMon et DB/X Quer y that ca n the n be quer i ed us in g PF/Tij ah .T he meta -data o ftheretr i e v ed se n te n ces pr ovi de suffic i e n t in f o rma -t ion f o rthe S treet TiVo G UI t o d i sp l a yonly the des i red vi de o fragme n t . sh own in Fi gure 1. In th i ssetup ,w e assume that the c oo rd in at o r i sare li ab l e DHT-based P 2 P m o de l, w efirstdeta il the curre n t i mp l eme n tat ion.

Each peer ru n sa Mon et DB/X Quer y ser v er a n dc o mmu ni cates wi th o ther peers vi a X R P C , b y se n d in g S O AP X R P Crequest / resp on se messages .T he ce n-ge n erat ion a n dd i str i but ion o f AS Rtasks .Fo reach recording , the c oo rd in at o r ma in ta in sa li st o fpart i c i pat in g peers a n da li st o ftasks ( ca ll ed fragment s ). A para ll e lly b y the part i c i pa n ts .Fo reach fragment , the c oo rd in at o rma in ta in s i f i t i sbe in gpr o cessed b y a peer (i. e ., i thasa n assignee ), o r i f i ts speech te x t i s a l read y a v a il ab l e (i. e .i thasa n owner ). All meta -data are in XML f o rmat a n d st o red in Mon et DB/X Quer y.
 Example 1. T he XML s ni ppet in Fi gure 2 sh ow sthe recording e l eme n tf o rthe TV pr o gram bbc1 20080425 200000 .T he progID i s determ in ed b y cha nn e l, date a n dstartt i me .T he TV pr o gram i srec o rded b y t wo peers a n d i sd ivi ded in t o 4 fragme n ts .T he attr i butes start a n d end o fa fragment in d i cate the re l at iv e start / e n dt i mestamps o f the fragme n t in the vi de o fi l e .F ragme n ts are ass i g n ed t o the part i c i pa n ts in the o rder the y reg i ster , s oini t i a lly fragme n ts 1 a n d2 are ass i g n ed t o the h o sts x.example.org a n d y.example.org , respect iv e ly. So far , x.example.org has fi ni shed a n a ly se fragment 1(in d i cated as the owner o fthe fragme n t ) a n dhasbee n ass i g n ed a n e wjo b fragment 3. T he h o st y.example.org i sst ill pr o cess in g fragment 2 .Sin ce there are no m o re part i c i pa n ts , fragment 4 i s w a i t in gt o be ass i g n ed .
 All in terfaces bet w ee n c oo rd in at o r , c li e n ts a n dthe lo ca lAS Re n g in eha v ebee n defi n ed as X Quer y fu n ct ion s .A sma ll J a v apr o gram i mp l eme n ts the X Quer y fu n ct ion ( start-asr() in Fi gure 1) that tr i ggers the AS Re n g in e .T he in teract ion bet w ee non e S treet TiVo c li e n ta n dthec oo rd in at o r i ssh own in deta il s . C oll ab o-rat iv e speech rec o g ni t ion wo rks as f ollow s .
 Step  X  . W he n a TV pr o gram i sschedu l ed f o rrec o rd in g , the S treet TiVo c li e n t se n ds a nX R P Crequestt o the c oo rd in at o rt o e x ecute the fu n ct ion register-recording() .T he c oo rd in at o rresp on ds wi th a fragment ,w h i ch has no tbee n pr o-cessed b y a ny part i c i pa n ts , a n d in serts the c li e n tasa n assignee in t o the fragment
I ftherequest i s the first reg i strat ion f o ra TV pr o gram , the c oo rd in at o rfirst n eeds t o ge n erate AS Rtasks .An eas yw a y t o d o th i s i st o d ivi de the w h ol e rec o rd in g in t o equa l s i zed fragme n ts .To get h i gh qua li t yAS Rresu l t , the AS R segme n ter sh o u l dbeused ,w h i ch i sab l et o fi l ter o ut the aud io that d ono tc on-ta in speech a n dge n erates fragme n ts acc o rd in g ly ( see S ect ion 3. 2 ). In f o rmat ion pr ovi ded b y the AS Rsegme n ter e n sures that the AS R speech rec o g ni zer pr o-duces m o re accurate resu l ts .How e v er , the better qua li t y c o mes at a h i gh c o st o f speed , because the c oo rd in at o rmustrec o rd the TV pr o gram i tse l fa n dru nAS R segme n ter afterwards .So, there i satrade -off bet w ee n speed a n dqua li t y. Step  X  . U p on rece i pt o ftheresp on se fr o mthec oo rd in at o r (in Step  X  ), the S treet TiVo c li e n tstarts i ts lo ca lAS Re n g in et o a n a ly ze the fragme n tspec i fied in the resp on se message , b y ca llin gthe in terface fu n ct ion start-asr() .
 Step  X  . A fter the AS Re n g in ehasfi ni shed a n a ly z in gafragme n t , the S treet -TiVo c li e n trep o rts th i sb y ca llin g add-finished-fragment() on the c oo rd in at o r a n dpass in gam on g o thers the retr i e v ed te x t as parameter . Step  X  . A fter ha vin gfi ni shed on etask , the S treet TiVo c li e n t i se x pected t o request a n e w task ( get-job() ), u n t il the c oo rd in at o rresp on ds wi th a n empt y task ,w h i ch m i ght mea n that there are suffic i e n t n umber o fass i g n ees f o reach fragme n t ,o r that the c oo rd in at o r has rece iv ed the AS Rresu l ts o fa ll fragme n ts . Step  X  . I fthereare no n e w tasks , the S treet TiVo c li e n t w a i ts f o rs o me predefi n ed t i me t o g iv ethe o ther part i c i pa n ts the o pp o rtu ni t y t o fi ni sh the i r AS Rtasks , a n dthe n attempts t o retr i e v e the speech te x t o fthem i ss in g fragme n ts .T he S treet TiVo c li e n tca n d i rect ly ask the c oo rd in at o rf o rthem i ss in g fragme n ts ( get-speech-text() ), s in ce a ll AS Rresu l ts are a l s o st o red at the c oo rd in at o r , but the preferred pr o cedure i st oj ust ca ll the c oo rd in at o r  X  s get-fragments() fu n ct ion (no tsh own) t o fi n d o ut w hat part i c i pa n t own s w h i ch AS Rresu l t , a n dretr i e v e the fragme n ts  X  te x ts fr o mth o se no des .

O n ce the AS Rresu l ts are lo ca lly a v a il ab l e ,S treet TiVo users ca n search f o r vi de o fragme n ts b y e n ter in gke ywo rds in the G UI. T he ke ywo rds are subseque n t ly tra n s l ated in t oTij ah quer i es .PF/Tij ah retur n smatch in gse n te n ces ra n ked b y start / e n dt i mestamps in the vi de o fi l e , th i s w a y, the des i red vi de o fragme n ts ca n be retr i e v ed .In summar y, S treet TiVo has three ma jo rc o mp on e n ts :X R P Ctakes care o fc o mmu ni cat ion am on g peers ,AS Rpr ovi des vi de o a n a ly s i sfu n ct ion s , a n d PF/Tij ah e n ab l es retr i e v a lo f vi de o fragme n ts us in gke ywo rds .In the rema in der o fth i s sect ion, w eg iv eabr i ef ov er vi e wo fthesetech ni ques . 3.1 XRPC: Distributed XQuery Processing X Quer y 1.0 [15] only pr ovi des a data shipping m o de l f o rquer yin g XML d o cu -me n ts ov er the In ter n et .T he bu il t -in fu n ct ion fn:doc() fetches a nXML d o cume n t fr o marem o te peer t o the lo ca l ser v er ,w here i t subseque n t ly ca n be quer i ed .T he rece n t W3 CCa n d i date Rec o mme n dat ion XQuery Update Facility (X Q UF) [ 22 ] in tr o duces a bu il t -in fu n ct ion fn:put() f o rrem o te st o rage o f XML d o cume n ts , w h i ch aga in i mp li es data sh i pp in g .T here ha v ebee nv ar io us pr o p o sa l st o equ i p X Quer ywi th function shipping st yl ed i str i buted quer yin gab ili t i es [ 2 3, 24 , 2 5]. O n these .X R P C adds R P Ct oX Quer yin the m o st s i mp l e w a y: add in gadest in at ion U R I t o the X Quer y equ iv a l e n t o fapr o cedure ca ll (i. e . fu n ct ion app li cat ion).
Rem o te fu n ct ion app li cat ion s in X R P Ctakethe X Quer y s yn ta x: execute at { Expr }{ FunApp (ParamList) } ,w here Expr i sa nX Quer y xs:string e x press ion that spec i fies the U R Io f the peer on w h i ch the fu n ct ion FunApp i st o be e x ecuted . A saru nnin ge x amp l e ,w e assume a set o f X Quer yDBMS( peers ) that each st o re am ovi e database in a nXML d o cume n t filmDB.xml wi th c on te n ts s i m il ar t o: W e assume a nX Quer y m o du l e film.xq st o red at the h o st example.org that defi n es a fu n ct ion filmsByActor() : Wi th X R P C ,w eca n e x ecute th i sfu n ct ion on arem o te peer , e . g . x.example.org , t o get a seque n ce o ffi l ms in w h i ch S ea n C onn er y p l a y s in the fi l m database st o red on the rem o te peer . w h i ch yi e l ds : films name The Rock /name /films .W e in tr o duceherea n e w xrpc:// n et wo rk pr o t o c ol, accepted in the dest in at ion U R Io f execute at , t oin d i-cate a peer  X  sab ili t yo fha n d lin g X R P Cquer i es .T he ge n er i cf o rm o fsuch U R I s i s xrpc:// host [:port] [/[path]] ,w here xrpc:// i sthe n et wo rk pr o t o c ol, host [:port] i de n t i fies the rem o te peer , a n d [/[path]] i sa no pt ion a llo ca l path at the rem o te peer .
 The SOAP XRPC Protocol. T he des i g n g o a lo f X R P C i st o create a d i s -tr i buted X Quer y mecha ni sm wi th w h i ch different X Quer y e n g in es at d iff ere n t a network protocol ,S O AP X R P C ,w h i ch uses the Si mp l eOb j ect A ccess P r o t o c ol (S O AP) [ 2 6] (i. e .XML messages )ov er HTTP. XML i s i dea l f o rd i str i buted e nvi-are perfect ly equ i pped t o pr o cess XML messages , a n da nXML-based message pr o t o c ol makes i ttr ivi a l t o supp o rt pass in g v a l ues o fa ny t y pe fr o mthe X Quer y D ata Mo de l[ 27 ]. T he ch oi ce f o r S O AP br in gs as add i t ion a l ad v a n tages seam -l ess in tegrat ion o f X Quer y data s o urces wi th w eb ser vi ces a n d S er vi ce Or i e n ted A rch i tectures (S O A) as w e ll as AJAX-st yl eG UI s .T he c o mp l ete spec i ficat ion o f the S O AP X R P Cpr o t o c ol ca n be f o u n d in [1 7 ]. H ere w esh ow, as a n e x amp l e , the X R P C request message that sh o u l dbege n erated f o rthequer y ab ov e : 3.2 ASR: I Know What You Said A ut o mat i c S peech Rec o g ni t ion (AS R ) supp o rts the c on ceptua l quer yin g o f vi de o c on te n ta n dthes yn chr oni zat ion t o a ny k in d o fte x tua l res o urce that i s access i-b l e ,in c l ud in g o ther a nno tat ion sf o raud iovi sua l mater i a l such as subt i t l es .T he p o te n t i a lo f AS R -based in de xin ghasbee n dem on strated m o st successfu lly in the br o adcast n e w sd o ma in. Ty p i ca lly l arge vo cabu l ar y speaker in depe n de n tc on t in-u o us speech rec o g ni t ion (LV C S R )i sdep loy ed t o th i se n d .

T he AS Rs y stem dep loy ed in S treet TiVo w as de v e lo ped at the Univ ers i t y o f Tw e n te a n d i spart o fthe o pe n-s o urce SHoUT speech rec o g ni t ion t ool k i t 1 . Fi gure 3 g iv es a nov er vi e wo fthe AS Rdec o d in gs y stem . Each step pr ovi des the in put f o rthef ollowin gstep .T he w h ol epr o cess ca n be r o ugh ly d ivi ded in t o t wo stages .D ur in g the first stage , the Speech Activity Detection (SAD) i susedt o fi l ter o ut the aud io parts that d ono tc on ta in speech .T h i sstep i scruc i a l f o rthe perf o rma n ce o fthe AS Rs y stem t o a voi dthat i ttr i es t o rec o g ni ze non-speech aud io that i st y p i ca lly f o u n d in rec o rded TV pr o grams such as mus i c , s o u n d e ff ects o rbackgr o u n d noi se wi th h i gh vol ume ( traffic , cheer in gaud i e n ce , etc ). A fter SAD, the s y stem tr i es t o figure o ut  X  X  h o sp o ke w he n X , apr o cedure that i st y p i ca lly referred t o as speaker d i ar i zat ion. In th i sstep , the speech fragme n ts are sp li t in t o segme n ts that only c on ta in speech fr o m on es in g l espeaker . Each segme n t i s l abe ll ed wi th i ts c o rresp on d in gspeaker ID. N e x t , f o reachsegme n t the vo ca l tract l e n gth (VTLN) w arp in gfact o r i s determ in ed f o r vo ca l tract l e n gth no rma li sat ion. V ar i at ion o f vo ca l tract l e n gth bet w ee n speakers makes i t harder t o tra in r o bust ac o ust i cm o de l s .In the SHoUT s y stem ,no rma li sat ion o f the feature v ect o rs i s o bta in ed b y sh i ft in gthe M e l-sca l e win d ow sb y a certa in w arp in gfact o r dur in gfeaturee x tract ion f o r the first dec o d in gstep .
A fter ha vin gc l ea n ed up the in put s o u n da n dga in ed suffic i e n tmeta in f o rma -t ion, speech rec o g ni t ion ca n be started in the sec on d stage .D ec o d in g i sd on e us in gthe HMM-based Vi terb i dec o der .In the first dec o d in g i terat ion, tr i ph on e VTLN ac o ust i cm o de l sa n dtr i gram l a n guage m o de l sareused .Fo r each speaker , afirstbesth y p o thes i sa li g n ed on aph on ebas i s i screatedf o ru n super vi sed ac o us -t i cm o de l adaptat ion. Opt ion a lly, f o reachfi l eat o p i cspec i fic l a n guage m o de l ca n be ge n erated based on the in put o ffirstrec o g ni t ion pass .T he sec on dde -c o d in g i terat ion uses the speaker adapted ac o ust i cm o de l sa n dthet o p i cspec i fic l a n guage m o de l st o create the fi n a l first best h y p o thes i sa li g n ed on wo rd bas i s . Al s o, f o reachsegme n t , a wo rd l att i ces i screated .A m o re deta il ed descr i pt ion o feachstepca n be f o u n d in [19]. 3.3 PF/Tijah: XML Text Search PF/Tij ah [ 2 0] i sa no ther research pr oj ect ru n b y the Univ ers i t yo f Tw e n te wi th the g o a l t o create a fl e xi b l ee nvi r on me n tf o rsett in gupsearchs y stems b yin te -grat in g Mon et DB/X Quer y that uses the P athfi n der c o mp il er [ 28 ]wi th the Tij ah XML In f o rmat ion Retr i e v a l(I R ) s y stem [ 2 9]. T he ma in features supp o rted b y PF/Tij ah in c l ude the f ollowin g :  X 
Retr i e vin garb i trar y parts o fte x tua l data , u nli ke trad i t ion a lI Rs y stems f o r w h i ch the no t ion o fad o cume n t n eeds t o be defi n ed up fr on tb y the app li-art i c l es o r paragraphs without adapt in gthe in de xo ra ny o ther part o fthe s y stem c on figurat ion;  X  C o mp l e x sc o r in ga n dra n k in g o ftheretr i e v ed resu l ts b y mea n s o fs o-ca ll ed
Narrowed Extended XPath (N E XI) [30] quer i es .N E XI i saquer yl a n guage s i m il ar t oXP ath that only supp o rts the desce n da n ta n dthese l fa xi sstep , but that i se x te n ded wi th a spec i a l about() fu n ct ion that takes a seque n ce o f no des a n dra n ks th o se b y the i rest i mated pr o bab ili t yo fre l e v a n ce t o the quer y;  X 
PF/Tij ah supp o rts in creme n ta lin de xin g :w he nn e wAS R fragme n ts are added t o the database , the i rte x t will be aut o mat i ca lly in de x ed b yPF/Tij ah , without the n eed t o re -in de x the e n t i re database fr o mscratch ;  X  search c o mb in ed wi th trad i t ion a l database quer yin g ,in c l ud in gf o r in sta n ce join s on v a l ues .A sa n e x amp l e ,on ec o u l dsearchf o rpr o grammes me n t ionin g  X  f oo tba ll X  that are br o adcast on the same cha nn e l as pr o grammes me n t ionin g  X  cr i me  X .

S treet TiVo in serts fragme n ts c on ta inin gthetra n scr i pts o f AS R w he n e v er the y are a v a il ab l e .T heref o re , the y will no tbe ni ce ly gr o uped per pr o gramme in the database ,no r will the y be in chr onolo g i ca lo rder .T he c o mb in at ion X Quer y a n d N E XI te x tsearche n ab l es S treet TiVo t o search match in g fragme n ts , c o mb in ethe fragme n ts wi th the same pr o gramme i de n t i fier , c o mb in ethe i rsc o res (o rtakethe sc o re o fthebestmatch in g fragme n t ), rera n kpr o grammes b y the sc o res o fthe i r fragme n ts , a n dd i sp l a y the match in gpr o grammes a lon g wi th the i rbestmatch in g fragme n ts : a ll o fth i s i sd on e in on equer y. Our n e x tstep in the de v e lo p -me n t o f S treet TiVo i st o re -p l ace the c li e n t -ser v er m o de lwi th Mon et DB/X Quer y [1 4 ], w h i ch in tegrate the P 2 P data structure Di str i buted H ash T ab l es (DHT s ) in t oX Quer y( see Fi gure 4 ). A DHT [1,3, 4 ,6] pr ovi des (i) r o bust c onn ect ivi t y(i. e ., i ttr i es t o pre -v e n t n et wo rk part i t ionin g ), (ii) h i gh data a v a il ab ili t y(i. e ., pre v e n t data lo ss i f a peer g o es d own b y aut o mat i crep li cat ion), a n d (iii) a sca l ab l e ( key, value ) st o rage mecha ni sm wi th O ( log ( N )) c o st c o mp l e xi t y, w here N i sthe n umber o f peers in the n et wo rk .An umber o f P 2 P database pr o t o t y pes ha v ea l read y used DHT s [5, 7 , 8 ,10,11].
 In a S treet TiVo s y stem us in ga DHT m o de l, peers are ma n aged b y a DHT r in g . T here i s no s in g l e S treet TiVo c oo rd in at o r .All peers are u n re li ab l ea n deachca n be b o th a c oo rd in at o ra n dac li e n t , thus , each peer must add i t ion a lly supp o rt the fu n ct ion spr ovi ded b y the c oo rd in at o r , as d i scussed in S ect ion 3. T he pr o cess t o e x cept se v era l sma ll cha n ges : Example 2. Fi gure 4 sh ow sa n e x amp l esce n ar io, in w h i ch three peers N65 , N73 a n d N82 will rec o rd the TV pr o gram wi th progID = X  bbc1 20080425 200000  X .
 All part i c i pa n ts use the same hash fu n ct ion t o ca l cu l ate the hash o fthe progID , w h i ch i s42here .Sin ce the peer P40 i sresp on s i b l ef o rke y s [ 4 0 , 53], i t i sch o se n as the c oo rd in at o rf o rth i s TV pr o gram .T he part i c i pat in g peers reg i ster the rec o rd in gat P40 (S tep  X  ). Ge n erat in g AS Rtasks i sst ill d on eb y the ( temp o rar y) c oo rd in at o r , P40 .W he n a peer fi ni shed a nAS Rtask ,i trep o rts th i satthe c oo rd in at o r (S tep  X  ), but without se n d in gthee x tracted te x t .All part i c i pa n ts will repeat steps  X  ,  X  a n d  X  t o pr o cess m o re fragme n ts , u n t il there are no m o re AS Rtasks .Fin a lly, the part i c i pa n ts e x cha n ge the AS Rresu l ts b y first fi n d in g the own er o f each fragme n ts fr o mthec oo rd in at o r (S tep  X  ), a n dthe n retr i e vin g the m i ss in g AS Rresu l ts fr o meach o ther (S tep  X  ).
 No te that ,in the DHT m o de l, the a v a il ab ili t yo ftherec o rd in gmeta -data (i. e ., the recording e l eme n ts ma in ta in ed b y ac oo rd in at o rasd i scussed in S ect ion 3) i s guara n teed tha n ks t o the aut o mat i crep li cat ion fac ili t y pr ovi ded b y the u n der ly-in g DHT n et wo rk , that i s , a ll data on a peer ma n aged b y the DHT n et wo rk are rep li cated on the peer  X  s predecess o rs a n d success o rs .T hus ,i f peer P40 wo u l dfa il in o ur e x amp l e , a ll request wi th ke y 42 wo u l dber o uted b y the DHT n et wo rk t o P23 o r P54 .Al s ono te that , the AS Rresu l ts are no tma n aged b y the DHT n et wo rk .B as i ca lly, a ll S treet TiVo peers ca n retr i e v e these data , but only the peers that ha v erec o rded the part i cu l ar TV pr o gram ca n d i sp l a y the vi de o. T he a v a il ab ili t yo fthe AS Rresu l ts i sa ff ected b y the n umber o fpart i c i pa n ts ( m o re e v er yS treet TiVo peer i sab l et o ru nAS R on am i ss in g fragme n ts .
 The challenges in in tegrat ion o f X Quer y a n d DHT are : (i) how a DHT should be exploited by an XQuery processor, (ii) if and how the DHT functionality should surface in the query language.

In Mon et DB/X Quer y ,w epr o p o se t o a voi da ny add i t ion a ll a n guage e x te n s ion s , but rather in tr o duce a n e w dht// n et wo rk pr o t o c ol, accepted in the dest i-n at ion U R Io f fn:doc() , fn:put() a n d execute at .T he ge n er i cf o rm o fsuch U R I s i s dht:// dht i d / key ,w here dht:// i sthe n et wo rk pr o t o c ol, dht id i sthe ID o fthe DHT n et wo rk t o be used .S uch a nIDi susefu l t o a l-low a P 2 PXDBMS t o part i c i pate in mu l t i p l e (lo g i ca l) DHT ss i mu l ta n e o us ly ( see Fi gure 4 ). T he key i susedt o st o re a n dretr i e v e v a l ues in the DHT.

In the arch i tecture sh own in Fi gure 4 ,w eru n the DHT as a separate pr o-cess ca ll ed the Lo ca lDHTA ge n t (LDA). Each LDA i s i sc onn ected t oon e DHT dht id .W epr o p o se a tight coupling bet w ee n the DHT n et wo rk a n dthe XDBMS [1 4 ], in w h i ch each DHT peer uses i ts lo ca lXDBMS t o st o re the data (i. e .XML d o cume n ts ) a n dthe lo ca lXDBMS uses i ts u n der lyin g DHT n et wo rk t o r o ute X Quer y quer i es t o rem o te peers f o re x ecut ion (i. e . pass X R P Crequests t o the LDA). A p o s i t iv es i de -e ff ect o fth i st i ght c o up lin g i s that the DBMS gets access t o the in f o rmat ion in ter n a l t o the P 2 Pn et wo rk .T h i s in f o rmat ion ( e . g . peer res o urces , c onn ect ivi t y) ca n be e x p loi ted in quer yo pt i m i zat ion. To rea li ze th i sc o up lin g ,w e n eed t o e x te n dthe DHT API ( put() a n d get() )wi th on e n e w meth o d : xrpc ( key, q, m, f ( ParamList )) : item()* ,w here f ( ParamList )i sthe X Quer y fu n ct ion that i st o be e x ecuted on arem o te DHT peer determ in ed b y key .T he parameters q a n d m spec i f yX Quer y m o du l e ,inw h i ch the fu n ct ion f r i sdefi n ed a n dthe lo cat ion o fthem o du l efi l e .Wi th th i smeth o d , a nX R P Cca ll on a peer p 0 t o a dht:// dht x / key y U R Ii sha n d l ed as f ollow s : 1. T he X R P C request ( q, m, f, P aramList )i s passed t o the Lo ca lDHTA ge n t 2 .T he DHT dht x r o utes the request us in gthe no rma lDHT r o ut in gmecha ni sm 3. W he n the LDA lda x i on p i rece iv es such a request ,i tperf o rms a nX R P Cca ll 4 .W he n lda x i rece iv es the resp on se message ,i ttra n sp o rts the resp on se back Use Cases. B e low w esh ow h ow t wo ma in S treet TiVo fu n ct ion sca n be i mp l e -me n ted as X Quer y m o du l efu n ct ion s ,w h i ch the n ca n be e x ecuted us in g X R P C a n dthet i ght ly c o up l ed DHT sema n t i cs . (i) Collaborator Discovery. In S treet TiVo, e v er yTV pr o gram has a u ni que i de n t i-fier progID , a n df o reachrec o rded TV pr o gram a recording e l eme n t i sma in ta in ed b y the peer resp on s i b l ef o rtheke y hash ( progID )wi th li sts o f participants a n d fragments .I f a peer i sg oin gt o rec o rd the TV pr o gram  X  X bc1 20080425 200000 X  , i tsh o u l dreg i ster the rec o rd in gatthec oo rd in at o r o fth i s TV pr o gram .T h i sca n be d on eb y the f ollowin g X R P Cca ll: (ii) Distributed Keyword Retrieval. A ssume a S treet TiVo user w a n ts t o search in t o da y X  s n e w scast  X  X bc1 20080425 20-0000 X  , he / she has rec o rded , f o r vi de o fragme n ts that w ere ab o ut the s i tuat ioninTi bet , but the AS Rresu l ts are no t c o mp l ete ly a v a il ab l e (y et )on h i s / her lo ca l mach in e .T he n the search request m i ght be se n tt oo ther S treet TiVo peers that ha v erec o rded the same n e w scast . T he f ollowin gpseud o-c o de first retr i e v es the li st o f fragments fr o mthec oo rd in a -t o r , a n dthe n se n ds a search request t o each peer that own s ( $frags//owner/@host ) the AS Rresu l ts o f a fragme n t : In th i spaper ,w eha v e descr i bed S treet TiVo, a P 2 PIn f o rmat ion Retr i e v a l s y s -tem that e n ab l es n ear rea l-t i me search in vi de o c on te n ts b yj ust us in ge xi st in g vi de o c on te n ta n a ly s i st ool s .

T ha n ks t oi ts i mp l eme n tat ion in ah i gh -l e v e l dec l arat iv e database l a n guage , p l a n t o c o mp l eme n t the curre n tmed i aa n a ly s i s wi th i mage pr o cess in gtech ni ques M a y be e v e n m o re in terest in g i sthat S treet TiVo users ca n a l s o eas ily share the i r own huma n made a nno tat ion s .Fo re x amp l e , pe o p l eusua lly schedu l earec o rd in g se v era l m in utes bef o re / after the start / e n d o fthet o be rec o rded TV pr o gram , t o pre v e n tm i ss in gpart o f the pr o gram .I f j ust on e S treet TiVo user has a nno tated the e x act start / e n dt i mestamp o fthe TV pr o gram , the in f o rmat ion ca n be shared in the p l atf o rm wi th o ther S treet TiVo users w h o ha v erec o rded the same pr o gram , a n dtheu nn ecessar y parts o fthe i rrec o rd in gs ca n be rem ov ed tra n spare n t ly. T he auth o rs wo u l d li ke t o tha n k M ar ijn H u ij bregts f o rcreat in gthe SHoUT AS R t ool k i ts , Er win de Mo e l f o rde v e lo p in gtheG UI f o r Win d ow s Vi sta M ed i aCe n ter , H e nnin gR o de a n d J a nFlo kstra f o rthe i rc on tr i but ion t oPF/Tij ah , a n d Ni e l s N es ,M atth ij s Mo ur i ts a n dR o bert o C o r n acch i af o rthe i rhe l p in o rga ni z in gthe c on tract BSIK 03031.

