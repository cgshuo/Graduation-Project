 1. Introduction
Electronic Health Record (EHR) system is patient-centered information resource supported by computer software and hard-ware infrastructure. In the clinical workflow, EHR system facil-itates the archiving and communications of clinical information of each patient throughout the episodes of care. More than a data repository of digitized health records, EHR system provides core functionalities in eight categories, including electronic health information/data capture, order entry/order management, results management, administrative processes, electronic connectivity, clinical decision support (CDS), health outcomes reporting and patient support ( Institute of Medicine and Board on Health Care
Services, 2003 ). Among these eight categories, clinical decision support enhances clinical performance by adopting computer software applications to generate information items, such as drug alerts, other rule-based alerts, reminders, clinical guidelines and pathways. With the clinical decision support (CDS) tools, EHR system can effectively support the patient care and reduce the cost, time and errors in clinical workflow ( Morris, 2005 ). Since the idea of CDS has first emerged, a lot of research endeavors have dedicated to the research and development of tools, methods and approaches for pattern discovery and predictive analysis. Some of those research studies explored the associations between diag-noses based on datasets of collected health records. IBM X  X 
HealthMiner and Molecular Concept Map (MCM) are two exam-ples of data mining tools, which have been successfully applied in two different research studies to identify the related diagnoses among the health records ( Mullins et al., 2005 ; Hanauer et al., 2009 ). Another research study investigates a method for selecting the threshold of Chi-square test in analyzing co-occurring fea-tures, such as disease, finding and medication, of a large dataset of discharge summaries ( Cao et al., 2007 ). These tools are very important and useful for the clinical experts to gain insights of disease patterns and linkages from the large EHR database.
Besides CDS, clinical trials require the database retrieval of relevant cases for subject recruitment. A concept-based document search engine was implemented with an EHR system and eval-uated through a retrospective clinical-epidemiological study tar-geting syphilis cases ( Schulz et al., 2008 ). A research study proposed a sequence alignment strategy for finding patients with similar treatment histories in the temporal order of drugs given to the patients ( Lee and Das, 2010 ). The approach could be useful for treatment cohort identification in clinical trials. 1.1. Motivation have been well developed, identifying similar health records based on similarity in disease pattern becomes a novel topic and growing research area in CDS. In some stages of clinical decision making processes, uncertainty exists and it is difficult to model the relevant medical domain knowledge in logical repre-sentations like rules. The similar health records retrieved using similarity matching algorithm are more concrete and convincing for medical experts to express their domain knowledge on particular disease patterns than the rule-based representation ( Kong et al., 2008 ). For this reason, case-based reasoning approach presents similar health records to the clinicians as suggested solutions in many CDS applications, e.g. stress diag-nosis based on finger temperature signals. To achieve the desired matching, the biomedical features were appropriately selected for those similarity matching algorithms based on the a-priori medical knowledge. For example, age, gender, room temperature, hours since meal, food and drink taken and finger temperature were considered as features for matching patients on similar stress level. Better goodness-of-fit can be attained when the parametric similarity measure is learnt through the adjustment of weights by domain experts or using the empirical data ( Begum et al., 2009 ).
 atherosclerosis, the etiology and underlying mechanism have not been completely known and clearly explained. The feature selec-tion is not feasible as there are only a few variables that have significant association with the subclinical disorder and the association is usually very weak. An example of such variable is
C-reactive protein (CRP). It was demonstrated in recent research studies that the elevation of CRP indicates increased risk of atherothrombotic events. However, it was shown in a large cross-sectional study that CRP is weakly associated with the manifestations of prevalent atherosclerosis, such as the intima-media thickness and ankle/brachial blood pressure index ( Folsom et al., 2001 ). As all the available features are considered, a large dataset is required to train the parametric similarity measure.
Otherwise, the trained measure may not be so accurate to match similar patient records. Therefore, non-parametric similarity measures are considered in this study.
 ing Euclidean distance (ED) and direction cosine (DC) ( Qian et al., 2004 ). ED takes into the account the lengths of two vectors and the angle between them but DC depends on the deviation of vector direction only. Two similar health records retrieved based on DC could be very different in content. On the other hand, ED involves higher computational load than DC because ED considers all the vector components but DC needs not compute the zero-valued vector components, which are very often observed in the information retrieval applications. Combining the properties of
ED and DC may yield a similarity measure addressing both precision and computational load issues. Further, the application of supervised machine learning approach could enhance the performance of these similarity measures through the relative weights of feature terms estimated by the training dataset. 1.2. Research questions
In this study, all the available disease terms in the health records are considered as the features and non-parametric simi-larity measure is used because most of the current EHR search engines are generally used for searching health records subject to any possible desired clinical terms and these tools were devel-oped based on simple string matching of clinical terms. Thus, it is intuitive to hypothesize that a non-parametric similarity measure is a random scoring system in the agreement of a subclinical disorder between two patients. To cope with the randomness, the semantic relationships defined by medical ontology may help to estimate the closeness between patients of interest. Such kind of closeness, referred to as  X  X  X linical distance X  X , was estimated by the semantic distance of the  X  X  X inimal-cost X  X  path in the ontology ( Melton et al., 2006 ). As medical ontology can be used to align the synonymous and related clinical terms to unique concepts and form the feature space for the similarity measure, the likelihood of a common subclinical disorder found in two patients may be reflected by the similarity score based on medical ontology. To test the hypotheses for simple string matching and medical ontology, this study is aimed to examine whether the degree of similarity between two health records is associated with the subclinical disorder agreement between two patients, for the similarity measures based on simple string matching and medical ontology respectively. Further, a modified version of DC, referred to as mDC, is proposed in this paper and its performance in ranking the subclinical disorder agreement between two patients will be compared with that of ED and DC. This study is also aimed to examine whether the mDC outperforms the DC and ED in the estimation of patient similarity in terms of atherosclerosis. The implementation of the ontological model using machine learning approach will be also evaluated against the identification of subclinical disorder in the test dataset. 1.3. Core contribution and novelty of the work
Atherosclerosis is a major cause of cardiovascular disease (CVD). The American Heart Association (AHA) reported that no previous symptoms were observed in 50% of men and 64% of women who died suddenly of coronary heart disease (CHD) ( Lloyd-Jones et al., 2009 ). Therefore, there is a need for search engine, which can retrieve similar cases from EHR system to provide concrete evidence for assessing the CVD risk of the asymptomatic individuals of interest. Once the above-mentioned research question is answered, it will bring out the potential of a medical-ontology-based search algorithm for identifying patients with similar CVD risk which is unlikely achieved by the current approach of simple string matching. From this study, the ontol-ogy-specific feature space and the derived similarity measure thereof will lead to a search engine, which will act as a simple, non-invasive and inexpensive tool to present similar cases to clinicians during consultation of asymptomatic patients. If the similar cases are already of CVD, the cases could be the evidence for predicting the future of the patients of interest and justifying the early intervention and prevention.

As a diabetic complication, atherosclerosis and its related information are not commonly documented in clinical practice. A study in southwest London showed that all of 17 participating general practices input the codes of cardiovascular risk factors, including urine protein, blood pressure, serum cholesterol, dietary advice given and diabetes mellitus, in the health records, but only one of them input the code of Framingham cardiac risk score (the chance of developing cardiovascular disease within a certain number of years) and three and nine of them input the codes of diabetic retinopathy and neuropathy respectively ( Gray et al., 2003 ). Thus, there is a lack of clinical information or coding about the diabetic complications in the health records and it spotlights the limitation of simple string matching in the retrieval of cases with diabetic complications. On the other hand, medical ontology has good potential for linking related concepts like hypertension and atherosclerosis and is superior to simple string matching in digging undocumented subclinical disorders from EHR system. The proposed search engine and findings of this study could be used as a reference for the future development of the case-based CDS for diabetes management.

Ontology vector models have been widely applied to more information retrieval applications. Two classic similarity mea-sures, ED and DC, have their own pro and con in terms of the computational load and precision. This paper suggests a new similarity measure, mDC, which conserves the advantageous properties of ED and DC. Fast and precise retrieval can be achieved by using mDC. 2. Background and related work 2.1. Local and worldwide context of EHR use In Hong Kong, the EHR system of the Hong Kong Hospital Authority (HKHA), called electronic Patient Record (ePR), is one of the world X  X  largest integrated longitudinal EHR ( Cheung et al., 2007 ). The common use of EHR focuses on the longitudinal study of the clinical history of the concerned patient. The exploration of the similarity or difference between patients may be useful for providing useful information for clinical decision support. The inter-patient similarity measures assess the degree of closen-ess between patients or cases in a database so as to discover analogous cases, such as those patients who qualify for an experimental oncology chemotherapy protocol ( Melton et al., 2006 ). Except for health policy purposes, it is rare to find research studies looking into the patterns and associations among the patient records. The EHR database is still an under-explored valuable resource that has archived a variety of cases with complete recovery, good prognosis, medical errors or ineffective treatments. Despite the popularity of simple string matching, EHR search engine finding the conceptual linkage between patients would play a more important role in supporting patient care, because the retrieved records are not only the demographic data of particular patients but also refer to concrete concepts such as  X  X  X heir parts, diseases, therapies and lesions X  X , which can be used as references for the health care professionals to make diagnosis and plan treatment ( Ceusters and Smith, 2006 ). The superior perfor-mance of the search algorithm based on conceptual linkage has been demonstrated in the information retrieval over a large document repository on the World Wide Web ( Castells et al., 2007 ).
 The success of search engines, like Google, in searching World Wide Web contents sheds light on the potential of search engines for EHR. Researcher developed the Electronic Medical Record Search Engine (EMERSE) for retrieving health records for research and data abstraction ( Hanauer, 2006 ). The contribution of a search engine is to provide a rapid method for patient history review with retrospective chart so that the events of interest could be easily noted. 2.2. Medical terminologies and ontologies
Nowadays, more systematic medical terminologies and stan-dard codes are provided to the health care professionals during their input, update and review of the patient records so that the data contained in these records become more objective and consistent, with less variability in terminologies and data entry habit among professionals. In Sweden, general practitioners use the
International Classification of Disease (ICD) as a tradition for diagnostic labeling in the EHR ( Nilsson et al., 2000 )andalarge proportion of problems are coded in general practice in Stockholm where the completeness (number of codes per problem  X  0.9) and correctness (97.4%) of diagnostic codes are high ( Nilsson et al., 2003 ). A study in Norway revealed that the mean precision of record retrieval, i.e. the proportion relevant to a particular concept of all retrieved EHR elements, was 100% for manual semantic tagging and 37% for string matching ( Mikkelsen and Aasly, 2002 ).
In the United Kingdom, general practitioners in primary care currently code clinical problems using Read codes developed in the 1980s to ensure the construction of accurate disease registries ( Gray et al., 2003 ). Among medical ontologies, Systematized
Nomenclature of Medicine Clinical Terms (SNOMED-CT) has been widely adopted as a standard for formulating medical concepts. In the 2010 international release of SNOMED-CT, more than 291,000 active concepts are included and the descriptions of these concepts are over 758,000. The concepts are organized into hierarchies, in which 823,000 relationships enable the consistency of data retrie-val and analysis. The breadth of SNOMED-CT terms and concepts were evaluated in a study through the clinicians X  coding of diagnosis and problem lists within a computerized physician order entry (CPOE) system in the United States, resulting in 98.5% concept coverage ( Wasserman and Wang, 2003 ). Another study examined whether the clinical information retrieval at an electro-nic medical record data warehouse is simplified by leveraging the knowledge built into the hierarchical structure of SNOMED-CT and the results showed that the recall of SNOMED-based record retrieval, i.e. the proportion retrieved of the EHR elements relevant to a particular concept, was greater than 89% ( Lieberman et al., 2003 ). Besides the classification of terms, SNOMED-CT incorporates concepts of entities on the ontological view. The entities include universals, kinds, attributes or properties in the world ( Smith, 2006 ). With linkages between entities, concepts provide more accurate and substantial representation of entities than the codes and semantic tags only. However, there exists an ontological issue from the perspective of SNOMED-CT that the same entity, e.g. colon polyp, can result in different codes on successive clinical visits, e.g. intestinal polyp, polyp and malignant neoplasm of colon ( Ceusters and Smith, 2006 ). Though some search engines may facilitate wild card function and logical operators to formulate the query statement, the simple string matching cannot identify the association of two terms that are completely different in wording but conceptually related (e.g. heart disease and cardiac arrhyth-mia). A combination of string-based and tag (concept)-based retrieval yielded 95% mean recall of relevant records in contrast to 54% using string-based model ( Mikkelsen and Aasly, 2002 ). 2.3. Semantic relationships using SNOMED-CT
SNOMED-CT defines semantic relationships including an extensive  X  X  X s-a X  X  and  X  X  X nverse-is-a X  X  structures. Through these defined relationships, the relative closeness between two con-cepts in a record is measured by  X  X  X dge counting X  X  the semantic distance along the connecting path in the ontological hierarchy ( Knappe et al., 2007 ; Melton et al., 2006 ; Petrakis et al., 2006 ;
Slimani et al., 2006 ; Zhang et al., 2007 ) and the clinical distance, the closeness between patients of interest is obtained by taking the semantic distance of the  X  X  X inimal-cost X  X  path ( Melton et al., 2006 ). The path-length measure is a mathematical representation of semantic measure defined as the inverse of the node number on the shortest path between two concepts and the adaptation by
Leacock and Chodorow (1998) further scales the shortest path length by the maximum depth attained by the concepts of interest in the hierarchy ( Pedersen et al., 2007 ; Knappe et al., 2007 ; Zhang et al., 2007 ). The edge counting method has been applied to PubMed document clustering and the performance was comparable to the alternative methods ( Zhang et al., 2007 ), such as information content based measure associating the probabil-ities with concepts in the ontology ( Lord et al., 2003 ; Petrakis et al., 2006 ). 2.4. Sub-ontology extraction for specialization area covering the domains of interest. In the medical applications, the analysis of medical data is commonly specialty-specific and the usage of a medical ontology is limited to a subset of the entire meta-data. A sub-ontology view extraction approach was pro-posed for semantic profiling for particular specialties and the process is referred to as Materialized Ontology View Extraction (MOVE) ( Bhatt et al., 2009 ). The application of MOVE contextua-lizes the user X  X  specialization area on the types of terms (con-cepts) so that the semantic range is significantly reduced to form the sub-ontology or partial views of the ontology of interest. records using medical ontology, the occurring terms or concepts will be very few or none if the semantic range is narrowed. As the application of MOVE for matching patients with atherosclerosis could limit the sub-ontology to the taxonomy branches like cardiovascular disease and hypertensive disease, the extracted sub-ontology may not cover some related concepts like disorder of soft tissue and inflammatory disease. The calculated similarity score may not reflect the agreement of atherosclerosis between two patients. 2.5. Application of gene ontology for searching biomedical literature cal articles annotated with the terms from the Medical Subject Headings (MeSH) controlled vocabulary. To respond to a query, PubMed search engine matches the query term with the articles X 
MeSH terms and their descendants in the hierarchy and returns all the matches to the user interface. Currently, over 20 million articles are indexed by PubMed and a query may return hundreds or even thousands of matches. With the support of PubMed search interface, the matches can be sorted by first/last author, title and publication date/venue. However, some relevant articles might be published a few years ago and their author names, titles and publication venues may not reflect the articles X  relevancy. The relevant or desired articles may be moved to the end of the query result by PubMed search interface, limiting its usefulness in literature search. To provide a better solution, GoPubMed is a web-based search engine, which relays query keywords to
PubMed, extracts gene ontology (GO) terms from the query results of the matched abstracts and allows users to browse the induced ontology for desired abstracts ( Doms and Schroeder, 2005 ). The induced ontology is a minimal subset of GO derived from the GO terms extracted from the retrieved abstracts. The tool provides the users with a query-specific taxonomy for further specifying the query, instead of a list of abstracts ranked by the frequencies of the terms occurring in PubMed. GoPubMed demonstrated that the documents deeply hidden by the PubMed-sorted matches can be explored easily through the application of medical ontology. This statement is also applicable to the retrieval of health records similar to a query record. There may be hundreds or even thousands of health records matched with a query record accord-ing to the associated disease terms, especially in hospital clusters or regional health enterprises. If the matched health records are sorted by the patient name, age, clinician name or admission date, the agreement of subclinical disorder between the patients of the top matches and the query may be less likely observed. Ranking the health record pairs by similarity measure based on medical ontology could feature particularly those patients with the same subclinical disorder. 2.6. Vector model
With a well-established term set, such as medical ontology, the vector (space) model offers simple parallel evaluation of similarity between queries and documents through the construc-tion of the query and document vectors, in which every single term in the term set is weighted with zero if is not present in the query/documents, otherwise, with positive number reflecting the relative importance in the query/documents ( Salton and Buckley, 1991 ; Salton, 1991 ). Given a query of weighted terms for identifying similar documents in a repository indexed with weights of the same term set, the inner product between the normalized elements of the query and document vectors ranks the query-document similarity and returns those documents above the similarity threshold in decreasing order of ranks. The update of query and document vectors is easy for query reformu-lation, document changes and other purposes due to the intuitive vector mathematics. The similarity can be quickly computed because there is most likely a substantial number of zeros in the query and document vectors, like  X  X  X oolean retrieval X  X , elim-inating a large amount of numerical operations. Such classic vector model has been applied to the information retrieval over a large document repository on the World Wide Web ( Castells et al., 2007 ). The Term Frequency-Inverse Document Frequency (TF-IDF) algorithm was used to compute the weights of the vector automatically. The similarity measure between the query and a document is computed as the direction cosine of their respective vectors. It was shown that a combination of ontology and key-word search gave the best performance in terms of precision versus recall for 20 queries to a corpus of documents from CNN
Website. 2.7. Similarity measures
Once the ontological vectors are obtained, the closeness between two patients can be quantified by a score generated by a mathematical function of the two vectors, called similarity measure. There are many different choices of similarity measures and the appropriate choice is of considerable importance to applications, such as pattern classification, clustering and infor-mation retrieval ( Cha, 2007 ). Euclidean distance (ED) and direc-tion cosine (DC) are two similarity measures commonly used for ranking relatedness in the vector model due to the simplicity in computation. These two measures achieved very similar level of recalls and precisions in content-based image retrieval ( Qian et al., 2004 ). ED is grounded on the fact that the shortest geometric distance between two points is a straight line. ED compares both the lengths and directions of two vectors. The comparison is very stringent because the two patients are con-ceptually the closest if and only if the ontological vectors are the same, i.e. the patients have the same diseases. DC was widely adopted in automatic text retrieval as it ranks the similarity according to the angle between two vectors only ( Salton, 1991 ). The patients with different diseases could be ranked with the maximum of DC, i.e. unity, if the ontological vectors are pointing at the same direction. DC is still very popular because it consumes less computation resource than ED due to the fact that the zero vector elements are not involved in the calculation of DC while ED takes into the account all the vector elements. 3. Material and methods
In this study, similarity measure is regarded as a rater for comparing the query health record and a database health record. It is assumed that both health records contain disease terms that can be mapped to unique concepts in medical ontology. The database health records are already stored in the data repository of EHR system. The query health record belongs to the patient of interest in the consultation and based on which the clinician requests for similar health records as references for supporting the clinical decision making. Fig. 1 shows the examples of the query health record (query EHR in step 1) and a retrieved database health record thereof (retrieved EHR in step 3) and illustrates how a search algorithm ranks the database health records through the scores generated by a similarity measure (health record list sorted in the descending order of similarity score). 3.1. Ontology vector model
SNOMED-CT, the ontology used in this research work, was developed by the College of American Pathologists and now constitutes part of the Unified Medical Language System estab-lished by the National Library of Medicine (NLM) ( Pedersen et al., 2007 ). The researchers of this study have been offered an affiliate license of UMLS (license code: 23044A180) for academic use since 1 July 2007. Tree structure of SNOMED-CT hierarchy is illustrated in Fig. 2 , demonstrating the  X  X  X s-a X  X  relationships between terms extending from root to two sample diseases, type II diabetes and cardiac arrhythmia. The terms of SNOMED-CT are organized into levels and connected with  X  X  X s-a X  X  links. Root is at level 0 and the terms connected to root are at level 1. The  X  X  X s-a X  X  links direction-ally map terms from one level to the next level based on the semantic relationships. No  X  X  X s-a X  X  links can be drawn from one level to the same or previous level. For example, there is a  X  X  X s-a X  X  link from  X  X  X isorder of digestive system X  X  to  X  X  X isorder of pancreas X  X  as disorder of pancreas is subsumed into the disorder of digestive system, however, there should not be any  X  X  X s-a X  X  link between terms at level 4, say  X  X  X isorder of digestive system X  X  and  X  X  X inding of trunk structure X  X .

As the natural language processing is not a focus of this work, the free text disease terms were converted to SNOMED concepts manually. Therefore, the health records, irrespective of the type of database records or queries, are indexed with the SNOMED-CT terms, referred to as  X  X HR terms X  in this paper. The proposed ontology vector model considers a set of feature terms at fixed level of the  X  X  X s-a X  X  hierarchy, which makes up a feature space. For example, the feature term set consists of  X  X  X isorder of digestive system X  X ,  X  X  X inding of trunk structure X  X , etc., if level 4 is considered as the pre-defined feature space. Let f i , m , d j and n be the i th feature term, the number of terms in the feature space, the j th
EHR term and the number of terms in the health record, respectively. The semantic distance between f i and d j is denoted by s ij A [0, N ] and the value is measured according to the following rules: (A) If d j is the descendant of f i in the SNOMED-CT hierarchy, then s ij is the number of  X  X  X s-a X  X  links from d j to f i . (B) If d j is not the descendant of f i , then s ij  X  N . (C) If d j is the same as f i , then s ij  X  0.

Consider the term  X  X  X ype II diabetes X  X  as an example and level 4 terms as the feature space. As illustrated in Fig. 2 , the semantic distance between  X  X  X ype II diabetes X  X  and the feature term  X  X  X is-order of digestive system X  X  is 4 because there are four  X  X  X s-a X  X  links from Type II diabetes to  X  X  X isorder of digestive system X  X . The semantic distance between  X  X  X ype II diabetes X  X  and the feature term  X  X  X inding of trunk structure X  X  is infinity because  X  X  X ype II diabetes X  X  is not the descendant of  X  X  X inding of trunk structure X  X .
Note that this is just an example to illustrate the calculation of semantic distance between two concepts and it does not mean that  X  X  X ype II diabetes X  X  is not related to  X  X  X ardiac arrhythmia X  X . In fact, there is another branch expanded from  X  X  X inding of trunk structure X  X , along which the leaf  X  X  X ype II diabetes X  X  can be reached.
That branch is not shown in Fig. 2 for simplicity. The feature vector, v , is a linear array of m  X  102 elements given by the following expression: v  X  X  a 1 a 2 ... a m g 1 g 2 e 1 e 2 ... e 100 T  X  1  X  where g 1 and g 2 are Boolean variables for female and male respectively; e k is Boolean variable for age  X  k A [1,99], except e 100 for age Z 100; a i is the weight of term f i with respect to an
EHR, represented by { d j 8 j A [0, n ]}. The element a i using the following formula: a  X 
The value of a i , quite similar to the path-length measure ( Pedersen et al., 2007 ), projects the health record onto a feature term. It weighs those relevant feature terms with positive values and those irrelevant feature terms with zeros in the feature vector. Thus the feature vector comprises of a vast majority of zeros and a small number of non-zeros, providing a discriminative fingerprint of the health record. Gender and age are included in the feature vector because they are also contributing factors of many complications.
 3.2. Similarity measures: ED, DC, mDC
Through the alignment of EHR terms to the medical ontology, an ontological vector can be generated to each patient. It is natural to hypothesize that those diabetic patients having similar disease profile (and thus similar ontological vectors) will be subjected to similar risk of cardiovascular diseases. Therefore, the similarity measure of ontological vector could link similar patients together with respect to the degree of cardiovascular risk. For ontological vector model, three types of similarity measures are considered in this study. The detailed descriptions are given as follows. 3.2.1. Euclidean distance (ED) The shortest distance between two vectors represents the Euclidean distance ED, given by the following formula: d
ED  X  9 Q D 9  X  3  X  where Q and D represent the ontological vectors of two health records; The distance is zero if both vectors are identical. Other-wise, it gives a positive value, increasing with the geometrical distance between two vectors. The similarity measure based on ED is given by the following formula: sim ED  X  Q , D  X  X  1 3.2.2. Direction cosine (DC)
The similarity score between the two ontological vectors, denoted by, sim DC ( Q , D ), is a kernel function computed as the direction cosine between their feature vectors ( Salton, 1991 ), given by the following formula: sim DC  X  Q , D  X  X  Q U D 9 Q 99 D 9  X  5  X  where Q and D represent two ontological vectors; is the inner product between two vectors; and 9 . 9 is the geometric vector length. 3.2.3. Modified direction cosine (mDC)
The similarity score between the two ontological vectors, denoted by, sim mDC ( Q , D ), is a kernel function computed as the direction cosine between their augmented feature vectors, given by the following formula: sim mDC  X  Q , D  X  X   X  Q , 1  X  U  X  D , 1  X  9 Q , 1 99 D , 1 where Q and D represent two ontological vectors; is the inner product between two vectors; and 9 . 9 is the geometric vector length. The feature vectors are augmented by appending a unity element. 3.2.4. Properties of mDC
Unlike DC, mDC does not have the problem of numerical overflow when Q or (and) D is (are) zero vector(s). If Q is zero vector, mDC can be simplified by the following formula: sim mDC  X  0 ! , D  X  X  1 9 D , 1 9  X  7  X  It is easy to observe that the value of (7) is always nonnegative. If neither Q nor D are zero vectors, Eq. (6) can be rewritten by the following formula: sim mDC  X  Q , D  X  X  where y is the angle between Q and D , always lying within [0, p /2] as the vector elements are nonnegative. Thus, mDC is always nonnegative. According to (8), mDC is equal to zero when y is equal to p /2, the length of one vector is positive and the other X  X  length tends to infinity. This agrees with the property of ED under the condition that two points are very far apart in the coordinate system.

When two feature vectors Q and D are equal, their lengths are equal and the angle y is 0. The value of mDC reaches 1, the maximum of Eq. (8), if and only if the condition, Q  X  D , is satisfied.
ED also attains its maximum if and only if the same condition is satisfied. This property makes mDC perform better than DC and similar to ED. 3.3. Scoring and search algorithm for CDS
The query EHR can be compared with every single EHR in the database according to this similarity score and the retrieval output can be selected subject to a threshold of score and ranked with the score values. Fig. 1 shows a flow chart demonstrating the conceptual interactive search engine empowered by the proposed ontological vector model.
 The list of the relevant health records provided in step 2 of
Fig. 1 indicates the confirmed diabetic complications. In this example, the most similar patient (with rank #1) is confirmed to have carotid atherosclerosis and thus the patient Q (with the query EHR) may have plaques at the carotid arteries with a chance reflected by the score 0.4608. Carotid ultrasound exam-ination could be suggested to the patient Q though the score is not too high. Further, the similarity is expected to be valued around the middle of the range (i.e. 0.5), leading to a narrow range of similarity values. It is because no two patient records are exactly the same or completely different, especially for those in the same
EHR database or from the same medical consultation center. 3.4. Data collection and analysis To test the hypothesis, a dataset was collected from 47 subjects in
Hong Kong. All were Type II diabetic patients, aged 46 X 62 years, non-smokers and with no record of stroke or coronary heart disease.
Human ethics approval and informed consent were obtained before data collection. This study did not retrieve any health records of these subjects from EHR databases because most of the subjects were consulting doctors at different private clinics and it was difficult to obtain their health records directly due to the resistance from the private clinics. Instead of direct retrieval, data items that are com-monly stored in health records were collected from the subjects through questionnaire survey. Ea ch subject completed a question-naire, which collected information including age, gender and medical history with disease terms. A research assistant graduated from medical school advised the subjects in completing the questionnaires, curated the collected data items and coded the disease terms with concept IDs of SNOMED-CT. An ultrasound examination of the carotid arteries of each subject was also performed. A radiologist confirmed the presence or absence of carotid plaque for each subject. This confirmed manifestation of vascula r abnormality was regarded as the reference value to verify the similarity between any two subjects. The diseases shown in the medical history became the EHR terms and then the feature vector of each subject (health record) was computed based on the SNOMED-CT  X  X  X s-a X  X  hierarchy. Based on such taxonomy, a feature vector was generated for each health record. Totally, 47 feature vectors were ge nerated. The similarity measure is a pairwise rater for comparing any two health records (any two feature vectors). The number of pairwise similarity scores is therefore given by
N ( N 1)/2  X  47(47 1)/2  X  1081 for all pairwise combinations of 47 subjects. There were totally 1081 pairs of feature vectors (health records). Between each pair of healt h records, a similarity score was obtained using the similarity measure. For simple string matching, the  X  X  X atching score X  X  is simply given by the number of co-occurring terms in a pair of health records. For the query EHR and the retrieved
EHR shown in Fig. 1 , only the concept  X  X  X iabetes Mellitus, Non-insulin-Dependent X  X  and gender  X  X  X emale X  X  co-occur in both health records and thus the similarity score is 2 using simple string matching. Note that the similarity score using simple string matching is not bounded by one and its value cannot be directly compared with that using ontological vector model.
 ontological vector model using ED, DC and mDC, and the simple string matching were compared with respect to the accuracy in matching subjects with or without t he carotid plaque based on their scoring approaches. The health record pairs for all subjects were sorted in ascending order of the sim ilarity scores. A threshold value between the minimum and the maximum values of the score was set amid every two consecutive sorted scores to generate the true positive rate (sensitivity) and the false positive rate (1-specificity) based on the ranking collated with the sorted reference value of similarity. The ROC curve was drawn by plotting the true positive rate against the false positive rate for all the threshold values. The empirical area under the ROC curve (AUROC) was estimated using trapezoidal rule. Wilcoxon statistic was exploited to estimate the standard error (SE) of AUROC, indic ating the sampling variability for the null hypothesis  X  X  X rue area  X  0.5 X  X  ( Hanley and McNeil, 1982 ). The asymptotic 95% confidence interval (CI) was given by [AUR-
OC 1.96 n SE, AUROC  X  1.96 n SE]. The performance of the ontological vector model and the simple string matching was tested against the criterion that the empirical AUROC was significantly different from 0.5, implying that the model is not randomly rating the health record pairs. 3.5. Ontological model implementation using support vector approach random rater of health record pairs, it can be implemented to identify patients potentially with subclinical disorder. Direct application of the above-mentioned similarity measures may not yield good performance for case retrieval because the relative importance of each feature term cannot be reflected by the non-parametric dot product or Euclidean distance. Supervised machine learning approach was applied to implement the onto-logical model. support vector (SV) classifier would be a suitable parametric model to accommodate the a-priori weighting subject to the relevancy of the feature terms ( Vapnik, 1995 ). The SV approach makes use of the Lagrange multipliers, nonnegative real numbers, and a training dataset is required to obtain the values of the Lagrange multipliers through the constrained minimization.
The resultant model of the SV classifier is a linear regression function of the pre-defined kernels plus a bias. The kernels are, for the proposed vector model, simply the dot product of the feature vectors of a health record in the tra ining dataset and the health record of interest, satisfying the Mercer X  X  condition ( Chan et al., 2001 ). The classifier F (.) is given by the following equation: F  X  Q  X  X  where N is the size of training dataset; a i and a i are the Lagrange multipliers and b is the bias; D i isthefeaturevectorofthe i th health record in the training dataset; K ( Q , D ) could be a kernel defined by the following expression: K  X  Q , D  X  X  Q U D  X  10  X 
If Q and D are feature vectors already normalized with their vector lengths, this kernel is equivalent to the similarity score used in this study. It is easy to observe that the classifier function
F (.) is simply a linear combination of the similarity score between the feature vectors of each health record in the training dataset, D , and the health record of interest, Q . The classifier will give a positive (negative) value to indicate the health record of interest is positive (negative) case according to the knowledge learnt from the training dataset. By replacing the kernels in the classifier with the dot product of feature vectors, we can obtain an alternative representation of the classifier as given below: F  X  Q  X  X  Q U
From this representation, each feature term is associated with a weight, specifying the relevancy of the feature term to the reference similarity value of interest according to the training dataset. This set of a-priori weights is formed by the vector elements of the following linear combination of Lagrange multi-pliers and feature vectors of health records in training dataset
The support vector classifier could be nonlinear when we consider kernels, such as polynomial, B-spline and radial basis functions (RBF), instead of linear kernel, i.e. dot product. In this study, Bioinformatics toolbox of Matlab s was used to construct the SV classifier. With randomization, feature vectors and the corresponding atherscolerosis labels of 32 subjects form the training dataset and the rest form the test dataset. After the SV classifier was trained, its performance on the test dataset was evaluated by the accuracy, precision and recall. 4. Experimental results Levels 1 X 4 were considered individually as the feature space.
Of 47 health records, the feature vectors were computed. Con-sidering level 4 as the feature space and two health records mentioned in Fig. 1 , Tables 1 and 2 illustrate how the EHR terms are projected to the feature terms through the semantic distance given by Eq. (2) and the calculation of their feature vector elements (except those elements for gender and age). It was found that patients Q and A have, respectively, 22 and 23 non-zero feature vector elements only but there are totally 6964 feature terms at level 4. In the calculation of similarity score between them, we need to consider the co-occurring non-zero elements, which involved 12 feature terms only. Table 3 shows the alignment of the two feature vectors (including the elements for gender and age as well). The data obtained from these two subjects yielded a similarity score 0.4608 after taking the direc-tion cosine of the two feature vectors. Both subjects had carotid plaques as confirmed by ultrasound examination and thus this pair of patients (health records) was determined as relevant and labeled by a dichotomous value 1 as the reference value of similarity. If both subjects had no carotid plaques, the pair was also determined as relevant and labeled by a dichotomous value 1 as the reference value of similarity. If either of the subjects had carotid plaques, the pair was determined as irrelevant and labeled by a dichotomous value 0 as the reference value of similarity.
The similarity and matching scores of 1081 health record pairs were checked against the reference values of similarity. The scores were sorted in ascending order and the true positive and the false positive rates were obtained for each threshold. After the construction of the ROC curves, the AUROCs and the correspond-ing asymptotic 95% CIs were calculated and shown in Table 4 . The results showed that the exact matching was a random rater in evaluating the similarity in terms of carotid plaque presence as the AUROC is not significantly different from 0.5. The proposed vector model at any considered ontological level demonstrated a non-random rater of health record pairs in term of carotid plaque identification as the AUROC was significantly greater than 0.5. The ontological vector model at the SNOMOD-CT level 4 yielded the highest accuracy for ranking the agreement of carotid plaque identification in subject pairs. The AUROCs are 0.578, 0.587 and 0.584 for DC, ED and mDC, respectively.
 the ontological model to identify patients with the same sub-clinical disorder. The SV classifiers with linear kernel, RBF kernel and 3rd order polynomial kernel were trained and tested. It was found that both classifiers with linear and RBF kernels gave 0% precision and 0% recall. On the other hand, the classifier with 3rd order polynomial kernel yielded 50% precision and 25% recall and the overall accuracy was 73.3%, which is much higher than 58.4%, the AUROC attained by mDC. The performance justifies the implementation of the ontological model by SV classifier. 5. Discussion 5.1. Implications of findings
The findings of ROC analysis revealed that the simple string matching paired up  X  X  X imilar X  X  health records by chance, but the ontological vector model acted as a non-random rater with respect to the agreement of carotid plaque identification between two subjects. The example of the two subjects shown in Fig. 1 , explained the difference between two approaches. It was found that only two items,  X  X  X iabetes Mellitus, Non-Insulin-Dependent X  X  and  X  X  X emale X  X  were exactly matched when comparing patients Q and A . The similarity score generated by simple string matching is equal to 2. The value was relatively low as carotid plaques were confirmed in these two subjects. The unmatched EHR terms, such as  X  X  X ypertensive disease X  X  and  X  X  X hest pain X  X , are also related to diabetic complications but the simple string matching cannot reflect the importance of these terms. On the other hand, the ontological vector model provided a more complete fingerprint-ing of the health record, as illustrated in Tables 1 X 3 . Although the terms  X  X  X ental caries X  X ,  X  X  X ingivitis X  X  and  X  X  X ronchitis X  X  of patient Q were not verbally matched with  X  X  X ypertensive disease X  X ,  X  X  X rozen shoulder X  X  and  X  X  X ritis X  X  of patient A, these terms triggers the feature terms  X  X  X inding of head and neck region X  X ,  X  X  X isorder of head X  X ,  X  X  X isorder of soft tissue X  X  and  X  X  X nflammation of specific body structure or tissue X  X  at the SNOMED-CT level 4 and contributed considerable portion of the similarity score. The relatedness of these features to the atherosclerosis at the carotid arteries explained why the similarity score generated by ontological vector model can rate the likelihood of carotid atherosclerosis occurring in a subject pairs. Such relatedness can be explained by the findings of the clinical and epidemiological studies that inflammation and its markers play a very important role in the pathogenetic mechanism in atherosclerosis ( Pearson et al., 2003 ). Moreover, in the medical concept, the carotid arteries at the neck region are responsible for the blood supply to the soft tissue of the head region. That X  X  why the feature terms  X  X  X inding of head and neck region X  X  and  X  X  X isorder of head X  X  should be involved in the calculation of similarity score. Therefore, the proposed ontological vector model demonstrated the potential in uncovering subclini-cal manifestation of complications, which have been not diag-nosed or documented in the medical history but can be identified through the similar health records retrieved from the existing EHR database.

The accuracy of carotid plaque identification was the highest for the ontological vector model at the SNOMED-level 4 because level 4 has higher degree of granularity than levels 1 X 3. A study of the inter-patient distance metrics using SNOMED-CT claimed that the usefulness of ontology principles as tools for a particular purpose, is highly dependent of the quality and granularity of the terminology ( Melton et al., 2006 ). This claim is further justified in this study. Therefore, the choice of level for the feature space is essential for developing a promising similarity measure.
Among the three similarity measures, the performance was very close. ED gave the highest AUROC, mDC was at the middle and DC gave the lowest AUROC at any level. It showed the potential of mDC for saving the computational load and at the same time providing better performance than the classic DC. Further, the SV machine learning implementation of the ontolo-gical model was further justified by the highly improved perfor-mance in identifying subjects with atherosclerosis. 5.2. Suggested enhancement of ontological vector model
It is not surprising to get the low AUROC for the ontological vector model because of two main reasons. First, atherosclerosis develops silently through the mediation of multiple risk factors ( Dzau et al., 2002 ). The absence of carotid pl aque in the ultrasound examination does not mean that th ose high-risk subjects will not build up any carotid plaque in the coming years. The reference value of similarity was adopted without the consideration of time at which the plaques were detected, increasing the number of false positives. Second, there exists limitation in this approach as it simply considers some relations such as proximity on the body. When Canonical Clinical Proble m Statement System (CCPSS) is incorporated into the SNOMED-CT hi erarchy,  X  X  X houlder Injury Gun-shot Wound X  X  (C0748662) and  X  X  X rozen Shoulder X  X  (C0311223) are both having  X  X  X s-a X  X  relationships with  X  X  X oint Problem X  X  (C0575044). It implies that a patient had a gunshot wound to the shoulder may be linked to another patient had froze n shoulder but they are less likely having the same subclinical disorder as the causalities of the two terms are completely different. To prevent this problem, the relationships should be weighted according to their causalities. Relationships with the injury should be modulated by smaller weights when the considered subcli nical disorder is atherosclerosis. Third, all the feature terms at th e same level were considered but not all of them are significantly related to the carotid atherosclero-sis, for example,  X  X  X nfection by site X  X  and  X  X  X ower respiratory tract finding X  X . The a-priori weighting of the feature terms could benefit the classification of patients with re spect to the atherosclerotic risk.
The SV classifier achieved such sup ervised learning and the accuracy of the subclinical disorder identi fication was significantly raised. 6. Conclusions
This paper proposes ontological vector model for searching health records in database, which are expected to be similar to the query EHR, with respect to the carotid plaque presence or absence. The medical ontology, SNOMED-CT, was used to form the feature space for fingerprinting the health records. The results showed that the three similarity measures, ED, DC and mDC, for ontological vector model were non-random raters of health record pairs but the scores generated by the simple string matching identified the similar pairs by chance. In other words, the degree of similarity between two health records is associated with the agreement of subclinical atherosclerosis between two patients using the ontological vector model. Though the performance of three measures was very close, the modified direction cosine has several advantages over classic direction cosine and Euclidean distance in terms of numerical overflow and computational load.
Further, support vector classifier could be an enhanced parametric implementation of the proposed vector model to give a weighting of the feature terms with respect to the relevancy of the complica-tion of interest. It was found that the accuracy of carotid plaque identification was significantly improved.
 Acknowledgments
This research is supported by the PolyU internal research funds  X  X  X -PH74: Artificial intelligent modeling of inter-relation-ships between biomarker profile and haemodynamic features of atherosclerosis in Type II Diabetes Mellitus X  X ,  X  X  X -SA33: Sketching a Multi-dimensional Arterial Health Status Map based on Fuzzy Expert System, Health Domain Expertise and Published Relative Risk Findings X  X  and  X  X  X -PC0B: Development of a UMLS-integrated Ontology-based Similar ePR Search Engine X  X .
 References Further reading
