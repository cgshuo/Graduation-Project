 1. Introduction
The main task of anesthesiologist is ensure patient healthy and comfort during general anesthesia, and preparing patient X  X  con-ditions for surgery. In this way, anesthesiologist employs different kinds of drugs such as muscle relaxing drugs, breathing regula-tors, pain killers and tranquilizers. Injecting a certain volume of anesthetic agents during a surgery has been a challenging issue among anesthesiologists ( Orser, 2008 ). One of the main problems is over-sedated, which is due to use of a high volume of the anesthetic agents like isoflurane that finally leads to comma. On the other hand, applying a low volume of such a drug, maintains the patient X  X  state near to the consciousness ( Muncaster et al., 2003 ; Shao-hua et al., 2009 ).

Anesthesiologists control the d epth of anesthesia using clinical symptoms such as blood pressure , heart beat, body movements, oxygen saturation level (SPO 2 ) and breathing. In the short-time surgeries such as cesarean, the mentioned monitoring tools can properly monitor the depth of anesthesia but in long-period opera-tions such as brain, backbone and orthopedic surgeries, the tradi-tional indicators like level of SPO 2 cannot reveal the pain level, which may lead to awaken a patient during these painful surgeries.
To monitor the depth of anesthesia in the long-time painful surgeries, features of electroencephalogram (EEG) have been successfully employed ( Sebel et al., 2004 ). EEG signals can be affected by anesthetic agents like pain killers or tranquilizers, since these drugs try to block the pain receptors that cause to deteriorate the whole integration of neurons activity ( Sebel et al., 2004 ). Thus, the EEG patterns are not only dependent to different levels of anesthesia, but they are also drug-dependent. To over-come these drawbacks, it has been shown that there exist stable
EEG features, which are independent to the anesthetic agents ( John, 2001 ). Hence, these experiments confirm that, the EEG can provide a reliable basis for deriving a measurement of hypnosis ( Stanski, 1994 ).

In general, there are several EEG-based approaches to deter-mining depth of anesthesia. Analyzing the auditory evoked poten-tial (AEP) is used to measure excitability of a patient according to his/her response to the audio stimulus ( Jensen et al., 1996 ;
Litvan et al., 2002 ). In another approach, modern anesthetic depth monitors just use the frontal EEG signal (one channel) to extract the bispectral index scale (BIS) ( Rampil, 1998 ), which decreases monotonically with increasing anesthetic dosage. BIS index con-sists of three different algorithms, which are computed separately.
The resulting values are combined with different weights to construct BIS index. Nevertheless, BIS index has some shortcom-ings; BIS value is highly sensitive to low EEG amplitude ( Sigl and
Chamoun, 1994 ), and also BIS index response to different anes-thetic drugs with various doses is not quick due to BIS-XP monitor delay for calculation (10 s). Using BIS-XP monitoring reduces anesthetic drug usage up to 20% ( Rosow and Manberg, 2001 ), and also reduces intra-operative awareness during anesthesia up to 80% ( Myles et al., 2004 ). Therefore, using this index has some benefits such as reduction of the anesthetic drug usage, soon recovery, etc. BIS index is a patented algorithm with noticeable attention from researcher; therefore, there have been many efforts to extract an efficient index that behave similar to this index ( Rampil, 1998 ).
 The third EEG-based approach is Narcotrend index (Monitor
Technik, Bad Bramstedt), which has been proposed to analyze sleep stages. This method uses Kugler X  X  classification and denomi-nation scheme to classify EEG patterns into different classes ( Kugler, 1981 ). The Narcotrend exhibits stepwise changes during increasing or decreasing hypnotic depth. The Narcotrend is based on multivariate algorithm, and also seems to perform better during emergence than BIS index ( Schmidt et al., 2003 ).
Through the last three decades, a lot of research has been performed to develop an efficient time X  X requency representation of signal ( Garrettetal.,2003 ). In this way, several time X  X requency techniques are designed that each of them is suitable for a specific signal characterization ( Garrett et al., 2003 ; van Steenis et al., 2005 ;
Flandrin, 1999 ). Generally speaking, linear time X  X requency trans-forms such as short time Fourier transform (STFT), wavelet trans-form (WT), packet wavelet and multi-wavelet transform can reveal the frequency content of a signal, in different scales in term of intensity while non-linear time  X  X requency transforms such as
Wigner X  X ille, Choi X  X illiams and smoothed pseudo-Wigner X  X ille distributions reflect the energy dis tribution of a signal in the time X  frequency domain, which suffer from producing of unwanted cross terms ( Hlawatsch and Boudreaux-Bartels, 1992 ). In the following paragraph, some of these app lications are introduced.
EEG signals behave more irregular when state of the brain is changed; consequently, it seems that fractal dimension can be an
Weiss et al., 2009 ). The main weaknesses of fractal-based methods is that, EEG signals have non-uniform and complex fluctuations even in a certain state that lead to determine different fractal dimension values for a certain brain state ( Ma et al., 2006 ). Therefore, fractal dimension methods cannot describe these signals very well ( Ma et al., 2006 ). In addition, multifractal was introduced to measure the irregularity of a signal in different time scales ( Ivanov et al., 1999 ).
This technique was also employed in modeling the energy cascading process in turbulent flows ( Ivanov et al., 1999 ; Meneveau and
Sreenivasan, 1991 ). Moreover, as an application of using the chaos theory in analyzing time series, detrended fluctuation analysis (DFA) was introduced ( Peng et al., 1995 ; Gifani et al., 2007 ; Nguyen-Ky et al., 2010 ) as a method to determine the statistical self-affinity and self-similarity of a non-stationary signal. It is useful to detect a long-range correlation in a long signal, like EEG signal during anesthesia.
However, DFA avoid detecting long -range correlation of artifacts ( Peng et al., 1995 ; Gifani et al., 2007 ; Nguyen-Ky et al., 2010 ).
As another effective feature, wavelet is one of well-known tools in signal processing ( Blanco et al., 1998 ; Zoubek et al., 2007 ).
In this paper, the performance of wavelet is enhanced by adding some pre-processing and post-processing methods. We can sum-marize the contribution of this paper in two main parts: 1-We have proposed a normalization operator for each frame 2-We introduce a new method in the wavelet domain to determine
In this research, we investigate the performance of the most successful indices and compare their ability with the proposed quantitative method referred to as Wavelet Coefficient Energy
Entropy (WCEE). This method extracts information from single channel EEG signal to estimate depth of anesthesia. The WCEE exploits wavelet decomposition, and uses entropy to analysis wavelet information. This novel index can give a faster feedback compare to BIS index that is very important for anesthesiologists.
The rest of this paper is organized as follows: In Section 2 ,data acquisition and some of the previous works are reviewed. The new method and its implementation details are discussed in Section 3 .In Section 4 , experimental results are presented. Section 5 represents some discussions and finally Section 6 concludes the paper. 2. Materials and methods 2.1. Data acquisition
In this study, 22 subjects were participated all of whom used the isoflurane anesthetic drug but their surgery and duration of their anesthesia were different. Patients X  age ranged from 35 to 65 years (mean  X  48.36, SD  X  25.93), and in weight from 43 to 87 kg (mean  X  70.56, SD  X  14.02). Before using any drug, the patients were asked to lay down and being relaxed for a few minutes. Then, anesthetic drugs were used till the time that patients drove in the suitable anesthetic depth for surgery. All the patients were used 2 X 4 mg/kg midazolam and 300 mg pentanal. The anesthesia was induced with 10 X 13 mg/kg sufentanil. The muscle relaxant used in this study was atracurium (30 X 45 mg/kg in the induction phase). The main drug that drove the patients into anesthesia was isoflurane (90 X 130 cc).

Meanwhile, BIS index was determined in successive ten second intervals simultaneous to recording the raw EEG signal. To record EEG signal, BIS-XP (Aspect Medical System Inc.) instru-ment was used and the recording was perform from one channel with 128 Hz sampling frequency. The positions of EEG electrodes in BIS-XP monitor were as follow: the first electrode was placed between corner of eye and hairline, the second one was directly above eyebrow and the third one was approximately 2 in above bridge of nose. Data was transferred to a portable computer by RS232 interface using software (BSA software v.3.16). The raw EEG data along with the indices determined by BSA including the depth of anesthesia index, SEF90, Burst Suppression Ratio (BSR), Beta ratio, bispectral ratio, power spectrum and Signal Quality Index (SQI) were stored for later analysis. The exact time and dosage of all drug infusions were also noted.

To the best of our knowledge, BIS index is based on bispectral analysis, which can represent the coupling of EEG frequencies and gives a dimensionless value in the range 0 X 100, which points to deep anesthetic level up to consciousness ( Sigl and Chamoun, 1994 ). BIS value between 40 and 60 is sufficient range for general anesthesia while BIS value in the interval of 60 X 80 reveals moderate or light anesthesia. During the maintenance of anesthe-sia if BIS index was higher than 60 or anesthesiologist assess-ments were showing lightness of anesthesia, atracurium was induced.

All patients were operated in Namazi hospital, which is the training center of Shiraz University of Medical Sciences. EEG samples during anesthesia are shown in Fig. 1 , in which EEG signal in the higher anesthetic depth contains more regular rhythms in comparison with the awaked state. In this study, for a function that would adequately estimate the anesthetic depth, 4 different sets corresponding to 4 different anesthetic states were recorded as shown in Fig. 1 , for representative samples. The data set contain awake, light anesthesia, moderate anesthesia and deep anesthesia, which are listed as follows: 1) Awaked state : 170 min recorded from 5 healthy adult subjects who were awaked or lightly sedated. Subjects were asked to keep their eyes close and relax while recording the EEG signal. 2) Light anesthesia : 200 min recorded from 5 subjects. 3) Moderate anesthesia : 150 min recorded from 7 patients who were in low probability of response situation. 4) Deep anesthesia or isoelectric : 270 min recorded from 5 patients, deep anesthesia is deeper than what is normally needed in general anesthesia. 2.2. State of the art approach
Some state of the art approaches including multifractal, detrended fluctuation analysis (DFA), wavelet entropy (WE) and short time Fourier transform (STFT) are discussed here. In addi-tion, these methods have been implemented for comparison. 2.2.1. Multifractal analysis
We expect that fractal and multifractal analysis of EEG signals give useful information of the EEG signal during different brain activities.
One limitation of fractal dimension is to describe objects by a single fractal value while EEG signals show multifractal behavior. Multi-fractalanalysisisasolutionforthisproblem,whichcomputesaset of fractal dimensions ( Lopes and Betrouni, 2009 ). Ma et al. (2006) evaluated multifractal dimension of the sleep EEG signal, estimating singularity strength and the asymme try of the singularity spectrum.
Multifractal dimension is a good descriptor of sleep depth, presenting lower values for deeper sleep states. The human sleep EEG signal is more complicated that it could be described by a fractal dimension.
Thus multifractal dimension is needed for interpretation of the fractal behavior of this signal, which re presents uniformity of amplitude distribution ( Weiss et al., 2009 ). Fractal dimension of EEG signal in a certain brain state varies within s uccessive windows thus multifractal analysis is used to solve the time scale variation of this scale. In other words, self-similarity of a signal can be described by multifractal measures in different time scales.

To determine the multifractal index, first, the singularity strength a ( q ) and the Hausdorff dimension f ( q ) are obtained by  X  q  X  X  lim f  X  q  X  X  lim where m i ( q i , L ) is described as follows:  X  q , L  X  X   X  P i  X  L  X  q f ( q ) and a ( q ) functions are derived from the EEG signals by the box counting method ( Ma et al., 2006 ), L represents the size of boxes, P i ( L ) is the probability of the i th attractor in the captured boxes, and the values of singularity factor q can be within the interval of ( N ,  X  N ). Therefore, multifractal is obtained from the size of a intervals along the horizontal axis of the following relation: f ( a ) a ( Lopes and Betrouni, 2009 ). 2.2.2. Detrended fluctuation analysis (DFA)
It seems logical to assume different states of the brain might indicate different behaviors in terms of the signal complexity.
DFA is an efficient tool in order to interpret the EEG fluctuations in terms of fractal exponents in which the dynamic behavior of
EEG during the anesthesia can be estimated. In the deep anes-thetic state, the fractal behavior and self-similarity of EEG signals increase in comparison with the awaked state. This observation empirically points to the more asynchronous activity of brain neurons in the awake rather than the deep anesthetic state.
Consequently, the behavior of the EEG signal in the awake state is becoming highly randomized, which leads to increase the entropy of EEG signals. In contrast, when the anesthetic drugs are becoming more effective, the entropy of EEG signals decreases while its self-similarity increases. This concept is evaluated by considering slope variation from awake to anesthetized state, which is discussing as follows:
DFA analysis is useful in revealing the extent of long-range correlations in time series. To obtain DFA, at first, the time series x including N samples is integrated as follows: y  X  k  X  X  where x ( i ) is the time series and x ave is the average value of x ( i ) and k changes from 1 to N . Second, the integrated time series, y ( k ), is detrended by removing the local trend, y n ( k ). The root-mean-square fluctuation of this integrated and detrended time series is calculated as
F  X  n  X  X  where F ( n ) computes for different values of n . The slope of
F  X  n  X  X  n a is determined as a scaling relation where a is termed as the scaling exponent ( Gifani et al., 2007 ). 2.2.3. Wavelet entropy (WE)
WT is a useful tool for presenting EEG signals in different time and frequency scales. Entropy of signals in the wavelet domain indicates the variation of signal in each frequency scale. In addition,
WE is physiologically meaningful b ecause it differentiates specific physiological brain states under spontaneous or stimulus-related conditions. When EEG signal behave more regularly, the symptom of synchronization in neuron activities, WE value reduces. Moreover,
WE can recognize the time localiz ations of a dynamic process ( Rosso et al., 2001 ). To calculate the WE, wavelet energy E  X  N determined at each scale j as follows:
E  X  where m j and N j are running index and the length of running windows within each level j , respectively. The total energy over all scales is obtained by
E
The wavelet energy is divided by total energy to obtain relative wavelet energy at each scale j and length of running windows N p
The WE is calculated from entropy of p  X  N j  X  j distribution between scales as follows: WE  X  2.2.4. Short time Fourier transform (STFT)
STFT is a function of time and frequency, which depicts how the spectral content of a signal evolves over time. For non-stationary signals, we can use local DFT, which analysis the signal by a window over that the signal is approximately stationary.
Thus, the resulting STFT indicates the spectral content of the signal, at each corresponding time period. The spectral content of the signal over different time intervals is obtained by moving the window through the time. For effective implementation of
STFT, fast Fourier transform would be computationally efficient ( Dirgenali et al., 2006 ). Here we implement STFT by placing the window function w ( t ) at the value t on the time axis: F  X  t , f  X  X  where F ( t , f ) is the frequency content of the windowed signal, centered at time t . 3. Practical issues and implementation
Several pre-and post-processing techniques are employed to improve the main algorithm and to design an efficient procedure for determining depth of anesthesia. The brief procedure of the algorithm is outlined in Table 1 . As shown in this table our procedure consists of three main steps. 3.1. Pre-processing
Our environment is noisy, thus the raw signal must be de-noised before the processing. Here, raw EEG signal is pre-processed before further analyzing. 3.1.1. Reduce amplitude effects
As shown in Fig. 1 when anesthetic depth increases from top to down, gradual changes of EEG signal occur. Moreover, EEG signals in the higher anesthetic depth contain lower frequency component compared to the consciousness. As a patient drawn to deep anesthesia, his effective EEG frequency component decreases but EEG amplitude is not correlated to the anesthetic depth. Therefore, a suitable method should be employed to consider the frequency content of EEG signal rather than using the amplitude information. For more discussion consider the Fourier transform.

In Fourier transform, the following relation is used to convert a time-series x ( n ) into the discrete frequency domain: X  X  k  X  X  where N is the number of samples in the time domain. From the above relation it can be concluded that having a high value of Fast Fourier transform (FFT) at a certain frequency, does not mean that frequency is repeated several times through the EEG signal while it is probable due to the high value of x ( n ). Two waves along with their frequency components are represented in Fig. 2 . Fig. 2 (a) shows asinusdiagram Y 1  X  a 1 sin( x )and Fig. 2 (b) shows another sinus diagram Y 2  X  a 2 sin( x ) with amplitude higher than Y 1 of Fig. 2 (a) and (b) are computed and depicted in Fig. 2 (c) and (d), respectively. These subfigures show for a determined frequency ( x  X  33), different FFT values for Y 1 and Y 2  X  FFT  X  Y obtained due to different amplitude values.

In order to reduce the noise level and amplitude effect in the brain waves, first we detrend each epoch by its mean value then it would be normalized by energy of the signal. z  X  where x is the average value of x and it is given by x  X 
Due to the small effect of EEG signal amplitude to estimate the anesthetic depth, if we apply a method to remove the influence of amplitude, processing of EEG signals would be improved. By dividing the signal into 1 s intervals and normalizing these time intervals separately (as indicate in the denominator of Eq. (13)), without affecting the frequency content of the signal intervals, the effect of signal amplitude on determining the frequency content will be minimized. In deep anesthesia, energy value is less than 3 m v, thus, normalization using energy values close to zero enlarges the noise because of mean energy value located in the denominator. Therefore, we just normalize EEG epochs with energy values above 3 m v. 3.1.2. Wavelet-based eliminating electroculogram artifacts in EEG
EEG can be contaminated by other bio-potential sources such as heart and respiratory muscles, eye blinks, etc. Vigon et al. (2000) but dominant source noise is generated by eye muscles, which are known as electroculogram (EOG) signals. EOG is a non-cerebral activity that spreads across the scalp and deteriorates the EEG content. EOG and head movements cause transience in lighter anesthesia states, which mostly happens before and during anesthesia. Therefore, it is essential to provide a control procedure for eliminating the ocular artifacts (OA) from EEG in order to be interpreted properly for clinical use.

A common strategy is to remove all EEG epochs containing artifacts with high amplitude (larger than a certain voltage). How-ever, losing data because of artifact removal may be unsatisfactory, especially in cases with limited number of data. On the other hand, since EEG and EOG have the same frequency band, using analog and digital filters to omit this type of noises is ineffective Girton and Kamiya (1973) .

WT is used to analyze non-stationary and time varying signals such as bio-potential signals. The ability of wavelet is to represent a signal into some specific frequency bands with different resolutions in the time domain. WT is used in many applications such as feature extraction, signal modeling and signal de-noising.
Since frequency content of EEG signals are time varying, WT can represent EEG signal into different frequency scales and a simple threshold can detect those scales, which mostly affected by noise.
In wavelet decomposition, decomposed components in different scales are independent. However, as mentioned before other well-known time X  X requency techniques such as STFT ( Dirgenali et al., 2006 ) do not have this property.

In this study, stationary wavelet transform (SWT) is used to decompose the EEG signals because the following two positive properties. First, SWT provides the same number of coefficients in each frequency band, which eases the comparison between these coefficients. Second, at the pre-processing stage, the better time resolution of the SWT leads to a better description of artifacts as well as a smoother estimation of the signal. Here, as mentioned before, Daubechies-3 wavelet has been chosen as a proper mother wavelet to simulate EOG artifact.

When noise affects a certain frequency band in EEG signals, applying WT to the signal can be useful to remove this noise.
More precisely, existence of this type of noise leads to increase wavelet coefficients in a few scales, which should be discarded.
Those scales with smaller wavelet coefficients can reconstruct the de-noised EEG signal.

As we mentioned, eyes activity is one of the main sources of artifacts in EEG recording and deteriorate the low frequency bands of EEG signals. These artifacts include eye movement and eye blinking for which corresponding frequency range must be excluded. For eye movements and eye blinking these ranges are 0 X 7 Hz and 8 X 13 Hz, respectively ( Gasser et al., 1985 ).
Choice of threshold limit and threshold function is the main step in de-noising procedure. These threshold and function must be precisely determined to prevent removing main parts of the original signal, which lead to lose critical information of the input signal. The proposed threshold in ( Krishnaveni et al., 2004 )is directly related to the standard deviation of each decomposed signal. The de-noising threshold is briefly described as follows:
T  X  1 : 5 std  X  C j  X  X  14  X 
Here, we applied a hard threshold as the threshold function, which sets any coefficient higher than a determined threshold to zero. For calculating the above equation length of window or frame is 1 s. 3.1.3. Wavelet-based electrocardiogram artifact detection and elimination
In addition to OA, electrocardiogram (ECG) signals are another artifact source that deteriorates the EEG signal. Several artifact detection methods have been proposed in past studies to eliminate
ECG artifacts from EEG ( Nakamura and Shibasaki, 1987 ; Park et al., 2002 ). Here, power spectrum of ECG signal is determined as an adaptive threshold to eliminate ECG from EEG ( Thakor et al., 1984 ). The steps of the algorithm are as follows: Step 1: Decomposition scale
In this step, first EEG signal is decomposed in three scales in the wavelet domain. The frequency distribution of the QRS (a rhythm in ECG signal) generally covers the second and third scales. But third scale is more affected by noise that most of the EEG variations like beta activity and sleep spindles appear at this scale. Thus, we chose the third scale to extract the R-peak ( Nakamura and Shibasaki, 1987 ) of ECG artifacts. Step 2: Wavelet basis selection
We should find a suitable mother wavelet, which has a sharp and spiky waveform consistent with spike-like ECG artifacts.
We chose the Daubechies-3 as the basis function, which is very similar to the ECG artifacts.
 Step 3: Adaptive threshold
The main goal of an adaptive threshold algorithm is to reveal artifacts and make the focal points more considerable. The threshold values depend on energy variation of the wavelet coefficients. The wavelet details of the j th decomposition scale are denoted as D j , and the energy of coefficients at this scale is defined as E j  X  k  X  X  9 D j  X  k  X  9 2 .

An adaptive threshold scheme was proposed by Jiang et al. (2007) as follows: T  X  k  X  X  max E j k L 2 : k  X  L 2 for k  X  L 2 , L 2  X  1 , ... :  X  15  X 
Here T ( k ) is the threshold at the k th time index and L is length of the moving window. This procedure allows detection of the local maximum of energy, corresponding to the R-peak of ECG artifacts in a specific segment. When the window length is within the range of I o L o 2 I , where I is the interval length between two adjacent R-peaks, detection can be expected more accurate. In accordance with experimental results, the predefined length of the moving window is set to 300 samples (2.3 s.). As long as the
R X  X  intervals are in the range of 1.1 X 2.3 s (R X  X  mainly takes 0.8 s), correct detection would appear. However, R X  X  intervals will change in long-term recordings due to heart rate variability (HRV); hence, window length would update every 10 s in order to ensure the trueness of detection. The current window length is derived from the mean value of the intervals between two detection points during the previous 10 s. The elimination of ECG artifacts is achieved by directly subtracting t he estimated artifacts from the contaminated EEGs wavelet coefficients. 3.1.4. Eliminating of power line noise
The EEG signal is a low power signal, which is sensitive to environmental noise. The main noise in operating room is produced by the urban electricity, used in various devices such as ventilator, electric cutter, ECG recorder and lots of specific lights that are working in the operating room. When these devices are near the EEG recording device, strong 50 Hz noises may be added to the EEG signal, which can be removed by a 50 Hz notch filter.

After the filtering stages, the EEG signal is processed by the main algorithm. 3.2. The main algorithm 3.2.1. Optimal mother wavelet selection
WT is an intuitive tool while it can represent the information of a signal through the time X  X requency domains. WT decomposes EEG signal into desired band, each of these bands represents the activity of the signal in a particular frequency band, which would be effective for further analysis ( Zikov et al., 2006 ). WT decom-poses a signal through successive low and high-pass filters where the bandwidth of theses filters at each scale has a dyadic relation to its former one. The goodness of the wavelet coefficients and wavelet details is highly depended on the mother wavelet shape. In this way, Singh and Tiwari (2006) proposed a method for optimal selection of wavelet functions, which has been consid-ered and implemented in our study. An optimal mother wavelet for a signal causes to maximize wavelet coefficients values in the wavelet domain. By selecting the optimal wavelet filter bank, the best interpretation of frequency content of the EEG signals would be possible.
 In Fig. 3 (a) X (c) EEG signal and ordered wavelet coefficients for Haar and Daubechies-3 mother wavelets are depicted, respectively. Fig. 3 (b) and (c) also represents that a few numbers of significant coefficients (2000 out of 8000) required for reconstructing EEG signal with desired resolution in wavelet domain, which is indicator of wavelet compression nature. Fig. 4 represents reconstructed EEG signal with 2000 of its most significant wavelet coefficients. These subfigures represent that Daubechies-3 acts better than Haar mother wavelet in reconstructing EEG signal and localizing property of wavelet coefficient. Fig. 4 (b) and (c) presents the reconstructed EEG signal with Haar and Daubechies-3 wavelet, respectively, which clarify the necessity in selecting optimal wavelet basis to better reconstruct and interpret EEG signal in wavelet domain. The steps to determine optimal mother wavelet for applying to the EEG signal is as follows:
At first, we select some arbitrary basis mother wavelets, and then the cross correlation coefficient between EEG signal and the selected wavelet filter would be evaluated. Finally, the mother wavelet, which maximizes the cross correlation coefficient would be selected as the optimum mother wavelet.

Fig. 5 shows cross correlation coefficient of the EEG signal with various wavelet filters, which are usual in signal processing.
As it is obvious Daubechies-3 is the optimal basis mother wavelet, which has the maximum cross correlation coefficient with the EEG signal. 3.2.2. Wavelet coefficient energy entropy (WCEE)
According to several observations of EEG in different states such as anesthesia, sleep and hypnosis researchers found out that the main informative frequencies are in the range of 0.3 and 30 Hz. This range is classified in a number of frequency bands as follows:
Delta ( o 4 Hz) : Delta rhythms are slow brain activities, which occur only in deep sleep stages of normal adults and pathologies.
Theta (4 X 8 Hz) : These frequencies occur in normal infants, children and also in adults during drowsiness and sleep states.
Rarely theta rhythms appear in the normal awaking adult. In abnormal and pathological conditions, high theta activity appears.
Alpha (8 X 14 Hz) : Alpha rhythms observe in normal adults during relaxation and mentally inactive awaked. The amplitude is mostly less than 50 mV and appears in the occipital area. Alpha rhythms are blocked by visual attention and other mental efforts such as thinking.

Beta (14 X 30 Hz) : beta activity is mostly occurs in front-central region and its amplitude is less than alpha rhythms. It is observed in expectancy states and tension.

Gamma ( 4 30 Hz) : Gamma rhythms have a high frequency band and usually are not considered by clinical and physiological interests therefore it is omitted in EEG analysis.

WT is an effective tool in signal processing due to its unique properties such as time X  X requency localization (obtaining a signal in particular time and frequency interval or extracting features at various locations in time at different scales) and multi-rate filtering (differentiating the signals having various frequencies).
Using these properties one can extract the desired features from an input signal characterized by certain properties in time and frequency domains. Wavelet decomposes EEG signal into desired bands, which would be effective for further analysis. For instance when an EEG signal is decomposed in three scales by WT, it looks like to filter the signal into three frequency bands, including 0 X 8 (theta bands together with delta bands), 8 X 16 (alpha bands) and 16 X 32 Hz (beta bands).

In this study, a new measure based on WT is introduced, which is called Wavelet Coefficient Energy Entropy ( WCEE ) to provide quantitative information about the depth of anesthesia. Similar approaches were suggested in several studies such as the neuro-logical status of the brain ( Al-Nashash et al., 2003 ), ordering or disordering of EEG during sleep ( Mikaili and Hashemi, 2002 ) and seizures ( Rosso et al., 2003 ; Hornero et al., 2003 ).
In order to calculate the WCEE, the wavelet coefficients Cj ( k )of that signal are calculated at each scale j . The SWT, which is computed in de-noising step is also used to decompose the recorded EEG into different frequency scales. After applying
SWT on short length epochs, boundary effect ruins the results; therefore before decomposition, each epoch is extended and after applying SWT, the coefficients, which are not influenced by boundary effects, are preserved for further analysis ( Zikov et al., 2006 ).

WCEE is computed by the following proposed formulas. The energy at each scale j and time k can be calculated by the following equation:
E where E  X  k  X  j is the squared wavelet coefficients at scale j and time k .
The total energy in different times and scales is obtained by the following formula:
E
The relative wavelet coefficient energy, which defines energy X  X  probability distribution in time-scale, is defined as p
In Eq. (18), P k P j p  X  k  X  j  X  1, since it is the summation of prob-abilities. Entropy of the resulted samples in all scales and times namely WCEE are determined as follows: H
In this part we obtain an index for each epoch, namely H WT according to Eq. (19). The value of this index is normalized between 0 and 100 (similar to BIS index). This index shows depth of anesthesia or patient states during anesthesia. As we would represent in Section 3 the value of WCEE can provide a good estimation of anesthetic depth. 3.3. Post-processing
After applying our algorithm, some post-processing is performed to enhance the reliability of the results. In this research, EEG signal is analyzed in each epoch but it leads to a very noisy index. For solving this problem we use an averaging method in which for every 10 epoch (equal to 10 s) the average is computed and reported as the final index. This approach makes the obtained WCEE index comparable to the BIS index ( Zikov et al., 2006 ).

As mentioned before, our algorithm computes SWT for pre-processing and determining the WCEE index, which cause fast computation of our algorithm. In the next section, empirical evaluations to assess the proposed method are illustrated. 4. Results
In this part, the results achieved by applying the proposed method (WCEE) to the segmented EEG, belonged to 22 patients, all of whom were used isoflurane during the surgery are shown. The recorded signals do not have equal durations. In order to record EEG signal, BIS-XP instrument with the updated software whose sampling frequency is 128 Hz was used. Totally, 47,400 epochs are recorded for all patients.

In this study, we do some pre-processing on EEG signals as follows. Firstly, in order to reduce the noise level and effect of amplitude in the brain waves, we detrend each epoch and then normalize it by its energy. This normalization minimizes the effect of signal amplitude on determining the frequency content, which leads to increase the performance index. Secondly, the main part of recorded noises, which are produced by eye move-ments and muscle activities must be removed since it causes our index to be unstable. Here, Daubechies-3 as a mother wavelet with an adaptive threshold has been chosen to simulate and subsequently remove EOG artifact. Third, ECG signals are another artifact source that deteriorates the EEG signal. Power spectrum of ECG signal is determined as an adaptive threshold to eliminate ECG from EEG. Finally, the electrical city noise (50 Hz) is removed by a notch filter.

After applying the pre-processing stage, optimal wavelet is selected and then the proposed WCEE index is extracted from the signals based on the implementation mentioned in Section 3.2. The methods are implemented using MATLAB 2006.

Analyzing 1-s of EEG signal leads to a very noisy index, thus 10-s averaging filter is used for making this index more robust and comparable to the BIS values. In order to validate our introduced method the proposed index is compared with BIS index. Fig. 6 depicts BIS index with respect to the obtained WCEE index for four different patients. In these subfigures, vertical axes show BIS index and horizontal axes show WCEE index. As depicted in these subfigures using the proposed method, anesthe-sia states are well apart from each other in terms of moderate and high anesthetic depths and consciousness. As it is expected, in deep anesthesia, irregularity of EEG decreases, which leads to decrease in scattering of wavelet coefficients. Consequently, WCEE index, which is entropy of wavelet samples X  energy decreases. In contrast, in the moderate anesthesia state, the irregularity is increased that heighten the WCEE index in this state, which shows the underlying changes in EEG.

BIS index of the eight persons are depicted versus time in Fig. 7 (subfigures a 1  X  X  8 ) and the results of the WCEE index versus time are illustrated in Fig. 7 (subfigures b 1  X  X  8 ) for each patient. As can be seen, the results achieved by the proposed method get very near to the BIS index in deep and moderate anesthetic depths. In addition, most of the EEG based indices are not scalable from one to another one. In other words, WCEE indices can follow the trend of variations but their values cannot be ranged from two certain values (0 X 100). This is a very positive property, which makes our method scalable for different subjects and anesthesiologists can relay to our index.

Among our patients, two subjects have recorded signals con-taining whole anesthetic process including, consciousness (80 o BIS o 100), consciousness to anesthesia (60 o BIS o 80), anesthesia (BIS o 60), anesthesia to consciousness (60 o BIS o 80) and consciousness (80 o BIS o 100). In fact, EEG signals of both 5th and 6th patients were recorded from consciousness to anesthetic and back (from anesthetic to consciousness), shown in Fig. 7 .
In order to see the effect of pre-processing and post-proces-sing, the experiments are repeated for each subject without these steps and the results are plotted in Fig. 8 . In this figure, BIS index of the same eight persons of Fig. 7 versus time are depicted without pre-and post-processing. By comparing Figs. 7 and 8 ,it can be inferred that for all subjects, the pre-and post-processing steps have direct effect on the accurate estimation of anesthetic depth. The reason is that, the amplitude effects, power line noise, EOG and ECG artifacts are not removed in these experiments.
Moreover, the post-processing step smoothes the final results, which is not occurred in Fig. 8 .

To show effectiveness of the proposed scheme, state of the art algorithms, which are discussed in Section 2.2 , such as wavelet entropy, STFT, multifractal and DFA were implemented and their correlation coefficients with BIS index were compared to each other, in order to evaluate our introduced method. The correlation coefficient is calculated as cov ( i , j ) computes covariance between two variables i and j .In
Table 2 , the first column depicts the patient X  X  number; the other columns show the correlation coefficient of the corresponding methods with BIS index. Each row is the result of correlation coefficient of each algorithm and BIS index for each patient. As can be seen in Table 2 , some methods have been implemented to enrich the comparison part in order to present a comprehensive study to investigate performance of different anesthetic depth indices.

To show the robustness of the method, Gaussian noises with different amplitudes are added to the signals and the results for different levels of additive noise are shown in Table 3 . To evaluate the effect of noise level on the indices, the correlation coefficient is determined according to Eq. (20). The first column depicts the patient X  X  number and the second column shows correlation coefficient of WCEE index and BIS index. The third column shows correlation coefficient of BIS index and WCEE index with additive white Gaussian noise. In this column, the signal-to-noise ratio per sample is 10 decibels (db). Similarly, the fourth column shows correlation coefficient of BIS index and WCEE index with additive white Gaussian noise. However, its signal-to-noise ratio per sample is 20 db. 5. Discussion
To extract the appropriate information to estimate depth of anesthesia from the EEG signal, the entropy of the wavelet coefficient energy is selected as a candidate feature. This choice is due to the facts mentioned as follows:
Firstly, different EEG patterns or difference in spectral dis-tribution would cause into different anesthetic depth. Therefore, WT is an efficient tool to derive this time X  X requency information.
However, it is necessary to extract the information obtained from the wavelet coefficients by statistical tool, because theses coeffi-cients cannot be used right away. The main reason in using entropy is in the fact that Shannon entropy gives a useful criterion to analyze and compare the probability distribution. Thus it acts as a measure of information for different distributions. The entropy is also a measure of condensation or scattering the wavelet coefficients of a signal. For a regular activity, such as a sinusoidal signal, a sharp peak would be appeared in the fre-quency domain. This compactness of the wavelet coefficient in one single peak corresponds to a low entropy value. However, for an irregular activity like pure noise, a wide band response would be appeared in the frequency domain, which would be reflected in higher entropies ( Rosso et al., 2001 ).

Secondly, entropy can be applied on a time X  X requency representa-tion of a signal like WT. WT has no assumptions about the stationarity of the signal. Thus, the time proper ties of frequency patterns can be followed in an optimal time X  X requency domain. Therefore, entropy of wavelet coefficients is a tool to measure degree of regularity and irregularity in the signal and also it can represent the fundamental dynamical process asso ciate with the signal.

Third, due to the localization nature of WT, WCEE index can detect variations in a non-stationary signal. Fourth, here we use entropy as the feature function, which allows flexible choice in
WT. Thus, by iterating between different wavelet filters, a search algorithm can be used to assess the best wavelet filters. 6. Conclusion
In this study, an efficient method based on WT for estimating the anesthetic depths is presented. The proposed method extracts informative features from the EEG signals during anesthesia. Moreover, the ability of wavelet in decomposition the EEG signal into various frequency bands makes it an efficient tool to describe these signals. Since each level of anesthesia contains specific frequency bands, relation between these frequency bands would be a good interpretation of anesthetic depths. Thus, we use entropy of these coefficients to obtain anesthesia indices. Hence, the main contribution of this paper is noise reduction of the input signal and minimization of the signal amplitude effect. In addi-tion, this method utilizes entropy of wavelet coefficients in a new way to determine the anesthetic depth and provide more con-siderable results.

The proposed method might seems simple in comparison with other methods like BIS-XP monitor, which based on complex signal processing algorithms and hundreds of samples used for training purposes. However, we believe that the proposed method can be a good descriptor of anesthetic depth. This method provides a good approximation of the anesthetic depths and its results is highly consistent with the BIS index results. Moreover, experimental results empirically showed that our method can significantly decreases the noise effect produced by ECG and OAs artifacts and electrical apparatuses in the operation room. More noises are added to the signals amplitude while in the proposed method, effect of signal amplitude is minimized on the final results that make it robust to the additive noises. In addition, for each second WCEE obtains one index, which is much faster to compute than BIS index (one index for every 10 s). Therefore, in critical situations the proposed method gives a faster feedback for the patient X  X  states to specialist. The BIS gives an index after each 10 s period. During this period, the anesthetic depth might change, which causes to late reaction of the surgeon to state of the patient. On the contrary, in the proposed method, having the index after each second is more vital for specialists. Moreover, the proposed method can be applied to other EEG processing fields such as detecting the seizure through the EEG for infants or detection of imagery movements in the brain computer interface (BCI) field.
 Acknowledgment The authors of this paper present their warm regards to Reza Sameni and Farid Zand for their valuable academic comments on this paper.
 References
