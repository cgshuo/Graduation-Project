 1. Introduction
To reduce the ambiguity due to the word mismatch problem in information retrieval and to thereby increase retrieval effectiveness, a variety of query modification and reformulation strategies have been investigated ( Attar &amp; Fraenkel, for query reformulation ( Yates &amp; Neto, 1999 ): (1) Interactive techniques based on feedback information from the user, commonly known as relevance feedback (RF); (2) Automated techniques based on the global information derived from the entire collection or corpus, commonly known (3) Automated (might be interactive also in some cases) techniques based on local information from the top retrieved  X 
The efficiency of image relevance computation has accelerated the development and use of RF in these three approaches
CBIR as an emerging technology. Comprehensive surveys exist on both early low-level and recent semantic-level image re-almost two decades of intensive research, CBIR systems still lag behind the best text-based search engines of today. One of human understanding of image content consisting of semantic concepts (high level) and image representation through fairly rudimentary features (low level). To narrow the semantic gap, techniques have been developed over the last few years for et al., 2007; Datta et al., 2008; Bosch, Muoz, &amp; Mart, 2007; Zhou &amp; Huang, 2003; Rui et al., 1997 ).
Among these, a number of RF-based approaches have been proposed in the CBIR domain, such as: query point movement, The majority of these approaches estimate the ideal query parameters from the low-level image features at a global level. often do not return many relevant results even with a large number of feedback iterations. To address this limitation, some recent systems incorporate the RF approach on both low-level content and high-level context (keyword) based feature spaces performance boost, one of the major drawbacks is that the users do not always provide enough feedback information to make
The automatic query reformulation based on term co-occurrence or term similarity also has been widely investigated in terms for the query expansion. In local analysis, the top retrieved documents for a query are examined (usually without any
Due to the nature of the low-level continuous feature representation, it is difficult to perform query reformulation or expansion based on term co-occurrence or the term similarity in the CBIR domain. The obvious choice for terms in text doc-uments are the words that are directly related to the semantic contents. However, the images contain information in a very dense and continuous form where the units of an image at a low level are pixel values having no direct semantic meaning. In order to perform an automatic query expansion based on term-term correlations, the images should have a similar feature type and distribution as the ones from the text. Therefore, the number of possible image features should be high, and the number of image features per image should be low. Recently, the ongoing success of the  X  X  X ag-of-words X  X  methodology in the text retrieval domain have motivated researchers to explore analogous techniques mainly for scene classification and between low-level features and high-level concepts.
 keywords X  X ) from the sample images. In Jing et al. (2004) , a compact and sparse representation of images is proposed based on using a region codebook generated by a clustering technique. A semantic modeling approach, investigated in Vogel and
Schiele (2007) for a small collection of images, is based on the binary classification of semantic patches of local image regions. Similarly, in Shi et al. (2004) a binary support vector machine (SVM) is employed for the model generation of 23 the highest positive result is associated with the region. A learning-based unified image retrieval framework to represent images in local visual and semantic concept-based feature spaces is presented in our previous work ( Rahman, Bhattacharya, vector machine (SVM). A detailed review and accuracy comparison of some of the most commonly used scene classification approaches has recently been presented in Bosch et al. (2007) . Experimental evaluation has shown that approaches using intermediate semantic concepts are more appropriate to reduce the gap between low and high-level. 1.1. Motivations and contributions
Besides the loss of all ordering structure, each word (term) is considered independent of all the words in the bag-of-words conceptsinanoriginalqueryimagebyexploitingtheinformationoncorrelationpatternstoimprovetheretrievaleffectiveness.
Due to the similarity of the concept-based feature representation schemes to the keyword-based representation of doc-uments and to address the limitations of both the low-level and concept-level feature representations, we explore analogous query expansion techniques in the image domain from a novel perspective. We propose automatic query expansion ap-local concepts and represent images with the concept frequencies, a statistical model is built by utilizing the SVM-based multi-class classification technique. For the automatic query expansion based on a local analysis, we exploit the concept X  concept correlations by analyzing a local clustering method that takes into account the co-occurrence information and the metrical constraints based on the neighborhood proximity between the concepts in encoded images. We also analyze ( Rahman &amp; Bhattacharya, 2009 ) of query expansion in image domain.

The organization of the paper is as follows: Section 2 reviews existing query reformulation and modification approaches in the CBIR. In Section 3 , the semantic concept-based image representation approach is described. Section 4 presents a query 2. Related work
The idea of query expansion or reformulation techniques based on the term co-occurrence or the term similarity is rel-atively new in the CBIR domain due to the nature of the low-level continuous feature representation. Until recently, only a
Jeon, Lavrenko, &amp; Manmatha, 2003 ). For example, a context expansion approach has been explored recently in Wang et al. (2006) to take advantages of the correlations between key regions (representing the main semantic contents) and environ-mental regions (representing the contexts) by expanding the key regions of the queries using highly correlated environmen-tal regions according to an image thesaurus. The thesaurus is constructed through a data-driven approach, serves as both a a soft query expansion approach based on this similarity matrix is adopted to infer keywords which is somewhat related to the query expansion approach. A cross-modality query expansion approach is proposed in Zhang and Su (2001) to further improve image retrieval performance. When a query is given in the form of keywords, it is expanded by a set of keywords selected from a semantic keyword network constructed through keyword propagation, and the low-level features of the cor-evance model based on a set of training images to automatically annotate and retrieve images. An image is represented as a in the caption of the image. The probability of drawing a keyword or a blob from the model of an image is given by a linear nation procedure is fundamentally a smoothing scheme, which is different from our approach.

The approaches mentioned above are either data dependent on the entire collection Wang et al. (2006) or relied on key-expansion is fundamentally different from the above approaches. It relies solely on a concept-based image representation where images are modeled as  X  X  X ag of concepts X  X  . Here, the concept co-occurrence or the concept similarity are analyzed by considering both the global collection and the local feedback level. 3. Image representation on local concept space
A major component of the proposed query expansion framework is the image representation in a local concept space. By identify specific local patches that are perceptually and/or semantically distinguishable, such as homogeneous texture pat-terns in grey level radiological images, differential color and texture structures in microscopic pathology and dermoscopic images. However, semantic similarity does not always correspond to perceptual or visual similarity. For example, Fig. 1 shows several patches of sky (top row) and water (bottom row) that are cropped from a fixed partition-based image segmen-the appearances in terms of the color and texture features.

Although we can easily distinguish such concepts with variations due to our long accumulated knowledge, it is always difficult for a machine to do the same. The variation in these local patches can be effectively modeled by using supervised contains category specific labels. 3.1. Multi-class SVM
In its basic formulation, the SVM is a binary classification method that constructs a decision surface and maximizing the inter-class boundary between the samples. Stated mathematically, where x 2 R d is an input vector, x i is a training sample vector along with its label y function which maps the vectors into a higher dimensional space by the non-linear mapping function / : R or l could even be infinity.
 A number of methods have been proposed for the extension of the SVM to multi-class classification problems ( Duan &amp;
Keerthi, 2005 ). We utilize one such a method by combining all pairwise comparisons of binary SVM classifiers, known as set of local semantic patches from individual image regions. We consider a semi-automatic approach for the semantic patch area of each region should correspond to a particular concept by at least 70 X 80%.
 In order to perform the multi-class SVMs training based on the local concept categories, a set of L labels are assigned as manually with the concept labels in a mutually exclusive way. Hence, each patch is labeled with only one local concept cat-egory and is represented by a combination of color and texture moment-based features. The color feature is composed of the mean and the standard deviation of each channel in the RGB color space and the texture feature is composed of second order texture moments, such as energy, maximum probability, entropy, contrast, and inverse difference moment from a grey level the feature vector set of the patches along with their manually assigned corresponding concept labels. 3.2. Image encoding and feature representation
Images in the data set are annotated with local concept labels by partitioning each image I l vectors as f x 1 j ; ... ; x k j ; ... ; x l j g , where each x x , the local concept category probabilities are determined by the prediction of the multi-class SVMs as Wu et al. (2004) of I j as
Here, each p ik scores, the category label of x k j is determined by m  X  argmax probability score. Hence, the region x k j is annotated with the label m and the entire image is thus represented as a two-dimensional index linked to the concept or localized semantic labels assigned for each region. Based on this encoding scheme, an image I j is represented as a vector in a local semantic concept space as where each f i j corresponds to the normalized frequency of a concept c
However, this representation scheme captures only a coarse distribution of the concepts and is analogous to the distri-bution of quantized color in a global color histogram. In the image domain, the concepts contain information from both per- X  X  X ky X  X  would occur in many outdoor images whereas the concept  X  X  X now X  X  might be found only in images of a snowy mountain lection have low information content. However, if a single image contains many occurrences of a concept then it is probably
In this context, for the tf-idf based scheme, the local weight is denoted as L occurrence of a local visual concept c i or a local semantic concept sc the concepts which are presented in I j . The global weight G frequency in text) as G i = log e ( M / M i ) + 1,1 6 i 6 scheme, an image I j can be represented as a vector in a concept space as where w i j is the weight of the concept c i . Here, the vector dimension equals to the number of local concept categories. 4. Query expansion based on local analysis
Query expansion based on local feedback and cluster analysis (commonly known as local analysis) has been one of the 2000 ). Generally, the techniques based on local analysis expand a query based on the information from the top retrieved items (without any assistance from the user) for that query. In most expansion methods that uses the local analysis, there contribution to the query. The top ranked terms are re-weighted and appended to the query, and finally the reformulated in image domain, some basic terminologies are defined as follows:
Definition 1. For a given query image I q , the set S l of images retrieved is called the local image set . Also, the set C distinct concepts c i 2 C l in the local image set S l is called the local vocabulary of concepts . occurrence of concepts inside images.

Each entry a u v expresses a normalized correlation factor between concepts c where n u be the number of images in S l that contain the concept c and n u v be the number of the top retrieved images in S l the number of images where both c u and c v appear and the total number of images in S value ranges to 0 6 a u v 6 1. If c u and c v have many co-occurrences in images, the value of a considered to be more correlated.
 proach in Yasushi, Tetsuya, and Kiyohiko (1991) . The local correlation (connection) matrix A quency of co-occurrence of pairs of concepts in images and it does not take into account where the concepts are located in an encoded image. Since, the two concepts that occur relatively close in a neighborhood seem more correlated than the two concepts which occur far apart in an image. We provided such an example in the previous section for the concepts of sun and sky for outdoor images. Hence, it would be worthwhile to factor the distance between two concepts in the com-putation of their correlation factor.
 terms. A document can be viewed as a one-dimensional ordered list of terms where the distance between two terms is cal-culated by counting the number of words between them. For the image domain, the concepts are organized in a two-dimen-sional grid in encoded images. To measure the distance between two concepts, we need to rely on some sort of a neighboring tions. Such a neighborhood relationship is defined as follows:
Definition 3. Let a two-dimensional encoded image I j be represented as a grid of P columns and Q rows of block units. Each block r ( x , y ),0 6 x 6 P 1,0 6 y 6 Q 1, has a topological d -neighborhood and is mapped into a concept c codebook as shown in Fig. 3 . The value of d can go up to a maximum of P 1or Q 1 for horizontal or vertical directions. If we consider two blocks r ( x , y ) and r ( u , v ) for 0 6 distance dis ( c i , c j ) between these two concepts is measured as
Hence, if c i and c j are 1-neighborhood apart then dis ( c
For example, Fig. 3 shows the distance between concepts c local concept X  X oncept metric correlation matrix M l is defined as follows ( Attar &amp; Fraenkel, 1977 ):
Definition 4. M l =[ m u v ]isa X  C l  X   X  C l  X  matrix. Each entry m between concepts c u and c v as where S ( c u ) and S ( c v ) indicate the sets of the concepts c ent regions in encoded images of the local image set S l . The metric correlation c
Given the above definitions of the local connection matrix A ciation and metric clusters respectively for the query expansion. Let f ordered set of n largest values a ij from A l or m ij from M defines a local association or metric cluster around the concept c (e.g., red star) is located within a neighborhood f i ( n ) associated with the concept c Now, the concepts that belong to clusters associated with the query concepts can be used to expand the original query. expansion process based on the metric cluster are given in Algorithm 1 . Similar steps can also be applied for the query expansion based on the correlation cluster where we just need to replace M
Algorithm 1. Query Expansion through Metric Clusters 1: Initialize a temporary expanded query vector that need to be added to the original vector of query image I 2: For an original query vector f o 3: Consider, the top ranked K images as the local image set S 4: Construct, the local metric matrix M l based on Eqs. (8) and (9) at query time. 5: for i =1to L do 6: if w i q &gt; 0 then 7: Consider the i -th row in the metric matrix M l for concept c 8: Return f i ( n ), the ordered set of n largest values m 9: for each c j do 10: Add and re-weight the corresponding element in query vector as ^ w 11: end for 12: end if 13: end for 14: Obtain the re-formulated or modified query vector as f 15: Perform the retrieval with the modified query vector f 16: Continue the process, i.e., steps 3 X 15 until no more changes are noticed.

Based on Step 10 of Algorithm 1 , weights are assigned in such a way that a top ranked concept in a ordered set gets the largest weight value than the next one in the set. After this expansion process, new concepts may have been added to the original query based on Step 10 and the weight of an original query concept may have been modified had the concept be-longed to the top ranked concepts based on Step 14 of the algorithm.

The main drawback of any local analysis based query expansion approaches is that it is computationally expensive to con-ure of a system. However, this query expansion approach would be of great assistance for the application domain where effectiveness is the major issue then efficiency, such as the medical image collections. 5. Query expansion based on global analysis
This section presents another query expansion approach in the concept space by generalizing upon an expansion model bal analysis techniques are computationally intensive but the computations are done off-line once per database. The only component done on a per query basis is the actual query expansion itself. The query expansion methods tend to add a term with the query terms.

A query expansion model for the text retrieval using a similarity thesaurus is presented in Qiu and Frei (1993) . They ob-tain a relatively large improvement (15 X 30%) in performance by adding terms that have the largest similarity to the entire tween these terms and the query.

By generalizing their approach in our image framework based on the concept model, each concept c associated with a vector c i  X  &lt; w i 1 ; ... ; w ij ; ... ; w the weight for the concept c i in image I j , which is computed in a rather distinct form as Qiu and Frei (1993) : where f ij be the frequency of occurrence of the concept c under all images in the collection. Further, the inverse concept frequency ikf ument) frequency) is computed as ikf j  X  log L k cept vectors, a similarity matrix S L L =[ s u , v ] is built through the computation of each element s relationship or dot product between two concept vectors c and can be computed off-line. The only component done on a per query basis is the utilizing the matrix elements for the query modification.

We map an original query vector f o q  X  X  w 1 q w iq w Lq T vector c q , which is computed as
Based on the similarity matrix S , a similarity between each concept c sion. After selecting the additional search concepts, we need to assign weight to them so that they can be added to the original query vector. The weight of each concept c v is calculated as Qiu and Frei (1993) :
Finally, we obtain the re-formulated or modified query vector as f
With the above steps, the query and the concepts most similar to the virtual query concept are classified in the same clus-ter. After this expansion process, new concepts may have been added to the original query and the weight of an original query concept may have been modified had the concept belonged to the top ranked concept based on (14) .
To illustrate the above process, Fig. 5 shows a virtual query concept vector c that concepts c c and c d are closer to the individual query concepts c terms of the whole query concept (i.e., the virtual query vector c consider only two concepts out of all other concepts in the vocabulary. It implies that, the concepts selected here for the query expansion might be distinct from the ordinary global or local analysis method. 6. Experiments
To evaluate the effectiveness of the proposed retrieval framework based on query expansion, exhaustive experiments were performed in two different image collections. Since these collections have greatly different characteristics, together they offer a diverse set of data with complementary nature. The first collection comprises a varying cross-section of 4000 still natural images taken from locations around the world. It is basically a subset of the COREL data set and the IAPR TC-12 benchmark that was created under the Technical Committee 12 (TC-12) of the International Association of Pattern Rec-life situations with many different images of similar visual content but with varying illumination, viewing angle and back-ground. This makes it more challenging for the successful application of image retrieval techniques. To evaluate retrieval performance, we have manually categorized 4000 images from this collection into three levels and 26 different disjoint cat-tings and closeup of individual persons; indoor and different outdoor natural landscapes or manmade objects; activities, such as different sports and so on. This category information is served as ground truths for the experimental purposes.
The second image collection consists of 5000 biomedical images in 30 manually assigned disjoint global categories, which the visual and some mixed-mode query topics during the last three years (2005, 2006, and 2007) of ImageCLEFmed ( M X ller on current CBIR techniques is difficult. 6.1. Training for the SVM into an 8 8 grid generating 64 non-overlapping regions. Only the regions that conform to at least 70 X 80% of a particular concept category out of the pre-defined categories are selected and labeled with the corresponding category label. We man-
The concepts are selected in such a way that images in the same category share many common concepts, such as, rock, sky, grass, etc. As well as images from different categories also contain common concepts, such as blue sky in most of sub-some meanings to the physicians with distinct visual appearances. We defined 30 concept categories from the patches, such as X-ray lung tissue and bone, normal and abnormal skin, microscopic images of different color and texture patterns, and so for the photographic and the medical collection, respectively.

For the SVM training, we utilized both the radial basis function (RBF) and the polynomial kernels. There are two tunable parameters while using RBF kernels: C and c . It is not known beforehand which values of C and c are the best for the one with the best CV accuracy is picked. We also experimented with the polynomial kernel of degrees 1 and 2 with C = 100. ti-class SVM classifiers. 7. Results
For a quantitative evaluation of the retrieval results, we selected all the images in the individual collections as query images and used  X  X  X uery-by-example X  X  as the search method, where a query is specified by providing an example image to the system. A retrieved image is considered to be a correct match if it is in the same category (based on the ground truth) as the query image. Precision (percentage of retrieved images that are also relevant) and recall (percentage of relevant
We at first evaluated the effectiveness of the concept-based feature representation scheme compared to the two well known low-level feature representation schemes, the MPEG-7 based Color Layout Descriptor (CLD) and Edge Histogram
Euclidean similarity matching in the different feature spaces. By analyzing Fig. 8 , we can observe that proposed concept-based feature representation schemes performed much better for both the collections compared to the CLD and EHD based features in terms of precision at each recall level. The better performances are expected as the concept features are more semantically oriented that exploits the domain knowledge of the collections at a local level.

Fig. 9 shows the PR graphs of the automatic query expansion approaches based on the local analysis (as described in Sec-clear from Fig. 9 that the performances were improved for both the collections for the local analysis based query expansion approaches as compared to the case when no query expansion is performed on the concept feature space. The performance we achieved around 5 X 15% performance improvement in precision at each recall level for the medical collection and similar mances in image domain and the results are consistent to the performances in the text domain as reported previously ( Attar &amp; Fraenkel, 1977 ).

To check the consistency of the query expansion approaches based on the local analysis by employing both correlation and metric cluster, we also considered five iterations of feedback and compared the performance by considering the average precision within the top 20 (e.g., P(20)) retrieved images as shown in Fig. 10 . From Fig. 10 , we observe one common trend Precision Precision that the precision increases during the first 2 X 3 iterations for both approaches under the medical and photographic collec-cludes that the performance of the query expansion approach is consistent from one iteration to another.
Finally, Fig. 11 shows the PR graphs of the automatic query expansion approach based on the global analysis (as described only need to exploit the information from the global cluster and do not require any feedback information. The query expan-P(20) when compared to the performances based on the local analysis based query expansion. Although the performances for the query expansion based on local analysis is slightly better due to the query-specific nature of the expansion algorithm as mentioned before. The performance is also compared with a query expansion approach based on performing similar algo-based on each query term, it is effective to select expanded terms based on a single virtual query vector only.
The results were also evaluated by comparing the overall average precisions among the average precision on top 20, 30, 50, and 100 retrieved images with global query expansion ( X  X  X E Global (Sim) X  X ) and without any expansion with different number of added concepts. From Tables 4 and 5 , it can be observed that the improvement by the expanded queries increases when the number of additional concepts increases. But after adding certain number of concepts, the performance started to concepts contain better information and when the number gets larger, the expansion approach might add the concepts that are not related to the relevant images.
 the same category as the query image based on the concept feature space. Whereas, for the query expansion based on local we can see that the query expansion approach provides better precision in top ranked images compared to the approach when no query expansion is used. 8. Conclusions
We have investigated automatic query expansion techniques in the CBIR domain, inspired by the ideas from the text re-trieval domain in IR. The decision to rely on techniques from the text retrieval domain and generalize them to our concept feature-based image representation scheme has proven effective, as demonstrated empirically on two largely different im-age collections. The proposed expansion techniques exploit the correlations among the concepts based on both local and glo-bal analysis. Due to the nature of the concept-based image representation schemes, there always exists enough correlations among the concepts. Hence, exploiting this property reduces the concept-mismatch problem and removes the burden from the users to provide feedback information to a system. For the feature representation, we limited our approaches by mod-lections irrespective of their variations and occlusions. However, the main focus in this work is to explore the query expansion and the consequent retrieval to prove its effectiveness in the image domain. As object recognition techniques ma-Acknowledgments
This research is supported by the Intramural Research Program of the National Institutes of Health (NIH), National Library of Medicine (NLM), and Lister Hill National Center for Biomedical Communications (LHNCBC). The authors would like to thank the CLEF organizers 2 for making the databases available for the experiments.
 References
