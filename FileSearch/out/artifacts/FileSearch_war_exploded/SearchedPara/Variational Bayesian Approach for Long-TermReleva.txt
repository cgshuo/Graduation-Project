 Most information filtering (IF) systems build user models to  X  X ecommend X  new and relevant information to users accord ing to their preferences in an overloaded store. For instance, Amazon.com offers a recommendation service to its cus-tomers to help them in discovering interesting products and improve their expe-rience. Motivated from consumer psychology researches, the content-based image suggestion (CBIS) is a new type of IF systems which uses both visual (images) and contextual (e.g. user X  X  location and time) information in the definition of user models [2,4,3]. A straightforward application of CBIS in Amazon.com could be, for instance, the personalized recommendation of new fashion clothes and accessories.

Product collections are dynamic and changing continuously. In fact,  X  X ew products X  are added to inventories and thus made available to customers on a regular basis. On the other hand, users may change their appreciations on some products, for instance, relevant on es become irrelevant and vice versa. The change in user needs has been explained by consumer psychologists by  X  X irect X  and  X  X erived X  explanations [9]. Direct ones refer to psychological aspects that may be either intra-personal (e.g. need for novelty and information) and inter-personal (e.g. personal identity or affiliation to a group).  X  X erived X  explanations are those motivations such as advertisements, changes in prices and incomes, and user X  X  maturation. The recommender system should offer a new interaction modality which allows users to provide new relevance feedback data (judgements) on the suggested products  X  X o notify X  recent long-term needs. The new data serve to track the change in users long-term needs. We have noticed that the majority of existing IF approaches [6,8,13,2] were designed mainly to model  X  X ast X  data sets. They learn statistical models fro m the rating data co llected from users in the past. Then, the learned models ser ve to predict  X  X nce X  all the ratings of products to all users. This scenario has been widely employed as an experimental design to validate existing IF approaches. They have not considered the evolution of user needs over time [9]. To the best of our knowledge, the issue of using user feedbacks in recommender systems has not been addressed so far.

In this paper, we motivate an approach for taking into account  X  X ll X  user feedbacks in order to maintain up-to-date user models that represent with most fidelity  X  X ecent X  user needs. Even our approach is g eneral in the sense that it can be applied to many IF approaches (either collaborative [6,8,13] or content-based filtering [10]), we focus here on CBIS for image recommendation [3,2]. In order to illustrate the complexity of the problem, let us consider the example outlined by Figure 1 which shows the evolution of user appreciations over time on some products of the collectio n. For instance, the camera has been  X  X udged X  recently (i.e. one week before suggestion) for the first time by the user as relevant. There-fore, it is natural to consider similar cameras in the  X  X ear X  future as relevant for that user. However, the problem is not easy to handle for the piece of art on which we observe a high change (switch) in the user X  X  appreciation. In such a case, consumer psychologists suggest to favor recent data comparatively with older ones in making future recommendations. Therefore, the rating of the piece of art should be predicted more likely high.

The principle long-term relevance f eedback is  X  X o refine X  user models from the newly collected rating data. We formulate the problem probabilistically as follows. Given an old statistical user model (i.e. some probability distribution) and recent rating data (user feedbacks), the goal is to adapt that model such that both old and recent rating data are co nsidered in future image suggestions. 2.1 CBIS Data The domains of variables considered by CBIS are: a set of users U = { 1 ,...,N u } , an image collection X = { x 1 ,..., x N i } ,aratingscale R = { 1 ,...,N r } and a set of contexts E = { 1 ,...,N e } . x =( x 1 ,...,x D )isa D -dimensional descriptor that represents the visual appearance of the image such as the shape and texture. Note that in collaborative filtering (CF) [5], x is considered one-dimensional variable with no information about the content. The history D ue of each user u and context e contains data about past rating data on some images of the collection i.e. D ue = { &lt; x ( i ) ,r ( i ) &gt; | x ( i )  X  X  ,r ( i )  X  X  ,i =1 ,..., |D ue |} . 2.2 A Bayesian CBIS Model Before we define our approach for long-term RF, we need to set a model that fits the distribution of the set of user histories D ue . This model can be used to predict the ratings of unseen images. The Visual Content Context aware Flexible Mixture Model (VCC-FMM) [2] is graphica l model that integrates both content x and contextual e information in modeling users. It uses the visual information (color, shape, or texture) as an added value comparatively with CF approaches. The main principle of VCC-FMM is that  X  X imilar X  users prefer  X  X imilar X  images. Therefore, both users and images are clus tered into separate classes i.e. two hid-den variables z  X  X  1 ,...,K } (user class or attitude), c  X  X  1 ,...,M } (image class) label each rating data &lt; x ,r &gt;  X  X  ue . In addition, since x  X  X  is gener-ally high-dimensional, VCC-FMM motivated feature selection to remove noisy and uninformative visual features and improve the quality of clustering. An ad-ditional hidden variable  X  =(  X  1 ,..., X  D ) (feature relevancy) labels each image x such that  X  l =0( l =1 ,...,D ) corresponds to the case where the l th feature is irrelevant i.e. it follows a distribution independent of class-labels [4,7,3]. In other words, the class-conditional distribution of each feature is factorized as considering p (  X  l =1)=  X   X  l and after marginalization over hidden variables of la-beled (completed) data ( z , c ,and  X  ), the likelihood p ( D ue |  X  ) under VCC-FMM is given by (1). The reader is referred to [2,3] for a comprehensive description of the conditional independence assumptions among random variables.  X  respectively. p ( . |  X  l ) is a univariate distribution independent of class-labels and p ( . |  X  cl ) is the class-conditional distribution of the l th feature. The authors in [4,3] p ( . |  X  l ), respectively.  X  is the set of VCC-FMM parameters and h =( z, c,  X  ) refers to the hidden label associated with a rating data &lt; x ,r &gt;  X  X  ue . The authors in [4,3] proposed to learn VCC-FMM by minimizing a message length (MML) objective using the Expectation-Maximization (EM) algorithm. The result is a point estimate  X   X  that conditions the rating of unseen images i.e. p ( x ,r |  X   X  ). However, since users are not always willing to  X  X udge X  (feedback) sufficient num-ber of images, there is only a small amount of data that is insufficient to  X  X efine X  accurately VCC-FMM. In fact, the point estimate  X   X  is unbiased only in the limit of large amount of data. Note that VCC-FMM does not provide generative semantics at the level of users since  X  Z ue are simply multinomial parameters.
We propose to overcome both issues by employing the Bayesian framework as a principled way for rating predictions. We consider all VCC-FMM parameters  X  as random variables with an initial uncertainty defined by a prior distribution p (  X  ). Then, this uncertainty is updated from the data D ue through a posterior distribution p (  X  |D ue ) which captures the generat ive semantics of VCC-FMM parameters. Now, the predictive distribution p ( x ,r |D ue ) is no longer dependent on a point estimate since all nuisance parameters  X  are integrated out weighted by their posterior distribution as The new model (2) is referred to as Bayesian VCC-FMM which formulates CBIS as a prediction problem.

We employ the exponential-conjugate framework in which both p (  X  )and p (  X  |D ue ) are conjugate (same functional form) to p ( D ue |  X  ). As we will show in subsection 2.5, this framework allows us to define accurate analytic approxima-analytically. Variational methods lower-bound the marginal log-likelihood of all user histories log p ( D ) , D =  X  ue D ue , by a tractable objective F in the expo-nential form [1]. These methods propose an approximate posterior distribution Q (  X , H ) over parameters  X  and hidden variables H . Then, the lower bound is de-fined by the marginal log-likelihood minus the Kullback-Leibler (KL) divergence between the true posterior and the approximate distribution Q D denotes the data set of all users and all contexts. H = { h 1 ,...,h |D| } such that h t =( z t ,c t ,  X  t ) ,t =1 ..., |D| , denotes the label associated with the t th rating data. The optimization of (3) with respect to Q is performed using an efficient Variational Bayesian EM (VBEM) algorithm [1]. The result is a distribution Q  X  that best approximates the true posterior in terms of KL divergence.
 Setting p (  X  )and Q (  X  ). In the exponential-conjugate framework, we consider are Normal-Gamma distributions. For instance,  X  cl  X  X  ( m l ,f X   X  1 cl )and  X  cl  X  G (  X ,  X  )where m l is set to be the mean of all the data. The parameters f,  X ,  X  are set to form broad and uninformative priors ( f =  X  =  X  0). The approximate Normal-Gamma distributions. Finally, the approximate posteriors of hidden vari-2.3 Long-Term Relevance Feedback We define the long-term RF as the mechanism that takes into account recent feedbacks provided by users so that rating predictions are always made based on recent long-term user needs. Long -term RF data provided by user u in context e that they are not used in the learning pha se, and their temporal ordering (i.e. by t ) is important. These data may be either positive (like) or negative (dislike) and constitute an important expression means of the preference change. A user may provide a negative feedback in order  X  X o penalize X  a suggested image and notify the CBIS system that he/she would not r eceive similar images in the future. One possible cause of such event is the satisfaction of the user X  X  need in that content i.e. future consumption of similar images will not generate psychological stimuli. Also, the non-suitability of the context (e.g. busy user at work) may contribute to the generation of negative feedbacks. Positive feedbacks serve  X  X o strengthen X  a newly discovered informat ion need (e.g. novel interesting images) that is not fully saturated. To maintain the user X  X  trust over time, CBIS should  X  X efine X  user models to handle both positive and negative feedbacks.
 Formally, at any time, the posterior distributions Q (  X  ) of Bayesian VCC-FMM should represent recent user needs. Th erefore, one possible implementation of long-term RF is to maximize the objective (3) from D X  X { s } ue in order to  X  X elearn X  a new model parame terized by a new distribution Q  X  . However, this solution is impractical due to its prohibitive cost in terms of storage (old history) and computing (learning) as the numbers of users/images are generally high. According to the Bayesian VCC-FMM presented previously, we identify Therefore, we propose to implement mo re efficiently the long-term RF as the process that  X  X pdates X  those distributions. The input data is a model Q (of old user needs) and D{ s } ue . The output of long-term RF is a new model  X  Q that represents both old and new user long-term needs. The Bayesian framework offers a principled way to update the posterior distributions from new data, for instance, by updating the sufficient statistics of variational parameters using Bayes rule. However, we argue in accordance with psychologists [9], that the straightforward maximization of the variational lower bound (3) w.r.t Q is not suitable for long-term RF due to the following facts. First, users with  X  X are X  feedbacks will see their models updated slowly comparatively with other users with more RF data. Second, (3) considers all RF data in D{ s } ue with equal importance which does not favor recent user needs and may not capture the switch in appreciations. We propose rather the maximization of a discounted expected lower bound corresponding to a  X  X ixed X  amount of T  X  X eighted X  RF data. The t th RF data d t  X  X { s } ue is weighted by a time-dependent forgetting penalizes older feedbacks fits well our goal [12]. The  X  X iscounted X  lower bound of the expected log-likelihood is where  X  ( s )=( s t =1  X  ( t ))  X  1 is a normalizing constant. It can be shown that the following mathematical property holds:  X  ( s )  X  ( s )=  X  ( s  X  1) 1  X   X  ( s ) .
Now, the new user model  X  Q can be identified by maximizing (4) w.r.t three user-specific Q distributions from each recent RF data d t  X  X { s } ue taken indi-vidually and after d t  X  1 . We present in the following, an Online version of VBEM we have already updated Bayesian VCC-FMM from D{ s } ue  X  X  d s } .First,in the VBE-step, we maximize L  X  ( D{ s } ue ,Q ) w.r.t Q ( h s ) while  X  Q (  X  )issetto Q (  X  ) in order to make the discounted lower bound as tight as possible to the true expected marginal. Aft er that, in the VBM-step,  X  Q (  X  ) is obtained by max-imizing (4) given  X  Q ( h s ). The posteriors of hidden variables are computed in the VBE-step as | a n | = m a nm and a n =( a n 1 ,...,a nA ) is an arbitrary vector. Also, we have E
We show how to derive the recursive u pdate formulas in the VBM-step of  X  Q (  X  ) from d s .Weusethesuperscript( t ) on the variational parameters to denote their values after an update from d t ,t &lt; s . From (8) and (9), and since log Q (  X  Z |  X  Z ue )=const+ K z =1 (  X  Z z  X  1) log  X  Z z + logarithm of a Dirichlet distribution parameterized by Similarly, we get the recursive update formula for  X   X  R zcr ,  X  Z ,and  X  R  X  ( x )= d log  X  ( x ) is the digamma function and  X   X  1 is its inverse which can be computed in a fourteen digit accuracy in five iterations [11]. Note that one could also update all Q distributions from D{ s } ue . Empirically, this method does not provide significant improvement of the modeling accuracy. 2.4 New Image Data One known weakness of CF approaches is their inability to recommend unrated (i.e. novel) products. On the other hand, VCC-FMM can use the content of those images with an average relative decrease in accuracy about only 25% for 30% of novel images [4]. This decrease in performance is caused by errors in labeling some of these images that do not fall exactly into one of the existing image clusters. In practice, with an incr easing number of  X  X ew images X , the clus-tering structure underlying the collection changes considerably (e.g. shape and density of clusters) which may affect th e suggestion accuracy. In addition, the early inaccurate esti mators obtained using few image data can be improved from new images in order to form well-identified clusters by penalizing (i.e. discount) old image data. Therefore, we advocate to  X  X eadjust X  also image clusters from the content of new images using the same methodology employed for long-term RF but with different Q distributions. Indeed, the clustering structure underly-Normal-Gamma distributions presented in Subsection 2.2. Since each new image x is unrated, we propose to compute its posterior distribution Q ( c x |  X  C x )inthe VBE-step from the visual content only. The impact of this assumption on the prediction accuracy is evaluated i n experiments. Let us consider a set X{ s } of s new images ordered by their arrival tim e. We update the clustering structure from the last image x  X  X { s } as follows. In VBE-step, we compute the posteriors of hidden variables c and  X  Following long-term RF, one could obtain the updates in VBM-step as creasing numbers of new images and long -term RF data, the model order defined by M and K may change (e.g. new classes may be added). Our Bayesian formu-lation of CBIS allows us to identify the optimal model order by monitoring the behavior of the lower bound of the likelihood as a model selection criterion. 2.5 The Predictive Distribution After training, we approximate p (  X  |D ue )in(2)by Q (  X  ) i.e. p ( x ,r |D ue )
Q (  X  ) p ( x ,r |  X  ) d X  . The predictive distribution (2) can indeed be calculated analytically as where St( . | a, b, c ) denotes a univariate Student X  X  t-distribution with mean a , precision b ,and c degrees of freedom. The rating is predicted using the max rule 3.1 Goal and Data Sets In this section, we evaluate our long-term RF on the real CBIS data set used in [4,3]. This data set D contains 13446 rating data collected from 27 subjects during a period of three months. Subjects expressed the relevance of images on a five star rating scale. The context information is defined as a combination of location L = { in  X  campus, out  X  campus } and time as T =( weekday, weekend ). Moreover, for each rating data is associated a variable indicating the day of its acquisition. The image collection contains 4775 natural and man-made images (41 classes). Image data is represented using the color correlogram for image texture representation and the edge orientation histogram for shape. Therefore, a visual feature vector is represented in a 40-dimensional space.

We evaluate two evolution settings of Bayesian VCC-FMM. In the first one, the model is updated from only from long-term RF data provided by users. The second setting deals with an image coll ection growing over time whose model is updated from new images. We refer by  X  X pdated-VCC-FMM X  to our pro-posed approach for both settings. For the forgetting factor  X  ( t ), many choices can be adopted depending on the relative importance attributed to the new data comparatively with older ones. Mor eover, one could consider user-specific forgetting factors (i.e.  X  u ( t )) to distinguish those users with highly changing long-term needs from the others. In our experiment, we have defined two variants of  X  X pdated-VCC-FMM X  depending on the weighting factor used:  X  (1) ( t )=1(no 3.2 Design of Experiments and Evaluation Metrics Due to dependence of long-term RF data on time, we propose a new experimental design to validate the proposed method based on the collected data set D as days). For convenience, we introduced th e user and context information to each rating data. Let D t be the set of ratings provided by users at time t .Wedenote by X t the set of rated images in D t . We learn Bayesian VCC-FMM from rating data provided during the first 30 days D train = 30 t =1 D t to define initial user models. Finally, we measure the rating prediction accuracy in terms of the mean absolute error (MAE) which is the average of the absolute deviation between the recent ratings and the predicted one s. We investigate t he importance of long-term RF over time, by updating Bayesian VCC-FMM using D t and then computing MAE on D t +1 as for the i th observation (see subsection 2.5). Let X t new be the set of  X  X ewly X  discovered images at time t , those images that have not been rated beforehand. We have X t new = { x | x  X  X  t , t &lt;t : x  X  X  t } and their corresponding ground truth rating data D t new = { &lt;u,e, x ,r &gt;  X  X  t | x  X  X  t new } . The importance of using new image data (subsection 2.4) is investigated by first updating Bayesian VCC-FMM from the set of new images X t new and computing MAE on D t new .We have found that only 45% of images were rated during the first 30 days. 3.3 Results Figure 2 shows the average MAE over successive time intervals (5 days). It is re-ported that long-term RF data is an important indicator about the evolution of user needs over time since both Updated-VCC-FMM algorithms outperform the non updated variant of the model (at least: 7 . 74% in average, 15 . 4% at day 55). When recent RF data is used, Bayesian V CC-FMM predicts more accurately fu-ture ratings. It is also reported that the ideal way to use such data, is to  X  X orget X  slightly old RFs by attribut ing more importance to recen t ones. For instance, the variant  X  X pdated-with-discount X  improves after 55 days both its initial MAE 5 ( X  X ay 5 X ) and that provided by  X  X pdated-no-discount X  by 5 . 65% and 10 . 81%, respectively. The first improvement can be explained by the availability of more data to refine user models.

From Figure 3, it is reported that updating the model from new image data is also an important process that ensures a better prediction of ratings. This fact is due to the improvement of the quality of the image collection modeling (i.e. well-identified image clusters). Moreover, by attributing more importance to new images, the clustering structure is better uncovered since earlier inaccurate estimators are penalized. H owever, MAE increases (5 . 7%) after 680 images due to the unavailability of user judgements on these new images that can be used to fine tune the model. Indeed, recent images inherit the relevance of older ones which does correspond necessarily to any potential change in user needs. We have also analyzed the behavior of some existing CF approaches: the Aspect model [6], Flexible Mixture Model (FMM) [13], and User Rating Profile (URP) [8]. All these models are learned on D train (first 30 days). Since these CF approaches are unable to predict the ratings for  X  X ew images X , we compute the error MAE eval only on rated ones. In other words, the evaluation data is formed as D eval =  X  t&gt; 31 D t such that it contains only images that have been rated in D train . Note that this experimental setting is different from the commonly used n -fold cross validation which does not consider arrival time of rating data.
Table 1 shows that average MAE eval during a period of 55 days after the learning, increases for all approaches (except for Updated-VCC-FMM with dis-count) comparatively with their baseline MAE 5 . Moreover, for these approaches, we observe a significant increase of th e error (at least 20%) in the most recent rating prediction (i.e. MAE 55 ) comparatively with MAE 5 .Afteralongperiod of time, initial user models are no longer suitable to predict current needs of users. Note that, the performance of VCC-FMM no-update comparatively with CF is explained by the added value of both visual and contextual information, as argued in [4,3]. In this paper, we have motivated the problem of tracking both changes of user long-term needs and product collections over time. We formulated the problem using a Bayesian model, learned continuously and efficiently by penalizing old data comparatively with recent ones. Th e proposed method has been applied successfully in content-based image sugge stion. Experiments showed a significant improvement of the prediction accura cy. This method is general and can be extended straightforwardly to many statistical collaborative filtering models. The completion of this research was made possible thanks to Natural Sciences and Engineering Research Council of Canada (NSERC), Bell Canada X  X  support through its Bell University Laboratories R&amp;D program.

