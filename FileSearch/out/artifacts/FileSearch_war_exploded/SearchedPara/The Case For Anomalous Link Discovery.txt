 In this paper, we describe the challenges inherent to the task of link prediction , and we analyze one reason why many link predi c-tion models perform poorly. Specifically, we demo n strate the effects of the extremely large cl ass skew associated with the link prediction task. We then present an alternate task  X  anomalous link discovery (ALD)  X  and qualitatively demonstrate the effe c-tiveness of simple link prediction models for the ALD task. We show that even the simplist ic structural models that perform poorly on link prediction can perform quite well at the ALD task. Link prediction, anomalous link discovery, relational lear n ing. Modeling the link structure of relational data is a key cha l lenge of relational learning. To date, many link modeling e f forts have focused on the task of link prediction : given a dynamic graph representing objects and their relationships, predict which new relationships will appear in the near future [7] [10] . A fundamental challenge in link prediction is a highly skewed class distribution  X  as networks grow and evolve, the number of negative exa m-ples (disconnected pairs of objects) increases quadratica lly while the number of positive examples often grows only linearly. Thus, the evaluation of a link prediction model is hampered by the co m-putational cost of evaluating all possible pairs of objects for which a link might exist , and the highly skewed cla ss distribution i n-creases the variance of the model. As a result, most attempts at accurate link prediction have produced models with very low accuracy.
 We propose the alternative task of anomalous link discovery (ALD): given a static or dynamic graph rep resenting objects and their relationships, identify those links that are anom a lous. In this paper, we equate anomalous links with those that are statistically unlikely, and we contend that, in many cases, the most  X  X nteres t-ing X  links in the data are those that are st a tistically unlikely. A myriad of link models can be found in the literature [4] [7] [9] [10] [11] . They vary in complexity and effectiveness at probabilistically modeling link structure in relational data. Many such models, especially those that rely on link structure alone, can be crippled by the variance introduced by im balanced data. Ho w-ever, as we will see below, even a very simple model such as one based on the Katz measure [7] can be very effective at the ALD task. Probabilistic modeling of link structure is a growing ar ea of r e-search in statistical relational learning [3] . Many algorithms for attacking this problem approach it as a binary classific a tion task in which pairs of objects in the data comprise i n stances. Given any pair of ob jects, the model assesses the probability of a new link appearing between them at some point in the future. While some link models found in the literature take into account object attri b-ute information [11] , t he models we cons ider in this paper use only graph structure , because such models are sufficient to exa m-ine the effects we wish to investigate . Figure 1 . Logarithmic plot of actual and possible collabor a-tions be tween DBLP authors, 1995 -2004.
 Figure 2 . Publications of DBLP authors as a proportion of possible collaborations, 1995 -2004.
 While this approach to link modeling seems straightforward, the combinatorics of the task poses formid able challenges. The nu m-ber of possible links is quadratic in the number of objects, but in many domains where link prediction is e m ployed the number of actual links added to the graph in any time period is only a tiny fraction of this number. The result is that algorithms for link modeling must contend with a extremely large class skew, making both learning and infe r ence difficult [5] . Figure 1 illustrates the problem for data from the Digital Bibliography &amp; Library Project (DBLP) over a ten -year span. During this time period, the nu m-ber of authors i n creased by a factor of 13, from approximately 22 thousand to 286 thousand , and the number of possible collabor a-tions i n creased by a f actor of 16 9 . However, the number of actual collabor a tive papers increased by only a factor of 21 .
 Figure 2 depicts the proportion of possible collaborations between authors that occur during this same time period. This ratio repr e-sents the class distribution for the pairwise link prediction pro b-lem. By 2004, less than one -thousandth of one percent of DBLP author pairs had written a paper together.
 In the face of such an uneven class distribution, even the very accu rate binary classifiers can have extremely low raw accurac y in predicting link structure [7] . T he high error rate results from a combination of the variance in the model X  X  estimates and t he i m-balance in the class distribution . The high propo r tion of negative instances (unlinked object pairs) means that even when a rel a-tively low percentage of negative instances are assigned scores similar to the positive instances , the model will produce an e x-tremely large raw number of false positive infe r ences.
 Figure 3 . ( top) Schematic representation of the effec ts of large class skew on a model X  X  ability to discriminate between classes. In the first case, the two distributions are easily di s-tinguished. (bottom) In the second case, large class skew vi r-tually eliminates our ability to produce highly accurate pred ictions.
 We illustrate the problem schematically in Figure 3 . Consider a hypothetical data set and some statistic s that is measured on each instance pair. We assume that the values of s are drawn from separate distribu tions for linked (positive) and non -linked (neg a-tive) object pairs, illustrated in Figure 3 (top) as Normal distrib u-tions with differing means. In the face of large class skew, the entirety of the positive class distribut ion is  X  X wallowed X  by the tail of the negative class distribution, as seen in Figure 3 (bottom). In the latter case, it is virtually impossible produce highly accurate predictions by examining values of s . Attempts to ov ercome the variance issues will usually introduce additional bias to the class i-fier [2] .
 Figure 4 . Relative f requency distribution s of the log -Katz st a-tistic for author pairs that include Jiawei Han for all possible coauthors (top) and actual coauthors (bottom).
 As an example, consider the case of Jiawei Han, a professor at the University of Illinois at Urbana -Champaign and a KDD 2005 program committee member. We took a snapshot of the DBLP databas e as it existed in 2002, and identified 39 tho u sand  X  X ore authors X  (authors who had several publications in the eight pr e-ceding years) much in the same manner as Liben -Nowell and Kleinberg [7] . In the standard link prediction task, our goal is to predict which authors Prof. Han will collaborate with in the future (e.g., 2003 -2004). To discriminate between positive coauthor pairs (those that Prof. Han does write a paper with) and negative pairs, we use the Katz measure (see Se ction 2) , which Liben -Nowell and Kleinberg ha ve shown to be a (relatively) effective statistic for link prediction tasks [7] . The relative frequency di s-tributions for each class can be seen in Figure 4 . Clearly, the values of the Katz measure for Prof. Han X  X  actual coauthors are drawn from a different distribution than the author population at large. This would lead us to believe that an accurate model for link prediction can be constructe d fairly easily. However, the abs o-lute frequency distr i butions shown in Figure 5 tell a different story, showing the effects of the large class skew. The distrib u-tions depicted are the same as those shown in Figure 4 , but plotted with actual frequency counts rather than relative ones. According to DBLP, Prof. Han co l laborated with 63 different core authors in 2003 -2004 (out of a possible 39,000), and it becomes virtually i m possible to dif ferentiate scores for positive instances from the tail of the score distribution for negative instances (the pro b lem is actually even worse than depicted, as computational constraints allowed us to calculate the Katz measure for only 10,000 possible coauth ors). We see here how the variance associated with the class imbalance can drown out the separ a bility achieved by the simple model. Thus a Katz -based ran k ing classifier that draws a classification threshold generous enough to capture even half of the act ual positives will misclassify hundreds of negative pairs. Figure 5 . Actual frequency distributions of the log -Katz stati s-tic for negative Jiawei Han author pairs (top) and po s i tive author pairs (bottom).
 The results of these effects are models of questionable utility. The vast majority of new links are not correctly predicted, and the number of false negatives is quite substantial [7] . In add i tion, the links that are predicted correctly tend to be the  X  X  b vious X  ones, those that are out of the  X  X each X  of the tail of the massive negative sampling distribution. Finally, this sort of pairwise link prediction is often computatio n-ally intractable [9] . Given new obj ects in the graph, it may not be possible to efficiently consider their link probabilities with all other objects. Again, attempts to restrict the search introduce bias that may eliminate the possibility of predicting the most  X  X nteres t-ing X  links.
 Given t he issues described above, the link prediction task is a daunting undertaking. Furthermore, due to the challenging co m-binatorics, it may very well be impossible to satisfactorily address link prediction as currently specified. In the face of these facts, what is the aspiring link modeler to do? One p o tential avenue is to refocus structure learning efforts away from predicting link existence and toward predicting properties of existing links. Sp e-cifically, we propose identifying anomalous links that actu ally appear in the data. By respecif y ing the task, we can leverage existing algorithms to gain i n sight into the structure of graphs. In some ways, anomaly discovery can be seen as the most a b stract of knowledge discovery tasks . The goal is to identify  X  X utliers X  in a data set. In traditional data mining, anomaly detection alg o-rithms are most often employed in domains that deal with security issues , pick ing out suspicious login se s sion s at a computer or strange financial transacti on s .
 Figure 6 . Relative frequency distribution of the log -Katz measure for Jiawei Han's collaborations, 1995 -2004. The shaded region represent the collaborations from the final two years.
 In the case of relational learning , anomaly detection involves modeling the likelihood of links that appear in the data . Rel a-tional learning techniques seem especially suited to the ano m aly detection problem, because structured data lend themselves to a host of possible methods for find ing interes t ing instances in a data set. As we have seen, the interesting facets of our data may be defined by the relations between ent i ties as well as the intrinsic properties of the entities themselves. D espite this seemingly nat u-ral alignment of task s and techniques, anomaly detection tasks have been all but ignored in the literature on relational learning [8] .
 Furthermore, in many domains, identifying anomalous links may actually be more useful than predicting links. For instance, bi b-liometric data are often the target of link predi c tion [3] . However, is it more useful to  X  X redict X  coauthorships and citation, or to realize when an interesting (or unlikely) collaboration occurs? In the case of Internet applications, is predicting which web pages will potentially link to each other very helpful? Or would we rather be able to comb the new links that are created each day and be alerted when surprising connections are made? Obviou sly, the utility of ALD algorithms is domain dependent, but even a cu r-sory examination of the literature suggests several possible appl i-cations. F i nally, ALD models scale well with the size of the graph, una f fected by an ever -widening class distribution g ap. Returning to the example of Prof. Han, we can examine the pro p-erties of the collaboration links that appear in 2003 -2004, and examine their likelihood given past collaborations. Figure 6 shows the distribution of the Katz measure for all of Prof. Han X  X  collaborations with core authors dating back to 1995. Using this distribution, we can rank the new collabor a tions by likelihood. On one extreme, we have a collaboration between Jiawei Han and Jian Pei of SUNY Buffalo, w hich was measured to be the most likely collaboration involving Prof. Han with a Katz score of 6.96x10 -4 . An examination of the authors X  home pages bears this out ---the two have written dozens of papers together over the years, thus their recent joint w ork should not surpris e anyone . However, not all of Dr. Han X  X  collaborations are so predictable. During the same year, he authored a paper with Martin Ester of Simon Fraser University. According to a the Katz measure, this is one of the more unlikely of P rof. Han X  X  collaborations in 2003 -2004, with a score of 4.3x10 -7 . Both authors are acco m plished scientists, yet until last year they were only connected in the authorship graph by paths of four or more hops. A visual repr e-sentation of the subgraphs conne cting the two pairs of authors is shown in Figure 8 . To test the validity of our intuitions concerning the use of link prediction techniques for anomaly detection, we exa m ined the author graph drawn fro m DBLP data. In our represe n tation, we have a single object type, representing authors. Journal and co n-ference papers are represented as links that connect the authors together through coauthorships. Thus a single paper with four authors will spawn ten different items in the graph: a node for each author, and six links expressing the pairwise coauthorships between them. A visual representation of the relational schema can be seen in Figure 7 . N ote that for the purposes of our exper i-ments, our models operate on the link structure alone, and do not incorporate any paper attribute information.
 Figure 7 . Relational schema DBLP data: authors are repr e-sented by author that a re linked through co -authored p a pers. tom). The Katz scores for the two subgraphs differ by t hree orders of magnitude. (a) (b) (c) Figure 9 . Sampling distributions for Iinked (bottom) and u n-linked (top) author pairs for three measures of link likel i hood: (a) graph distance, (b) delivered current , and (c) Katz sc ore . We tested several measures identified in the link prediction liter a-ture as being useful at predicting links [7] . The hist o grams in Figure 8 illustrate the  X  X iscriminative ability X  for three of these measures. In each ca se, the sampling distrib u tion for negative (unlinked) pairs is shown directly above the distribution of pairs that contain links.
 The first statistic shown is simple graph distance between the objects in the pair. While the linked and unlinked values are clearly drawn from different distributions, there is still a great deal of overlap between the two.
 The second measure depicted, called delivered current , is a mea s-ure of the maximum deliverable current when the nodes in the subgraph connecting the start a nd end nodes are treated as wired resistors in an electric circuit [1] . A quick comparison shows this measure to be more useful than simple graph di s tance.
 Finally, we show the positive and negative distributions for the Katz measure [7] used in the examples in section 1.2. The Katz measure is a weighted sum of the number of paths in the graph that connect two nodes, with shorter paths being given the most weight: Above, p i is the number of paths of length i connecting nodes s and t , while  X  is an input parameter. Here, we have clear separ a-tion between the bulk of each distribution. Regardless, for the reasons described above, even the Katz measure is ineffe c tive at predict ing links.
 Of great interest, however, is the leftward tail of the Katz distrib u-tion for positive pairs. This tells us that a small number of new links in the graph appear in structural contexts that appear to be random. It is these links (the statistica lly unlikely ones) that d e-serve our interest in the DBLP domain  X  they represent collab o-rations between authors from vastly different spheres of the academy. To verify the ability of the Katz measure to help us identify anomalous links, we conducted a sy nthetic experiment. We i n-serted  X  X rtificial X  links into the data set, randomly selected from the space of all collaborations, and calculated the Katz score for each one. Figure 10 shows where these scores lie in the dis trib u-tion of actual links (shaded portions of the bars in the histogram represent the synthetic links). As we might expect, the Katz va l-ues for the artificial links are grouped in the tail of the overall distribution. However, given the presence of the  X  X nteresting X  links as described above, its understandable that these actual anomalies could be confused with the appa r ent ones.
 It should be noted that in order to produce non -trivial values of the Katz score (that is, values not equal to zero), the pair of authors in question must be connected in the graph by a minimum path length of four or less. Furthermore, pairs that are not so co n-nected were not considered in our synthetic anomaly experiments. As most randomly selected pairs are indeed not connecte d by such a short path, it can be assumed that extending our Katz calcul a-tions out to paths of length five would shift the mean of the Katz distribution for the sy n thetically inserted links further out toward the tail of the Katz distribution for actual li nks.
 Finally, we conducted a qualitative examination of a subset of the dataset to test our intuition about the usefulness of the Katz mea s-ure to find  X  X nteresting X  coauthor pairs. From the DBLP data set, we considered the 203 papers from 2003 -2004 (repre senting 450 pairwise collaborations) written by members of the program committee for the workshop on Multirelational Data Mining (MRDM) at KDD 2005, and calculated the Katz score for each pairwise collaboration. The overall distribution of Katz scores for the group is shown in Figure 11 . While the bulk of the distribution of pairs has a score between 0.001 and 0.0001 (note that the hist o-gram is plotted on a log scale), the distribution has a significant tail. It is these collaborations that are often the most interesting, as they are statistically indistinguishable from random pairings in the data. Likewise, pairs with high Katz scores represent links that are not une x pected given the existing structure in the data. Figure 10 . ( top ) Distribution of log -Katz scores for pairs in DBLP , with a rtificial links are represented by shaded r e gions . ( bottom ) An accompanying ROC curve for classifying anom a-lies.
 Figure 11 . Frequency distribution of log -Katz scores for coll o-aborations involving MRDM program committee me m bers in 2003 -2004.
 Below we present lists of the ten most  X  X ikely X  and  X  X nlikely X  papers, as ranked by the mean pairwise Katz score for all pairs of auth ors of the paper. Note that some authors may be omi t ted, as the data were drawn from the designated pool of  X  X ore X  authors. In addition, multiple papers written by the same group were disr e-garded for the sake of interest, and anomalous papers with (u n-ran kable) Katz scores of 0 were excluded.
 Top 10 Least Likely Papers of 2003 -2004 Top 10 Most Likely Papers of 2003 -2004 A cursory inspection of th ese results confirms our intuitions about the value of the Katz score in determining link likel i hood. The papers on the  X  X nlikely X  list have author lists sim i lar in character to the Han -Ester collaboration discussed in the previous section, made up of est ablished researchers from di f ferent  X  X elational neighborhoods X  within the graph. Omitted from this list is an extremely unlikely paper on  X  X oltage scheduling X  written by one of the authors of the paper you are reading now  X  so unlikely, in fact, that said author does not recall writing it. As it turns out, this lack of recollection is entirely warranted, as there are two co m-puter scientists with the name  X  X avid Jensen X , and our version of the DBLP dat a base mistakenly combined them.
 Conversely, the papers on the second list are written by pr o lific authors who are multi -connected by shared work and coauthors. Note, for instance, the presence on the list of the two chairs of the MRDM workshop (ranked fifth) as well as teams of authors who have collaborated d ozens of times in the literature. The vast majority of work dealing with probabilistic models of link structure addresses the problem of link prediction ( e.g., [7] , [9] , [10] ). To our knowledge, though, the simpler problem of anomal ous link discovery has been largely ignored. Ce r tainly, ALD could be cast as one of several challenges in structure lear n-ing identified by Getoor [3] , such as link type prediction (if we consider existential status as a type), link cardinality prediction, or existence and reference unce r tainty [4] . Lin and Chalupsk y X  X  work on  X  X arity analysis X  [8] seems to be closest in spirit to ALD in terms of motivation and approach, though it focuses on ident i-fying unique paths through the data graph rather than examining the statistical properties of individual links. A n obvious extension to ALD would involve combining the two a p proaches.
 While our work on using link prediction models to perform ALD is preliminary, the results so far are encouraging. Further exam i-nation and testing on additional data sets (both real and synthetic) is necessary before we gain a complete understan d ing of how these models work. Future work should also i n clude learn ing link models that combine a number of statistics (Katz measure, Falou t-sos measure, etc.) as well as object attributes to identify interes t-ing links rather than rely ing on a si n gle measure. Regardless of method, however , more attention to the anomaly discovery is warranted , because ALD gets at the heart of what defines relational learning a s a unique field  X  the meaning of relationships encoded in the structure of the data. The authors wish acknowledge the helpful input of Ross M. Fai r-grieve and Agustin Schapria .
 This research is supported by DARPA and LLNL/DOE La w-rence Li vermore National Laboratory and the Department of E n-ergy under contract numbers HR0011 -04 -1 -0013 and W7405 -E NG -48. The U.S. Government is authorized to reproduce and distri b ute reprints for governmental purposes notwithstanding any copyright not ation hereon. The views and conclusions co n tained herein are those of the authors and should not be inte r preted as necessa r ily representing the official policies or endorsements either e x pressed or implied, of DARPA, LLNL/DOE Lawrence Livermore N a tional La boratory and the Department of Energy, or the U.S. Go v ernment. [1] Faloutsos, C., McCurley , K., and Tomkins , A . Fast Disco v-[2] Friedman, J. On Bias, Variance, 0/1 Loss, and the Curse of [3] Getoor , L . Link Mining: A New Data Mining Cha l lenge. [4] Getoor, L., Friedman, N., Koller, D., and Taskar, B. Lear n-[5] Jensen, D., Rattigan, M., and Blau , H. Information A war e-[6] Le e, W. and Stolfo , S . Data Mini ng Approaches F or Intr u-[7] Liben -Nowell, D. and Kleinberg , J . The Link Prediction [8] Lin , S. and Chalupsky , H . Unsupervised Link Discovery I n [9] Mooney, R., Mellville, P., Tang , L., Shavlik, J., Dutra, I., [10] Popescu l , A. and Ungar , L . Statistical Relational Learning [11] Taskar, B., Wong, M., Abbeel, P., and Koller, D. Link Pr e-
