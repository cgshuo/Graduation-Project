 fi  X  1. Introduction
Anomalous operating condition and fault detection of indus-trial assets are the core of process engineers in industry. Effective detection ensures the product quality improvement and reduces the cost and the time of repair. Consequently, industrial assets safety and reliability are very important to ensure the continuity of production, to improve process operation, to increase plant throughput, to reduce process downtime and to comply with increasingly stringent environmental rules and safety regulations ( Lau et al., 2013 ).

Rolling Element Bearing (REB) is the most used solution for industrial machinery guiding in rotation. This critical component requires running with high reliability to decrease fault occurrences and fatal breakdowns of machineries ( Lei et al., 2007; Konar and
Chattopadhyay, 2011 ). It is well known that bearing defects are one of the most common fault sources in induction machineries (about 40  X  50%) ( Widodo and Yang, 2007; Frosini and Bassi, 2010 ). Failure surveys by the electric power research institute indicate that bearing-related faults are about 40% among the most frequent faults in for REB defect detection are a trivial task nowadays in the industry. been proposed to detect and diagnose bearing defects. These methods may be roughly classi fi ed into vibration and acoustic measurements, temperature measurements and wear debris analysis ( Nandi et al., 2005 ). The mechanical bearing vibration signals remain the most immediate, simplest, and richest source of information for understanding phenomena related to bearing defects ( Seungdeog powerful source to extract interesting information and to apply appropriate techniques. However, REB accelerations are considered as non-stationary and nonlinear ( Randall and Antoni, 2011 ). Besides, noises present a serious trouble in the study of this type of signals ( Zhang and Randall, 2009 ). Moreover, the relatively weak bearing signals are always affected by quite stronger signals (gear meshing, unbalance, bars, etc.) ( Randall and Antoni, 2011 ).
 proposed in the open literature to deal with the diagnosis of bearing faults. When a fault occurs on one bearing surface, the acceleration is characterized by the presence of periodic repetitive sharp peaks and further modulated by a number of harmonic frequencies ( Zhang and Randall, 2009 ). However, interesting information is often contained in the periodicity of impacts, rather than in the rest of the signal frequency content. Thereby, vibration signals are non-stationary and always are masked by machine noise ( Randall and Antoni, 2011 ). For this reason, conventional vibration analysis techniques, which were successfully employed for stationary signals such as fast Fourier transform, have not provided good and signi fi cant results based on REB vibration signals ( Braun and Feldman, 2011 ).

In the literature, non-stationary or transient signals are often decomposed into sub-bands where stationary and linear character-istics could be obtained and fault patterns are easily extracted ( Priestley, 1988 ). Consequently, Wavelet Transforms (WT) ( Wang et al., 2015 ), Empirical Mode Decomposition (EMD) ( Liu et al., 2015 ), Local Characteristic-scale Decomposition (LCD) ( Zheng et al., 2013a ), Ensemble Empirical Mode Decomposition ( Wang et al., 2014 ), and
Generalized Empirical Mode Decomposition ( Zheng et al., 2013b )were widely used for the processing of bearing vibration signals in the presence of nonlinear and non-stationary data. By analyzing some series of decomposed REB signals based on WT and EMD, it was demonstrated that the energy entropy changes in different frequency bands when a bearing fault occurs. Besides, EMD is more highlighted than WT in terms of mean fault characterization ( Tavakkoli and Teshnehlab, 2007 ).

After decomposing bearing accelerations into some linear and stationary signals, it is recommended to extract the most useful features. Bearing fault diagnosis is not an easy task, it is essentially a problem of pattern recognition. The most effective features and accurate classi fi ers are needed to obtain higher diagnostic accu-racy ( Li and Zhang, 2011 ).

Several previous works based on feature extraction and classi tion techniques have been proposed for bearing fault diagnosis. Yang et al. have used the discrete WT to decompose vibration and acoustic signals into different frequency levels. Then, some statistical measures were extracted from the fi rst-four levels. Also, an Arti
Networks (ANNs) combined with a Support Vector Machine (SVM) were used to classify the faults of small reciprocating compressor used to decompose vibration signals into different Intrinsic Mode Functions (IMFs) and then the Hilbert spectrum was computed to extract bearing fault features. Bin et al. (2012) have demonstrated that the WT generally has some shortcomings and dif fi culties in selecting suitable basic function because there are no standards or general selection rules for different tasks. However, the EMD is an automated method frequency. Saidi et al. (2014) have presented a combination of EMD and bi-spectrum. The computation of the bi-spectrum was based on the fi rst IMF which contains more information. The proposed combi-nation was promising but it needs always an expert intervention for the analyses of the bi-spectrum plot. Unfortunately, all these methods presented an of fl ine bearing fault detection. Generally, some holes were created in the tested REB and subsequently the fault detection ef fi ciency of the proposed method was given. In this case, the bearing vibration signals increase and the fault detection task become effort-less. In an industrial environment, REBs are in continuous rotation where fault characteristics are always submerged and hidden by noises. So, it is recommended to investigate bearing defects online by using run-to-failure histories.

The online bearing monitoring is very important to avoid unexpected breakdowns where the breakdown of a single machine can halt the production of the entire process chain.
However, investigations related to naturally induced and naturally progressed defects of REBs are relatively scarce. In fact, online detection of REB degradation for naturally progressing defect in damage stages is not available in the literature ( Shakya et al., 2014 ). Recently, some approaches have been proposed for the online bearing health monitoring. Pan et al. (2014) have proposed a new approach based on dynamic fuzzy neural networks where only consequent parameters were updated online. In Shakya et al. (2014) , various damage stages for naturally progressing REB defect were given online. For this, time domain, frequency domain and time  X  frequency domain were together under study. The Mahala-nobis distance was used as a trend parameter for bearing fault diagnosis. In Loutas et al. (2011) , the combination of vibration, acoustic emission and oil debris measures is used in an online condition monitoring of bearings and gearboxes. Several techni-ques were combined such as fusion technique, Principal Compo-nent Analysis (PCA) and Independent Component Analysis (ICA) to identify different damage modes. The computational time was not discussed in this work and with respect the de fi nition of failure thresholds was arbitrary. In Ben Ali et al. (2015b) , the combination of traditional statistical features and EMD energy entropy were jointed with the back propagation neural network for an online bearing fault diagnosis. The classi fi cation results were relatively low (93%) that is why the authors have proposed a health index for a more reliable online monitoring.

In this paper, an attempt is made to diagnose the state of bearings using a new nearly online method. The proposed method is based on the EMD feature extraction, linear feature reduction and feature classi fi cation using neural networks. The validation of the proposed method is based on bearing run-to-failure histories. This method is able to detect online perfectly the state of the bearing. The remainder of this paper is organized as follows: Section 2 is devoted to describing the used techniques in this work. This section describes the different steps of the EMD method. Also, a brief description of Linear Discriminant Analysis and Principal Component Analysis algorithms is given. Besides, this section details the different steps to implement the used neural networks in this work. Section 3 is dedicated to the experimental results by analyzing the proposed feature extraction, feature reduction and feature classi fi cation techniques. Section 4 gives a numerical analysis of the most effective features based on a mathematical criterion. Also, a good discussion and analysis of the experimental results by comparing the performances of the proposed method with some previous works is provided in this section. Finally, conclusions and prospects of this work are given in Section 5 . 2. Methods 2.1. Empirical Mode Decomposition (EMD)
EMD algorithm is developed from the simple assumption that any signal consists of different simple intrinsic modes of oscilla-tions called Intrinsic Mode Functions (IMFs). This adaptive decom-position method is especially applicable to the analysis of nonlinear and non-stationary signals ( Yu et al., 2006 ).
By the de fi nition, any signal x ( t ) can be decomposed as detailed in Table 1 ( Huang et al., 2011 ).
 The step (G) in Table 1 presents a stoppage criterion for the EMD which is one of the weaknesses of this algorithm ( Lei et al., 2013 ). Huang et al. (1998) proposed a robust way to access the IMF component of a signal as  X  Sifting process  X  . The sifting process is stopped by limiting the size of the standard deviation ( S computed from two consecutive results as 0 : 2 o S D  X 
Numerous publications of the EMD for bearing fault diagnosis have shown several advantages and very encouraging results.
Nowadays, EMD is one of the most powerful advanced signal processing techniques and it has been extensively studied and widely applied in fault diagnosis of rotating machinery. To achieve better results, it is recommended to combine the EMD with other signal processing techniques or arti fi cial intelligent techniques for an effective strategy for bearing diagnosis ( Lei et al., 2013 ). 2.2. Brief description of Principal Component Analysis
In literature, Principal Component Analysis (PCA) is the most used technique for feature reduction which means transforming the original features into a lower dimensional space. PCA, as a linear technique, is a quantitatively rigorous method for achieving data dimensionality reduction of the extracted features. The method generates a new set of variables, called Principal Compo-nents (PCs), which maximize the variance of the projected vectors.
Each PC is a linear combination of the original variables. All PCs are orthogonal to each other, so there is no redundant information. The PCs are a whole of an orthogonal basis for the data space.
Thus, the fi rst PC consists of the high variability, the second PC consists of the next highest variability and so on for other directions. The fi rst few components are kept and others with less variability are discarded ( Widodo et al., 2007 ). In this work, the PCA algorithm will be used to eliminate the non-signi features in the recorded vibration signals. The step by step procedure of PCA is provided below. Let us say we have N observations of M -dimensional data.

Step 1: To perform PCA we should fi rst compute the covariance matrix  X  A R M M ;  X   X  E {( x x )( x x ) T }, where x is the given signal, x is its mean vector, and E {.} is an average over an ensemble of N samples.

Step 2: Find matrix  X  of eigenvectors and diagonal elements of matrix D as eigenvalues of covariance matrix  X  as given by,
Step 3: Sort the eigenvectors of PCs in the decreasing order of importance of eigenvalues in D .

Step 4: Project the data into the directions of sorted eigenvec-tors by taking the dot product between the given data and eigenvectors.

Step 5: Select the fi rst few principal components depending on the containment of a given percentage of variability (like 95% or 98% depending on the problem). 2.3. Brief look into Linear Discriminant Analysis
Linear Discriminant Analysis (LDA) is a mathematical transfor-mation based on a linear discriminant combination. As the PCA method, LDA is used to reduce features by transforming the original features into a lower dimensional space. Typically, LDA is used to analyze the original dataset and to produce K 1 independent components where K is the number of classes.
Generally, LDA dataset preprocessing is more suitable for classi cation tasks than PCA ( Mouelhi et al., 2013 ): PCA tends to minimize feature variances of the same class although LDA tends to minimize feature variances of the same class and to maximize feature variances of different classes. The aim of LDA is to create new variables by maximizing discrimination between all classes.
New variables maximize the differences between the prede fi classes and minimize differences in the same class ( Subasi and
Gursoy, 2010 ). 2.4. Probabilistic Neural Network was by Specht in 1990. The different steps of PNN algorithm are well described in Specht (1990) . Brief, PNN is based on the computing of Bayes statistics for two categories ( A and B ). Conse-quently, for each p dimensional vector x , the state  X  could either be functions of the category A and B , l A and l B are the loss functions associated respectively with the decision d ( x )  X   X  B and d ( x ) is the prior probability of category A pattern occurrences and vice-versa for h B . We should note that the boundary of density probabilities A and B is given by f A x  X  X  X  h B l B h the pattern layer, the summation layer and the decision layer. The p nodes in the input layer consist of the p input vector compo-nents. The pattern layer is designed to receive all components of the input vector x . For each pattern node i , the product Z computed. To deal with the nonlinear feature distributions for any classi fi cation task, a nonlinear function, where x and W i should be normalized to the unit length, is introduced as follows: exp
Z
After computing the nonlinear function for all nodes, this function will be transferred to the summation layer. Afterwards, summation units sum pattern unit inputs which correspond to the desired category. The decision layer consists of two neurons that produce binary outputs taking into account the variable weight C with the following mathematical expression:
C where n A and n B is the number of training patterns from the category
A and B respectively. More details are given by Specht (1990) . 2.5. Simpli fi ed Fuzzy Adaptive Resonance Theory Map neural network (SFAM)
The Simpli fi ed Fuzzy Adaptive Resonance Theory Map (SFAM) neural network is a fast, incremental, supervised learning system for analog inputs ( Ben Ali et al., 2014 ). In 1993, Kasuba proposed the SFAM network which is a simpli fi cation of Fuzzy ARTMAP ( Venkatesan and Suresh., 2009 ). This neural network is a step ahead of Fuzzy ARTMAP in reducing the computation and archi-tectural redundancy.

As illustrated in Fig. 2 , the SFAM is formed of three layers; the input layer F 1 , the competitive layer F 2 and the output layer F
The activity patterns of layers F 1 and F 2 are fully intercon-nected. Each neuron is initially connected to every neuron on the other layer. All connections are weighted by synaptic weights lying between 0 and 1. Each neuron of the F 2 layer represents one category formed by the network and it is characterized by its weight vector W j ( j is the index of the neuron). The weight vector's size is equal to the dimension M of layer F 1 . In the training process, if the weights of a neuron are not modi fi ed, this neuron is called uncommitted. Inversely, once a neuron's weights have been modi fi ed, this neuron is named committed.

SFAM is based on a form of normalization called complement coding. The operation consists on taking the input vector and concatenating it with its complement. The resulting vector should be presented to the layer F 1 . Therefore, the dimension M of layer F is equal to the double of the input vector's dimension ( M
The F ab layer is connected with the competitive layer F 2 W ab weights to locate the appropriate class t of the input vector in the test mode.

The SFAM has a self-determining architecture: the training vectors are presented to the network, the output category nodes are grown and assigned to a particular class. If there is a new category of input training example, a new output category node is grown and its weights are set equal to the elements of the complement-coded input vector I .

For further applied training vectors, the subset hood of the weight vectors to the complement coded input is computed using the activation function T
I  X  X  X  I 4 W j  X   X  where 4 is the fuzzy AND operator;  X  is a very small value (typically 10 5 ); and j is the number of the current output category node.

The node with the highest T j ( I ), called the  X  winner  X  chosen ( G ) to represent the input vector. To know if associating W with I is a good match, the matching function MF ( I , W G the two is calculated as MF I ; W G  X  X  X  I
The matching function should be compared to the vigilance parameter  X  .

If MF ( I , W G ) r  X  , the winner G is disabled and the next most activated node is selected.

If MF ( I , W G ) 4  X  , a category agreement test between the winner and the input example is performed.

If the categories disagree, the vigilance  X  is increased by a small amount  X  and the winner is disabled. If they agree the SFAM is considered in a state of resonance and the weight vector W updated using the following formula: W where  X  is the learning rate introduced to select the mode of learning as follows:
If  X   X  1, the fast learning mode is selected with just one iteration of the training data.

Whereas if 0 o  X  o 1, slow learning is selected and it requires a number of iterations for the training.

Finally, when classifying, each test vector is applied in turn and its predicted class is that of the node with the highest activation. More details are given in Ben Ali et al. (2014, 2015a) . 3. Experimental results 3.1. Experimental setup and data recording The vibration signals used in this paper were provided by the Center for Intelligent Maintenance Systems (IMS), University of Cincinnati, USA, in collaboration with the National Aeronautics and Space Administration (NASA). A schematic of experimental test rig is shown in Fig. 3 . Four Rexnord ZA-2115 double row bearings are installed on the shaft. Each bearing contains 16 rollers (for each row), a pitch diameter of 2.815 in., a roller diameter of 0.331 in., and a tapered contact angle of 15.17 1 ( Qiu et al., 2006 ). Three tests were made. Each test is an experience of 4 bearings. In this way 12 bearings are used but only 4 bearings have reached failure with known defects. Each data set describes a run-to-failure experiment. It consists of individual fi les that are 1-second vibra-tion signal snapshots recorded at speci fi c intervals (every 10 min).
Each fi le consists of 20,480 points with the sampling rate set at 20 kHz. Records (row) in the data ASCII fi les are data points. Data collection is provided by NI DAQ Card 6062E ( Ben Ali et al., 2015b ).
The three tests have been carried out for 35 days until a signi fi cant amount of metal debris is found on the magnetic plug of the test bearing. Larger intervals of time stamps (showed in names) indicate resumption of the experiment in the next working day. Table 2 summarizes the necessary information of the IMS bearing dataset and full details are provided at  X  http://ti.arc.nasa. gov/tech/dash/pcoe/prognostic-data-repository/  X  .

In the fi rst test, two perpendicular sensors (12 o'clock and 3 o'clock positions) were used to record bearing vibration signals. However, only one sensor (12 o'clock) was used. In this paper only the 12 o'clock is used. We should also note that the last fi le in the fi uninformative because the record was made in the stoppage phase of the machine.

Table 2 focuses on some important po ints. The REB life is a highly nonlinear phenomenon. The 12 used bearings in the experimental setup were tested in the same conditions of speed and load. Despite that, only four bearings were broken and one bearing was slightly degraded (bearing 3 of testing 3). Moreover, the failure time and the failure nature of the three broken bearings were not the same. All 3.2. Feature extraction
In this section, the three broken bearings in the IMS database are explored. These bearings are bearing 4 and 3 of testing 1 ending respectively with a failure roller and a failure inner race and bearing 1 of testing 2 ending with a failure outer race. The run-to-failure vibration signals of these bearings are shown in
Fig. 4 . Each run-to-failure history is divided into three zones the healthy zone (number 1), the degradation zone (number 2) and the faulting zone (number 3). This partition was done based on the magnitude of vibration signals by proposing two thresholds for each history. Consequently, seven REB states are considered: healthy (H), degraded roller (DR), failure roller (FR), degraded inner race (DIR), failure inner race (FIR), degraded outer race (DOR), and failure outer race (FOR).
 signal with the sampling rate 20 kHz. The original vibration signals recorded during 1 s are decomposed into some IMFs. For each decomposition, the number of the found IMFs is higher than 12. Consequently, the fi rst 12 IMFs are chosen to extract features.
However, the computational time was very important and some-times the EMD algorithm diverges and no IMF is given even after 10 min. To solve these troubles, we propose the following steps for
EMD feature extraction: iv. Compute the total energy of all IMFs: v. Construct the feature vector as where H en is EMD energy entropy of the whole original signal and H en IMF G is EMD energy entropy of the IMF number G . The EMD energy entropy is designated as ( Hong et al., 2014 ) H signal energy.

By considering just the fi rst part of the vibration signal, the number of the treated points by the EMD algorithm is reduced from 20,480 to 2048 and the computational time is reduced impressively. Besides, if the computational time of the EMD algorithm exceeds 10 s, we consider the next part of the vibration signals. This is a very smart step to ensure a quick convergence of the proposed feature extraction fi rst three parts of the signal were considered and thereby the maximum computational was time less than 30 s. Note that the reported time is on a typical PC con fi gured with CPU i3 2.3 GHz, 4 GB RAM, and running Windows 7.
 The energy entropy of the original signal and the fi rst twelve IMFs of the bearing 1 of testing with an outer race defect (shown in Fig. 4 c) are shown in Fig. 5 . In this plot, feature number zero is the energy entropy of the original signal and the other features (from 1 to 12) are the energy entropies of IMFs (from 1 to 12 respectively). Through Fig. 5 it is obvious that the energy entropy is near zero for the last IMFs.

Yu et al. (2006) demonstrated that the EMD energy entropy changes with the energy variation of bearing fault vibration signals when the REB operates with different faults. Thereby, we propose to use the energy entropy of the fi rst 12 IMFs as features to character-ize REB defects. We select just the fi rst 12 IMFs because it is the minimum IMF number found using the EMD. Thus, we are sure that any REB vibration signals produce more than 12 IMFs. 3.3. Feature reduction and classi fi cation
To show the repartition of the extracted features, 50 vectors were selected arbitrarily from three classes (H, DR, FR). Fig. 6 shows the energy reparation of the fi rst eight IMF energy entro-pies and the original signal energy entropy. This plot clearly dem-onstrates that the fi rst IMFs consist of the highest discrimination. For more clari fi cation, Figs. 7 and 8 show two bi-dimensional plots of the highest features' discrimination (shown in Fig. 6 a) and lowest features' discrimination (shown Fig. 6 g) respectively. Figs. 7 and 8 reveal that the overlapping of features increases for IMFs higher order than 4.
As shown previously, plotting EMD energy entropy features indicates the necessity of the preprocessing step them to generate separable features more suitable for the classi fi cation task.
Disorder distribution of original features tends to decrease the performance of the used classi fi er. So, the combination of these features directly with a classi fi er is not recommended. To avoid this drawback, Principal Component Analysis (PCA) and
Linear Discriminant Analysis (LDA) are proposed to extract and to reduce the feature dimensionality based on the eigenvalues of the covariance matrix. Firstly, because the overlap between normal-degradation zones and degradation-faulting zones, the number of records of the broken three bearings is reduced from 5394 to 3911.
This reduction is made with a very great caution to ensure the reliability of measures. Then, the new data set is divided into two sub-sets: one for training (containing 60% of the samples), and the other for test (containing 40% of the samples).

By using the PCA for the training dataset, the fi rst eight principal components have been selected to replace the original feature vector (which contains 13 components). As shown in Fig. 9 , the number of features is reduced from 13 to 8 where principal components 9, 10, 11, 12 and 13 are discarded.

By using LDA technique, original features of the training dataset are reduced to automatically to K 1 where K is the number of classes. In this paper, we have used seven REB states. Thereby, the original features are reduced from 13 to 6 by applying the LDA.
Fig. 10 b and c shows the distribution of the fi rst three features extracted using PCA and LDA respectively. To evaluate the importance of PCA and LDA techniques, in Fig. 10 we have used the same features shown in Fig. 6 . To have a good interpretation, Fig. 10 a shows the optimal and the desired feature distribution where classes are perfectly separated.

Compared to previous works, this paper is based on a large data set which contains 3911 records extracted from run-to-failure REB vibration signals. For each record, the EMD energy entropy is used to extract 13 features. Then, the PCA and LDA are employed to reduce features to 8 and to 6 respectively.

To obtain a good analysis of the proposed method, six scenarios are proposed i. Scenario 1: Combination of original features with SFAM. ii. Scenario 2: Combination of PCA and SFAM. iii. Scenario 3: Combination of LDA and SFAM. iv. Scenario 4: Combination of original features, PNN and SFAM. v. Scenario 5: Combination of PCA, PNN and SFAM. vi. Scenario 6: Combination of LDA, PNN and SFAM.

In the fi rst three scenarios, the SFAM neural network is used to classify seven REB states (H, DIR, FIR, DOR, FOR, DR, FR). However, en IMF
H IMF 1 in the last three scenarios, the PNN is introduced to classify REB states in two classes healthy and not healthy. If the PNN decision shows that the processed state is unhealthy, then the SFAM is used to detect the type of failure (DIR, FIR, DOR, FOR, DR, FR).
For each scenario, the training-bearing dataset is divided into ten equal sized sub-datasets (ten folds). Then, ten iterations of training and validation are performed. One iteration presents nine folds for the training and one fold for the validation. Also, ten folds cross-validation experiments are done to validate the classi accuracy of each scenario.

After the validation phase, we have projected the testing dataset using PCA and LDA techniques. Then, the classi fi cation accuracy (CA) is computed for each scenario. The CA is the ratio between the total samples and it can be expressed as follows:
CA  X  %  X   X  number of correctly classified samples  X   X   X  of PNN is highlighted compared to the direct use of the SFAM neural network. The PNN neural network is able to classify the whole dataset in two classes (healthy and not healthy) with a CA about 100%. Compared to the use of SFAM only, the proposed combination of PNN  X  SFAM is very promising for classi fi cation tasks. Besides, LDA is better than PCA in terms of feature discrimination. This result is validated when comparing the CA of scenarios (2,3) and (5,6). Better experimental results are insured by the combination of LDA, PNN and SFAM as illustrated by the 6th scenario summarized in Fig. 11 . 3.4. Nearly online bearing fault diagnosis scientists. With the recent advances in modern technology, industry and scientist researchers are progressing toward providing enhanced strategies to detect online REB anomalies.

EMD  X  LDA  X  PNN  X  SFAM combination for an online diagnosis task.
H
IMF
We recall that the three used bearings (see Fig. 4 ) contain 5394 records were just 3911 are used in the training and testing modes.
Consequently, the other 1483 records are unknown for the validated SFAM and PNN neural networks. Experimental results, given in Fig. 12 , show that the application of the proposed strategy is very promising for a nearly online bearing diagnosis.
The online evaluation of the proposed strategy for the diag-nosis of naturally bearing progressing defects is very encouraging.
The proposed strategy is able to indicate qualitatively a clear distinction between the healthy and damaged states. In addition, this approach proposes automatic fault detection without any human intervention. The application of the proposed methodology perfectly separates the healthy stage, the degraded stage and the faulting stage. Besides, the type and the severity of defects are given for all tests which provide an idea about the remaining useful life of the tested bearing. However, the three tested bearings are already modeled by the PNN and SFAM neural networks and another test is needed. Another bearing is needed where records were not yet treated by the neural networks. Hence, we thought to use the bearing 3 of testing 3 where any record was used in the training phase. Experimental results shown in Fig. 13 con fi rm that the proposed methodology is really interesting. The probability density of failure increases at the end of the experi-ment although that the magnitude of vibration signals remains substantially constant. For more clarity and better resolution, experimental results are enlarged in Fig. 14 .

To improve the quality of the proposed diagnosis approach, we propose a smart step to minimize the false alarm rate: It is a sliding window that fi lters external tests which were not used in the training mode and it can be summarized as follows:  X 
Select a sliding window (sliding step ( ss  X  1), window length ( wl  X  16)) to browse the nearly online classi fi cation results.  X  rence of the defect i along the sliding window.  X 
For each point of the window, if the classi fi cation result is i then k i  X  k i  X  1.  X 
After 16 sliding steps, determine the highest occurrence as occ  X  max ( k DIR , k FIR , k DOR , k FOR , k DR , k FR ).  X 
Determine the fault with the highest occurrence as occty-pe  X  argmax ( k DIR , k FIR , k DOR , k FOR , k DR , k FR  X 
If occ Z 2 then the fault type is occtype else the state of bearing is healthy.  X 
Run the next 16 classi fi cation results.
Fig. 15 shows the adverse effect of the proposed smart fi phase on the bearing 3 of testing 3. Compared to Fig. 14 , Fig. 15 exhibits fewer false alarms, which can improve the classi
The fi rst fi fteen points in Fig. 15 are equal to zero (omitted) due to the sliding window length which is set to sixteen. Despite the fact that increasing window length decreases the false alarm rate, it increases the number of zero points and the computational time.
Consequently, several tests have been performed in this work to select the most effective window length and to select the thresh-old of occurrences. By evaluating the percentage of false alarms, the best window length is chosen to ensure more sensitivity to the proposed method. 4. Discussion 4.1. Feature performance measures
The ultimate goal in pattern classi fi cation is to fi nd the best feature dataset. It is a common practice to get a feature dataset with high performance measures. To achieve this goal, a mathe-matical treatment is presented in this section. From various measures known in literature, we discuss the interclass/intraclass distance well known as scatter matrix. This measure is applied to the multi-class case and it is well known as the J criterion. In this paper, the J criterion is used to evaluate original extracted features,
PCA features and LDA features. As clari fi ed previously, seven REB states are de fi ned in this work. For each class, 50 extracts are used to be evaluated. Also, these features are projected with PCA and
LDA to be evaluated. In this way seven classes have been used ( K  X  7) and 50 extracts are evaluated ( N  X  50). The procedure of the
J criterion is summarized as follows ( Ben Ali et al., 2013 ): i. Compute the average feature vectors of the k th class: where x k , n the n th extract of the k th class. ii. Compute the total average feature vectors of all classes iii. Compute the intra-class variance matrix of average dispersion coef fi cients
S iv. Compute the inter-class variance of average dispersion between v. Finally, the J degree of the average scattering within classes is The computation of the J criterion based on original features, PCA features and LDA features is given respectively in Table 4 , Tables 5 and 6 . These three tables improve the importance of the LDA feature reduction technique. First, the use of LDA reduces the 13 original features to 6 features which decrease the training computational time of PNN and SFAM. In addition, the fi rst component LD 1 shows the greatest scattering criterion compared more discriminant compared to original and PCA features. In conclusion, the comparison of the six proposed scenarios con the important of EMD  X  LDA  X  PNN  X  SFAM combination. 4.2. Comparison with some previous works
Classi fi cation accuracy is much more improved for all bearing diagnosis conditions by the use of methodologies based on feature extraction, feature selection (or reduction) and classi fi The classi fi cation accuracy results are all greater than 92%. To get a good classi fi cation, the majority of scienti fi c researches in the previous works have used four bearing states (H, FIR, FOR and FR). The superiority of this work is highlighted in the introduction of the default severity which was not held before. Severity consists of three types: normal, degraded and faulty. Thereby, seven bearing states have been used in our work. These added modi fi cations allow the real time monitoring degradation. Table 7 summarizes previous works on automated identi fi cation of bearing faults.
The importance of our work over others is the use of real data which results from real time vibrations describing the dynamic response of defective REBs. However, previous works are based on simulation defects by creating holes with different diameters and depths. The proposed approach produces good classi fi cation accuracy despite the important number of classes and records. Moreover, our proposed methodology is tested online however the majority of the previous works do not satisfy this aim and scope.
Compared to the work proposed in Ben Ali et al. (2015b) , this paper presents a strategic improvement. As shown in Table 7 , the number of features used in Ben Ali et al. (2015b) was 18 and the used classi fi er was the back propagation neural network (which is perhaps, with respect, even a bit outdated). The structure of the used neural network was important (four layers and 60 nodes) which increase remarkably the computational time. Besides, the use of statistical features certainly degrades the quality classi tion: it is well known that they are redundant and consequently we do not need all of them as they provide the same information ( Tandon and Choudhury, 1999 ). Also, statistical features present strange behavior: their values come down to the level of an undamaged bearing when the damage is well advanced ( Tandon and Choudhury, 1999 ). In this paper, we have applied the LDA technique to select best features derived from the EMD method and guarantee an optimal separation between features of different classes. Moreover, we have proposed a new combination of PNN and SFAM neural networks. This combination is very promising and it is through her that we obtained 97.82% as classi fi accuracy. The combination of PNN and SFAM do not require structure initialization, however, the back propagation neural network needs to be compiled many times to con fi rm a structure which can be not optimal. In the literature there are some empirical recommendations to de fi ne the structure of the back propagation neural network, however, no mathematical justi tion was given ( Capocchi et al., 2011 ).
 given in Table 7 , was very satisfactory, these works were based on synthetic bearing defects which were always introduced by the user (holes with different diameters, depths and numbers). In reality, this is not the case of a bearing defect in industrial environment.
Many factors can cause deterioration of bearings such as same type of bearing in the same experimental conditions never produces the same kind of failure in terms of time, type, and severity. This property is con fi rmed by Intelligent Maintenance Systems (IMS) bearing run-to-failure data set.
 on run-to-failure vibration signals. This is due to the dif processing these signals. The major problem is the noise; it is very dif fi cult to detect degradation when it is smaller than the noise measurements. This form of degradation is often known as  X  progressing degradations  X  . Even though many researchers have performed fault bearing detection, they do not perform the diagnosis and identi fi cation of naturally progressing degradations. degradation is a highly nonlinear phenomenon. The failure time and the failure nature of the three broken bearings were not the same. All these con fi rm that bearing fault assessment is a very hard task. In conclusion, the proposed method is very adequate in terms of fault accuracy detection. 4.3. Statistical validation classi fi er can recognize tuples of different groups, which contains information about real and predicted classi fi cations done by a classi fi cation system ( Fawcett, 2001 ).

Table 8 and presented in Fig. 16 by a compact box plot, it can be seen that the EMD  X  LDA  X  PNN  X  SFAM combination recognize the type and the severity of defects effectively.

For more statistical signi fi cance and better generalization, some series of experiments should be conducted to support the author's claims. In fault detection problems, the performance of a detection algorithm usually depends on the trade-off between robustness and sensitivity. The sensitivity and robustness of the proposed method need to be explored by running a series of experiments. A receiver operating characteristic (ROC) curve will make the results more convincing. The ROC curves are often the only valid method of evaluation ( Fawcett, 2006 ). An ROC curve is a detection performance evaluation methodology that shows how successfully a certain detector can separate two groups in a quantitative manner ( Fawcett, 2001 ). An ROC curve gives the trade-off between the probability of detection or true positives rate, also called sensitivity and recall versus the probability of false alarm or false positives rate ( Fawcett, 2006 ).

In order to compute the performance of the developed diag-nosis methodology, the ten folds cross-validation experiments mentioned in Section 3.3 are re-used in this validation phase.
Based on the correct classi fi cation of patterns in the test set (in each fold), the performance measures are computed. The average of these performance measures is computed to report the overall performance of the proposed method. To handle the problem of multiple classes, we used the one-against-all strategy:
Each class was treated as appositive class in turn, while all remaining six classes were combined to form a negative class.
In each fold, based on correct classi fi cation of test patterns, the following parameters are de fi ned:  X 
True Positive ( TP ): It is the number of actually abnormal test patterns which were classi fi ed as abnormal by our automated classi fi ers.  X 
True Negative ( TN ): It is the number of normal patterns in the test set which were classi fi ed into normal class by the auto-mated classi fi ers.  X 
False Positive ( FP ): It is the number of normal test patterns classi fi ed as abnormal by the automated classi fi ers.  X 
False Negative ( FN ): It is the number of abnormal test patterns which are classi fi ed as normal by the automated classi fi
Based on TP , TN , FP and FN , the sensitivity ( Sn ), and speci ( Sp ), were de fi ned as follows:
Sn  X  TP
TP  X  FN
Sp  X  TN
TN  X  FP
Fig. 17 shows one of the found ROC performances of our proposed strategy. It can be seen that PNN  X  SFAM classi fi provides good accuracies of sensitivity (91.7%) and speci (93.4%) and an area under curves equal to 0.847. We should note that this curve has the least important features among all ROC curves found which validates the strength of our strategy. 5. Conclusion and prospects
In this work, a new online automated bearing fault diagnosis methodology is proposed. This effective method is introduced by feature extraction, characterization, reduction and classi based on non-stationary vibration signals. Compared to previous works, experimental results demonstrate that the proposed method is extremely promising and it can be summarized as follows:  X 
EMD is a self-adaptive signal processing method applied to decompose nonlinear and non-stationary vibration signals into some stationary IMFs.  X 
The diagnosis method is based on eigenvalues of LDA method to investigate a higher classi fi cation accuracy compared to the use of EMD energy entropy and PCA features.  X 
The combination of PNN and SFAM neural networks presents a better categorization than the use of SFAM only.

Finally, the proposed method accurately identi fi es bearing faults online and a better generalization capability is shown compared to previous works. As future works, we will focus on the variable operating conditions of speed and charge which can generalize the proposed methodology.
 Acknowledgment Authors wish to thank the Center for Intelligent Maintenance
Systems (IMS), University of Cincinnati, USA, for his permission to use his bearing data. Also, authors wish to thank Dr. Barrie William
Jervis, former professor in Shef fi eld Hallam University (UK) for his relevant advices during the implementation of PNN and SFAM neural network.
 References
