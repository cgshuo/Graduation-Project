 Adverse Drug Reactions (ADRs) represen t causal relationships between adverse events and use of medicines, such as alendronate 1 causing esophagitis [9]. Adverse events contribute to about 5% of all hospital admissions, and are about the 5 th commonest cause of death in hospital [4]. Among them, 30% to 60% are preventable/avoidable by careful prescribing and monitoring [1]. With ADRs like drug-symptom/diagnosis patterns, computerised systems can search health records to monitor adverse events [1]. Such patterns may be used to find at-risk patient groups [5], or to help practitioners ameliorate their diagnoses and prescriptions [3]. Therefore, systematically signalling and validating ADRs is of financial and social importance.
 recognise all ADRs [8]. There exist several post-marketing ADR detection tech-niques, known as signal detection in pharmacovigilance, like EBGM (Empirical Bayes Geometric Mean) and BCPNN (Bayesian confidence propagation neural network) [3]. They work mainly on spontaneous ADR reports in which drugs reportedly cause symptoms/diagnoses [3]. However, when based only on these spontaneous ADR reports, the frequency of adverse reactions is underestimated, typically by a factor of about 20 [1]. Adverse reactions may go unnoticed until lots of drug users have been affected , e.g., recent experience with Vioxx [7, 9]. In contrast, administrative health datab ases routinely record health events such as medical services, diagnoses, and drug prescriptions for, say, subsidy purposes. They cover quite extensive users and are readily available. Signalling ADRs from these databases would complement exist ing techniques. This data mining work is the first and preliminary attempt on this new direction.
 be generated using event timestamps. Am ong these sequences, ADRs as patterns are normally unexpected and infrequent due to rigorous pre-market drug testing. It is inappropriate to signal ADRs by looking for frequent patterns/association from the event sequences, as is done in current temporal data mining [2]. Another difficulty is that a drug is strongly associated with certain diagnoses due to treatment/prevention. T hus, new techniques are essential for signaling ADRs from the sequences.
 pectedly in a T -sized period after another event pattern A . For simplicity, we assume that both A and C comprise a set of event types. These patterns are de-noted by A T  X  C , called Unexpected Temporal Association Rules (UTARs). T ,a period length, constrains the temporal relation between the antecedent A and the consequent C , and so ensures the UTARs X  plausibility. To handle the un-expectedness, we introduce a new interestingness measure, unexpected-leverage and give a user-based exclusion technique for its calculation. The basic idea is to exclude expected events in a single T -constrained subsequence and then ag-gregate unexpectedness over all the remaining T -constrained subsequences. In contrast to [11], it need not compare new rules with existing knowledge rules during the mining procedure in order to find unexpected rules. We also use an event-oriented data prepar ation technique to handle infrequency. We develop a new data mining algorithm, MUTARA ( Mining UTAR given the Antecedent), to signal simple ADRs where a drug causes a symptom. The technique is easily extended for longer patterns such as adverse events induced by drug interac-tion. Its performance is demonstrated on linked administrative health databases by short-listing ADRs. Compared with OPUS AR t , extended from OPUS AR (OPUS Association Rule) [12], MUTARA can short-list ADRs more effectively. and propose its mining algorithm MUTARA in Section 3. Results and compar-isons are presented in Section 4, fo llowed by conclusion in Section 5. We first introduce Temporal Association Rules (TARs) as a representation for signalling ADRs from a set of health event sequences  X  . The effect of an event is usually short-acting, e.g., less than 6 months for acute or sub-acute ADRs [8]. By embedding a temporal const raint into association rules A  X  C ,wegeta category of TARs A T  X  C . The notation T  X  is used to indicate explicitly that the antecedent A and the consequent C occur within subsequences constrained by a time window of length T . For simplicity, we choose such a T -constrained subsequence from each sequence in  X  . As illustrated in Fig. 1, e.g., the subse-quences for drug User 1 and drug Nonuser 1 are { A 1 , A 5 , A 6 , C 1 -C 3 } and { A 3 -A , A 8 , C 2 } within the hazard and the control periods respectively. The support of a TAR, supp ( A T  X  C ), is the proportion o f subsequences where A occurs before C at least once, among all the T -constrained subsequences. Thus, the support describes how often A followed by C occurs in the subsequences. For the two subsequences in Fig. 1, e.g., supp ( A 6 T  X  C 3 )= 1 2 . Similar to associa-tion rules, we have confidence of a TAR, conf ( A T  X  C )= supp ( A T  X  C ) supp ( A T  X  ) indicates the proportion of T -constrained subsequences that con-tain A . As another measure of the association strength [12], leverage is de-fined as leverage ( A T  X  C )= supp ( A T  X  C )  X  supp ( A T  X  )  X  supp ( T  X  C ) . For the two subsequences in Fig. 1, leverage ( A 6 T  X  C 1 )= 1 2  X  1 2  X  1 2 = 1 4 ,and all drugs are screened before marketing, and (2) some post-marketed drugs that strongly led to adverse events are rem oved from the market. As a result, if we want to signal ADRs by finding valid TARs whose support and confidence exceed pre-specified thresholds  X  s and  X  c respectively, two problems emerge. (1) The thresholds  X  s and  X  c should be set pretty small [2]. This leads to innumerable valid TARs and makes mining algorithms unmanageable [12]. (2) It is hard to set problem-specific thresholds properly. The same difficulties exist in other temporal data mining models, e.g., sequential patterns [2].
 most interesting rules [12]. For example, we may simply apply OPUS AR [12] on the T -constrained subsequences. We call this OPUS AR t . It can return a pre-specified number of TARs that maximise a rule quality measure.
 leverage, are not suitable for ranking TARs to signal ADRs. Risk ratio and odds ratio are two appealing measures of effect to medical experts [6, 8]. For example, It describes to which degree A increases the occurrence rate of C with the T -constraint. Because these two measures a re commonly used in pre-market testing, their values for ADRs in administrative health databases are relatively low. Leverage can not indicate the unexpectedness between drugs and adverse events for effectively signalling ADRs. Based on leverage, e.g., hypertension NOS (last row in Tables 1 and 2) is strongly associated with alendronate 1 . This condition is highlighted due to its high frequency among alendronate users, even before taking the drug. It is not evidentially an adverse reaction.
 embed unexpectedness into rules directly . To clearly indicate temporal unexpect-edness, we introduce an Unexpected Temporal Association Rule (UTAR), denoted by A T  X  C , which means that the consequent C occurs unexpectedly within a T -sized period after the antecedent A . Rather than defining unex-pectedness explicitly, we aggregate it from individual sequences.
 Definition 1. The support of the UTAR supp ( A T  X  C ) is the proportion of the T -constrained subsequences that contain A unexpectedly followed by C ,among all of the T -constrained subsequences.
 In other words, only the subsequences that contain A and then unexpectedly contain C will favor A T  X  C . Within a single sequence, we bypass the problem of determining whether event types unexpectedly follow A and only exclude ex-pected event types following A . In the first sequence in Fig. 1, e.g., C 3 occurs both after and before the first A 6 . For its subsequence within the hazard period, C 3 is expectable after A . That is, this subsequence does not favor the unexpected temporal association between A 6 and C 3 .Thus supp ( A 6 T  X  C 3 ) = 0. Sequence information outside of subsequences ca n be used to prune expected event types, and remaining subsequences may be aggregated together to express the unex-pectedness of UTARs. A simple user-based exclusion operation will be given in Section 3.
 Definition 2. The unexpected-leverage of the UTAR A T  X  C is the propor-tion, among all the T -constrained subsequences, of the subsequences that exhibit the unexpected association in excess of those that would be supposed if A and unexpected C were independent of each other. That is, where supp ( T  X  C ) is the proportion of subsequences that unexpectedly contain C . Thus, only the subsequences which unexpectedly contain C will contribute to unexpected-leverage. For example, for the two subsequences in Fig. 1, we have unexlev ( A 6 T  X  C 1 )= 1 4 &gt;unexlev ( A 6 T  X  C 3 ) = 0. The measure successfully distinguishes C 1 from the others.
 number of, say 10, UTARs with high unexpected-leverage for signalling ADRs. Another reason to rank UTARs only base d on unexpected-leverage is that large unexpected-leverage also indicates large support and confidence. In this section, we develop a simple but effective algorithm to search for in-teresting UTARs when the antecedent, say a drug, is specified in advance. We concentrate on simple UTARs corresponding to an ADR in which the use of a drug causes a diagnosis, i.e., drug A T  X  diagnosis C . These UTARs are of great practical value, and the success on them may also pave the way for mining so-phisticated UTARs in future. The mining algorithm, MUTARA, is outlined in Algorithm 1. We exemplify it on the two health event sequences as illustrated in Fig. 1.
  X  The antecedent A is specified to restrict the search space, e.g., A 6 .The  X  Event types of interest determine the possible candidates for the consequent  X  A study period is specified by [ t S , t E ] according to the antecedent A .User  X  The time lengths T e , T r , T b ,and T c indicate lengths of, respectively, the effect
Algorithm 1 Mining UTARs given the Antecedent (MUTARA) .  X  In order to offset low frequency of adve rse reactions, a hazard period may tecedent A . Among them, some are not likely to be unexpectedly induced by A . For each user sequence, we can use the event types which occurred before the first occurrence of A to infer event types which are not unexpectedly induced by A . We can disregard these expected ones in the hazard period, and infer that the remaining ones are more likely caused by A unexpectedly. An underlying reason is that most event types are more common in certain patient groups, say, the condition hypertension for the elderly [6] no matter whether A occurs or not. To simplify this exclusion operation for Step 2, we borrow the concept of the reference period from case-cr ossover studies [6]. It is a T r -sized period which is a T b -sized interval before the first occurrence of A as illustrated in Fig. 1. If the event type (e.g., suffering a disease) occurs in the reference period, the patient (or his/her doctors) would be not su rprised to see its occurrence after A ,espe-cially if A is likely used to treat/prevent that event type. The event types within the reference period are probably not une xpected to the user with respect to the antecedent A , and they can be excluded for mining simple UTARs. For User 1 in Fig. 1, e.g., C 3 is in the reference period, and C 1 ,C 2 ,C 3 in the hazard period. Then, C 3 is excluded and { C 1 ,C 2 } are left for this subsequence. This exclusion operation is carried out only based on a single user sequence, and is termed as the user-based exclusion . It is basically designed to exclude some expected event types from a single drug user X  X  viewpoint.
 the control period within [ t S , t E + T c ]. In order to avoid other confounding factors like age and gender, all nonusers are chosen from the same age-gender group as drug users. The event types within the control period comprise the nonuser subsequence.
 subsequences together, we calculate s upports for each event type with respect to A . We compute unexpected-leverage of ea ch event type according to Eq. (1). Unexpected-leverage then aggregates unexpectedness among the subsequences. Finally, MUTARA outputs the top 10 UTARs with highest unexpected-leverage. ing to the antecedent A , and it restricts the event types in the calculation of supports. This event-oriented data preparation makes it possible to signal the usually infrequent ADRs. The user-based exclusion in Step 2 is simple and easily implemented, but it is crucial i n MUTARA. In order to make a clear com-parison, the only difference of our implemented OPUS AR t from MUTARA is without using the user-based exclusion. The CSIRO, through its Division of Mathematical and Information Sciences, was commissioned by the now Australia n Government Department of Health and Ageing (DoHA) in August 2002 to analyse a linked data set produced from MBS, PBS and Queensland Hospital morbidity data, more commonly referred to as the Queensland Linked Data Set (QLDS). The objective was to provide a demonstration of the utility of data mining on de-identified administrative health data to investigate patterns of utilisation, adverse events and other health outcomes.
 tween DoHA and Queensland Health. The d ata set contained de-identified and confidentially linked patient level hospital separation data (1 July 1995 to 30 June 1999), Medicare Benefits Scheme (MBS) data and Pharmaceutical Benefits Scheme (PBS) data (both 1 January 1995 to 31 December 1999). All data were de-identified, and actual dates of service were removed, so that time sequences were indicated only by time from first admission. This process provided strong privacy protection, consistent with the requirements of the relevant Federal and State legislations. CSIRO held the QL DS in a secure computer environment and limited access to authorised staff dir ectly involved in the data analysis. noses coded in the ICD9 system. There are 2020 different diagnoses. Each record in the PBS data corresponds to one prescription supplied to one patient, and there are 758 distinct codes in the WH O ATC system [10]. The ATC codes for alendronate and atorvastatin , e.g., are M05BA04 and C10AA05 respectively [10]. For convenience, we refer to 1 January 1995 as Day 1 hereinafter. Thus the time period is [1, 1826] for all the health event sequences.
 UTAR generated to be of value to domain experts. There may several reasons for UTARs being mined from the QLDS. (1) The QLDS only contains data for hospitalised patients which may not be representative of the general population. (2) The QLDS contains incomplete health data for each patient. Thus, similar to signal ADRs from spontaneous ADR reports [3], a practical goal is to short-list the unexpected associations between adve rse events and use of medicines among the most interesting UTARs. These associ ations would have to be further evalu-ated by causality analysis [3], and other h ealth aspects taken in to consideration in interpretation on any findings. Because this isn X  X  yet to be done for our re-sults, only those results corresponding to known ADRs are reported. If a drug is prescribed to tr eat a condition, it can be taken as a proxy for side effects associated with the condition. Prescription of nizatidine , e.g., may be a proxy for ulcers [7]. Some ADRs then may be signalled from unexpected associations between drugs probably used to treat adverse reactions and a given drug. with OPUS AR t . We concentrate on two drugs, alendronate 1 and atorvastatin 2 . Since atorvastatin is well-tolerated and its adverse drug reactions rarely lead to hospitalisation, we use prescribed drugs as proxies for signalling its side effects. (  X  60) females X  and  X  X lder (  X  60) males X . The parameters are set as follows. T e = T c = 180 and T c = T b =6 leave reasonable room for hazard periods, t E = 1645  X  T e for inpatient diagnoses and t E = 1826  X  T e for prescribed drugs. t S is set as the drug introduction day, i.e., 672 and 1114 for alendronate and atorvastatin respectively.
 leverage for older females given alendronate generated by MUTARA. They are compared with results generated by OPUS AR t . In Table 1, reflux esophagitis (53011) is ranked as No 4 based on its unexpected-leverage value of 1.59E-04 (Column 5) among 2020 different diagnoses. It is worth noting that 48 (Column 10) patients suffer reflux esophagitis within 180 days after taking alendronate . Among them, about 40 (Column 7) drug users start suffering reflux esophagitis after drug usage. That is, only 8 patients suffered reflux esophagitis in their haz-ard and reference periods. As a comparison, reflux esophagitis is ranked as No 13 (Column 2) based on leverage (Column 8). It is interesting to observe that the first two diagnoses in Table 1 are closely related with osteoporosis which alendronate 1 is used to treat/prevent. We attribute these results to  X  X herapeutic failures X  and the incomplete data. If the health event sequences contained all the diagnoses/symptoms before alendronate prescription, the user-based exclu-sion would decrease the unexpected-lever age values of these failures. This would further highlight ADRs like alendronate T  X  reflux esophigitis in Table 1. Though hypertension NOS isrankedasNo2byOPUS AR t , it is ranked as low as 1163 by MUTARA. Similar results can be found in Table 2. On the other hand, MU-TARA and OPUS AR t run about 63.1 and 64.8 seconds on an Intel Pentium 4 (3.2GHz)/Linux computer respect ively. Both run comparably fast.
 given alendronate . Among the 10 drug users suffering esophageal reflux , only one suffers it in its reference period. Bas ed on its unexlev value of 4.85E-5, esophageal reflux which belongs to esophagitis 1 is ranked as No 2 by MUTARA. It is No 11 basedonleveragebyOPUS AR t .
 atorvastatin is specified. It is interesting to see that No 4 and 6 drugs may be prescribed to trea t side effects of atorvastatin 2 . Nizatidine (A02BA04) is used to treat the recurrence of ul cers and to treat other conditions where the stomach produces too much acid [7]. Nizatidine is presumably prescr ibed to treat side effects like stomach ulcer related to atorvastatin . Similarly, dicloxacillin (J01CF01) is presumably prescribed for urinary tract infection 2 . As a comparison, these two drugs are ranked as low as 56 and 98 by OPUS AR t respectively. In this paper, we have proposed the new kn owledge representation, Unexpected Temporal Association Rule (UTAR), and its interestingness measure, unexpected-leverage, in the context of signalling unexpected and infrequent Adverse Drug Re-actions (ADRs) from administrative health databases. Based on our user-based exclusion and event-orient ed data preparation techniques, we have developed a simple mining algorithm MUTARA to signal simple ADRs.
 dronate T  X  esophagitis ,and atorvastatin T  X  stomach ulcer or urinary tract infection using drugs as proxies for diagnoses. Considering data biases and incompleteness in the QLDS, these shortlists are quite promising to help medical experts identify ADRs efficiently and effectively. It demons trates the usefulness of this research. We are currently extending the propose d techniques to signal more complicated ADRs. In addition, we are interested in mining ADRs from large administrative health databases without specifying the drug exposure or outcome event. Acknowledgements. The authors acknowledge the Australian Government Department of Health and Ageing (DoHA) and the Queensland Department of Health for providing data for this research. The authors thank K. Mackay, P. Graham, and anonymous reviewers for their comments and suggestions.
