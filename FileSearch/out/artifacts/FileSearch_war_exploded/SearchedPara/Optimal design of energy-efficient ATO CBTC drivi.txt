 1. Introduction
Energy ef fi ciency is a priority nowadays due to the environ-mental impact of pollution, the necessity to optimize the use of limited natural resources and the associated economical cost. The contribution of railways to CO 2 emissions is low compared to other transport modes, but the huge amount of energy consumed makes it necessary to improve energy ef fi ciency ( Feng et al., 2013b ).
Different strategies can be applied in railway systems to reduce energy consumption. First, long term and high investment is needed in rolling stock and infrastructure to improve technologies and equipment. Second, short or mid-term strategies related to traf fi c operation increase energy ef fi ciency without high invest-ment. Related to the traf fi c operation strategies, different appro-aches are being researched from the point of view of traf management ( Abril et al., 2008; Fay, 2000; Feng et al., 2013a, 2013b; Jia and Zhang, 1994 ), the ef fi cient use of regenerative energy ( Dom X nguez et al., 2012; Falvo et al., 2011 ) and ef driving also called ecodriving.

Ecodriving design has an important impact on energy savings associated with traf fi c operation ( Mlinari  X  and Ponikvar, 2011;
Sicre et al., 2012 ). The solutions for ecodriving design based on analytical models include simpli fi cations which makes them inadequate for real cases ( Albrecht et al., 2013; Franke et al., 2000; Khmelnitsky, 2000; Ko et al., 2004; Miyatake and Ko, 2010;
Su et al., 2013 ). On the other hand, simulation is usually the best approach to design and evaluate different strategies and algo-provides an adequate level of accuracy taking into account the variability of the parameters involved in the problem.
In general, railway design and operation analyses are based on simulation platforms where realistic data and conditions can be reproduced. This way, each part of the railway system can be modeled with the necessary detail and accuracy to fi nd the equilibrium between computational load, simulation time and precision of the solution obtained ( Martin, 2010 ).

In the ecodriving design, a number of optimization techniques have been used in combination with simulation  X  Genetic Algorithm ( Bocharnikov et al., 2007, 2010; Cucala et al., 2012;
Fu et al., 2009; Sicre et al., 2012; Wong and Ho, 2003, 2004a, 2004b; Yang et al., 2012 ), Arti fi cial Neural Networks (ANN) ( Acikbas and Soylemez, 2008; Chuang et al., 2008, 2009 ), direct searching methods ( De Cuadra et al., 1996; Wong and Ho, 2004a, 2004b ) and Ant Colony Optimization (ACO) ( Lu et al., 2013 ). In
Ding et al. (2011 ) GA combined with simulation is applied for the ecodriving design and the distribution of recovery times along the line, designing the timetable.
 manual to fully automated driving. In trains controlled by ATO (Automatic Train Operation) devices, it is possible to have a signi-fi cant control over running and station dwell times. The ATO equipment drives the train automatically according to a prede-fi ned speed pro fi le. The design of ATO driving strategies has two main objectives: quality of service (punctuality, regularity and comfort of passengers), and energy consumption ( Dom X nguez et al., 2011a, 2011b; Wang et al., 2011 ).

Bocharnikov et al. (2007) , Chang and Xu (2000) , Khmelnitsky (2000) , Kim et al., (2013) , Lu et al. (2013) , Wong and Ho (2004a, constraints and control capabilities of any particular ATO system, or for Fixed Block signalling systems, which locate trains at discrete track circuits ( Dom X nguez et al., 2011; Ke et al., 2009 ). system CBTC (Communication Based Train Control) is being installed.
It is based on continuous communi cation via radio between trains and the control center ( Chen and Guo, 2010; Pascoe and Eichorn, 2009 ). It is capable of implementing functions of automatic train protection (ATP), automatic driving ATO and centralized automatic train supervision (ATS) ( IEEE, 2008 ). In railways equipped with CBTC it is possible to continuously check in real-time the position and speed of the preceding train and interlocking points, giving the choice to recalculate the braking curve and security distances of the following train. This feature enables the improvement of the mini-mum headway in comparison with Fixed Block signalling systems ( IEEE, 2009 ).
 exploited by the centralized traf fi c regulation system to perform more regular and ef fi cient traf fi c management. However, new oped and implemented in the new CBTC lines ( Ding et al., 2009; Gu et al., 2011; Su et al., 2013 ).
 driving commands at any point of the interstation, in contrast with the former Fixed Block signalling system, where ATO commands are loaded onboard the train at the station and it is not possible to update them until the train reaches the next station. This way, new types of speed pro fi les can be executed by CBTC, and in general it time. The aim of this paper is to calculate the optimal ATO speed pro fi les (Pareto curve) for the two objectives: running time and energy consumption. The designed Pareto curve will be the input con fi guration data for the traf fi c regulation system that will select in real time the optimal speed pro fi le for the required running time.
 (2012 ) on the framework of moving block systems, for the single objective problem. In Dom X nguez et al. (2014 ) the multi-objective problem was stated for energy consumption and running time, based on a MOPSO algorithm, but it does not take advantage of the CBTC communication capability to update ATO commands. stated for minimizing energy consumption and the travel duration, based on an evolutionary algorithm called the Indicator Based
Evolutionary Algorithm (IBEA), but the driving model is too simplistic (traction, speed regulation, coasting and braking).
In this paper, a multi-objective evolutionary algorithm NSGA-II is proposed to obtain the consumption-running time Pareto front based on the detailed simulation of a train equipped with a real ATO system, in a CBTC metro line.

In order to obtain a smooth functioning of the traf fi c regulation system, a Pareto curve where time distance between consecutive points is small enough is preferred, thus, speci fi c algorithms for gap fi lling are necessary. These algorithms include the one based on crowding distance measure ( Kukkonen and Deb, 2006 ), the solution proposed in Patnaik and Behera (2011 ) by means of pseudo-inverse functions and Arti fi cial Neural Networks (ANN) techniques, the Pareto front interpolation method proposed in
Hartikainen et al. (2012 ), and other gradient-dependent methods ( Sch X tze et al., 2010 ).

However, all these methods fi ll gaps with dominant points, so the gap is not fi lled if there are no dominating points. When the energy consumption difference is negligible, fi lling the gaps with domi-nated points is necessary to avoid broad separation between points method proposed in Burachik et al. (2013 )and Dutta and Kaya (2011 ),
Tchebychev Scalarization Along Ra ys, deals especially with discon-nected Pareto fronts. Dominated points are discarded, but this procedure could be applied to obtain dominated points. One of the main drawbacks of the process consists of the adequate determina-tion of the weights of the algorithm. A new procedure for gap detection and fi lling is proposed in this paper to obtain a pseudo-Pareto curve with dominated points when necessary.

The uncertainty associated with the mass of the train, that is, the passengers load, should be taken into account due to the important impact on the running time and the energy consump-tion. However, most of the papers focused on ecodriving design do not consider the uncertainty associated with this parameter.
Frequently the uncertainty in parameters is better represented by fuzzy knowledge modeling. Uncertainty modeled as fuzzy knowledge ( Bellman and Zadeh, 1970 ) has been applied to different railway applications as in Bai et al. (2014 ), Chang and Thia (1996 ), Corriere et al. (2013 ), Fay (2000 ), Hanaoka and Kunadhamraks (2009 ), Isaai et al. (2011 ), Jia and Zhang (1994 ), Tsang and Ho (2004 ), Wang et al. (2012 ), and Yang et al. (2009 ).
In Bocharnikov et al. (2007 ), a model for an optimal driving strategy is proposed based on a single objective GA with energy consumption and running time included as the fuzzy parameters.
However, the uncertainty associated with the mass of the train is not modeled. The proposed model in Cucala et al. (2012 ) permits the joint design of timetable and ef fi cient driving, taking into account a fuzzy model of delays and fuzzy punctuality constraints.
In Sicre et al. (2014 ) the manual driving is modeled by means of fuzzy parameters and a GA with fuzzy parameters is proposed for the driving regulation algorithm of a high-speed train.
The main contribution of this paper is the algorithm for the design of new ATO CBTC speed pro fi les under uncertainty to reduce energy consumption. The proposed method is an evolu-tionary algorithm based on the detailed simulation of the train motion. The Pareto curve running time  X  energy consumption is calculated by means of the multi-objective NSGA-II algorithm. The mass of the train is modeled as a fuzzy number, thus a hybrid technique ( Vasant, 2010; Vasant et al., 2012a ) is proposed: a multi-objective NSGA-II with fuzzy parameters. The method to solve the optimization model with fuzzy parameters is based on  X  -cut arithmetic of the fuzzy numbers ( Chanas et al., 1984 ) combined with the NSGA-II optimization. For this purpose, new de fi fuzzy weak and strong dominance are proposed. In addition, the algorithm permits the inclusion of dominated solutions to obtain a pseudo-Pareto curve, fi lling running time gaps.

The simulation model and the parameters of ATO driving are described in Section 2 . Then, the NSGA-II algorithm with fuzzy parameters (NSAGA-II-F) is detailed in Section 3 . Section 4 describes the case study, and the results are shown and discussed. Finally the conclusions are presented in Section 5 . 2. Simulation model
In order to produce reliable results the time and energy calculations must be made with a precise simulator. A simula-tion model for the precise simu lation of metropolitan lines equipped with an ATO system compatible with the Fixed Block D2G (Distance to Go) and moving block CBTC signalling systems has been developed. The simulator also veri fi es the operational and comfort constraints typically de fi ned by the railway administrator.

The line is described in terms of speed limits, grades and track curve radius. The main physical and dynamic variables that affect the train motion are considered, such as the length, mass of the train, running resistance, rotary inertia, traction and braking effort curves, and auxiliary equipment consumption. The ATO simulation module calculates the effort command that has to be sent to the motor of the train according to the current ATO driving commands. The ATO module always observes safety conditions such as speed limitations and stopping points (the detailed train simulation model is described in Dominguez et al. (2011a, 2011b )).

In the Fixed Block signalling systems a set of ATO commands are sent to the train at each station, and the corresponding speed pro fi le is executed along the next interstation. The typical com-mands are speed holding, coasting / re-motoring cycles (where the parameters are the coasting speed and the re-motoring speed) and deceleration rate (see Fig. 1 ).

The CBTC continuous communication signalling system ( Gill and Grostate, 2012 ) would permit the ATO commands to be updated along the interstations, providing new and probably more ef fi cient speed pro fi les.

In the proposed driving model for CBTC lines, a list of track section-driving commands is de fi ned from one station to the next (position, type of command, value).

The types of command in CBTC are: speed holding, coasting/ re-motoring cycles (de fi ned by coasting speed and re-motoring speed), coast and traction. In addition, a deceleration rate is de fi ned. An example of the proposed list of ATO CBTC driving commands is shown in Table 1 .
 Therefore, in the proposed CBTC driving model a new set of
ATO commands must be sent to each train from the control center when the train reaches a new section of the list, using the CBTC communication capabilities.

As an illustration, in the diagram Fig. 2 points A  X  D can be noted where the transitions among different modes as holding speed, coasting/re-motoring cycles, traction, coasting by distance, and traction are shown. A fi nal braking process with the speci deceleration rate is executed to stop at the next station. 3. NSGA-II with fuzzy parameters for the design of CBTC speed pro fi les
As previously mentioned, the running time and the energy consumptionofanATOspeedpro fi le are highly dependent on the mass of the train. The transported mass varies with the passenger load, and the associated uncertainty is modeled in this paper as a fuzzy number. Thus, in this section a NSGA-II algorithm with fuzzy parameters is proposed to calculate the Pareto curve of CBTC speed pro fi les. The algorithm is re fi ned with a time-gap detection and with dominated points algorithm to obtain a pseudo-Pareto curve. tion space in terms of dominance and crowding distance. The crowding distance (CD) is used to guarantee a more spread-out set of solutions along the Pareto curve ( Deb et al., 2002 ). for a bi-objective optimization problem is shown. An index denoting the quantity of solutions that dominate each point is the basis of determining the levels of dominated fronts. The solutions in level zero of domination (non-dominated) correspond to the optimal Pareto front.
 for every i (being i each objective function) and A i o B one objective function. If it is equal in one of the objectives then B is a weak Pareto point. The objective functions in this paper are the running time (F2) and the energy consumption (F1). 3.1. Fuzzy mass model consumption for a given interstation is shown. Different driving pro fi les have been simulated for different percentages of the train load, from 10 to 100%. This fi gure shows the important impact of the mass of the train, especially on energy comsumption. on the passenger load) is modeled as a fuzzy number. In this paper, a triangular fuzzy number is proposed for the fuzzy mass of the train (see Fig. 5 ), although the proposed NSGA-II with fuzzy parameters algorithm could be applied for other possibility membership functions S-shaped membership function ( Chang, 2010 ; Vasant et al., 2012b )).
Where m 3 is the maximum passenger additional mass.
 X  3.2. NSGA-II-F algorithm fl owchart First, a random population of CBTC speed commands is generated.
The set of CBTC commands that con fi gure one individual in the population is a set of crisp commands. The population is simulated and the uncomfortable and unfeasible speed pro fi les are dis-carded. For each individual, the simulation with the fuzzy mass ~
M of the train provides a fuzzy running time ~ T and a fuzzy energy consumption ~ E .

In the following the rest of the diagram is described: fuzzy dominance, fuzzy crowding distance, mutation and crossover, and the gap-fi lling algorithm. 3.3. Fuzzy dominance
Fuzzy dominance has been de fi ned in He et al. (2013 )asa measure to quantify the degree of domination in each objective when the quantity of objectives is high and the majority of the population becomes non-dominated in early epochs. The authors state the problem that the dominance of an individual A over another one B can be hardly ful fi lled in high dimensional pro-blems. Thus, a new fuzzy Pareto dominance relation is proposed by the authors applying a left Gaussian function to transform the performance of an individual with respect to the other into a measure in [0,1]. After that, a fuzzy product value is used to aggregate the individual fuzzy contributions for each objective obtaining in this way the fuzzy dominance value.

In Farina and Amato (2004 ) the fuzzy dominance is de fi ned by means of the fuzzy de fi nition of  X  equal to  X  ,  X  greater than than  X  , as fuzzy sets. By using fuzzy reasoning a numerical inter-pretation can be given to these linguistic concepts and de fuzzy-dominance and fuzzy-optimality levels to classify a set of solutions in a many-objective optimization problem in a more useful way for the decision maker.

In Koduru et al. (2008 ) the authors suggested a fuzzy Pareto dominance concept to compare two solutions. An individual A fuzzy dominates another B if it fuzzy dominates for each objective i . The corresponding fuzzy level of dominance is obtained by means of the fuzzy intersection of each objective (see Eq. (2) ), being the intersection a t-norm function ( Gupta and Qi, 1991; Nasir et al., 2011; Panigrahi et al., 2010; Sengupta et al., 2012 ). where the fuzzy-i dominance  X   X  dom i  X  is de fi ned as a function (monotonically non decreasing) that transforms an objective i into a measure in [0,1].

In the present paper, the problem of the design of ATO speed pro fi les in CBTC lines is a 2-dimensional problem, where the objectives are running time and energy consumption. In this case, as the mass of the train is modeled as a fuzzy number, the resulting objectives, energy and time are also fuzzy. Thus, the classical crisp dominance relation de fi ned for crisp objectives can be expressed in fuzzy terms as shown in Eq. (3) ~ A ! ~ B  X \ ~ A ! i ~ B  X  3  X  where i  X  1, 2, and the two objectives are running time and energy consumption.

Then the proposed fuzzy dominance of A over B can be de fi as the intersection of these two objectives as ~ T B 4 ~ T
To calculate the fuzzy dominance proposed in this paper, the min t-norm is used, and the fuzzy numbers ~ T B ; ~ T A ; compared in terms of possibility and necessity measures ( Dubois and Prade, 1983 ). 3.3.1. Weak fuzzy dominance
Ade fi nition of weak fuzzy dominance is proposed by means of the possibility measure. The individual A fuzzy weakly dominates B if  X   X  ~ T min t-norm for the  X  and  X  (or intersection operator) min  X   X   X  ~ T where p wd is the required level of possibility for the fuzzy comparison. A representation when  X   X  T A o T B  X  X   X  wd is shown in Fig. 7 . 3.3.2. Strong fuzzy dominance
Ade fi nition of strong fuzzy dominance is proposed by means of the necessity measure. The individual A fuzzy strongly dominates t-norm for the  X  and  X  (or intersection operator) min  X  N  X  ~ T B 4 ~ T A  X  ; N  X  ~ E B 4 ~ E A  X  X  Z n SD  X  5  X 
The necessity measure of ~ T B 4 ~ T A is equal to one minus the possibility of ~ T B o ~ T A , that is
N  X  ~ T 4 ~ T A  X  X  1  X   X  ~ T B o ~ T A  X  X  6  X 
The relationship in Eq. (6) is shown graphically in Fig. 8 . 3.4. Fuzzy crowding distance
Once the non-dominated or Pareto front and the successive dominated fronts using the previous methodology are obtained, the crowding distance (CD) measure is calculated for the solutions of each front.

In the crisp model with crisp objective functions, the de of CD is ( Kukkonen and Deb, 2006 )
CD  X  x
In Fig. 9 , the concept of crisp CD is shown. The CD for the Pareto front is calculated as the normalized sum of the cuboid edge lengths formed by the solutions that surround a determined point in the solution space.

When the mass is fuzzy, and in consequence the running time and energy consumption, the fuzzy crowding distance for a solution x k is de fi ned (see Eq. (8) ) adding the fuzzy crowding distance for each objective (Eqs. (9) and (10) ). ~
CD  X  x k  X  X  ~ CD Time  X  x k  X  X  ~ CD Energy  X  x k  X  X  8  X  ~ CD ~ CD where ~ T k  X  1 ; ~ T k 1 are the fuzzy running times and are the fuzzy energy consumptions of the adjacent solutions to x
T max T min , E max E min are the crisp normalization values for the running time and energy consumption.

By the successive application of the fuzzy dominance and crowding distance processes the population P of the NSGA-II-F algorithm is obtained. 3.5. Crossover and mutation
For each dominance level, the fuzzy crowding distance value is used to assign the mutation and crossing probabilities.
An individual with a high crowding distance measure gains a higher probability of being selected in the crossover and mutation processes.

A crossover is de fi ned between two random driving pro fi (parents) by randomly selecting and interchanging the switching point distance. The mutation operator consists of the roulette-based random selection of one of the command or switching points and the random change of the selected value in the admissible interval.

The crossover and mutation algorithms used in this research are based in differential evolution that consists of the production of new individuals through the application of scaling factors multiplied by the vector of parameters of randomly selected solutions ( Chang and Xu, 2000; Chang et al., 1999; Kwan et al., 2007; Kwan and Chang, 2005 ).

A population Q is formed by the offspring of the population P through the processes of crossing and mutation and the mixing of populations P and Q forms a new population. 3.6. Calculation of the pseudo-Pareto front
As already mentioned, a well-distributed Pareto curve is recommended to improve the performance of the centralized traf fi c regulation system. This may be partially achieved by the application of the crowding distance, but regions containing just dominated points are not fi lled.

When the real characteristics of the ATO equipment are taken into account, and when comfort criteria are applied to discard solutions, the solution spaces may have non convexities and the provided Pareto front would include important gaps it the running time that are not desirable. Inef fi cient driving pro fi taken to fi ll the gap if the difference in energy consumption is small enough (see Fig. 10 ).

A speed pro fi le that matches the needed running time but with slightly higher energy consumption should not be discarded. Although from the optimization point of view that solution is dominated, the percentage of error could be inside the limits of the simulation and data accuracy. Thus, in this case, a procedure is proposed to fi ll these running time gaps with dominated solutions in the energy consumption objective, providing the corresponding pseudo-Pareto curve.

The algorithm for the gap detection and calculation of the pseudo-Pareto curve is described in fuzzy terms. If the time distance between consecutive solutions is greater than a threshold (Eq. (11) ), then a new dominated candidate is selected to gap ( Fig. 11 a). ~ T where K is a crisp constant.

This can be expressed as a necessity measure that a fuzzy gap is detected N  X  ~ T A  X  K o ~ T B  X  Z n GAP  X  12  X 
If this necessity measure is greater than n GAP , a gap has been detected and it has to be fi lled with dominated points.
The next candidate is selected from the next dominated front considering that the energy consumption difference must be less than a pre-speci fi ed bound  X  E  X  K 2 ( Fig. 10 ).

The proposed NSGA-II-F algorithm can be expressed in terms of the  X  -cuts of the fuzzy mass of the train ( Chanas et al., 1984 ).
As shown in Figs. 7, 8, and 11 , the upper and lower limits of the -cuts of the fuzzy running times are necessary to determine the fuzzy weak/strong dominance, and to detect the gap in the Pareto curve. As the running time is increasing with the mass of the train, time can be obtained simulating the train motion with the upper (vs. lower) limit of the  X  -cut of the fuzzy mass. Similarly, as the energy consumption is increasing with the mass, this property can also be applied to calculate the upper e  X  (vs. lower e  X  -cut of the fuzzy energy consumption (see Eqs. (13)  X  (16) ). e  X 
F  X  m  X   X  X  13  X  e  X 
F  X  m  X   X  X  14  X  t  X 
F  X  m  X   X  X  15  X  t  X 
F  X  m  X   X  X  16  X  where F is the simulation function of the train motion, m upper limit of the  X  -cut of the fuzzy mass, and m  X  is the lower limit of the  X  -cut of the fuzzy mass. 3.7. Resolution
The resolution of the NSGA-II-F based on  X  -cut arithmetic can be described as follows: 1. Generation of the random initial population. The initial popula-tion of commands is generated and each driving pro fi le is simulated for the upper limit of the  X  -cut, for a value of (maximum load). This consideration has the advantage that all the possible scenarios obtained for this condition are also valid for other levels of load. On the contrary a driving pattern obtained for a lower level of passengers load could not be feasible for higher loads: the train might not reach the next station with this set of parameters. 2. Fuzzy dominance. To analyze weak/strong dominance for as described in the following. Given two solutions A and B ,to determine if A dominates B , different  X  -cuts have to be calculated depending on the application of the weak or strong dominance
Weak dominance :
A weakly dominates B if t  X  wd A o t  X  wd B , and e  X  wd A
Strong dominance : A strongly dominates B if t p SD A o t p SD B , and e p SD 3. Fuzzy crowding distance. The crowding distance (CD) is calcu-lated for the running times and energy consumptions obtained 4. Calculate population P by taking the fi rst elements of a 5. Crossover and mutation procedures are applied and new 6. Populations P and Q are aggregated. 7. Calculation of fuzzy dominance (as described in step 2). 8. Calculation the fuzzy crowding distance (as described in step 3). 9. Calculation of pseudo-Pareto front. If a time gap is detected in the fuzzy time difference between the associated running times is greater than a crisp threshold time K (Eq. (17) )
T B ~ T A 4 K ~ T A  X  K o ~ T B  X  17  X  N  X  ~ T A  X  K o ~ T B  X  Z n GAP  X  18  X  tion is described as follows: point B is simulated with the mass value corresponding to the lower limit of the  X  -cut of alpha  X  GAP  X  1 n GAP date is taken from the next dominated front considering that the energy consumption must be less to a pre-speci fi ed bound. The gap fi lling algorithm is repeated until t  X  GAP A  X  K (see Fig. 11 d).

Stopping criteria. The stopping condition is the number of generations. If the limit has not been reached, the procedure is repeated from step 4. When the algorithm fi nishes, the pseudo-
Pareto front is formed by the non-dominated Pareto points and the dominated solutions used to fi ll the running time gaps. 4. Case study and results A Metro de Madrid interstation has been selected for the design of ATO CBTC speed pro fi les by means of the application of the proposed NSGA-II-F algorithm. The interstation of Line 3 between Delicias and
Palos de la Frontera stations has an associated length of 495 m. This length is around the average interstations length in Line 3.
The train data are summarized in Table 2 , where a , b and c are the coef fi cients of the train running resistance. The maximum traction/braking effort are modeled as curves and their maximum values are indicated in Table 2 .

To deal with the uncertainty associated with the passenger load, the mass of the train has been modeled as a triangular fuzzy number ( m 1; m 2; m 3)  X  (190.897 t; 214.297 t; 237.697 t).
The parameters of the fuzzy algorithm are p wd  X  1 for the fuzzy weak dominance and p  X  1 crowding distance procedures, n the initial population of the NSGA-II-F is 50 individuals and the stopping criterion is 50 generations.

Some individuals generated and simulated by the NSGA-II-F algorithm are shown as an example in Fig. 12 .

As a base case for comparison purposes, an exhaustive simula-tion considering all the possible combinations of D2G ATO com-mands has been performed (see Table 3 ). Each command can only take discrete values according to an increase, from the minimum to maximum limits, due to communication constraints. In this case study much smaller increments than D2G ATO real systems have been considered as in Dom X nguez et al. (2014) . This way, energy savings associated just with the update of ATO commands along the interstation are calculated. Therefore, the savings calculated in this paper would be added to those obtained in the previous work.
The simulation for D2G ATO commands of Table 3 and the corresponding Pareto curve is shown in Fig. 13 .

The proposed NSGA-II-F algorithm is executed for the same interstation and ATO CBTC commands, generating a pseudo-Pareto front ( Fig. 13 ). A comparison between both D2G and CBTC solu-and 8.5% could be obtained for non-dominated and dominated speed pro fi les respectively.

A comparison between the D2G and CBTC speed pro fi les (corresponding to the 7.3% of energy savings in Fig. 13 ) are shown in Fig. 14 , and the associated ATO driving commands are described in Table 4 a and b.
 The CBTC solution given in Table 4 b is compared with the Pareto front generated for full passenger load. Fig. 15 shows that the difference between this CBTC optimal solution provided by the NSGA-II-F for  X   X  1 and the optimal solution that would be obtained for the maximum train load is 0.98%.

The resulting pseudo-Pareto front is shown in Fig. 16 ,whereatime gap (Tgap) of 3.4 s was detected by the algorithm and fi lled with the best dominated solutions available. The value of energy consumption for an initial population of 50 individuals, 50 generations, and the simulation time was 24.55 s. As a reference the computation time for the D2G ATO solution space exhaustive generation was 46.3 s.
The optimal solutions in this pseudo-Pareto curve are used by the traf fi c regulation system that selects the optimal speed pro in real time for any required running time. 4.1. Convergence
The stopping criterion that has been applied is the maximum number of generations. The reasonable number of individuals and generations is a tradeoff between computation time and accuracy of the results. In Fig. 17 the pseudo-Pareto front obtained for different population sizes is shown, running the algorithm for 50 generations in all cases.

A measure to evaluate the convergence of multi-objective algorithms is the hypervolume ( Knowles and Corne, 2002 ) given by Eq. (19) . v  X  1 number of objectives and NI the number of individuals of the ef fi cient front obtained with the algorithm. f max j and f min maximum and the minimum values for the j th objective when the objective space is bounded. If the objective space is not bounded these are the values that satisfy f max j 4 f i j and f min higher adjacent in the j th objective to individual i .
An execution of the NSGA-II-F algorithm using a high number of individuals in the population (500) and a high number of generations (400) is used as a reference for convergence comparisons. The hypervolume value for different population sizes is shown in Fig. 18 .
The evolution of the hypervolume measure with the genera-tions is shown in Fig. 19 . According to the fi gure, at around the 50th generation the algorithm has practically converged to a stable set of solutions.
 4.2. Diversity for its adequate application for traf fi c regulation purposes, given that any running time could be required by the system. This diversity is obtained by means of the application of the crowding distance criteria for the selection of solutions along successive generations, and also by the proposed algorithm to fi ll time-gaps with dominated solutions, providing a pseudo-Pareto front (see Fig. 16 ).
 5. Conclusions
The new CBTC signalling system allows the continuous com-munication of the train with the control center. This character-istic would permit the updating of ATO commands along the interstation providing new types of comfortable and more ef driving.

In this paper an algorithm is proposed for the design of these new ATO CBTC driving pro fi les to minimize the energy consumption. The running time  X  energy consumption Pareto front is calculated with the most ef fi cient driving for each running time.
Then, the centralized traf fi c regulation system will select the driving commands in real time according to the required running time of the train.
 parameters where the uncertainty associated with the mass of the train (load of passengers) is included as a fuzzy number.
In addition, a method is proposed to fi ll running time gaps with dominated points providing a pseudo-Pareto curve.
 motion, where ATO CBTC driving is modeled as a list of distance-commands to be executed along the interstation. For the resolu-tion of the NSGA-II-F, the weak and strong fuzzy dominance have been de fi ned as well as the fuzzy crowding distance by means of the possibility and necessity measures, and a procedure based on alpha-cut arithmetic has been proposed.
 pro fi les of a real interstation in Metro de Madrid, showing that important energy savings can be obtained by the re-design of ATO speed pro fi les taking advantage of the CBTC features (7 providing a well distributed pseudo-Pareto front.

Finally, the important impact that the new CBTC signalling system can have, not only in transport capacity but also in reducing the energy consumption of traf fi c operation, has been shown. Acknowledgment W. Carvajal-Carre X o has been awarded an Erasmus Mundus
Ph.D. Fellowship. The authors would like to express their gratitude to all partner institutions within the Sustainable Energy Technol-ogies and Strategies (SETS) Joint Doctorate as well as to the European Commission for their support.
 References
