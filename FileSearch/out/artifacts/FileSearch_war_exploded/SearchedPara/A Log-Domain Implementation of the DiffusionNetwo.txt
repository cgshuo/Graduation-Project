 In many implantable biomedical microsystems [1, 2], an embedded system capable of recognis-ing high-dimensional, time-varying signals have been demanded. For example, recognising multi-time [3].
 The Diffusion Network (DN) proposed by Movellan is a stochastic recurrent network whose stochas-Monte-Carlo Expectation-Maximisation (EM) algorithm [4,5]. As stochasticity is useful for gener-continuous-time biomedical data [8]. However, the stochastic dynamics of the DN is defined by a relationship of capacitors [9].
 and describe its corresponding implementation in analogue VLSI. Figure 1: The architecture of a Diffusion Network with one visible and two hidden units As shown in Fig. 1, the DN comprises n continuous-time, continuous-valued stochastic units with fully recurrent connections. The state of the j th unit at time t , x j ( t ) , is governed by of the DN [5].  X  ij defines the connection weight from unit i to unit j .  X  function given as where a adapts the slope of the sigmoid function. As shown in Fig. 1, the DN contains both visi-thus equals the dimension of the data to be modeled, while the minimum number of hidden units training data indicate how well the DN models the data. 2.1 Log-domain translation resented as a current and then logarithmically-compressed into a voltage V Xj in VLSI [11]. The (I-V) relationship of a capacitor to simulate SDEs in real-time and in parallel. x ( t ) and V Xj . equation.
 C where C Xj equals  X / X  j . Fig. 2 illustrates the block diagram for implementing Eq. (5) in VLSI. C Xj is a capacitor and V Xj the voltage across the capacitor. Each term on the right hand side of  X  Figure 3: The stochastic dynamics (gray lines) regenerated by the DN trained on the bifurcating curves (black lines). Figure 5: The stochastic dynamics (gray lines) re-generated by the DN trained on the QRS segments of electrocardiograms (black lines). 2.2 Adapting  X  j instead of  X  j The DN has been shown capable of modeling various distributions of continuous paths by adapting w instead of  X  j is investigated by Matlab simulation.
 A DN with one visible and one hidden units was proved capable of regenerating the dynamics of  X 
I S in Fig. 2, the VLSI implementation was greatly simplified. 2.3 Parameter mappings Table 1 summarises the parameter mappings between the numerical simulation and the VLSI im-in subthreshold operation, as well as to reduce the power consumption. Moreover, extensive simu-at which most instruments can sample multiple channels(units) simultaneously. Finally, the unit in C Xj =  X   X  C unit = 30 pF.
 A DN with two stochastic units have been designed with the CMOS 0.18  X  m technology provided by the Taiwan Semiconductor Manufacturing Company (TSMC). The following subsections introduce the design of each component circuit. 3.1 The EXP element Fig. 7(b) shows the schematics of the EXP element. With M1 and M2 operated in the subthreshold region, the output current is given as extracted to be 30 by plotting log( I d ) versus V GS in SPICE.
  X  from introducing simulation errors, all EXP elements of the DN unit are biased with a constant I
B = 100 nA. As shown by Fig. 7(a), I out of each element is then re-scaled by the one-quadrant where I V AR represents the current input to each element in Fig. 2 (e.g.  X   X  X  or  X x off ). 3.2 Current multipliers Eq. (5). Both  X  ij and  X  ( x i ) are represented by differential currents as multipliers in Fig. 7(c), as illustrated in Fig. 8.
 over the dynamic ranges required in Table 1.
 Figure 9: The simulation results of the four-quadrant current multiplier 3.3 Sigmoid function  X  (  X  ) Fig. 11 shows the block diagram for implementing the sigmoid function in Eq. (3). The current I transconductance amplifier(OTA) in subthreshold operation, producing an output current of R between  X  400 nA and +400 nA. The differential currents are then duplicated for the inputs of four-quadrant multipliers of all DN units.
 3.4 Capacitor amplification As C Xi = 30 pF requires consider-able chip area, C Xi is implemented by the circuit in Fig. 13, utilising the Miller effect to amplify the capaci-tance. Let A denote the gain of the amplifier. The effective capacitance between X and Y is (1 + A )  X  C X .
 Fig. 13 also shows the schematics of the amplifier whose gain is designed to be 2. As a result, C X = 10 pF is sufficient for providing an effective C
Xi of 30 pF. Figure 15: The sinusoidal dynamics regenerated by the DN chip in post-layout simulation (10 tri-als). Figure 17: The bifurcating dynamics regenerated by the DN chip in post-layout simulation (8 trials). Fig. 14 shows the chip layout of the log-domain implementation of the DN with two stochastic the CMOS 0.18  X  m Technology by the TSMC. The post-layout simulations are shown in Fig. 15  X  18 and described as follows.
 simulated by a piecewise-linear current source with random amplitudes in the SPICE. As shown tested and the measurement results will be presented in the conference. The log-domain representation of the Diffusion Network has been derived and translated into ana-logue VLSI circuits. Based on well-defined parameter mappings, the DN chip is proved capable of implantable microsystems.
 Acknowledgments The authors thank National Chip Implementation Center (CIC) for fabrication services, and Mr. C.-M. Lai and S.-C. Sun for helpful discussions. [1] G. Iddan, G. Meron, A. Glukhovsky, and P. Swain,  X  X ireless capsule endoscopy, X  Nature , vol. [2] T. W. Berger, M. Baudry, J.-S. L. Roberta Diaz Brinton, V. Z. Marmarelis, A. Y. Park, B. J. [3] M. A. Lebedev and M. A. L. Nicolelis,  X  X rain-machine interfaces: past, present and future, X  [4] J. R. Movellan,  X  X  learning theorem for networks at detailed stochastic equilibrium, X  Neural [5] J. R. Movellan, P. Mineiro, and R. J.Williams,  X  X  Monte Carlo EM approach for partially [6] H. Chen and A. F. Murray,  X  X  continuous restricted Boltzmann machine with an implementable [7] D. F. Specht,  X  X robabilistic neural networks, X  Neural Networks , vol. 3, no. 1, pp. 109 X 118, [9] L. O. Chua, T. Roska, T. Kozek, and A. Zarandy,  X  X NN universal chips crank up the computing [10] T. Serrano-Gotarredona and B. Linares-Barranco,  X  X og-domain implementation of complex [11] D. R. Frey,  X  X xponential state space filters: A generic current mode design strategy, X  IEEE [14] M. Banu and Y. Tsividis,  X  X loating voltage-controlled resistors in CMOS technology, X  Elec-[15] C. Toumazou, F. J. Lidgey, and D. G. Haigh, Analogue IC Design: The Current-Mode Ap-
