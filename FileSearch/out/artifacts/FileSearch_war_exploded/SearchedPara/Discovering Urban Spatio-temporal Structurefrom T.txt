 Understanding the urban structure is important for urban planning, transporta-tion management, epidemic prevention, and location based business. However, our and IC card records, from which we can build a  X  X rom-where-to-where X  X raffic net-simultaneously, which we refer to urban spatio-temporal structure.
Significant progresses have been made on the problem about finding inter-esting structures from networks in the fi eld of community detection [1]. For ex-ample, researchers have found protein clusters that have same specific function within the cell from protein-protein interaction networks [3]. Social circles can be mined from social networks [7]. The basic intuition shared by this methods is to find community that have more edges  X  X nside X  X he community than edges time-evolving and dynamic. Traffic in the morning is apparently different from that in the evening. Second, the structure is also related with urban contextual information. A working area owns different structure from a residential area. Then, the structure we want to find need to consider not only edge information, but also the time and urban contexture attribution.

To solve these challenges, in this paper we model the time-evolving traffic of which represents the volume of traffic from the i -thoriginareatothe j -th destination area in the k -th time domain. Considering traffic data and urban contextual information together, we propose a regularized Non-negative Tucker Decomposition (rNTD) method to solve the problem, which decomposes the original tensor to three projection matrix and a core tensor. The projection ma-trix in origin and destination mode indicate which cluster an area belongs to. The projection matrix in time mode shows temporal patterns. And the core tensor gives the correlation between spatial clusters and temporal patterns. The framework of rNTD is shown in Fig. 1. We apply Alternating Proximal Gra-dient to optimize the rNTD problem, and carry out intensive experiments to demonstrate the effectivenes s of our proposed method.

It X  X  worthwhile to highlight the key contribution of this paper.  X  We formulate the urban spatio-temporal structure discovery problem for- X  The discovered urban spatio-temporal structure is easy to understand and  X  We conducted intensive experiments on a real dataset collected from Bei-
The rest of the paper is organized as follow: Section 2 summarizes related work. Section 3 gives the formulation of our problem and the method we propose. We give experimental results in S ection 4 and conclude in Section 5. The research of urban computing have recently received much attention. Yuan et and POI. Zheng et al. [17] design an algorithm to detect flawed urban planning with GPS trajectories of taxicabs traveling in urban areas. Zhang et al. [15] propose an context-aware collaborative filtering method to sense the pulse of time air quality information throughout a city. Different from these study, we explore urban spatio-temporal structure from time-evolving traffic networks.
A great deal of work has been devoted to mining community structure from network [1]. Recently, Wang et al. [11] u se Non-negative Matrix Factorization to discover community from undirected, directed and compound networks. Yang et al. [13] develop CESNA for detecting communities in networks with node attribution. Kim et al. [4] propose a nonparametric multi-group membership model for dynamic networks. Different from the above mentioned work, we mine time-evolving traffic networks by considering node attribution ( urban contextual information ) and temporal dynamic ( time-evolving ) together. 3.1 Problem Formulation the problem of urban spatio-temporal structure discovery. Suppose we have M as d j . We split the day time uniformly to K time domain with k -th domain denoted as t k .
 We denote the time-evolving traffic networks data as a 3-order tensor  X  X  X  R we use the log function for scaling the tensor data:
Then given the time-evolving traffic networks, the spatial and temporal struc-ture discovery problem is converted to finding latent projection matrix in every mode and the correlation core tensor between them simultaneously from the traffic tensor. The projections of mode O and D summarize the spatial clusters on urban areas, and projection on T shows the temporal patterns, and correla-tion between O , D and T give the a compact view of urban traffic. As show in Fig. 1. From the result, we can get the urban spatio-temporal structure. 3.2 Basic Tucker Decomposition Let O  X  R M  X  m be the latent origin projection matrix, D  X  R M  X  m be the latent destination projection matrix, and T  X  R N  X  n bethelatenttimep rojection matrix. { d 1 , d 2 ,..., d m represents the correlation between latent factor o i , d j ,and t k .
According to the Tucker Decomposition[5], we can factorize the tensor ap-proximately based on the factor matrix and core tensor as where  X  n represents the tensor-matrix multiplication on mode n .
Then, given the observed origin-destination-time tensor X , the objective of this paper is to find the optimal latent projection matrix O , D , T and core tensor C by minimizing the following objectives The objective function can be seen as th e quality of approximation of tensor X by the projection matrix O , D , T and core tensor C . However, as mentioned above, urban structure is also strongly related with urban contextual informa-ture from only observed urban traffic network. That X  X  the reason why we need to make full use of the urban contextual information. 3.3 Urban Contextual Regularization or interesting. A POI is associated with a geo-position (latitude, longitude) and a POI category, which implies the urban contextual information . Table 1 shows the information of POI category used in this paper. For each area, the number of POI in each POI category can be counted. Then the POI feature vector in categories, and c k is the number of k -th category POI. Based on the POI feature vectors, we consider the consin distance of POI vectors to measure similarity of two areas.

In this way, we can construct the area-area similarity matrix W  X  R M  X  M .We further assume that W can be approximated by the inner product of the latent origin projection matrix and latent destination projection matrix respectively, thus we need to minimize the following objective
We also use non-negativity constraints and sparsity regularizer on the core tensor and/or factor matrices. Non-negativity allows only additivity, so the so-lutions are often intuitive to understand and explain[6]. Promoting the sparsity speaking, the core tensor interacts wit h all the projection matrices, and a sim-ple one is often preferred. Forcing the core tensor to be sparse can often keep strong interactions between the project ion matrices and remove the weak ones. Sparse projection matrices make the d ecomposed parts more meaningful and can enhance uniqueness, as explained in [8].
 matrix O , D , T and latent core tensor C by minimizing the following objective function.
 3.4 Optimization In this section, we will introduce an Alternating Proximal Gradient(APG)[12] method to solve the optimization problem.

For convenience of description, We first introduce the basic APG method to solve the problem r ( x i ) is the regularization item on x i .
 i =1to s by constant of  X  f i ( x i ), namely,
In this paper, we consider the non-negative and sparse regularization. Then the Equation 9 has closed form
Then we return to our problem. Although the objective function is not jointly convex with respect to C , O , D ,and T , it is convex with each of them with the other three fixed. We can adopt a block coordinate descent scheme to solve the problem. That is, starting from some random initialization on C , O , D ,and T , we solve each of them alternatively w ith the other three fixed, and proceed respect to the variables are  X  J  X  C  X  J  X  O  X  J  X  D  X  J  X  T where X ( k ) denotes the mode-k matricization of tensor X . 4.1 Data Sets In this section, we conduct extensive experiments to evaluate the effectiveness and show insight of our proposed method based on a real taxi trajectory dataset, which contains more than 3 millions occupied trips generated by taxis of Bei-jing in one month (November, 2011). According to the report of Beijing Trans-portation Bureau, the taxi trips occupy over 12 percent of traffic flows on road surface[14]. We split the Beijing map within 5-th Ring Road into 651 areas ac-cording to the traffic analysis zone, as shown in Fig. 2(a), which is the most commonly used unit of geography. We also split 24 time domains according to hours. After the data preprocessing, we built a (651  X  651  X  24) traffic tensor. ness. Our datasets also include a POI dataset in year 2011, which contains more than 30 thousands POI records. 4.2 Comparative Method Besides the proposed rNTD method, we also implement the following methods for comparison.  X  Basic Non-negative Tensor Factorization (bNTF): As an extension to  X  Regularized Non-negative Tensor Factorization (rNTF): By incorpo- X  Basic Non-negative Tucker Decomposition (bNTD): This is a variant We evaluate the quality of structures we discover by tensor reconstructed error using the Root Mean Square Error (RMSE) is the reconstructed tensor. 4.3 Parameter Settings In this section, we report the sensitivity of parameters our method involves, the dimensionality of hidden space m,n , and the tradeoff parameter for urban contextual regularization  X , X  .
 Dimensionality of Hidden Space. The goal of our model is to find a m  X  m  X  n -dimensional space for origin areas, destination areas and time. How to set m and n is important for our problem. If m,n are too small, the cluster can not be well represented and discr iminated in the latent space. If m,n are too large, the low-rank structure would not capture the relations between different dimensions and the computational complexity will be greatly increased. Thus, we conduct 10 experiments with m ranging from 5 to 30 and n ranging from 2 to 10 on the dataset. The result are shown in Fig. 3, from which we can see that with the increase on the dimension m,n , RMSE will reduce gradually. When m  X  20 ,n  X  3, the RMSE reduces rather slow. For the concern of the tradeoff between precision and explaination, we choose m =20and n = 3 as latent space dimension in our experiments.
 Tradeoff Parameters. The tradeoff parameters  X  ,  X  in our method play the shows the RMSE when  X , X  changes from 10  X  5 to 1. When  X , X  are small, the performance is close to that of bNTD, as we will see in Table 2. However, when  X , X  are relatively large, the optimization in Equation 7 may be dominated by the urban contextual regularization term, therefore the reconstructed loss term is not properly optimized. The result in Fig. 4 shows that the parameter set  X  =  X  =0 . 01 produce the best performance. In our following, we just use this parameter setting. Moreover, we also find the best configurations in every comparative methods on our datasets to make sure comparisons are fair. 4.4 Experimental Performance To do the comparision, We randomly select 50% 70% and 90% of the observed entries in tensor as training dataset and compute the reconstruction error of the hidden entries, where we obtain the RMSE . We repeat the experiments 10 times and report the average performance of all methods in Table 2,
From the Table 2, we can observed that:  X  The comparison between bNTF v.s. bN TD and rNTF v.s. rNTD reveals the  X  The advantage of rNTD over bNTD, as well as the advantage of rNTF over  X  Finally, our proposed method, rNTD, which incorporates the spatio-temporal 4.5 Insights by our method. As shown in Fig. 1, the goal of urban spatio-temporal structure mode association.

The projection on O and/or D gives the spatial correlation information among the areas in city. The entries with high values in a columns of O and/or D imply which cluster an area belongs to. The result is visualized in Fig. 5(a) and Fig. 5(b). Surprisingly, we see that although our method make no use of geography information, spatial cluster are geographically close. In Fig. 5(c), we plot the three columns o f projection matrix T . Along the time mode, three temporal patterns are found. This result is similar with the work in [9], where three patterns are explained as home to workspace, workspace to workspace, workspace to others. Although the patterns are similar, our method can find also the corresponding spatial patterns and the correlation between them, thus the better understanding of spatio-temporal structure of city.

We choose the Central Business District (CBD) of Beijing as a destination the origin cluster that have non-zero value with CBD destination cluster in core tensor in three temporal patterns accordingly. From Fig. 6(a), we see that most traffic to CBD, as a typical workplace, reach peak in the morning and fade down soon. In the daytime, most traffic occur in the nearby area. Since CBD is one of the most congested place in Beijing, Fig. 6 give an intuitional guidance for urban planning to solve traffic jam. In this paper we investigate the problem of discovering urban spatio-temporal structure from time-evolvi ng traffic network. We model the time-evolving traffic network into a 3-order origin-destination-time tensor. We propose a regular-ized Non-negative Tucker Decomposition (rNTD) method to solve this problem, which consider traffic data and urban contextual knowledge together. We also propose an alternating proximal gradient algorithm for optimization. Experi-mental results on a real-world dataset show that our method can significantly outperform the baseline methods.There are many potential directions of this work. It would be interesting to investigate how the POI affect urban traffic, which will give us more guideline for urban planning.
 Acknowledgement. This work is supported by National High Technology Re-search and Development Program of China (No. 2013AA01A601), NSFC (No. 61370022, No. 61202426, No. 61303075), and International Science and Technol-ogy Cooperation Program of China, (No. 2013DFG12870).

