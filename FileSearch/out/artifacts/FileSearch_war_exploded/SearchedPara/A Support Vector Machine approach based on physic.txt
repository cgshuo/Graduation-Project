 K.C. Gryllias, I.A. Antoniadis n 1. Introduction
Rolling element bearings consist one of the most widely used industrial machine elements, being the interface between the stationary and the rotating part of the machine. The capability to detect fast, accurately and easily the existence and severity of a fault in an installation during operation is very important, since an unexpected failure of machine can lead to unacceptably long time maintenance stops. Thus, due to their importance, a plethora of monitoring methods and fault diagnosis procedures has been developed for rolling element bearings.

A large number of them are based on a physical and engineering concept, as established long ago by the term  X  X  X igh Frequency Resonance Technique (HFRT) X  X  ( McFadden and Smith, 1984a ). This method is alternatively known as Demodulated Resonance Analy-sis or Envelope Power Spectral Density Analysis ( Randall, 1987 ), since it consists in band-pass filtering a frequency range around a machine structural resonance, which is excited by the periodic impulsive excitation forces, generated on bearings with localized defects. Further demodulating this band generates a signal envel-ope which presents a clearer impulsive nature than the signal itself, able to identify and characterize the nature of the defect. In order to overcome certain disadvantages of the traditional HFRT method, which mainly result due to the use of the Hilbert Transform, a demodulation method based on the use of Complex Shifted Morlet Wavelets (CSMW) has been proposed ( Nikolaou and
Antoniadis, 2002 ). Moreover, since the traditional Hilbert Trans-form based demodulation procedure requires a significant degree of manual intervention from an experienced user, a number of approaches have been proposed for the automatic selection of certain key parameters of this demodulation approach.
Parallely, due to the reason that the traditional engineering approaches  X  such as the HFRT  X  require experienced users, an impressive number of methods have been presented for defective rolling element bearing fault detection  X  and more generally for
Machine Condition Monitoring  X  based on intelligent and/or expert systems. These methods include A rtificial Neural Networks (ANN),
Fuzzy Expert Systems, Condition-Based Reasoning, Random Forest, etc. Artificial intelligent techniques are combined with expert systems, attempting to transfer ex pertise from human to computers.
These methods in general belong to two broad categories, concerning the data classification procedure: Supervised Learning approaches and Unsupervised Learning approaches. The most well known supervised learning class of methods, the traditional
Artificial Neural Networks (ANN), present a number of drawbacks, such as poor generalization capability and a potential tendency of local rather global solutions. Moreover they can give rise to models that can over fit the data, while they may require a relatively large number of data training samples.
 involving unsupervised learning procedures have emerged for fault identification, such as Kernel Principal Component Analysis ( Cho et al., 2005 ), Bayesian Inference-based Finite Gaussian Mixture Models ( Yu and Qin, 2008 ) and Multiway Gaussian
Mixture Models ( Yu and Qin, 2009 ). Although some preliminary encouraging results of such methods for rolling element bearing fault diagnosis have been reported ( Yiakopoulos et al., 2011 ), unsupervised learning procedures present some inherent disad-vantages over supervised learning. Unsupervised learners cannot provide labeled classifications. Since the data clusters result in an unsupervised way, they cannot be easily attributed to specific faults, requiring the a-posteriori intervention of experienced personal. Moreover, most existing unsupervised learning methods still present stability, convergence and robustness problems. considered in this paper, since they have been shown to present a number of advantages. Support Vector Machine is a relatively new computational supervised learning method based on Statis-tical Learning Theory and combines fundamental concepts and principles related to learning, well-defined formulation and self-consistent mathematical theory. Unlike to most classification methods, Support Vector Machines (SVM) do not require a large number of training samples ( Burges, 1998 ; Gunn, 1998 ). More-over, the SVM method can solve the learning problem even when only a small amount of training samples is available. Due to the fact that it is hard to obtain sufficient fault samples in practice,
SVM is introduced into health monitoring due to its high accuracy and good generalization for a small number of samples. have been already proposed for rolling element bearing fault detection, and more generally, for rotating Machine Health Condi-tion Monitoring. Jack and Nandi (2001) examined the performance of Artificial Neural Networks (ANN) and Support Vector Machines (SVMs) in one given scenario, a multiclass fault characterization example. A number of different fo rms of preprocessing were used, including plain statistics, signal differences and sums, Highpass and
Lowpass filtering as well as spect ral data. SVMs produced at worst comparable results with the best ANN. The value of the kernel parameter required for good classification performance was selected by using an average value of the standard deviation of all the members of a given class. Jack and Nandi (2002) used the Genetic
Algorithms in order to select the value of the kernel parameter. Only the separable case is used (The miscl assification penalization term is thought of as equal to infinity). In Rojas and Nandi (2006) a mechanism for selecting adequate training parameters is proposed. bearing condition using vibration signals were presented. Compar-isons are made between the performance of ANNs and SVMs, both without and with automatic selection of features and classifier parameters. The main difference between Samanta et al. (2003) and Jack and Nandi (2002) is in the process of feature extraction from the time-domain signal. The selection of input features and the classifier parameters are optimized using a GA-based approach. multi-class SVMs for rotating machinery. This paper offers a comparison between two kinds of algorithms, the SVMs and other traditional Neural Networks, such as the Self-Organizing
Feature Map (SOFM), the Learning Vector Quantization (LVQ), the Radial Basic Function (RBF) and the Adaptive Resonance
Theory (ART) networks. The experiments have demonstrated that this approach can successfully diagnose any condition and the average fault diagnosis accuracy is over 90%.

In Yang et al. (2007) , the capacity dimension, the information dimension and the correlation dimension are applied to classify various fault types and evaluate various fault conditions of rolling element bearing, and the classification performance of each fractal dimension and their combinations are evaluated by using
SVMs. Experiments showed that the classification performance of the single fractal dimension is quite poor on most data sets.
Moreover, the classification performance of the SVM trained with 11 time-domain statistical features in tandem with three fractal dimensions outperforms that of the SVM trained only with 11 time-domain statistical features or with three fractal dimensions.
In Hu et al. (2007) a novel method for fault diagnosis based on an improved wavelet package transform (IWPT), a distance evaluation technique and the Support Vector Machines (SVMs) ensemble is presented. The proposed method is applied to the fault diagnosis of rolling element bearings, and testing results show that the SVMs ensemble can reliably separate different fault conditions and identify the severity of incipient faults, which has a better classification performance compared to the single SVMs.
Yuan and Chu (2007a) used Artificial Immunization Algorithm (AIA) in order to optimize the parameters in SVM. The AIA is a new optimization method based on the biologic immune princi-ple of the human being and other living beings. With the parameters optimized by AIA, the total capability of the SVM classifier is improved. The fault diagnosis of turbo pump rotor shows that the SVM optimized by AIA can give higher recognition accuracy than the normal SVM.

In Yuan and Chu (2007b) a new method that jointly optimizes the feature selection and the SVM parameters with a modified discrete particle swarm optimization is presented. This new method can select the best fault features in a shorter time, improves the performance of the SVM classifier, and presents fewer errors and a better real-time capacity than the method based on Principal Component Analysis (PCA) and SVM, or the method based on Genetic Algorithm (GA) and SVM, as shown in the application of fault diagnosis of the turbo pump rotor.
In Samanta and Nataraj (2009) , a study is presented on the application of Particle Swarm Op timization (PSO) combined with other Computational Intelligence (CI) techniques fo rbearingfault detection in machines. Results are compared with other techniques such as Genetic Algorithm (GA) and Principal Component Analysis (PCA). The PSO based approach gave a test classification success rate of 98.6 X 100%, which were compar able with GA and much better than with PCA. The results show th e effectiveness of the selected features and the classifiers in the detection of the machine condition.
However, two basic problems are encountered in the above procedures: (A) Experimental data from the machine under actual fault conditions are required for their training. Such data are quite hard to obtain in an industrial environment, since neither artificial faults can be introduced in industrial equipment under operation, nor the application of the diagnostic procedure can be postponed after the occurrence of an actual fault. (B) Quite complex feature sets are used based mostly on general criteria resulting from information theory or statistical processing, rather than features and measures resulting from the engineering knowledge of the specific application. These two problems may render the above methods practically inapplicable in industrial environments.
In order to overcome these two problems, the SVM approach proposed in this paper can be trained using simulation data, which result from a well established model, describing the dynamic response of defective rolling element bearings, as a result of the implementation of the  X  X  X igh Frequency Resonance Technique (HFRT) X  X  ( McFadden and Smith, 1984b ), under appropriate exten-sions and enhancements ( Randall, 1987 ; Antoni and Randall 2002 ). A key aspect of the method is the data preprocessing approach, which among others, includes order analysis, in order to overcome problems related to sudden changes of the shaft rotating speed. Moreover, frequency domain features both from the raw as well as from the demodulated signal are used as inputs to the SVM.
Then vibration measurements, resulting from the machine under condition monitoring, can then be imported and processed directly by the already trained fault diagnosis system. A two-stage recognition and classification SVM approach is used. At the first stage, a SVM classifier separates the normal condition signals from the faulty signals. At the second stage, a SVM classifier recognizes and categorizes the type of the fault (Inner or Outer race defect). The effectiveness of the method is tested in one literature estab-lished experimental test case and in three different industrial test cases, including a total number of 34 measurements. Each test case includes successive measurements from bearings under different types of defects, different loads and different rotation speeds. In all cases, the method presents 100% classification success.
The rest of the paper is organized as follows. Section 2 presents an overview of Support Vector Machines. Section 3 presents an overview of the dynamic model used to simulate the vibration response of defective rolling element bearings. Section 4 presents the proposed method, including the description of the data preprocessing procedure, the selected feature set and the pro-posed multistage SVM based classifier. Section 5 presents the results from an experimental test case and section 6 presents the results from three different industrial test cases. 2. Overview of Support Vector Machines (SVM) 2.1. Basic concepts of SVM
Briefly, the basic idea of SVM ( Christianini and Shawe-Taylor, 2000 ; Vapnik, 1995, 1998 ; Platt, 1999 ) is to transform the signal to a higher dimensional feature space. Then the SVM solves a binary problem in which data are separated by a hyperplane. The hyper-plane is defined through the use of support vectors, which are a subset of the data available for both cases and define the boundary between the two classes. In a two-dimensional case, the action of the SVM can be easily explained without any loss of generality in
Fig. 1 . This boundary can be expressed with the use of the support vectors as  X  w U x  X  X  b  X  0 , w A R N , b A R ,  X  1  X  where the vector w defines the boundary, x is the input vector of dimension N and b is a scalar threshold. At the margins, where the
SVs are located, the equations for classes A and B, respectively, are  X  w U x  X  X  b  X  1and  X  w U x  X  X  b  X  1  X  2  X 
As SVs correspond to the extremities of the data for a given class, a decision function can be created to specify whether a given data point belongs to either A or B. This is defined as: f  X  x  X  X  sign  X  X  w U x  X  X  b  X  ,  X  3  X 
The optimal hyperplane can be obtained as a solution to the optimization problem:
Minimize  X  w  X  X  subject to y  X  X  w U x i  X  X  b  X  Z 1 , i  X  1 , ... : , l ,  X  5  X  where l is the number of training sets. The solution of the constrained quadratic programming (QP) optimization problem can be obtained as w  X 
X where x i are SVs obtained from training. Substituting Eq. (5) in Eq. (3), the decision function is obtained as follows: f  X  x  X  X  sign 2.2. Data separation and kernel functions
In cases where the linear boundary in input spaces is not be able to separate the two classes accurately, a hyperplane is created that allows linear separation in the higher dimension.
This is achieved through the use of a transformation f  X  x  X  , which transforms the data from an N-dimensional input space to
Q-dimensional feature space s  X  f  X  x  X  ,  X  8  X  where x A R N and b A R ( Fig. 2 ). Substituting the transformation (8) in Eq. (7) results to f  X  x  X  X  sign
The transformation into higher-dimensional feature space is relatively computation-intensive. Therefore, a kernel can be used to perform this transformation and the dot product in a single step provided that the transformation can be replaced by an equivalent kernel function. The definition of legitimate kernel function is given by the Mercer X  X  theorem. The function must be continuous and positive definite.
 The kernel function K  X  x , y  X  is defined as K  X  x , y  X  X  f  X  x  X  U f  X  y  X  ,  X  10  X 
The decision function is accordingly modified as f  X  x  X  X  sign
The parameters v i are used as weighting factors to determine which of the input vectors are actually support vectors  X  0 o v Some kernel functions are shown as follows: K  X  x , y  X  X  x U y ,  X  12  X 
K  X  x , y  X  X  X  / x U y S  X  1  X  p ,  X  13  X  where p is the power number of polynomial.
 K  X  x , y  X  X  exp  X  9 x y 9 2 = 2 s 2  X  ,  X  14  X  K  X  x , y  X  X  tanh  X  v U / x U y S  X  c  X  ,  X  15  X  with nonseparable data, the range of parameters v i may be limited to reduce the effect of the outliers on the boundary defined by SVs. In these nonseparable cases, a constraint is proposed: 0 o v i o C :  X  16  X  which are mis-separated by the optimal separation plane. Its role is to strike a proper balance between the calculation complexity and the separating error. For separable case, C is infinity while for nonseparable case, it may be varied, depending on the number of allowable errors in the trained solution: few errors are permitted for high C , while low C allows a higher proportion of errors in the solution. To control the generalization capability of SVM, there are a few free parameters like the limiting term C and the kernel parameters like RBF width s .
 correctly, there is not a most effective method up to now. A number of approaches have been presented including Genetic Algorithms ( Jack and Nandi, 2002 ; Samanta et al., 2003 ), Artificial Immunization Algorithm ( Yuan and Chu, 2007a ), Particle Swarm Optimization ( Samanta and Nataraj, 2009 ; Yuan and Chu, 2007b ),
Cross validation ( Christianini and Shawe-Taylor, 2000 ; Hsu et al., 2005 ), iterative process and user defined selection. 2.3. Multiclass classification strategies
However in the real world problems, usually more than two classes exist, e.g. in fault diagnosis of rotating machinery there are several fault classes such as mechanical unbalance, misalignment, bearing faults, etc. In order to overcome this particularity of
SVMs, a number of multiclass classification strategies have been proposed ( Hsu and Lin, 2002 ).

One-against-all (OAA) methods were the earliest used imple-mentations for SVM multiclass classification. A number of k SVM models are constructed ( k is the number of classes) and the i th
SVM is trained with all the examples in the i th class with positive labels, while all the other examples are noted as negative labels.
At One-against-one (OAO) methods, k ( k 1)/2 classifiers are constructed and each one is trained on data from two classes.
Different methods have been proposed for the future testing after the construction of the k ( k 1)/2 classifiers, e.g. the Max Win strategy. At the directed acyclic graph SVM (DAGSVM) the training phase is the same as the one-against-one method by solving k ( k 1)/2 binary SVMs. However, in the testing phase, it uses a rooted binary directed acyclic graph which has k ( k 1)/2 internal nodes and leaves. Each node is a binary SVM of i th and j th classes. Given a test sample, starting at the root node, the binary decision function is evaluated. Then it moves to either left or right depending on the output value. 3. Defective rolling element bearing vibration model
The dynamic behavior of rolling element bearings and machines under localized defects has been a subject of intensive research, leading to a number of well established models ( Antoni and Randall, 2002 ; Randall, 1987 ; McFadden and Smith, 1984b ).
As a result, instead of experimental data which are difficult to obtain, a model can be used, in order to train the Support Vector Machine. Following actually the same concepts as in ( Antoni and
Randall, 2002 ; McFadden and Smith, 1984a , b ), the basic elements of such a model are as follows.

The repetitive impacts produced by a localized bearing defect can be described by a train of Dirac delta functions d ( t ) of the following form: d  X  t  X  X  where d 0 is the amplitude of the impulse force characterizing the severity of the defect. The impulse repetition period T d reciprocal of the characteristic Ball Pass Frequency Outer race (BPFO) or Ball Pass Frequency Inner race (BPFI) of a rolling element bearing, depending on the type of defect. These two frequencies are proportional to the shaft rotation speed f their value depends on the bearing geometric characteristics. The function q  X  t  X  is the distribution of the load around the rolling element bearing under radial load which is approximated typically by the well-known Stribeck equation: q  X  t  X  X  q 0  X  1  X  1 = 2 where q 0 is the maximum load intensity, e is the load distribution factor, y max is the angular extent of the load zone and n  X  3/2 for ball bearings. The terms q 0 , e and y max are all functions of the diametral clearance of the bearing and the applied load. For a bearing with positive clearance, e o 0.5 and y max o p /2 .
However, significant variations of the dynamic response of a defective rolling element can exist, when certain parameters of the above equation are assumed to present rather a stochastic than a deterministic behavior. The amplitude of the impacts depends mainly on the load distribution around the circumfer-ence of the bearing, as well as on other parameters, such as on the variation in the dynamic stiffness of the assembly, the waviness of the rolling elements and races, and the existence of off-sized balls in the ball complement. Therefore, the series of the impacts should be rather considered as randomly modulated in amplitude.

In parallel, rolling element bearings present a slip motion, which introduces nonlinear effects to the system. As a conse-quence, the impulses never occur exactly at the same position from one cycle to another.

Thence, a more realistic model for the impact train of a defective rolling element bearing should be of the following form: d  X  t  X  X  where A k are random variables for the amplitude of the k th impulse force with a probability density function typically assumed to be normal (Gaussian), t k is a random variable for the time lag between two impacts due to the presence of slip, which is typically assumed to be of zero mean and of normal (Gaussian) probability density function.

When an impulse train is applied to the rolling element bearing, it will excite structural resonances. Assuming for simpli-city that the excited structure is a linear MDOF system, the impulsive structural response of such a system to each impulse can be expressed by the following function: s  X  t  X  X  f where i  X  1 , ::: , M are the excited modes, and for each mode i , f the resonance frequency, and z i is the damping factor. Therefore, the dynamic response x  X  t  X  resulting from an induced defect in a bearing can be expressed by where the symbol denotes convolution and n  X  t  X  is an additive background noise, which takes into account the effects of the other vibration sources of the system and the external environment. This noise signal is typically assumed to be a white noise signal. 4. A hybrid one-against-all strategy for a serial SVM model based classification 4.1. Characteristic features of defective rolling element bearing vibration signals
The dynamic model for the vibration response of defective rolling element bearings, described in the previous section 3 , foresees that bearing defects cause impacts at characteristic  X  X  X efect frequencies X  X , governed by the rotating speed of the machine and the geometry of the bearings, which in turn excite various machine natural frequencies. As a result, a  X  X  X piky X  X  behavior is generated in the time domain signal. The frequency-domain transform of the signal results to entire high frequency regions around the excited natural frequencies which are domi-nated by characteristic defect frequency sidebands. Typical exam-ples of such spectra of defective bearings are presented in Fig. 7 for an outer race defect and in Fig. 9 for an inner race defect. Due to this characteristic dynamic behavior, different features and feature extraction methods have been proposed, including signal statistical analysis in the time domain, low and high-pass filter-ing, normalization, time derivation and integration of signals, Fourier transform and wavelet transform.

Some characteristic statistical time domain feature parameters used are:
Kurtosis, which is a measure of whether the data are peaked or flat relative to a normal distribution.

Skewness, which is a measure of symmetry or the lack of symmetry of the signal.

Variance, which is a measure of dispersion of a waveform about its mean.

RMS of a signal, which indicates the severity of a bearing defect.

These parameters  X  and especially skewness and kurtosis  X  are considered to be especially appropriate for  X  X  X piky X  X  signals, like the ones characterizing the behavior of defective rolling element bearings. Additionally to them, a number of other time domain features can be considered. 4.2. Proposed data preprocessing and feature extraction
Alternatively to the time domain features, frequency domain features are considered in this paper, since taking into account the energy at well specified frequency bands can lead to a more accurate diagnosis and monitoring of the operating condition of rotating machinery.

First, prior to frequency analysis, the signals are preprocessed using order analysis. The basic idea of order analysis for rotating machinery is to lock the sampling intervals of the signal rather to constant angular shaft positions ( X  X  X quiangular sampling X  X ) than to constant time intervals. This is necessary because the rotating speed of the machine is generally varying, or, as in the case of x  X  t  X  X  rolling element bearings, slip can occur due to imperfect rolling conditions. As a result, the application of spectrum analysis directly to the time domain for this kind of signals will lead to the so-called  X  X pectral smearing X . The original signal can be sampled at constant angular shaft positions using two different techniques. The external sampling technique relies on the hard-ware to lock the sampling times to constant shaft positions. The digital resampling method uses an interpolation algorithm to interpolate the original data acquired at constant sampling frequency and generate a resampled signal at constant shaft positions. The implementation of FFT on this signal transforms the angular domain into the order domain (i.e. orders of shaft rotating speed) in the same way as an FFT transforms the time domain into the frequency domain. Thus, the resulting spectral lines represent constant orders instead of constant frequencies.
Due to the presence of characteristic sidebands of inner or outer race defect frequencies around the machine natural frequencies as a typical feature of defective rolling element bearings ( Figs. 7 and 9 ), a number of demodulation methods have been proposed. Demodulation or enveloping based methods offer a stronger and more reliable diagnostic potential, since they are based on a more solid physical background. The corresponding physical mechanism is described in ( McFadden and Smith, 1984b ). The goal of the enveloping is first to isolate the measured signal in a relatively narrow frequency band around a specific natural frequency using a band-pass filter and then to demodu-late it in order to produce a low-frequency signal, called  X  X nvelope X . Carrier signals are removed and this decreases the influence of irrelevant information. The envelope signal is obtained by applying the well known Hilbert transform. The
Hilbert envelope spectrum is given by h  X  f  X  X  where H  X  x  X  t  X  is the Hilbert transform of a series x  X  t  X  : Hx  X  t  X   X   X  1 p
As a result of the demodulation procedure, the envelope spectrum of defective rolling element bearings is now dominated mainly by spectral peaks at harmonic frequencies clearly char-acterizing the existence and the type of the defect. For example, the spectra of the envelope of a bearing with an outer race defect is presented in Fig. 8 . Contrary to the spectra of the corresponding signal in Fig. 7 , the spectra of the signal envelope are now characterized by a number of peaks at harmonic frequencies of the BPFO/Ball Pass Frequency Outer Race of the bearing (around Hz Hz Hz Hz Hz Hz Hz Hz Hz Hz encounter a defect at the outer race of the bearing. The envelope spectrum of a bearing with an inner race defect is presented in Fig. 10 and is similarly dominated by the BPFI/Ball Pass Frequency Inner Race of the bearing (around 150 Hz), as well as harmonics of the shaft rotating speed.

For this reason, the vibration energ ies at characteristic frequency bands of the signal and of the envelope are the main proposed indices to be used as input features, as presented in Table 1 .
These indices are energies in the spectrum of the signal or its envelope at the following characteristic frequency bands: The shaft rotating speed and its harmonics up to fourth order.
The Ball Passing Frequency Outer Race (BPFO) frequency and its harmonics up to fourth order. The peaks at the BPFO frequency harmonics characterize the ex istence of an outer race fault.
The Ball Passing Frequency Inner Race (BPFO) frequency and its harmonics up to fourth order. The peaks at the BPFO frequency harmonics characterize the existence of an inner race fault.

The first sixteen energies in Table 1 are derived from the spectrum of the envelope of the signal and are normalized by the Total Energy of the demodulated signal. The last two energies are derived from the spectrum of the raw signal and are normalized by the corresponding Total Energy of the raw signal. The main advantage of the normalization is to avoid attributes in greater numeric ranges to dominate on those in smaller numeric ranges. Another advantage is to avoid numerical difficulties during the calculation. Kernel values usually depend on the inner products of feature vectors, e.g. the linear kernel and the polynomial kernel, and as a result large attribute values might cause numerical problems.
The lowest frequency f H , as used in the definition of the HFE index in Table 1 , is selected equal to 1000 Hz, since this frequency is considered to characterize the typical lower limit of the high-frequency bands, excited by the bearing impulses, while f denotes the Nyquist frequency. The enveloping procedure takes place in the frequency band range from f H ,upto f s /2. 4.3. Classification strategy
A hybrid algorithm based on an one-against-all strategy is adapted in order to construct two (2) two-class SVM classifiers. These two (2) two-class classifiers are ranged as a binary tree and thus become a multi-class fault diagnosis system. The proposed diagnostic procedure follows the flow chart of Fig. 3 . First, the defective rolling element bearing vibration model is tuned to the specific application conditions and a number of simulated signals presenting an outer or an inner defect are produced. The healthy condition is simulated by a number of white noise signals. Afterwards, two Support Vector Machines are trained. The first
SVM (SVM 1) is trained in order to detect whether a fault exists or not. For this reason, only three features are used, as shown in
Table 2 . When the test signal represents a normal bearing condi-tion, the output of SVM 1 is set to  X  1 and the classification process is over. Otherwise, the output is set to 1 and the fault diagnosis is transferred to the second SVM (SVM 2). The second SVM is used in order to identify the type of the fault (Outer or Inner race). In this case, a set of 15 frequency domain features are used, as shown in
Table 2 . When the test signal presents an inner race fault the output of SVM 2 is set to 1, and when it represents an outer race fault, it is set to  X  1. This setup is necessary as SVM can only deal with two classes. Moreover such a structure ameliorates the procedure, speeds up the fault detection and results in a simple and robust structure, as necessary for industrial applications. Then the measured signals are preprocessed and the Energy
Features of Tables 1 and 2 are extracted. The data are imported consecutively at the trained SVM 1 and SVM 2 and the outputs of the Support Vector Machines reveal the c ondition of the tested bearing.
The selection of the type of the kernel function and the corresponding parameter, as well as the choice of the penalty factor C exert a considerable influence on the performance of the
SVM. In practice the parameter C is varied through a wide range of Hz Hz Hz Hz Hz Hz Hz Hz values. Its role is to strike a proper balance between the calcula-tion complexity and the separation error. Whether the value of C is too big or too small can reduce the generalization of SVM.
For simplicity and robustness reasons in industrial environ-ments, a Linear Function is selected as kernel function. The penalty parameter C is set equal to 100, representing a high value and as a result, few classification errors are permitted. Hz 5. Experimental application 5.1. Description of experimental setup first in an experimental application. The vibration data used at this session have been obtained from the ball bearing test data set of the Western Reserve University Bearing Data Center Website ( Loparo, K.A ). As shown in Fig. 4 , the test stand consists of a 2 hp Reliance
Electric motor (left), a torque transducer/encoder (center), a dynam-ometer (right), and control electro nics (not shown). The test bear-ings support the motor shaft. Vibration data was collected using accelerometers, which were attached to the housing with magnetic bases. Vibration signals were collected using a 16 channel DAT recorder, and were post processed in a MATLAB &amp; environment.
Digital data was collected at 12,000 samples per second. Speed and horsepower data were collected us ing the torque transducer/enco-der and were recorded by hand. Each signal is 8192 samples long.
The bearing monitored is a deep groove ball bearing manu-factured by SKF. The drive end bearing is a 6205-2RS JEM with a
BPFI frequency and a BPFO frequency equal to 5.4152 and 3.5848 times the shaft frequency respectively, leading to the theoretical estimations of the expected BPFO and BPFI frequencies presented at Table 6 . Single point faults are introduced into the drive-end test bearings using electro-discharge machining with fault diameters of 7 mils and 21 mils (1 mil  X  0.001 in.) at the inner Hz Hz race and at the outer race, respectively. Each bearing was tested under four different loads (0, 1, 2 and 3 hp) resulting to four different motor speeds. The bearing data set was obtained from the experimental test rig under three different operating condi-tions: (a) normal condition (3 measurements), (b) with an outer race fault (8 measurements) and (c) with an inner race fault (8 measurements) as presented at Table 6 .

The spectra of indicative signals and their corresponding envelopes are presented in Figs. 5 X 10 . 5.2. Training and classification procedure performance assessment
The two-stage SVM approach was applied in all nineteen (19) test cases. The defective bearing model is tuned in order to produce a certain number of simulated signals. The model is updated with the shaft rotation speed and the expected BPFO and
BPFI frequencies of the bearing. Afterwards, four model para-meters are selected as shown at Table 3 : (a) The mean Amplitude of the signal (Gs), (b) the Slip (%), (c) the Level of Noise NL (%) and (d) the excited Natural Frequency (Hz). Four different amplitudes were selected in order to cover the mean amplitude vibration signal range between 0 and 40 Gs Rms (concerning signals presenting an Outer Race Defect) and 0 and 40 Gs Rms (concern-ing signals presenting an Inner Race Defect). In all cases, the standard deviation of the signal amplitude was selected equal to 5%. Simulated signals were produced using totally four different amplitudes, three resonance frequencies, three levels of noise and three levels of slip. The noise at simulated signals is up to 5% SNR while the percentage of slip fluctuates up to 3%. A single resonance was selected, since the variation of the resonance Hz Hz frequency covers the entire frequency band. Finally the model was used to generate 108 signals representing an inner race defect and another 108 representing an outer race defect. The normal condition is simulated using a white noise with 12 different noise levels. The envelope spectra of characteristic simulated signals are presented in Figs. 11 X 13 . The simulated signals at Fig. 11 are white noise signals indicating the normal condition. The signals at Fig. 12 present an outer race defect, while the signals at Fig. 13 present an inner race defect. the features presented at Table 1 are derived. Afterwards, the two SVMs are trained. The inputs for each SVM are shown in Table 2 . For each SVM the Linear Basis Function is used. The limiting term
C is chosen equal to 100 (high value) and as a result few errors are permitted. The inputs of the first (1) Support Vector Machine are (a) the Sum of Shaft Harmonics (SSHR), extracted from the raw signal, (b) the Sum of bearing Inner and Outer Race defect
Harmonics (SIORH), extracted from the Envelop signal and (c) the High Frequency Energy (HFE) extracted from the raw signal.
The training set consists of 228 examples, 12 positive and 216 negative. Two (2) Support Vectors were selected while none of them is at the bound C, as shown at Table 4 .
 The inputs of the second SVM are presented at Tables 1 and 2 .
The training set is consisted of 216 examples, 108 positive and 108 negative. Three (3) Support Vectors were selected, one (1) from positive examples and two (2) from negative examples ( Table 5 ).
The 19 available measurements corresponding to the different stages and the different type of the fault are then used, in order to test the results of the trained SVM. The results of the application of the proposed two-stage classification using SVMs are presented Hz Hz in Table 6 . As it can be observed, the success rate of the method is 100% in both stages at all measurements of all cases. 6. Industrial application 6.1. Industrial application description
The evaluation of the proposed approach has been performed also in three different test cases, which include successive measurements from the vibration response of defective rolling element bearings in three different industrial installations.
The vibration data set in Test Case I includes signals measured on an industrial fan with a defective rolling element bearing on the outer race. The shaft rotation speed during the measurements was around 1200 rpm (20 Hz). The bearing monitored is of SKF type 2312, with a BPFO frequency equal to 4.72 times the shaft rotation speed, leading to a theoretical estimation of the expected
BPFO frequency around 94 Hz. Each signal is 4,096 samples long and recorded with a sampling rate of 8.33 KHz. The time interval between two successive measurements is about 2 months. The spectra of the signals are presented in Fig. 14 and the spectra of their envelopes are presented in Fig. 15 .

The measurements in Test Case II were performed on a rolling element bearing of an industria l pump, presenting an inner race fault. The shaft rotation speed during the measurements was around 1320 rpm (22 Hz). The bearing type is of 22205 EK type, with a BPFI frequency equal to 8.32 times t he shaft frequency, leading to a theoretical estimation of the expected BPFI frequency around 183
Hz. Each signal is 4096 samples long and recorded with a sampling rate of 8.33 KHz. The spectra of the signals are presented in Fig. 16 and the spectra of their envelopes are presented in Fig. 17 . Hz Hz at an industrial compressor presenting an outer race fault. The shaft rotation speed during the five measurements was around 1350 rpm (22.5 Hz). The bearing monitor ed is of 22228 cck/w3 type, with a
BPFO frequency equal to 8.22 times the shaft frequency, leading to a theoretical estimation of the expected BPFO around 185 Hz. Each signal is 4096 samples long and recorded with a sampling rate of 8.33 KHz. This test case presents a fast progress of the bearing defect. Each of the first four measurements was recorded with a time interval about a week from the previous one. The fifth signal was measured after the shutdown of the machine and the replace-ment of the defective bearing. The spectra of the signals and their envelopes are presented in Figs. 18 and 19 . 6.2. Industrial classification performance analysis
The two-stage SVM approach was applied at the three test cases. The sampling rate for all signals was 8.33 KHz. For this reason the three resonance frequencies for the simulated signals were selected a bit lower at the frequency domain. Again totally 108 simulated signals were generated for each fault and each test case. Moreover, 12 simulated signals were generated, represent-ing the healthy condition of the bearing. The 228 signals are further processed using order analysis and the 18 features of
Table 1 are calculated. The spectra of three characteristic simu-lated signals and their corresponding envelopes are presented respectively for each of the three cases in Figs. 20 X 25 . The first Hz Hz simulated signal presents an outer race defect, the second one presents an inner race defect and the third one is a white noise signal indicating the normal condition.

The 228 signals are further processed using order analysis and the features presented at Table 1 are derived. Afterwards, the two
SVMs are trained using the features shown in Table 2 . The training set for the first SVM consists of 228 examples, 12 positive and 216 negative. The inputs of the second SVM consist of 216 examples, 108 positive and 108 negative.

At Case I at the first SVM, two (2) Support Vectors were selected, one from positive examples and one from negative examples, while none of them is at the bound C ( Table 7 ), while at the second SVM four (4) Support Vectors were selected, two (2) from positive examples and two (2) from negative examples ( Table 8 ). Hz step, one from positive examples and one from negative exam-ples, while none of them is at the bound C ( Table 10 ). Further-more, three (3) Support Vectors were selected at the second step, one (1) from positive examples and two (2) from negative examples ( Table 11 ).

SVM, two from positive examples and two from negative exam-ples, while two of them are at the bound C ( Table 13 ). Four (4) Support Vectors were selected at the second SVM, one (1) from positive examples and three (3) from negative examples ( Table 14 ).
 to the different stages of the fault are then used, in order to test the results of the trained SVM. The results of the application of the proposed two-stage classification using SVMs are presented in Tables 9, 12 and 15 . As it can be observed, the success rate of the method is 100% in both stages at all measurements of all cases. 7. Conclusion
The presented results from the application of the proposed hybrid two stage one-against-all Support Vector Machine (SVM) approach for the automatic diagnosis of defective rolling element bearings condition, present an 100% classification success rate in both classification stages at all 34 measurements of the experimental and the three industrial test cases. This success rate is mainly due to the fact that the feature set used for the training of the SVM results from a well established physical and engineer-ing model, describing the dynamic behavior of defective rolling element bearings. This fact can be verified by the comparison mainly of the envelope spectra of the experimental or industrial measurements, with those resulting after the implementation of the dynamic model. As a result of the quality and suitability of this proposed feature set, a very small number of support vectors is actually needed. Thus, a generally smooth decision bound is calculated, enabling the implementation of the simplest possible form of SVM kernel: the Linear Function.
 Acknowledgments
This paper is part of the 03ED_78 research project, implemen-ted within the framework of the  X  X  X einforcement Programme of Human Research Manpower X  X  (PENED) and co-financed by National and Community Funds (25% from the Greek Ministry of Development  X  General Secretariat of Research and Technology and 75% from E.U.  X  European Social Fund).
 References
