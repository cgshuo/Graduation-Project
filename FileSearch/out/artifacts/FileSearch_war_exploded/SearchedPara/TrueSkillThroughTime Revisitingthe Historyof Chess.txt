 Comp etitiv e games and sports can bene t from statistical skill ratings for use in matc h-making as well as for pro viding criteria for the admission to tournamen ts. From a historical persp ectiv e, skill ratings also pro vide information about the general dev elopmen t of skill within the discipline or for a particular group of interest. Also, they can give a fascinating narrativ e about the key players in a given discipline, allo wing a glimpse at their rise and fall or their struggle against their con temp oraries.
 In order to pro vide good estimates of the curren t skill level of players skill rating systems have traditionally been designed as lters that com bine a new game outcome with kno wledge about a player's skill from the past to obtain a new estimate. In con trast, when taking a historical view we would like to infer the skill of a player at a given point in the past when both their past as well as their future achiev emen ts are kno wn.
 The best kno wn suc h skill lter based rating system is the Elo system [3] dev elop ed by Arpad Elo in 1959 and adopted by the World Chess Federation FIDE in 1970 [4]. Elo mo dels the probabilit y of the game outcome as P (1 wins over 2 j s 1 ; s 2 ) := s 1 s 2 p are the skill ratings of eac h player, denotes the cum ulativ e densit y of a zero-mean unit-variance Gaussian and is the assumed variabilit y of performance around skill. Denote the game outcomes by y = +1 if player 1 wins, y = 1 if player 2 wins and y = 0 if a dra w occurs. Then the resulting (linearised) Elo update is given by s 1 s 1 + y , s 2 s 2 y and where 0 &lt; &lt; 1 determines how much the lter weighs the new evidence versus the old estimate.
 The TrueSkill rating system [6] impro ves on the Elo system in a num ber of ways. TrueSkill's curren t belief about a player's skill is represen ted by a Gaussian distribution with mean and variance 2 . As a consequence, TrueSkill does not require a pro visional rating perio d and con verges to the true skills of players very quic kly. Also, in con trast to Elo, TrueSkill explicitly mo dels the probabilit y of dra ws. Crucially for its application in the Xbox Liv e online gaming system (see [6] for details) it can also infer skills from games with more than two participating entities and infers individual players' skills from the outcomes of team games.
 As a skill rating and matc hmaking system TrueSkill operates as a lter as discussed above. However, due to its fully probabilistic form ulation it is possible to extend Trueskill to perform smo othing on a time series of player skills. In this pap er we extend TrueSkill to pro vide accurate estimates of the past skill levels of players at any point in time taking into accoun t both their past and their future achiev emen ts. We carry out a large-scale analysis of about 3.5 million games of chess played over the last 150 years.
 The pap er is structured as follo ws. In Section 2 we review previous work on historical chess ratings. In Section 3 we presen t two mo dels for historical ratings through time, one assuming a xed dra w margin and one estimating the dra w margin per player per year. We indicate how large scale appro ximate message passing (EP) can be used to ecien tly perform inference in these huge mo dels. In Section 4 we presen t exp erimen tal results on a huge data set from ChessBase with over 3.5 million games and gain some fascinating chess speci c insigh ts from the data. Estimating players' skills in retrosp ectiv e allo ws one to tak e into accoun t more information and hence can be exp ected to lead to more precise estimates. The pioneer in this eld was Arpad Elo himself, when he encoun tered the necessit y of initializing the skill values of the Elo system when it was rst deplo yed. To that end he tted a smo oth curv e to skill estimates from ve-year perio ds; however little is kno wn about the details of his metho d [3]. Probably best kno wn in the chess comm unit y is the Chessmetrics system [8], whic h aims at impro ving the Elo scores by attempting to obtain a better t with the observ ed data. Although constructed in a very though tful manner, Chessmetrics is not a statistically well-founded metho d and is a ltering algorithm that disregards information from future games. The rst approac h to the historical rating problem with a solid statistical foundation was dev elop ed by Mark Glic kman, chairman of the USCF Rating Committee. Glic ko 1 &amp; 2 [5] are Bayesian rating systems that address a num ber of dra wbac ks of the Elo system while still being based on the Bradley-T erry paired-comparison metho d [1] used by mo dern Elo. Glic kman mo dels skills as Gaussian variables whose variances indicate the reliabilit y of the skill estimate, an idea later adopted in the TrueSkill mo del as well. Glic ko 2 adds volatilit y measures, indicating the degree of exp ected uctuation in a player's rating. After an initial estimate past estimations are smo othed by propagating information bac k in time. The second statistically well founded approac h are Rod Edw ards's Edo Historical Chess Ratings [2], whic h are also based on the Bradley-T erry mo del but have been applied only to historical games from the 19th cen tury . In order to mo del skill dynamics Edw ards considers the same player at di eren t times as sev eral distinct players, whose skills are link ed together by a set of virtual games whic h are assumed to end in dra ws. While Edo incorp orates a dynamics mo del via virtual games and returns uncertain ty measures in terms of the esti-mator's variance it is not a full Bayesian mo del and pro vides neither posterior distributions over skills, nor does it explicitly mo del dra ws.
 In ligh t of the above previous work on historical chess ratings the goal of this pap er is to introduce a fully probabilistic mo del of chess ratings through time whic h explicitly accoun ts for dra ws and pro vides posterior distributions of skills that re ect the reliabilit y of the estimate at every point in time. This pap er strongly builds on the original TrueSkill pap er [6]. Although TrueSkill is appli-cable to the case of multiple team games, we will only consider the two player case for this application to chess. It should be clear, however, that the metho ds presen ted can equally well be used for games with any num ber of teams comp eting.
 over a perio d of T time steps, say, years. Denote the series of game outcomes between two of game outcomes available for that pair of players in that year. Furthermore, let y = +1 if player i wins, y = 1 if player j wins and y = 0 in case of a dra w. 3.1 Vanilla TrueSkill In the Vanilla TrueSkill system, eac h player i is assumed to have an unkno wn skill i 2 R at time t . We assume that a game outcome y t ij ( k ) is generated as follo ws. For eac h of the two players i and j performances p t ij ( k ) and p t ji ( k ) are dra wn according to j is then determined as where the parameter " &gt; 0 is the dra w margin. In order to infer the unkno wn skills s t i the TrueSkill mo del assumes a factorising Gaussian prior p s 0 i = N s 0 i ; 0 ; 2 0 over skills and a can be well describ ed as a factor graph (see Figure 1, left) whic h clari es the factorisation assumptions of the mo del and allo ws to dev elop ecien t (appro ximate) inference algorithms based on message passing (for details see [6]) In the Vanilla TrueSkill algorithm denoting the winning player by W and the losing player by L and dropping the time index for now, appro ximate Bayesian inference (Gaussian densit y ltering [7]) leads to the follo wing update equations for W , L , W and L .
 The overall variance is c 2 ij = 2 2 + 2 W + 2 L and the two functions v and w are given by For the case of a dra w we have the follo wing update equations: and similarly for player j . De ning d := t and s := + t then ~ v and ~ w are given by ~ v ( t; ) := times t 2f 0 ; : : : ; T g the Vanilla TrueSkill algorithm initialises eac h skill belief with 0 i 0 and 0 i 0 . It then pro ceeds through the years t 2 f 1 : : : T g in order, goes through the game outcomes y t ij ( k ) in random order and updates the skill beliefs according to the equations above. 3.2 TrueSkill through Time (TTT) The Vanilla TrueSkill algorithm su ers from two ma jor disadv antages: Both problems can be addressed by extending the Gaussian densit y ltering to running full exp ectation propagation (EP) until con vergence [7]. The basic idea is to update rep eatedly on the same game outcomes but making sure that the e ect of the previous update on that game outcome is remo ved before the new e ect is added. This way, the mo del remains the same but the inferences are less appro ximate.
 More speci cally , we go through the game outcomes y t ij within a year t sev eral times until con vergence. The update for a game outcome y t ij ( k ) is performed in the same way as before but saving the upward messages m f ( p t performance p t ij ( k ) on the underlying skill s t i . When game outcome y t ij ( k ) comes up for update again, the new downward message m f ( p t thus e ectiv ely dividing out the earlier upward message to avoid double coun ting. The integral above is easily evaluated since the messages as well as the marginals p ( s t i ) have been assumed Gaussian. The new downward message serv es as the e ectiv e prior belief on the performance p t i ( k ). At con vergence, the dep endency of the inferred skills on the order of game outcomes vanishes.
 The second problem is addressed by performing inference for TrueSkill through time (TTT), i.e. by rep eatedly smo othing forw ard and bac kward in time. The rst forw ard pass of TTT is iden tical to the inference pass of Vanilla TrueSkill except that the forw ard messages m t 1 on skill estimate s t i at time t . In the bac kward pass, these messages are then used to calculate the new bac kward messages m f ( s t 1 new prior for time step t 1, This pro cedure is rep eated forw ard and bac kward along the time series of skills until con-vergence. The bac kward passes mak e it possible to propagate information from the future into the past. Figure 1: Factor graphs of single game outcomes for TTT (left) and TTT-D. In the left graph there are three types of variables: skills s , performances p , performance di erences d . In the TTT-D graphs there are two additional types: dra w margins " and winning thresholds u: The graphs only require three di eren t types of factors: factor tak es the form N ; ; 2 , factor &gt; 0 tak es the form I ( &gt; 0) and factor tak es the form I ( = ). 3.3 TTT with Individual Draw Margins (TTT-D) From exploring the data it is kno wn that the probabilit y of dra w not only increases mark edly through the history of chess, but is also positiv ely correlated with playing skill and even varies considerably across individual players. We would thus like to extend the TrueSkill mo del to incorp orate another player-sp eci c parameter whic h indicates a player's abilit y to force a dra w. Supp ose eac h player i at every time-step t is characterised by an unkno wn skill ij ( k ) between players i and j at time t is generated as follo ws: In addition to the Gaussian assumption about player skills as in the Vanilla TrueSkill mo del of Section 3.1 we assume a factorising Gaussian distribution for the player-sp eci c dra w margins p " 0 i = N " 0 i ; 0 ; &amp; 2 0 and a Gaussian drift of dra w margins between time steps in Figure 1 (cen tre) and for the case of a dra w in Figure 1 (righ t). Note, that the positivit y of the player-sp eci c dra w margins at eac h time step t is enforced by a factor &gt; 0 . Inference in the TTT-D mo del is again performed by exp ectation propagation, both within a given year t as well as across years in a forw ard bac kward manner. Note that in this mo del the curren t belief about the skill of a player is represen ted by four num bers: t i and of t i can be though t of as having the abilit y to achiev e a dra w against strong players, while players with a high value of t i have the abilit y to achiev e a win. Figure 2: (Left) Distribution over num ber of recorded matc h outcomes played per year in the ChessBase database. (Righ t) The log-evidence P ( y j ; ) for the TTT mo del as a function of the variation of player performance, , and skill dynamics, . The maximizing parameter settings are indicated by a blac k dot. Our exp erimen ts are based on a data-set of chess matc h outcomes collected by ChessBase 1 . This database is the largest top-class annotated database in the world and covers more than 3.5 million chess games from 1560 to 2006 played between 200,000 unique players. From this database, we selected all the matc hes between 1850 (the birth of mo dern Chess) and 2006. This results in 3,505,366 games between 206,059 unique players. Note that a large prop ortion of games was collected between 1987 and 2006 (see Figure 2 (left)).
 Our implemen tation of the TrueSkill through Time algorithms was done in F# 2 and builds a factor graph with appro ximately 11,700,000 variables and 15,200,000 factors (TTT) or 18,500,000 variables and 27,600,000 factors (TTT-D). The whole schedule allo cates no more than 6 GB (TTT) or 11 GB (TTT-D) and con verges in less than 10 min utes (TTT)/20 min utes (TTT-D) of CPU time on a standard Pentium 4 mac hine. The code for this analysis will be made publicly available.
 In the rst exp erimen t, we built the TTT mo del for the above men tioned collection of Chess games. The dra w margin was chosen suc h that the a-priori probabilit y of dra w between two equally skilled players matc hes the overall dra w probabilit y of 30.3%. Moreo ver, the mo del has a translational invariance in the skills and a scale invariance in = 0 and = 0 . Thus, we xed 0 = 1200, 0 = 400 and computed the log-evidence L := P ( y j ; ) for varying values of and (see Figure 2 (righ t)). The plots sho w that the mo del is very robust to setting these two parameters except if is chosen too small. Interestingly , the log-evidence is neither largest for 0 (complete de-coupling) nor for ! 0 (constan t skill over life-time) indicating that it is imp ortan t to mo del the dynamics of Chess players. Note that the log-evidence is L TTT = 3 ; 953 ; 997, larger than that of the naiv e mo del ( L naive = 4 ; 228 ; 005) whic h alw ays predicts 30 : 3% for a dra w and corresp ondingly for win/loss 3 . In a second exp erimen t, we picked the optimal values ( ; ) = (480 ; 60) for TTT and optimised the remaining prior and dynamics parameters of TTT-D to arriv e at a mo del with a log-evidence of L TTT D = 3 ; 661 ; 813.
 In Figure 3 we have plotted the skill evolution for some well{kno wn players of the last 150 years when tting the TTT mo del ( t ; t are sho wn). In Figure 4 the skill evolution of the same players is plotted when tting the TTT-D mo del; the dashed lines sho w t + " t whereas the solid lines displa y t ; for comparisons we added the t of the TTT mo del as dotted lines.
 As a rst observ ation, the uncertain ties alw ays gro w towards the beginning and end of a career since they are not constrained by past/future years. In fact, for Bobby Fischer the uncertain ty gro ws very large in his 20 years of inactivit y (1972{1992). Moreo ver, there seems to be a noticeable increase in overall skill since the 1980's. Looking at Figure 4 we see that players have di eren t abilities to force a dra w; the strongest player to do so is Boris Spassky (1937{). This abilit y got stronger after 1975 whic h explains why the mo del with a xed dra w margin estimates Spassky's skill larger.
 Looking at individual players we see that Paul Morphy (1837{1884), \The Pride and Sorro w of Chess", is particularly strong when comparing his skill to those of his con temp oraries in the next 80 years. He is considered to have been the greatest chess master of his time, and this is well supp orted by our analysis. \Bobby" Fischer (1943{) tied with Boris Spassky at the age of 17 and later defeated Spassky in the \Matc h of the Cen tury" in 1972. Again, this is well supp orted by our mo del. Note how the uncertain ty gro ws during the 20 years of inactivit y (1972{1992) but starts to shrink again in ligh t of the (future) re-matc h of Spassky and Fisc her in 1992 (whic h Fisc her won). Also, Fisc her is the only one of these players whose " t decreased over time|when he was activ e, he was kno wn for the large margin by whic h he won! Finally , Garry Kasp arov (1963{) is considered the strongest Chess player of all time. This is well supp orted by our analysis. In fact, based on our analysis Kasparo v is still considerably stronger than Vladimir Kramnik (1975{) but a con tender for the crown of strongest player in the world is Viswanathan Anand (1969{), a former FIDE world champion. We have extended the Bayesian rating system TrueSkill to pro vide player ratings through time on a uni ed scale. In addition, we introduced a new mo del that trac ks player-sp eci c dra w margins and thus mo dels the game outcomes even more precisely . The resulting factor graph mo del for our large ChessBase database of game outcomes has 18.5 million nodes and 27.6 million factors, thus constituting one of the largest non-trivial Bayesian mo dels ever tackled. Full appro ximate inference tak es a mere 20 min utes in our F# implemen tation and thus demonstrates the eciency of EP in appropriately structured factor graphs.
 One of the key questions pro voked by this work concerns the comparabilit y of skill estimates across di eren t eras of chess history . Can we directly compare Fisc her's rating in 1972 with Kasparo v's in 1991? Edw ards [2] points out that we would not be able to detect any skill impro vemen t if two players of equal skill were to learn about a skill-impro ving breakthrough in chess theory at the same time but would only play against eac h other. However, this argumen t does not rule out the possibilit y that with more players and chess kno wledge owing less perfectly the impro vemen t may be detectable. After all, we do see a mark ed impro vemen t in the average skill of the top players.
 In future work, we would like to address the issue of skill calibration across years further, e.g., by introducing a laten t variable for eac h year that serv es as the prior for new players joining the pool. Also, it would be interesting to mo del the e ect of playing white rather than blac k.

