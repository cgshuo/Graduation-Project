 1. Introduction
Fuzzy systems are very effective in modeling and control of complex nonlinear systems whose complete mathematical mod-els are not available. It is a very well-known fact that fuzzy models can smoothly integrate a priori knowledge with informa-tion obtained from process data ( Babuska, 1998 ; Abonyi, 2003 ; processes are characterized by uncertainties and nonlinearities, various fuzzy modeling and control strategies have been success-fully implemented in many problems ( Eksin et al., 2001 ; Babuska et al., 2009 ).

The concept of type-2 fuzzy sets is an extension and general-by Zadeh (1975) . Fuzzy logic systems that are described with at least one type-2 fuzzy set are called type-2 fuzzy logic systems are more suitable in circumstances where it is difficult to determine the accurate membership function for a fuzzy set also been shown that type-2 fuzzy sets are much more powerful to handle uncertainties and nonlinearities directly ( Liang and
Mendel, 2000 ; Hagras, 2007 ). The major problem with type-2 fuzzy logic system is that the computations are much more complicated compared to type-1 fuzzy logic systems. Therefore,
Liang and Mendel (2000) and Mendel (2000) proposed a special the output of interval type-2 fuzzy sets is uncertain within an be used for real time application purposes, a type-reduction mechanism which maps the type-2 fuzzy set into a type-1 fuzzy set is needed and afterwards routine defuzzification procedure is accomplished ( Liang and Mendel, 2000 ; Wu and Mendel, 2002 ; Wu and Tan, 2006a ).

The interval type-2 fuzzy logic systems have been successfully implemented in controller design. The beneficial sides of type-2 fuzzy controllers have been demonstrated in several control applications such as liquid-level process control ( Wu and Tan, 2004 ; Wu and Tan, 2006b ); autonomous mobile robots ( Martinez systems have been generalized to type-2 fuzzy systems ( Kheireddine et al., 2007 ; Lin et al., 2009 ). Furthermore, Lin (2010) introduced a state observer based indirect adaptive inter-et al. (2009) suggested type-2 fuzzy model based model predic-tive control structures.

In the fuzzy logic literature, there exist various ordinary fuzzy model inversion methods. Different type-1 fuzzy model inversion techniques for certain fuzzy models have been suggested that can that the exact inverse of a fuzzy model can be obtained under some certain invertibility conditions. In addition, in Babuska (1998) the inverse Takagi X  X ugeno fuzzy model controller has been obtained through the principle of rule-by-rule inversion by permutation of the antecedent and consequence parts. Moreover, Boukezzoula et al. (2003) and Boukezzoula et al. (2007) proposed an inversion method in which the fuzzy model is decomposed into fuzzy meshes and the inverse of the global fuzzy system is obtained through inversion of each fuzzy mesh. In Abonyi et al. (1999 ), the inverse model is obtained directly through mapping Furthermore, iterative fuzzy model inversion methods are also proposed by researchers which do not require any invertibility et al., 2008b ).
 In this study, an inversion method for interval type-2 Takagi X  Sugeno fuzzy logic system has been proposed. The inverse type-2 interval TS fuzzy model has been obtained through the principle of rule-by-rule inversion by permutation of the antecedent and consequence parts. The calculations are simple and straightfor-ward. The proposed methodology is a generalization of the type-1 TS fuzzy model inversion proposed by Babuska (1998) .Itis important to note here that the developed inversion strategy is based on a pure analytic method. However, the proposed method is still restricted to SISO processes.

Internal Model Control (IMC) is one of the mostly used control strategy in process control area because of simplicity in design and disturbance rejection properties ( Garcia and Morari, 1982 ). strategies have been developed to design PID controllers based on internal model control principle has been extended to design other approaches for nonlinear systems ( Economou et al., 1986 ). In this context, several Nonlinear Internal Model Control (NIMC) schemes have been proposed since it is robust against distur-bances and model mismatches ( Economou et al., 1986 ; Brown In the NIMC scheme, the most difficult task is to find a process model which will represent the nonlinear and/or uncertain systems especially for practical chemical processes. Economou et al. (1986) have demonstrated that the main controller can directly be obtained by model inversion in their scheme. How-of the nonlinear model may not be obtained analytically. The inversion of nonlinear models is generally obtained by numerical methods in spite of fact that sufficient and necessary conditions this problem, researchers proposed NIMC structures where the main controller design is based on type-1 fuzzy model inversion et al., 2010 )
Finally, in this study, the proposed type-2 TS fuzzy model inverse controller is embedded into the nonlinear internal model control structure and Type-2 Fuzzy Inverse Nonlinear Internal Model Controller (T2-FI-NIMC) structure has been developed. If the inverse type-2 fuzzy model is calculated exactly then an offset-free control performance is guaranteed since the type-2 fuzzy models are powerful tools in representing highly nonlinear and uncertain processes. Moreover, the model mismatches and disturbances will be compensated due to the nonlinear internal model control structure.

The effectiveness of the proposed method is demonstrated on a pH neutralization experimental set-up which exhibits a highly nonlinear characteristic. The performance of the proposed method T2-FI-NIMC is compared with the type-1 TS Fuzzy Inverse
Internal Model Controller (T1-FI-NIMC) structure where the main controller is constructed based on the TS fuzzy model inversion method developed by Babuska (1998 ). It has been illustrated that the proposed T2-FI-NIMC scheme ameliorates the overall perfor-mance of the process much better in every sense compared to the T1-FI-NIMC.

This paper is organized in five sections excluding the conclu-sion section. In Section 1, the type-2 fuzzy model structure is method for type-1 TS fuzzy logic systems is generalized to type-2 fuzzy logic systems and the newly obtained Type-2 fuzzy model the newly proposed T2-FIC is embedded into the nonlinear internal model control structure and Type-2 Fuzzy Inverse Non-linear Internal Model Controller (T2-FI-NIMC) structure is intro-duced. The description of pH neutralization process (G.U.N.T pH value Control Trainer RT-552) is briefly given in Section 4. In
Section 5, the type-1 and type-2 fuzzy modeling approaches and the comparative performances of these models are given and discussed. Next, the T1-FI-NIMC and the proposed T2-FI-NIMC control schemes have been implemented and tested on the pH neutralization process experimentally. Finally, the servo and disturbance rejection performances of the T1-FI-NIMC and the
T2-FI-NIMC structures have been compared based on the same pH neutralization process within this section. The results have been evaluated and discussed in the conclusion section. 2. Type-2 fuzzy model structure
Type-2 fuzzy sets are generalized forms of those of type-1 fuzzy sets ( Zadeh, 1975 ). Mathematically, type-2 fuzzy sets are not easy to describe like type-1 fuzzy sets. A type-2 fuzzy set, denoted as e A , is characterized by a type-2 membership function e  X  x , u  X  , where x A X and u A J x D [0,1], i.e.: e A  X f X  X  x , u  X  , m e in which 0 r m e can be expressed as e A  X  where to as the primary membership of x , and m e set known as the secondary set. The uncertainty in the primary membership of a type-2 fuzzy set e A is defined by a region named footprint of uncertainty (FOU) which is also the union of all primary memberships. When m e interval type-2 fuzzy set is obtained. An example of a Gaussian an upper membership function m e function m e membership functions are named as s and s , respectively. A gaussian type-2 membership function with fixed center and uncertain distribution can be expressed as e
The primary membership J x is also given in Fig. 1 , and its associated possible secondary memberships, that are Gaussian and interval, are presented in Fig. 2 a and b, respectively. When the interval secondary membership function that is illustrated in 2000 ).

A fuzzy logic system described with at least one type-2 fuzzy
Similar to a type-1 FLS, a type-2 FLS includes type-2 fuzzifier, output processor which consists of type reduction and defuzzifi-cation mechanisms.

A T2FLS is characterized by IF X  X HEN rules where its ante-cedent and/or consequent fuzzy sets are defined by type-2 fuzzy reducer which combines the output sets and then perform type-type-reduced set. The defuzzifier can then defuzzify the type-reduced type-1 fuzzy outputs to produce crisp outputs ( Mendel, 2000 ).

A type-2 fuzzy rule can be defined as following: r :IF x 1 is e A 1 and x 2 is e A 2 and ... and x n is e A n THEN z is y j  X  f p 0 j  X  f p 1 j x 1  X  f p 2 j x 2  X  X  f p e
A , e
A , ... , e A n are type-2 fuzzy sets on the universe of discourses x , x the total number of rules e m e m ^ e m ties of the antecedents X  consequent set. The total firing set f each rule is given by f j  X  m f j  X  m 1  X  x 1  X \ m 2  X  x 2  X \\ m n  X  x n  X  X  6  X 
The consequent y j of the rule f j is also an interval set y  X  X  y j l , y j r  X  7  X  Then, e y  X  X  y l , y r becomes the extended output of the Type-2
Takagi X  X ugeno Fuzzy Logic System (T2-TS-FLS). It inherits the uncertainty of the output of T2-TS-FLS due to antecedent or consequent parameter uncertainties. In this study, the center-of sets type reduction proposed by Karnik et al. (1999) , which is used most commonly for type reduction/defuzzification, is used.
In this method, y l and y r are calculated iteratively and as the
Defining y  X  R  X  r and y  X  L  X  l , for 0 r L , R r N ,as y  X  P y  X 
Then, y 1  X  x  X  is the minimum of all y  X  L  X  l  X  x  X  , and y of all y  X  R  X  r  X  x  X  , i.e. y  X  x  X  X  min where
L  X  x  X  X  arg min and y  X  x  X  X  max 0 0 1 where R  X  x  X  X  arg max The iterative Karnik and Mendel algorithm is used to obtain the crisp output of T2-TS-FLS is calculated using (14) y  X  y r  X  y l 2  X  14  X  3. Interval type-2 Takagi X  X ugeno fuzzy model inversion
Let us consider a fuzzy logic system without time delay, characterized with a state vector x ( k ). The fuzzy model can be expressed as x  X  k  X  1  X  X  f  X  x  X  k  X  , u  X  k  X  X   X  15  X  sampling time will eventually become equal to the desired reference signal denoted as s des ( k  X  1). This objective can be formally stated as follows: u  X  k  X  X  f 1  X  x  X  k  X  , s des  X  k  X  1  X  X   X  16  X  Generally, it is difficult, to find inverse fuzzy function in an analytical form, only some special forms can be calculated such linearization of type-1 TS fuzzy model is performed so as to simple calculations for type-1 TS fuzzy model. This inversion strategy is based on simple manipulation of the antecedent and consequence parts of the fuzzy model.

This simple and straightforward methodology can be general-ized to the inversion of interval type-2 TS fuzzy models. In this is available and its rules are given as r :IF y  X  k  X  is e A 1 and y  X  k 1  X  is e A 2 and ... and y  X  k n and u  X  k n d  X  1  X  is e B 1 and ... u  X  k n d n u  X  2  X  is
THEN y j  X  k  X  1  X  is w j  X  f p 0 j  X  f p 1 j x  X  k  X  X  f p past inputs.

For the sake of simplicity, it is assumed that n y  X  n u  X  N and n  X  1 (assuming no transport delay). Thus, the defined fuzzy sets could then be represented as one multi-dimensional state type-2 fuzzy set e X  X  e A 1 e A N e B 1 e B N . Substituting e B for , the rule base structure can then be redefined as follows: r : IF x  X  k  X  is e X and u  X  k  X  is e B , THEN y  X  k  X  1  X  is w Therefore, the type-2 fuzzy model output y ( k  X  1) can be calcu-lated as the weighted average of the linear consequents in the individual rules: y  X  k  X  1  X  X  represented as the following uncertain linear time invariant discrete model: y  X  k  X  1  X  X  f p 0  X  f p 1 x  X  k  X  X  f p 2 u  X  k  X  X  20  X  relations: f p  X  f p sets possess upper and lower bounds (e.g. f p 0  X  p 0 p 0
Consequently, (20) can be reformulated for left and right values of the type-2 fuzzy model as follows: y  X  k  X  1  X  X  p 0  X  p 1 x  X  k  X  X  p 2 u r  X  k  X  X  22  X  y  X  k  X  1  X  X  p 0  X  p 1 x  X  k  X  X  p 2 u l  X  k  X  X  23  X  sampling time then naturally (16) can be stated as u  X  k  X  X  f 1  X  x  X  k  X  , s des  X  k  X  1  X  X   X  24  X  u  X  k  X  X  f 1  X  x  X  k  X  , s des  X  k  X  1  X  X   X  25  X 
Thus, the inverse type-2 TS fuzzy model law can be formulated as u  X  k  X  X  X  s des  X  k  X  1  X  p 0 p 1 x  X  k  X  X  = p 2  X  26  X  u  X  k  X  X  X  s des  X  k  X  1  X  p 0 p 1 x  X  k  X  X  = p 2  X  27  X 
Thus, the crisp output of inverse interval TS-T2FLS is u  X  k  X  X  u l  X  k  X  X  u r  X  k  X  2  X  28  X 
If there exists any time delay in the system then the method should be applied after n d steps of prediction have been per-formed, similar to what has to be done for the case of the type-1 TS fuzzy model inversion ( Babuska, 1998 ).

The proposed interva l type-2 fuzzy model inv ersion algorithm is presented in Table 1 . The inversion method has been embedded in 3.1. Illustrative example
To illustrate the effectiveness of the proposed inversion method, a simple example with two input and one output interval type-2 Takagi X  X ugeno fuzzy model is presented. The inputs are represented by three Gaussian shape type-2 membership func-type-2 linear function sets. The consequent parameters f p , f in Table 2 .

Since the inputs and outputs are defined with type-2 fuzzy sets; this is the most general type-2 Takagi X  X ugeno fuzzy system ( Mendel, 2000 ). The rule base of the model consists of three
Takagi X  X ugeno type rules as following: r tested whether it can force the system output to the desired
Two different reference signals have been applied, a sinusoidal within the interval [ 2, 2] ( s des 2 ).

The tracking error between the fuzzy model output and amplitude of the error is around 10 6 for s des 1 and 10 3 4. Type-2 fuzzy model based internal model control design
The simplest interpretation of a control problem is to determine ( Economou et al., 1986 ). Here, the inverse controller is formed
Since the type-2 fuzzy models are more powerful to represent process dynamics compared to type-1 fuzzy models, an inverse type-2 model based controller should naturally provide a more effective control performance than type-1 inverse controller. In Section 3, it has been illustrated that the type-2 fuzzy model
Membership Grade -5 0 5 0 0.2 0.4 0.6 0.8 1 type-2 fuzzy model matches the process perfectly, then one could assume that the process output would converge to the desired set point.

Even though inverse model controllers may produce perfect control while operating in an open loop fashion, this open loop control would not be sufficient in the case of modeling mis-matches or disturbances. Thus, the control of a nonlinear process within a nonlinear internal model control (NIMC) structure, which is illustrated in Fig. 8 is implemented to provide an effective control performance ( Economou et al., 1986 ). The main advantage of this scheme is that the inverse fuzzy model controller has been obtained through simple calculations. If the fuzzy model is a perfect model-match of the process then the NIMC structure is equivalent to an open-loop control configura-tion. In case of disturbances and model mismatches, the NIMC the proposed scheme guarantees offset-free performances ( Economou et al., 1986 ). Moreover, a robustness filter in the The robustness filter is chosen as follows: R  X  s  X  X  1 T 5. Application to a pH neutralization process 5.1. The G.U.N.T. pH value control trainer RT 552
The control of pH in a continuous stirred tank reactors (CSTR) the pH process inherits severe nonlinearities, uncertainties and time varying behavior, it is a benchmark process to evaluate control performances. The experimental apparatus considered in this study is the pH Value Control Trainer RT 552, which is illustrated in Fig. 9 . This process has two input streams, one constant at its nominal value while the base flow rate is cess can be described as the sodium hydroxide stream as input ( F ) and the pH (pH 2 ) as output. The operating conditions and the parameters of the neutralization process are given in Table 3 . 5.2. Fuzzy modeling
Since both the T1FMIC and T2FMIC strategies are model based, an identification experiment is applied to G.U.N.T. RT-552 to obtain fuzzy models. For that purpose, a multi-signal (three random signal generators with different frequencies and ampli-both the type-1 and type-2 fuzzy model is constructed by identification of the fuzzy models is handled as an optimization problem. The learning procedure is accomplished in two stages. In the forward pass, the antecedent parameters are fixed while the consequent parameters are adjusted via the recursive least square (RLS) algorithm. In the backward pass, this time the consequent parameters are fixed, and the antecedent parameters of the membership functions are determined via the Big Bang Big of the type-1 TS fuzzy model (T1FM) is accomplished based on model (T2FM) has been accomplished as an extension of type-1
FLS and here the same optimal results used for the type-1 fuzzy model are chosen as initial conditions in order to reduce the complexity and to be fair ( Kumbasar et al., in review ).
In order to map the nonlinearities of the process better, the antecedent membership functions of the type-1 fuzzy rules are defined with seven Gaussian combinational membership func-tions (Gauss2mf) and the consequent parts are defined with seven type-2 fuzzy model are represented by seven type-2 Gaussian combinational membership functions, and the consequent parts are defined with seven linear functions with interval parameters to match the nonlinearities of the process enhanced ( Kumbasar et al., in review ). A uniform random test signal is applied for validation purposes of the type-1 and type-2 fuzzy models obtained. Two performance indices are used to provide a quanti-tative measure of the model accuracy of the obtained models; namely, root mean square error (RMSE) and the variance calculated performances values for the T2FM are RMSE  X  0.2634 and VAF  X  94.5942 while the T1FM has correspondingly
RMSE  X  0.5998 and VAF  X  83.0993 on the same data set ( Kumbasar et al., in review ). Thus, it can be concluded that
T2FM is superior to T1FM in the case of uncertainties and strong nonlinearities are present. Moreover, it has been illustrated in
Fig. 10 that the T2FM represents the nonlinear neutralization process much better than the type-1 fuzzy model. 5.3. Performance comparison of the inverse fuzzy controllers
The effectiveness and the superio rity of the proposed T2-FI-NIMC method over the T1-FI-NIMC is tried to be shown on the real time some empirical tryouts for both th eT1-FI-NIMCandtheT2-FI-NIMC schemes, two performance measures are considered as follows: i) Integral of time squared error (ITSE), which is defined as ITSE  X  which is defined as TV  X 
Since the major difficulty of controlling pH neutralization pro-cesses is the nonlinear S-shaped pH titration curve, a servo performance of the T1-FI-NIMC and T2-FI-NIMC structures have been compared. The desired reference trajectories have been chosen as 6, 8, and 7 pH values, respectively. It has been illustrated in Fig. 11 that the T2-FI-NIMC scheme provides better transient state performances than the T1-FI-NIMC scheme under varying set points. Moreover, the ITSE value of T2-FI-NIMC structure is less then T1-FI-NIMC controller structure, as it can value of TV that shows that it has the smoothest control signal. Secondly, the disturbance rejection performance of the T2-FI-
NIMC and T1-FI-NIMC scheme has been examined. First of all, a reference signal of  X  X 7 pH X  X  has been applied. After the process converged to the set point value, a unit step output disturbance proposed T2-FI-NIMC structure compensated very effectively the output disturbance in a short period of time compared to the T1-
FI-NIMC structure. Moreover, the control signal of the T2-FI-NIMC scheme is smoother and therefore has a lower TV value. Also, the ITSE value is almost 46% better.

Moreover, since the main drawback of type-2 fuzzy models is computational time is examined for both the T1FMIC and T2FMIC.
The time needed for experiment r uns was measured and compared on a personal computer with an Intel Pentium Dual Core E7500 2.93 MHz processor, 2.99 GB RAM, and software package Matlab/
SIMULINK R2007A. For the servo performance study the total computational time of the T2FMIC is 0.3246 s while for T1FMIC it 5.384 ms for the T2FMIC and T1FMIC, respectively. This means almost 50% deceleration due to type reduction/defuzzification inference mechanism of T2FLS structure. Although the total compu-tational time of the T2FMIC is relatively big compared to the
T1FMIC X  X , it has been illustrated in the servo and disturbance rejection performance studies that T2FMIC scheme outperforms the T1FMIC scheme. 6. Conclusions
In this study, a systematic method has been presented to find or form the inverse model of interval type-2 Takagi X  X ugeno fuzzy
The inversion technique develop ed and generalized for a class of type-2 fuzzy systems consists of simple permutation of the ante-cedent and consequence parts based on a purely analytical
Time (s)
Time (s) Time (s) methodology. The effectiveness and the performance of the method interval type-2 Takagi X  X ugeno fuzzy system has been forced to follow certain desired reference signals in an open loop fashion.
Inspecting the tracking error values between the desired input concluded that almost exact inversion of interval type-2 Takagi X 
Sugeno fuzzy system has been accom plished. However, the pro-posed method is still restricted to SISO processes.

Moreover, a nonlinear internal model control strategy where the is proposed. In case there is no disturbance and no parameter exactly. The developed fuzzy control strategy can potentially be ogy has been implemented on an experimental pH neutralization process setup and the effectiven ess of the proposed T2-FI-NIMC method has been shown by comparing the results obtained via the transient response performances of both methods are investigated under the reference set point of 6, 8, and 7 pH values in this successive order. The T2-FI-NIMC method provides lower ITSE and
TV values compared to the T1-FI-NIMC method. Thus, the transient performance of the T2-FI-NIMC method is much better than the T1-FI-NIMC method while it produces a smoother control signal. has been examined and it has been observed that the proposed T2-
FI-NIMC method has compensated the output disturbance very effectively in a short period of time compared to the
T1-FI-NIMC method. On the other hand, the total computational caused because of the type reduction/defuzzification inference of T2FLS structure. However, the results of the real time control applications demonstrated that the T2FMIC is superior to T1FMIC for the pH experimental set-up and the average computational time the real time application of the proposed inverse controller is feasible.
 References 6.5 7.5 pH 20 40 60 80 100 Control Signal
