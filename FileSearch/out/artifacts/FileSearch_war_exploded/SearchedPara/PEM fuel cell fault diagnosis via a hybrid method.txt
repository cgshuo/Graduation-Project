 1. Introduction
Polymer electrolyte membrane (PEM) fuel cells are devices that allow the direct transformation of chemical energy (hydrogen) into is clean because the only by-products are water and heat. Moreover, than the main fossil alternatives. Amongst others, these advantages are behind the recent increase in scienti fi c production in the the last years. Potential applications are grouped into three cate-tial and electronic applications and automotive applications. agents ( Rajashekara, 2000 ). This means that fuel cells are signi fi cantly reduce pollution and man-made greenhouse gases.
With all, PEM fuel cells are complex and interrelated systems and, as stated in recent research efforts ( Feroldi, 2009 ), ef in control is crucial. Different control problems must be solved to obtain a correct operation of the system, i.e. control of the of the generated power, handling of heat and water and suitable hydrogen and air supply. Therefore, a set of auxiliary elements guarantee that the fuel cell works in an optimal way. For this reason, fuel cell systems are vulnerable to different set of faults that can imply its temporal or permanent damage. Fault diagnosis systems (FDS) become, therefore, fundamental in order to reduce as much as possible this vulnerability.

There has been intensive research activity in the fault diagnosis of fuel cell stack systems that includes quantitative as well as qualitative approaches. According to Aitouche et al. (2012) , fault diagnosis methods can be classi fi ed on two types: model-based and knowledge-based approaches. In model-based approaches a priori knowledge about the model of the process is assumed.
However, this information is not always available and the dynamic fuel cell model is characterized by multiple variables and a strong coupling with profound dynamics. Model-based approaches are primarily based on statistical techniques, fi rst order logic, control theory, mathematical modeling, and computer simulation et al., 2008a, 2008b; Wang et al., 2011; Zhang and Huang, 2011 ).
Knowledge-based approaches are based on the data available from the system to perform learning. Examples of knowledge-based approaches are signal processing, experimental methods and arti fi cial intelligence. There is a large amount of research done in the area of knowledge-based FDS for fuel cell stack systems, neural networks, and genetic programming ( Chavez-Ram X rez et al., 2010; Kamal et al., 2014; Liu and Wang, 2003; Nitsche et al., 2004; years, the demand has arisen to develop FDS that are more robust to uncertainty. In this context, fuzzy logic and hybrid fuzzy approaches appear to offer a good alternative to other qualitative interests.
 cell systems diagnosis, by proposing a Sugeno-type fuzzy model anode compartment and an important drying of the proton exchange membrane. The Sugeno model has been tuned using a genetic algorithm. The conclusions obtained state that the fuzzy diagnosis models help to improve the results. For instance, the authors point out that thanks to the fuzzy model only 150 s are needed to detect the accumulation of nitrogen and water in the anode component fault. Hissel et al. (2007) present a new approach to PEM diagnosis based on fuzzy k -means clustering.
The fuzzy clustering algorithm produces three clusters on the two dimension feature space, each one corresponding to a speci workers also proposed a Sugeno-type fuzzy model. In this case the goal was to model the polyelectrolyte membrane fuel cell by means of a set of fuzzy rules built based on physical principles.
Therefore, this research follows a model-based approach and it is not focused on fault diagnosis. Tao et al. use the adaptive neural-networks fuzzy infer system (ANFIS) to build the temperature model of PEM fuel cell which is used as the reference model of the control system, and adjusts the model parameters to control it online. Vural et al. also uses the ANFIS to model the PEM fuel cell under various operational conditions. The models obtained are able to predict fuel cell performance with a high accuracy in an easy, rapid and cost effective way. Becker and Karri also build predictive ANFIS models, in this case for hydrogen fl ow rate, electrolyzer system-ef fi ciency and stack-ef fi ciency. They found that these models are reliable predictive tools with an excellent and Karri research are focused on fault diagnosis.

Therefore, the number of works that can be found in the literature that propose fuzzy or hybrid fuzzy FDS for PEM fuel cells is quite low. This is the reason why we propose a FDS based on the Fuzzy Inductive Reasoning (FIR) methodology.

The main motivation of our research is to explore the added value of using a fuzzy knowledge-based approach as an alternative to other knowledge-based and model-based approaches, for cases in which the non-linear dynamics are insuf fi ciently known. The goal of this research is to allow a tolerant fuel cell control by means of the addition of a fuzzy fault diagnosis system operating in real-time. With this idea in mind, the VisualBlock-FIR FDS based on the Fuzzy Inductive Reasoning (FIR) methodology is presented in this work. The FIR methodology is based on a hybrid fuzzy pattern recognition approach and its conceptualization arises of the General System Problem Solving ( Klir and Elias, 2002 ). This methodology of modeling and qualitative simulation is based on systems behavior rather than structural knowledge. It has the ability to describe systems that cannot easily be described by physical processes are awkward to model.

The novelty of this work lies in using the FIR methodology to to detect and isolate the faults occurred as fast as possible.
Most of the inductive model identi fi cation techniques, such are neural networks and its hybridizations, assume a fi xed (although often arbitrary) structure and map the knowledge contained in the training data set onto a set of parameter values. The training data are only used during the model identi fi cation phase, i.e., the modeling phase. Once the model has been identi fi ed, simulation runs are based solely upon the previously optimized parameter values. Such techniques suffer from the problem that they nor-mally are unable to recognize, when the testing data lie outside the range, for which the model has been validated.

In contrast, FIR is a non-parametric technique. The training data are characterized and classi fi ed during the model identi phase, but they are not mapped onto parameter sets. Therefore, FIR refers back to the classi fi ed training data set also during the simulation or prediction phase. This property makes it impossible assessment capabilities that enable it to warn the user of the not well founded on the basis of the available training data.
To prove the usefulness and robustness of the proposed metho-dology, the PEM system simulator developed by Pukrushpan et al. results obtained by the VisualBlock-FIR methodology to the results achieved by the model-based fault d iagnosis methodology presented by Escobet et al. (2009) . It is important to mention that we have and identi fi cation of the faults is reported not only taking into account whether it is possible or n ot to detect and identify them; they also take into account the time needed to do it. We could not fi nd many papers that present the time needed by the proposed methodologies to detect and identify the faults of PEM fuel cells. The VisualBlock-FIR fault diagnosis methodology is introduced in Section 2 . Section 3 describes the PEM fuel cell system. Section 4 the results obtained. Section 5 presents the study of robustness of Nomenclature PEM polymer electrolyte membrane FDS fault diagnosis system ANFIS neural-networks fuzzy infer system FIR Fuzzy Inductive Reasoning
KNN k -nearest neighbor 5NN 5-nearest neighbor EFP equal frequency partition MSE mean square error LPV linear parameter varying Q acceptability measure C partial acceptability measure C rel relative con fi dence I a computing the maximum number of local cumulative 2 oxygen excess ratio o in oxygen input o react oxygen reacted I cm compressor current cm compressor speed V fc voltages applied to the cell I fc stack current V cm voltages applied to the compressor are outlined in Section 6 . 2. Fault diagnosis methodology
It is necessary to clarify here that the Fuzzy Inductive Reasoning (FIR) methodology is responsible for identifying models that repre-
On the other hand, the VisualBlock-FIR methodology is the FDS based on the FIR models previously mentioned.

A FDS aims to detect and identify the different faults that may occur in the system over time. VisualBlock-FIR performs these user can manage by means of a user-friendly framework. In the occurred, setting off an alarm in that case. In the identi fault module, the type of fault is identi fi ed. In the following sections the VisualBlock-FIR is described and, when necessary, the FIR modeling and prediction processes are also explained. 2.1. VisualBlock-FIR fault detection The fault detection process of VisualBlock-FIR is presented in diagnosis methods, a model allows checking the consistency between measured system output and its predicted behavior. If an proposed approach, the FIR methodology has been used for obtaining a qualitative behavioral model.

The data measured from the system is converted into qualitative triples (class, membership, and side) by means of the FIR fuzzi process. The class value represent s a coarse discretization of the original real-valued variable. Th e fuzzy membership value denotes thedegreeofbelongingofthedatatoafuzzyset.Finally,theside right of the peak value of the associated membership function. The commonly used in fuzzy logic, is responsible for preserving, in the qualitativetriple,thecompletek nowledge that had been contained by means of an example. A temperature of 23 1 C would hence be fuzzi fi ed into the class normal with a side value of right and a fuzzy membership value of 0.755. The determination of the number of genetic algorithms to learn the granularity (number of classes per computational time is quite large if this option is chosen.
The fuzzy forecasting processpredictsthenextqualitativeoutput value from the qualitative input data using the best FIR model identi fi ed, which represents the current behavior of the system. The process takes place. A FIR model is composed by a structure, called mask,andapatternrulebase,namedinput/outputmatrix.Amask tive variables. It is represented by a matrix where each column
Each row is delayed relative to its successor by a time interval of t representing the time lapse between two consecutive samplings. An u  X  respectively, and one m -output, O 1 ,associatedto y 1  X  t
The best mask is found by means of an optimization process that determines the most deterministic state transition matrix.
The optimality of the mask is evaluated with respect to the maximization of its forecasting power.

How can the one mask be found that, within the framework of all allowable masks, represents the most deterministic state transition matrix? This mask will optimize the predictiveness of the model. In the FIR methodology, the concept of a mask candidate matrix has been introduced. A mask candidate matrix is an ensemble of all possible masks, from which the best is chosen by a mechanism of exhaustive search. Another search strategy based on genetic algorithms has also been implemented.
The optimal mask function searches through all legal masks of complexity two, i.e., all masks with a single m -input, and best one; it then proceeds by searching through all legal masks of complexity three, i.e., all masks with two m -inputs, and best of those; and it continues in the same manner until the maximum allowed complexity (a parameter) has been reached. In increasing complexity, then reach a maximum, and then decay Dynamic Comparison rapidly. Each of the possible masks is compared to the others with respect to its potential merit. The optimality of the mask is evaluated with respect to the maximization of its forecasting power that is quanti fi ed by means of a quality measure, based mainly on Shannon entropy ( Escobet et al., 2008 ).

Fig. 4 illustrates how the input/output matrix (pattern rule based) isobtainedfromthemask.Thelefthandsideof Fig. 4 shows an shows the numerical rather than the symbolic class values presented use numerical values to represent them. The box symbolizes the mask that is shifted downwards along the qualitative data matrix.
The round  X  holes  X  inthemaskdenotethepositionsofthe m -inputs,
The class values are read out from the qualitative data matrix rule of Fig. 4 can be read as follows:  X  If all m -inputs ( i value of 2 (corresponding to medium ) then the m -output, O assumes a value of 1 (corresponding to low )  X  .

In the forecasting phase, future qualitative output states can be et al., 2008 ).TheFIRinferenceengineisbasedonavariantofthe k -nearest neighbor (KNN) rule. The 5NN pattern matching algorithm is the core of the FIR inferencing process. The forecast of the output variable is obtained as a weighted average of the potential conclu-sionsthatresultfrom fi ring the fi ve rules, whose antecedents best tive value can be obtained whenever needed.
 The envelope drives the fault detection process (see Fig. 1 )of VisualBlock-FIR. As shown in Fig. 6 , the envelope is composed of an upper bound (maximum value) and a lower bound (minimum value), that delimit the area in which the real output signal is expected to lie. The envelope is computed by applying the the fuzzy forecasting process of FIR methodology. The upper bound is the neighbor predicting the highest value and the lower bound correspond to the neighbor predicting the lowest value.
A narrow enveloping interval implies that the fi ve neighbors are very close to each other, meaning that the information available of the behavior of the system at that point in time is very rich and time, and therefore, the nearest neighbors are far away from each other. It is important to keep in mind that the FIR methodology is driven by the system's behavior rather than relying on structural knowledge, and therefore, the amount and richness of the data available from the system are crucial in order to assure the
Fault detection process checks if the real signal lies inside the envelope. If the observed (real) value leaves the bounds speci by the envelope, an instantaneous error is recorded, meaning that the model used in the prediction no longer represents the system at that speci fi c point in time.

In order to reduce the effect of instantaneous errors due to the presence of noise in the measurem ents or unmodeled dynamics, two fi The instantaneous errors recorded inside a predetermined detection time window are accumulated. When the cumulative error surpasses to identify the fault that has occurred (see Fig. 1 ).
Fig. 6 presents an example of FIR fault detection using the enveloping concept with a time window of 15 prediction points. The upper and lower dotted lines represent the upper and lower bounds of the envelope, respectively, whereas the continuous line is the real output signal. In the bottom part of the fi gure, the leaves the envelope for the fi rsttimeatpointnumber6wherethe observed value exceeds the upper bound of the envelope, causing an instantaneous error. The same occurs at points number 7 and 11. and therefore, the alarm is triggered at point number 11 when the third instantaneous error arrives. 2.2. VisualBlock-FIR fault identi fi cation
When an alarm is triggered, the fault identi fi cation process, model library, where each model has been identi fi ed, out of line, using the FIR methodology.

As in the detection process, the gray boxes represent FIR processes whereas the white boxes constitute the fault identi tion procedure.

At each instant of time, the measured data, once fuzzi fi for each model stored in the fault model library to obtain the envelope interval. As in the detection process, the instantaneous errors recorded for each fault model are accumulated over time. A predetermined identi fi cation time window de fi nes the number of determine the size of the time window it is necessary to take into account the system's dynamics. Due to the fact that the FIR models experiment with them to establish a small useful time window.
The accumulated errors are used to compute the model accept-that has occurred. It also offers guidance when the identi a foreseen fault and therefore is not available in the fault model able to explain an observed fault.
 The acceptability measure of the i th model, Q i , is described by Eq. (1) .

Q  X 
C is a relative con fi dence that takes the dispersion between the
C values into account. C i is obtained adding the cumulative errors cumulative errors possible (depending on the size of the identi time window ), I a max as shown in Eq. (2) .

C  X  1 : 0 I a
C is a con fi dence measure, i.e. a real-valued number in the range [0,1], where larger values indicate increased con fi dence. The relative con fi dence is obtained by Eq. (3) .

C
If there is only one model with a high value of C i , C rel be very high, but if there are other models with high C i well, C rel i will be much smaller. The model with the largest acceptability measure is selected as the one that best represents the new behavior of the system, and therefore, the detected fault has been identi fi ed. 3. Case study: PEM fuel cell system
A PEM fuel cell system is an electrochemical cell where chemical fuel with oxygen from air, with waste heat and liquid water as by-products. In this paper, a simulator of the PEM fuel cell system is non-lineal model and controller strategies proposed by Pukrushpan et al. (2004) which represents a 75 kW fuel cell system with 381 cells. This PEM fuel simulator allows incorporating various faults ( Table 2 ) within the Simulink environment.

A schematic diagram of the main subsystems of a PEM fuel cell
The air supply system consists of an air compressor to feed atmospheric air to the fuel cell cathode, the supply manifold that compressor, thus, it is important to determine the proper air air fl ow excess is re fl ected by the term oxygen excess ratio, de the ratio of oxygen supplied to oxygen used in the cathode, i.e.
The model guarantees the required stoichiometry by regulating the hydrogen, supplied from a pressurized or liquid hydrogen tank, by cell stack are also modeled in order to accurately evaluate the electricity production and the o utputs of the stack. This implies speci fi c model equation for the anode, the cathode, the membrane cell is considered in the model as an external component. The simulated model only describes the normal operational mode and purges in the anode side are not considered, meaning that all the hydrogen in the anode side is consumed. It is also assumed that the temperature of the fuel cell stack is known and constant since its dynamic behavior is much slower than that of the rest of the model. The transient phenomena captured in the model include the inertia dynamics of the compressor, the manifold fi lling dynamics (both anode and cathode), reactant partial pressures, and membrane humidity. For a deeper descriptio n of the PEM fuel cell simulator please refer to Lira et al. (2010 ).

The available sensors in the system are another important issue to measures of the compressor current I cm , and its speed,  X  voltages applied to the compressor, V cm , and the cell, V current I fc , is regarded as a measured disturbance to the system.
The simulator includes the fi ve faults presented in Table 2 .The fault # 1 is simulated with an increment in the compressor constant and, similarly, the fault # 2 is simulated with an increment in the thecompressortorque.Thefault # 3 is simulated with an increment in increment in the supply manifold outlet fl ow constant, which is in fl uences the compressor torque. 4. Fault diagnosis of the PEM fuel cell system
Fault diagnosis requirements applied to PEM fuel cell system model of the plant both in normal operation and in failure mode. 4.1. FIR qualitative models identi fi cation
The fi rst step for building the FDS is to obtain the FIR qualitative models, which constitute the model library. As Fig. 9 shows, the measured data are I fc , V cm , I cm ,  X  cm ,  X  the fi rst two are input variables.

When load changes, the current delivered by the fuel cell stack pump in order to maintain appropriate air feeding. In this study,
PEM fuel cell has been perturbed with a periodic load change. The load periodically draws the current signal shown in Fig. 8 , with a period of 160 s and amplitude between 160 and 250 A. The second and third periods are used to train the models and the last one to test them.
 The input and output variables are discretized into 3 classes.
The number of classes per variable has been determined by the modelers after an analysis of the signals. The membership func-tions are de fi ned following the equal frequency partition (EFP) algorithm, which distributes the membership functions in the search space in such a way that each class contains the same use a genetic algorithm to optimize the discretization parameters, due to the fact that the prediction results obtained with the proposed discretization values are already really good.
Due to the fact that each FIR model can have only one output, it perform fault detection and identi fi cation.

For each of these 24 scenarios, the system is simulated during 3 complete signal periods of 160 s each, i.e. 480 s of simulation time, with a sampling rate of 0.1 s, generating 4800 data points.
The fi rst 320 s (3200 data points) are used by FIR to identify the model, and the fi nal 160 s are used to verify the model. The masks obtained for the 24 scenarios are presented consecutively in Eq. (4) .
 t =
I
I t 4  X  t t 3  X  t t 2  X  t t t t 1 20 000 000 30 4 001 2 6 6 6 6 6 6 4 t =
V t 4  X  t t 3  X  t t 2  X  t t t t 1 20 000 000 3 40 001 t =
I t 4  X  t t 3  X  t t 2  X  t t t t 00 1 00 0 00 0 00 2 30 1 2 6 6 6 6 6 6 4 t =
V
I t 4  X  t t 3  X  t t 2  X  t t t t 10 2 00 0 00 0 00 3 40 1 2 6 6 6 6 6 6 4
The mean square error in percentage de fi ned in Eq. (5) is used to compute the prediction error.

MSE  X  E  X  y  X  t  X  y  X  t  X  X  2 =  X  2 predicted value and  X  2 denotes the variance.

For each of the 24 FIR models identi fi ed, mean square errors lower than 1 10 2 % are obtained when predicting the test sets.
These prediction errors are very low, meaning that the models obtained represent accurately each of the system's behaviors. The
FIR models are stored in the fault model library and are used during the fault identi fi cation phase of VisualBlock-FIR.
It should be taken into account that if a possible fault is not included in the fault model library it can be detected but not identi fi ed. Therefore, the set of faults should be selected accu-rately. However, it is possible to include new faults in the model library when needed. On the other hand, the mask and the pattern rule base are stored in the model library for each fault and, therefore, if the number of faults becomes very large the memory burden for on-line applications could become a problem.
As has already been explained, FIR is a data driven methodol-ogy that infers the model from system measured trajectories. As all obtain  X  good  X  models with poor and/or scarce data. From statis-least fi ve times ( Law and Kelton, 1990 ). Thus, a relation exists between the total number of legal states and the number of data points required to base the modeling effort upon. The total number of legal states is computed multiplying the number of classes of all input variables. Obviously, fault detection and identi fi cation are more accurate when the fault models identi represent accurately its behavior. However, as mentioned earlier, predictions that are not well founded on the basis of the available training data. 4.2. Simulation results Turning to the detection and identi fi cation performance of
VisualBlock-FIR, different experiments have been performed intro-ducing the previously described 5 faults. The goal of these experiments was to study the usefulness of our approach detecting and identifying the faults. Fault #1 is introduced at second 150 when the plant is working properly. Figs. 10 and 11 show the dynamic comparison of the six FIR models when used for predicting oxygen excess ratio,  X  o 2 , and compressor current, I output variables, respectively. The envelope is computed at the the fault models (rest of the plots of Fig. 10 ). The maximum and minimum values of the enveloping are represented as dashed lines whereas the real data is represented as a continuous line. As explained before, the FIR models identi fi ed are very accurate (have low prediction errors) and, therefore, the upper and lower bounds of the enveloping are, in both fi gures, almost undistin-guishable. In this study case, the detection time window lasts 1 s, the threshold of the cumulative error is 3 and the identi time window lasts 6 s.

Table 3 shows the detection and identi fi cation time (s) for each fault #1, VisualBlock-FIR needs only 0.4 s (4 samples) to detect a fault when oxygen excess ratio and compressor current output variables are analyzed. At second 150.4 an alarm is triggered and the identi fi cation phase starts, as seen in Figs. 10 and 11 .For VisualBlock-FIR needs 0.5 and 0.8 s, respectively, to detect that a fault has occurred.

In this case, a time window of 60 data points (corresponding to enough for the acceptability measure to be sure that fault #1 has been produced. In this application acceptability measures of 1 (maximum value) are obtained. In Figs. 10 and 11 it can be seen that at second 156 the enveloping of fault #1 contains the real signal, meaning that fault #1 model represents the current behavior of the plant. Contrarily, envelopes of the rest of the models do not contain the real signal.

Almost identical results are obtained when the same analysis is carried out for fault #2, as summarized in Table 3 . As can be seen in the second row of this table, the detection for each output variable is done very quickly (from 0.4 to 1.5 s). The identi performance is also very good, i.e. only 6 or 7 s is needed to know which fault has occurred.

If the same experiment is applied to fault #3 it is found that the behavior of compressor speed,  X  cm , and stack voltage, V is extremely similar to the signals of the same variables when the the enveloping when the system is working properly (most upper analyzing  X  cm and V fc variables, as shown in Table 3 .
If the same experiment is applied to fault #3 it is found that the behavior of compressor speed,  X  cm , and stack voltage, V is extremely similar to the signals of the same variables when the Fault Detector Fuel Cell Hydrogen Supply (Tank and control) the enveloping when the system is working properly (most upper analyzing  X  cm and V fc variables, as shown in Table 3 .
However, fault #3 is rapidly detected and identi fi ed when which shows the dynamic comparison of the six FIR models when the fault is detected in 0.4 s and identi fi ed in 6 s.
VisualBlock-FIR also obtains good detection and identi fi taken into account. The same reason outlined in fault #3 is valid here.

Fault #5 should be approached in more detail due to the fact become much more dif fi cult than in the previous faults (see last row of Table 3 ). VisualBlock-FIR needs around 22  X  25 s to detect the detection time. This time increase needed to detect and identify faults is a consequence of the similarity between the behavior of the output signals of fault #5 and the behavior of the same signals when the system is working properly, mainly in the positive semi-period of the signals. During the negative semi-period, the signals behave differently from one another, allowing the detection of the fault.

Fig. 14 shows the detection and identi fi cation results obtained fault #5.

As in the previous experiments the fault has been introduced in 172.7, and identi fi es it at second 178.

These results compare favorably to the detection and identi cation time obtained by the methodology based on computing residuals presented by Escobet et al. (2009 ), where more than 2 s were needed to detect faults #1 and #2 and more than 30 s were required to identify each of the fi rst two faults. No speci were reported in that research related to faults #3, #4 and #5. Therefore, no comparison can be made between their research and ours for these three faults.

On the other hand, the work of Lira et al. (2010) also analyzes fi ve faults; two of them correspond to our #1 and #4 faults. Their methodology is based on computing residuals using a LPV obser-ver. They conclude that with this methodology it is possible to detect and identify the faults studied. On the other hand, in the research of Kamal et al. (2014) and Kamal and Yu (2011 ) fi are presented, one of them corresponding to our fault #4. In these studies the authors propose to use radial basis function networks. As in the previous case, the authors report that all the faults studied are detected and identi fi ed with the proposed methodol-ogy, but no time information is included.

It is interesting to remark that usually the papers found in the faults studied. They only report if the fault has or has not been perform a deeper comparison here with other methodologies. 5. Robustness of VisualBlock-FIR
In order to study the robustness of the method developed, uniform white noise is added to the four output system variables. in the signals used to identify FIR models, i.e. FIR models are identi fi ed from data without noise, and are tested for fault detection and identi fi cation in a noise environment.
The reason not to use noisy data to obtain the models is twofold. On the one hand, we think that if the models are obtained without noise and afterwards they are used to detect and identify faults in a noisy environment, the robustness of the methodology is tested in higher depth. On the other hand, in real environments, robustness studying what happens when noise is added to the sensors is a prerequisite to test VisualBlock-FIR with real data.
For these experiments the detection time window is set to 1 s, window has been increased from 6 to 10 s, and the cumulative errors needed to trigger an alarm remains to three. Table 4 shows
If we compare the detection results from Tables 3 and 4 , it can be easily seen that when a noise of 60 dB and 40 dB is added to the signal, the detection time is almost the same than the one when the signal has no noise at all.

This makes sense since 60 dB and 40 dB correspond to only a 0.1% and 1% of noise, respectively. When the noise is increased, the time needed by VisualBlock-FIR to detect the fault is also increased. However, the detection time is still acceptable when a low compared to the results reported by Escobet et al. (2009 ).
Notice that when the percentage of noise increases more than 1% the enveloping signal is also increased in the percentage speci fi ed in the third column of Table 4 . Remember that the FIR models obtained are very accurate thus, implying very narrow envelopes. Fig. 15 shows the enveloping signals obtained for fault #1when a noise of 20 dB is added to the output signals. In this case, the percentage of increment of the enveloping is 8%, allowing fault detection and identi fi cation.

If we now compare the identi fi cation results from both tables, it when the noise is added to the output signals. This is due to the fact that the identi fi cation time window has been increased from 6 to 10 s in order to get a good identi fi cation performance. However, the identi fi cation time obtained for all faults is very satisfactory and de fi nitely lower than the time reported by other approaches for the same application ( Escobet et al., 2009 ). 6. Conclusions
The VisualBlock-FIR fault diagnosis system is presented and i.e. an increase in the friction in the compressor motor, when the compressor motor suffers an overheating, the fl uid resistance increases due to water blocking the channels or fl ooding in the diffusion layer, air leak in the air supply manifold and, increase in the voltage value below which the compressor motor does not turn.

For the fi rst four faults, a detection time lower than a second in less than 7 s. Detection and identi fi cation of the last fault of the plant when working properly. For this fault, minimum detection times between 22 and 25 s and identi fi cation times between 28 and 31 s (i.e. absolute seconds, including detection time) have been found. These results compare favorably with those obtained by the computing residuals approach ( Escobet et al., 2009 ). The robustness of VisualBlock-FIR has been also studied by adding different levels of noise to the output signals.
The detection and identi fi cation time has been shown to increase very good for values of 60, 40 and 30 dB.
 Here we have assumed that single fault occurs at a time.
However, in the near future, we plan to extend this research to fault conditions where multifaults occur simultaneously. We strongly believe that the methodology developed in this work has the potential to be applied to real world fuel cell stacks and that it could be implemented for on-board applications. It should done out of line and that, once the model library is available, the
FDS, i.e. VisualBlock-FIR, is able to perform the detection and identi fi cation in real time. Also notice that new models can be added to the fault model library anytime and no adjustment or recon fi guration of the FDS is required.
 References
