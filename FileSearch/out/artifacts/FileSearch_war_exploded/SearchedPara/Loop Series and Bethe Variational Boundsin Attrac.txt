 which generate better approximations but not, in general, b ounds. BP, and empirically improve substantially on naive mean fiel d bounds. implications for future analysis and applications of loopy BP. ical model associates each node with a random variable X Markov random fields (MRFs) as in Fig. 1, the joint distribution of x := { x via a normalized product of local compatibility functions : The partition function Z (  X  ) := P vertices ( c  X  V ). Letting x where as before Z (  X  ) = P conveniently described by the bipartite factor graphs [11] of Fig. 2. 2.1 Attractive Discrete Random Fields compatibility functions  X  pairwise marginal distributions  X  We let E X s = X t = 1 by coupling random spins z attractiveness condition of eq. (3) then becomes  X   X  following collection of 2 k  X  1 mean parameters: For example,  X  subset a  X  c , we then define the following central moment statistic: Note that  X  equals the cumulant  X  Given these definitions, we say that a probability distribut ion  X  ments associated with all subsets a  X  c of binary variables are non X  X egative (  X  compatibility function  X  satisfy this condition for all degrees k = | c | , and any scalar  X  2.2 Belief Propagation and the Bethe Variational Principle individual variables  X  denote the set of factors which depend on X sponding factor graph. The BP algorithm then iterates the fo llowing message updates: The left X  X and expression updates the message  X  m outgoing messages m messages define estimates of the desired marginals: to the local marginalization constraints P For pairwise MRFs, the reparameterized compatibility func tions equal  X   X  graph [20]. In later sections, we take expectations with res pect to  X  marginals p Using eq. (10), it is easily shown that the Bethe approximati on Z partition function via the positive constant Z (  X  ) /Z (  X  ) = Z 3.1 Pairwise Loop Series Expansions all nodes s  X  V have degree d ized potentials as in eq. (11) . The associated partition function then equals where only generalized loops F lead to non X  X ero terms in the sum of eq. (12) , and are central moments of the binary variables at individual no des. reparameterized pairwise compatibility functions: As verified in [17], this expression is satisfied for any ( x eq. (13). For attractive models satisfying eq. (3),  X  expectation with respect to the fully factorized distribut ion  X   X  ( x ) = Q non X  X mpty subset F  X  E of the graph X  X  edges: d ( F ) = 1 , it follows that E  X  loop F , in which all connected nodes have degree at least two. and the Bethe variational approximation is thus exact.
 a spin representation, and refactoring terms from the denom inator of edge weights  X  to establish analytic properties of BP fixed points. 3.2 Factor Graph Loop Series Expansions all connected factor and variable nodes have degree at least two. eq. (11) , and associated edges E . The partition function then equals where a edges in F . Only generalized loops F lead to non X  X ero terms in the sum of eq. (18) . For factor graphs with attractive reparameterized potenti als, the constant  X  Single X  X ariable subsets are excluded in eq. (20) because  X  partition function of the reparameterized factor graph as f ollows: Note that  X  chosen subset a Note that  X  in this loop series to be non X  X ero, there must be no degree one variables, since E In addition, the definition of  X  Z  X  (  X  ;  X  ) only at appropriate BP fixed points, not for arbitrarily chosen pseudo X  X arginals  X  4.1 Partition Function Bounds for Pairwise Graphical Models Consider a pairwise MRF defined on G = ( V,E ) , as in eq. (1). Let V cycles. We then define the core graph H = ( V discarding edges from nodes outside V Theorem 1. Let H = ( V potentials satisfying eq. (3) . Consider any BP fixed point for which all nodes s  X  V more neighbors in H have marginals  X  variational approximation Z From eq. (9), note that loopy BP estimates the pseudo X  X argin al  X   X  lead to edge weights  X  follows because E every generalized loop F associates an even number of neighbors d E for all nodes, we thus have Z (  X  )  X  1 . In particular, the symmetric fixed point  X  d For fixed points where  X  eq. (15) as (1 +  X  a graph with fixed pseudo X  X arginals  X  Sherman (GKS) inequality leads to an alternative proof in ca ses where  X  For attractive Ising models in which some nodes have margina ls  X  use upper bounds on the edge weights  X  lower bound Z (  X  )  X  Z with less homogeneous marginal biases. 4.2 Partition Function Bounds for Factor Graphs Given a factor graph G = ( V,C ) relating binary variables, define a core graph H = ( V Theorem 2. Let H = ( V attractive BP fixed point for which one of the following condi tions holds: The Bethe approximation Z For the case where  X  arguments in Sec. 4.1. When  X  of eq. (20), and again recover uniformly positive loop corre ctions. more challenging to determine which compatibility functio ns  X   X  ,a  X  c are necessarily satisfied whenever all variable nodes s  X  V H have the same bias. 4.3 Empirical Comparison of Mean Field and Bethe Lower Bounds spin representation z of uniform strength  X  moderate  X   X  the Bethe bound Z with corresponding bound Z log Z (  X  )  X  log Z  X  (  X  ;  X  )  X  log 2  X  0 . 69 thus remains bounded. potentials sampled according to |  X  |  X  ence log Z point reached from a random initialization. Fig. 3(b) first c onsiders MRFs where  X  potentials  X  attractive, binary pairwise MRFs, regardless of the observ ation potentials.
