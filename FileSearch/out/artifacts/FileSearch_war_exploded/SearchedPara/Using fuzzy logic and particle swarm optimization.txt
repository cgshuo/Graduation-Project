 1. Introduction
A cDNA microarray image represents a two-channel Red-Green image which is regarded as a vector-valued image ( Bajcsy et al.,; Belean et al., 2012; Giannakeas et al., 2012; Lukac et al., 2005 ). Nowadays,thecDNAarraytechnologydenotesanadvancedmethod which is employed in the investigation of toxicological problems and achieves promising results. Also, it can be intensively employed for rapidly screening, analyzing, and matching gene behavior. In addi-tion, the cDNA array technology is applied in various fi elds of biotechnology ( Bajcsy et al.,; Belean et al., 2012; Daskalakis et al., 2009; Giannakeas et al., 2012; Rueda and Rezaeian, 2011 ). In general, the gene expression of testing spe cimens depends on the reaction estimation of spots. However, durin g the image digitization process, the cDNA microarray images are easily contaminated by residual dye when they are extracted or transmitted, as shown in Fig. 1 ( Bajcsy et al.,; Belean et al., 2012; Gonzalez and Woods, 2002 ). These arti fi cial pollutions are known as artifacts or impulse noises which cause image distortion and damage ( Bajcsy et al.,; Belean et al., 2012; Gonzalez and Woods, 2002 ). They seriously in fl uence the color displaying of spots and inhibit the accuracy of follow-up gene expression analysis ( Schena, 2000 ). Hence, cDNA microarray images need to be processed for noise removal, and then the subsequent removing impulse noises, shown in Fig. 2 ( Jin and Li, 2007; Ko and Lee, 1991; Lukac and Smolka, 2003; Smolka and Chydzinski, 2005;
Tsai et al., 2012 ). The noise detectors of these methods judge each central pixel in the fi lter window whether it is noise-corrupted or not. If yes, these methods restore the corrupted pixel. Otherwise, the pixel remains unchanged. In Tsai et al. (2012) , the method of
Tsai utilizes a varying 2-level hybrid impulse noise detector (IND) to detect whether each pixel in the gray-level image is corrupted by impulse noises or not. In Jin and Li (2007) , the method of Jin proposes a switching vector fi lter to perform the noise detection, which can determine the corrupted pixels for color images.
However, these two methods can be not directly employed for noise detection of cDNA microarray images because they are only applied on noise detection for gray-level or color images. The method of Daskalakis et al. (2007) proposes a robust framework which is designed to think over the effect of noise of microarray images to overcome the rigorous work of microarray image analysis . Nevertheless, the computations for fi lters in this method are individual channel-based. Also, fi lters are designed in the
DFT domain, which will blur edge/details. Subsequently, another two schemes have been proposed to promote the above methods ( Lukac and Smolka, 2003; Smolka and Chydzinski, 2005 ). In Lukac and Smolka (2003) , the method of Lukac provides an adaptive center-weighted vector median fi lter (ACWVM) which varies the extreme CWVM (center-weighted vector median fi lter) smoothing levels between the identity and the VM (vector median fi lter) operations. In Smolka and Chydzinski (2005) , the method of
Smolka employs the switching scheme which is based on impulse noise detection mechanism via using the fast peer group (FPG) concept in the noise detection for color images ( Smolka and Chydzinski, 2005 ). Nevertheless, Lukac and Smolka (2003) and
Smolka and Chydzinski (2005) only create simple formulas with fi xed thresholds to determine each vector-valued pixel whether it is corrupted or not. These methods based on hard computing cannot solve complex problems for complicated situations to restoring the damaged pixel. Note that the output of an identity fi lter is the same as its input. Fuzzy rules for the FL-based noise detector are designed according to the characteristics of cDNA microarray images. The reason to adopt the FL technique in the design of the noise detector is given as follows. A fuzzy rule data base is built and the fuzzy inference engine is then employed to inference these fuzzy rules to determine whether the input pixel vector is corrupted or not. These rules are devised according to human prior knowledge and thinking reasoning. The FL technique possesses two characteristics. One is that it can realize linguistic concepts. The other is that it can be easily implemented to be a universal approximator which performs a nonlinear mapping from an input domain to a corresponding output domain. The FL easily re fl ects the human concept of expertise knowledge which per-forms a mapping to classify input pixel vectors as two classes, noise-free and noise-corrupted classes. Because the human con-cept of expertise knowledge can be realized by a set of fuzzy rules, human can maintain these fuzzy rules to promote suitable map-pings ( Own et al., 2006; Tsai et al., 2000 ). For example, two methods proposed in Own et al. (2006) and ( Tsai et al. (2000) employ the FL technique in the design of fuzzy gray-level image fi lters which maps a set of input pixels into 256 categories. The mapping can be regarded as a fi ltering algorithm.

The rest of this paper is organized as follows. The basic components and the representation of cDNA microarray images are introduced in Section 2 . The algorithms for the FL technique and the PSO algorithm are brie fl y described in Section 3 . Literature reviews of well-known color image fi lters and cDNA microarray image fi lter are also stated in Section 3 . Section 4 presents the proposed fuzzy-based fi lter for cDNA microarray images, which contains the preprocessor, the noise detector, and the fi ltering framework. Section 5 shows the experimental results. Finally, the conclusions are given in Section 6 . 2. cDNA microarray images 2.1. Basic components in the cDNA microarray image
In general, a cDNA microarray image contains four basic components: pixel vector, spot block, foreground, and background, shown in Fig. 4 ( Giannakeas and Fotiadis, 2009 ). These basic components are expressed as follows:
Pixel vector: The smallest units, pixel vectors, form a color cDNA microarray image. Each pixel vector consists of two-channel color information.

Spot block: In order to segment and identify spots' hybridization reactions, spot blocks are considered as rectangular and equidi-stant in the microarray chip which appears as a grid array.
Foreground: The foreground of a spot block is a fl uorescent reaction spot. If the spot has stronger reaction, then it has 3. The FL technique and the PSO algorithm 3.1. The FL technique difference between a fuzzy set and a traditional set. The membership degrees of the elements in the traditional set are expressed by crisp values in {0, 1}. Compared to the traditional set, the membership degrees of the elements in the fuzzy set can be determined by membership functions, such as trapezoidal and triangular, etc. These membership degrees are expressed by the values in [0, 1]. The latter way can better represent human knowledge and logical reasoning. In recent years, fuzzy logic has been widely applied in the application fi elds, such as pattern recognition, decision analysis, and image fi ltering, etc. ( Ross, 2004 ). In this paper, a fuzzy logic system is employed to design an impulse noise detector for improving the detection performance of the traditional detectors. Each pixel vector in an image can be identi fi ed by the system whether it is corrupted or not. More clearly, Fig. 5 displays the structure of the fuzzy logic system. Main functions in the system contain the fuzzi fi er, the fuzzy rule data base, the fuzzy inference engine, and the defuzzi fi er. The fuzzi fi er converts an input into its corresponding fuzzy set. The fuzzy rule data base contains various fuzzy inference rules which appear in
IF-THENformat.Thefuzzyinferenceengine fi rst computes the fuzzy degrees of each fuzzy rule. And then it produces the fuzzy results of each fuzzy rule. Subsequently, it aggregates these fuzzy results to form a fuzzy set performed by several fuzzy inference methods, for instance, max  X  min of Mamdani method. The defuzzi fi er converts the above fuzzy set into a crisp value via using, for example, the gravity method or the centroid method. 3.2. The PSO algorithm in many applications ( Tsai et al., 2012 ). In the algorithm, birds decide the next direction and the distance of movement by referencing the past directions of movement and the current location when they look for food. A particle in the PSO algorithm is considered as a biological individual in a very numerous solution space to search for a nearly optimal solution for more complex problems ( Tsai et al., 2012 ). More speci fi cally, the training proce-dure of the PSO algorithm is brie fl y described as follows X  X  t  X  1  X  X  X i  X  t  X  X  V i  X  t  X  1  X  X  5  X  where X i  X  t  X  1  X  represents the location of particle i at the ( t  X  1)th iteration, V i  X  t  X  1  X  indicates the movement vector of particle i at the ( t  X  1)th iteration. Hence, the next location of particle i is to add its current location vector to its movement vector ( Tsai et al., 2012 ). 3.3. A review of vector-based image fi lters 3.3.1. The VM fi lter
The method of Astola proposes the VM fi lter for restoring corrupted color images ( Astola et al., 1990 ). The fi lter outputs the pixel vector which has minimum sum of all distances between one be an input of the VM fi lter. First, the associated distance D i for each vector x i can be calculated by Eq. (6) .
 D  X   X  n where D i indicates the distance of two pixel vectors, x i and x k ,in w , jj x i x k jj L represents the distance of Minkowski metric, L stands for the norm parameter. L  X  1 and 2 respectively indicate the city-block distance and the Euclidian distance. Subsequently, D , D 2 , ... , and D n are sorted by the ascending sequence to obtain D (1) r D (2) r ... r D ( n ). According to the total ordering of their associated distances, these vectors x 1 , x 2 , ... , x n can be sorted to the VM fi lter for the central pixel vector of w ij denotes ^ x VM which is computed in Eq. (7) . ^ x VM  X  VM  X  w ij  X  X  x  X  1  X  :  X  7  X  That is, D  X  1  X  represents the minimum sum of all distances between one pixel vector and other pixel vectors in w ij . de fi ned in Eq. (11) .

Val  X   X  where  X  denotes the tunable parameter. 4. The DBAMI image fi lter fi lter. First, a cDNA microarray image I is segmented to form spot blocks, shown in Fig. 4 (b). Then, each spot block is split into foreground and background images. Next, the foreground image is performed by a fi ltering procedure. Subsequently, the background image is set to black. Finally, the output of the DBAMI fi lter is to merge the restored foreground and background images. 4.1. The block diagrams for the DBAMI fi lter locate each spot of a cDNA microarray image I . The method of Li is adopted in this paper to perform the SB component ( Li et al., 2005 ). Fig. 7 shows an example for the SB component. Fotiadis, 2009; Giannakeas et al., 2012; Rueda and Rezaeian, 2011 ). Fig. 7 (b) exhibits the spot template with size 22 22 which is utilized in the DBAMI fi lter. Fig. 7 (d) depicts the location of the highest similarity between the spot block and the template. White spots indicate the center locations of spots after matching the template. However, shortcomings of the method still exist in the spot block identi fi cation for cDNA microarray images. The spots are not necessarily perfectly circular. In order not to affect the spot shape, the proposed identi fi cation method in this paper employs a rectangle with covering larger area for segmenting the foreground area, shown in Fig. 7 (e). The white regions indicate the foreground areas which are utilized in the noise-removal procedure of the DBAMI fi lter. The black regions are regarded as the backgrounds whose pixels are set to be black. 4.2. The FL-based noise detector (FLND) 4.2.1. The design of the FLND component
In Fig. 6 , the FLND component performs a noise detector, which employs the FL technique to judge the central pixel vector x mn ij in the fi lter window w mn ij whether it is corrupted or not. The FLND fi rst utilizes the VM fi lter, the ACWVM fi lter and the CWVM fi lter to judge x mn ij of w mn ij in F mn using various fi lter windows with different sizes. In order to compare various restoration results of different fi lters and fi lter windows, the VM and the CWVM fi lters are performed in a 5 5 fi lter window. The ACWVM fi lter utilizes the fi lter window with size 3 3 here.
 restoration results of using the VM, the CWVM, and the ACWVM fi lters, respectively, while feeding w mn ij into them. Moreover, d VM ; ij , d
CWVM ; ij , and d ACWVM ; ij represent the distances between the central respectively, using L 2 norm, jj U jj 2 , for distance computation. The d components in input vectors can be normalized in [ 1, 1] without loss of generality. Therefore, the FLND performs a mapping from  X  1 ; 1 3 to { 1, 1}. In this paper, the mapping can be realized by d
ACWVM ; ij ) is fed to the FLND which employs the de fi ned semantic fuzzy rules to compute the possibility degree in [ 1, 1] for the corruption for x mn ij . As a result, a constant decision function is utilized in the FLND to judge whether the vector-valued pixel x mn ij is noise-corrupted or not.

A fuzzy rule data base is composed of a set of fuzzy rules with the if-then format. According to the structure knowledge, the mapping behavior of the FLND can be described by means of eight fuzzy rules, shown in Table 1 . Three input linguistic variables, d low ( L) and high ( H) in the premise part. Thus, there are totally 2 3  X  8 fuzzy rules. In the consequence part, a fuzzy linguistic variable, NP (noise-corrupted possibility), associates with fi ve linguistic terms, very low ( VL) , moderate low ( ML) , medium ( M) , complicated problem to search for an optimized combination of the parameters of these eight rules. Recently, the PSO algorithm has been utilized to solve this kind of optimization problems ( Tsai et al., 2012 ). Thus, in this paper, the PSO algorithm is also employed to fi nd out an approximately optimal solution of the optimization problem. That is, it is essential to utilize a systematic approach to search for the appropriate parameters and the optim-ized combinations.
 parameters (the center and the spread) of bell-shaped member-ship functions in the FL technique and the threshold constant  X  with fi nal decision. Fig. 9 depicts the training procedure for the optimization of the FLND. In Fig. 9 , the trained images are noise-corrupted, where P  X   X  [f  X  g comprises a set of shape parameters of all membership functions and the decision threshold  X  . The error rate of noise detection for each generation is calculated as the fi tness of the PSO algorithm, where the error rate denotes the rate between the number of error evaluation samples and the number of total evaluation samples, shown as follows ( Tan et al., 2006 ): fitness  X  Error Rate  X  FN  X  FP TP  X  FN  X  FP  X  TN 100 %  X  15  X  where TP (True Positive) and TN (True Negative) indicate correct evaluation samples, FP (False Positive) and FN (False Negative) denote false evaluation samples. FP indicates that the number of adopts the fi tness function in Eq. (15) to evaluate the fi tnesses of particles. It is terminated when the number of maximum training generation reaches 50 or the fi tness value meets the problem's requirements.

Let p 0  X   X  0 [f  X  0 g be a nearly optimal solution for the optimi-zation problem of the FLND. Moreover,  X  0 indicates the approxi-mately optimal threshold which determines x mn ij whether it is corrupted or not.  X  0 is a nearly optimal solution selected from  X  in Eq. (14) , which can be found out by the PSO algorithm and be represented by Eq. (16) , where c 0 lk and  X  0 lk denote the nearly optimal center and the approximately optimal spread of the k th membership function in Rule l , respectively. 4.3. The color-ratio histogram-based fi lter (CHF)
Fig. 10 displays a comparison of restoration results for the VM, the CWVM, and the ACWVM fi lters with different sizes in terms of the average MAE FG in Eq. (19) while feeding the corrupted fore-ground image with impulse noises, salt-and-pepper (SP), fi xed-length (FL), and random-valued (RV), to these fi lters. An observa-tion in Fig. 10 is found out that the ACWVM fi lter (3 3) outper-forms other fi lters in restoration performance at low noise ratios (2  X  16%). Additionally, the CWVM fi lter (5 5) is superior to other fi lters at high noise ratios (16  X  30%). Therefore, the paper proposes the CHF to improve the CWVM fi lter, which is shown in Fig. 11 . Fig. 11 (a) shows the restoration results for a spot block. The foreground and the background images clearly have several noises. Fig. 11 (b) displays the restoration results after applying the CHF to the output image of the CWVM fi lter.

In an ideal cDNA microarray image, the spots show consistent colors ( Schena 2000 ). According to the assumption of spots' color consistency, the paper presents the CHF, which fi rst adds up color-ratio value of foreground area in the spot block and then judges the color reaction for the spot with the color-ratio value. Subsequently, it restores the pixel vector by using the VM fi lter with size 3 3.
Let CR be a color-ratio value for a vector-valued pixel x mn ij , which is speci fi ed in Eq. (17) , CR  X  x mn ij  X  X  where x 1 ij and x 2 ij respectively indicate the pixel values of Green and Red channels at position ( i , j ) in the image X MN . Moreover, x 1 ij and sample images are depicted in Fig. 12 . The impulse noises are simulated to contaminate cDNA microarray images in the experi-ments. Three kinds of impulse noises, SP, FL, and RV are adopted ( Tsai et al., 2012, 2000 ). The noise corruption can be de fi ned in
Eq. (18) , where x ij denotes the original pixel vector, x 0 ij indicates its corrupted pixel vector, and v ij represents the noise vector. 5.1. The evaluation quantitative indices for restored image quality and NMSE (normalized MSE) are employed in the evaluation of fi ltering performance and are rewritten as MAE FG , MSE FG , PSNR FG , pixel vector in the foreground g denotes the foreground region of the pixel x ij in the fi lter window, M and N respectively indicate the length andthewidthofanimage,and jj U jj 2 denotes the Euclidian distance. 5.2. The evaluation for the FLND Here, the PSO algorithm is employed to optimize the FLND. That is, the PSO algorithm is utilized to search for a nearly optimal set for  X  [f  X  g . The optimal set is denoted by p 0  X   X  0 [f  X  0 g in Section 4.2.2 . For each rule in Fig. 8 , the centers of the membership functions for linguistic terms H and L in the premise part are set to 1 and 1, respectively. Also, the centers of the membership functions for linguistic terms VH and VL in the consequence part are set to 1 and 1, respectively. Thus, four parameters are in Rules 1 and 8 respectively. Meanwhile, in other rules, each one contains fi ve parameters. Table 3 exhibits that there are totally 38 parameters in eight rules. That is, the cardinality of the optimal set ,  X  0 , is 38 and the cardinality of P 0 , P 0 jj , is 39.
Each examined training image is respectively contaminated by aforementioned three impulse noises, SP, FL, and RV, at noise ratios 10%, 20%, 30%, and 40%, which is indicated by I ments, a set of training images can be represented by I tr ;  X   X  ;  X   X  f I Subsequently, the other corrupted images at noise ratios 2%, 4%, 6%, ... , 28%, and 30%, which are indicated by I te , are utilized to form a set of testing images to validate the DBAMI fi lter, where I et al., 2007; Smolka and Chydzinski, 2005 ). Here, the following j I  X  ;  X  j X  12 12  X  144 ; and j I te j X  45, can be obtained.
In Eq. (15) , the error rate of noise detection is considered as the evaluation index. Lower error rate indicates higher performance in noise detection. More speci fi cally, Figs. 13  X  15 respectively repre-sent the error rates of different noise ratios for various impulse noises, while using I tr to train the FLND. Fig. 16 demonstrates the average error rates for different noise ratios in three kinds of noises. In Figs. 13  X  16 , SP, FL, and RV are followed by numbers to stand for noise ratios. For instance, SP10 indicates that trained images are corrupted by salt-and-pepper with 10% noise ratio, and so on. Also, the curve of SP10 represents the error rates of the FLND while testing images at noise ratios, 2%, 4%, 6%, ... , 28%, and 30%, being fi ltered.
 Fig. 8 demonstrates the shapes of membership functions for the FLND before training. During training, if  X  is more adjusted approaching to 1, then FN is lower. This phenomenon indicates that the FLND very possibly considers a pixel vector in the cDNA microarray image as noise-corrupted. For the reason, in two
Thus, the images at FL20 are the appropriate trained images under considerations.
 Meanwhile, the FLND is optimized by the PSO algorithm.

Figs. 8 and 17 depict an example for the shapes of membership functions before and after training, respectively. Table 4 presents the parameters of the PSO algorithm during training. The above experimental results demonstrate that the FL techniques are robust in generalization for same noise type with various noise ratios and for different noise types with various noise ratios. 5.3. The performance evaluation of the DBAMI fi lter (with CHF), are respectively employed to evaluate the performance and are also compared with other existing cDNA microarray image fi lters ( Adjeroh et al., 2006; Lukac et al., 2005; Lukac and Smolka, 2003; Smolka and Chydzinski, 2005 ). Figs. 18  X  26 demonstrate the restoration performance of various fi lters for three kinds of impulse noises in terms of MAE FG , PSNR FG , and NMSE FG .An observation is obtained that when the index PSNR is greater than 35, it is dif fi cult to distinguish the difference by visual perception between the restored image and the original image. 6. Conclusions
This paper has proposed the decision-based DBAMI fi lter for the removal of three types of impulse noises in cDNA microarray images. First, it splits the foreground image and the background image from a cDNA microarray image. Subsequently, this paper is the fi rst one which employs the decision-based structure to design an impulse noise detector for cDNA microarray images and also simultaneously utilizes the FL and the PSO algorithm to realize the noise detector. Three vector-based fi lters, the VM, the CWVM, and the ACWVM have been subtly employed to design the inputs of the FLND which can effectively judge the impulse noises and achieve better performance in noise detection. Also, the proposed fi lter employs the CWVM fi lter for noise restoration. In addition, according to the characteristics of spot's reaction in the cDNA microarray image, the CHF with the histogram of spot color ratio is designed to improve the CWVM fi lter. Finally, experimental results demonstrate that the DBAMI fi lter outperforms the existing well-known fi lters under considerations here. Accordingly, the DBAMI fi lter can be effectively applied in the restoration of cDNA micro-array images.
 Acknowledgments
This work is partially supported by the National Science Council of Taiwan, for its fi nancially supporting the research under Con-tract nos. NSC 101-2511-S-150-003 and NSC 97-2221-E-150-070. The authors also gratefully acknowledge the valuable comments and suggestions of the anonymous reviewers, which have improved the presentation.
 References
