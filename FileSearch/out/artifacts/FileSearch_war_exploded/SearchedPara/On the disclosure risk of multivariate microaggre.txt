 1. Introduction
One approach for ensuring privacy is the application of perturbative protection methods over the confidential data when it is released to third parties. At present, a large number of perturbative protection methods exist (see [1,6] for two good surveys on data protection methods).

Microaggregation has emerged as one of the most promising protection methods; for example, [10] shows that microag-gregation is used by many statistical agencies for data anonymization. Microaggregation works as follows: given a dataset which the element belongs. A certain level of privacy is ensured because k elements have an identical protected value.
Microaggregation techniques can be classified as univariate microaggregation (when the number V of variables is 1) or one is to apply a multivariate microaggregation technique to the whole set, resulting in protected clusters with at least k elements (or records) with exactly the same values in the V variables. Therefore, this method provides k -anonymity [22], is to split the set of variables in smaller blocks of v i parallel some microaggregation technique (possibly univariate, if v in this case will not have k equal elements, because two elements which are in the same cluster for a block of variables are ity is not ensured anymore), but the statistical utility of the protected dataset is higher.
Formally, microaggregation is defined as an optimization problem with some constraints. The constraints are that clusters should have at least k elements. The objective function (to minimize) is the total sum of distances between all the elements roaggregation, there exist polynomial-time methods to obtain an optimal solution of this optimization problem, for example the algorithm in [11] which works over a graph built from the sorted original data. The main drawback of univariate mic-roaggregation, of course, is that it provides a bad level of privacy, due to its high disclosure risk [19].
With respect to the multivariate case, the problem of optimal microaggregation was proved to be NP-hard [20]. Due to this, different heuristic microaggregation schemes are found in the literature. We can distinguish here two approaches. The first one is to design a specific heuristic scheme; a well-know algorithm is MDAV (maximum distance to average vector) [13,8] , an iterative algorithm. The second approach is to reduce the multivariate case to the univariate one, by using some method to project variables into a single one. In other words, records are sorted using a new projected value computed from the V variables to microaggregate; after that, an univariate microaggregation algorithm (for example, an optimal one) is ap-plied to the sorted projected records. According to the projection method which is applied to the variables, two such mic-roaggregation schemes have been suggested (but not detailed) in the literature: PCP-microaggregation (principal these two methods; we also implement them and compare their performance against MDAV.

Since k -anonymity is ensured only in the case of microaggregation with a unique block of variables, the exact level of pri-vacy of specific microaggregation schemes must be carefully studied. The usual technique to do so is to compute the disclo-with their protected partners. A correct link between the two datasets implies that the privacy of the respondent is broken.
The use of such record linkage methods [25] to study the privacy level of a data protection method presents the advantage probabilistic record linkage (P-RL) [14] are the two standard methods for record linkage which are considered when analyz-ing a particular protection method. However, as shown in a few works [17,26] , record linkage can be tuned by an intruder, depending on the specific data protection method which is being used, to improve the results of the attack.
In this paper we add a new argument in this direction. Namely, we first show by means of some experiments that the privacy level of PCP-microaggregation and ZScore-microaggregation is quite good, when only the standard record linkage methods DB-RL and P-RL are considered. However, we then design and implement a new ad hoc record linkage method, that iate microaggregation schemes. Informally, the projected record linkage method computes the projected values of the pro-tected values, then it uses the standard distance-based record linkage method to compare the projections with the original record to be linked. The experiments described in this paper show that this new record linkage method finds (many) more correct links than DB-RL or P-RL. The conclusion is that the real disclosure risk of PCP-microaggregation and ZScore-micro-aggregation is underestimated when it is computed using only standard record linkage methods. In order to confirm whether the projected record linkage method is really specific for these two methods, we also apply it to MDAV, obtaining better re-record linkage method is originally designed to work well for projection-based microaggregation.
The rest of the paper is organized as follows. In Section 2, we explain some preliminary concepts like the disclosure risk and the information loss of a microdata protection method, and the basic definitions and some standard protocols for mic-roaggregation. In Section 3, we first propose a formal and generic description of PCP-microaggregation and ZScore-microag-gregation. We then perform experiments with two reference databases, Census and EIA, to compute the standard score of
MDAV and the two new projection-based microaggregation methods. Then, in Section 4, we present a new record linkage technique based on projections; we experiment this technique with all the considered microaggregation methods, and then we compute two updated and more realistic scores. Finally, in Section 5, we draw the conclusions of this work and present some future work. 2. Preliminaries
In this section, we explain basic concepts about microdata protection methods, including the score, a measure to compare two protection methods, by combining their information loss and their disclosure risk. We also review the definition and some results about microaggregation. 2.1. Microdata protection methods
A dataset X can be viewed as a matrix with n rows ( records ) and V columns ( attributes ), where each row contains V attri-to identify unique individuals, as follows: the passport number.
 alone. However, when it is combined with other quasi-identifier attributes, they can univocally identify an individual.
Among the quasi-identifier attributes, we distinguish between confidential and non-confidential, depending on the kind of information that they contain. An example of non-confidential quasi-identifier attribute would be the zip code, while a confidential quasi-identifier might be the salary.

Normally, before releasing a dataset with confidential attributes, a protection method q is applied, leading to a protected crypted, therefore we will write X  X  X nc k X c ; (ii) confidential quasi-identifier attributes X
X privacy of the individuals whose confidential data are being released. Therefore, we have X was used first in [6] to compare several protection methods, has also been adopted in other works like [27]. 2.2. Record linkage
Once the protected dataset X 0 is released, everybody can see its content X tains from another data source another non-protected dataset Y  X  Y an intruder is to find correct links between the protected dataset X record in X 0 , then he will know that the matching (not modified) confidential information X tection method is directly related to the difficulty of finding correct linkages between original and protected data. goal of the intruder is to find the protected record in X cords he wants to link. Additionally, maybe there exists a more effective record linkage method for the case where many original records are known. For example, if the applied microdata protection method is deterministic and an intruder knows truder, then we can conclude that the considered protection method does not offer enough privacy, because the situation in real life can be even more advantageous for the intruder.
 Two record linkage (also known as re-identification ) methods are usually considered in the literature:
Distance-based record linkage (DB-RL) . It can be applied when a distance between records in the original and protected datasets can be defined. In the standard method proposed in [21], every protected record is linked with the closest original record using the Euclidean distance after normalizing both datasets.

Probabilistic record linkage (P-RL) . In this case, the matching algorithm uses the linear sum assignment model to choose which pairs of the original and protected records must be matched. In order to compute this model, the EM (expectation-maximization) algorithm [12,15] is normally used. Informally, for each pair of records  X  a ; b  X  where a is an original record of the dataset Y and b is a protected record of the dataset X ( c 1 (a,b) ... c n (a,b)), where c i  X  a ; b  X  is defined as 1 if V over these coincidence vectors, pairs are classified as linked pairs (LP) or non-linked pairs (NP). This method was intro-duced in [14]. 2.3. Score computation
A microdata protection method must guarantee a certain level of privacy (low disclosure risk). At the same time, since the method must ensure somehow that the protected data are statistically close to the original data. In other words, the amount of information which is lost by releasing the protected data instead of the original one should not be very high. original microdata are encrypted and then released, the disclosure risk is (almost) zero, but the information loss is maximum.

There are different measures proposed in the literature to evaluate the quality of a data protection method, by taking into account these two values. We will use one of the most popular ones, the score , which was presented in [5] and used in many other works [16,30] . The score is a simple and natural way to evaluate the trade-off between the information loss and the disclosure risk because it is defined as the average of these two values. Namely, In the score framework, information loss and disclosure risk are computed as follows.

Information loss (IL). The overall IL is computed as IL  X  100  X  0 : 2 IL (i) IL 1 is the mean absolute error of the original microdata X with respect to the protected data X (ii) IL 2 is the mean variation of the attribute average vectors. (iii) IL 3 is the mean variation of the attribute covariance matrices. (iv) IL 4 is the mean variation of the attribute variance vectors. (v) IL 5 is the mean variation of the attribute correlation matrices.

Disclosure risk (DR). Three alternatives are considered for measuring the disclosure risk. They are the two variations of record linkage explained in Section 2.2 and the interval disclosure. Half weight is given to record linkage and the remain-ing half weight is given to interval disclosure. For record linkage, the average of the two methods is computed. Formally, this corresponds to DR  X  0 : 25 DLD  X  0 : 25 PLD  X  0 : 5 ID , where (i) DLD , the distance-based linkage disclosure risk , is the average percentage of correctly linked records using distance-These three values are computed over the number of attributes that the intruder is assumed to know.
The idea of the score is to work without prior knowledge about both the use of the data and the possible behaviour of the intruders. For this reason, the score always computes the arithmetic mean of all the considered options (the same weight is more interested in privacy than in utility of the data; or DR make more sense than interval disclosure attacks). These modifications would assume some prior knowledge on the use of the data or the behaviour of the intruders, which would go against the philosophy of the score measure. 2.4. Microaggregation
Microaggregation is one of the most popular, studied and used microdata protection methods, because its score values is the original records by the centroid of the cluster to which the record belongs.
 The goal of a microaggregation is to minimize the total sum of square error where c is the total number of clusters, C i is the i th cluster and x i  X  1 ; ... ; c .

When the number of attributes is large, the basic microaggregation technique suffers from a low statistical utility, espe-released (protected) dataset.

To solve this drawback, the following natural strategy is applied by statistical agencies: the dataset is split into smaller attributes. So, the resulting protected records will not be equal and no k -anonymity is ensured. The simplest approach for microaggregation is when the size of the attribute blocks is equal to one, in other words, each attribute is protected inde-pendently. This corresponds to univariate microaggregation or individual ranking microaggregation .
In this section we will explain several different algorithms that have been proposed (in more or less detail) for microag-on when we will explain two methods for projection-based multivariate microaggregation: PCP-microaggregation and
Zscores-microaggregation. Finally, we will describe one of the most used methods for heuristic microaggregation (specially for the multivariate case, although it can be applied to the univariate case, as well): the MDAV algorithm. 2.4.1. Optimal univariate microaggregation
In [7], two results related to optimal univariate microaggregation are proved, which constrain the search space and make possible a polynomial time algorithm: contiguous (non overlapping clusters exist).
 Result 2. All clusters of any optimal partition have between k and 2 k 1 elements.

One method for optimal univariate microaggregation was proposed in [11]. Let V  X  X  v n values of the variable to be protected. Assume that the values are sorted in increasing order: v an integer satisfying 1 6 k &lt; n , which is a parameter of the microaggregation configuration.
Given V and k , a graph G k ; n is defined as follows. First, we define one node of G for each element v node v 0 (this node is later needed to apply the Dijkstra algorithm). Then, for each node v edges h v i ; v j i for all j such that i  X  k 6 j &lt; i  X  2 k . The edge h v sible clusters (recall Result 1 above). The cost of the edge h v cluster. That is, SSE  X  P j l  X  i  X  x l x  X  2 , where x is the average record of the cluster.

Given this graph, the optimal univariate microaggregation is formed by the clusters determined by the edges which are in the shortest path between the nodes G 0 and G n (this path is found by applying the Dijkstra algorithm). 2.4.2. MDAV microaggregation
The MDAV algorithm [8,13] is an heuristic algorithm for clustering records in a dataset X so that each cluster is con-strained to have at least k records. This algorithm can be used for univariate microaggregation and multivariate microaggre-gation. The MDAV algorithm is described in Algorithm 1.
 This generic algorithm can be instantiated for different data types, using appropriate definitions for distance and average.
In the most common case, the most distant record and the closest records are computed using the Euclidean distance, and the average record is defined as the arithmetic mean of the records.
 Algorithm 1. MDAV 3. Projection-based microaggregation
The main problem when one tries to extend the optimal univariate solution (see Section 2.4.1) to the case of multivariate with respect to their distance to the global centroid of the data.

A different possibility is to reduce the dimensionality of the problem, from more than one variable to 1 variable, by apply-ables of the dataset are projected. We detail here a more general method, where projection-based microaggregation is applied in parallel to blocks of v i variables, where P i dataset will not enjoy k -anonymity. However, the information loss of the protected dataset with respect to the original one will be lower.
 Algorithm 2. Projected microaggregation
The proposed multivariate microaggregation algorithm is described in Algorithm 2, when applied to a dataset X with n records and V attributes:
Depending on the projection method which is applied to the variables, we will obtain different methods of multivariate the scenario of statistical data protection), the PCP and Zscores projection methods seem to be the best choice. We call the resulting microaggregation algorithms PCP-microaggregation and Zscore-microaggregation . For completeness, we review now the PCP and Zscores projection methods.

Principal component projection . Formally principal component projection (PCP in short) works as follows: let us assume that values of v variables for n individuals are stored in a matrix X of dimension n v , where columns contain variables and rows contain individuals. For the sake of simplicity, we will assume here that data are standardized (i.e., the data has l  X  0 and r  X  1, and so the covariance matrix is S  X  1 = nX The first principal component is defined as the linear combination of the variables which has the maximum variance.
Therefore, this first principal component will be represented using a vector z to be found. Since the original values have l  X  0, we have that z
Since S is positive-definite, the variance increases when the module of the vector a solution for the maximization of the expression (1), some constraint on the module of a multiplier has been added to the variance:
To maximize expression (2), the derivative with respect to the a
The solution for such equation is Sa 1  X  k a 1 , which implies that a eigenvalue. To determine which eigenvalue of S is the right solution, Eq. (3) is left-multiplied with a T and its associate eigenvector a 1 defines the coefficients of the projection (PCP). Therefore, the final projected value is
Zscores projection . We assume again that values of the v variables for the n individuals are stored in a matrix X of dimen-sion n v . Given a record (a row)  X  x 1 ; x 2 ; ... ; x v 3.1. Standard score for multivariate microaggregation methods based microaggregation methods, comparing them with a very popular algorithm for multivariate microaggregation, MDAV.
In order to compare them, we have protected two different reference microdata files, proposed in the CASC project [3], with different instances of the three methods, and then we have computed the resulting scores, after having applied the standard tracted using the data extraction system (DES) from the US Census Bureau [4]. This dataset contains 1080 records with 13 Information Authority [29]. It contains 4092 records consisting of 10 attributes (i.e., 40,920 values to be protected).
Tables 1 and 2 show the results of these experiments. Each of the three microaggregation methods has been applied with plied. For example, Mic2Zscore15 refers to the Zscore-microaggregation method applied to blocks of v  X  2 attributes, with microaggregated and removed from the beginning.

The values of DLD, PLD and ID are average values. We have taken into account different cases, according to the number of variables of the original record(s), to be linked, that the intruder knows. This number varies from 2 to the total number of parameterization of each microaggregation method.

For the Census dataset, the best scores are clearly obtained with MDAV; but for the larger EIA dataset, both PCP-micro-aggregation and (specially) Zscore-microaggregation lead to better scores than MDAV. The lowest score using Zscore-micro-aggregation is 16.55 (Mic3Zscore05) while the lowest score using MDAV is 29.15 (Mic3MDAV15). Since MDAV produces in projection-based microaggregation than against MDAV. This difference in the disclosure risk seems to grow up with respect are different datasets, so it is impossible to formally conclude anything from this fact).

Summing up, the two projection-based microaggregation methods can be a real alternative to MDAV in some situations, conclusions are not completely right: we will show some new record linkage methods, specially designed for projection-based microaggregation, which increase the real risk of re-identification (and so, the disclosure risk) of these methods.
Maybe surprisingly, the new methods are also very effective when applied to MDAV. This will result in important changes to the real disclosure risk, and consequently the real score, of all these multivariate microaggregation methods. 4. Projected record linkage and its consequences
Recently, some works have appeared which present ad hoc record linkage techniques, specifically designed for some par-dard record linkage methods like the probabilistic or the distance-based ones. Some examples can be found in the papers [17,19,26] , related to microaggregation and rank swapping.

In some way, the philosophical conclusion of these works is that the standard computations of the disclosure risk (and score) values should be reconsidered, because a smart intruder can find more successful ways to break the privacy of a data protection method, in particular by obtaining more correct links than those obtained when standard record linkage methods are applied. Following this approach, a data protection method would be considered secure if the most effective record-link-the maximum number of correct record links should be obtained in an analytical way, independently of the possible strat-possible ad hoc record linkage techniques for this method, for example by implementing these techniques to compare their success rates with those of standard techniques.

Since we personally think that this approach is the correct one, we have considered an ad hoc record linkage method, (initially) specific for the two projection-based microaggregation schemes studied in this work. In this section we describe this new record linkage technique, and then we show the experimental results that we have obtained when applying it to the
Census and EIA datasets, protected with PCP-microaggregation, Zscore-microaggregation and MDAV. The conclusion is that the real disclosure risk of these three methods is significantly increased. 4.1. The projected record linkage technique record x 0 2 X 0 which corresponds to the original y .

Our new projected record linkage technique (Pro-RL) is specifically designed for the case of microaggregation. Therefore, we can assume that X 0 is implicitly split into r blocks X to perform microaggregation. The algorithm of the projected record linkage method is defined in Algorithm 3. Algorithm 3. Projected record linkage statistical behaviour to the data protection method which transformed X into X mented, which are explained in the following section, show that this intuition is right.

Although we have explained here a version of the projected record linkage technique which is specific for microaggrega-block, independently. We have implemented and run this generic record linkage technique against other protection methods (rank swapping, noise addition) and, differently to what happens in the case of microaggregation, the results do not improve the ones obtained by standard record linkage techniques.

In our opinion, the main reason is that (in general) the protection applied by these methods is done by considering only a microaggregation. Therefore, considering projections of attributes does not make so much sense. 4.2. Experimental results: new disclosure risks and scores
We have executed the two projected record linkage methods (using PCP and Zscores as the inherent projection mecha-roaggregation, Zscore-microaggregation and MDAV, with different parameterizations, to the datasets Census and EIA. Figs. 1 X 3 show the percentage of correct links obtained with different record linkage methods, when applied to both the
Census and EIA datasets, protected with the three multivariate microaggregation schemes that we analyze in this paper ferent scenarios, where the intruder knows different amounts of groups of attributes of the original record(s) to be linked, from 2 to all the groups of attributes.
 The results of these experiments can be summarized as follows:
The new projected record linkage methods obtain, in almost all the cases, more correct links than the other (standard) record linkage methods. The difference is in some cases very significant. For instance, when the Census dataset is pro-tected using the Zscore-microaggregation with v  X  4 and k  X  25 (the most protected configuration) DLD is equal to 5.69, a very small value, and ProLD is equal to 21.85. A similar situation happens with MDAV, if we observe the configu-ProLD is equal to 60.03, much more than 50% of correctly linked records.

Not surprisingly, the most effective record linkage method against PCP-microaggregation is the projected one when PCP is used as the inherent projection, and the same happens with Zscore-microaggregation and Zscores projection. For instance, if we compare the ProLD-PCP and ProLD-Zscore in Fig. 2 we observe that the best method is to apply Zscores projection in the record linkage when the dataset is protected using Zscore-microaggregation.

Using PCP projection in the record linkage method to obtain correct links against Zscore-microaagregation, or vice versa, is not effective at all.
When applied to MDAV, the projected record linkage method using PCP is very effective (more than any other method in the case of Census, and only overcome by probabilistic record linkage in some instances of EIA). However, using Zscores as the inherent projection leads to quite bad results. For example, if we observe the MDAV configuration with v  X  3 and k  X  25 in the Census dataset (Table 3 ), we observe that ProLD is equal to 53.49 while DLD and PLD are equal to 15.86 and 13.36. Here, the ProLD is four times higher than standard record linkage disclosure risks.

Obviously, the fact that the projected record linkage technique has a higher success rate than the other record linkage techniques must have a direct impact in the real disclosure risk (and so, in the score) of the studied multivariate microag-gregation methods.

One possibility is to compute the disclosure risk, again, as the average of the interval disclosure risk (ID) and the record correct links obtained by the projected record linkage technique, using either PCP or Zscores as the inherent projection.
When the protection method is PCP-microaggregation or MDAV, the maximum is obtained by using PCP as the inherent pro-jection for record linkage; when the protection method is Zscore-microaggregation, the maximum is obtained by using Zscores projection.

Another possibility, maybe more realistic, is to assume that the intruder who wants to break the privacy of the protection method knows which is the most successful strategy to find correct links. For example, after reading this paper, he may know that projected record linkage with PCP as the inherent projection is the best known technique to attack PCP-microaggrega-
Therefore, considering other values to compute the linkage disclosure risk would make no sense in this situation; the real linkage disclosure risk would be defined as the maximum among all the linkage disclosure risk values: DLD, PLD, ProLD.
Summing up, there would be two different alternatives to compute the new scores of these methods. In the first one, that
Tables 3 and 4 show the new values of the scores, which strongly depend on the success rate (ProLD) of the new projected record linkage technique. This can be easily verified by comparing the new ScoreNew and ScoreMax with the standard Score, computed by considering only standard (and generic) record linkage techniques. We consider the same parameterizations than in Section 4.2.

After looking at these tables, one can conclude that the real scores of multivariate microaggregation methods are not as are now over the threshold of 50% in many cases, so it is not clear if these methods offer the desired level of privacy. 5. Conclusions and future work
In this paper we have analyzed some multivariate microaggregation methods. Namely, for the two projection-based ones (PCP-microaggregation and Zscore-microaggregation), we have described and implemented the first generic version of them, where not all the attributes must be necessarily microaggregated together. We have computed the standard score of these two methods, to see that they can be competitive when compared to (probably) the most popular scheme for multivariate microaggregation, MDAV.

Then, we have designed a new record linkage technique, called projected record linkage, as an ad hoc tool to find correct links between an original record and protected records, when the applied protection method is a projection-based microag-gregation. The new technique is much more effective than standard techniques (like distance-based or probabilistic record linkage). The most surprising result, however, has been obtained when we have applied the new record linkage technique to
MDAV, because it also overcomes the other record linkage methods in most of the cases. The conclusions of these experi-ments are that the real disclosure risk (and score) of these multivariate microaggregation methods is higher than what was believed up to now. In other words, the level of privacy that they offer is debatable.

As future work, other microaggregation methods [9], less popular than MDAV, or maybe other data protection methods different from microaggregation, could be subjected to the new projected record linkage technique, to see what is its real scope. From a constructive point of view, one should try to design new protection methods (for microaggregation or not) which resist even ad hoc record linkage attacks.
 Acknowledgements Partial support by the Spanish MEC (projects ARES  X  CONSOLIDER INGENIO 2010 CSD2007-00004  X  and eAEGIS  X 
TSI2007-65406-C03-02) and by the Government of Catalonia (Grant 2005-SGR-00093) is acknowledged. Jordi Nin wants to thank the Spanish Council for Scientific Research (CSIC) for his I3P grant.

References
