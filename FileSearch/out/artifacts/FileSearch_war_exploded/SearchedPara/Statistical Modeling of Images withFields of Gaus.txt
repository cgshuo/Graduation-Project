 Many successful methods in image processing and computer vision rely on statistical models for images, and it is thus of continuing interest to develop improved models, both in terms of their ability to precisely capture image structures, and in terms of their tractability when used in applications. Constructing such a model is di ffi cult, primarily because of the intrinsic high dimensionality of the space of images. Two simplifying assumptions are usually made to reduce model complexity. The fi rst is Markovianity : the density of a pixel conditioned on a small neighborhood, is assumed to be independent from the rest of the image. The second assumption is homogeneity : the local density is assumed to be independent of its absolute position within the image. The set of models satisfying both of these assumptions constitute the class of homogeneous Markov random fi elds (hMRFs). Over the past two decades, studies of photographic images represented with multi-scale multi-orientation image decompositions (loosely referred to as  X  X avelets X ) have revealed striking non-Gaussian regularities and inter and intra-subband dependencies. For instance, wavelet coe ffi cients generally have highly kurtotic marginal distributions [1, 2], and their amplitudes exhibit strong cor-relations with the amplitudes of nearby coe ffi cients [3, 4]. One model that can capture the non-Gaussian marginal behaviors is a product of non-Gaussian scalar variables [5]. A number of authors have developed non-Gaussian MRF models based on this sort of local description [6, 7, 8], among which the recently developed fi elds of experts model [7] has demonstrated impressive performance in denoising (albeit at an extremely high computational cost in learning model parameters). An alternative model that can capture non-Gaussian local structure is a scale mixture model [9, 10, 11]. An important special case is Gaussian scale mixtures (GSM), which consists of a Gaussian ran-dom vector whose amplitude is modulated by a hidden scaling variable. The GSM model provides a particularly good description of local image statistics, and the Gaussian substructure of the model leads to e ffi cient algorithms for parameter estimation and inference. Local GSM-based methods represent the current state-of-the-art in image denoising [12]. The power of GSM models should be substantially improved when extended to describe more than a small neighborhood of wavelet co-e ffi cients. To this end, several authors have embedded local Gaussian mixtures into tree-structured MRF models [e.g., 13, 14]. In order to maintain tractability, these models are arranged such that coe ffi cients are grouped in non-overlapping clusters, allowing a graphical probability model with no artifacts in applications such as denoising.
 In this paper, we use a local GSM as a basis for a globally consistent and spatially homogeneous fi eld of Gaussian scale mixtures (FoGSM). Speci fi cally, the FoGSM is formulated as the product of two mutually independent MRFs: a positive multiplier fi eld obtained by exponentiating a homogeneous Gaussian MRF (hGMRF), and a second hGMRF. We develop a parameter estimation procedure, and show that the model is able to capture important statistical regularities in the marginal and joint wavelet statistics of a photographic image. We apply the FoGSM to image denoising, demonstrating substantial improvement over the previous state-of-the-art results obtained with a local GSM model. A GSM random vector x is formed as the product of a zero-mean Gaussian random vector u and an independent random variable z ,as x d = through the integral A key property of GSMs is that when z determines the scale of the conditional variance of x given z , which is a Gaussian variable with zero mean and covariance z  X  . In addition, the normalized variable x  X  The GSM model has been used to describe the marginal and joint densities of local clusters of wavelet coe ffi cients, both within and across subbands [9], where the embedded Gaussian structure a ff ords simple and e ffi cient computation. This local GSM model has been be used for denoising, by independently estimating each coe ffi cient conditioned on its surrounding cluster [12]. This method achieves state-of-the-art performances, despite the fact that treating overlapping clusters as indepen-In this section, we develop fi elds of Gaussian scale mixtures (FoGSM) as a framework for mod-eling wavelet coe ffi cients of photographic images. Analogous to the local GSM model, we use a latent multiplier fi eld to modulate a homogeneous Gaussian MRF (hGMRF). Formally, we de fi ne a FoGSM x as the product of two mutually independent MRFs, where u is a zero-mean hGMRF, and z is a fi eld of positive multipliers that control the local coe ffi -cient variances. The operator  X  denotes element-wise multiplication, and the square root operation is applied to each component. Note that x has a one-dimensional GSM marginal distributions, while its components have dependencies captured by the MRF structures of u and z .
 Analogous to the local GSM, when conditioned on z , x is an inhomogeneous GMRF p ( x | z )  X  where Q u is the inverse covariance matrix of u (also known as the precision matrix ), and D (  X  ) denotes the operator that form a diagonal matrix from an input vector. Note also that the element-wise division of the two fi elds, x To complete the FoGSM model, we need to specify the structure of the multiplier fi eld z .For tractability, we use another hGMRF as a substrate, and map it into positive values by exponentiation, as was done in [10]. To be more speci fi c, we model log( z ) as a hGMRF with mean  X  and precision matrix Q z , where the log operator is applied element-wise, from which the density of z follows as: This is a natural extension of the univariate lognormal prior used previously for the scalar multiplier in the local GSM model [12].
 The restriction to hGMRFs greatly simpli fi es computation with FoGSM. Particularly, we take ad-vantage of the fact that a 2D hGMRF with circular boundary handling has a sparse block-circulant precision matrix with a generating kernel  X  specifying its nonzero elements. A block-circulant ma-trix is diagonalized by the Fourier transform, and its multiplication with a vector corresponds to convolution with the kernel  X  . The diagonalizability with a fi xed and e ffi ciently computed transform makes the parameter estimation, sampling, and inference with a hGMRF substantially more tractable than with a general MRF. Readers are referred to [15] for a detailed description of hGMRFs. Parameter estimation : The estimation of the latent multiplier fi eld z and the model parameters (  X , Q method, which is guaranteed to converge. Speci fi cally, based on the statistical dependency structures in the FoGSM model, the following three steps are repeated until convergence: According to the FoGSM model structure, steps (ii) and (iii) correspond to maximum likelihood estimates of the parameters of hGMRFs, x both steps may be e ffi ciently implemented by exploiting the diagonalization of the precision matrices with 2D Fourier transforms [15].
 Step (i) in (5) may be implemented with conjugate gradient ascent [16]. To simplify description and computation, we introduce a new variable for the element-wise inverse square root of the multiplier: s = 1 The joint density of s is obtained from (4), using the relations between densities of transformed variables, as log p ( s ; Q z , X  ), which is further simpli fi ed into: ascent [16]. Speci fi cally, the negative gradient of the objective function in (8) with respect to s is and the multiplication of any vector h with the Hessian matrix can be computed as:  X  2 log p ( x | s ) p ( s ) Both operations can be expressed entirely in terms of element-wise operations ( and  X  ) and 2D convolutions ( ) with the generating kernels of the two precision matrices  X  u and  X  z , which allows for e ffi cient implementation. We have applied the FoGSM model to subbands of a multi-scale image representation known as a steerable pyramid [17]. This decomposition is a tight frame, constructed from oriented multi-scale derivative operators, and is overcomplete by a factor of 4 K / 3, where K is the number of orientation bands. Note that the marginal and joint statistics we describe are not speci fi c to this decomposition, and are similar for other multi-scale oriented representations. We fi t a FoGSM model to each subband of a decomposed photographic image, using the algorithms described in the previous section. For precision matrices Q u and Q z , we assumed a 5  X  5 Markov neighborhood (corresponding to a 5  X  5 convolution kernel), which was loosely chosen to optimize the tradeo ff between accuracy and over fi tting.
 Figure 1 shows the result of fi tting a FoGSM model to an example subband from the  X  X oat X  image (left panel). The subband is decomposed into the product of the u fi eld (middle panel) and the z fi eld (right panel, in the logarithm domain), along with model parameters Q u ,  X  and Q z (not shown). Visually, the changing spatial variances are represented in the estimated log z fi eld, and the estimated u is much more homogeneous than the original subband and has a marginal distribution close to Gaussian. 1 However, the log z fi eld still has a non-Gaussian marginal distribution and is spatially inhomogeneous, suggesting limitations of FoGSM for modeling photographic image wavelet coe ffi cients (see Discussion).
 The statistical dependencies captured by the FoGSM model can be further revealed by examining marginal and joint statistics of samples synthesized with the estimated model parameters. A sample from FoGSM can be formed by multiplying samples of u and sampling from hGMRF u , and the latter is obtained from the element-wise exponentiation followed by a element-wise square root operation of a sample of hGMRF log z . This procedure is again e ffi cient for FoGSM due to the use of hGMRFs as building blocks [15].
 Marginal distributions : We start by comparing the marginal distributions of the samples and the original subband. Figure 2 shows empirical histograms in the log domain of a particular subband from four di ff erent photographic images (blue dot-dashed line), and those of the synthesized samples of FoGSM models learned from each corresponding subband (red solid line). For comparison, a Gaussian with the same standard deviation as the image subband is also displayed (red dashed line). Note that the synthesized samples have conspicuous non-Gaussian characteristics similar to the real subbands, exempli fi ed by the high peak and heavy tails in the marginal distributions. On the other hand, they are typically less kurtotic than the real subbands. We believe this arises from the imprecise Gaussian approximation of log z (see Discussion).
 Joint distributions : In addition to one-dimensional marginal statistics, the FoGSM model is capa-of photographic images present non-Gaussian dependencies. Shown in the fi rst and the third rows in Fig. 3 are empirical joint and conditional histograms for one subband of the  X  X oat X  image, for samples, two orthogonal orientations and two adjacent scales. Contour lines in the joint histogram are drawn at equal intervals of log probability. Intensities in the conditional histograms correspond to probability, except that each column is independently rescaled to fi ll the full range of intensity. conditional distribution. The latter is indicative of strong non-Gaussian dependencies. For coe ffi -cients that are distant, the dependency becomes weaker and the corresponding joint and conditional histograms become more separable, as would be expected for two independent random variables. Random samples drawn from a FoGSM model, with parameters fi tted to the corresponding subband, tographic images. Shown in the second and the fourth rows of Fig. 3 are the joint and conditional histograms of synthesized samples from the FoGSM model estimated from the same subband as in the fi rst and the third rows. Note that the joint and conditional histograms of the synthesized samples have similar transition of spatial dependencies as the separation increases (column 1,2 and 3), suggesting that the FoGSM accounts well for pairwise joint dependencies of coe ffi cients over a full range of spatial separations. On the other hand, the dependencies between subbands of di ff erent orientations and scales are not properly modeled by FoGSM (column 4 and 5). This is especially true for subbands at di ff erent scales, which exhibit strong dependencies. The current FoGSM model does not exhibit those dependencies as only spatial neighbors are used to make use the 2D hGMRFs (see Discussion). Let y = x + w be a wavelet subband of an image that has been corrupted with white Gaussian noise of known variance. In an overcomplete wavelet domain such as steerable pyramid, the white Gaussian noise is transformed into correlated Gaussian noise w  X  X  w (0 ,  X  w ), whose covariance  X  w can be derived from the basis functions of the pyramid transform. With FoGSM as prior over x , commonly used denoising methods involve expensive high-dimensional integration: for instance, maximum the Bayesian least square estimation,  X  x BLS = E ( x | y ) requires a double high-dimensional integral over x and z . Although it is possible to optimize with these criteria using Monte-Carlo Markov sampling or other approximations, we instead develop a more e ffi cient deterministic algorithm that takes advantage of the hGMRF structure in the FoGSM model. Speci fi cally, we compute and take  X  x as the optimal denoised subband. Note that the model parameters are learned within the inference process rather than in a separate parameter learning step. This strategy, known as partial optimal solution [19], greatly reduces the computational complexity.
 fi xing the others. With fi xed estimates of ( z , Q u , Q z , X  ), the optimization of x is which reduces to argmax x log p ( x | z , y ; Q u ), with the second term independent of x and can be dropped from optimization. Given the Gaussian structure of x given z , this step is then equivalent to a Wiener fi lter (linear in y ). Fixing ( x , Q u , Q z , X  ), the optimization of z is independent of z when conditioned on x . The last term was also dropped since it is also independent tion 2, which can be implemented with e ffi cient gradient descent. Finally, given ( x , z ), the FoGSM model parameters ( Q u , Q z , X  ) are estimated from hGMRFs x second and third step in the algorithm of section 2. However, to reduce the overall computation time, instead of a complete maximum likelihood estimation, these parameters are estimated with a maximum pseudo-likelihood procedure [20], which fi nds the parameters maximizing the product of all conditional distributions (which are 1D Gaussians in the GMRF case), followed by a projection to the subspace of FoGSM parameters that results in positive de fi nite precision matrices. We tested this denoising method on a standard set of test images [12]. The noise corrupted images were fi rst decomposed these into a steerable pyramid with multiple levels (5 levels for a 512  X  512 image and 4 levels for a 256  X  256 image ) and 8 orientations. We assumed a FoGSM model for each subband, with a 5  X  5 neighborhood for fi eld u and a 1  X  1 neighborhood for fi eld log z . These sizes were chosen to provide a reasonable combination of performance and computational e ffi ciency. We then estimate the optimal x with the algorithm described previously, with the initial values of x and z computed from subband denoised with the local GSM model [12]. Shown in Fig. 4 is an example of denoising the  X  X oat X  image corrupted with simulated additive white Gaussian noise of strength  X  = 50, corresponding to a peak-signal-to-noise-ratio (PSNR), of 14 . 15 dB. We compare this with the local GSM method in [12], which, assuming a local GSM model for the neighborhood consisting of 3  X  3 spatial neighbors plus parent in the next coarsest scale, computes a Bayes least squares estimate of each coe ffi cient conditioned on its surrounding neighborhood. The FoGSM denoising achieves substantial improvement ( + 0 . 68 in PSNR) and is seen to exhibit better contrast and continuation of oriented features (see Fig. 4). On the other hand, FoGSM introduces some noticeable artifacts in low contrast areas, which is caused by numerical instability at locations with small z .We fi nd that the improvement in terms of PSNR is consistent across photographic images and noise levels, as reported in Table 1. But even with a restricted neighborhood for the multiplier fi eld, this PSNR improvement does come at a substantial computational cost. As a rough indication, running on a PowerPC G5 workstation with 2.3 Ghz processor and 16 Gb RAM memory, using unoptimized MATLAB (version R14) code, denoising a 512  X  512 image takes on average 4 . 5 hours (results averaging over 5 images), and denoising a 256  X  256 image takes on average 2 . 4 hours (result averaging over 2 images), to a convergenceprecision producing the reported results. Our preliminary investigation indicates that the slow running time is mainly due to the nature of coordinate ascent and the landscape of (9), which requires many iterations to converge. statistics of wavelet coe ffi cients of photographic images. We developed a feasible (although admit-tedly computationally costly) parameter estimation method, and showed that samples synthesized from the fi tted FoGSM model are able to capture structures in the marginal and joint wavelet statis-tics of photographic images. Preliminary results of applying FoGSM to image denoising indicate substantial improvements over the state-of-the-art methods based on the local GSM model. Although FoGSM has a structure that is similar to the local scale mixture model [9, 10], there is a fundamental di ff erence between them. In FoGSM, hGMRF structures are enforced in u and log z , while the local scale mixture models impose minimal statistical structure on these variables. Because of this, our model easily extends to images of arbitrary size, while the local scale mixture models are essentially con fi ned to describing small image patches (the curse of dimensionality, and the increase in computational cost prevent one from scaling the patch size up). On the other hand, the close relation to Gaussian MRF makes the analysis and computation of FoGSM signi fi cantly easier than other non-Gaussian MRF based image models [6, 7, 5].
 We envision, and are currently working on, a number of model improvements. First, the model should bene fi t from the introduction of more general Markov neighborhoods, including wavelet not accounting for these dependencies (see Fig. 3). Secondly, the log transformation used to derive the multiplier fi eld from a hGMRF is somewhat ad hoc, and we believe that substitution of another nonlinear transformation (e.g., a power law [14]) might lead to a more accurate description of the image statistics. Thirdly, the current denoising method estimates model parameter during the process of denoising, which produces image adaptive model parameters. We are exploring the possibility of using a set of generic model parameter learned a priori on a large set of photographic images, so that a generic statistical model for all photographic images based on FoGSM can be built. Finally, there exist residual inhomogeneous structures in the log z fi eld (see Fig. 1) that can likely be captured by explicitly incorporating local orientation [21] or phase into the model. Finding tractable models and algorithms for handling such circular variables is challenging, but we believe their inclusion will result in substantial improvements in modeling and in denoising performance.
