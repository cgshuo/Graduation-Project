 LUKAS MANDRAKE, UMAA REBBAPRAGADA, KIRI L. WAGSTAFF, DAVID THOMPSON, STEVE CHIEN, DANIEL TRAN, ROBERT T. PAPPALARDO, DAMHNAIT GLEESON, Satellite-based remote sensing has opened vast swaths of remote terrain to regular scientific scrutiny. Of particular interest are deserts, ice sheets, mountain ranges, and other nearly or totally inaccessible locales [Goldstein et al. 1993; Rango et al. 1989; Tucker et al. 1991]. These studies and others yield invaluable data on natural and human-induced climate change, seasonal variation, global-scale dynamics, and a host of other relevant inquiries. Missions to other planets employ remote sensing to study targets too distant for direct human observation and analysis. However, the volume of data generated by Earth and remote spacecraft continues to exceed the available downlink bandwidth.

Several approaches have been employed to address this limitation. Data compres-sion enabled the rescue of the science return of the Galileo spacecraft (which experi-enced a high gain antenna deployment failure) [Cheung et al. 1993] and continues to be a mainstay of satellite communication. Cooperation between in-situ spacecraft to relay data over the horizon or to boost transmission bandwidth has now also become possible [Hastrup et al. 2003] and is regularly employed for surface operations such as those of the Mars Exploration Rovers. However, the development of new sensors continues to outpace increases in data throughput capability. Spacecraft now carry hyperspectral cameras capable of sensing hundreds of wavelengths simultaneously in a streaming, real-time manner [Ungar et al. 2003]. Intelligent prioritization of the data for transmission to Earth is needed.

One solution to this problem is to employ onboard data analysis and classification methods that can automatically identify regions of interest. Many such detectors have been created to detect a variety of phenomena such as floods [Ip et al. 2006], vol-canic eruptions [Davies et al. 2003], and dust devils imaged by Mars rovers [Casta  X  no et al. 2008a]. Beyond hand-crafted detectors, machine learning methods such as sup-port vector machines (SVMs) have also been used onboard EO-1 to classify individual pixels into categories such as snow, water, ice, or land [Casta  X  no et al. 2006]. SVMs are desirable for their compressibility into a simple dot product once trained in the linear case, maximizing computational efficiency in tightly constrained on-board envi-ronments. EO-1, for example, employs a 12-MHz Mongoose M5 processor with 4 MIPS and 32 MB memory allocated to on-board science processing.

The Autonomous Sciencecraft Experiment [Chien et al. 2005] is a highly visible, highly successful example of this technology that has demonstrably saved millions of dollars in operational costs and thereby enabled the Earth Observing One (EO-1) spacecraft to continue operating past its nominal end of mission date. We seek the automated detection of surface sulfur deposits, which on Earth have in some instances been linked to microbial activities. Using Borup Fiord as a case study, we evaluated a variety of classification and feature selection methods using data collected by the Hyperion instrument on EO-1.

The primary contribution of this article is a careful description of an important real-world application of machine learning. First, we describe a concrete example of machine learning applied to a domain in which the both the general class of prob-lem (automated interpretation of remotely sensed data) and the specific task (sulfur deposit detection) are of scientific interest (Sections 2 and 3). Second, we provide moti-vation for why a data-intensive, machine learning solution is needed by first attacking the problem with existing spectrum matching (Section 4.1) and endmember analysis (Section 4.2) methods. Third, we show how the sulfur detection problem requires an automated feature selection solution (Section 5). Finally, we discuss the process of subclass discovery and data filtering which ended up providing the key leverage point to achieve good performance at this task (Section 6.3).

Very few of these aspects have been addressed in previous work. The SVM devel-oped for snow/water/ice/land (SWIL) classification [Casta  X  no et al. 2006] addressed an easier classification problem and good performance was achieved by the SVM (sur-passing expert hand-crafted models). However, no automated feature selection was explored as the observing bands were selected by an expert, and no additional data filtering was required again due to the relative simplicity of the task.
 Early work on the use of SVMs for the sulfur detection problem was conducted by Castano et al. using a single Borup Fiord Hyperion scene from 2006 [Casta  X  no et al. 2008b]. Ground truth was provided by in situ collection of field spectra and laboratory spectral analysis of returned samples [Gleeson et al. 2010]. A later study augmented that data set with six subsequent observations that were made in 2007, increasing the generalizability and reliability of the trained classifier [Mandrake et al. 2009]. Neither report addressed the fundamental motivation issue. Finally, Section 7.2 contributes a new discussion of the implications of this study specifically for the study of Europa.
The classifiers described in this work were designed to run onboard the spacecraft to enable fast detection not only for Earth orbiters but also for future missions to remote destinations such as Europa. In a bandwidth-constrained setting, a Europa orbiter would be able to collect more data than it could transmit back to Earth. An onboard classifier could adaptively prioritize the regions of highest interest, including any similar sulfur deposits that could potentially point to sites of endogenous activity. Positive detections can also be used to adaptively replan spacecraft operations, for ex-ample, to target a higher-resolution instrument or conduct more frequent observations of a particular region.
 An example usage case of this method would begin with sample imagery from Europa provided to a ground team for analysis. Experts would employ other meth-ods to discover regions of interest of known or unknown composition as well as regions of disinterest. An SVM classifier would then be automatically generated on the ground as described in this article, designed to detect the presence of these interesting spec-tral features. Finally, the classifier would be uploaded to the Europa orbiter to help it prioritize images in real time that contain features of interest for priority transmis-sion back to Earth and perhaps re-target such areas at higher spatial and spectral resolutions. Set in the far north of the Canadian Arctic Archipelago (81  X  N, 81  X  W), Ellesmere Island abuts the northern edge of Greenland between the Lincoln Sea and Baffin Bay. Like other ice-covered terrain in the solar system, it does not appear at first glance to be particularly hospitable to life. This region was explored in the mid 1990s by Benoit Beauchamp, who collaborated with later investigations in 2006 with Stephen Grasby, Damhnait Gleeson, and Marie-Eve Caron. His initial investigation discovered yellow stains along a glacial edge. These were identified as supraglacial deposits associated with sulfur-rich springs flowing through and across a 200-meter thick glacier [Grasby et al. 2003b]. The telltale yellow stain is due to the presence of elemental sulfur, which dominates the composition of the deposits. The source of these minerals most likely relates to marine evaporite deposits of anhydrite (CaSO4) in the region X  X  bedrock. The various depositional structures and spring locations varied greatly between field cam-paigns. As Borup Fiord Pass is only accessible for three months of the year, the ac-tivation cycles of the springs during the remaining year are not known nor are the conditions that spur their flows.

The springs and their associated deposits show evidence of elemental sulfur, gypsum, and hydrogen sulfide gas. These three compounds contain sulfur in three different oxidation states. The presence of a complex redox system in addition to the high abundance of elemental sulfur (which is not predicted to be thermodynamically stable in the wet, oxygen-rich surface environment) suggested that microbial media-tion of the local geochemistry could be occurring. Exploration of the microbial ecology within the system has detected a rich microfauna including known sulfur cycling mi-croorganisms, while cultivation of microorganisms from this site has demonstrated that members of the community have the capacity to biomineralize sulfur [Gleeson et al. 2011; Grasby et al. 2003a]. This arrangement of fissured permanent ice through which sulfur-rich fluids access the surface and precipitate mineral deposits is poten-tially analogous to the surface of Jupiter X  X  moon Europa. Europa too shows evidence of surface sulfur-bearing mineral deposits on otherwise solid ice along fractures [Carlson et al. 1999]. The reddish-tinged lenticulae (round-shaped regions indicative of en-dogenic activity) and long, stained, double-lined fissures suggest a subsurface ocean likely rich with dissolved minerals [Sotin et al. 2002]. Studying the microbes surviv-ing within the Borup Fiord glacial spring system might therefore also shed light on potential habitats beneath Europa X  X  surface, which would also be subject to low tem-peratures and potentially sulfur-rich conditions. The ability to automatically detect mineral deposits related to endogenic activity from orbit around Europa could greatly assist any future exploration of cryospheric biohabitats. Hyperion is a hyperspectral imager onboard the Earth Observing One spacecraft (EO-1). At a 700-km orbital altitude, Hyperion resolves the Earth X  X  surface to 30 m resolution simultaneously in 220 distinct spectral bands that range from 0.38 to 2.5  X  m (near ultraviolet to short-wave infrared) [Ungar et al. 2003]. The first hyper-spectral sensor to operate from space, it captures 7.5 km by 100 km of surface area with each image. Designed to assist mining, geology, forestry, agriculture, and envi-ronmental management through the classification of surface type and features, it has successfully generated over 27 Tb. of raw data available as various products from the USGS. In this study, we used the L1R Hyperion product, a processed version of the data that reports surface reflectance (as opposed to radiance) to help mitigate such effects as sun angle and reflections.

Our goal was to train a classifier that could accurately detect individual pixels con-taining sulfur. Damnhait Gleeson labeled a collection of pixels from seven Hyperion images using the commercial ENVI toolkit, aerial photos, and the PixelLearn image la-beling software developed by the Machine Learning and Instrument Autonomy Group at the Jet Propulsion Laboratory [Mazzoni et al. 2005]. Each Hyperion image is 256 pixels wide and of variable length (mean 3200 rows); see Figure 1. Table I lists the Hyperion image IDs used along with the number of pixels labeled as sulfur, ice, and rock (the  X  X right X  and  X  X ark X  distinction for sulfur pixels is explained in this arctic). Sulfur is a rare occurrence, and the majority of each image remained unlabeled. The ice and rock labels served to provide non-sulfur examples for training the classifier. To evaluate false positive rates, we also used seven additional Hyperion images of simi-lar size that targeted areas far from the sulfur-bearing glacial springs. These images were selected to cover a variety of polar regions with an environment similar to that of Borup Fiord, but without any known sulfur (see Table II).

An initial exploration of the labeled data shows that separating sulfur-bearing pix-els from nonsulfur pixels is a challenging goal. Figure 2 plots all of the labeled pixels in terms of their reflectance for an arbitrary choice of two of Hyperion X  X  220 wavelengths (similar results were observed for other wavelength pairs). The sulfur pixels are well mixed with the ice pixels, and there is some overlap with the rock pixels as well. Further, two sub-populations are evident in the pixels labeled as sulfur. Note that the  X  X ark Sulfur X  points are especially easy to confuse with rock and similarly dark ice.

We used the k-means clustering algorithm [MacQueen 1967] to automatically refine the labeled sulfur pixels to account for these two subtypes. The two sub-populations were strongly distinguished by their mean reflectance values. We therefore refer to these types as  X  X right Sulfur X  and  X  X ark Sulfur X  pixels and use their k-means labels to separate them in the labeled training data. We have confirmed empirically that this distinction yields better classification performance, and it also permits a more informed analysis of the results. As a starting point, we first compared the pixel spectra observed by Hyperion to the standard USGS lab spectrum for sulfur [Clark et al. 2007]. This spectrum, restricted to the range of wavelengths that Hyperion uses, is shown in Figure 3. It is a mostly flat and bright spectrum across the near-infrared with a steep edge in the visible range.
We computed the degree of sulfur spectrum match for each pixel i as where h i is the vector of Hyperion reflectances observed for pixel i and S is the vector of reflectance values for the sulfur lab spectrum. Figure 4(a) shows an RGB representation of the Borup Fiord area from image EO1H0570012006187110PY. The sulfur spring appears near the center of the image as an outflow from the glacier tongue on the left. Figure 4(b) shows the sulfur spectrum match results for each pixel, in which brightness correlates with a higher degree of match. The highest matches tend to be the icy areas, since ice also has a relatively flat, bright spectrum. The sulfur deposit is not recovered. We note significant instrument noise, with vertical striping due to variabilities across detector elements and high levels of background noise due to single-pixel artifacts at high wavelengths [Pearlman et al. 2003]. Additionally, given Hyperion X  X  30-m spatial resolution it is likely that pixels with sulfur also contain other elements such as ice and rock that preclude a direct matching with the (pure) lab spectrum.

This result suggests two directions for improvement: first, adopting a data-driven approach that adapts sulfur detection to the actual spectra observed, given instru-ment properties and subpixel mixing (addressed next); and second, carefully selecting the most informative and reliable bands for conducting the analysis (addressed in Section 5).
 Our next step was to employ an unsupervised data analysis technique to investigate how separable the sulfur pixels were from the surrounding ice and rock features. Linear endmember detection assumes that spectra are linear combinations of pure materials, and that these minerals combine according to nonnegative mixing coeffi-cients to produce all of the observed spectra in the scene [Keshava and Mustard 2002]. Examples of endmember detection algorithms include Sequential Maximum Angle Convex Cone Analysis (SMACC) [Gruninger et al. 2004], Vertex Component Analysis [Nascimento and Dias 2005], and N-FINDR [Winter 1999]. They compute geometric or statistical properties of the data to determine the endmember spectra without any strong assumptions about the specific classes of materials that are present. They thereby provide an objective test of the prominence of the sulfur signal with respect to the background.

Endmember detection is sensitive to spectral artifacts, so its application to orbital remote sensing requires careful attention to mitigate noise. We employ a superpixel endmember detection approach that incorporates a segmented image representation to help compensate for pixel noise [Thompson et al. 2010]. We begin with a conserva-tive oversegmentation of the scene into contiguous, homogeneous pixel groups. These groups are created by agglomerating pixels together according to a spectral similarity measure. Here a simple Euclidean distance measure informs a graph partitioning segmentation algorithm [Felzenszwalb and Huttenlocher 2004]. The result of the operation is a set of regions that are spatially contiguous and spectrally homogeneous; the new superpixel representation allows the mean spectrum of each superpixel to stand in for the entire region. This provides noise reduction benefits while generating regions of interest for later processing.
 We applied this endmember analysis to a superpixel representation of the same Hyperion image (EO1H0570012006187110PY) to determine whether sulfur would emerge as a distinct endmember. We used the SMACC strategy [Gruninger et al. 2004], which sequentially grows a set of endmembers to maximize the volume of the implied convex cone. This provides a rank ordering of endmembers in terms of their extremity vis a vis the remaining data. Because the sulfur signal was known to occupy visible bands, we focused on this region of the spectrum. Our spectral analysis used only the Hyperion bands in the range 426 to 626 nm. This excluded the lowest frequency channels which generally had more instrument artifacts. Pixels from the sulfur re-gion appeared in the 15th endmember. Figure 5(a) shows a spatial map of where the pixels from the 15th endmember were located (green). Figure 5(b) shows the average spectrum for those pixels, with the USGS lab spectrum for sulfur as a reference. The characteristics of the sulfur spectral signal make it a prominent signal in this data set. However, it also deviates significantly from the pure lab spectrum for sulfur, which is consistent with the lab spectrum matching results presented earlier. The sulfur signal is filtered through the observing instrument X  X  properties, the environmental condi-tions, and subpixel mixing; these factors are all ignored by the endmember detection process.

We conclude that the sulfur signal is strong, but too scene-specific to compare di-rectly with the lab spectrum. Thus we are naturally guided to a supervised classifica-tion solution, which is described next. Supervised classification methods make use of a small collection of expert-labeled data to train a generalized model that can make similar classification decisions on new data. In using the labeled data, rather than lab spectra, we have access to ex-amples of sulfur (and non-sulfur) that is tailored to the instrument and observing conditions.

The classifier we used for this study was the support vector machine (SVM) [Cortes and Vapnik 1995]. SVMs generally provide high performance across a wide range of problems and have been used previously for sulfur classification with Hyperion, al-beit with a very small data set (only 18 labeled sulfur pixels) [Casta  X  no et al. 2008b]. Another relevant benefit (for use onboard a spacecraft) the SVMs provide is their great computational efficiency, especially with linear kernel implementations. An SVM seeks to construct a hyperplane that separates two classes of previously labeled data. A linear kernel SVM is defined by n + 1 parameters: a weight ( w i ) for each of n training examples ( x i ) and a single scalar bias term ( b ). These weights and bias are determined during the training process by solving a quadratic programming problem with one de-gree of freedom: the regularization parameter C which determines how strongly to penalize training errors. Classification of a new example x as positive or negative is achieved by: More expressive solutions can be obtained by replacing the linear dot product with a kernel function K ( x i , x ) that implicitly maps each point into a new (possibility in-finite dimensional) feature space in which linear separability is achievable. For this study, we examined both a linear kernel (simple dot product) and a Gaussian kernel parameterized by  X  , the Gaussian width: The Gaussian kernel generally provides higher accuracy and greater representation power, but it requires significantly more computational effort. It serves in this study as an example of what might be achievable given more spacecraft resources than are generally available on EO-1.

Before presenting classification results using an SVM trained from the expert-provided labeled data, we will next address the second important advance required for this work: an intelligent selection of which of Hyperion X  X  220 observational bands to use when seeking to classify sulfur pixels. Although Hyperion generates 220 bands of hyperspectral data, only 12 (selectable) bands can be passed to the onboard processor for analysis due to architectural limi-tations. Therefore, any onboard classifier faces the dual challenges of choosing which bands are most relevant for its classification goals and then classifying the data as accurately as possible. The instrument exhibits a sharp decrease in data quality at higher wavelengths (band numbers) [Pearlman et al. 2003], so the most reliable bands are likely to be the lower ones.

We employed the following methods for feature selection: (1) Domain expert manual selection based on knowledge and experience. (2) Greedy Forward Feature Selection [Guyon et al. 2002]: Starting with the empty (3) Recursive Feature Elimination (RFE) [Guyon et al. 2002]: Starting with the full (4) RFE based only on the 2006 data [Casta  X  no et al. 2008b]: Same as (2), but using
Each of these methods was applied to the (labeled) Hyperion training data, with the goal of selecting just 12 bands. Table III shows the bands (in terms of their cen-ter observing wavelengths) that were selected by each method, sorted by wavelength. The first four bands were the same for all methods. The final row in the table indi-cates how many of the bands selected were also chosen by the expert. RFE using all seven training scenes showed the strongest agreement with the expert (8 of 12 bands). Bands that were unique to a single selection method are shown in bold. The greedy forward method is distinguished in its use of longer wavelenths (1448, 1791, and 2013 nm).

Figure 6 shows the band choices visually, using a different marker for each fea-ture selection method. The figure also shows the sulfur lab spectrum across the same wavelength range, and the standard deviation observed across the data set at each wavelength. This value serves as a rough proxy for the sensitivity of the Hyperion instrument [Pearlman et al. 2003] and is largely influenced by atmospheric absorption properties. Most of the bands chosen also have high standard deviation values, except for the three highest bands chosen by the Greedy Forward method, all of which have much lower sensitivity. This combined with the high computational cost for the Greedy Forward strategy led us to focus on the other three options for the remainder of this article.

Sequential band selection shows an interesting parallel with many manually de-rived spectral classification rules. Many mineralogical maps exploit specific scalar operators that reveal the presence of specific absorption features. For example, the CRISM spectral summary products include an ISLOPE index [Pelkey et al. 2007] that is sensitive to ferric coatings on dark rock in Mars CRISM images. It is is a scalar value generated by measuring the spectal slope between 1815 and 2530 nm. The algo-rithm estimates the reflectance values R 1815 and R 2530 at each point and computes the numerical slope between them. Other spectral indices compute band depths relative to a continuum value.

The RFE sequential selection algorithm  X  X iscovers X  a similar strategy, choosing clusters of bands that provide reliable estimate reflectances at 436 and 536 nm. In other words, it naturally brackets the sulfur X  X  spectral slope feature. Forcing the band selection process to select fewer than 12 bands tends to alternately add bands to ei-ther side of the dynamic region, refining the effective estimate of the sulfur feature X  X  depth. This oscillation continues until it has exhausted all spectral bands near 436 and 536 nm. This policy is optimal for reducing the uncertainty over the distribu-tion of absorption depths that could have given rise to the observed feature vector. We take our estimate of the two reflectances to be Gaussian-distributed random variables N (  X  a , X  2 a ) at 436 nm and N (  X  b , X  2 b ) at 536 nm. This is reasonable for white instrument noise. After taking i.i.d. measurements X a from the 436 nm region and measurements X b from the 536-nm region, the posterior variance of the reflectance estimates reduces according to the  X  X oot-n X  rule: The depth of the sulfur feature is the difference of the two reference values: This linear combination of Gaussians is also Gaussian-distributed with variance  X  2 = For some constant C , this is equal to the expression: Additional measurements from either side yield diminishing returns for the depth es-timate due to the natural logarithm. For maximum reduction in entropy it is always desirable to allocate measurements to the reflectance term with the least number of previous observations. By alternating between low and high bands, the greedy RFE band selection seeks an  X  X lemental sulfur index X  value representing the best informa-tion gain with respect to the depth of the sulfur absorption feature. It discovers this strategy using only noisy labeled examples of the data, but no other prior information about the spectral characteristics of sulfur.

The number of bands selected (12) is dictated by the architecture of the EO-1 space-craft in this application. It is reasonable to wonder how much performance is lost due to the discarded bands. Figure 7 shows f-measure performance as a function of the number of bands remaining when selected by the RFE method. Recall that RFE starts with all features and then iteratively removes the least useful one. We observe that there is effectively no impact on performance until the number of bands drops below 60. At the selected performance point of 12 bands, the f-measure achieved is 0.86, only 0.04 below the asymptotic performance of 0.90 achieved with the full set of bands. We therefore conclude that there is a little room for improvement if more bands could be used, but the impact to performance is not dramatic in restricting the analy-sis to only 12 bands. Using fewer than five bands, however, would dramatically impact performance. For each of the four 12-band feature sets chosen by these methods, we performed a cross-validation study by training an SVM on the pixels from all but one of the labeled scenes and computing test performance on the pixels from the remaining scene, then averaging results across the test scenes. To evaluate performance, we are interested both in accuracy and in the number of false positives. False detections, if used to trigger followup observations of a target area, can be very expensive, so it is important that they be kept low.

For accuracy, we report the f-measure, which is the harmonic mean of recall (R) and precision (P) [Van Rijsbergen 1979]. Here, L indicates labeled pixels and D indicates detected pixels (the output of the classifier). L and D are subscripted by their type of label (class): I =ice, R = rock, B = bright sulfur, and D = dark sulfur.
 These metrics focus on the accurate detection of the bright sulfur class, which is the one most likely to confidently contain surface sulfur. S correct is the number of correct detections of bright sulfur (whether detected as bright or dark sulfur by the classifier). S missed is the number of missed detections of labeled bright sulfur (identified as any-thing but sulfur), and S false is the number of incorrect bright sulfur identifications (ice or rock identified as bright sulfur).

We also compute two other statistics, both addressing false positives identified out-side the original labeled pixels. Any unlabeled pixels in the seven training images that are detected as sulfur are considered  X  X ikely false positives X  and referred to as Likely FPOS in our graphs. In the absence of a label or ground truth, we cannot know with certainty that there is no sulfur present, but it is extremely unlikely. We also compute the number of Sulfur-Free FPOS , which is the number of pixels in the seven new scenes taken very far from the known sulfur source (images of clouds, opposite hemisphere ice sheets, frozen ocean, etc.). Any putative sulfur detected in the Sulfur-Free images can be confidently considered an error. We explored three different formulations of the sulfur detection problem as a classifi-cation task:  X  Two classes: sulfur (bright and dark) vs. non-sulfur (ice and rock)  X  Three classes: sulfur (bright and dark), ice, rock  X  Four classes: bright sulfur, dark sulfur, ice, and rock For each formulation, we trained a multiclass SVM using a one-vs.-all ensemble of pairwise classifiers. In each case, we used a linear kernel to minimize computational cost, in light of the desired operation of the classifier onboard the EO-1 spacecraft. Later we examine the use of a Gaussian kernel.

The linear SVM has only a single hyperparameter, C , to tune. C trades off penalties for errors on the training data against model complexity; small values permit better generalization while large values more accurately fit the training data. We tested C  X  { 10  X  1 ,..., 10 5 } using 36 values ranging logarithmically.

Figure 8 shows SVM performance results using 2, 3, or 4 classes to define the problem (top, middle, and bottom rows respectively). Each plot shows results for three different band selection strategies (expert pick, RFE old (from 2006, see above), and RFE), for each of the C values tested. The left column plots Likely FPOS against f-measure, while the right column shows Sulfur-Free FPOS against f-measure. The optimal result would be lie at the bottom-right of each graph, with zero Likely Sulfur-Free FPOS (Y) and an f-measure of one (X). Note that the y axis uses a logarithmic scale to report the number of false positives.
 The linear kernel 2-class (sulfur vs. non-sulfur) SVM shows poor performance. While some C values yielded an impressive f-measure of up to 0.80-0.82 for all three band selection strategies, these classifiers also produced more than 104 Sulfur-Free FPOS. Similarly poor generalization occurred in the Likely FPOS of the unlabeled examples from the source image. Thus, though the labeled data was fit, it failed to generalize to more remote examples.

The linear kernel 3-class (ice, rock, and sulfur) SVM achieved an improvement for all three band selections, particularly for the Expert and RFE selected bands. The number of Sulfur-Free FPOS dropped to a mean of  X  40 FPOS per Sulfur-Free image. The number of Likely FPOS remained high, however, with a mean of  X  3400 per image. The mean and maximum f-measure also increased with a new top achievement of 0.86.
The linear kernel 4-class (ice, rock, bright sulfur, and dark sulfur) SVM yielded im-provements in f-measure and mixed results with false positives. The mean f-measure increased to a mean of  X  0.9 and a maximum of 0.96. The number of Sulfur-Free FPOS increased to a mean of  X  70 pixels per image, but the number of Likely FPOS was re-duced to a mean of  X  800 false positives per image. Most of Likely FPOS improvement comes from the decision to define recall and precision in terms of the system X  X  ability to detect only the bright sulfur.
 Any evaluation is only as good as the reference that is used. As we worked with this data, it became clear that some of the labeled pixels were less reliable than others. Manual pixel labeling is a challenging task even for experts. The patterns of labeled pixels in Figure 1 suggest the strategy by which they were labeled, which included broad sweeps of a coarse  X  X aint X  tool across seemingly homogeneous areas for the ice and rock classes. The sulfur pixels were labeled more cautiously by zooming in and marking individual pixels. In all cases, subpixel mixing and unclear boundaries can render these labels noisy.

We therefore conducted an experiment to determine whether the noisy labels could be automatically identified and filtered to improve the quality of the labeled data. We employed Pair-Wise Expectation Maximization (PWEM), a label confidence eval-uation method based on averaging across multiple EM clusterings of the labeled data [Rebbapragada and Brodley 2007; Rebbapragada et al. 2009]. In its general for-mulation, PWEM suggests that improved results may be obtained by permitting a reweighting of input labels based on these results. In this study, we simply filtered out any labeled example with an insufficiently high (0.75) probability of being labeled correctly.

Figure 9 shows the distribution of label correctness probabilities, broken down by pixel type (label). Ice and rock labels proved to be the most reliable (almost all near 1.0). When using the original three classes (bright and dark sulfur grouped together; results not shown in the figure), none of the  X  X ulfur X  pixels had a confidence that ex-ceeded 0.75. Separating these pixels into bright and dark sulfur provided a stark ben-efit: 104 of the 144 bright sulfur labels and 39 of the 91 dark sulfur labels had a confidence at or above 0.75. We then discarded labels with confidence below 0.75, a threshold chosen so as to provide a reasonably confident resulting labeled set with-out decreasing its size too much. The labeled pixels that were removed were largely located near the boundary between ice and rock areas.

Filtering out the likely mislabeled (noisy) items dramatically reduced the number of false positives. Revised results achieved using PWEM to estimate label confidence and then filter the labels are shown in Figure 10. The mean f-measure was unchanged (0.90) while the number of Likely FPOS dropped to  X  600 per image. Sulfur-Free FPOS dropped even further to a mean of 24 pixels per image. While further filtration of the labels might in principle yield further improvements, we had already discarded 40% of our very limited positive examples for the gains shown here, and discarding more would risk overfitting the very small labeled data set. The final part of this study reports on the use of a Gaussian kernel, which provides increased representational power (with respect to a linear kernel) at the cost of ad-ditional computational effort. A second hyper-parameter,  X  , must be specified; this parameter indicates the  X  X idth X  of the exponential expression in Eq. 1. In practical terms, it is not possible for the EO-1 spacecraft to make use of an SVM with a Gaus-sian kernel given processor limitations. However, looking ahead to future missions and technology, we studied this type of classifier in order to understand what benefits it may provide.

Our experiments with the Gaussian kernel used the same C values but also varied the Gaussian width parameter  X   X  X  10  X  2 ,..., 10 3 } by factors of ten. These ranges spanned the empirically observed dynamic region between numeric instability and a failure of the SVM to generalize beyond the training data.

Figure 10 (bottom) shows the result of employing a Gaussian kernel on the PWEM-filtered 4-class data. Results are shown only for the Expert and RFE band selections. The plots encompass a larger number of results due to the additional sweep over values for  X  . The Gaussian SVMs achieved a mean f-measure of 0.93 and maximum f-measure of 0.98, exceeding the best performance of the linear kernel SVM, without sacrificing performance in terms of the Likely and Sulfur-Free FPOS. The experimental results show that a classifier can indeed be trained to detect sulfur-bearing pixels in data collected by the Hyperion instrument onboard EO-1, while ac-commodating the particular computational challenges and constraints imposed by the onboard environment. The best results were achieved by (1) using Recursive Feature Elimination (RFE) to select the 12 bands to use, (2) modeling the problem using four classes by decomposing  X  X ulfur X  into  X  X right sulfur X  and  X  X ark sulfur X  populations, and (3) employing PWEM to filter out likely mislabeled items from the training set.
Automated feature selection is effective on this problem. RFE tended to select bands similar, but not identical, to those chosen manually by an expert, and RFE X  X  bands of-ten yielded higher f-measure performance as well as a smaller number of false positive detections.

Identifying the distinct subpopulations within the sulfur class not only yielded im-proved generalization performance, but it also provides an example of how the result of a machine learning investigation can feed back into the underlying science goals of an investigation. Empirically, the machine learning results indicate that the distinc-tion between sulfur on ice and sulfur on rock is important for creating a reliable model of sulfur in this environment. The use of PWEM to estimate the confidence of each label could provide additional benefits. We employed this information only to filter out unreliable labels, but it could also be used as feedback to the expert who originally created the labels. While reviewing each individual labeled pixel would be exceedingly tedious, it is reasonable to simply review a small number of pixels that were marked as questionable. Then, rather than filtering them out, we could make use of those that the expert considers truly reliable, even if unusual or anomalous with respect to the rest of the training data. The value of PWEM would then be in guiding the  X  X econd look X  efforts of the expert.

The best sulfur classification performance we observed was an f-measure of 0.9 with  X  600 likely false positives per training image and just 24 false positives per sulfur-free image. These results were achieved with a highly efficient linear kernel SVM, which is a classifier that can be run onboard EO-1 in approximately 50 minutes. We also found that a Gaussian SVM could achieve higher performance (f-measure 0.98), but at a computational cost that is unrealistic for use on EO-1 (24 hours to complete). This classifier could however be employed on a future mission with a more capable onboard processor. In this application, false positive detections are very undesirable since detections may be used to schedule costly follow-up observations. We therefore investigated the false positives more closely to help understand their prevalence. Figure 11 shows examples of the false detections obtained from a highly performing classifier. (SVM with Gaus-sian kernel, C = 0.25,  X  = 1000, RFE band selection). The test accuracy achieved by this classifier was an f-measure of 0.83, 0 sulfur-free FPOS, and  X  50 Likely FPOS per image. The left panel of the figure shows the original image in RGB. The middle panel shows the data labels for ice (cyan), rock (yellow), bright sulfur on ice (magenta), and dark sulfur on rock (green). The right panel marks in white all labeled pixels that remain after applying PWEM confidence estimation and filtration, and in red the false detections that comprise the Likely FPOS for this image. These tend to occur in small icy valleys and at glacier edges, which are environmentally similar to the true sulfur locations but do not contain sulfur itself. As noted earlier, the spectra for sulfur and for ice are quite similar.

This analysis highlights a potential weakness in the methodology involved in obtaining labeled data from an expert user. If the labels that are provided include unambiguous examples (such as our ice and rock labels) as well as more challeng-ing examples of a minority class that coexists with ambiguous examples of the other classes, then the trained classifier may learn to highlight  X  X ixed X  areas as being the ones of interest, not those that simply contain the minority class. The results of this terrestrial case study indicate that laboratory spectra of materials collected under ideal conditions can deviate significantly from the spectra of materials as they are observed in the field. Incorporating the experience gained in developing data-derived solutions for the identification of materials of interest to Europa will be particularly valuable, especially given the topographically variable conditions and low signal to noise data sets utilized for the current study. While very smooth at the global scale, the topography of Europa at higher resolution is observed to be highly variable, with successive generations of intersecting linear geologic features recorded across the icy surface in the form of larger ridges and furrows, among countless smaller cracks and lineations. The spatial resolution of current datas ets average 30 km per pixel, and while future missions will improve this resolution, pixels are likely to contain multi-ple materials, complicating spectral signatures. Onboard algorithms that can carry out automated classification could be utilized to intelligently select sites for higher resolution or repeat data collection. Definitive identification of sites of sulfur-rich ma-terials on the surface of Europa related to endogenous activity could be considered as candidates for future landing sites.

