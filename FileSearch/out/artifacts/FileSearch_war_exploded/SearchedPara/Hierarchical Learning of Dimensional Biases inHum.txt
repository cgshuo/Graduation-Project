 Given only a few examples of a particular category, people have strong expectations as to which new examples also belong to that same category. These expectations provide important insights into how objects are mentally represented. One basic insight into mental representations is that objects that have similar observed properties will be expected to belong to the same category, and that expectation decreases as the Euclidean distance between the properties of the objects increases [1, 2].
 The Euclidean distance between observed properties is only part of the story however. Dimensions also play a strong role in our expectations of categories. People do not always generalize isotropi-cally: the direction of generalizations turns out to be centrally important. Specifically, people gen-eralize along the dimensions, such as size, color, or shape  X  dimensions that are termed separable . In contrast, dimensions such as hue and saturation, which show isotropic generalization are termed integral [3] . An illustration of the importance of separable dimensions is found in the time to learn categories. If dimensions did not play a strong role in generalization, then rotating a category struc-ture in a parameter space of separable dimensions should not influence how easily it can be learned. To the contrary, rotating a pair of categories 45 degrees [3, 4] makes it more difficult to learn to discriminate between them. Similarity rating results also show strong trends of judging objects to be more similar if they match along separable dimensions [3, 5].
 The tendency to generalize categories along separable dimensions is learned over development. On dimensions such as size and color, children produce generalizations that are more isotropic than adults [6]. Interestingly, the developmental transition between isotropic and dimensionally biased generalizations is gradual [7].
 What privileges separable dimensions? And why are they acquired over development? One possi-bility is that there is corresponding variation in real-world categories, and this provides a bias that learners carry over to laboratory experiments. For example, Rosch et al. [1] identified shape as a key constant in categories, and we can find categories that are constant along other separable dimensions as well. For instance, categories of materials such as gold, wood, and ice all display a characteristic color while being relatively unconstrained as to the shapes and sizes that they take. Size is often constrained in artifacts such as books and cars, while color can vary across a very wide range. Models of categorization are able to account for both the isotropic and dimension-based components of generalization. Classic models of categorization, such as the exemplar and prototype model, account for these using different mechanisms [8, 9, 10]. Rational models of categorization have accounted for dimensional biases by assuming that the shapes of categories are aligned with the axes that people use for generalization [11, 12, 13]. Neither the classic models nor rational models have investigated how people learn to use the particular dimension basis that they do. This paper presents a model that learns the dimensional basis that people use for generalization. We connect these biases with a hypothesis about the structure of categories in the environment and demonstrate how exposure to these categories during development results in human dimensional biases. In the next section, we review models of categorization and how they have accounted for di-mensional biases. Next, we review current nonparametric Bayesian models of categorization, which all require that the dimensions be hand-coded. Next, we introduce a new prior for categorization models that starts without pre-specified dimensions and learns to generalize new categories in the same way that previous categories varied. We show that without the use of pre-specified dimensions, we are able to produce generalizations that fit human data. We demonstrate that training the model on reasonable category structures produces generalization behavior that mimics that of human sub-jects at various ages. In addition, our trained model predicts the challenging effect of violations of the triangle inequality for similiarity judgments. Models of categorization can be divided into generative and discriminative models  X  we will focus on generative models here and leave discriminative models for the discussion. Generative models of categorization, such as the prototype [8] and exemplar models [9, 10], assume that people learn category distributions, not just rules for discriminating between categories. In order to make a judgment of whether a new item belongs to one category or another, a comparison is made of the new item to the already existing categories, using Bayes rule with a uniform prior on the category labels, where x n is the n th item and c n = j assigns that item to category j . The remaining items are collected in the vector x n  X  1 and the known labels for these items are c n  X  1 .
 For the prototype and exemplar models, the likelihood of an item belonging to a category is based on the weighted Minkowski power metric 1 , which computes the absolute value of the power metric between the new example x n and the cat-egory representation R i for category i on a dimension d . Integral dimensions are modeled with r = 2 , which results in a Euclidean distance metric. The Euclidean metric has the special property that changing the basis set for the dimensions of the space does not affect the distances. Any other choice of r means that the distances are affected by the basis set, and thus it must be chosen to match human judgments. Separable dimensions are modeled with either r = 1 , the city-block metric, or r &lt; 1 , which no longer obeys the triangle equality [5].
 Dimensional biases are also modeled in categorization by modifying the dimension weights for each dimension, w ( d ) . In effect, the weights stretch or shrink the space of stimuli along each dimension so that some items are closer than others. These dimension weights are assumed to correspond to attention. To model learning of categories, it is often necessary to provide non-zero weights to only a few features early in learning and gradually shift to uniform weights late in learning [14]. These generative models of categorization have been developed to account for the different types of dimensional biases that are displayed by people, but they lack means for learning the dimensions themselves. Extensions to these classical models learn the dimension weights [15, 16], but can only learn the weights for pre-specified dimensions. If the chosen basis set did not match that used by people, then the models would be very poor descriptions of human dimensional biases. A stronger notion of between-category learning is required. Rational models of categorization view categorization behavior as the solution to a problem posed by the environment: how best to to generalize properties from one object to another. Both exemplar and prototype models can be viewed as restricted versions of rational models of categorization, which also allow interpolations between these two extreme views of representation. Anderson [11] proposed a rational model of categorization which modeled the stimuli in a task as a mixture of clusters. This model treated category labels as features, performing unsupervised learning. The model was extended to supervised learning so each category is a mixture [17], where x ` is the newest example in a category i and x `  X  1 are the other members of category i . x ` is a mixture over a set of K components with the prior probability of x ` belonging to a component depending on the component membership of the other examples s `  X  1 .
 Instead of a single component or a component for each previous item, the mixture model has the flexibility to choose an intermediate number of components. To make full use of this flexibility, Anderson used a nonparametric Chinese Restaurant Process (CRP) prior on the mixing weights, which allows the flexibility of having an unspecified and potentially infinite number of components (i.e., clusters) in our mixture model. The mixing proportions in a CRP are based on the number of items already included in the cluster, where M j is the number of objects assigned to component k , and  X  is the dispersion parameter. Using Equation 4, the set of assignments s `  X  1 is built up as a simple sequential stochastic process [18] in which the order of the observations is unimportant [19].
 The likelihood of belonging to a component depends on the other members of the cluster. In the case of continuous data, the components were modeled as Gaussian distributions, where the mean and variance of each Gaussian distribution is given by  X  ( d ) and  X  ( d ) respectively. The prior for the mean was assumed to be Gaussian given the variance and the prior for the variance was a inverse-gamma distribution. The likelihood distribution for this model assumes a fixed basis set of dimensions, which must align with the separable dimensions to produce dimensional biases in generalization. The rational model presented above assumes a certain basis set of dimensions, and the likelihood distributions are aligned with these dimensions. To allow the learning of the basis set, we first need multivariate versions of the prior distributions over the mean and variance parameters. For the mean parameter, we will use a multivariate Gaussian distribution and for the covariance matrix, we will use the multivariate generalization of the inverse-gamma distribution, the inverse-Wishart distribution. The inverse-Wishart distribution has its mode at  X  m + D +1 , where  X  is the mean covariance matrix parameter, m is the degrees of freedom, and D is the number of dimensions of the stimulus. A covariance matrix is always diagonal under some rotated version of the initial basis set. This new basis set gives the possible dimensional biases for this cluster.
 However, using Gaussian distributions for each cluster, with a unimodal prior on the covariance matrix, greatly limits the patterns of generalizations that can be produced. For a diagonal covariance matrix, strong generalization along a particular dimension would be produced if the covariance matrix has a high variance along that dimension, but low variances along the remaining dimensions. Thus, this model can learn to strongly generalize along one dimension, but people often make strong generalizations along multiple dimensions [5], such as in Equation 2 when r &lt; 1 . A unimodal prior on covariance matrices cannot produce this behavior, so we use a mixture of inverse Wishart distributions as a prior for covariance matrices, where  X  k is the covariance parameter for the k th component. For simplicity, the component param-eters  X  k are assumed i.i.d. given their class.  X  j are the parameters of component j which reflect the expected covariances generated by the j th inverse-Wishart distribution in the mixture. u k = j is the assignment of parameters  X  k to component  X  j and the set of all other component assignments is u k  X  1 .  X  and  X  k are the sets of all  X  j and  X  k . The means of categories k have Gaussian priors, which depend on  X  k , but are otherwise independent of each other.
 As before, we will use a nonparametric CRP prior over the mixture weights u k . We now have two infinite mixtures: one that allows a category to be composed of a mixture of clusters, and one that allows the prior for the covariance matrices to be composed of a mixture of inverse-Wishart distributions. The final piece of the model is to specify p ( X ) . We use another inverse-Wishart prior, but with an identity matrix for the mean parameter, so as not to bias the  X  j components toward a particular dimension basis set. Figure 1 gives a schematic depiction of the model. The categories we learn during development often vary along separable dimensions  X  and people are sensitive to this variability. The linguistic classification of nouns helps to identify categories that are fixed on one separable dimension and variable on others. Nouns can be classified into count nouns and mass nouns. Count nouns refer to objects that are discrete, such as books, shirts, and cars. Mass nouns are those that refer to objects that appear in continuous quantities, such as grass, steel, and milk. These two types of nouns show an interesting regularity: count nouns are often relatively similar in size but vary greatly in color, while mass nouns are often relatively fixed in color but vary greatly in size.
 Smith [7] tested the development of children X  X  dimensionality biases. In this study, experimenters showed participants six green circles that varied in shade and size. The discriminability judgments of adults to scale the parameters of the stimuli, so that one step in color caused the same gain in dis-criminability as one step in size. Participants were asked to group the stimuli into clusters according Figure 1: Schematic illustration of the hierarchical prior over covariance matrices. The top-level prior is a covariance matrix (shown as the equiprobability curves of a Gaussian) that is not biased towards any dimension. The mid level priors  X  j are drawn from an inverse-Wishart distribution centered on the top-level prior. The  X  j components are used as priors for the covariance matrices for clusters. The plot on the right shows some schematic examples of natural categories that tend to vary along either color or size. The covariance matrices for these clusters are drawn from an inverse-Wishart prior using one of the  X  j components. to their preferences, only being told that they should group the  X  X nes that go together X . The parti-tions of the stimuli into clusters that participants produced tended toward three informative patterns, shown in Figure 2. The Overall Similarity pattern ignores dimension and appears to result from isotropic similarity. The One-dimensional Similarity pattern is more biased towards generalizing along separable dimensions than the Overall Similarity pattern. The strongest dimensional biases are shown by the One-Dimensional Identity pattern, with the dimensional match overriding the close isotropic similarity between neighboring stimuli.
 Children aged 3 years, 4 years, 5 years and adults participated in this experiment. There were ten participants in each age group, participants clustered eight problems each, and all dimension-aligned orientations of the stimuli were tested. Figure 2 shows the developmental trend of each of the infor-mative clustering patterns. The tendency to cluster according to Overal Similarity decreased with age, reflecting a reduced influence of isotropic similarity. Clustering according One-dimensional Similarity increased from 3-year-olds to 5-year-olds, but adults produced few of these patterns. The percentage of One-dimensional Identity clusterings increased with age, and was the dominant re-sponse for adults, supporting the idea that strong dimensional biases are learned.
 We trained our model with clusters that were aligned with the dimensions of size and color. Half of the clusters varied strongly in shape and weakly in size, while the other half varied strongly in size and weakly in shape. The larger standard deviation of the distribution that generated the training stimuli was somewhat smaller than the largest distance between stimuli in the Smith experiment, while the smaller standard deviation in the distribution that generated the training stimuli was much smaller than the smallest distance between Smith stimuli. The two dispersion parameters were set to 1, the degrees of freedom for all inverse-Wishart distributions were set to the number of dimensions plus 1, and 0.01 was used for the scale factor for the mean parameters of the inverse-Wishart distributions 2 .
 Inference in the model was done as a combination of the Gibbs sampling and Metropolis-Hastings algorithms. The assignments of data points to clusters in each class were Gibbs sampled conditioned on the cluster assignments to inverse-Wishart components and the parameters of those components,  X  . Following a complete pass of the assignments of data points to clusters, we then Gibbs sam-pled the assignments of the cluster covariance parameters  X  k to components of the inverse-Wishart Figure 2: Experiment 2 of Smith [7]. In a free categorization task, the stimuli marked by dots in the top row were grouped by participants. The three critical partitions are shown as circles in the top row of plots. The top bar graph displays the developmental trends for each of the critical partitions. The bottom bar graph displays the trend as the model is trained on a larger number of axis-aligned clusters. mixture prior. After a pass of this mid-level sampling, we resampled  X  j , the parameters of the inverse-Wishart components, and the prior expected means of each cluster. This sampling was done using Metropolis-Hastings, with the non-symmetric proposals made from a separate inverse-Wishart distribution. A large finite Dirichlet distribution was used to approximate p ( U ) . Given the learned  X  and u k , the predicted probabilities for the Smith experiment were computed exactly. The predictions of our model as a result of training are shown in Figure 2. The model was trained on 0, 2, 4, 8, and 16 axis-aligned clusters in an unsupervised fashion. For the all three patterns, the model shows the same developmental trajectory as human data. Overall Similarity decreases with the number of trained categories, One-dimensional Similarity increases and then decreases, and One-dimensional Identity patterns are overwhelmingly produced by the fully trained model. The probabilities plotted in the figure are the predicted posterior of only the partitions that exactly matched the informative patterns, out of all 203 possible partitions, showing that the patterns in Figure 2 dominated the model X  X  predictions as they dominated the participants X  responses in the free categorization task. Standard models of categorization, such as the prototype or exemplar model, have a variety of mech-anisms for producing the dimensional biases seen in experiments with adults. We propose a very different explanation for these dimensional biases. In this section we plot generalization gradients, Figure 3: Generalization gradients of the exemplar model and the posterior predictive distribution of the model presented in this paper. The dots are the stimuli. which provide a good feel for how the priors we propose match with the mechanisms used in earlier models across a variety of conditions.
 Generalizations of single items are studied by collecting similarity ratings. In this task, participants judge the similarity of two items. In standard models of categorization, similarity ratings are mod-eled mainly by the exponent in the Minkowski power metric (Equation 2). For rational models, similarity ratings can be modeled as the posterior predictive probability of one item, given the sec-ond item [20]. The first two columns of Figure 3 give a comparison between the exemplar model and the model we propose for similarity ratings. The central dot is a particular stimulus and the color gradient shows the predicted similarity ratings of all other stimuli. For integral dimensions, a Euclidean metric ( r = 2 ) is used in the exemplar model, which the model we propose matches if it has not been trained on dimension-aligned categories.
 For separable categories, the exemplar model usually uses a city-block metric ( r = 1 ) [10]. How-ever, experimental evidence shows that dimensions have an even stronger effect than predicted by a city-block metric. In experiments to test violations of the triangle equality, Tversky and Gati [5] showed that the best fitting exponent for similarity data is often r &lt; 1 . The model we propose can produce this type of similarity prediction by using a prior that is a mixture of covariance matrices, in which each component of the mixture generalizes strongly along one dimension. In a category of one item, which is the case when making similarity judgments with the posterior predictive dis-tribution, it is uncertain which covariance component best describes the category. This uncertainty results in a generalization gradient that imitates an exponent of r &lt; 1 using Gaussian distributions. As a result, our proposed model predicts violations of the triangle inequality if it has been trained on a set of clusters in which some vary strongly along one dimension and others vary strongly along another dimension. A comparison between this generalization gradient and the exemplar model is shown in the second column of Figure 3.
 The second mechanism for dimensional biases in standard models of categorization is selective attention. Selective attention is used to describe biases that occur in categorization experiments, when many items are trained in each category. These biases are implemented in the exemplar model as weights along each dimension, and early in learning there are usually large weights on a small number of separable dimensions [14, 21]. Our proposed model does not have a mechanism for selective attention, but provides a rational explanation for this effect in terms of the strong sampling assumption [13]. If two items are assumed to come from the same cluster, then generalization tends to be along a single dimension that has varied during training (third column of Figure 3). However, if two items are inferred to belong to different clusters, then the generalization gradient corresponds to additive similarity without selective attention (fourth column of Figure 3).
 We have shown that the model we have proposed can reproduce the key generalization gradients of the exemplar and prototype models. The important difference between our model of dimensional biases and these standard categorization models is that we learn basis set for dimensional biases, assuming these dimensions have proven to be useful for predicting category structure in the past. Other models must have these dimensions pre-specified. To show that our model is not biased towards a particular basis set, we rotated the training stimuli 45 degrees in space. The resulting posterior predictive distributions in Figure 3 extendend in the same direction as the rotated training categories varied. The approach to dimensional biases we have outlined in this paper provides a single explanation for dimensional biases, in contrast to standard models of categorization, such as exemplar and prototype models. These standard models of categorization assume two distinct mechanisms for producing di-mensional biases: a Minkowski metric exponent, and attentional weights for each dimension. In our approach, biases in both similarity judgments and categorization experiments are produced by learning covariance matrices that are shared between clusters. For similarity judgments, the single item does not give information about which covariance mixture component was used to generate it. This uncertainty produces similarity judgments that would be best fit with an Minkowski exponent of r &lt; 1 . For category judgments, the alignment of the items along a dimension allows the gen-erating covariance mixture component to be inferred, so the judgments will show a bias like that of attentional weights to the dimensions. The difference between tasks drives the different types of dimensional biases in our approach.
 We propose that people learn more complex cross-category information than most previous ap-proaches do. Attention to dimensions is learned in connectionist models of categorization by find-ing the best single set of weights for each dimension in a basis set [15, 16], or by cross-category learning in a Bayesian approach [22]. A more flexible approach is used in associative models of categorization, which allow for different patterns of generalizations for different items. One asso-ciative model used a Hopfield network to predict different generalizations for solid and non-solid objects [23]. A hierarchical Bayesian model with very similar properties to this associative model motivated this result from cross-category learning [24]. The key difference between all these models and our proposal is that they use only a single strong dimensional bias for each item, while we use multiple latent strong dimensional biases for each item, which is needed for modeling both similar-ity and categorization dimensional biases with a single explanation. The only previous approach we are aware of that learns such complex cross-category information is a Bayesian rule-based model of categorization [25].
 The main advantage of our approach over many other models of categorization is that we learn the basis set of dimensions that can display dimensional biases. Our model learns the basis the same way people do, from categories in the environment (as opposed to fitting to human similarity or category judgements). We begin with a feature space of stimuli in which physically similar items are near to each other. Using a version of the Transformed Dirichlet Process [26], a close relation to the Hierarchical Dirichlet Process previously proposed as a unifying model of categorization [17], a mixture of covariance matrices are learned from environmentally plausible training data. Most other models of categorization, including exemplar models [10], prototype models [8], rule-based discriminative models [27], as well as hierarchical Bayesian models for learning features [24, 22] and Bayesian rule-based models [25] all must have a pre-specified basis set. People generalize categories in two ways: they generalize to stimuli with parameters near to the category and generalize to stimuli that match along separable dimensions. Existing models of cat-egorization must assume the dimensions to produce human-like generalization performance. Our model learns these dimensions from the data: starting with an unbiased prior, the dimensions that categories vary along are learned to be dimensions important for generalization. After training the model with categories intended to mirror those learned during development, our model reproduces the trajectory of generalization biases as children grow into adults. Using this type of approach, we hope to better tie models of human generalization to the natural world to which we belong.
