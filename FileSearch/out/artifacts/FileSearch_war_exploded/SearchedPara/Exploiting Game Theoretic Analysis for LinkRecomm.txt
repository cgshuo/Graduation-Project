 The popularity of Online Social Networks (OSNs) has attracted great research interests in different fields. In Economics, re-searchers use game theory to analyze the mechanism of network formation, which is called Network Formation Game. While in Computer Science, much effort has been done in building machine learning models to predict future or missing links. However, there are few works considering how to combine game theoretic analysis and machine learning models. Therefore, in this paper, we study the problem of Exploiting Game Theoretic Analysis for Link Rec-ommendation in Social Networks. Our goal is to improve link rec-ommendation accuracy via leveraging the power of Network For-mation Games into machine learning models. We present two dif-ferent approaches to solve this problem. First, we propose a three-phase method that straightforwardly combines game theoretic anal-ysis with machine learning models. Second, we develop a unified model, BPRLGT , that incorporates Network Formation Game into a Bayesian ranking framework for link recommendation. Specifi-cally, BPRLGT takes advantage of network topology and we design a game theoretic sampling approach to improve its training pro-cess. The experiments are conducted on four real world datasets and the results on all datasets demonstrate that both our proposed three-phase method and the unified ranking model outperform the baseline methods.
 H.4 [ Information Systems Applications ]: Miscellaneous Algorithms, Experimentation, Performance Game Theory; Network Formation Game; Link Prediction c  X 
Online social networks (OSNs) play an important role for people to satisfy their social needs and seek novel information on Internet. As shown by recent studies, there are over 5.7 billion users on the world X  X  top 21 social networks and 72% of all Internet users are active on social media for sharing feelings, posting pictures and most importantly, making friends. Such popularity has attracted great research interests from different fields.

In Economics, a popular research direction is to use game theory to study the mechanism of the formation of social networks, which refers to Network Formation Game (NFG). Typically, in NFG mod-els, utility functions are defined to represent how much utility peo-ple can gain from their connected neighbors and the models assume that people build social links in order to maximize their utility. Here utility represents the benefit or profit for people. Based on NFG, economic researchers try to investigate the following prob-lems: 1) given a specific social network, how to find the particular utility functions that can explain why people form such a network; 2) how different definitions of utility function can trigger people to form different social networks in order to maximize their utility. To answer these questions, several possible modeling approaches are proposed, including simultaneous move modeling, pairwise-stability modeling [16], bargaining for network formation [8], dy-namic modeling [31], farsighted network formation modeling [11], etc.. However, most of these works focus on explaining the forma-tion of current network and cannot be directly used for link predic-tion.

While in Computer Science, much effort has also been done for social network analysis, especially in predicting new links for people. Many methods are proposed to solve this problem. Sev-eral atomic propagation models are proposed in [12] such as di-rect propagation, co-citation propagation, transpose propagation and coupling propagation for trust link prediction. Leskovec et al. [21] leverage the topological feature of a social network to pre-dict the trust and distrust relations among users. Tang et al. pro-pose a method for link prediction by capturing the evolution of trust in [34]. Guha et al. propose a framework for modeling trust propa-gation [12]. Dong et al. [10] design a factor graph method to predict trust links between users across heterogeneous networks. While the existing methods can learn the network and predict links to users, none of them consider how users X  utility change when building the recommended links.
 Therefore, in this paper, we study the problem of Exploiting Game Theoretic Analysis for Link Recommendation in Social Net-works . The goal is to improve link recommendation (link pre-diction) accuracy via leveraging the power of Network Formation Games (NFG). However, there are several challenges when com-bining game theoretic models and link prediction models. First, most of the NFG models focus on explaining the formation of cur-rent networks and assume that no users can further improve their utility through building new links. This assumption conflicts the goal of link prediction models. Second, the goals of NFG analysis and link prediction models are different. NFG models aim to max-imize users X  utility value while the goal of link prediction models is to maximize the accuracy of link recommendation. To our best knowledge, there is no work investigating the connections between the two goals. Third, no existing link prediction models consider the utility analysis when training, how to integrate utility analysis into model training is a challenging problem.

To address these challenges, in this paper, we first conduct an empirical study to investigate how well NFG models describe the formation mechanism of real networks. Then we propose a three-phase approach that leverages the power of game theory into link prediction models. Given a social network G , the first phase em-ploys NGF models to calculate an original utility value of each user in G ; at the second phase, link prediction models are used to find the candidate links; after adding the candidate links to G , the third phase then calculates users X  utility via NFG models again and uses the utility difference based on the current and original utility as a criterion to help re-rank the candidate links. In particular, the links which are highly-ranked by link prediction models but cannot im-prove the utility of connected users will be re-ranked to a lower priority for final recommendation.

Although the three-phase method provides a simple way to com-bine NFG models and machine learning models, it processes the knowledge from NFG models and machine learning models in sep-arated steps. In particular, NFG models have no contribution when training machine learning models and no utility information is con-sidered when generating candidate links.

To alleviate these problems and better integrate NFG models into machine learning models, we further propose a novel unified pair-wise ranking model, namely, BPRLGT ( B ayesian P ersonalized R anking for L ink recommendation with G ame T heory), integrat-ing NFG models into a Bayesian ranking model for link recommen-dation. Our model is built based on Bayesian Personalized Rank-ing framework (BPR) [27], which always requires sampling tech-nique to select training data. In BPRLGT, we emphasize on design-ing a game theoretic sampling approach to improve model train-ing. More specifically, different from uniformly sampling and other heuristic sampling approaches [29] such as popularity-based sam-pling, etc., the proposed game theoretic sampling approach consid-ers users X  utility and helps the model punish the links that cannot in-crease users X  utility but with high-rank. Moreover, BPRLGT model also takes network topology into account, which makes BPRLGT more suitable for link prediction.

We conduct experiments on four real world social network datasets and the results show that our proposed three-phase method and the unified model consistently outperform other state-of-the-art methods.
 Organization. In Section 2, we discuss the related work. In Sec-tion 3, we provide the background and then formulate the problem ; Section 4 details the proposed three-phase method and the unified ranking model with the game theoretic sampling technique. Sec-tion 5 demonstrates the experimental results and verifies the contri-bution of integrating game theoretical analysis into link prediction problems. Finally, Section 6 concludes the paper. In this section we review the related work, regarding the Network Formation Game, link prediction in social network, as well as one-class recommendation problem.
 Network Formation Game. Recent years, Game Theory [5, 17, 18, 22] has been used to investigate people X  X  behaviors and social relations in social networks. Typically, a utility function is defined to represent people X  X  utility in a social network. By analyzing pa-rameters in utility function and the network structure, researchers try to explain the mechanism of the network formation. We refer readers to [14] and [15] for a detailed survey of models in Network Formation Games. Xiao et al. [35] formulate the wireless secu-rity problem as an indirect reciprocity game, and propose a method that applies the indirect reciprocity principle to suppress attacks in wireless networks. In [16], the authors study the stability and efficiency of social and economic networks. Bramoulle et al. [7] provide a general network analysis to a wide class of games, in-cluding strategic innovation, public goods and social interactions. Mele [23] analyzes the network formation by a dynamic meeting protocol and Badev [2] further extends the model. Paula et al. [26] provide a framework to learn parameters of utility function in net-work formation models.
 Link Prediction. A large number of studies about link predic-tion [9, 36, 32, 1, 34] have been proposed based on either similar-ity analysis or propagation analysis. Siegler et al. point out that there is a strong and significant correlation between trust link and similarity [39] and then use the similarity for link prediction. Guha et al. propose a framework for modeling trust propagation [12]. Leskovec et al. utilize the topological feature of a social network to predict the trust and distrust relations among users[21]. Tang [32] et al. exploit homophily effect for link prediction. Lee et al. [20] develop an integer programming problem for the link prediction problem. Besides the machine learning models, some game theory-based methods are also proposed for link prediction, but they all need some additional information, such as users X  rating or tagging behavior on items, to help define the game parameters. Zappella et al. [37] present a Graph Transduction Game for link prediction and Beigi et al. [6] also employ a game theoretic approach for commu-nity detection and link prediction. Few work considers to integrate game theory models into machine learning models to improve the accuracy on link prediction.
 One-class Recommendation. One-class recommendation focus on solving recommendation problems when one can only observe some forms of users X  implicit feedback from data, typically binary feedback, such as the webpages they browse, the music they listen to, the link they click or whom they make friend with. We view users X  observed feedback as positive feedback and others as nega-tive feedback. In this paper, we cast link prediction as an one-class recommendation problem since we can only observe users X  positive feedback (existing links) and aim at predicting missing or future links. Several works have studied one-class recommendation and can be mainly divided into two branches: pointwise methods [13, 25] and pairwise methods [27, 30]. Pointwise methods aim to fit a numeric value associated with each evaluated item, while pairwise methods focus on modeling the order, or ranking of the feedback. Pairwise methods always consider implicit feedback as relative re-lationships indicating that users show higher preference on positive feedback than on negative feedback. In [27], Rendle et al. propose a bayesian personalized ranking ( BPR ) framework. Following this, various ideas have been proposed that incorporate different types of contextual information into the BPR framework. [19] extends the BPR framework to model both users X  feedback on items and on their social relations. In [38], Zhao et al. leverage social connec-tions to improve item recommendations by building a new prefer-ence system. Since the learning method used in most related works is stochastic gradient descent (SGD), how to select the training in-stances has great impact on model performance. In [29], the au-thors propose two strategies to sample negative feedback and also design an efficient implementation to improve the convergence of the learning algorithm.
 Summary. Our proposed methods differentiate themselves from all these existing methods in that the study of incorporating game theoretic analysis into machine learning models is unexplored in previous work.
In this section, we first present several notations and definitions used in the paper and then detail two Network Formation models, Co-author model and Linear Best Reply model, which will be used in our proposed methods. We analyze the property of Network For-mation models and then formally define the problem of Exploiting Game Theoretic Analysis to Improve Link Recommendation in So-cial Networks .
Let G = ( V,E ) denote the social network, where V is a set of | V | = M users and E  X  V  X  V is a set of links between users. G can be either directed or undirected. N i represents the directed neighbors of user i in graph G . e ij  X  E ( G ) means there is a direct link between user i and j in G and e ij /  X  E ( G ) represents that there is no direct link between the two users. Given a network G and e ij /  X  E , let G + e ij denote the network formed by adding the link e ij to the network G , and G /e ij denote the network formed by deleting the link e ij from the network G . I denotes the identity matrix, 1 denotes a vector of ones, A T denotes the transpose of matrix A and det ( A ) represents the determinant of matrix A . We also have the following concept definitions.

Definition 1. Action : Actions in this paper are defined as user X  X  behaviors to build social relations with others. In particular, given G , each user i  X  X  action can be represented as x i the j th entry in x i equals to 1 if e ij  X  E and 0 otherwise. Let x =  X  x 1 ,x 2 ,...,x M  X  denote the action vector for all users and x  X  i =  X  x 1 ,x 2 ,...,x i  X  1 ,x i +1 ,...,x M  X  denote the action vector of all users other than i .

Definition 2. Individual utility : The individual utility repre-sents the profit, quantity or "utility" in result of user X  X  actions. Typ-ically, it can be constructed as the value of a utility function, U (  X  ) . In this paper, we assume that users X  utility will change only when G changes and only building new links or deleting existing links will affect users X  utility. Let U ( x i ; x  X  i ,G ) denote the utility function to calculate user i  X  X  utility value in network G since G is formed by action vector x . For simplicity, we use U i ( G ) or U user i  X  X  utility value in social network G .

Definition 3. Utility difference : Utility difference of user i ,  X  describes the difference when user i builds some new links. Specif-ically, given G and a set of recommended links, { e ij } /  X  E ( G ) ,  X  i = U i ( G + { e ij } )  X  U i ( G ) . If  X  i  X  0 , we conclude that e is a beneficial link for user i . In particular, for a recommended link e ij /  X  E ( G ) , if  X  i  X  0 and  X  j  X  0 , we call e ij a mutual consent link .
 In game theory, the most important concept is Nash Equilibrium, which describes a solution concept of a Network Formation Game such that no player in the game can gain more by changing only their own actions. Here we also introduce the Nash Equilibrium concept used in Network Formation Games.
 Definition 4. Nash Equilibrium : An action vector x is a Nash Equilibrium if and only if for all users i , This definition shows that for user i , his/her utility cannot increase by changing his/her action from x i to x 0 i . In fact, Nash Equilib-rium describes the optimal utility that users can gain in network G . Based on the definition of action, we can see that the network G is the result of users X  actions and given a network G , we can calculate users X  utility based on U (  X  ) . In this paper, we aim to im-prove link recommendation accuracy by considering the utility that users will gain from building the recommended links. Specifically, given a network G and a set of recommended links { e ij } , we first assume that both G and G + { e ij } reach Nash Equilibrium, then we can obtain the optimal utilities, U i ( G ) and U i ( G + { e each user i on G and G + { e ij } . More importantly, we can then judge whether { e ij } should be recommended to people based on  X  i = U i ( G + { e ij } )  X  U i ( G ) : if  X  i  X  0 for user i , then we conclude that { e ij } should be recommended; otherwise, we should not recommend them to people since people cannot increase their utilities by building them. In this section, we first formally define the Network Formation Game and then present several utility functions that are widely used in NFG. Following that, we analyze their properties when reaching Nash Equilibrium.

A Network Formation Game (NFG) in game theory is always used to analyze user X  X  discretion when they build links in social network and it can be represented by a triple ( G , U , U (  X  ) ), where U =  X  U 1 ( G ) ,...,U i ( G ) ,...,U M ( G )  X   X  R M records users X  utili-ties in G and U (  X  ) is the utility function which defines how utilities are allocated across the users when they build a particular network. The key component of NFG is to find a proper utility function and ensure that it could explain why users build such a particular net-work. Specifically, the utility function describes the utilities that users directly receive, taking both benefit and cost of maintaining their social links into account. Different utility functions lead to different models in NFG and also motivate users to set up different network structures. The goal of NFG is to analyze users X  utilities when assuming the given network G reach a Nash Equilibrium. In the following subsection, we will introduce two popular NFG mod-els, Co-author model and Linear Best-Response model in details. The Co-author Model. The Co-author model [16] is firstly proposed to describe the collaboration relationship between re-searchers. Each user in this model is assumed to own a fixed
Algorithm 1 : Utility calculation in LBR. G S denotes the sub-graph of G connecting the selected users S and G V  X  S denotes the graph of links connecting users S to the rest users. U denotes the utility vector when users S are selected to estimate the Nash Equilibrium in network G . amount of time to spend or pay, so the time user i spends on each collaboration is inversely related to the number of links he/she has, say n i = | N i | . The utility of user i is represented by Here we can see that the more links user i has, the lower synergy he/she could gain from this link. Note that there is no direct cost modeling, but the diluted gains reflect the cost when user builds too many links with others. Given G , users X  utilities can be directly calculated from Eq (1). In this way, when considering to build new links, user i needs to think about the utility difference after they constructing these links. Specifically, when user i considers to make friends with user k , the utility difference can be estimated as If  X  i  X  0 , we conclude e ik as a beneficial link to user i since it could increase i  X  X  utility.
 The Linear Best-Response Model. In Linear Best Response (LBR) model [7], vector U is used to represent users X  effort on network G , u is the required efforts that each user needs take in isolation; for each user i , his/her effort can be calculated as follow-ing, U ( G ) = where  X  is a measure of how much user i  X  X  directed neighbors af-fect his/her efforts. Thus, user i achieves his/her required efforts u through combining his/her own effort and his/her friends X  efforts. From this definition, we find that the more efforts user i  X  X  neighbors could offer, the less effort user i herself would take. In LBR model, each user wants to minimize his/her own efforts while reaching the required u by others.

LBR model captures the property of several exemplary games in-cluding network formation game. For example, researchers benefit from the results of experiments done by their collaborators, which Figure 1: Empirical analysis of Network Formation Models. We investigate how much different network formation models can capture the real network evolution from benefit perspec-tive. We include a random setting for clear comparison. Y-axis represents the probability that Network Formation Game mod-els precisely capture the beneficial links. explains the formation of academic collaboration networks; peo-ple in Facebook learn more by the sharings of their friends, which explains the formation of social networks.

Accordingly, user i  X  X  utility function then can be equivalently represented as Equation (3) can be obtained by calculating the derivation of Eq (4). However, one can see that from Eq (4), utility value cannot be di-rectly calculated since Eq (4) contains both U i and U j . Therefore, we need to borrow the concept of Nash Equilibrium to obtain the final utility of each user. Several works are done for the analysis of Nash Equilibrium of LBR model [3, 4]. According Proposition 1 in [7], we can obtain the utility of each user via Algorithm 1.
Similar to Co-author model, here we also use the utility dif-ference as criteria to identify beneficial and mutual consent links. Specifically, when user i considers to make friends with user k , the utility difference can be estimated as  X  i =  X  ( U i ( G + e U ( G )) . If  X  i  X  0 , we say e ik a beneficial link to user i since it could decrease i  X  X  effort.
As we discussed in Section 1, though the above game theoretic models show their strength on analyzing the formation mechanism of a static network from theory perspective, an important issue still remains: could these model capture the mechanism of evolution of real networks? In particular, we are interested in understand-ing: Q1 , if we exactly know the links users will build and apply NFG models to estimate their utilities before and after they setting up these links, whether their utilities would increase accordingly? Q2 , how precise the models can achieve in identifying beneficial or mutual consent links? Q3 , could users gain more utility by adding arbitrary links?
To answer questions Q1 to Q3, we conduct an empirical analysis on four real-world datasets, Ciao, Epinions 1 , Collaboration Net-work (COL) 2 and Facebook 3 . The statistics of these datasets are shown in Table 1 and we will introduce the datasets in detail in Section 5. To answer these questions, we first remove X% links { e ij  X  E ( G ) } as N from network G and note the network with the rest links as G removed , then we utilize the models of NFG to calculate the utilities of each user in G removed , say U ( G following that, we add the removed links back and again calculate the utilities of each user, say U ( G ) ; thus, for each user i who has link changes, we calculate  X  i . Based on the description in Defini-tion 3 , we can then count the number of beneficial links and fur-ther obtain the number of mutual consent links. The more a NFG model can identify beneficial and mutual consent links, the better this model will be when using it to model real network evolution. In addition, we also calculate users X  utility difference by randomly adding links to G removed for answering Q3 . The number of ran-domly added links is same as removed links. We test X as 10, 20 and 30. Since the performance are similar, here we just report the result of X=20.

By cross validation, we find the best performance of each models as Figure 1. Here we set  X  = 0 . 25 and u = 1 in LBR model. We summarize the results by following observations:
In summary, these results indicate that NFG models can partially describe the evolution of real networks from utility perspective, which motivates us to consider an approach to leverage NFG mod-els to help improve the recommendation performance of link pre-diction methods. In the following section, we will first introduce a three-phase method. Furthermore, we present a unified model that incorporates Network Formation Game into a Bayesian rank-ing model for link recommendation.
Given the definitions and empirical analysis above, now we can formally define the problem solved in this paper.
 Problem 1. Exploiting Game Theoretic Analysis for Link Recommendation in Social Networks : Given a network G , a utility function U (  X  ) , the goal is to learn a predictive model from e ij  X  E ( G ) and U (  X  ) such that the model can recommend new links to each user as accurate as possible.
Ciao and Epinions datasets can be found from [33] X  X  first author webpage http://www-personal.umich.edu/ mejn/netdata/ http://konect.uni-koblenz.de/networks/facebook-wosn-links Algorithm 2 : A game theoretic framework for link prediction.
In this section, we first introduce a three-phase method that em-ploys NFG models to improve link recommendation performance. The proposed framework is quite general and the idea here is straightforward that by using NFG models to calculate the utility difference when adding links to the network, the links which are highly-recommended by link prediction models but cannot improve the utility of connected users will be re-ranked to a lower prior-ity for final recommendation. Besides this three-phase approach, we also propose a novel unified pairwise ranking model, namely, BPRLGT , integrating NFG models into a Bayesian ranking model for link recommendation. Our model is built based on Bayesian Personalized Ranking framework (BPR) [27], which always re-quires sampling technique to select training data. In BPRLGT, we extend the preference assumption of BPR by considering network topology and further propose a game theoretic sampling approach to improve model training.
In this section, we introduce the proposed method that leverages the power of game theory to improve the accuracy of link recom-mendation in social networks.

Given a network graph G , a utility function U (  X  ) , a link predic-tion model L , our goal is to recommend T links for users. The pro-posed method includes three phases. At first phase, we utilize U (  X  ) to calculate the current utility of each user i , as U i ( G ) on network G . Then a link prediction method L is trained on G and suggests a list of new links { e ij } for users. After getting the recommended links from L , at the beginning of third phase, we add them to G and form a new graph, G + { e ij } . Based on this new graph, we can compute a new utility of each user by calling U (  X  ) again, say U ( G + { ij } ) . By comparing  X  i = U i ( G + { ij } )  X  U 0, we can identify the beneficial links and further adjust the rank-ing of suggested links. In particular, we can decrease the ranking of those non-beneficial links. Thus, after the third phase, the links in the top ranking positions are approved by both machine learning method and NFG model. In other words, these recommended links not only have high probability to be set up but also are beneficial links once they could be set up. The algorithm for this framework is shown as Algorithm 2.

Although the proposed framework provides a straightforward way to combine NFG models and machine learning models, and it can improve the recommendation performance as we will show in Section 5, we notice that the framework processes the knowl-edge from NFG models and machine learning models in separated steps, which makes NFG models insufficient in improving machine learning models directly. To better integrate NFG models into ma-chine learning models, we therefore develop a unified Bayesian ranking model with game theoretic sampling techniques for link recommendation.
Since the observed network data only contains binary feedback between two users (1 for an observed link, 0 for no link), the link recommendation problem then can be cast as a one-class recom-mendation problem, as we introduced in Section 2. Thus, we pro-pose a pairwise ranking method, BPRLGT ( B ayesian P ersonalized R anking for L ink recommendation with G ame T heory), to solve this problem. Our proposed model is built upon Bayesian Per-sonalized Ranking framework, BPR [27], which requires sampling technique to select pairwise data for Stochastic Gradient Descent (SGD) training. In BPRLGT, we emphasize on designing a game theoretic sampling approach to improve model training. Moreover, BPRLGT model also takes network topology into account, which makes BPRLGT more suitable for link prediction than BPR. Model Assumption. We first introduce the basic assumption used in BPR [27] in a link recommendation scenario as following, where p ui represents a user u  X  X  preference on building a link with user i and the assumption requires that p ui should be larger than p uj , p ui p uj , when user u has a direct link with user i rather than j in G . This assumption models the preference order of users when building links with others and are commonly used in one-class recommendation problems.

However, different from existing works [27, 28, 30, 19], here network topology provides us more reliable auxiliary knowledge to solve link prediction problems. Based on the point that people are more likely to make friends with the friends of their friends, we extend the original assumption to a topology-based preference assumption consisting two pairwise preference comparisons, Compared this with Eq (5), here we further assume that user u prefer to make friends with k other than j since user u and i are friends and k is the friend of i .
 Model Formulation. Based on the assumption, we propose an optimization criterion for each user. In particular, the inequality in Eq (6) can be used to maximize the value of the Area Under the ROC Curve (AUC) which is widely used in ranking problems. We utilize a matrix factorization framework to estimate the link preference between users. Specifically, H  X  R M  X  k is a low-rank representation with k M for users, thus, the preference value of p ui can be estimated as H u H T i + b i , where H u is the u in H representing the user u  X  X  latent factors, b i  X  R is a biased term for user i . Then, for each user u , our goal is to maximize the likelihood of his/her all assumed preference order as Eq (6) shows, which is equivalent to maximize Eq (7): Input : A social network G = ( U,E ) Output : Parameters  X  = { H  X  R M  X  k ,b  X  R M } Initialization: Initialize H and b
Training: for iterations do end
Algorithm 3 : B ayesian P ersonalized R anking for L ink rec-ommendation with G ame T heory.

When optimizing for the AUC, it is common practice to work with a differentiable function, such as a sigmoid function which has the form  X  ( x ) = 1 1+ e  X  x , to approximate the function P ( . ) , so that the objective function is differentiable. Based on this trick, our goal is to maximize the following objective function, where a regularization term is used to avoid overfitting in the learning process, p ui = H u H T i + b i , p uk = H u H T p uj = H u H T j + b j . We adopt ` 2 -norm regularization terms for model parameters  X  = { H,b } .
 Model Learning. We employ the widely used stochastic gradi-ent descent (SGD) algorithm to optimize the objective function in Eq (8). The main process of SGD is to sample a training instance. Here we first randomly select a user u , then we pick a triple of users for each selected instance, we calculate the derivative and update the corresponding parameters  X  by walking along the ascending gradient direction, Game Theoretic Sampling Strategy. Since the learning method we use in this paper is stochastic gradient descent (SGD), the se-lected training instances might have great impact on the recom-mendation performance. Here we adopt the utility analysis in Net-work Formation Game to develop a game theoretic sampling strat-egy for model training. In each iteration, the model needs to sam-ple a tuple of users { u,i,j,k } . First, a user u is uniformly sam-pled from V , then i and k are sampled uniformly according to e ui and e ik  X  E ( G ) , and e uk /  X  E ( G ) . Then we calculate a preference vector h u = H u H T + b  X  R M for user u based on current estimation of H . We rank the elements in h u in descend-ing order and let h u ( v ) be the user who has the v th largest value in h u . Then the game theoretic sampling strategy can be described as follows: scan from the top of h u , find the first h u  X  u = U u ( G + e uh u ( v ) )  X  U u ( G )  X  0 , set j = h u
The key point of the sampling strategy is to select effective train-ing instances by examining users X  utility difference. In particular, we check the candidate j from the user with highest preference score of u , which is estimated by current model parameters. The idea is that if a user j is strongly recommended to u by current pa-rameters but adding edge e uj cannot improve u  X  X  utility, we need to punish the model preference on j by maximizing the preference difference between p ui and p uj . In this way, BPRLGT not only maximize the likelihood of observed preference order but also con-sider the utility of each user during the learning process. The de-tailed algorithm is shown in Algorithm 3.
In this section, we conduct several experiments to evaluate the performance of the proposed three-phase method and the unified ranking method. We demonstrate the recommendation accuracy, analyze the parameters and the convergence of the proposed meth-ods. The results show that link recommendation performance can be improved under the help of game theoretic analysis.
First, we introduce the datasets we use in Section 3.2.2. We use four real world datasets to validate the performance of the proposed methods, namely, Ciao, Epinions, COL and Facebook. Ciao and Epinions are online product review websites. Both websites allow users to build their social connections with others in order to share their experience and knowledge on the products. COL describes a scientific collaboration network between authors submitting papers to www.arxiv.org . Facebook is one of the most popular social net-working websites that users can make friends with others on it. The statistics of the four datasets are shown in Table. 1. The datasets are preprocessed by eliminating users with less than three neighbors. For each dataset, we randomly split it into a training part, used for model training, and a test part, used for model evaluation. Similar to [24], for each user u , we select 80% of their observed social links as P u and leave the remainder as T u for testing. Cross-validation is applied to find best parameters in the proposed methods,  X  in LBR model is set as 0.25, k is set as 10 and learning rate,  X  , of each link prediction model is set as 0.01.

Our experiments are intended to answer the following questions: 1. Can the proposed three-phase method and unified ranking 2. Whether the proposed game theoretic sampling strategy help 3. How does the value of k in BPRLGT affect model perfor-
We use four popular metrics, Recall@K (R@K), NDCG (Nor-malized Discounted Cumulative Gain), Accuracy and Area under the curve (AUC), to measure the recommendation quality of our proposed approach in comparison to baseline methods.
 The average AUC statistic is defined as where E ( u ) = { ( i,j ) | ( u,i )  X  T u  X  ( u,j ) /  X  ( P is an indicator function.

For each user u , DCG @ K considers the ranking of the recom-mended users by discounting the importance and is defined as where rel i represents the preference score of user i (we use a bi-nary value for this quantity, if e ui  X  T u , rel i = 1 ; otherwise, 0). NDCG is the ratio of the DCG value to the ideal DCG value for that user. The ideal value of DCG comes from the best ranking function for the user. Here we set K = M  X  X  P u | where M is the total number of users.

Following [32], we also use the prediction accuracy metric to measure the recommendation quality of link prediction. Specifi-cally, the method ranks candidate links in decreasing order of con-fidence and we take the first | T u | candidates as the set of predicted links, denoted as C , for recommendation. Then the prediction ac-curacy (Accuracy) can be calculated as, where | X | is the size of a set.
In order to demonstrate the benefits of our methods, we adopt several link prediction methods as baselines and compare their per-formance for link recommendation. The experimental results are shown in Table 2. In this table, for a specific method B , the column B demonstrates its performance without the help of proposed framework while B  X  describes the performance of method B when a NFG model is used to adjust the ranking results. The results here are achieved when LBR model is used in the framework and BPRLGT . demonstrates its performance without the help of proposed framework while B Performance Comparison. Based on the results in Table 2, we can see that the proposed unified model clearly outperforms the comparison methods. CN and AA are two static scoring methods using only local network structure information for link prediction, which often lead to suboptimal performance. BPR is a popular pair-wise ranking method for one-class recommendation problem and here we use it to model users X  preference order when building links. However, it does not perform well because it misses network topol-ogy and just uses a uniform sampling strategy for model training. hTrust is a state-of-the-art point wise method for link prediction, incorporating low-rank matrix factorization and homophily regu-larization terms. FactLog also exploits matrix factorization frame-work for link prediction and also take advantage of network topol-ogy as explicit feature for model learning. Although both hTrust and FactLog methods improve the performance of link prediction compared with BPR and other heuristic methods, they still cannot beat the proposed BPRLGT model. BPRLGT carries on the merits of BPR and further extends BPR  X  X  assumption by directly modeling users X  preference on their second-degree friends. Moreover, when learning the model, the proposed game theoretic sampling strategy allows BPRLGT to consider users X  utility difference for effective training instance selection. Based on these, BPRLGT obtains sig-nificant improvements over all baseline methods on all datasets.
Detailed results for Recall@N can be found in Figure 2. We can see that on Ciao dataset, BPRLGT achieves clearly better perfor-mance than other methods. For other datasets, although the curves of different methods seem to be close to each other, BPRLGT consistently outperform baselines on different Recall@N measure points. We also find that compared with BPRLGT , BPR always per-forms bad, especially in COL dataset. The reason we consider is that BPR samples training instances via uniform sampling and do not consider network topology information. Since users X  observed links are always very limited and there are huge number of unob-served links acting as candidate links to be recommended, thus the original assumption of BPR , Eq (5), cannot correctly capture users X  preference on building links. This also indicates the necessity of proposing new pairwise preference assumption for link prediction, as BPRLGT does.

We also take experiments to evaluate the performance of the pro-posed framework. For a specific method B , the column B demon-strates its performance without the help of proposed framework while B  X  describes the performance of method B when a NFG model is used to adjust the ranking results. The results here are achieved when LBR model is used since LBR performs better in Sec 3.2.2. From the results, on all datasets, we find that exploit-ing game theoretic analysis can improve prediction performance for all link prediction methods. By exchanging the positions of lower-ranked but beneficial links with those higher-ranked but non-beneficial links, our proposed framework can help link prediction methods achieve better performance, which verifies the contribu-tion of Network Formation Game. In summary, with the help of game theoretic analysis, both the proposed framework and the uni-fied ranking model can always improve the performance of baseline methods. Impact of k . Since BPRLGT is built upon matrix factorization framework, which requires us to predefine the number of latent fac-tors in advance, here we take experiments to investigate the impact of the number of latent factor k on recommendation performance. The results are shown in Figure 3. We use AUC as evaluation met-ric and vary the value of k from 5 to 50. We find that on all datasets, all comparison methods perform stable with different values of k and BPRLGT always achieves best and stable performance. The results verify the significant contribution of the extended prefer-ence assumption as Eq (6) and game theoretic sampling strategy. Moreover, we also notice that on COL and Facebook datasets, BPR shows clearly poor performance than other methods. The reasons we consider are that the observed feedback in these datasets is too sparse and BPR does not consider network topology to help select effective instances for better learning.
 Impact of Game Theoretic Sampling Strategy. In this subsec-tion, we compare the performance when we use different Network Formation Game models in BPRLGT . The results are shown in Fig-ure 5. We find that on all datasets, BPRLGT with game theoretic sampling strategy achieves better performance over uniformly sam-pling strategy. Moreover, by using LBR model, it achieves best per-formance over Co-author models. Through cross validation,  X  and x here are set as 0.25 and 1 in LBR , respectively. This results ver-ify the simulation results in Section 3.2.2 and also demonstrate the advantages of incorporating game theoretic analysis into machine learning models for link prediction.
 Convergence Analysis. We further investigate the convergence of BPRLGT . Figure 4 shows the convergence analysis of BPRLGT model on different datasets. We see that our method always con-verges within 30 iterations on all datasets, since BPRLGT incorpo-rates network topology into the model assumption and also benefits from utility analysis from NFG models, making it learn more effec-tive knowledge in each iteration. The fast convergence ensures its ability to scale up to huge data.
In this paper, we study the problem of exploiting game theoretic analysis for link recommendation in social networks. We first pro-pose a three-phase game theoretic framework combining the mod-els in Network Formation Game with the machine learning models. Besides this framework, we also develop a unified model by incor-porating Network Formation Game into a Bayesian ranking model for link recommendation. Specifically, we design a game theoretic sampling approach to improve the model training process. Exper-iments on four real datasets validate the effectiveness of the pro-posed methods for link recommendation.

The idea and methods proposed in this paper represents a novel and interesting research direction. There are several potential di-rections for future work. One straightforward extending is to study the performance when other Network Formation models are incor-porated into the proposed framework and ranking model. More-over, it is also interesting to investigate how to combine contextual knowledge with Network Formation models for link recommen-dation. Furthermore, integrating game theory with other machine learning models, such as Markov Decision Process, should also be an intriguing direction for future research.
This research was in part supported by grants from the Na-tional Grand Fundamental Research 973 Program of China (No. 2014CB340405), the Research Grants Council of the Hong Kong Special Administrative Region, China (Project No. CUHK 413213), and Microsoft Research Asia Regional Seed Fund in Big Data Research (Grant No. FY13-RES-SPONSOR-036).
