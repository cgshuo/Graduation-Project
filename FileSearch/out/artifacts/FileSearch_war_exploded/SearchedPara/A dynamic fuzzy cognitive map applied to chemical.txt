 n , Flavio Neves Jr. b 1. Introduction in automatic control of complex industrial processes is due to some aspects as the presence of dynamic nonlinearities, the low-quality of measures, the high levels of noise and the highly distributed sensing. In general, only secondary variables are measured and controlled in such systems (e.g., temperature, pressure, flow, etc.). The decision-making about variables that directly affect the final quality and quantity of the production process are an operator charge. One of the more relevant factors that result in a stop in the production processes is the inherent error in human cognition, such as misinterpretation of alarms and system responses, information overload, among others. found in chemical and petrochemical industries in which the operation and supervision of control loops has become increas-ingly critical. These processes are in general not well understood and its operation is carried out based on experience rather than on rigid control laws. Some approaches in the literature for monitoring such processes are based on data acquisition techni-ques, and specifically on clustering methods for dealing with the difficulty in modeling processes. In these cases, the system behavior is modeled with a finite state machine ( Kempowsky et al., 2006 ) which evolves along a reachable states trajectory. The system dynamical behavior is modeled as a sequence of states in which the current state contains all information need to predict the system behavior. In this context, Kempowsky et al. (2006) discuss theoretical and practical aspects to develop a supervisory system for process control modeled as finite state machine.
Intelligent systems based on FCMs can be used in modeling and simulation of complex systems, due to the flexibility of knowledge representation using fuzzy quantities and the ease of abstraction of knowledge presented in the cognitive maps. The possibility of train and adapt maps based on historical system data is also an advantage of FCMs ( Kosko, 1986 ). In fact cognitive maps are weighted and directed graph (digraph) with feedback.
The graph nodes are used to model concepts describing the system behavior. These concepts are connected by weighted arcs representing the causal relationships between them. The fuzzy cognitive maps are a class of cognitive map in which the values of concepts and causal relations are fuzzy ( Kosko, 1986 ). As a weighted directed graph, an FCM can also be regarded as an automaton (or finite state machine), generated from expert knowledge and calibrated with acquired data from system ( Miao and Liu, 2000 ). As a data based model, Miao and Liu (2000) demonstrated that FCM inference trajectories are conver-gent. They are also demonstrated theorems which show that for a large FCM, these trajectories can be decomposed into small ones, generating a hierarchy of smaller FCM that are more easily built.
Over recent years many FCM models have been developed in several areas, including supervision of complex systems, failures modes effects analysis and detection, medical diagnosis, analysis and decision making of financial, social and organizational sys-tems. Moreover, some methods describing cognitive map ontol-ogies have also appeared in recent literature in order to improve knowledge elicitation and translation into a FCM model ( Wang et al., 2008 ; Chauvin et al., 2009 ; Kwon, 2011 ; Starr and de Oliveira, 2012 ). A good review of recent applications and advances in FCM modeling can be found in Glykas (2010) .
In conclusion, the FCM is an efficient tool for incrementally analyzing and modeling large scale systems existing in the real world. The obtained model can be trained and adapted from system data. However, FCMs lack of a concept of time that is crucial in many real-world applications. As a result the FCM model has some problems to represent and manage nonlinear and time-dependent behaviors. Moreover, they do not offer formal mechanisms to verify the behavior of systems being represented. This fact limits the use of FCM as inference engine and its associated knowledge representation ( Miao et al., 2001 ; Koulouriotis et al., 2005 ; Acampora and Loia, 2011 ). To circum-vent the temporal drawbacks of FCM models, Acampora and Loia (2011) have proposed a new type of FCM based in timed automata theory which provides a straightforward way to repre-sent time-related events in FCM modeling.
 Based on the results presented by these authors ( Miao and Liu, 2000 ; Kempowsky et al., 2006 ; Acampora and Loia, 2011 ), this paper proposes the development of a supervisory system in which the finite state machine proposed by Kempowsky et al. (2006) is replaced by a FCM built from expert knowledge about process control. In order to model all behavior of a nonlinear dynamical system, we develop a new type of FCM in which the concepts and causal relations are dynamically changed into a graph from the occurrence of events. Thus, the new type of fuzzy cognitive map is able to acquire and use heuristic knowl-edge dynamically. This dynamic fuzzy cognitive map (D-FCM) is a type of timed automata based FCM such as those proposed by Acampora and Loia (2011) . The supervisor is constructed in a modular way: each supervisor X  X  task corresponds to a smaller FCM that is developed and tested separately. At the end, the complete supervisor is formed by the union of all small FCM. We also introduce into the D-FCM other types of relationships beyond the cause X  X ffect relationships that are common to cognitive maps. The ability to model different types of relation-ships adds versatility to the FCM and it is a contribution to the knowledge representation and systems modeling areas by means of FCM.

This paper is organized as follows: Section 2 gives an intro-duction to fuzzy cognitive maps theory highlighting the temporal drawbacks of FCM models. Section 3 presents the proposed approach to develop dynamical fuzzy cognitive maps (D-FCM) in which time problems are mitigated by the use of several kinds of concepts and relationships. Section 4 describes the fermenta-tion process used as a test-bed and develops the D-FCM based supervisory system to this process. Section 5 presents the simula-tion results and Section 6 concludes the work. 2. Fuzzy cognitive maps
Cognitive maps were initially proposed by Axelrod (1976) as a mathematical model to the belief structure of a person or group. This mathematical model was adapted for inclusion of fuzzy uncertainty by Kosko (1986) generating fuzzy cognitive maps. Like the original, FCMs are signed and directed graph, in which the involved variables are fuzzy numbers. The graph nodes represent linguistic concepts modeled by fuzzy sets and they are linked with other concepts through fuzzy connections. Each of these connections has a numerical value (weight) taken from a fuzzy set, which models the relationship strength among concepts. A cognitive map example is given in Fig. 1 and the corresponding connection matrix (equivalent weights matrix) is given by Eq. (1) .

W  X  2 6 6 6 6 6 6 4
The concepts of a cognitive map can be updated through the iteration with other concepts and with its own value. Eq. (2) drives this interaction where the strength of the causal relation-ships is represented by the weight of the summation. After some iterations, the values of the concepts will evolve until stabilize at a fixed point or a cycle limit.

A  X  k  X  1  X  X  fA i  X  k  X  X  where k is the interaction index and f  X  X  is the sigmoid function f  X  x  X  X  1 1  X  e l x  X  3  X  where l is a parameter used to determine proper shape of the function. This transformation function guarantees the weighted sum values is confined to a certain range. In this work, A and l 4 0.

In resume, the FCM inference engine iteratively computes a sequence of vector transformations that is mainly used to answer a what-if question based on an initial scenario. This knowledge representation differs from others intelligent systems that are based on if-then rules. Despite the graph representation, some authors argue that FCMs are not able to properly represent real systems, especially the dynamic systems, because FCM models can only express monotonic and symmetric causal relationships.
In fact, the robustness and accuracy of a FCM model is highly dependent on the weight matrix. Thus, the determination of the weight matrix, i.e., strength of relationships among concepts of an
FCM, is crucial. Moreover, there is no differentiation between long-term events and immediate events. To infer an effect with an
FCM, it is necessary to have simultaneous occurrence of all modeled causes. These causal relationships also fail to express the concept of feedback and other temporal aspects associated with real systems. The lack of temporal concepts that is crucial in many applications, associated with monotonic inference, has limited the use of FCM models in dynamic applications ( Miao et al., 2001 ; Carvalho and Tome, 2001 ; Acampora and Loia, 2011 ; Mendonc -a et al., 2012 ).
 As a solution, other types of relationships were introduced in
FCMs as well as cause X  X ffect relationships by Carvalho and Tome (2001) . These authors also classified concepts according to their temporal behavior. Other approach has been proposed by Miao et al. (2001) in which a time-varying weighting matrix is used and Laplacian functions describe the causal relationships. The paper also studied the two aspects of the causality separately, i.e., causes and effects ( Miao et al., 2001 ). Another approach to provide adaptability to FCM models is the use of decision trees ( Papageorgiou, 2010 ). In this case, the map structure can be dynamically modified as a result of a tree inference. Recently, a new framework based on timed automata theory has been proposed in Acampora and Loia (2011) that enables FCMs to model dynamic behaviors. This framework relies on a double-layered temporal granularity where the low-level layer is based on well-known FCMs timing mechanisms and the high-level layer proposes a novel timing mechanism base on the ideas of cognitive era. A cognitive era is the longest interval time in which the system does not change its cognitive configuration, i.e., its concepts and causal relationships ( Acampora and Loia, 2011 ). behavior of FCM models remains an open issue. In order to extend
FCMs to support the usual dynamic behaviors of real systems and consequently become appropriate for dynamic control applica-tions, we propose a new framework where new types of concepts and temporal relationships among concepts are introduced into
FCM models. In this framework, the concepts and causal relations of a FMC are dynamically changed into a graph from the occurrence of special events. Thus, the new model of a fuzzy cognitive map is able to acquire and use heuristic knowledge dynamically. 3. Dynamic fuzzy cognitive maps which the causal relationships and the associated effects are both time varying. A framework to develop such maps must support the following procedures ( Acampora and Loia, 2011 ): fuzzy cognitive map (D-FCM) supports several types of concepts and relationships: as reinforcement learning algorithm ( Mendonc -a et al., 2012 ).
The resulting weighting matrix W is a time varying matrix in which time is a variable explicitly considered.

Fuzzy relation: this relation introduces a non-monotonic and fuzzy reasoning into the model. In this case, two or more concepts (antecedents) affect another concept (consequent) by means of a fuzzy function. The computed weighting matrix W is a time varying matrix resulting from a fuzzy inference system.

Selection relation: these relations model the occurrence of events and they also identify what are the valid cause X  X ffect relationships in a given time. They are conditional declaration expressed in term of if-then rules that are fired according to the modeled phenomena. These relations are naturally time-varying since that rules are valid only under special circum-stances (events). The weighting matrix is resulting from fired rules. This relation is a mechanism which triggers (adds or removes) concepts in the map.

Factor concept: this concept is necessary to magnify/reduce the level of the other model concepts. The use of a factor concept is determined by a conditional declaration.

These concepts and relations can be easily organized into an ontology as proposed by Chauvin et al. (2009) providing a formal semantic definition of dynamic fuzzy cognitive models.
Various methodologies could be used to knowledge acquisi-tion in order to develop FCM models ( Dickerson and Kosko, 1994 ; Stylios and Groumpos, 2004 ; Chauvin et al., 2009 ; Leger and
Naud, 2009 ; Pedrycz, 2010 ). In these works, some knowledge acquisition methods are dependent on the group of knowledge engineers (expert) who operate, monitor and supervise the system to be modeled. In this context, a main concern is to reach a consensus among multiples expert about the cause X  X ffect relationships driving the system to be modeled. Moreover the knowledge extraction from historical and/or simulation data is also an important issue in FCM modeling ( Pedrycz, 2010 ; Papageorgiou, 2012 ). In this paper, we have used the augmented
FCM approach to develop fuzzy cognitive maps. This approach was originally proposed by Dickerson and Kosko (1994) and detailed by Stylios and Groumpos (2004) and Salmeron (2009) .
With this approach, each expert handcrafts the FCM structure via a list of concepts and forms a suitable set of connections. The several maps are merged by a fuzzy system as discussed by
Salmeron (2009) and then the resulting map is  X  X  X uned X  X  from data by a learning algorithm ( Papageorgiou, 2012 ).

As a result, the construction of FCM even for small systems requires a large amount of concepts and relationships that need to be established which hinders a manual development of the model. To make this process easier and to allow a temporal analysis of the maps, a FCM model must be developed incremen-tally according to the kind of modeled cause X  X ffect connections.
First, a classical fuzzy cognitive map is built where all concepts are level ones and all connections are causal relations. In this step, the input/output data concepts are also specified. Regarding the timing issues, it is worthwhile to note that this map is a monotonic inference engine where all causes occur at the same time.

In the second step, the variation and temporal memory concepts are introduced and the time varying relations (causal and fuzzy) are defined. By dynamically setting the strength of the causal relationships, the obtained maps allow to model dynamic systems and can be considered a temporalized FCM similar to those proposed by Carvalho and Tome (2001) , Miao et al. (2001) , and Papageorgiou (2010) . Learning algorithm can be also used to tune the FCM model in this step. Despite the inference engine enables a non-monotonic reasoning, only continuous causal actions are represented in the model, in this step.

The rule basis to add/remove concepts and relations are inserted in the third step. These actions are carried out by selection relations and factor concepts. If the complete D-FCM model is composed by several small maps that represent different behaviors of the systems, these maps are merged in this step. The relations (edges) and concepts (nodes) shared by the various maps (graphs) are used to merge them. Moreover, if the idea of cognitive era is adopted in the modeling then the mechanism to trigger the several D-FCMs is also implemented in this step.
Due to the inclusion of these new features into FCMs, it will require a knowledge organization to represent, model and imple-ment the several behaviors into the cognitive maps. For the management of behaviors, we propose the use of control archi-tecture similar to Brooks X  subsumption architecture ( Brooks, 1986 ; Goerick, 2011 ). The subsumption architecture was origin-ally conceived for use in autonomous mobile robots able to process complex information in real time. It can shortly be summarized as a composition of hierarchical control loops, where each loop maps a perception to action behavior or cause X  X ffect behavior. If these simple control loops are fitted with timers, they become finite state machines ( M  X  uller, 2007 ). These state machines can be combined in incremental and hierarchical layers, working bottom-up toward increasingly complex systems. The lower layers are independent of higher layers and each layer forms a complete operational system. Another interesting feature of the Brook X  X  architecture is that many behaviors can be simultaneously triggered, hence the need for a choice mechanism to select which state machine should actually be triggered ( Goerick, 2011 ).
 Inspired by these ideas, we propose to organize the several FCMs that correspond to behavioral modules in a so called hierarchy of subsumption, in which the behaviors are organized in layers. The FCMs placed in the lower layer present only purely causal relationships and/or fuzzy type relationships. These maps constitute a reactive knowledge that models continuous cause X  effect behaviors. The higher level behaviors are driven by the aim to pursue planned goals (deliberative knowledge). The FCM models in this layer can inhibit or suppress concepts and relation-ships and thus change the overall behavior of the model. They are characterized by the presence of selection relations and factor concepts. The decision-making associated to these higher maps can be classified in three groups: low-level decisions used to magnify/reduce the strength of a causal relationships and/or the level of concepts; management decisions used to add or to remove concepts and/ or causal relationships; drastic decision used to completely change the current FCM model, that is, the decision changes the model cognitive era ( Acampora and Loia, 2011 ).

Although this hierarchical organization and management, the parallel processing is a characteristic of subsumption architec-tures. Thus actions or decision-making can coexist. However, when the actions of a higher strategic level hierarchy are running, the others (lowers) are inhibited ( Goerick, 2011 ).

As cited above, this framework characterized by several types of concepts and relationships with a hierarchical knowledge organization can be extended with an ontology. Although this is not the purpose of this paper, the combination of cognitive maps and ontologies improves the construction, understanding and maintenance of knowledge. Moreover, this combination also support interoperability and reusability of knowledge allowing its sharing among several agents such as designers and users of resulting DFCM models ( Foguem et al., 2008 ). 4. Supervisory control based on D-FCM
The use of hierarchical systems for supervisory control is widely accepted in the literature ( Passino and Yurkovich, 1998 ).
A hierarchical architecture based on FCM is proposed in Stylios and Groumpos (2004) for the supervision of complex processes.
This architecture, adapted for a D-FCM, is shown in Fig. 2 . The supervisor on the upper level consists of many interconnected
D-FCMs. Each map performs a specific task of supervisory control such as fault detection, monitoring, planning and decision-making, among others.

The main advantage of using a FCM based supervisor is its easiness to be expanded, including advanced features. For instances, small maps (parts of the supervisor) could stand for devices failures modes by modeling their cause and effects, and for normal or degraded operation and even for news goals of the system. These small FCMs can be designed by a group of experts that translate their own experience about the process into different models. These maps are easily merged by use of the augmented FCM approach. This possibility of building large maps from the union of small maps representing different sources of knowledge is an effective tool in the complex systems modeling.
The modular composition also confers to a FCM supervisor the ability to redesign the system which can support the process engineers and designers to estimate what will happen if some system parameters are changed. Another advantage is the possi-bility of developing a cognitive evolution that is a succession of valid maps (cognitive era) which describe the system behavior during a time line.

For the proposed supervisor, four cognitive eras have been identified: process start-up, production campaign, campaign recovery, process shut-down. They correspond to a natural evolution of a real process. At each stage, the process is char-acterized by different behaviors. For instance, during a startup procedure, the plant is operating out of normal conditions that generate strong nonlinearities in the process. On the one hand, in normal operation, the several controllers are adjusted to operate around specifically operation points obtained from linearized process models. Thus an ordered set of set-points to be sequen-tially implemented forms a production campaign.

In this paper for sake of simplicity, we develop only the cognitive era related to production campaign. For this, the proposed D-FCM based supervisor implements decision-make rules in an alcoholic fermentation process with two goals: dynamic generation of set-points for system operation in response to changes in the process variables and devices (valves) and improving the performance of the reaction compared with a pre-specified campaign, while satisfying operational constraints.
These decisions rules should consider the process under normal and critical (degraded) operation. 4.1. Alcoholic fermentation process tion was proposed by Maher (1995) , and it is depicted in Fig. 3 .
The simulated model corresponds to a reactor pilot unit. There are two controlled variables, F in and F out that represent the input flow of substrate and the output flow of product, respectively. The process has four state variables: concentration of substrate ( S ), of biomass ( C ), and of product ( P ), and mixture volume inside the fermentation tank ( V ). The concentrations are given in grams/liter (g/l) and the volume in liters (l).
 process dynamical behavior: dS dt  X  dC dt  X  m C dP dt  X  dV dt  X  F in F out  X  7  X  where S a is the substrate concentration of feed, Y C = S are the constant conversion of biomass and product respectively.
Eq. (8) represents the growing biomass function
Michaelis X  X enten constant, and P m is the inhibition coefficient of the product. These equations are solved by using the 4th Order
Runge X  X utta Algorithm. Moreover, there are volume constraints due to the tank capacity and the minimal and maximum quan-tities of substrate and biomass allowing the fermentation process 1 : 5 r V r 3 : 0  X  9  X  0 o C r 8  X  10  X  0 : 5 o S r 100  X  11  X  several problems, such as non-minimum phase and large accom-modation time. These characteristics can be seen in the step-response curve, presented in Fig. 4 . The initial process conditions are given in Table 1 .

From previous work, classical PID controller and Fuzzy-PD controller fail to control this process due it considerable large accommodation time and interactions among product, substrate and biomass ( Fabro and Arruda, 2003 ). The supervisory strategy proposed in this paper uses the knowledge of process operator to model the relationship among variables by means of a D-FCM. 4.2. A D-FCM model to supervisory control
Following the recommendations discussed in Section 3 and the architecture given in Fig. 2 , two different D-FCMs are built, one for normal operation and one for a critical mode operation when at least one of constraints in Eqs. (9) X (11) is not satisfied. Both maps are developed, tested and validated separately and then they are gathered in order to form a D-FCM larger model that performs the task of supervising the process during a production campaign with the two goals discussed above.

The D-FCMs were developed from observing the process behavior in different situations. The mathematical relations between its physical variables (substrate, biomass, product and volume) and control devices (input F in and output F out valves) under control actions are also studied. For this, besides the analysis of differential equations (4) X (8) that describe the fer-mentation chemical reaction, it was considered an cause X  X ffect analysis relating process physical variables to different set-points values of PIDs that drive the valves F in and F out . These set-point values correspond to the various operation points of the fermen-tation process.
 As a result, the following concepts are modeled:
Input concepts: product, substrate and biomass concentration, volume of the reaction mixture and a list of set-points that are specified by the campaign planning.

Variation concepts: substrate variation and specified set-point variation.

Level concept: errors among the product concentration (con-trolled variable) and the set points applied to both PID controllers.
 Output concepts: set-point values for both PID controllers.
Factor concepts: to each output concept, it is associated a factor concept in order to magnify/reduce its values. and the following process behaviors are mapped:
The concentration of product in the reactor, which is a process controlled variable, is affected by variations in the set-point of the PID that controls the intake valve F in . This behavior is modeled through a causal relationship represented by an arc in the D-FCM ( W 2 ).

The concentration of product in the reactor is also affected by changes in the set-point of the PID that controls the output valve ( W 3 ).

The specified value to product concentration (i.e. the set point determined by the campaign planning), that characterizes the operating point of the reaction, determines the value of the PID set-point which is effectively applied to the intake valve ( W and to the output valve ( W 5 ).

The variation of specified set-points during the campaign (change in the operating points) affects the value of the set-point applied to the intake valve ( W 6 ) and to the output valve ( W 7 ). The planning establishes a set of admissible operating point and allowed transitions during the campaign.

A substantial variation in substrate concentration (greater than 3 g/l) into the reactor determines a change in the PID set-point that controls the intake valve ( W 1 ). This is a neces-sary action to ensure the balance of the fermentation reaction.
This substrate variation does not influence the set-point of PID driving the output valve, since the insertion of the substrate is made by F in , and F out valve is only related to the withdrawal of product.

The values of the PID set-point of both valves F in and F the mixture volume in the tank. However these relationship are asymmetrical and there are restrictions on the maximum volume to valve F in and on the minimum volume to valve F
These facts are modeled as fuzzy type relationships, as explained afterward (WF 1 ) and WF 2 .

From this behavior, the first D-FCM for the fermentation process operation is constructed, as shown in Fig. 5 .Thismap represents the process operatio n in normal mode and will be called D-FCMn. Its supervisory task is to minimize the effects of set-point transitions, determined by change s in operating points, and improve the performance of the reaction, whil e satisfying operational restric-tions as to keep the reaction volume within its limits.
Ascanbeseenin Fig. 5 , the D-FCMn corresponds to a simple acyclic graph, represent ing the way an operator adjusts the set-points effectively applied to the PID controllers. According to Miao et al. (2001) , the construction of large cognitive maps by steps always generates smaller maps usually acyclic, which correspond to well defined cause X  X ffect relations.

In D-FCMn of Fig. 5 , the values of input variables as mixture volume and specified set-point are normalized into the interval [0, 1] from process measurements. The factor concepts SP IN SP OUT are decision variables taking values into the interval [0, 1].
The set-point values that are effectively applied to the controllers ( OUT 1 and OUT 2 ) correspond to these decision values multiplied by the desired set-points. Weights W 2 to W 7 represent causal relations whose values are obtained from simulated data. Speci-fically, the strength of the relationship modeled by W 4 is time varying ones according to process operating points as given by
Eq. (12) . This behavior is due to chemical reaction characteristics ( Neves et al., 2009 ).

W  X 
The relationship W 1 is a causal trivalent function reflecting the equilibrium conditions of the chemical reaction
W  X  where the D substrate corresponds to the substrate change that occurs between two consecutive instants of time.

In Fig. 5 , the arcs WF 1 and WF 2 are fuzzy relations whose values are derived from a fuzzy rule base. Fuzzy relations are necessary if some variables present a non-monotonic behavior, that is, the variables are not strictly increasing or decreasing. This situation occurs with the volume of the reaction mixture in presence of positive or negative set-point variations for both valves. This non-linear behavior is shown in Fig. 6 (a) that high-lights the volume of the reaction mixture performance under set-point variations of the PID driving the F in valve. It is observed that volume changes are more pronounced with a positive set-point variation (see Fig. 6 (b)). According to this behavior, a Mandami fuzzy system ( Passino and Yurkovich, 1998 ) was developed that takes as input the volume and volume variation values and, as output, the value of the fuzzy relationship WF 1 that computes the set-point effectively applied to the valve F in .
 ship WF 1 is relation given by WF 2 between the volume and the set-point of the PID driving the valve F out .
 biomass concentrations may decrease to levels that do not allow the chemical reaction (see restrictions (10) and (11) ). In this case, the reactor operation becomes critical and it is necessary to recover the reaction components through a valve manipulation, regardless of the set points determined by the campaign planning.
For this, we develop a new model able to recover the reaction X  X  components levels. The new model corresponds to a cognitive map, labeled D-FCMc, for critical mode operation.
 components fall down security levels. In this case, the following restrictions must be modeled:
The biomass concentration should not exceed a maximum concentration of 8 g/l.

As explained earlier, the reactor volume cannot exceed 3.5 l and not decrease below 1.5 l.

The substrate concentration cannot be lower than a minimum concentration of 0.5 g/l.

The product concentration assumes discrete values into the interval [10, 50] g/l which correspond to the process operation points.
 The developed model for critical operation is shown in Fig. 7 .
Beyond the input concepts taken from process measurements (substrate and biomass concentration and volume), three new concepts related to admissible values of concentrations are modeled. These concepts (selected biomass, selected substrate and selected volume) are triggered by selection relationships and they affect both set-point values to be applied in the process. The number of rules associated with a selection concept depends on the modeled conditions. The selected volume is computed by two rules that test the maximum and minimum volume limits. The other two selection relationships (substrate and biomass) have only one rule. For example, the rule controlling the concentration of the biomass is as follows:
If the concentration of biomass is greater than the maximum threshold and the current set-point is equal to the maximum value of set point taken from the list of operation points (set-point list), then the value of set-point is decremented from the list of operation points (WS 3 ).

The two cognitive models (D-FCMn and D-FCMc) are merged through the two factor concepts that are connected to the output variables ( OUT 1 and OUT 2 ). Also, the input concept volume and the fuzzy relation (WF 1 and WF 2 ) are the same for both maps. The values of the variables OUT 1 and OUT 2 are resulting from both models iteration.

Fig. 8 shows the supervisor model resulting from the union of two cognitive maps (D-FCMn  X  D-FCMc). This final D-FCM was tested for different campaigns where the values of product concentration varied into the interval 10 X 50 g/l. In all conditions
The cognitive map given in Fig. 8 represents the supervisor behavior only during a production campaign. Other maps have been developed to supervise the process during other operational stages that correspond to the three other cognitive eras (process start-up, campaign recovery, process shut-down). Thus it is also necessary to embed into the supervisor a mechanism to switch among these eras. This mechanism considers the following situations:
If the campaign has satisfactorily reached the end and there is no other campaign to implement then shut-down the process else begin a new production campaign.

If the campaign performance is not satisfactory and the supervisor cannot restore the chemical reaction then restart the campaign.

Considering the adopted subsumption architecture, this mechanism is inserted in the higher priority layer of the hier-archy. It consists in a timer with two flags. The first one indicates if the time to complete the campaign is over and the other one indicates that the lower value of set-point is maintained for a long period. Thus, based in these flags and in the campaign planning, the rules discussed above determine the next era to be run.
The complete D-FCM is a knowledge based system comprising two types of decisions: decisions resulting from the analysis of cause X  X ffect relationships (causal and fuzzy relations) and event-oriented decisions. Both decisions can change dynamically the strength of relations and concepts of the D-FCM. However an event-oriented decision can only change the temporal basis of the model. The D-FCMs shown in Figs. 5 and 8 are used in the next section to control the fermentation process presented in Section 4.1 . 5. Simulation results
Three sets of tests were performed in order to assess the performance and robustness of the supervisor. In each case, it is simulated a campaign that aims to bring the fermentation process from an initial state characterized by a concentration of approxi-mately 25 g/l of product until a final state in which the concen-tration of product is 45 g/l. For this, the campaign planning establishes a sequence of three different set-points (30, 35 and 40 g/l) that are applied during 360 h.

In the first experiment, the process is considered in normal mode operation. The process is initially simulated only under regulatory control (without supervision) and then the simulation is retaken with the supervisory control accomplished by D-FCMn in Fig. 5 . Under regulatory control, both PID controllers operate from a single set-point. The increment of computed control is added to the current value of valve F in and decremented from the current value of valve F out ( Fabro and Arruda, 2003 ). In the supervisory control, the operation of the valves are independent, the increment of control is calculated from two sets of different set-points, one for each PID in the regulatory level. These set-points are generated by the D-FCM. Besides, when a valve is fully closed, the other will also be closed for safety reasons.
In the second experiment, the same campaign is carried out, and as will be explained below, the reaction reaches a critical condition after a given time. This situation requires a more careful operation of the process. In this case, we evaluate the perfor-mance of supervisory control accomplished by D-FCM in Fig. 8 , which incorporates two (normal and critical) operation modes.
In the last experiment, the same campaign is carried out, however a fault is simulated. The valve F in is forced to remain temporarily closed for a certain time, which leads to an uncontrollable disturb of the process. The performance of regulatory control is again compared with the supervisory control with D-FCM given in Fig. 8 . The goal is to test the critical operation mode when an external cause (closed valve) leads to an imbalance of the reaction. In all experiments, the initial conditions are given in Table 1 .

The following criteria are used to evaluate the control perfor-mance: ITAE (Integral Time Value of Absolute Error) index and the variances of the control signals ( s 2 F output ( y ( t )). The ITAE was chosen because it is widely accepted in the control community as a perform ance indicator for evaluation of ness of the closed-loop in presence of disturbances, and the control signal variances ( s 2 F the control actions ( Astr  X  om and Wittenmark, 1995 ).
Figs. 9 and 10 show the results of both control schemas obtained with the first set of set-points. Fig. 9 (a) shows the product concentration resulting from regulatory control where the set-point applied to both PID controllers is the same. As explained above, the control increment computed from the error is added to the valve F in and decremented from the valve F outputs of the PIDs are shown at Fig. 9 (b) and (c), as well as the values of state variables: substrate and biomass concentration ( Fig. 9 (d) and (e)) and volume ( Fig. 9 (f)).

The results for the supervisory control are given in Fig. 10 which brings the different set-points applied to the PIDs ( Fig. 10 (b) and (c)) and the responses of these controllers (control signals in Fig. 10 (d) and (e)). The evolution of state variables of the process are also shown: product, substrate and biomass concentration ( Fig. 10 (a), (f) and (g)) and volume ( Fig. 10 (h)). The performance indexes of this experiment are given in
Table 2 . These indexes were calculated only up to time t  X  285 h. In this moment, for both control architectures, the reaction reaches a limit value, with a volume equal to 3.5 l. For safety reason, the input valve is closed and, consequently, the output valve is also closed. In fact, from that moment on, the biomass reaches its maximum concentration of 7 g/l, the sub-strate is completely consumed and there is no longer chemical reaction, i.e., the process shuts down. This can be observed by examining the behavior of the variables showed in Fig. 10 .
Analyzing the results in Table 2 , the ITAE metric indicated a performance of approximately 5% lower for the supervisory control (D-FCM  X  PID) in relation to the single regulatory control, confirmed by the values of error variance s 2 e  X  t  X  . Regarding the performance of the PID driving the output valve, the values of variance ( s 2 F process is done on the valve F in , which regulates the reactor substrate feed and it is strongly influenced by changes in set-points. At t  X  120 h there is a transition set-point of 45 g/l to 35 g/l.
In this case, the regulatory control acts, the error is computed and the valves are open enough to correct this error. On the other hand, the supervisory control considers that, besides the error, there is a variation of substrate in earlier instants of time. As a result, the value of W 1 is inverted (trivalent relationship given by
Eq. (13) ), which reduces the value of the set-point and determines a desired complete opening of valve F in . This fact is responsible for the variation of the control signal in the valve F in higher for the supervisory control ( s 2 F impact of this variance in the process output is only 1.8% higher for supervisory control compared to regulatory control.
The positive changes of set-point are treated equally by both architectures.

In conclusion, for the normal operating mode with different variations of set-point, the behavior of the supervisory control is equivalent to regulatory control, indicating that when there is no occurrence of critical events, if the regulatory control loop is operating satisfactorily, the inclusion of a supervisory level in this operation does not interfere with the process performance. The supervisor fulfills its role well.

During the campaign simulation, as explained above, a critical process situation occurs from time t  X  285 h, determining the closure of the reactor ( F in and F out valves are completely closed) and the end of the reaction (see Fig. 9 (b) and (c)). In order to analyze this situation, a second experiment just like the first is carried out, with the difference that the supervisory control includes the critical mode of operation, that is implemented by the dynamic cognitive model (D-FCM) in Fig. 8 .

Fig. 11 shows the results obtained with supervisory control performed by the D-FCM. A new set of set-points different from the experiment 1 (compare Fig. 10 (b) and (c) with Fig. 11 (b) and (c) respectively) is now generated by the supervisor due to the heuristics modeled by the rule base. For example, just before the moment when the set-point transition from 45 g/l to 35 g/l ( t  X  115 X 120 h) occurs, the supervisor commanded by D-FCM ( Fig. 8 ) generates an intermediate set-point of 40 g/l, that is not previewed in the campaign planning. The goal is to recover the amount of substrate that is decreasing. Thus, when the set-point transition specified in the campaign occurs at t  X  120 h, the errors considered in PIDs are smaller and the calculated control signals are also smaller when compared with those of experiment 1 (compare Figs. 10 (a) and 11 (a) at t  X  120 h). In order to corrobo-rate the role of the D-FCM supervisor, the performance indexes are recalculated until the instant t  X  250 h, for the three control schemas: regulatory control (PID), supervisory control with the
D-FCMn (only normal operation mode  X  Fig. 5 ) and supervisory control with the D-FCM (normal and critical operation modes  X  Fig. 8 ). These values are given in Table 3 and show that the
D-FCM supervisor performance is slightly higher than the other two architectures.

Moreover, the critical situation in experiment 1 that occurs from t  X  285 h is anticipated because the D-FCM supervisor prevents the substrate concentration falls below its minimum limit (0.5 g/l). Thus at time t  X  264 h, the supervisor determines (see Fig. 11 (a)) a decrement in the set-point of 45 g/l to 40 g/l, and soon after to 35 g/l. This set-point remains until the time t  X  275 h, when the supervisor attempts to retrieve the campaign by increasing the applied set-point to 40 g/l, and then to 45 g/l. This will repeat indefinitely, unless the set-point of the campaign is specifically decreased in order to remove the reaction of its critical condition. This condition is characterized by the following approximated values: product concentration of P  X  45 g/l, substrate concentration of S  X  0.5 g/l, biomass concentration of C  X  7 g/l, and volume V  X  3.5 l. The decision to implement a campaign recovery is taken by the supervisor after some attempts of campaign retrieve. For this, the supervisor determines a cognitive evolution and the D-FCM describing the campaign recovery cognitive era is enabled.

Finally, these experiment results validate the complete super-visor build by the combination of the two models (D-FCMn and
D-FCMc) into a single map. This supervisor improves the process behavior in both normal and critical operation modes.
The third experiment examines the behavior of D-FCM super-visor when a fault occurs in the process. The valve F in is temporally locked during the instants t  X  195 X 205 h. In conse-quence, the substrate feeding is cut. The performance of regula-tory control shown in Fig. 12 is compared with the performance of D-FCM supervisory control ( Fig. 8 ) showed in Fig. 13 . In these figures only the evolution of process variables from time t  X  150 h is shown. For both control schemas, the chemical reaction is stopped just after the F in valve closing (see Figs. 12 (b) and 13 (d)).
F valve is also closed (see Figs. 12 (c) and 13 (e)) and the product concentration decreases ( Figs. 12 (a) and 13 (a)). The reaction is recovered as soon as the valve is released. However, the product removal from the reactor attains low rate under regulatory control (see Fig. 12 (a)). The valves remain almost closed (instant t  X  210 X 230 h), until a change of set-point occurs at t  X  230 h.
From this point, the regulatory control tries to keep the product concentration by means of small product removal (small values of
F and F out control signal) until a new critical situation is reached ( t  X  280 h) and the valves are closed, stopping the reaction again.
With supervisory control, the F in valve block leads to decrease the set-point from 40 g/l to 35 g/l as long as the locking remains.
Then, this set-point is restored (35 g/l), and the product removal is reestablished ( Fig. 13 (a)). When set-point variation occurs at t  X  230 h, the effects of F in valve closure are no longer sensed and, as in experiment 2, the process anticipates the critical situation and it attempts to recover it.

As a result of the experiment 3, it is possible to conclude that, although the developed supervisor was not specifically designed to work under fault caused by external agents, it is able to mitigate the fault damage on the process performance.
Another advantage of the proposed architecture is the fact that new features, such as alarm triggers for reaction critical situation and fault detection can be easily incorporated into the supervisor through the creation of new cognitive models. These new cogni-tive models can be interconnected with the former ones through common concepts or they can represent a new cognitive era. Thus a complete supervisor, as the one proposed in Fig. 2 can be incrementally built according to the developed functionalities. 6. Conclusions
This work developed a supervisory system based on dynamic fuzzy cognitive maps for the control of a fermentation process.
The supervisor represents an abstraction of expert knowledge about the process behavior under normal and critical operation and in presence of disturbances. The construction of the cognitive map was incrementally obtained through analysis of the process mathematical model and simulation results. The supervisor obtained is very simple, easy to implement and easy to under-stand, and it presented a good performance as shown in the simulated experiments.
 generation tasks (corresponding to a production campaign) in normal and critical operating mode, the supervisor can be easily expanded to incorporate other supervisory tasks, such as fault detection, gain scheduling, start-up and shut-down, among others. Such tasks correspond to new D-FCM models that can be easily interconnected in order to form a complete supervisor as shown in Fig. 2 . Currently, a D-FCM for process start-up and fault detection is under development.
 decision about process practice under different conditions such as normal, degraded, failure and others. Moreover, the FCM super-visor offers to engineers and designers opportunities to produce new insights about the process and an easy way to handle uncertainty and inaccuracies associated to real problems. is that the FCM are not able to model the various types of relationship existing in dynamical systems, especially those related to the feedback and the variables temporal behavior.
In fact, a cognitive map or a FCM built as the original proposal of Axelrod (1976) and/or Kosko (1986) only represents monotonic and symmetric causal relationships. In order to overcome this problem, this paper proposed the use of different types of concept (level, variation, decision and selection concepts) and relations (causal, fuzzy, time varying relationships) able to model all behavior of dynamic system variables. This new type of dynamic fuzzy cognitive map extends the approach proposed in Miao et al. (2001) that uses new forms of dynamic calculation for the cognitive map edges.

As the temporalized FCM proposed by Acampora and Loia (2011) , this new dynamic FCM has different time basis. Some portions of the cognitive map are continuously driven and others only are run from the occurrence of events. Also the model may undergo different cognitive evolution. Thus, it is possible to emulate the actions of a human operator for the correct super-vision of a complex control loops. The resulting supervisor model can be considered a hybrid system where continuous variables are monitored and computed at the same time basis and other specific actions are only performed from the occurrence of discrete events.

In conclusion, the presented D-FCM is an intelligent system with fuzzy reasoning and non-monotonic inference skills. The human knowledge is represented in a structured way by means of graphs, in which cause X  X ffect relations can be modified by means of rule bases. Through this mechanism, continuous dynamic behaviors and/or oriented event behavior can be equally modeled. Moreover, despite not explored in this paper, it is possible to on-line refine the D-FCM model, using learning techniques based on metaheuristics, such as evolutionary algorithms, simulated annealing, particles swarm optimization, or reinforcement learn-ing techniques. It is also possible to combine the several described concepts and relations in order to form a broad ontology allowing an easily development of D-FCM models.
 Acknowledgments
Financial support of the Brazilian Petroleum Agency (ANP) and the Research and Projects Financing Agency (FINEP) through Grant PRH-ANP/MCT:PRH10-UTFPR and Brazilian Research Council (CNPq) through Grants 304037/2010-9 and 311877/2009-5. References
