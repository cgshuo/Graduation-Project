 1. Introduction
Dependencies increase the risk of failure and the vulnerability in a complex critical infrastructure and among infrastructures. As an example, most major power grid blackouts that have occurred in the past were initiated by a single event (or multiple related events) that gradually led to cascading failures and the eventual collapse of the entire system ( Pourbeik et al., 2006 ). Rinaldi et al. (2001) classify dependency-related disruptions or outages as cascading, escalating, or common cause outages. A cascading phenomenon occurs when the failure of one component of the system induces an overload in adjacent components increasing their failure probability. If the overload can be compensated by the strength of the adjacent components, the cascade may be arrested, otherwise the cascade may become an avalanche causing a progressive and rapid disruption of all the system.
Recent electrical blackouts that occurred both in USA and Europe are typical cascading phenomena; since their effect has been catastrophic for millions of citizens, they have stimulated further research as also witnessed by the launch of public research programs in the EU (CRUTIAL ( http://crutial.erse-web.it ), IRRIIS ( http://www. irriis.org ), MANMADE ( http://www.manmadenet.eu )) and USA (The Complex Interactive Network s/Systems Initiative (CIN/SI), funded equally by EPRI and U.S. Department of Defense (DOD)). pendencies among critical infrastructures, and analyzing their impact are necessary steps for building interconnected infra-structures on which a justified level of confidence can be placed with respect to their robustness to potential vulnerabilities and disruptions. Modeling can provide useful insights of how component failures might propagate and lead to disturbances on the service delivered to the users.
 for the propagation of cascading failures is an open problem in the study of the dependability analysis of critical infrastructures. Two approaches can be accounted in the literature: (1) a pure statistical approach; (2) a phenomenological approach. The aim of the statistical approach is to model how the appearance of a failure and the consequent overload can be redistributed, and to study the propagation of the cascade. A series of papers ( Dobson et al., 2002, 2004, 2005 ) proposes a statistical model called
CASCADE which is based on an abstract view of the cascading phenomenon. The system is assumed to be composed of many identical components randomly loaded. An initial disturbance causes some components to fail by exceeding the loading limit.
The failure of a component causes a fixed load increase for other components. Models of the dynamic redistribution of the load have been explored also in Motter and Lai (2002) , Crucitti et al. (2004) , Kinney et al. (2005) where the load redistribution is based on the definition of node efficiency which is a centrality measure based on shortest paths computation. The idea of computing centrality measures using only the shortest paths has been criticized in Newman (2005) with the motivation that the intrinsic redundancy of the network is neglected. Woolf et al. (2007) consider networks transporting generic packets, that are constructed in such a way to be affected by avalanche-like breakdown originated by the congestion of a node. Given a source node and a destination node, the packets are transported following the shortest path between the two nodes. The load (or flow rate) of a node is based purely on the topology of the network, and in particular on the number of shortest paths passing through that node. The introduction of new nodes or links in the network may cause the congestion of a particular node causing its fall. This event determines the redistribution of the load among the nodes of the network, possibly causing other congestions, and in the worst case, the disconnection of a subnetwork.

In the phenomenological approach ,anattemptismadetobuilda physical scenario that leads to the comprehension of the propaga-tion of the cascading phenomenon. Typical examples of this approach in the literature can be found in DeMarco (2001) ,
Chowdhury and Baravc (2006) , Lininger et al. (2007) , Faza et al. (2007) . In particular, Chowdhury and Baravc (2006) discuss the possible evolution of various failure scenarios related to the IEEE 118 bus test system. An effort to propose a formal approach to a failure scenario is discussed in Faza et al. (2007) resorting to a chain of conditional probabilities. However, the proposal is incomplete: it does not take into account the dynamic of the cascade and it is not suitable for quantitative evaluations. In Bobbio et al. (2009) ,we showed that Bayesian Networks (BN) ( Langseth and Portinale, 2007 )  X  and more properly dynamic Bayesian networks (DBN) ( Montani et al., 2008 )  X  can provide a very valuable framework for modeling and analyzing dynamic phenomena as those arising in the propagation of cascading failures. DBN represent the evolution of the cascading phenomenon in a more physical way with respect to the abstract statistical models. In particular, in Bobbio et al. (2009) , we showed how a series/parallel dia gram representing the structure of the power grid, can be converted into the equivalent DBN which undergoes inference p rocedures in order to compute predictive or diagnostic measures concerning th e state of the general system, or the state of its elements.

It is worth noting that the work in Torres-Toledano and Sucar (1998) introduced an algorithm for automatically converting a reliability block diagram (RBD) ( Sahner et al., 1996 ), with series and parallel connections, into a BN. In particular, according to
Torres-Toledano and Sucar (1998) , lines in parallel have to be connected through an AND node (since the overall parallel circuit fails if all the lines are outaged), while lines in series have to be connected through an OR node (since the overall series circuit fails if at least one of the lines is outaged). With respect to our methodology, such an algorithm is limited to binary variables. On the other hand, in Bobbio et al. (2009) , we represented the state of lines and modules by means of multi-state (namely three-states) variables, and we generalized the OR and AND nodes into the nodes representing the state of series or parallel modules.
Moreover, if a line l gets outaged or overloaded, the lines affected by l get overloaded, and do not directly fail: they might fail subsequently. An ordinary BN, which could manage multi-state variables, cannot deal with this kind of temporal dependency, and this justifies our choice of relying on a DBN.

This paper extends Bobbio et al. (2009) in several directions: (1) in Bobbio et al. (2009) , we did not consider the possibility to repair outaged lines; in this paper, we take into account such possibility in the case study and in the DBN model. (2) In Bobbio et al. (2009) , the rules to convert a series or parallel module into DBN were limited to the case where the module is composed by two lines; in this work, we generalize the rules in such a way to be applied to a module composed by any number of elements which can be lines or in turns modules. The rules consider the possibility of repair. (3) For the sake of brevity, in Bobbio et al. (2009) ,we proposed a small case study ( Fig. 3 ) to be modeled and evaluated in form of DBN; in the current paper, we deal with a larger example ( Fig. 2 ), still inspired to the power grid case study presented in Chowdhury and Baravc (2006) .

This paper has the following structure: Section 2 describes how a power grid can be structured in terms of series and parallel modules, and presents the case study. Section 3 describes in details the assumptions we make about the dependencies arising among the elements of the power grid as a consequence of their organization in series or parallel modules; such assumptions determine the state of each element of the power grid. Section 4 presents the main features of DBN models, while Section 5 provides the rules to map the series/parallel diagram of a power grid into the equivalent DBN, taking into account the outage or repair events, and the dependencies defined in Section 3. According to such rules, in Section 6 we present the DBN model of the case study. Finally, Section 7 presents the quantitative values of prediction and diagnostic measures computed on such model by means of inference procedures. 2. Series and parallel modules
The aim of an electrical power grid is transporting the electrical power from the generators to the consumers. This can be done by means of the electrical lines composing the power grid and connecting its nodes. We assume that such lines can be structured in series or parallel modules, in such a way that more than one path may be available between two nodes of the grid. This mechanism allows the delivery of the electric power to a node, even though the outage of a subset of lines has occurred.
The elements composing a module can be single electric lines or inner modules. A series module requires that the power is transported along all the elements composing the module. So, if one element of the series fails, the transport of power along the series is interrupted. On the other hand, in a parallel module, the elements (branches) composing it, establish several parallel ways to transport the power; therefore if one elements fails, the other elements can still be exploited to this aim.

Thecasestudy : The IEEE 118 bus test case depicted in Fig. 1 and described in Chowdhury and Baravc (2006) , is an example of a power grid. In this paper, we concentrate on a subpart of this test case composed by the nodes 11, 12, 15, 17 only, and the electric lines realizing the connections among such nodes, as shown in Fig. 2 a. For the sake of simplicity and to facilitate the comprehension, we consider such a subpart in isolation; this means that we do not take into account the other nodes and the other lines connected to 11, 12, 15 and 17, that are instead present in the complete power grid in Fig. 1 .Forinstance,in Fig. 1 , the node 11 is connected to 4 by means of the line 4 X 11, or by means of the series composed by 4 X 5 and 5 X 11, but we omit them in the case study. Still for the sake of simplicity, we assume that the aim of the power grid portion in Fig. 2 a, is the transport of the electrical power from the node 11 to 15. We also suppose that this can be done by means of the direct line 11 X 15, or through the node 12: the electrical power can be transported from 11 to 12 by means of the line 11 X 12, then the node 15 can be reached by means of the line 12 X 15, or by means of the path composed by 12 X 17 and 17 X 15. In particular, the line 17 X 15 is redundant: 17-15A and 17 X 15B are actually present in the case study. Therefore the electric power can be transported from the node 11 to 15, through four distinct paths composed by electric lines: 1. [11 X 15] 2. [11 X 12, 12 X 15] 3. [11 X 12, 12 X 17, 17 X 15A] 4. [11 X 12, 12 X 17, 17 X 15B]
If a subset of such paths becomes unavailable for any reason, the other paths can be still exploited to transport the electrical power. the power grid portion in Fig. 2 a, become more visible if they are modeled as the series/parallel diagram in Fig. 2 b.
 diagram as a particular form of RBD. In a RBD, the basic components are structured in series or parallel modules, in such a way to show which combinations of components have to be working in order to determine the system functioning. In particular, a component is represented in form of Boolean binary variable expressing the working (value 1) or the failed state (value 0), while the state of a module is set according to Boolean operators (AND for the series module, OR for the parallel module).
Moreover, in a RBD, the state of a component is independent from the state of the other ones.

In the series/parallel diagrams used in this paper, the state of a basic component (electric line) is instead represented by a ternary variable because we assume that an electric line can be in one of these three states: normal, overloaded or outaged (as described in
Section 3). As a consequence, the current state of a series or parallel module does not obey to Boolean operators, but it is set according to specific rules, as explained in Section 3 ( d
Moreover, we assume the presence of dependencies among the states of the components, as described in Section 3 ( d 1
Fig. 2 b shows the series/parallel diagram modeling the structure and the paths inside the power grid portion in Fig. 2 a: the grid consists of the main parallel module P1 whose elements (branches) are the line 11 X 15 and the series module S1. This means that the electric power coming from the node 11 can reach the node 15, through at least one among 11 X 15 and S1. The series
S1 is composed by the line 11 X 12 and the parallel module P2; therefore the electric power must move through both 11 X 12 and
P2, in order to reach the node 15 along S1. The module P2 is composed by two elements: the line 12 X 15 and the series S2. This means that the electric power coming from the line 11 X 12 can be transported to the node 15 through 12 X 15 or S2. The series S2 contains the line 12 X 17 and the parallel module P3, so the power transported by S2 must move through both elements. Finally, the module P3 is composed by the redundant lines 17 X 15A and 17 X 15B.

Ordering elements : In this paper, we suppose that in the series/ parallel diagram of a power grid, the elements composing a series module can be ordered from left to right, while the elements composing a parallel module can be ordered from up to down. So, if a module M is composed by the ordered elements e 1 , y ( n
Z 2), given the element e i we can identify its preceding element e (if any) and its following element e i +1 (if any). For example, in
Fig. 2 b, in the parallel module P1, S1 is the following element of the line 11 X 15, while in the series module S2, P3 is the following element of 12 X 17.

We introduce now the concept of module X  X  first line : given a module whose elements are lines, the identification of the first line is straightforward, thanks to the order assigned to the lines. If instead the elements composing a module M are in turns modules, we need some criterion to detect the first line of M .
This is achieved by applying the recursive function first to M ,as coded in Table 1 ; such function explores recursively the first elements ( item ( e ,1)in Table 1 ) inside M until one of them is a line. Such line is the first line of M .

As an example, let us consider the module M1 in Fig. 3 ;we apply the function first ( Table 1 ) to M1: M1 is a module, in particular a series composed by M2 and 11 X 12, in such order; therefore first is applied recursively to the first element M2. M2 is an inner parallel module composed by M3 and 5 X 11, in such order; so, first is applied to M3. M3 is a series module composed by the ordered elements 5 X 4 and 4 X 11: first is applied to 5 X 4 which is a line, so 5 X 4 is finally returned as the first line of the module M1. If we apply the function first to the module P1 in Fig. 2 b, the line 11 X 15 is returned.

The order of the elements and the identification of the first line of a module, will support the description of the dependencies arising among the elements of the power grid (Section 3). 3. Dependencies arising in modules
According to Chowdhury and Baravc (2006) , we assume that each element (line or module) can be in one of the following states: normal , overloaded ,or outaged (failed). The normal state is the initial one; an element e becomes overloaded as a conse-quence of the outage of another element e u having some influence on e according to the structure of the power grid; then, the overload may be propagated from e to other elements. The outage state can be reached from both the normal and the overload state: in the case of lines, such a state transition is a stochastic event ruled by some probability distribution; the state of a module instead, depends on the state of its internal elements. Moreover, we assume that an outaged line can be repaired; such an event is still stochastic and determines the normal state of the line and possibly of other elements influenced by the repaired line.
Initially all the elements are in the normal state; any state transition by any portion of the power grid, is directly or indirectly originated by the outage or the repair of some line. We assume that this is due to the dependencies holding among the grid elements. If we consider a module M composed by the elements (lines or modules) e 1 , y , e n , we suppose that three particular kinds of dependency (namely d 1 , d 2 , d 3 ) hold among e , y , e n , M : ( d ) the dependency between the state of e i and the state of the ( d ) the dependency among e 1 , y , e n due to their outage or repair; ( d ) the dependency of the state of M on the states of e 1 ,
The first kind of dependency ( d 1 ) establishes that if any element (line or module) e i of M is overloaded for any reason, then the overload has to be propagated to the following element e on the contrary, e i is in the normal state, such state has to be propagated to e i +1 . This holds both in the case where M is a parallel module, and in the case where M is a series module. The second ( d 2 ) and the third kind ( d 3 ) of dependency are ruled according to the type of module:
Series module : Let us consider first the case where M is a series module: ( d ) the direct consequence of the outage of an element e i of M ,is M1 ( d ) The series module M is in the normal state if all the elements
Parallel module : We consider now the case where M is a parallel module: ( d ) if at least one element among e 1 , y , e n is outaged, the ( d ) The parallel module M is in the outage state if all the
Overload and normal state propagation : We now better specify the meaning of overload and normal state propagation mentioned in the description of d 1 and d 2 . The overload state propagation to the element e occurs as follows: if e is a line and is currently normal, then e turns overloaded; if instead e is a module of any kind, then the overload state has to be propagated to its internal lines. This is achieved by exploiting the concept of module X  X  first and f 1 is in the normal state, then f 1 turns overloaded and as a consequence of d 1 , such state is recursively propagated to the other lines inside e , eventually contained inside inner modules.
The propagation of the normal state to the element e occurs in a similar way: if e is a line and is currently overloaded, then e turns normal; if instead e is a module and its first line f 1 is overloaded, then f 1 turns normal and such state is propagated to the other lines inside e as a consequence of d 1 .
 effects on a outaged line. We assume that a line l in such state, undergoes a repair process. When this process is completed, l turns to the normal state, but as an effect of d 1 or d 2 immediately turn overloaded. Fig. 4 shows the possible state transitions by a line.
 happen that both d 1 and d 2 hold for the same line. If both dependencies are propagating the same state (overload or normal), then the application of any of them has the same effect.
If instead one dependency is propagating the overload state, and the other one is propagating the normal state, then the dependency propagating the overload is applied. The dependency type d 3 is never concurrent with d 1 or d 2 because d 3 concerns modules, while d 1 and d 2 actually influence lines.

Assumptions : The three kinds of dependency ( d 1 , d 2 , d consequent rules setting the state of lines and modules, are all assumptions that we make about the system behavior, with the purpose of simplifying the case study and its modeling in DBN form, for the sake of comprehension. These assumptions are inspired to the real functioning of lines and modules, however, they may not exactly fit the effective behavior of a power grid. For instance, we suppose that in a parallel module, the outage of an element causes the overload of the other working elements ( d a real power grid, this is true if the number of elements is low, but if the redundancy degree in the parallel module is particularly high, the outage of one element may not cause an effective overload of the other elements. Another case is the assumption that in a series module the state of an element e i may influence the state of the following element e i +1 , but not the state of e described later, we suppose that the outage rate of an overloaded line depends on the direct cause of the overload (another overload or an outage). An alternative situation is the case where the outage rate of a line grows proportionally to its overload degree, given by the number of parallel outaged elements.

To conclude, we may consider more realistic assumptions about the power grid behavior and state dependencies, such as those we mentioned above. This may lead to more complicated rules that can be still modeled in DBN form, by adding more influence arcs in the model, by modifying the entries of the conditional probability tables (CPT) associated with the DBN variables (Section 4), or by adding new variables.

Cascading scenario : In order to clarify all the dependencies among the grid elements, described so far, we consider a possible scenario in the power grid portion depicted in Fig. 2 and described in Section 2. We assume that all the elements are initially in the normal state. From such situation, the grid may reach many elements state configurations, due to the occurrences of outages and repairs of lines, and their consequent effects because of dependencies. Therefore, we concentrate on the scenario gener-ated by the occurrence of this sequence of events: (1) the outage of the line 12 X 15, (2) the outage of the line 12 X 17, (3) the repair of the line 12 X 17, (4) the repair of the line 12 X 15. (1) Let us consider the first event: in the case study in Fig. 2 b, the parallel module P2 is composed by 12 X 15 and the series module S2; therefore, the outage of 12 X 15 determines the propagation of the overload state to S2 ( d 2 in the parallel module). Since S2 is a module, the overload state is actually propagated to its first line, 12 X 17, which turns from normal to overloaded. Because of d 1 , the overload has to be propagated to the parallel module P3 which is the following element of 12 X 17 in S2. So, the first line of P3, 17 X 15A, turns from normal to overloaded, and still because of d 1 , the line 17 X 15B becomes overloaded as well. The other lines in the power grid maintain the normal state. According to the current state of all the elements and d 3 both types of modules, all the modules in the grid are in the overload state. Such configuration of the elements states is depicted in Fig. 5 a. (2) The next event is the outage of the line 12 X 17. According to d 2 in the series module, the outage of 12 X 17 causes the propagation of the normal state to its following element in S2 that is P3. This means that the first line of P3, 17 X 15A, turns from overloaded to normal; then, as a consequence of d 1 , also the line 17 X 15B turns normal as well. Actually the module P3 is currently isolated because of the outage of 12 X 17, so P3 cannot be overloaded. According to the current state of all the elements and to d 3 , P3 becomes normal, while S2, P2 and S1 become outaged. In particular, S1 composes the main parallel module P1, together with the line 11 X 15; therefore the outage of S1 determines the state transition from normal to overloaded by 11 X 15, because of d in the parallel module. The overload of 11 X 15 determines in turns the same state for 11 X 12, first element of S1 ( d 1 to d 3 in the parallel module, P1 maintains the overload state. The current state configuration is shown in Fig. 5 b. (3) The third event in our scenario consists of the repair of the outaged line 12 X 17. This event would lead to the normal state of
P1 ov.
P1 ov. 12 X 17, but 12 X 17 turns overloaded just after the repair, because 12 X 17 is the first line of S2, and S2 composes P2 with the line 12 X 15 currently outaged ( d 2 in the parallel module). Then, due to d 1 , the overload is propagated to P3, the following element of 12 X 17, by setting the lines 17 X 15A and 17 X 15B to overloaded. According to d 3 , such state transitions cause the overload state of
P3, S2, P2 and S1. In particular, S1 turns from outaged to overloaded: since 11 X 15 and S1 compose the main parallel module P1, and none of them is outaged, the state of 11 X 15 is set to normal ( d 2 in the parallel module). Also 11 X 12 turns to normal ( d 1 ) and P1 maintains its overload state ( d 3 in the parallel module). The current state configuration of the grid is the same as the one after the outage of 12 X 15 ( Fig. 5 a). (4) The last event occurring in the scenario is the repair of the outaged line 12 X 15. In this case, 12 X 15 actually turns to normal, since S2 and 11 X 12 are not outaged ( d 2 in the parallel module).
Because of d 1 , the normal state of 12 X 15 is propagated to its following element in P2 that is S2. This means that the first line of
S2, 12 X 17, turns from overloaded to normal, and still because of d , the normal state is propagated from 12 X 17 to P3 causing the normal state of 17 X 15A and 17 X 15B. All the lines are now in the normal state and according to d 3 , all the modules in the grid are now in the same state. The power grid has returned to the initial state of the scenario.

The role of d 1 in the DBN model : As described above, the aim of the dependency kind d 1 is the propagation of the overload or normal state, which is realized in several steps, one for each element involved in the propagation. Actually, d 1 arises as the direct or indirect consequence of an outage or repair event inside a certain module; in other words, d 1 is caused by the previous occurrence of d 2 . Because of this, we may have assumed that the propagation of the overload or normal state after an outage or repair event, happens in a single step just after the event, and involves immediately all the elements in the power grid, influenced directly or not, by the event. In this way, the overload or normal state propagation would be directly carried out by d , and d 1 would not be necessary. As an example of this approach, if we assume the initial normal state for all the elements in the power grid in Fig. 2 , the outage of the line 12 X 15 would cause the overload of the elements 12 X 17, 17 X 15A and 17 X 15B, in a single step after the outage event, instead of the several steps described in the scenario.

However, this view of the cascading effect phenomenon would lead to a consistent increase of the influence arcs in the dynamic
Bayesian network (DBN) model of the power grid, with the consequent increase of the model complexity in terms of graph, conditional probability tables (CPT) and inference analysis (Section 4). Besides this, the rules to convert a series/parallel diagram into
DBN would be decisively more complicated and less generalized than those presented in Section 5. Therefore the role of d cascading effects phenomenon in the power grid, and then in the
DBN model, allows to simplify the model construction and analysis.

The only drawback of d 1 consists of the fact that in the DBN, the state propagation along the elements may take several time slices (Section 4) instead of one; however, the effect of d elements state is the same as in the case of an immediate propagation. This is assured by the rule about the concurrency between d 1 and d 2 and its application in the CPT entries (Section 6).

Setting outage and repair rates : As already mentioned, the outage and repair events involving the lines are stochastic events: we assume that their probability to occur is ruled by the negative exponential distribution . In the case of outage events, the distribution parameter is the outage rate. We suppose that such rate changes according to the current state of the line: if the outage rate of the line l in the normal state is l , such rate is increased during the overload state; in particular, if the overload of l is directly caused by the overload of another element, the outage rate of l becomes a l . If instead the overload of l is directly caused by the outage of another element, the outage rate of l becomes bl , with b 4 a 4 1. In other words, the outage probability of an overloaded line is greater than the outage probability of a normal line. Such an increase depends on the direct cause of the overload. In the case of repair events, the distribution parameter is the constant repair rate m .
 the elements state configuration depicted in Fig. 5 a. The lines 11 X 15 and 11 X 12 are in the normal state, so their outage rate is l .
The overload state of the line 12 X 17 is directly caused by the outage of 12 X 15 ( d 2 in the parallel module); therefore the outage rate of 12 X 17 is bl . As a consequence of d 1 , the overload of 17 X 15A is caused by the overload of 12 X 17, and in turns the overload of 17 X 15B is due to the overload of 17 X 15A; so, a l is the outage rate of both 17 X 15A and 17 X 15B. Finally, the line 12 X 15 is the only in the outage state: its repair rate is m .
 m  X  0 : 01h 1 . 4. Ordinary and dynamic Bayesian networks be classified as combinatorial or state-space based. Since combinatorial models (like Fault trees and RBD Sahner et al., 1996 ) assume that components are statistically independent, they cannot be invoked in the present case. State-space based models (like Markov chains or Petri nets Sahner et al., 1996 ) rely on the specification of the whole set of the possible system states so that the stochastic behavior of each component may depend on the state of all the other components. This flexibility is very seldom exploited in practice and the state space description appears over-specified with respect to the real modeling needs. Furthermore these models incur rapidly in the state space explosion. space based models are Bayesian networks (BN) ( Langseth and
Portinale, 2007 ). We argue that BN are a possible and suitable approach to the qualitative and quantitative modeling of cascad-ing effects.
 knowledge in probabilistic systems and have been applied to a variety of real-world problems. BN are defined by a directed acyclic graph (DAG) in which nodes corresponds to discrete random variables having a conditional dependence on the parent nodes. Root nodes are nodes with no parents, and marginal prior probabilities are assigned to them. Since each node conditionally depends only on the parent nodes, BN provide an interesting framework to include localized dependencies like probabilistic gates, multi-state variables, dependent failures and uncertainty in model parameters ( Langseth and Portinale, 2007 ). Furthermore,
BN allow not only a forward (or predictive) analysis but also a backward (diagnostic) analysis, where the posterior probability of any set of variables can be computed.
 providing an explicit discrete temporal dimension ( Weber and
Jouffe, 2003 ; Montani et al., 2008 ). They represent a probability distribution over the possible histories of a time-invariant process, thus they allow to represent more complex kinds of dependencies with respect to BN. The advantage with respect to a classical probabilistic temporal model like Markov Chains, on the other hand, is that a DBN is a stochastic transition model factored over a number of random variables, over which a set of conditional dependency assumptions is defined. The assumption of time invariance ensures that the dependency model of the variables is the same at any point in time. Typically in a DBN, 2 time slices are considered in order to model the system temporal evolution, and a DBN represents a discretized Markov chain process; this form of DBN is usually called 2TBN (two time-slice temporal Bayesian network), as in Murphy (2002) , Weber and Jouffe (2003) .

Given a set of time-dependent state variables X 1 y X n and given aBN N defined on such variables, a DBN is essentially a replication of N over two time slices t D and t (being D the so called discretization step), with the addition of a set of arcs representing the transition model. Let X i t denote the copy of variable X slice t , the transition model is defined through a distribution
P  X  X t j X t D i , Y t D , Y t where Y t D is any set of variables at slice t D different from X i (possibly the empty set), and Y t is any set of variables at slice t different from X i (possibly the empty set). Arcs interconnecting nodes at different slices compose the so-called inter-slice dependency model, while arcs interconnecting nodes at the same slice compose the intra-slice dependency model.
The two slices of a DBN are often called the anterior and the ulterior layer.

Given a DBN, inter-slice edges connecting a variable in the anterior layer to the same variable in the ulterior layer are called temporal arcs ; in other words, a temporal arc connects variable to variable X i t . Their role is in defining the nodes they are connecting as copies of the same variable at different slices.
The dependencies of a node are quantified in a DBN by means of conditional probability tables (CPT). The probability in every table entry has to be set according to the state of the parent nodes (including the historical copy of the node at hand).

Concerning the analysis of a DBN, different kinds of inference algorithms are available. In particular, let X t be a set of variables at time t and y a : b any stream of observations from time point a to time point b (i.e. a set of instantiated variables Y i j with a r j r b ). The following tasks can be performed over a DBN: predicting a future state taking into consideration the observation up to now (if h  X  0 the task is more properly called filtering or monitoring ); what happened l steps in the past, given all the evidence (observations) up to now.
 Different algorithms, either exac t (i.e. computing the exact prob-ability value that is required by the task) or approximate, can be exploited in order to implement the above tasks ( Murphy, 2002 ). 5. Conversion rules from series/parallel diagram to DBN
We propose a methodology for converting a series X  X arallel diagram, like the one in Fig. 2 b, into a DBN. The methodology consists of a set of rules to convert a series module, and another set to convert a parallel module. By applying such rules first to the most internal modules, then to the outer ones, a complete series/ parallel diagram such as the on in Fig. 2 b, can be mapped in the equivalent DBN.

The DBN representation of a module must take into account the fact that an element of the grid can assume three distinct states: normal, overloaded and outaged (Section 3); therefore in the DBN, each element (line or module) e 1 is represented by the three states variable e 1 . Two instances of e 1 are present, one in the time slice t D , and one in the time slice t . In particular, the instance in t is indicated as e 1 #. e e 3 e 3 #
M M#
Lines : Outage and repair events concern lines and are related to the temporal evolution of such elements. In the DBN, such events concerning the line e 1 are represented by the arc ( e 1 , e (temporal arc) connecting the two instances of the variable e , each in one time slice.

Modules : Let us consider a module M composed by the elements e1, e2, e3. We assume that e1 and e3 are lines, while e2 is an inner module whose first line (Section 2) is f1. According to this, the DBN of M must contain the following variables: e 1 , e 2 , e 3 slice t D ,and e 1#, e 2#, f 1 #, e 3 #, M # in the time slice t .Sincee1 and e3 are lines, the arcs ( e 1 , e 1 #) and ( e 3 , e 3 while an inner DBN represents e2 and its internal elements, including f1. The DBN modeling M must represent the three kinds of dependency ( d 1 , d 2 , d 3 ) described in Section 3. module, as shown in Fig. 6 a where e1, e2, e3 are ordered from left to right. d 1 concerns the overload and normal state propagation between an element and its following one inside a module; in the case of M, d 1 holds between e1 and e2, and between e2 and e3. d in the series module, in case of outage of an element, propagates the normal state to the following element; in the case of M, d holds between e1 and e2, and between e2 and e3. So, in M, d d involve the same couples of elements. Moreover, since e2 is a module, d 1 and d 2 act directly on its first line f1 (Section 3). In the DBN modeling M ( Fig. 6 b), d 1 and d 2 holding between e1 and e2 are represented by the arc ( e 1 , f 1 #), while d 1 and d between e2 and e3 are represented by the arc ( e 2 , e 3 #). d establishes the state of a module according to the states of its elements: the state of M depends on the states of e1, e2, e3. In the DBN in Fig. 6 b, d 3 is represented by the arcs ( e 1 , M ), ( e in the time slice t D , and ( e 1 #, M #), ( e 2 #, M #), ( e time slice t .

The DBN in Fig. 6 b captures the behavior of a series module composed by three elements. Such model can be generalized in a series M composed by the elements e 1 , y , e n ( n Z 2); the general DBN model consists of: the variables M , e 1 , y , e n , M #, e 1 #, y , e n #, an arc ( e i , e i +1 #) for each element e i +1 ( i Z 1) which is a line, an arc ( e i , first ( e i +1 )#) for each element e i +1 module whose first line is given by the function first ( e ( Table 1 ), the arcs ( e i , M ) and ( e i #, M #) for each element e an arc ( e i , e i #) for each element e i which is a line, an inner DBN containing e i , e i #, first ( e i ), first ( e element e i that is a module.
 Each variable in the resulting DBN will be characterized by a CPT expressing the dependencies influencing the element repre-sented by the variable. In particular, the CPT of the variable e provides the probability of each possible value of e , given each possible combination of values of the variables influencing e . The CPT of M and of M # incorporates d 3 in the case of a series module (Section 3), while the CPT of e i +1 representing a line will express d and d 2 with respect to its preceding element e i . The CPT of the variable representing the first line f 1 of the module e j +1 express d 1 and d 2 with respect to e j , together with other dependencies arising among the internal elements of the series or parallel module e j +1 . Actually f 1 may be the first line of more than one module, and its CPT must capture all the dependencies arising on it. To clarify this, Section 6 provides the DBN model of the case study depicted in Fig. 2 b, showing and commenting the CPT of each variable.

Parallel module : Let us consider now the case where M is instead a parallel module whose elements are the line e1, the module e2, and the line e3, ordered from up to down as shown in Fig. 7 a. In the DBN model of M ( Fig. 7 b), since e1 and e3 are lines, the arcs ( e ( e , e 3 #) appear in the DBN, while an inner DBN represents e2 and its internal elements, including its first line f1. Besides this, the
DBN modeling M must represent the three kinds of dependency ( d , d 2 , d 3 ) in case of parallel module (Section 3). d 1 in the parallel module has the same effect as in the series one. So, in the case of M as parallel module, d 1 still holds between e1 and e2, and between e2 and e3. d 2 in the parallel module, in case of outage of at least one element, propagates the overload state to the other elements of the module, and in case of no outaged elements, d 2 propagates the normal state to the first element. Therefore d 2 holds between any element of M and all the other ones. In particular, since e2 is a module, d 1 and d directly on its first line f1. In the DBN model of M ( Fig. 6 b), the arc ( e , f 1 #) represents both d 1 and d 2 holding between e1 and e2, while the arc ( e 2 , e 3 #) represents both d 1 and d 2 holding between e2 and e3. The arcs ( e 1 , e 3 #), ( e 2 , e 1 #), ( e 3 d holding between e1 and e3, between e2 and e1, between e3 and e1, between e3 and e2, respectively. d 3 in the parallel module still establishes the state of a module according to the states of its elements: in the DBN in Fig. 6 b, d 3 is represented by the arcs ( e , M ), ( e 2 , M ), ( e 3 , M ) in the time slice t D , and ( e ( e #, M #), ( e 3 #, M #) in the time slice t .

The DBN in Fig. 7 b captures the behavior of a parallel module composed by three elements. Such model can be generalized to a parallel module M composed by the elements e 1 , y , e n ( n general DBN model contains: the variables M , e 1 , y , e n , M #, e 1 #, y , e n #, an arc ( e i , e j #) for any couple of elements such that i a line, an arc ( e i , first ( e j )#) for any couple of elements such that i j and e j is a module whose first line is given by the function first ( e j ) (Section 2), the arc ( e i , M ) and ( e i #, M #) for each element e i an arc ( e i , e i #) for each element e i which is a line, an inner DBN containing e i , e i #, first ( e i ), first ( e element e i that is a module.

The CPT of M and of M #incorporates d 3 in the case of the parallel module (Section 3), while the CPT of e i +1 representing a line will express d 1 with respect to its preceding element e i ,and d respect to any e k such that k a i . The CPT of the variable representing the first line f 1ofthemodule e j +1 will express d 1 with respect to e , d with respect to any e k such that k a j , and any other dependencies arising among the internal elements of the series or parallel module e j +1 . Examples of CPT are reported in Section 6. 6. The DBN model of the case study
Following the conversion rules defined in Section 5, we have been able to translate the series/parallel diagram in Fig. 2 b into the DBN in Fig. 8 . For instance, in Fig. 8 , the sub-network composed by the variables P1 , 11 X 15 , S1 , P 1#, 11 X 15# , S1# and 11 X 12# ( 11 X 12#  X  first(S1) ) has been obtained by applying the rules for the parallel module. The sub-network composed by the variables S1 , 11 X 12 , P2 , S1 #, 11 X 12# , P 2# and 12 X 15# ( 12 X 15#  X  first(P2) ) has been obtained by applying the rules for the series module.

The state of each element (line or module) in the series/parallel diagram, has been represented in the DBN by a couple of instances ofthesamevariable;oneinstancebelongstothetimeslice t D ,the other instance to t . For instance, S1 in the series/parallel diagram, is represented in the DBN by S1 in t D and S1 #in t .Avariable representing a module in a certain time slice, depends on the variables in the same slice, representing the elements of the modules. For instance, S1 in t D depends on 11 X 12 and P 2, while P 1# in t is influenced by 11 X 15# and S1 #. The CPT of S1 is reported in
Table 2 and represents the type of dependency d 3 in the case of a series module (Section 3) whose state depends on its two elements (11 X 12 and P2); the same CPT can be assigned to the variables S1 #,
S2 , S2 #. Table 3 presents the CPT of the variable P 1; such CPT incorporates d 3 in the case of a parallel module (Section 3) whose state depends on the states of its two elements (11 X 15 and S1). This CPT is the same as the CPT of P 1#, P 2, P 2#, P 3and P 3#.
The variables representing lines in the time slice t D do not depend on any variable; for this reason, their CPT provides the initial probability distribution of the states of the line: a line is initially in the normal state with probability 1, while the initial probability of the overload and outage state is null. The variables representing lines in the time slice t depend on their copy in t D , and on variables still in t D representing elements influencing the lines state. Because of this, the CPT of a line X  X  variable in t provides the probability of the possible states of the line according to its state and the states of the other influent variables in the previous time slice t D . The CPT respects d 1 and d (Section 3). The values of the probabilities in the CPT are given by the negative exponential distribution ruling the outage or repair probability according to the current outage or repair rate, respectively. If the line is not outaged, the outage rate can be l , a l or bl ; if the line is outaged, the repair rate is m (Section 3). The choice of the outage rate depends on the state of the line in t (normal or overloaded) and in case of overload, on its direct cause in t D .

The CPT of 11 X 15# ( Table 4 ) captures the type of dependency d in case of parallel module, with respect to S1 , given that P1 is composed by 11 X 15 and S1 in such order; 11 X 15 is the first element of P1, so d 1 does not arise on 11 X 15. The entries of the CPT of 11 X 15# , influenced only by d 2 , are grouped into numbered triples, each concerning a particular state configuration of the variables influencing 11 X 15# : in the triples 1 and 2, S1 and 11 X 15 are both not outaged: so 11 X 15# may maintain its normal state or may become outaged according to the outage rate l (rate in case of normal state).
In the triple 3, S1 is outaged and 11 X 15 is normal, so 11 X 15# turns overloaded and may maintain such state or may turn outaged according to the outage rate bl (the direct cause of overload is an outage).

In the triples 4 and 5, the state configuration may be the effect of a repair involving S1 , previously outaged: no elements are now outaged, so 11 X 15# turns normal and may maintain such state or become outaged according to the outage rate l .
In the triple 6, S1 is outaged, but 11 X 15 is already overloaded, so 11 X 15# maintains such state or become outaged according to the outage rate bl .

In the triples 7 and 8, 11 X 15 is outaged and in case of repair, it has to turn normal because S1 is not outaged. Because of this, 11 X 15# may maintain the outage state or may become normal according to the repair rate m .

Finally, in the triple 9, 11 X 15 is outaged, but because of the outage state of S1 , in case of repair, it turns overloaded instead of normal. Therefore 11 X 15# maintains the outage state or turn overloaded according to the repair rate m .

The CPT of 11 X 12# ( Table 5 ) expresses d 1 and d 2 with respect to 11 X 15 : d 1 arises because S1 is the following element of 11 X 15 in P1, and 11 X 12 is the first line of S1; d 2 arises because 11 X 15 and S1 are the elements of the parallel module P1. The entries of the CPT of 11 X 12# are grouped in numbered triples with the following roles: in the triple 1, d 1 arises because 11 X 15 is normal, but 11 X 12 is already in such state: 11 X 12# may maintain the normal state or may turn outaged according to the outage rate l (rate in case of normal state).

In the triple 2, d 1 arises because 11 X 12 is normal and 11 X 15 is overloaded: 11 X 12# turns overloaded and may maintain such state or may become outaged according to the outage rate a l (the direct cause of the overload is another overload).
In the triple 3, d 2 arises because 11 X 12 is normal and 11 X 15 is outaged: 11 X 12# turns overloaded and may maintain such state or may become outaged according to the outage rate bl (the direct cause of the overload is an outage).

In the triple 4, d 1 arises, but in this case, the normal state is propagated: 11 X 12 is overloaded and 11 X 15 is normal (possibly as a consequence of repair), so 11 X 12# turns normal and may maintain such state or may become outaged according to the outage rate l .

In the triple 5, d 1 holds because of the overload of 11 X 15 , but 11 X 12 is already overloaded: 11 X 12# may maintain such state or may turn outaged according to the outage rate a l .
In the triple 6, d 2 holds because of the outage of 11 X 15 , but 11 X 12 is already overloaded: 11 X 12# may maintain such state or may turn outaged according to the outage rate bl .

In the triple 7, 11 X 12 is outaged and in case of repair, 11 X 12# turns normal because 11 X 15 is normal ( d 1 ). So, 11 X 12# may maintain the outage state or may become normal according to the repair rate m .

In the triple 8, 11 X 12 is outaged and in case of repair, 11 X 12# turns overloaded because 11 X 15 is overloaded ( d 1 ). So, 11 X 12# may maintain the outage state or may become overloaded according to the repair rate m .

Finally, in the triple 9, 11 X 12 is outaged and in case of repair, 11 X 12# turns overloaded because 11 X 15 is outaged ( d 2 ). So, 11 X 12# may maintain the outage state or may become overloaded according to the repair rate m . d 1 and d 2 are both represented in the CPT of 12 X 15# ( Table 6 ): d holds with respect to 11 X 12 because 12 X 15 is the first line of
P2, the following element of 11 X 12 in the series S1; d 2 holds with respect to S2 because 12 X 15 composes the parallel module P2 together with S2. In this CPT, it may happen that both d 1 hold at the same time (they are concurrent). If so, the dependency that is propagating the overload is applied, as explained in Section 3. For instance, in the triple 4, 11 X 12 is overloaded while S2 is normal; d 1 arises because the overload of 11 X 12 should be propagated to 12 X 15# , but also d 2 holds because the normal state of S2 would determine the normal state of 12 X 15# . In this case, d is applied because it concerns the overload propagation: 12 X 15# may become overloaded or become outaged according to the outage rate a l . The same situation holds in the triple 13.
The variables 12 X 17# and 17 X 15B# have the same CPT of 11 X 12# ( Table 5 ), but 12 X 17# depends on 12 X 17 and 12 X 15 , while 17 X 15B# depends on 17 X 15B and 17 X 15A . Finally, the variable 17 X 15A# has thesameCPTastheoneof 12 X 15# ( Table 6 ), but 17 X 15A# depends on 17 X 15A , 12 X 17 and 17 X 15B . 7. Inference results
In this section, we compute several predictive and diagnostic measures by inferencing the DBN model depicted in Fig. 8 and representing the behavior of the power grid portion in Fig. 2 .
Predictive measures are computed by means of the filtering procedure, while diagnostic measures are computed by means of the smoothing procedure (Section 4). We assume that the parameters l , a and b determining the outage rate of the lines in the working or overload state, are set to 0.001h 1 , 1.2 and 1.5, respectively; the repair rate m is set to 0.01h 1 (Section 3). Moreover, we assume that all the lines are in the normal state at time t 0  X  0.
The DBN model has been designed and analyzed by means of the R ADYBAN tool ( Montani et al., 2008 ): both the filtering and the smoothing experiments are performed by means of the Junction Tree algorithm ( Murphy, 2002 ) for the exact inference of the DBN.
However, in DBN, the time is discretized according to a certain time step, and this leads to some approximation of the results, as mentioned in Section 8. In our experiments, we set such step to 1h.
 in Section 3 and deriving from the following events: the outage of the line 12 X 15, the outage of the line 12 X 17, the repair of 12 X 17, and the repair of 12 X 15. We suppose that we observe in all the experiments, the outage of 12 X 15 from time t 1  X  400h to time t 3  X  700h, the outage of 12 X 17 at time t 2  X  600h, and the overload of 12 X 17 at time t 3 . The fourth observation implies the repair event concerning 12 X 17 which turns to overloaded because of the outage of 12 X 15. According to the observations, the repair of 12 X 15 may be completed after t 3 . In the DBN of Fig. 8 , the observations are associated with the nodes 12 X 15 and 12 X 17.
Filtering : As a filtering experiment on the DBN, we predict according to the observations specified above, the probability of the states of the following elements of the power grid: 11 X 15, P3,
S2, P2, S1, P1. The prediction is performed for a mission time varying from 0 to 1000h. To this aim, in the inference (filtering) process, we query the DBN variables representing such elements in the time slice t . The results of the inference, as returned by the R
ADYBAN tool, are reported in Table 7 , while they appear in graphical form in Fig. 9 . We can notice that the probabilities of overload or outage of the elements gradually grow at 100, 200 and 300h because of the elapsing time. At time t 1  X  400h, we can see the effects of the observation of the outage of the line 12 X 15: the overload probabilities of all the elements, with the exception of 11 X 15, are increased in a relevant way with respect to their values at the previous times. Very similar probabilities are returned at time 500h because the outage of 12 X 15 is still observed and acts on the state of the other elements. Such values confirm the effects of the outage of 12 X 15 described in Section 3 and shown in Fig. 5 a.
At time t 2  X  600h, the observation of the outage of both 12 X 15 and 12 X 17, causes the following effects: the outage probability is very close to 1 for the modules S2, P2 and S1; the probability of the normal state of P3 and the probability of the overload state of 11 X 15 are increased in a considerable way. Such values confirm the effects of the contemporary outage of 12 X 15 and 12 X 17, described in Section 3 and depicted in Fig. 5 b. At time t we observe that 12 X 15 is still outaged, while 12 X 17 has turned overloaded, because of repair; as a consequence, the state configuration of the grid may return to the situation at time t depicted in Fig. 5 a. Actually the probabilities at t 3 are distributed among the three states in a way similar to the situation at t the times following t 3 , the repair of 12 X 15 may take place, with the effect of a possible return to the situation before the outage of 12 X 15 ( t 1 ). Actually the probability distribution among the three states at time 1000h is similar to the one at time 300h.
Smoothing : Besides predictions, we can compute smoothing measures on the DBN model. This can be useful in order to diagnose the possible causes of the system outage. In order to perform a smoothing experiment on the DBN in Fig. 8 ,wetakeinto account further observations, about the state of the main module: P1 is overloaded at times 100, 200, 300h; it is outaged at times 400, 500, 600, 700h; it is again overloaded at times 800, 900, 1000h. In the DBN model ( Fig. 8 ), such observations are associated with the node P 1. According to them, we perform the smoothing procedure on the DBN, by means of the R ADYBAN tool, with the aim of computing the probabilities of the states of the lines 11 X 15, 11 X 12, 17 X 15A, 17 X 15B. The variables representing such nodes in the time slice t are queried during the smoothing procedure. The results are reported in Table 8 and in Fig. 10 where we can notice high probabilities of outage for lines in several situations: from time 400h to time 700h, the probability that 11 X 15 is outaged is 1, because P1 is observed as outaged, so both its elements 11 X 15 and S1 must be in the same state. At time 700h, the probability of outage of 11 X 12 is about 0.9 because we observe that P1 is outaged and consequently S1 is outaged too, 12 X 15 is outaged and 12 X 17 is overloaded; this means that the only causes of the outage of S1 are 11 X 12 and P3: 11 X 12 is a more direct cause, so its probability of outage is considerably high, while the same measure for 17 X 15A and 17 X 15B composing P3, is lower because they are redundant. 8. Conclusions
In this paper, we have shown how cascading effects can be modeled by means of the DBN framework. DBN are a powerful instrument for modeling and analyzing dynamically dependent failure phenomena. Moreover, they enable a representation of the evolution of the cascading phenomenon in a more physical way with respect to the abstract statistical models. We took into account multi-state elements composing the power grid: in particular, we separated the working state into the normal and overloaded state. Besides outage events in the system, we considered the possibility of repair events. We have also pro posed generalized rules for converting the series/parallel diagram of the grid, into a DBN, which allows a quick DBN creation for any structure of the initial diagram. The overall approach has been successfully experimented on a case study inspired to Chowdhury and Baravc (2006) .

In the future, we plan to further investigate the potentialities of DBN in this application domain, by taking into consideration more complex and real forms of dependency among lines and modules, and their occurrence in cascading failure scenarios. In such an analysis, we will also consider computational complexity issues. As a general comment, the inference complexity of DBN depends on: (1) how much the net can be factorized, (2) how fine is the required discretization. With reference to the item (1), the role of the dependency type d 1 is the propagation of the overload or normal state, node by node in the DBN model, instead of a direct propagation, as described in Section 3. This reduces considerably the number of influence arcs in the DBN, and as a consequence, the connectivity level of nodes. In general, the DBN inference complexity may be reduced by applying the divorcing technique ( Jensen, 2001 ) which consists of increasing the model factorization if a particular node is influenced by many variables.
Another approach is based on clusters which are the independent modules of a DBN. Clusters can be detected and exploited in the inference procedure if the Boyen X  X oller algorithm ( Boyen and
Koller, 1998 ) is applied. This approach can be useful to speed-up the inference process, or to obtain approximate results. With reference to the item (2), in the experiments, the time discretiza-tion step must be set to a value which is relatively small with respect to the mean time to outage of the lines, and to the mission time. This allows an acceptable accuracy of the results despite of the time discretization, and the capture of all the dependencies among lines and modules, during the inference process. Acknowledgment
This work has been partially supported by the EU funded project CRUTIAL ( http://crutial.erse-web.it ).
 References
