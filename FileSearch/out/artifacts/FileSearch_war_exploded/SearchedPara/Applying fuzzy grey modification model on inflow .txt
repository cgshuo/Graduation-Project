 1. Introduction
Typhoons and extreme rainfall may result in multiple disasters and bring in large amounts of sediment which largely reduce the of high precision real-time forecast models which cannot only distribute the water resources appropriately but also enhance early warnings against natural disasters. The rainfall and flow of the reservoir are analysed through differential hydrological grey models, time series, and autoregressive integrated moving aver-age methods ( Otok and Suhartono, 2009 ). Additionally, other methods like the Artificial Neural Network (ANN) have been
Zhang et al., 2009 ). Studies show that the correlation between the rainfall and the flow is not as high as expected, and suggest the adoption of the concept of auto-regression of flow in predicting the reservoir inflow ( Wang and Liao, 2004 ; Collischonn et al., 2007 ).

Traditional regression analysis methods require a large num-ber of variables and need a large corpus of data from which to draw conclusions. The grey system uses four datasets to build the grey forecasting model ( Deng, 1989 ). Additionally, the grey model is not only applicable to forecasting the equal interval time series but is also applicable to the non-equal interval time series and the negative number series ( He and Hwang, 2007 ).

Yu et al. (2000) proposed the rainfall forecast model based on the grey model following the fuzzy regression technique. How-ever, the grey model regards the data set applying the Accumu-lated Generation Operation (AGO) as an exponential function. As a result, the forecasted values for original sequences with unsteady and centralised pattern are not ideal ( Li, 1990a , b ). Lin (2001) simulated the residual sequence obtained from grey model and combined it with the original predicted value to enhance the forecast accuracy. In order to enhance the forecast accuracy of the grey model, other studies improve upon the background value of the grey model and use superposition models, such as the Fourier series, to correct the periodic residues of the grey model and the exponential smoothing technique to correct the randomness of residuals of the grey model; the results show that the model can achieve higher levels of accuracy than that of the fuzzy forecast
The fuzzy theory uses the Membership Function to convert the subjective problems into values during the normalisation process, but it also needs to rely on membership functions and experience system theory focuses on the study of small sampling data. Its difference from the fuzzy mathematics lies in the context of clear denotation and uncertain connotation ( Liu, 2003 ). Therefore, the fuzzy theory is designed for fuzzy or incomplete information.
Without any complicated calculation processes, the theory can still the field of hydraulic engineering, many researchers have conducted numerous studies on fuzzy theo ry that have elicited excellent performance. For example, Wang ( 1999) uses fuzzy decision analysis to regulate the reservoir operation during periods of flooding.
This paper investigates the modified grey model for predicting the reservoir X  X  inflow. In the proposed grey model, the back-ground values are modified by integration. Furthermore, the
Fourier series and exponential smoothing techniques are utilised to correct periodical residues and random residuals for forecast-ing. As typhoons cause significant changes in the inflow, we apply the fuzzy membership function in dealing with inflow during the flood season to construct the fuzzy grey modification model.
The grey forecasting model and fuzzy theory is briefly intro-duced in Section 2 . The concept of combining fuzzy and grey models is proposed in Section 3 . The case study of 10-day reservoir inflow prediction of the Shimen reservoir and the application of different models, including a comparison among them, are pre-sented in Section 4 . Finally, conclusions are given in Section 5 . 2. Grey forecasting model and fuzzy theory
This section briefly introduces the concepts of the grey fore-casting model and the fuzzy theory which serve as the basis of the construction of the forecasting model. 2.1. Grey forecasting model
Owing to the variations of internal and external environments, system development is usually irregular. Therefore, Deng (1989) recommended adopting the technique of accumulation generating operation (AGO) to reveal the hidden regular pattern in the system X  X  development. The grey forecasting model is GM(1,1), which indicates that one variable is employed in the model and that the first order differential equation is adopted to match the data generated by the AGO. The generating function of the grey systems can be expressed in the following equations: 0  X   X  k  X  aZ  X  1  X   X  k  X  X  b  X  1  X  1  X   X  k  X  X  a X  X  1  X   X  k  X  X  X  1 a  X  X  X  1  X   X  k 1  X  X  2  X  wherein, the parameter a is called the developing coefficient ,while then, a is often set to 0.5. However, to effectively resolve the prediction problem, value a shall be adjusted according to the series features.

Sort the forecasting series of x (0) as x (0)  X  ( x (0) (1), x x number. The calculation steps are shown below:
Step 1. The general form of x (1)  X  ( x (1) (1), x (1) (2), x (1) ( n )) is presented as
Step 2. Set the first order Ordinary Differential Equation of x as
Step 3. Use the least square to get the parameter a and b where
B  X  and Y n  X  X  x  X  0  X   X  2  X  , x  X  0  X   X  3  X  , ... , x  X  0  X   X  n  X  X 
Step 4. Under the initial condition of x (1) (1), put a and b into the grey differential equation to get the particular solution of the differential, as shown below: wherein ^ x  X  1  X   X  k  X  1  X  is the forecast value of x (1) the original series can be expressed in the following equation:
By this logic, little data is needed to construct the GM(1,1); there are only two parameters to be estimated in Eq. (1). As the inflow records are all positive numbers, they do not defy the basic principle of the grey model ( Deng, 1989 ). In view of this, the grey model can be used to predict short-term flow and rainfall. 2.2. Fuzzy theory model
The basis of the fuzzy theory is to acknowledge the existence of subjective problems and to deal with those that are difficult to quantify so as to correctly handle problems which require sub-jective evaluation. The fuzzy comprehensive evaluation calcula-tion is conducted based on the following steps:
Step 1. To establish the fuzzy decision model, consider n by a fuzzy membership grade, m i , such that
F  X  m 1 x
Step 2. To establish the Fuzzy relational matrix, consider m influence factors, which influence the decisions, in a fuzzy decision model; these factors construct a factor set determined, construct an alternative set V  X  { v 1 , v 2 , A fuzzy relational matrix R will be defined as
R  X  where r ij is the membership grade that relates the factor m the alternative v j .

Step 3. To establish a weighting function set, different factors may affect decision making to various extents, so a weighting values to capture the relative importance of the meaningful factors m i . Usually, the weighting function set is normalised such that
Step 4. To establish the fuzzy decision making, when R and W are given to suit the problem of interest, the fuzzy evaluation set, E , is given by
E  X  W 3 R  X  X  e 1 , e 2 , ... , e n  X  X  X  w 1 , w 2 , ... , w
The weighted mean method is formulated as e j  X  S m i  X  1 each element e j in the fuzzy evaluation set E in Eq. (13) specifies the extent to which each of the alternatives can be explained in terms of the factor set. The alternative with the highest member-ship grade in the fuzzy evaluation set is chosen as the optimal alternative, because it explains the factor set to the greatest possible extent. 3. Fuzzy grey modification model
In this section, the fuzzy grey modification model is described in two parts: first, the grey modification model is introduced (this model improves the forecast precision through residual error modification and grey model arithmetic logic modification); second, the fuzzy grey modification model is introduced, in which the fuzzy rules are integrated in order to overcome problems relating to predicting significant key events which are subject to dramatic changes. 3.1. Grey modification model
The traditional GM(1,1) model exhibits better prediction when the sequence is exponential, unstable, where an irregular sequence would result in an undesirable prediction, as shown in
Fig. 1 . Enhancing the forecast performance of the grey model, through improving background value of the grey model and the self-adaptability of the grey forecast model, is optimised step by step through specific solution conversion.

It is known from Eq. (8) that the forecast accuracy depends on the parameters a and b , and the solution of a and b depends on the structural form of the background value of GM(1,1), z the accuracy and adaptability of the GM(1,1) model. Eq. (2) is a smoothing formula and a is the key parameter of the background value; when the data sequence changes greatly, a greater time lag error will be induced causing a larger error.

In order to increase the accuracy of the GM(1,1), the literatures ( Chen and Lai, 2001 ; Wen et al., 2000 ) show that a is an important parameter regarding the accuracy of GM(1,1) and have proposed methods to adjust the a value so that z (1) ( k ) can approach
R value by integrating  X  k  X  X  a x  X  1  X   X  k  X  X  X  1 a  X  x  X  1  X   X  k 1  X 
In order to avoid problems resulting from the continuous adjustment of the value a , this study deals with background values through Eq. (14) directly instead of estimating a to improve the precision of GM(1,1).
 The grey differential equation is a kind of exponential function.
In this study, x (1)( t ) is represented as  X  t  X  X  l e o t  X  y  X  15  X 
It is substituted in Eq. (14), and t is substituted in Eq. (15) by k, k 1, and k 2 , respectively, Finally, substitute the values o and y to get the improved background value as shown below:  X  k  X  X 
In addition to the improved background value of the grey model, the specific solution conversion is also used to enhance the precision of the improved grey forecast model. To get the minimum deviation of the simulation series and modelling series, this study will further use the least square method for finding the solution.

The general solution of GM(1,1) is known as ^ x  X  1  X   X  t  X  X  ce  X  b = a  X  . Here we have established the following formula ce ^ x  X  t  X  X  b = a  X  to solve the undetermined coefficient c . It shown as matrix, it is c ... 2 6 6 6 4 Set
D  X  2 6 6 6 4 Using the least square method, we can get ^ c , ^ c  X  X  D T of the GM(1,1) is obtained. One-step forecast value of the initial series is ^ x  X  n  X  1  X  X  ce an  X  e a 1  X  X  19  X 
The improved GM(1,1) model can be obtained by substituting the new z (1) ( k ) by integrating it into the GM(1,1) and optimised step by step specific solution conversion, that is referred to as the
GM (1,1). The calculation concept is detailed in Fig. 2 .
The characteristics of the system include periodicity, random-ness, and tendency. In order to effectively get the tendency of the series and the context of development of the system, this study, apart from improving the background value, has improved the the Fourier series and by correcting the residual, random errors using the exponential smoothing method.

Use the GM n (1,1) to calculate the predicted value ^ x  X  0  X  x adopts the Fourier series to extract the periodical feature hidden in the first-order residual series d (0) of the residual sequences.
Utilising the Fourier series, this residual series is simulated as ^ e the integral part of ka  X  [(( n 1)/2) 1] is the lower limit of the reasonable expanded degrees for the finite series. The parameter a , a i , and bi is estimated using the least square method as
C  X  X  P T P  X  1 P T E 0 X  0  X   X  21  X  where, C  X  X  a 0 , a 1 , b 1 , a 2 , b 2 , ... , a k a , b
The result of Eq. (21) is substituted back into Eq. (20) and then followed by the simulation series of E 0 (0) , namely, ^ E obtained as shown below: ^
E
Incorporate k  X  ( n  X  1) in Eq. (20) to achieve the cyclic one-step estimated value ^ e 0 X  0  X   X  n  X  1  X  of the original data.
The exponential smoothing method can explain the random-ness of the system, that is, the part of the quadratic residual error using the exponential smoothing method, the random feature
Namely, the quadratic residual error series e 00 (0) is fitted by the following formula: ^ e where f is the smoothing coefficient, 0 o f o 1. Furthermore, the grey model can accommodate the random residual error modification. However, the 2nd residual sequence needs to be translated into a non-negative series. After the completion of modelling and forecasting, it is translated back ( Lin, 2001 ). The residual error modification result obtained by this technique is not as good as that produced using the exponential smoothing method. This study also uses the exponential smoothing techni-que for the 2nd residual modification. Notably, the optimum smoothing coefficient is difficult to obtain in the case of stronger subjective judgment factors. Therefore, this study chooses the smoothing coefficient value that has a minimum deviation with the 2nd residual sequence through optimum techniques, i.e., solving the minimum value of the following formula: SSE  X 
After getting the optimum f value, the predicted value of the 2nd residual series is derived as ^ e 00 X  0  X   X  n  X  1  X  X  f ^ e can be derived as  X  n  X  1  X  X  ^ x  X  0  X   X  n  X  1  X  X  ^ e 0 X  0  X   X  n  X  1  X  X  ^ e
The GM n (1,1) model combines the Fourier series to correct the periodical error of the model and exponential smoothing method to correct the residual and random errors is referred to as the EFGM(1,1) model. 3.2. Fuzzy grey modification model
The inflow is affected by rainfall, typhoons, and exhibits immense fluctuations. The exponential function based on the grey model elicits poor forecast results particularly in forecasting series with fluctuation. The grey modification model, which enhances precision, achieves higher levels of accuracy. However, when typhoons cause a sudden increase in water flow during the flood season, as well as a rapid decline in water flow once finished, the sudden transient flows would still lead to calculation errors using the grey modification model.

P  X 
T 2 sin
T 3 sin
T n sin
As there is a presence of typhoons during the flood season, we chose EFGM(1,1) combined with the fuzzy theory model to increase the forecast flow affected by the typhoon. The total forecast value should be the original forecast value plus the incremental flow affected by typhoons, as follows: ^
Q  X  Q t 1  X  D Q  X  27  X  wherein ^ Q t is the predicted value on t -time, Q t 1 is the actual value on ( t 1)-time, and D Q is the inflow increment caused by a typhoon. ^
Q t is modified in the forecast value and calculated using
EFGM(1,1); the error caused by the sudden flow as well as the influence to the precision triggered by significant events are both reduced. Therefore, the fuzzy grey modification model is the inflow forecast model that combin esfuzzytheorywithEFGM(1,1), and named FEFGM(1,1). In this study, we used the triangle fuzzy membership function of the fuzzy theory to determine the fuzzy membership degree of typhoon-caused flow, as shown in Fig. 3 .
Because the droughts and floods have intensified in recent years, we gathered the statistical results o f devastating typhoons from the years 2003 to 2009 and divided the flow increment caused by the typhoon into five grades for flood control in Taiwan. Each grade represents the increment of the inflow and these are shown in Table 1 .

According to the flow increment cause by the typhoon X  X  path, distance, and intensity, we analysed the fuzzy membership function. 3.2.1. Typhoon path and typhoon distance
According to the rainfall feature of the typhoons that have impacted Taiwan based on data from the Central Weather Bureau, we divided the typhoon paths, P , into eight categories, namely,
Categories 1 X 8 ( Zhang, 1998 ), as shown in Fig. 4 . Typhoon distance, D , is defined as the nearest distance between the centre of typhoon X  X  path and the catchment area centre of the Shimen the reservoir ( Cheng, 1997 ). The degree of the Shimen Reservoir X  X  inflow is affected by typhoon X  X  path, and distance. When D is two times larger than the typhoon X  X  radius, r 0 , it is considered to be ineffective, as shown in Table 2 , for example, D is r 0 , and P is
Category 3, and the membership degree of typhoon affecting the reservoir X  X  inflow is 0.4. Table 3 shows each grade X  X  subjection function of the typhoon X  X  path and distance. The inflow is then forecast using the grey model. 3.2.2. Typhoon intensity
Table 4 shows the typhoon intensity factor of the membership function of each grade. 3.2.3. Weight analysis
When the typhoon alarm is raised, there is about 61% prob-ability of a typhoon entering Taiwan ( Cheng, 1997 ). Therefore,
Fuzzy grade subjection degree 0.5 this study sets the reliability as 0.61. At the same time, the technical precision of analysing typhoon intensity is currently high assuming the reliability is 0.9. So the fuzzy factor weight set is A  X  [0.61 0.9]. After the normalised conversion, we can get normalised A  X  [0.4 0.6]. 4. Case study 4.1. Background description
The water resources in Taiwan are unevenly distributed with regard to time and space. Taiwan X  X  annual rainfall reaches 2500 mm on average which is 973 mm more than the world average The occurrence of long-duration, continuous rainfall has increased in recent years, and so has daily rainfall and hourly rainfall intensity. As most river terrains in Taiwan are steep and river flow is rapid, operating rules of the reservoirs becomes very important. Therefore, the precise forecast for the 10-day flow takes a considerable ratio to reservoir operation water level. This paper adopts the Shihmen Reservoir as a case study and uses the catchment area X  X  daily-inflow data collected by the upstream survey station to forecast the reservoir X  X  10-day inflow. As shown in Fig. 5 , the watershed area of the Shihmen Reservoir is 763 km and 16.5 km in length. It is a multi-purpose reservoir used for irrigation, power generation, water supply, and flood control. 4.2. Case analysis
The inflow belonged to an unstable sequence in 2007; the d obtained by trial and error. Observing the value of MAE takes the 4), and (2, 1, 5), respectively.

The EFGM(1,1) predictions on extreme values are fitter to actual ones following the modifying errors of Fourier series exponential smoothing following a weighted moving average. This study minimised sums of square errors to determine the smoothing constant, j , and to correct prediction delays of GM(1,1); the delay phenomenon was significantly improved. The EFGM(1,1) is more sensitive to the cycle X  X  trend and the peak value moment for the decline leads behind the predictive value and is usually lower than the extreme low value. The EFGM(1,1) can improve GM(1,1) accurately predict the peak of extreme values, and reduce any delay phenomenon. Notably, typhoons cause significant changes in the inflow and are impossible to accurately predict. Therefore, consider that the rainfall brought by the typhoon causes increased inflow. Specifically, this paper applies the fuzzy membership function dealing with inflow during the flood season to construct the fuzzy grey modification model, FEFGM(1,1). We chose Typhoon Krosa in 2007, Typhoons Sinlaku and Jiangmi in 2008, and Typhoon Morakot in 2009 as cases for our analysis. 4.2.1. Path and the distance factors
The paths of Typhoon Morakot, Sinlaku, Jianmi, and Krosa are close to the paths of type 2, type 3, type 3, and type 2, respectively. The distance is about a quarter of the typhoon radius, as shown in Fig. 6 . Based on Table 2 , we gather that the membership degrees of these typhoons are 1.0, 0.8, 0.8, and 1.0, respectively. In Table 3 , we gather that each grade of typhoon [0 0 0 0 1]. 4.2.2. Intensity factor
The intensity of Typhoon Morakot is of medium type, yet the intensity of Typhoon Sinlaku, Jiangmi, and Krosa are all strong types. The corresponding central maximum wind speeds are 40, 53, 51, and 51 m/s, respectively. Depicted in Table 5 , the member-ship functions of each grade can be obtained, which are corre-spondingly [0 0 0 1 0], [0 0 0 0 1], [0 0 0 0 1], and[0 0001]. 4.2.3. Weight analysis
The normalised weight set is A  X  [0.4 0.6]. According to the fuzzy decision analysis of the fuzzy theory, we used the general matrix multiplication analysis. Taking Typhoon Morakot as an example, we obtain A 3
R  X  0 : 40 : 6 3
Therefore, we get the comprehensive evaluation results as [0 0 Eq. (27), we can obtain by Typhoon Morakot, D Q  X  2100 CMD. Similarly, we get the inflow increments induced by Typhoons
Sinlaku, Jiangmi, and Krosa, which are 2700 CMD, 2700 CMD, and 3000 CMD, respectively. These are shown in Table 6 .

Typhoon Morakot affected Taiwan for nearly five days starting in August of 2009 and the actual flow during the last ten days of
July was 117 CMD. According to Eq. (28), ^ Q t during the first ten days of August was 117  X  2100  X  2217 CMD. The actual value is 2398 CMD, the value of GM(1,1) 1s 1347 CMD, accuracy from 56% to 92%, as shown in Fig. 7 . By applying the above method,
Typhoons Jiangmi and Sinlaku affected Taiwan in the middle of these ten-days and during the last ten days of September 2008. The actual flow during the first ten days of September was 188
CMD; ^ Q t is 188  X  3000  X  3000  X  6188 CMD, and for the actual value 6665 CMD, the value of GM(1,1) is 3692 CMD, accuracy from 55% to 93%, as shown in Fig. 8 . Typhoon Krosa entered
Taiwan during the first ten days of October in 2007, ^ Q t 1261  X  3000  X  4261 CMD. For the actual value 4663 CMD, the value of GM(1,1) is 2739 CMD, accuracy from 59% to 91%, as shown in Fig. 9 .

Simultaneously, the performance of the inflow datasets from 2007 to 2009 to verify the application of the modified grey model in the context of short-term forecasting. Moreover, as the nature of the weather conditions are very complex, we use the fuzzy theory to explain the relationship among typhoon rainfall and inflow and the larger error of the original GM(1,1) during the flood season and show that it has decreased significantly after applying fuzzy membership function, as shown in Fig. 10 . 4.3. Statistics for indicators of different models
This study makes a comparison of the inflow from 2007 to 2009 to assess the forecast performance of GM(1,1), EFGM(1,1),
FEFGM(1,1), and ARIMA taken by way of the mean square error ( MSE ), absolute mean error ( AME ), mean absolute percentage ( MAPE ), and error of peak inflow ( EF P ). MSE can be used to ascertain the discrete degree of the forecast value and the observed value. AME can eliminate the influence of the extreme value in the positive or negative direction and the minus X  X lus offsetting of the error through absolute value calculation. MAPE can provide the relevant difference of the actual value and forecast value objectively. EF P evaluates the error between the predicted maximum inflow and the actual maximum inflow. The indicators were expressed as follows: MSE  X  1 n AME  X  1 n MAPE  X  1 n Q  X  TIME (MONTH) EF  X   X  value, and n is the number of all forecast points. X ( k ) maximum inflow, while ^ X  X  k  X  p is the predicted maximum inflow.
From Table 7 , in 2007, ARIMA provided prediction accuracy to 36.4 mm in MAPE while GM(1,1) gave 54.7 mm. The conventional grey model, GM(1,1), elicited poorer accuracy than ARIMA. It therefore requires improvements. EFGM(1,1) and FEFGM(1,1) achieved accuracy to 18.0 mm and 17.8 mm in MAPE , respec-tively. As above, GM(1,1) showed poorer performance than
ARIMA. The EFGM(1,1) used an integral approach to improve the background value of GM(1,1) further and was improved by
Fourier series which have the advantage of handling extreme values with regard to prediction and exponential smoothing to improve drawbacks of any prediction delay phenomena. As there is a presence of typhoons during the flood season, we choose
EFGM(1,1) combined with the fuzzy theory model to increase the forecast flow affected by the typhoons. Notably, the predicted extreme value of EFGM(1,1) was smaller than the error of
GM(1,1). However, the performance of EFGM(1,1) was slightly worse than that of FEFGM(1,1). Their performances are better in comparison to all studied approaches regardless of the adapting index of MAE , MAPE , RMSE ,or EF P .

In 2007, 2008, 2009, and 2007 X 2009, FEFGM(1,1) is the best case and is able to stand with EFGM(1,1), GM(1,1), and ARIMA.
Results from EFGM(1,1) revealed that both Fourier series and the exponential smoothing method contributed towards improving GM(1,1) and elicited outstanding FEFGM(1,1).

In sum, FEFGMI(1,1) not only enhanced the accuracy of conven-tional grey models, but also pr ovided increased accuracy and efficiency with regard to ARIMA. Clearly, rainfall intensity has increased years by year heightening the need for the accurate forecasting of inflow to the reservoir. This need includes relevant data for implementing flood control measures downstream, taking precautionary measures in low-lying areas as early as possible, not to mention the efficient use of water resources with an accurate and timely forecasting for inflow with FEFGMI(1,1), as show in Table 8 . 5. Conclusion
This paper investigated ARIMA, GM(1,1), and FEFGMI(1,1) for a 10-day reservoir inflow. Notably, it is important to be able to accurately forecast a 10-day inflow in advance in the context of operating the reservoir. Four conclusions are made as follows: 1. ARIMA was influenced by the previous historical data regard-ing the inflow, and most of the forecast verification results were between the upper and lower limits of the historical information; specifically, the data could not adequately reflect the current situation at the points with larger changes. 2. It is known from the study that it is not ideal for GM(1,1) to take on an unstable system with large fluctuations and changes with regard to the prediction of unsteady or centre-focused types of sequences. This research employed the integral form of the background value. This improved the accuracy and applicability of the ordinary grey model. 3. The prediction errors of GM(1,1) at the extreme value with large fluctuations are great and could not fully reflect the actual nature of the data. In this paper, EFGM(1,1) complies with direct integral, Fourier series, exponential smoothness, and the membership function was proposed as the inflow forecasting model. It did improve upon deficiencies in that conventional GM(1,1) could not completely resolve with regard to enhancing forecasting accuracy. When compared to other models, such as ARIMA, the modified grey model
FEFGM(1,1) shows high precision for inflow. When the next year X  X  accurate inflow is predicted, it is possible to use this data to simulate two dimensional overland flow modelling.
With this flooding map, the emergency related authorities can be given useful data with which to plan in advance. 4. A highly accurate model combining grey and fuzzy theory is proposed to distribute the water resources appropriately and to enhance warnings of natural disasters. Consequently, inflow of the reservoir is an essential factor for future flood control and even for plans or designs to handle unpredictable conditions resulting in a reduction of losses in property and human life.
The accurate forecast of inflow of the reservoir provides relevant data for implementing flood control measures down-stream, taking precautionary measures in low-lying areas as early as possible, and for the efficient use of water resources. References
