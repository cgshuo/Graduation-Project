
Petra Kralj 1 ,NadaLavra X  c 1 , 2 , Dragan Gamberger 3 , and Antonija Krsta X  ci  X  c 4 , Data analysis in medical applications is characterized by the ambitious goal of extracting potentially new relationships from the data, and providing insightful representations of detected re lationships. Medical data analysis is frequently per-formed by applying rule learning, as the induced rules are easy to be interpreted by human experts.

The goal of standard classification rul e learners [5] is to induce classifica-tion/prediction models from lab eled examples. Opposed to these predictive in-duction algorithms which induce a model in the form of a set of rules, descriptive induction algorithms aim to discover individual patterns in the data, described in the form of individual rules. Descriptive induction algorithms include association rule learners [1], and subgroup discovery systems [2,6,8,11].

This paper addresses a data analysis task where groups of labeled examples are given and the goal is to find differences between the groups. This data analysis task, named contrast set mining , was first presented in [3]. In this paper we propose to solve this task by transforming the contrast set mining task to a subgroup discovery task and to apply the subgroup discovery methodology to solve the task. This approach solves some open issues of existing contrast set mining approaches, like dealing with continuous valued attributes, choosing an appropriate search heurist ic, selecting the level of generality of induced rules, avoiding of overlapping rules, and presenting the results to the end-users.
Although the goals of contrast set mi ning, which aims at finding differences between contrasting groups, and subgroup discovery, which aims at finding de-scriptions of population subgroups, seem different, this paper proves that the goals are the same and the results can be interpreted in both ways. The pro-posed approach of contrast set mining through subgroup discovery (presented in Section 4) was applied to a real-life problem of analyzing patients with brain ischaemia (presented in Section 2), wher e we provide insightful data analysis helping to answer questions about the severity of the brain damage based on risk factors obtained from physical examination data, laboratory test data, ECG data and anamnestic data. The usefulness of the approach is shown by the achieved results (Section 5) interpret ed by medical specialists. The brain ischaemia dataset consists of records of patients who were treated at the Intensive Care Unit of the Department of Neurology, University Hospi-tal Center  X  X agreb X , Zagreb, Croatia, in year 2003. In total, 300 patients are included in the dataset: 209 with the computed tomography (CT) confirmed diagnosis of brain stroke, and 91 patients who entered the same hospital depart-ment with adequate neurological symptoms and disorders, but were diagnosed as patients with transition ischaemic brain attack (TIA, 33 patients), reversible ischaemic neurological deficit (RIND, 12 patients), and severe headache or cer-vical spine syndrome (46 patients). In this paper, the goal of the experiments is to characterize brain stroke patients confirmed by a positive CT test in contrast with the patients with a normal CT test.

Patients are described with 26 descript ors representing anamnestic, physi-cal examination, laboratory test and ECG data, and their diagnosis. Anamnes-tic data: aspirin therapy (asp) , anticoagulant therapy (acoag) , antihypertensive therapy (ahyp) , antiarrhytmic therapy (aarrh) , antihyperlipoproteinaemic ther-apy -statin (stat) , hypoglycemic therapy (hypo) ,sex (sex) , age (age) ,present smoking (smok) ,stress (str) , alcohol consumption (alcoh) , family anamnesis (fhis) . Physical examination data are: body mass index (bmi) , systolic blood pressure (sys) , diastolic blood pressure (dya) , fundus ocular (fo) . Laboratory test data: uric acid (ua) , fibrinogen (fibr) ,glucose (gluc) , total cholesterol (chol) , triglyceride (trig) , platelets (plat) , prothrombin time (pt) . ECG data: heart rate (ecgfr) , atrial fibrillation (af) , left ventricular hypertrophy (ecghlv) . 1
The diagnosis of patients is based on the physical examination confirmed by the CT test. All the patients in the control group have a normal brain CT test in contrast with the positive CT test of patients with a confirmed brain at-tack. It should be noted that the group of patients with brain stroke and the control group do not consist of healthy persons but of patients with suspected severe neurological symptoms and disorders. In this sense, the available dataset is particularly appropriate for studying the specific characteristics and subtle differences that distinguish the two groups. While the detected relationships can be accepted as the actual characteri stics for these patients, the computed evaluation measures X  X ncluding probability, specificity and sensitivity of induced rules X  X nly reflect characteristics speci fic to the available data set, not necessar-ily holding for the general population or other medical institutions. A common question of exploratory data analysis is  X  X hat is the difference be-tween the given groups? X  where the gro ups are defined by a selected property of individuals that distinguishes one group from the others. For example, the dis-tinguishing property that we want to investigate could be the gender of patients and a question to be explored can be  X  What is the difference between males and females affected by a certain disease?  X  or, if the property of interest was the response to a treatment, the question can be  X  X hat is the difference between patients reacting well to a selected drug and those that are not? X  Searching for differences is not limited to any special type of individuals: we can search for differences between molecules, pa tients, organizations, etc.

Data analysis tasks that try to find differences between contrasting groups are very common and the approach presented here can be applied in many of these tasks. When the end-users ask fo r differences characterizing different groups, they are usually not interested in all the differences; they may prefer a small set of representative and interpretable patterns. Finding all the patterns that discriminate one group of individuals from the other contrasting groups is not appropriate for human interpretation. Therefore, as is the case in other descriptive induction tasks, the goal is to find descriptions that are unexpected and interesting to the end-user.

The approach presented in this paper offers this kind of analysis. From a dataset of class labeled instances (the class label being the property of interest) by means of subgroup discovery [7] we can find interpretable rules that offer a good starting point for human analysis of contrasting groups.
 Contrast set mining. The problem of mining contrast sets was first defined in [3] as finding  X  X onjunctions of attributes and values that differ meaningfully in their distributions across groups. X  They proposed the STUCCO algorithm [3], which is based on Bayardo X  X  Max-Miner [4] rule discovery algorithm. In the level-wise search for contrast sets, formed of conjunctions of attribute-value pairs of length i , the interestingness of the conjunct is estimated by its statistical sig-nificance, assessed using a  X  2 test with a Bonferroni co rrection. Domain specific parameters need to be set, like the minimum support difference between groups. The algorithm works only on domains with nominal attributes.
It was shown in [10] that contrast set mining is a special case of a more general rule learning task, and that a contrast set can be interpreted as an antecedent of a rule and Group i , for which it is characteristic, as the rule con-sequent: ContrastSet Group i .

When using rule learners (OPUS-AR and C4.5 rules) for contrast set mining [10], the user needs to select a quality mea sure (choosing between support, confi-dence, lift, coverage and leverage). In this setting the number of generated rules largely exceeds the number of rules gen erated by STUCCO, unless pruned by the user-defined maximum number of rules par ameter. Expert inter pretation of rules is difficult due to a large amount of rules and sometimes also their specificity. Subgroup discovery. A subgroup discovery task is defined as follows:  X  X iven a population of individuals and a property of those individuals that we are in-terested in, find population subgroups that are statistically  X  X ost interesting X , e.g. are as large as possible and have the most unusual statistical (distribu-tional) characteristics with respect to th e property of interest X  [11]. The result of subgroup discovery is a relatively small set of subgroup descriptions formed of conjunctions of features. Members of a subgroup are examples from the dataset that correspond to the subgroup description. Good subgroups are large (descrip-tions covering many examples with the given property of interest), and have a significantly different distribution of examples with the given property compared to its distribution in the entire population.

Subgroup discovery algorithms include adaptations of rule learning algorithms to perform subgroup discovery [7,8] algorithms for relational subgroup discovery [9,11] and algorithms for exploiting background knowledge for discovering non-trivial subgroups [2], among others.

Since subgroup descriptions are conjunctions of features that are characteristic for a selected class of individuals (property of interest), a subgroup description can be seen as a condition of a rule SubgroupDescription Class and therefore sub-group discovery can be seen as a special ca se of a more general rule learning task. We present an approach to contrast set mining by means of subgroup discovery. Even though the definitions of subgroup discovery and contrast set mining seem different, we here provide a proof of the compatibility of the tasks. Furthermore, by subgroup discovery means, we solve the following open issues in contrast set mining [10]: proposing appropriate heuristics for identifying interesting contrast sets, appropriate measures of quality of contrast sets, and appropriate methods for presenting contrast sets to the end-users. The issue of dealing with continu-ous attributes is also solved by subgroup discovery algorithm SD [7]. Translating contrast set mining ta sks to subgroup discovery tasks.
 Contrast set mining and subgroup disc overy were developed in different com-munities, each developing its own termi nology that needs to be clarified before proceeding. In order to show the compatibility of contrast set mining and sub-group discovery tasks, we first define the compatibility of terms used in different communities as follows: terms are compatible if they can be translated into equivalent logical expressions and if they bare the same meaning, i.e., if terms from one community can replace terms used in another community.

To show that terms used in contrast set mining (CSM) can be translated to terms used in subgroup discovery (SD), Table 1 provides a term dictionary through which we translate the terms used in CSM and SD into a unifying terminology of classification rule learning.

We now wish to show that every contrast set mining task (CSM) can be translated into a subgroup discovery task (SD). The definitions of contrast set mining and subgroup discovery appear different: contrast set mining searches for discriminating characteristics of groups called contrast sets, while subgroup discovery searches for subgroup descriptions.

A contrast set is formally defined as follows: Let A 1 ,A 2 , ..., A k be a set of k A contrast set is a conjunction of attribute value pairs defined on user defined groups G 1 ,G 2 , ..., G n of data instances, whose characteristics we wish to uncover through contrast set mining [3]. A special case of contrast set mining considers only two contrasting groups G 1 and G 2 . In such cases, we wish to find charac-teristics of one group discriminating it from the other and vice versa.
In subgroup discovery, subgroups are described as conjunctions of features of the form A i = v ij for nominal attributes, and A l &gt;value or A l  X  value for continuous attributes. The subgroup discovery task aims at finding population subgroups that are as large as possible and have the most unusual statistical (distributional) characteristics with respect to the property of interest [11].
Using the dictionary of Table 1 it is trivial to show that a two-group contrast set mining task CSM ( G 1 ,G 2 ) can be directly translated into the following two subgroup discovery tasks: SD ( Class = G 1 vs. Class = G 2 )and SD ( Class = G 2 vs. Class = G 1 ). Since this translation is possible for two-group contrast set mining, it is X  X y induction X  X lso possible for a general contrast set mining task. Solving open issues of CSM with SD In this paper, contrast set mining is performed by subgroup discovery algorithm SD [7], an iterative heuristic beam search rule learner.

Handling continuous attributes: SD uses a feature-based data representation, where attribute values needed for the cons truction of features are generated au-tomatically from the data. In this way, the SD algorithm overcomes a deficiency of CSM: handling of continuous attributes.

Rule quality heuristic: At each run, the SD algorithm finds subgroups for a selected property of interest and a sel ected generalization parameter g. The output of the SD algorithm is a set of rules with good covering properties on the given example set, which is obtained by using rule quality heuristic q g ( R )= FP + g ,where TP (true positives) denotes the number of covered examples from the positive class, FP (false positives) the number covered negative examples, and generalization parameter g offers the user the opportunity to influence the degree of specificity of rules, since with large g general rules are preferred by the q g heuristic, while with small g each covered negative example is severely punished thus generating specific rules. 2
Rule diversity: To obtain diverse rules in different iterations, the algorithm implements weighting of covered positive examples after selecting a rule. Instead of the unweighted q g ( R ) measure, the weighted rule quality measure replaces TP with the sum of weights of covered positive examples. Although this approach can not guarantee the statistical independence of generated rules, it aims at ensuring good diversity of induced rule s. This can be verified also from the results presented in the following section.

Presenting the results to end-users: In the next section we present some visu-alization methods with the results of our experiments. The visualizations proved to be intuitive and useful to the domain experts, and can help estimating the quality of the results. In this section we illustrate the usage of the presented approach of contrast set mining through subgroup discovery including the visualizations of the results.
There are several questions that medical doctors find interesting and that can be investigated by using the presented method and dataset. Due to space restrictions of this paper, we concentrate only on the question  X  X hat is the difference between patients with confirmed stroke and patients with other severe neurological disorders? X  Other questions that could be addressed in a similar manner are:  X  X hat is the difference between patients with TIA and RIND and the confirmed stroke patients? X ,  X  X hat is the difference between patients with thrombolic ischaemia and embolic ischaemia X , and others.

For each of the two classes, Figure 1 shows three best rules induced by selecting g =10and g = 50, visualized with the bar visualization along with their TP and FP values. The order of rules is selected by the iterative SD algorithm and is de-termined by the q g rule quality value that takes into account the covering relations between the current rule and other ru les previously selected for the same g -value.
An interesting subgroup description is rule (age &gt; 52.00) and (asp=no), which stimulated the analysis presented in Figure 2. This analysis provides an excellent motivation for patients to accept prevent ion based on aspirin therapy, as the rule explicitly recognizes the importance of the aspirin therapy for persons older than 52 years.

In addition, the moderately sensitive and specific rules are relevant also for the selection of appropriate boundary values for numeric descriptors included into rule conditions. Examples are age over 58 years, and fibrinogen over 3.35. In the case of fibrinogen, reference values above 3.7 are treated as positive while rules induced for brain stroke domain suggest 4.45 in combination with age over 64 years, and 3.35 in combination with age over 58 years for more sensitive detection of stroke. These values, if significantly d ifferent from genera lly accepted reference values, can initialize research in the di rection of possibly accepting them as new decision points in medical decision ma king practice. Even more importantly, the fact that various boundary points can be suggested in combinations with different conditions is better than the ex isting medical practice which tends to define unique reference values irrespective of the disease that has to be described and irrespective of other pa tient characteristics. This work demonstrates that subgroup discovery methodology is appropriate for solving contrast set mining tasks. It s hows the results of contrast set mining through subgroup discovery applied to the problem of distinguishing between patients with and without brain stroke. Attention was devoted also to the se-lection of appropriate visualizations, enabling effective presentations of obtained results. The presented theory and exper imental results show that using subgroup discovery for contrast set mining solve s many open issues of contrast set mining.
