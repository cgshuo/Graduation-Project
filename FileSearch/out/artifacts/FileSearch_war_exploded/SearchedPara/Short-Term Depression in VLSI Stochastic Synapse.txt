 Synapses are the primary locations in neural systems where information is processed and transmit-ted. Synaptic transmission is a stochastic process by nature, i.e. it has been observed that at central synapses transmission proceeds in an all-or-none fashion with a certain probability. The synaptic weight has been modeled as R = npq [1], where n is the number of quantal release sites, p is the probability of release per site, and q is some measure of the postsynaptic effect. The synapse un-dergoes constant changes in order to learn from and adapt to the ever-changing outside world. The variety of synaptic plasticities differ in the triggering condition, time span, and involvement of pre-and postsynaptic activity. Regulation of the vesicle release probability has been considered as the underlying mechanism for various synaptic plasticities [1 X 3]. The stochastic nature of the neural computation has been investigated and the benefits of stochastic computation such as energy effi-ciency, communication efficiency, and computational efficiency have been shown [4 X 6]. Recently there is increasing interest in probabilistic modeling of brain functions [7]. VLSI stochastic synapse could provide a useful hardware tool to investigate stochastic nature of the synapse and also function as the basic computing unit for VLSI implementation of stochastic neural computation.
 Although adaptive deterministic VLSI synapses have been extensively studied and developed for neurally inspired VLSI learning systems [8 X 13], stochastic synapses have been difficult to imple-ment in VLSI because it is hard to properly harness the probabilistic behavior, normally provided by noise. Although stochastic behavior in integrated circuits has been investigated in the context of random number generators (RNGs) [14], these circuits either are too complicated to use for a sto-chastic synapse or suffer from poor randomness. Therefore other approaches were explored to bring randomness into the systems. Stochastic transmission was implemented in software using a lookup table and a pseudo random number generator [15]. Stochastic transition between potentiation and depression has been demonstrated in bistable synapses driven by stochastic spiking behavior at the network level for stochastic learning [16].
 Previously we reported the first VLSI stochastic synapse. Experimental results demonstrated true randomness as well as the adjustable transmission probability. The implementation with  X  15 tran-sistors is compact for these added features, although there are much more compact deterministic synapses with as few as five transistors. We also proposed the method to implement plasticity and demonstrated the implementation of STD by modulating the probability of spike transmission. Like its deterministic counterpart, this stochastic synapse operates on individual spike train inputs; its stochastic character, however, creates the possibility of a broader range of computational primitives such as rate normalization of Poisson spike trains, probabilistic multiplication, or coincidence de-tection. In this paper we extend the subtractive single release model of STD to the VLSI stochastic synapse. We present the simulation of the new model. We describe a novel compact VLSI imple-mentation of a stochastic synapse with STD and demonstrate extensive experimental results showing the agreement with both simulation and theory over a range of conditions and biases. Previously we demonstrated a compact stochastic synapse circuit exhibiting true randomness and consuming very little power (10-44  X  W). The core of the structure is a clocked, cross-coupled dif-ferential pair comparator with input voltages V i + and V i  X  , as shown in the dashed box in Fig. 1. It uses competition between two intrinsic circuit noise sources to generate random events. The dif-ferential design helps to reduce the influence from other noise sources. When a presynaptic spike arrives, V pre  X  goes low, and transistor M5 shuts off. V o + and V o  X  are nearly equal and the circuit is in its metastable state. When the two sides are closely matched, the imbalance between V o + and V o  X  caused by current noise in M1-M4 eventually triggers positive feedback, which drives one output to
V c and the other close to ground. We use a dynamic buffer, shown in the dotted box in Fig. 1, to generate rail-to-rail transmitted spikes V tran . V tran either goes high (with probability p ) or stays low (with probability 1  X  p ) during an input spike, emulating stochastic transmission.
 Fabrication mismatch in an uncompensated stochastic synapse circuit would likely permanently bias the circuit to one solution. In this circuit, floating gate inputs to a pFET differential pair allow the mismatch to be compensated. By controlling the common-mode voltage of the floating gates, we operate the circuit such that hot-electron injection occurs only on the side where the output voltage is close to ground. Over multiple clock cycles hot-electron injection works in negative feedback to equalize the floating gate voltages, bringing the circuit into stochastic operation. The procedure can be halted to achieve a specific probability or allowed to reach equilibrium ( 50% transmission probability).
 The transmission probability can be adjusted by changing the input offset or the floating gate charges. The higher V g + is, the lower p is. The probability tuning function is closely fitted by an error function f ( v ) = 0 . 5  X  is the standard deviation characterizing the spread of the probability tuning, and v = V i  X   X  V i + is the input offset voltage. Synaptic plasticity can be implemented by dynamically modulating the probability. Input offset modulation is suitable for short-term plasticity. Short-term depression is triggered by the transmitted input spikes V tran to emulate the probability decrease because of vesi-cle depletion. Short-term facilitation is triggered by the input spikes V pre to emulate the probability able for long-term plasticity. STDP can be implemented by modulating the probability depending on the precise timing relation between the pre-and postsynaptic spikes. Although long-term plasticity has attracted much attention because of its apparent association with learning and memory, the functional role of short-term plasticity has only recently begun to be un-derstood. Recent evidence suggests that short-term synaptic plasticity is involved in many functions such as gain control [17], phase shift [18], coincidence detection, and network reconfiguration [19]. It has also been shown that depressing stochastic synapses can increase information transmission efficiency by filtering out redundancy in presynaptic spike trains [5].
 Activity dependent short-term changes in synaptic efficacy at the macroscopic level are determined by activity dependent changes in vesicle release probability at the microscopic level. We will focus on STD here. STD during repetitive stimulation results from a decrease in released vesicles. Since there is a finite pool of vesicles, and released vesicles cannot be replenished immediately, a success-ful release triggered by one spike potentially reduces the probability of release triggered by the next spike. We propose an STD model based on our VLSI stochastic synapse that closely emulates the simple subtractive single release model [5, 20]. A presynaptic spike that is transmitted reduces the input offset voltage v at the VLSI stochastic synapse by  X  v , so that the transmission probability p ( t ) is reduced. Between successful releases, v relaxes back to its maximum value v max exponentially with a time constant  X  d so that p ( t ) relaxes back to its maximum value p max as well. The model can be written as For an input spike train with Poisson arrivals, the model can be expressed as a stochastic differential equation taking the expectation E (  X  ) on both sides, we obtain a differential equation When v is reduced, the probability that it will be reduced again becomes smaller. v is effectively constrained to a small range where we can approximate the function f ( v ) = 0 . 5 by a linear function f ( v ) = av + 0 . 5 , where  X  = 0 for simplicity. We can then solve for E ( p ) at steady state: Therefore the steady state mean probability is inversely proportional to the input spike rate when a  X  v X  d r  X  1 . This is consistent with prior work that modeled STD at the macroscopic level [17]. We simulated the model (1)-(3). We use the function f ( v ) = 0 . 5 from the best fit of the experimental data. Initially v is set to 5 mV which sets p max close to 1. Although the transformation from v to p is nonlinear, both simulation and experimental data show that this implementation exhibits behavior similar to the model with the linear approximation and the biological data. Fig. 2(a) and 2(b) show that the mean probability is a linear function of the inverse of the input spike rate at various  X  v and  X  d for high input spike rates. Both  X  v and  X  d affect the slope of the linear relation, following the trend suggested by (6): the bigger the  X  v or the bigger the  X  d , the smaller the slope is. Fig. 3 shows a simulation of the transient probability for a period of 200 ms. Fig. 4 shows that the output spike train exhibits negative autocorrelation at small time intervals and lower power spectral density (PSD) at low frequencies. This is a direct consequence of STD. Figure 2: Mean probability as a function of input spike rate from simulation. Data were collected at input rates from 100 Hz to 1000 Hz at 100 Hz intervals. The solid lines show the least mean square fit for input rates from 400 Hz to 1000 Hz. Figure 3: Simulated probability trajectory over 200 ms period. r = 100 Hz,  X  = 100 ms,  X  v = 2 mV. Figure 4: Characterization of the output spike train from the simulation of the stochastic synapse with STD. r = 100 Hz,  X  d = 200 ms,  X  v = 6 mV, V max = 5 mV. We implemented this model using the stochastic synapse circuit described above (see Fig. 1). Both inputs are restored up to an equilibrium value V icm by tunable resistors implemented by subthreshold pFETs operating in the ohmic region. To change the transmission probability we only need to modulate one side of the input, in this case V i  X  . The resistor and capacitor provide for exponential recovery of the voltage to its equilibrium value. The input V i  X  is modulated by transistors M6 and M7 based on the result of the previous spike transmission. Every time a spike is transmitted successfully, a pulse with height V h and width T p is generated at V p . T p is same as the input spike pulse width. This pulse discharges the capacitor with a small current determined by V w and reduces V i  X  by a small amount, thus decreasing the transmission probability. The value of the probability that it will be reduced again becomes smaller. Since the probability tuning only occurs in a small voltage range (  X  10 mV), the change in V i  X  is limited to this small range as well. Under this special condition, the resistance implemented by the subthreshold pFET is linear and large (  X  G
 X  ). With capacitance as small as 100 fF, the exponential time constant is tens of milliseconds and is adjustable. Similar control circuits can be applied to V i + to implement short-term facilitation. The update mechanism would then be driven by the presynaptic spike rather than the successfully transmitted spike. The extra components on the left provide for future implementation of short-term facilitation and also symmetrize the stochastic synapse, improving its randomness. The circuit has been fabricated in a commercially-available 0.5  X  m CMOS process with 2 polysil-icon layers and 3 metal layers. The layout size of the stochastic synapse is 151.9  X  m  X  91.7  X  m and the layout size of the STD block is 35  X  m  X  32.2  X  m. A 2-to-1 multiplexer with size 35  X  m  X  30  X  m is used to enable or disable STD. As a proof of concept, the layout of the circuit is quite conservative. Assuming no loss of performance, the existing circuit area could be reduced by 50%. The circuit uses a nominal power supply of 5 V for normal operation. The differential pair compara-tor uses a separate power supply for hot-electron injection. Each floating-gate pFET has a tunnelling structure, which is a source-drain connected pFET with its gate connected to the floating node. A separate power supply provides the tunnelling voltage to the shorted source and drain (tunnelling node). When the tunnelling voltage is high enough (  X  14-15 V), electron tunnels through the sil-icon dioxide, from the floating gate to the tunnelling node. We use this phenomenon to remove electrons from the floating gate only during initialization. Alternatively Ultra-Violet (UV) activated conductances may be used to remove electrons from the gate to avoid the need for special power supplies.
 To begin the test, we first remove residual charges on the floating gates in the stochastic synapse. We set V icm = 2 V. We raise the power supply of the differential pair comparator to 5.3 V to facilitate the hot-electron injection. We use the negative feedback operation of hot-electron injection described above to automatically program the circuit into its stochastic regime. We halt the injection by lowering the power supply to 5 V. During this procedure, STD is disabled, so that the probability at this operating point is the synaptic transmission probability without any dynamics.
 We then enable STD. We use a signal generator to generate pulse signals which serve as input spikes. Although spike trains are better modeled by Poisson arrivals, the averaging behavior should be similar for deterministic spike trains which make testing easier. We use I bias = 100 nA. The power consumption of the STD block is much smaller than the stochastic synapse. The total power consumption is about 10  X  W.
 We collect output spikes from the depressing stochastic synapse at an input spike rate of 100 Hz. We divide time into bins according to the input spike rate so that in each bin there is either 1 or 0 output spike. In this way, we convert the output spike train into a bit sequence s(k). We then compute the ber of time intervals between two bits. A (0) gives the variance of the sequence. For two bits with distance n &gt; 0 , A ( n ) = 0 if they are independent, indicating good randomness, and A ( n ) &lt; 0 if they are anticorrelated, indicating the depressing effect of preceding spikes on the later spikes. Fig. 5 shows the autocorrelation of the output spike trains at two different V r . There is significant nega-tive correlation at small time intervals and little correlation at large time intervals, as expected from STD. Fig. 6 shows the PSD of the output spike trains from the same data shown in Fig. 5. Clearly, the PSD is reduced at low frequencies. The time constant of STD increases with V r so that the larger V r is, the longer the period of the negative autocorrelation is and the lower the frequencies where power is reduced. This agrees with simulation results. Notice that the autocorrelation and PSD for V r = 1 . 59 V show very close similarity to the simulation results in Fig. 4. Normally redundant information is represented by positive autocorrelation in the time domain, which is characterized by power at low frequencies. By reducing the low frequency component of the spike train, redundant information is suppressed and overall information transmission efficiency is improved. If the nega-tive autocorrelation of the synaptic dynamics matches the positive autocorrelation in the input spike train, the redundancy is cancelled and the output is uncorrelated [5]. Figure 5: Autocorrelation of output spike trains from the VLSI stochastic synapse with STD for an input spike rate of 100 Hz. Autocorrelation at zero time represents the sequence variance, and negative autocorrelation at short time intervals indicates STD. Figure 6: Power spectral density of output spike trains from the VLSI stochastic synapse with STD for an input spike rate of 100 Hz. Lower PSD at low frequencies indicates STD.
 We collect output spikes in response to 10 4 input spikes at input spike rates from 100 Hz to 1000 Hz with 100 Hz intervals. Fig. 7(a) shows that the mean transmission probability is inversely pro-portional to the input spike rate for various pulse widths when the rate is high enough. This matches the theoretical prediction in (6) very well. By scaling the probability with the input spike rate, the synapse tends to normalize the DC component of input frequency and preserve the neuron dynamic range, thus avoiding saturation due to fast firing presynaptic neurons and retaining sensitivity to less frequently firing neurons [17]. The slope of mean probability decreases as the pulse width increases. Since the pulse width determines the discharging time of the capacitor at V i  X  , the larger the pulse width, the larger the  X  v is and the smaller the slope is. Fig. 7(b) shows that a  X  v X  d scales linearly with the pulse width. The discharging current is approximately constant, thus  X  v is proportional to the pulse width. Figure 7: Steady state behavior of VLSI stochastic synapse with STD for different pulse widths. We perform the same experiments for different V r and V w . As V r increases, the slope of mean where the equivalent resistance R from the pFET increases with V r . Fig. 8(a) shows that a  X  v X  d is approximately an exponential function of V r , indicating that the equivalent R of the pFET is ap-proximately exponential to its gate voltage V r . For V w , the slope of mean transmission probability decreases as V w increases. This is due to the increasing  X  v with V w . Fig. 8(b) shows that a  X  v X  d is approximately an exponential function of V w , indicating that the discharging current from the tran-sistor M6 is approximately exponential to its gate voltage V w . This matches the I-V characteristics of the MOSFET in subthreshold. We designed and tested a VLSI stochastic synapse with short-term depression. The behavior of the depressing synapse agrees with theoretical predictions and simulation. The strength and time duration of the depression can be tuned by the biases. The circuit is compact and consumes low power. It is a good candidate to bring randomness and rich dynamics into VLSI spiking neural systems, such as for rate-independent coincidence detection of Poisson spike trains. However, the application of such dynamic stochastic synapses in large networks still remains a challenge. [1] C. Koch, Biophysics of Computation: Information Processing in Single Neurons . New York, [2] M. V. Tsodyks and H. Markram,  X  X he neural code between neocortical pyramidal neurons [3] W. Senn, H. Markram, and M. Tsodyks,  X  X n algorithm for modifying neurotransmitter release [4] W. Maass and A. M. Zador,  X  X ynamic stochastic synapses as computational units, X  Neural [5] M. S. Goldman, P. Maldonado, and L. F. Abbott,  X  X edundancy reduction and sustained firing [6] W. B. Levy and R. A. Baxter,  X  X nergy-efficient neuronal computation via quantal synaptic [7] R. Rao, B. Olshausen, and M. Lewicki, Eds., Statistical Theories of the Brain . MIT Press, [8] C. Diorio, P. Hasler, B. A. Minch, and C. Mead,  X  X  single-transistor silicon synapse, X  IEEE [9] P. H  X  afliger and M. Mahowald,  X  X pike based normalizing Hebbian learning in an analog VLSI [10] S.-C. Liu,  X  X nalog VLSI circuits for short-term dynamic synapses, X  EURASIP Journal on [11] E. Chicca, G. Indiveri, and R. Douglas,  X  X n adaptive silicon synapse, X  in Proc. IEEE Int. Symp. [12] A. Bofill, A. F. Murray, and D. P. Thompson,  X  X ircuits for VLSI implementation of temporally [13] G. Indiveri, E. Chicca, and R. Douglas,  X  X  VLSI array of low-power spiking neurons and [14] C. S. Petrie and J. A. Connelly,  X  X  noise-based IC random number generator for applications [15] D. H. Goldberg, G. Cauwenberghs, and A. G. Andreou,  X  X robabilistic synaptic weighting in [16] S. Fusi, M. Annunziato, D. Badoni, A. Salamon, and D. J. Amit,  X  X pike driven synaptic plastic-[17] L. F. Abbott, J. A. Varela, K. Sen, and S. B. Nelson,  X  X ynaptic depression and cortical gain [18] F. S. Chance, S. B. Nelson, and L. F. Abbott,  X  X ynaptic depression and the temporal response [19] F. Nadim and Y. Manor,  X  X he role of short-term synaptic dynamics in motor control, X  Curr.
