 1. Introduction
Information sharing is a vital building block for today X  X  business world. In June 2004, the Information Technology Advi-sory Committee released a report entitled Revolutionizing Health Care Through Information Technology [31]. A key point is the establishment of a nationwide system of electronic medical records that encourages sharing medical knowledge through ing, specifically for the task of cluster analysis.

In this paper, we define the data publishing scenario as follows. Consider a person-specific data table T with patients X  people match it, publishing the table will lead to linking a unique or small number of individuals with the sensitive
The problem studied in this paper is to generate a masked version of T that satisfies two requirements: the anonymity requirement and the clustering requirement . 1.1. Anonymity requirement match the generalized description and, therefore, individuals who match the description will become less identifiable.
The anonymity requirement is specified by k -anonymity [33,40] : A masked table T * satisfies k -anonymity if each record matched individual actually has the disease from T * . 1.2. Clustering requirement be known at the time of data publication.

We study the anonymity problem for cluster analysis : for a given anonymity requirement and a raw data table T , a data share its patients X  information with a drug company for pharmaceutical research.

There are many possible masked versions of T * that satisfy the anonymity requirement. The challenge is how to identify
In this paper, we define the anonymity problem for cluster analysis and present a solution framework to address the chal-lenges in the problem. Our contributions to the literature can be summarized by answering the following key questions: (1) Can a masked table simultaneously satisfy both anonymity and clustering requirements? Our insight is that the two (2) What information should be preserved for cluster analysis in the masked data? We present a framework to convert the tered records to gain more knowledge. For example, a medical researcher may browse into some clusters of patients and but also increases the availability of information for the recipients.

The paper is organized as follows. We review related works in Section 2, define the problem in Section 3, present the framework of our approach in Section 4, and evaluate it in Section 5. Then, we show the extensions of the framework to achieve other privacy notions in Section 6 and conclude the paper in Section 7. 2. Related works
Recently, the research topic of privacy-preserving data publishing (PPDP) has received a great deal of attention in the database and data mining research communities. The literature in PPDP can be broadly categorized by linkage prevention the victim has a record in the released table.
 knowledge, there is a chance that the attacker could uniquely identify the victim X  X  record from the group. The notion of k -anonymity [33,40] and its variations [21,27] are proposed to prevent record linkage through QID . confidence bounding to prevent both linkages.

Many generalization methods [8,19,20,23,25,39,48,49] have been proposed to achieve the above mentioned privacy no-presented a greedy approach to the same problem based on information gain. LeFevre et al. [22] proposed a multi-dimen-sional generalization method, called InfoGain Mondrian , to identify a k -anonymous solution. Mohammed [29], Wang and
Fang [43], Wang et al. [44] addressed the extended data publishing scenarios, such as multiple releases and multiple data holders. Fung et al. [10] presented a suppression method for anonymizing high-dimensional sequential data.
There are two major differences that distinguish our work from the above mentioned anonymization algorithms. First, in rithms for anonymizing both continuous and categorical attributes with and without data holder-specified taxonomy trees.
The anonymization method presented in [22] can anonymize both categorical attributes with taxonomy trees and continu-ous attributes without taxonomy trees, but [22] did not discuss how to anonymize categorical attributes without taxonomy real-life data anonymization.

There is a family of anonymization methods [2,3] that achieves privacy by clustering similar data records together. Their wants to determine the common characteristics of some criminals from the data records.
Many secure protocols have been proposed for distributed computation among multiple parties. For example, [41,15] pre-participating parties. We consider a completely different problem, of which the goal is to share data that is immunized against privacy attacks.

We highlight some recent development in cluster analysis. Beringer and H X llermeier [5] presented a method for cluster-sented a number of efficient clustering strategies for distributed database. Gelbard et al. [14] conducted an extensive empirical study on different clustering methods. 3. Problem statements
A labelled table has the form T  X  D 1 ; ... ; D m ; Class  X  and contains a set of records of the form h v 1 6 j 6 m , is a domain value of attribute D j , and cls is a class label of the Class attribute. Each D continuous attribute. An unlabelled table has the same form as a labelled table but without the Class attribute. requirement is formally defined below.

Definition 3.1 ( Anonymity requirement ). Consider p quasi-identifiers QID 1 6 i 6 p . a  X  qid i  X  denotes the number of data records in T * that share the value qid
A  X  QID i  X  , is the minimum a  X  qid i  X  for any value qid ... ; h QID p ; h p ig if A  X  QID i  X  P h i for 1 6 i 6 p , where QID
If some QID j could be  X  X  X overed X  by another QID i , then QID vation is stated as follows:
Observation 3.1 ( Cover ). Suppose QID j # QID i and h j 6 covered by QID i ; therefore, QID j is redundant and can be removed.
 stores a count for each class label. The anonymity requirement h QID qid less identifiable by being one of the four females who have a graduate degree in the masked table T * .
Definition 3.1 generalizes the classic notion of k -anonymity [34] by allowing multiple QID s with different anonymity than is necessary. Most previous works suffer from this over-masking problem because they simply include all potential can reduce masking and, therefore, improve the data quality. 3.1. Masking operations
To transform a table T to satisfy an anonymity requirement, we apply one of the following three types of masking oper-for any reason, does not specify a taxonomy tree for the categorical attribute D attribute without a pre-discretized taxonomy tree, then we discretize D mally described as follows: (2) Suppress D j if it is a categorical attribute without a taxonomy tree. Suppressing a value on D (3) Discretize D j if it is a continuous attribute. Discretizing a value v on D
A masked table T can be represented by h[ Cut j ; [ Sup j satisfies the anonymity requirement, then h[ Cut j ; [ Sup cretization have their own merits and flexibility; therefore, our unified framework employs all of them. follows to reflect this natural choice of approach.

Definition 3.2 ( Anonymity problem for cluster analysis ). Given an unlabelled table T , an anonymity requirement fh QID 1 ; h 1 i ; ... ; h QID p ; h p ig , and an optional taxonomy tree for each categorical attribute in [ QID for cluster analysis is to mask T on the attributes [ QID has a cluster structure as similar as possible to the cluster structure in the raw table T .
Intuitively, two cluster structures, before and after masking, are similar if the following two conditions are generally satisfied: (1) two objects that belong to the same cluster before masking remain in the same cluster after masking, and (2) two objects that belong to different clusters before masking remain in different clusters after masking.
A formal measure for the similarity of two structures will be discussed in Section 4.3. 4. Our approach
In this section, we present an algorithmic framework to generate a masked table T * , represented by a solution set structure. 4.1. Overview of solution framework
Fig. 2 provides an overview of our proposed framework. First, we generate the cluster structure in the raw table T and label each record in T by a class label. This labelled table, denoted by T perform all of the three types of masking operations discussed in Section 3. We explain each step in Fig. 2 as follows. (2) Mask the labelled table T l . Employ an anonymization algorithm for classification analysis to mask T (3) Clustering on the maskedT l . Remove the labels from the masked T (5) Release the maskedT l . If the evaluation in Step 4 is satisfactory, the data holder can release the masked T
In some data publishing scenarios, the data holder does not even know who the prospective recipients are and, therefore, World Wide Web, how should the bureau set the parameters, such as the number of clusters, for the clustering algorithm in k -anonymity, our privacy-preserving framework for cluster analysis can easily adopt BCF -anonymity to guarantee anonymi-zation over multiple releases. 4.2. Anonymization for classification
The anonymity problem for classification has been studied in [4,12,16,22] . However, none of these anonymization algo-
To effectively mask both categorical and continuous attributes in real-life data, we proposed and implemented an anonymi-
TDR shares a similar top-down specialization (TDS) approach in [12], but TDS cannot perform suppression and, therefore, cannot handle categorical attributes without taxonomy trees.

TDR takes a labelled table and an anonymity requirement as inputs. The main idea of TDR is to perform maskings that preserve the information for identifying the class labels. The next example illustrates this point.
Example 4.1. Suppose that the raw cluster structure produced by Step 1 has the class (cluster) labels given in the Class attribute in Table 1 .In Example 3.1 we generalize Masters and Doctorate into Grad School to make linking through ( Education , Gender ) more difficult. No information is lost in this generalization because the class label C the distinction of Masters and Doctorate . However, further generalizing Bachelors and Grad School to University makes it harder to separate the two class labels involved.

Instead of masking a labelled table T l starting from the most specific domain values, TDR masked T refinements starting from the most masked state in which each attribute is generalized to the topmost value, suppressed refinement is valid (with respect to T l )if T l satisfies the anonymity requirement after the refinement.
Section 4.2.2, and provide the anonymization algorithm TDR in Section 4.2.3. 4.2.1. Refinement 4.2.1.1. Refinement for generalization. Consider a categorical attribute D the set of generalized records that currently contains a generalized value v in the table T generalized value of Masters . 4.2.1.2. Refinement for suppression. For a categorical attribute D disclosing one value v from the set of suppressed values Sup contain ? j in the table T l . Disclosing v means replacing ? val, we treat continuous attributes separately from categorical attributes with taxonomy trees. 4.2.2. Selection criterion
Each refinement increases information utility and decreases anonymity of the table because records are more distinguish-unit of anonymity loss ( AnonyLoss ( v )): classification and anonymization. We borrow Shannon X  X  information theory to measure information gain [37]. Consider a of elements in a set x . j T  X  v j  X  P c j T  X  c j , where c 2 child ( v ).
 where I  X  T  X  x  X  is the entropy of T  X  x [37]: see [32] where A  X  QID i  X  and A v  X  QID i  X  represent the anonymity before and after refining v . avg f A  X  QID anonymity for all QID i that contain the attribute of v .

If D j is a categorical attribute without taxonomy tree, the refinement ?
T  X ? j , where T  X ? j denotes the set of records containing ? refinement ? j !f v ; ? j g , except that InfoGain ( v ) is now defined as:
Algorithm 1. Top-Down Refinement (TDR) 1. Initialize every value of D j to the topmost value or suppress every value of D
D j into the full range interval, where D j 2[ QID i . 2. Initialize Cut j of D j to include the topmost value, Sup full range interval, where D j 2[ QID i . 3. while some candidate x in h[ Cut j ; [ Sup j ; [ Int j 4. Find the Best refinement from h[ Cut j ; [ Sup j ; [ Int 5. Perform Best on T l and update h[ Cut j ; [ Sup j ; [ Int 6. Update Score ( x ) and validity for x 2h[ Cut j ; [ Sup 7. end while 8. return Masked T l and h[ Cut j ; [ Sup j ; [ Int j i .
 4.2.3. The anonymization algorithm (TDR)
Algorithm 1 summarizes the conceptual algorithm. All attributes not in [ QID collapsed into a single row with the Class column storing the count for each class label. Initially, Cut most value for a categorical attribute D j with a taxonomy tree, Sup without a taxonomy tree, and Int j contains the full range interval for a continuous attribute D 4), apply Best to T * and update h[ Cut j ; [ Sup j ; [ Int h[ Cut j ; [ Sup j ; [ Int j i (Line 6). The algorithm terminates when there is no more candidate in h[ Cut it returns the masked table together with the solution set h[ Cut
The following example illustrates how to achieve a given anonymity requirement by performing a sequence of refine-ments, starting from the most masked table.
 anonymity requirement:
Initially, all data records are masked to and data after performing the following refinements in order:
The solution set [ Cut i is: 4.3. Evaluation
This step compares the raw cluster structure found in Step 1 in Section 4.1, denoted by C , with the cluster structure found in the masked data in Step 3, denoted by C g . Both C and C evaluate their similarity by comparing their record groupings. We propose two evaluation methods: F -measure [42] and match point . 4.3.1. F-measure cluster in C as the relevant set of records for a query, and treat each cluster in C called  X  X  X atural clusters, X  and those in C g are called  X  X  X uery clusters. X 
For a natural cluster C i in C and a query cluster K j in C tively, let n ij denote the number of records contained in both C recall , precision , and F -measure for C i and K j are calculated as follows: read as the fraction of relevant records retrieved by the query.
 read as the fraction of relevant records among the records retrieved by the query.

F  X  C ; K j  X  measures the quality of query cluster K j in describing the natural cluster C Precision .

The success of preserving a natural cluster C i is measured by the  X  X  X est X  query cluster K called the overall F-measure of C g , denoted F  X  C g  X  : from the raw data and the masked data, i.e., better preserved cluster quality.

Example 4.3. Table 3 shows a cluster structure with k = 2 produced from the masked Table 2 . The first 12 records are among the 21 records in C 1 , 19 remain in the same cluster K pattern. Table 4 shows the comparison between the clusters of the two structures, and Table 5 shows the F -measure. The overall F -measure is:
F -measure is an efficient evaluation method, but it considers only the best query cluster K cluster structure.
 4.3.2. Match point same cluster in C g , and if two objects that belong to different clusters in C remain in different clusters in C intuition, we build two square matrices Matrix  X  C  X  and Matrix  X  C the same cluster; 0 otherwise. Then, we define match point Matrix  X  C g  X  : where M ij is 1 if the  X  i ; j  X  th element in Matrix  X  C  X  and Matrix  X  C data and the masked data, i.e., better preserved cluster quality.

Example 4.4. Continue from Example 4.3 . Among the five records with Rec IDs 8 X 12, two records are not in its original clusters in C g . Among the 24 records with Rec IDs 13 X 34, three are not in its original clusters in C 2  X  0 : 80. 4.4. Analytical discussion
We discuss some open issues and possible improvements in our proposed privacy framework for cluster analysis. Then, we present an analysis on the efficiency of the TDR algorithm. 4.4.1. Open issues and improvements clustering algorithms. 4.1 for handling potential privacy breaches caused by multiple releases. not be affected significantly by small deviations from the assumed model and it should not deteriorate drastically due to in Step 4.

Our study in TDR focuses mainly on single-dimensional global recoding, defined in Section 3. LeFevre et al. [20,21] pre-the Bachelors with Rec ID# 23 X 26 can remain ungeneralized. Compared with global recoding, local recoding and multidimen-quality in the anonymous data. Nonetheless, it is important to note that local recoding and multidimensional recoding may cause a data exploration problem: most standard data mining methods treat Bachelors and University as two indepen-problem. 4.4.2. Efficiency of TDR
Let T l  X  v denote the set of records containing value v in a masked table T work. The first type accesses data records in T l  X  Best or T making a scan on records in T l  X  c , which is a subset of T expensive operation. Fortunately, resorting T l  X  c is unnecessary for each iteration because its superset T putes Score ( x ) for the candidates x 2h[ Cut j ; [ Int j each taxonomy tree with at most p nodes, the number of such x is at most m p . This computation makes use of the main-tained counts and does not access data records. Let h be the maximum number of times that a value in a record will be re-will be refined at most m h times and, therefore, accessed at most m h times because only refined records are accessed. Since m h is a small constant, independent of the table size, the TDR algorithm is linear in the table size.
Our current implementation assumes that the qid groups fit in memory. Often, this assumption is valid because the qid applies to small qid groups in memory; therefore, the memory demand is unlikely to build up. 5. Experimental study
In this section, our objectives are to: (1) study the loss of cluster quality for achieving various anonymity requirements; (2) verify that the cluster-quality in the masked data produced by our cluster-oriented anonymization method is better (3) verify that the employment of multiple QID s relaxes the anonymity requirement and, therefore, improves the cluster (4) study the effects on cluster quality when the data recipient and the data holder use different clustering algorithms; (5) evaluate the efficiency and scalability on large data sets of the proposed anonymization method.
We employ the CLUTO-2.0 Clustering Toolkit [17], in particular, bisecting k -means [18] and basic k -means [26], to gen-sub-clusters and repeats until the desired number of clusters is reached.

A naive approach to the studied privacy problem is to ignore the cluster structure and simply employ general purpose pose anonymization approach. To ensure a fair comparison, both approaches employ the same modified TDR anonymization labelled as follows: clusterFM and clusterMP denote the overall F-measure and match point, respectively, of the cluster structures before and after masking by our cluster structure-guided anonymization approach, whereas the Score function is specified in Eq. 1. distortFM and distortMP denote the overall F -measure and match point of the cluster structures before and after masking each iteration, the Score function biases to refine on a value v that results in the maximum number of refined records in table T l . Specifically, Score  X  v  X  X j T l  X  v j , where j T ignores the cluster structure.

Given the above objective measures, we can compare the two anonymization approaches in terms of cluster quality. purpose benefit. In this section, the term  X  X  X enefit X  refers to such ratios.

We are also interested in computing the loss in cluster quality due to masking. Both the overall F -measure and the match anonymity measured in match point. In this section, the term  X  X  X ost X  refers to such differences.
All experiments were conducted on an Intel Pentium IV 2.6 GHz PC with 1 Gbyte RAM. We adopted two publicly available marize the results in Section 5.3. 5.1. The Adult data set ously used in [4,11,12,16,20,22 X 25,43 X 46] . After removing records with missing values, we have 45,222 records. Every re-normalized as a standard preprocessing step in many clustering algorithms. The taxonomy trees for continuous attributes are dynamically generated by our TDR algorithm.

In Section 5.1.1, we present the results for the scenario called homogeneous clustering , where the same clustering algo-method. 5.1.1. Homogenous clustering
Homogeneous clustering refers to the scenario in which the same clustering algorithm is applied in both Steps 1 and 3. In single QID . Next, we study how the cluster quality is influenced by the anonymity threshold and QID size. Then, we study cluster quality for anonymity requirement with multiple QID s. cess to determine the rank of other attributes. In our experiments, Top9 denotes the anonymity requirement in which the
Re , Ag , Ra , Se , ranked in that order. 5.1.2. Benefit
Fig. 3 a shows the averaged clusterFM and distortFM over anonymity thresholds 5 of our cluster quality-guided anonymization over the general purpose anonymization spans from 24% to 125% for the num-likely to have occurred by chance.

Fig. 4 a shows the averaged clusterMP and distortMP over anonymity thresholds 5 efit spans from 28% to 85% for the number of clusters k = 2, 6, 10. The p -values for k = 2, 6, 10 are 7.94E 8, 3.72E 22, 1.67E 10, respectively. Fig. 4 b shows the results for the same experimental setting for bisecting k -means. The benefit guided anonymization generally preserves better cluster quality than the general purpose anonymization on the Adult data set. 5.1.3. Cost
Consider Figs. 3a, b and 4a, b again. The averaged cost, measured in overall F -measure, for achieving a given anonymity anonymization problem. 5.1.4. Sensitivity to anonymity threshold h
Figs.3c X  X  and 4 c X  X  plot the clusterFM , distortFM , clusterMP , and distortMP of anonymity thresholds 5 tions from these figures. (2) Both overall F -measure and match point do not decrease monotonically with respect to the increase of h because both
In addition to F -measure and match point, we also manually examined the cluster structures generated from the raw data point is 0.97. Note that the cluster labels are arbitrarily named. Among the 12,669 records in the natural cluster C remain together in the new cluster K 2 . So, C 1 is almost perfectly preserved. The natural cluster C members are split between two new clusters.

A closer look at the masked data reveals that among the nine top ranked attributes, four are generalized to a different ibility for masking identifying information.

We also conducted some experiments to study how the structure of a taxonomy tree could influence the generalization at 13 (the years of education, not age) is very reasonable because it indicates whether a person has post-secondary education.
F -measure and match point exhibit a similar pattern and suggest that as the QID increase, the preserved cluster quality of the cluster quality-guided anonymization over the general purpose anonymization becomes smaller because the non-
QID attributes dominate the clustering effect and, therefore, diminish the difference between the two anonymization methods. compared the overall F -measure between a multi-QID requirement and the corresponding single QID requirement, where the
QID is the union of the multiple QID s. For example, a requirement of three length-2 QID sis and the corresponding single QID requirement is We randomly generated 30 multi-QID requirements as follows. For each requirement, we first determined the number of the 14 attributes. A repeating QID was discarded.
 tween MultiQID and SingleQID is statistically significant at a = 5%. Fig. 7 b shows the averaged match point for the same requirement generally results in higher cluster quality than its corresponding single QID anonymity requirement. 5.1.5. Heterogeneous clustering arately using the two clustering methods (without any masking), and then measured the overall F -measure and match point caused by the nature of heterogeneous clustering, not by the masking.

The above studies suggest that if the data recipient applies the same clustering algorithm as the one used by the data holder for masking the data, the cluster structure obtained will be more similar to the raw cluster structure because the second clustering could extract the embedded structure preserved in the masked data. In contrast, if different clustering bias. This explains the significant drops in overall F-measure and match point for heterogeneous clustering. 5.1.6. Efficiency and scalability
We evaluated the efficiency and scalability of the TDR anonymization algorithm, which is capable of masking continuous ing the masked data to disk. The actual processing time for masking the data is relatively short.
The next experiment evaluates the scalability of TDR by adding some randomly generated records to the Adult data set, expansion scale. For each variation of r , we randomly selected q attributes from [ QID a solution, hence more runtime, than a larger threshold. TDR takes approximately 80 s to transform 1 million records. In Fig. 9 , MultiQID refers to the average runtime over the 30 random multi-QID requirements generated as described in anonymity requirement on multi-QID is a less restrictive constraint than the single QID anonymity requirement containing on this expanded data set is roughly the same as shown in Fig. 9 , so we omit the figure. 5.2. The Japanese credit screening (CRX) data set bute names in CRX have been changed to meaningless symbols, e.g., A analysis.
 homogenous clustering, followed by heterogeneous clustering. 5.2.1. Homogenous clustering
We first evaluate the cost and benefit, in terms of cluster quality, of employing our proposed method for anonymity
Then, we study cluster quality for anonymity requirement with multiple QID s. tant attributes to form the anonymity requirement, denoted by Top9 . 5.2.1.2. Benefit. Fig. 10 a shows the averaged clusterFM and distortFM over anonymity thresholds 5 means. The benefit of our cluster quality-guided anonymization over the general purpose anonymization spans from 40% 5 the benefit is unlikely to have occurred by chance.

Fig. 11 a shows the averaged clusterMP and distortMP over anonymity thresholds 5 efit spans from 9% to 60% for the number of clusters k = 2, 6, 10. The p -values for k = 2, 6, 10 are 1.67E 16, 8.50E 14, erally preserves better cluster quality than the general purpose anonymization on CRX . anonymity requirement spans from 0% to 23% for basic k -means and bisecting k -means at cluster numbers k = 2 and k =6. restrictive anonymity requirements. However, the cost increases to 30% when k =10in Fig. 10 a. Thus, it strengthens our claim that it is important to evaluate the cluster quality before releasing the data. basic k -means and bisecting k -means with anonymity thresholds 5 fects the cluster quality. to the result in Fig. 6 on Adult , we omit the explanation here. two portions. The left and right portions show the averaged overall F -measure over the 30 randomly generated test cases for basic k -means at h = 20, 50, 80 are 2.12E 9, 6.25E 6, 3.12E 3, respectively. The p -values for bisecting k -means at h = 20, 50, 80 are 1.03E 12, 2.49E 12, 1.42E 12, respectively. Fig. 13 b shows the averaged match point for the same Match Point on CRX . 5.2.2. Heterogeneous clustering
Fig. 14 depicts the averaged overall F -measure and averaged match point over anonymity thresholds 0 on both the overall F -measure and the match point for ( Bisecting KM ? Basic KM ). We notice that the drop is caused by heterogeneous clustering, not by masking, because the overall F -measure and match point also show severe drops on Raw
Data because the masking removes some overly specific information (i.e., noise) from the data. 5.3. Summary
These experiments verified the claim that the proposed approach of converting the anonymity problem for cluster anal-cluster structure in the raw data after masking identifying information for a broad range of anonymity requirements. The the general purpose anonymization.

The experiments demonstrated the cluster quality with respect to the variation of anonymity thresholds, QID size, and dependent.

The experiments confirmed that the specification of the multi-QID anonymity requirement helps avoid unnecessary cient and scalable for single QID , but less efficient for multi-QID . 6. Extension: beyond anonymity
The above approach provides a flexible framework that makes use of existing solutions as  X  X  X lug-in X  components. These of using the proposed TDR algorithm, the data holder has the option to perform the anonymization by employing one of the of masking operations discussed in Section 3, so some modification is necessary.

This paper focuses on preventing the privacy threats caused by sensitive record linkage, but the framework can also pre-vent sensitive attribute linkage by adopting different anonymization algorithms and achieving other privacy requirements, work can also adopt other evaluation methods, such as entropy [37], or any ad-hoc methods defined by the data holder. For number of clusters and anonymity thresholds, and visualize their influence on the clusters interactively. 7. Conclusions that could be used to guide the masking process. Our main contribution is a general framework for converting this problem corresponding classification problem. The experimental results verified the effectiveness of this approach. cluster analysis.
 Acknowledgements
The research is supported in part by the Discovery Grants (356065-2008) from the Natural Sciences and Engineering Re-search Council of Canada (NSERC), and the Faculty Start-up Funds from Concordia University.
References
