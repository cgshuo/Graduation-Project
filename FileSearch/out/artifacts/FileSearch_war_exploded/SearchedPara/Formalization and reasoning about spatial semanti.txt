 1. Introduction query processing [16] .
 ing spatial data types that define the domain of spatial attributes in a Euclidean space. clusion dependency constraints to combine spatial and thematic attributes.
R X  State Id s ; Name ; Area ; G s  X  X  ; Country Id c ; Name of states and dash lines represent boundaries of counties.

In this database, we need traditional constraints to enforce that attributes id attribute Area corresponds to the area calculated from the spatial attribute G the boundary of the state with which it keeps a relation through the foreign key Id (iv) are expressive enough to capture constraints found in practice. able [5] , but that the satisfiability of a set of conditional functional dependencies is intractable [2] . tables. For example, given spatial objects A and B , the topological relations must satisfy a set of constraints expressed by the possible topological relations between objects. some intractable cases.
 2. Spatial databases and integrity constraints types. 2.1. Spatial databases A spatio-relational database schema is a tuple  X   X U ; A ;
S is a spatial attribute that takes values in P R 2 , the power set of and ordered set of attributes belonging to A or S . We sometimes use R B butes. (e) T is a set of binary topological predicates. In a single-spatial schema schema.

A database instance D of a schema  X  is a finite collection of ground atoms of the form R ( c
B ; ... ; B l  X   X  R , (b) if B i  X  A then c i  X  U (c) if B i not empty) and are internally connected.
 of relations shown in Fig. 2 ,excluding  X  and  X  . 2.2. Spatial semantic integrity constraints capable of dealing with spatial attributes.

To simplify the presentation we will use the following notation: (i) variables x , y , z , x (ii) variables g , g 1 , g  X  , ... represent values in Ad ; (iii) variables u , v , w , u ... use 8 to denote that all free variables of the formula are universally quantified.
De fi nition 1. Given a schema  X   X U ; A ; S ; R ; T  X  X  , predicates P of the following:
Functional Dependency (FD):
Inclusion Dependency (IND):
Topological Dependency (TD): (a)  X  x 1 x 2 g 1 g 2 P x 1 ; g 1  X  X   X  R x 2 ; g 2  X  X   X  y (b)  X  x 1 x 2 g 1 g 2 P x 1 ; g 1  X  X   X  R x 2 ; g 2  X  X   X  Tg
Spatial Referential Dependency (RD):
Check Constraint (CC): where  X  a { N ,  X  , b ,  X  ,=}, Op a { Area , Perimeter } and t is either a variable in x or a constant c variable is in the positions of attributes A i and A j , then either A another with T c ( g 2 , g 1 ), where T c is the converse of T . For example, the constraint 8 Px be replaced by 8 Px ; g 1  X  X   X   X  g 2 Rx ; g 2  X  X   X  Covers g Example 2. Example 1 cont.

The following SSICs can be defined:
Functional dependencies ( 1  X  2 ) together with topological dependency (3) ensure that id way, constraints ( 4  X  6 ) enforce that id c is a key of County. Topological dependencies ( 7
Given a constraint  X  , a set of constraints  X  , a predicate P and a variable v , we will denote by (1)  X  by a database D if its antecedent is true in D . 3. Reasoning about topological relations and constraints of integrity constraints, which is addressed in detail by this work. 3.1. Topological consistency problem [12] two topological relations T 1 ( A , B ) and T 2 ( B , C ) over a common object B , denoted T composition between two relations, say Overlaps and CoveredBy , by:
De fi nition 2. Given a set of spatial objects Ob and a conjunctive topological expression sents a disjunction of base topological relations between objects A [22] if there exists a network of base topological relations, this is, if there exists a function TR : Ob  X  Ob (i) TR is defined for every A , B  X  Ob . (ii) For every A  X  Ob , TR ( A , A )= Equal . (iii) For every A , B  X  Ob such that T ( A , B )  X   X  , TR ( A , B ) (iv) For every A , B , C  X  Ob , TR ( A , C ) TR ( A , B )
Example 3. Given a set of objects Ob ={ A , B , C }, the topological expression is topologically consistent since a function TR can be defined, for example, as follows: TR ( A
The function satisfies the conditions in Definition 2 since TR ( A , B )= Equal in Ob , TR ( A i , C i ) TR ( A i , B i )  X  TR ( B i , C i
Example 4. Consider the set of spatial objects Ob ={ A , B , C , D } and the topological expression ( B , C )  X  Inside ( C , D )  X  Covers ( A , D ), which is illustrated as a network in Fig. 3 . { CoveredBy , Inside } and Covers  X  Includes ={ Includes }. Since CoveredBy tion TR that satisfies the conditions in Definition 2 .  X  3.2. Conjunctive realizability problem [15] determining if these objects exist is the realizability problem . logical expression like  X  =( Intersects ( A , B )  X  Disjoint ( B , C )
De fi nition 3. Given a set of objects Ob and a conjunctive topological expression junction of base topological relations between objects A i there exists a planar model for each object that satisfies the nodes and edges of the graph. Let O K in Fig. 4 should be disjoint . On the other hand, nodes overlap all their incident edges. For example node x y , y 2 , y 3 and y 10 , and is disjoint from all other objects. Edge y overlaps y 8 .  X  3.3. Satis fi ability problem
De fi nition 4. The satisfiability problem for a database schema exists a non-empty database instance D over  X  that satisfies IC . sion of satisfiability of IC  X   X  8 Rx ; g 1  X  X   X  Rx ; g 2 plus an inclusion dependency for each predicate in R . Since IC to consider the classical notion of satisfiability of constraints. as imposed by composition tables and (ii) will need to find specific objects in posed by the integrity constraints.
 pologically consistency.
 have, by mistake, written constraints (7) and (8) as follows:
The first constraint from State will also be checked when u = u can contain tuples, this set of constraints is inconsistent. always possible to find spatial objects in R 2 that satisfy them, this is, the geometries are not realizable. aschema R 5 in such a way that the set of constraints is satisfiable if and only if K predicates of the form X i ( id , g i )and Y j ( id , g j resent the nodes and edges of K 5 ,respectively,with id a thematic attribute, and g 1. For all Z  X  { X 1 , ... , X 5 , Y 1 , ... , Y 10 }: 2. For all X i  X  { X 1 , ... , X 5 } and Y j  X  { Y 1 , ... 3. For all X i  X  { X 1 , ... , X 5 } and Y j  X  { Y 1 , ... 4. For all X i  X  { X 1 , ... , X 5 } and Y j  X  { Y 1 , ... 5. For all X i , X j  X  { X 1 , ... , X 5 } with i  X  j : 6. For all Y i , Y j  X  { Y 1 , ... , Y 10 } with i  X  j : constraints will ensure that there is at least one tuple in every predicate. TDs (3) the different nodes and edges. It is easy to see that IC 5 quently, the set of constraints is not satisfiable.
 and an integrity constraint of the form 8 Rx ; y 1 ; s 1  X  X  with a finite number of tuples that satisfies this constraint. logical consistency can be used to obtain approximate results. We will explore this approach in Section 5.1 . 4. Satis fi ability of single-spatial schemas ness comes with a cost: the satisfiability problem for SSICs is not tractable. consists in determining if there exists a planar model that satisfies a conjunctive topological expression (i) each T i  X  { Intersects , Disjoint }, 3 (ii) for every A that T i ( A i , B i )  X   X  . The problem is said to be  X  low level  X  explicit  X  since for every pair of objects there always exists a unique relationship between them.
Given a conjunctive topological expression  X  we need to construct a set of constraints IC
IC is satisfiable if and only if  X  is realizable. Let  X   X   X  R ;
T Intersects ; Disjoint fg . Let IC  X  contain: 1. For every P A  X  R , a topological dependency: 2. For every A , B  X  Ob where A  X  B , the spatial referential dependency: where T  X  Intersects if Intersects A
Intuitively, each predicate represents one of the objects in and that all objects sharing the same value in attribute id satisfy the topological constraints given in
First, let us show that if IC  X  is satisfiable, then  X  is realizable. If IC have at least one tuple. Then, for every predicate P A there exists a constant c and a region g will also satisfy the topological constraints, if we assign to each object A
Now, let us prove that if there is a planar model of  X  , IC attribute of A in the planar model of  X  . Now, choose a constant c satisfies IC  X  .  X 
Example 9. Consider the schema  X   X  R ; A ; S ; R ; T  X  X  with A X  A set IC 1 ={ ic 1 , ic 2 }, where ic 1  X  8 Pu 1 ; v 1 ; g 1
Inside g 1 ; g 2  X  X  X  . For these constraints it is easy to see that if IC tuple per table that satisfies the constraints. Indeed, for g following non-empty instance:
Indeed, ic 1 is satisfied since u 1  X  v 2 is false in t 1 t [ G 1 ]) is always false and, therefore t [ A ] should be equal to t [ B ] to have in a consistent instance of { t } and D 3 ={ t 2 } also satisfy the constraints.

Now, let IC 2 ={ ic 1 , ic 2 , ic 3 }, where ic 3  X  8 Px ; ic that forces t [ A ]  X  t [ B ] for every tuple t in P .However,theset IC The example can be generalized for sets of FDs, TDs and CCs as the following proposition shows. that D  X  IC , then for any tuple t  X  D , the instance D t
To prove this small model property we will assume by contradiction that there exists a t
D  X  IC , but D t  X   X  IC . Since D t  X   X  IC , there exists an integrity constraint ic they are always satisfied in instances with only one tuple. Let ic be either a CC or a TD, if D straints. In order to test if such a tuple exists for a predicate P ,a tuple variable t 4.1. Satis fi ability of CCs of the spatial attribute due to the interaction Area ( g ) Given a single-spatial schema and a set  X  of CCs, algorithm sSAT least one predicate where the CCs are satisfiable. To check satisfiability in each predicate, sSAT
Fig. 6 , which takes a predicate P  X  R , a spatial attribute G in P and a set of CCs exist admissible values for Area and Perimeter and a tuple instance t for P such that t satisfies the CCs in if they are admissible; otherwise it returns ( null , null ).
 in these intervals must include values greater or equal to 4 the admissible intervals for Area and Perimeter should exclude values less than 4 replace all variables in Area and Perim by a unique fresh variable. In the algorithm, currence of variable x by variable y , and I 1 \ I 2 and I respectively.

At the end, the algorithm sPredSAT CC returns a tuple variable P x admissible interval for Area and Perimeter can satisfy  X  , the algorithm returns null, null .
In a set  X  P of CCs, we have inequalities and equalities with constants and variables. Let 8 P y possible: of the parabola.

ValidRangeSAT CC checks if the Area and Perimeter intervals defined after analyzing all CCs in admissible (lines 28 to 35). 4.2. Satis fi ability of CCs, FDs and TDs only need to enforce the satisfaction of CCs and TDs. First, algorithm sSAT which a tuple variable t p can satisfy the CCs (lines 7). If sPredSAT hand, if sPredSAT CC returns a tuple variable, possibly with repeated variables, algorithm sSAT isfaction of the TDs (lines 9  X  17).
 rithm forces some variables of t p to be the same to satisfy those constraints (lines 9 are triggered by t p such that its topological relation is not Equal, Within, Contains or Intersects (lines 14 found to be satisfiable, then the algorithm sSAT CC , FD , TD
Example 10. Consider a schema  X   X  R ; A ; S ; R ; T  X  X  with A X  A following set of constraints: Algorithm sSAT CC , FD , TD will first test if predicate R , with there are no CCs applicable to R (  X  ( R )=  X  ), algorithm sPredSAT tinct variables, e.g., t r = R ( x 1 , g ), and a tuple I =([0, spectively. Next, sSAT CC , FD , TD will check if the TDs can be satisfied (lines 9
Inside g 1 ; g 2  X  X  X   X  Ru 2 ; g 2  X  X   X  Inside g 1 ; g 2  X  X  X  will be triggered by { t 15 of sSAT CC , FD , TD ). Next, it will test if predicate P with 8 Pu 1 ; v 1 ; w 1 ; g 1  X  X   X  Pu 2 ; v 2 ; u 1 ; g 2  X  X   X  Overlaps g 1 ; g 2  X  X   X  X  , 8 Pu v
 X g is satisfiable. Algorithm sPredSAT CC willreturnatuplevariableoftheform t two attributes to be the same, and a tuple I =([4  X  ,  X  ),[4 the second and third variables in t p to be the same to satisfy the TD 8 Pu 1 ; v 1 ; w 1 ; g 1 satisfiable.

Note that although TD ( P ( u 1 , v 1 , w 1 , g 1 )  X  R ( v since it is enough to have a tuple in one of the predicates to satisfy tractable.
 4.3. Satis fi ability of acyclic SSICs Checking satisfiability of a set of SSICs with no cycles through INDs and RDs can be done in polynomial time.
De fi nition 5. Given a schema  X   X U ; A ; S ; R ; T  X  X  and a set of SSIC where the nodes correspond to predicates in R with an edge from predicate P to R if there is an IND 8 P u
RD 8 P u ; x ; g 1  X  X   X   X  yg 2 R u ; y ; g 2  X  X   X  T g 1 ; of SSICs is said to be acyclic if its dependency graph is acyclic.
 X  ( P ) is satisfiable. Algorithm sSAT acyc _ SSIC , shown in Fig. 9 , relies in this observation and calls sSAT SSICs is tractable.
 5. Satis fi ability of multi-spatial schemas comes intractable when multiple spatial attributes are allowed in a predicate. Theorem 2. There exists a set of TDs for which the satisfiability problem is topological expression  X  , we will construct a set of constraints IC if  X  is realizable for objects in Ob ={ A 1 , ... , A n }. Let and T X  Intersects ; Disjoint fg .Let IC  X  contain, for every A
In this reduction, a single predicate stores the spatial attributes of all objects in spatial attributes satisfy the conditions in  X  . It is easy to see that IC 5.1. Checking satis fi ability using the realizability problem tractable cases that result of this reduction.
 bound of S jj , where S is the set of spatial attributes in the schema. how this can be achieved.

De fi nition 6. ATD a  X  of the form 8 P x 1 ; g 1  X  X   X  P x 2 ; g constraints is said to be basic if it does not contain any mono-triggered TD
By the definition, a set of constraints is basic if it does not contain any TD 5.1.1. Satis fi ability of FDs and basic TDs and basic TDs. Also, since we do not consider mono-triggered TD
TD ical relations imposed over a single tuple are realizable. Algorithm mSAT topological relations between objects, solves the realizability problem. 10  X  13). Since no mono-triggered TD a s will be triggered by a single tuple, but all TD the topological relations of constraints of type TD b to the realizability problem (lines 9 true , then the predicate is satisfiable and mSAT FD , bTD icate. Finally, if no relation is satisfiable, it returns false . The algorithm is not polynomial in general since method Realizability solves an 5.1.2. Satis fi ability of CCs If all the calls to sPredSAT CC do not return null , mPredSAT where the equality conditions over T p have been merged (line 5 of topological relations in B of the form T ( i , j ), where T topological conditions are derived from the following reasoning: Given two regions g holds between topological relations in B and the areas of g laps( g 1 , g 2 )  X  CoveredBy( g 1 , g 2 )  X  Inside( g 1 , g verse topological relations. 5.1.3. Satis fi ability of CCs, FDs and basic TDs Algorithm mSAT CC , FD , bTD , shown in Fig. 15 , modifies algorithm mSAT if CCs are satisfied for single tuples using Algorithm mPredSAT conditions imposed by CCs if they are satisfiable. Next, mSAT these topological relations in  X  the realizability problem is solved (line 16). 5.1.4. Satis fi ability of acyclic basic SSICs mSAT acyc _ bSSIC , which is omitted in this paper because it can be obtained from sSAT 6. Discussion for general regions lizability and satisfiability problems where objects can be internally disconnected regions. objects need to either touch each other or be disjoint. Thus, RCC8 contains the 2 including the universal relation.

In [30,32] , the authors identified three maximal subsets of RCC8 , denoted time. where When considering only FDs and TDs, the realizability problem to be solved in algorithm mSAT Contains , IDisjoint } which, translated into unions of elements of B , results in T Includes }, { Touches , Disjoint }}. Thus, in this case, if the set T
We have that: T B  X  N 1  X  CoveredBy ; Inside ; Equal ; Covers
IDisjoint fg fg ; and T B  X  N 2  X T B  X  N 3  X T B  X  N 4  X T B
Intersects ; IDisjoint fg . Since the  X  H 8 , C 8 and Q 8 realizability problem for relations in T B is NP -hard.
 Proposition 4. Given a multi-spatial schema  X   X U ; A ; S ; Touches , Disjoint , Intersects , Within , Contains , IDisjoint }, there exists a set of TDs defined over satisfiability problem is NP -hard.
 relations in T which is NP -hard (direct from results in [30] ). if the set of ICs is satisfiable can be solved in polynomial time. Proposition 5. Given a multi-spatial schema  X   X U ; A ; S ; in polynomial time using the path-consistency algorithm.  X  is tractable in the same cases as for FDs and basic TDs. 7. Related work already existing semantic constraints at the logical level.
 sults of [1] are not directly applied.
 polynomial at different levels of granularity. The complexity of realizability is works of base relations in B .
 cases that can be reduced to the realizability problem. 8. Conclusions also shows the cases of the database satisfiability problem that can be reduced to the realizability problem. for FDs and INDs which are a particular case of SSICs.
 exploring measures of inconsistency of spatial databases and semantics for database cleaning. Acknowledgments
References
