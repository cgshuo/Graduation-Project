 Department of Computer Science, National Institute of Astr ophysics, Optics and Electronics, Puebla, Mexico
Department of Computer Science, Autonomous University of P uebla, Puebla, Mexico Department of Hematology, Mexican Social Security Institu te, Puebla, Mexico 1. Introduction
The morphological identification of acute leukemia familie s and subtypes is a difficult task that chemists and hematologists constantly face in hospitals. Leukemia i s a disease of the bone marrow and blood. There are two main types of leukemia: acute and chronic leuke mia, which can be classified in Acute Lymphocytic Leukemia (ALL), Acute Myelogenous Leukemia (A ML), Chronic Lymphocytic Leukemia (CLL), and Chronic Myelogenous Leukemia (CML). Acute leuke mia progresses quickly causing the accumulation of immature blood cells, and as a consequence, the marrow does not produce enough platelets, red blood cells, and white blood cells. Most of th e patients with leukemia develop anemia (a deficiency of red cells). The low rate of white cells affects t he patient X  X  immune system and the platelets deficiency causes bruising and easy bleeding. Chronic leuke mia progresses slower than acute leukemia. This allows producing more mature cells but still causes a hi gh mortality rate. There is a high number of deaths caused by leukemia around the world, which makes it a p ublic health problem [18].

According to the  X  X eukemia &amp; Lymphoma Society X , in their  X  X a cts 2007 X 2008 X  publication [11], it was estimated that there would be 44,240 new cases of leuke mia in the United States in 2007 (this publication was available in April 2007). From these, it was stated that the chronic cases would be 7% higher than the acute ones. Most of the cases affect old adu lts (beyond an age of 67) from which there are more AML and CLL. Among children the most common typ e is ALL. Approximately 21,790 deaths in the United States were suspected to be caused by leu kemia in 2007 (12,320 males and 9,470 females). From these, 4,500 were caused by CLL, 1,420 by ALL, 8,990 by AML, 490 by CML and 6,390 by unclassified forms of leukemia. Finally, in 2007, 51 5 children were expected to die from this illness. In Mexico, according to INEGI in its  X  X tatisti cs with respect to the World Day against Cancer X  publications [9,10], 6.3% and 5.5% of the deaths cau sed by cancer in 2005 in males and females respectively were due to leukemia (in 2006, these percentag es were 7.0% and 5.8% respectively). In children between an age of 1 and 4, leukemia caused 52 of 100 de aths (this and the information below correspond to 2005). Among children from 5 to 14 years old, ca ncer is the second cause of death with 15.8%, from which leukemia is responsible for 55.8% of those deaths. Among people between 15 and 24 years old, cancer is the third cause of death with 8.4%, fro m which leukemia causes 37.3% of that total (the fourth cause of death in men with 6.8% and the secon d in females with 12.1%). As we can see it is imperative fighting leukemia, a disease with a high mort ality rate. This is the reason that motivates our study of acute leukemia, the one that causes death at a hig her speed.

Detecting acute leukemia timely to provide the patient with an adequate treatment is decisive due to its quick development. The medical process starts when a g eneral physician has evidence (because of the symptoms or from the result of a peripheral blood test) that a patient has leukemia. If this is the case, another laboratory study is required to confirm the diagnosis. This can be done either with a morphological bone marrow smear analysis, a flux cytometry test (the type of test depends on the laboratory equipment of the hospital), or a chromosome test (with a cytogenetic analysis). The first test has an error rate of around 20% in the best case [16] but physic ians consider that this error rate increases up to 40 % in the worst case (according to our domain experts wh o are hematologists from the  X  X nstituto Mexicano del Seguro Social X   X  IMSS), which is related to the c hemist expertise and the difficulty to distinguish among the different blood cells subtypes. Acco rding to the FAB (French-American-British) classification [2], acute leukemia is divided into acute lym phoblastic leukemia and acute myeloblastic leukemia. In a finer division, there are three types of acute l ymphoblastic leukemia (L1, L2, and L3) and eight types of acute myeloblastic leukemia (M0, M1, M2, M 3, M4, M5, M6, and M7). This makes the leukemia subtype identification a difficult morphologic al task, because some leukemia subtypes look very similar to each other. The second and third tests are hig hly accurate but very expensive and not all the hospitals can afford to perform them (these are used, when possible, as complimentary diagnosis techniques). This is the reason why the morphological analy sis is still an important tool to detect and classify leukemia in order to choose an adequate treatment. This is why we recognize the need for an automated tool (or semi-automated) that can be used to suppo rt the medical diagnosis for acute leukemia identification from a morphological analysis. Such an autom atic tool could support the physician to reinforce his diagnosis.

The goal of our research work consists of creating a semi-aut omatic method that receives as input a bone marrow smear and produces as output a diagnose of the di sease (the acute leukemia subtype present in the smear) that could be taken as a second opinion b y the physicians. We are currently able to differentiate between lymphoblastic and myelogenous acut e leukemia and also among the acute leukemia subtypes present in our database. For this, we use machine vi sion and data mining techniques to process the smears. We first use machine vision algorithms to find regi ons of interest (ROIs) corresponding to white globules through segmentation algorithms. We then pr oduce a description (using a set of features) of each ROI to then feed a data mining algorithm that learns to classify the ROIs according to the type of leukemia to which they belong. Our method consists of two m ain phases. In the first one we train the algorithm to correctly classify the ROIs. In the second phas e, we classify new ROIs using the models learnt in the first phase.

Our research work contributes to the area in different ways. First, the creation of a segmentation method that allows obtaining regions of interest (white blood cell s). Second, the extraction and combination eigenvalues) in order to increase the classification accura cy of acute leukemia subtypes. The third contribution of our method consists of the consideration of the whole knowledge discovery process in order to provide the capability that the creation of a medica l support tool requires. It is true that we have not implemented the prototype of our semi-automatic ac ute leukemia identification for medical support tool yet, but we already have some of its main compone nts (segmentation, feature extraction, and classification algorithms). Now, we describe what our se mi-automatic tool is intended to do. The final goal of this research consists of the creation (in a near future) of a prototype tool to allow chemists, hematologists X  physicians, or students to use a microscope connected to a camera and a Graphic User Interface (GUI) to look for specific areas of a bone marrow sme ar, where suspicious and representative acute leukemia cells can be found (this part of the process wo uld be manual because physician use their experience to perform the task). It is important to note that at this point, when a bone marrow smear is available, there is enough evidence that the patient has leu kemia (either by the patient X  X  symptoms or a peripheral blood test confirmation) and our task consists of finding its family and subtype. After such an area is located, a digital image is obtained (the automati c part of the process starts at this point). We will then segment the white blood cells contained in the imag e, obtain their descriptive characteristics, and use the classifiers created during the training phase of o ur method to determine the acute leukemia family and subtype corresponding to the cells in the images, that is; provide a diagnosis support to the physician about the patient X  X  disease. Of course, we will on ly be able to identify those subtypes used during the training phase (due to our database limitations, but we are looking for more cases of those rare acute leukemia subtypes to be added to our acute leukemia dat abase). Our medical support tool cannot be completely automatic because the chemist, physician, or student is required to look for the area (or areas) of the bone marrow smear image to digitize, taking car e to obtain regions where suspicious cells (with high quality in the image) are found.

We should also consider that our MST-ALSI will have a cumulat ive error coming from the first phase, the acute leukemia family classification. Our domain expert s (hematologists from the IMSS) consider that our MST-ALSI will be successful when it is able to obtain an error rate below 10% for acute leukemia families and an error rate below 20% for acute leukemia subty pes. Error rates lower to these would be even better.

As we could see, the acute leukemia family and subtype classi fication is an important task, however; the computational process required to perform it is quite co mplex and because of this, the accurate classification of this type of images (or our regions of inter est) is a challenge, being also part of the contribution of our research work. These are the main difficu lties that the classification task faces: 1. The non-standardization of the staining process of the sm ears, which makes the images differ 2. A second problem is due to the similarity among different c ells subtypes, which makes necessary 3. One more difficulty faced during the classification task is related to the quality of the segmented 4. There are some leukemia subtypes for which we have a small n umber of samples.

These are the most important difficulties (some of them intro duce noise to our datasets) that affect the accuracy of the classification task, one of the main componen ts of our method.

As we can see, a semi-automatic method for morphological leu kemia identification can benefit in the reduction of error by providing a second opinion to the physi cian when making a diagnosis. This method can also be used to train chemists and physicians for leukemi a identification and can also be used in places where there are no specialists for this kind of diagno ses (as we know there is a lack of physicians in rural zones).

The results of our research show how our method, with the comb ination of different types of features, helps to distinguish among different acute leukemia famili es and subtypes with classification accuracy above 90% in most cases. These results, according to our chem ists and hematologists domain experts, are considered good to provide them with a medical support to ol for this difficult task.

The rest of the paper is organized as follows. In Section 2 we d escribe other research studies related to leukemia, in Section 3 we describe our leukemia database. We then present in Section 4 our KDD based method to identify leukemia using machine vision and data mi ning algorithms. In Section 5 we present our experimental results and finally in Section 6, we show our conclusions and future work. 2. Related work
The morphological analysis of bone marrow blood cells is an i mportant method to identify the leukemia family and subtype of a patient. Because of this, there has be en a lot of effort to perform this process with high precision and in our case; we are working to do it in a semi-automatic way. There are several reasons that justify the creation of this kind of systems. Fi rst, we have as a goal the reduction of the high error rates of chemists and hematologists to morphological ly classify leukemia by creating a diagnosis support tool. Second, there is a need to use this kind of test b ecause of the lack of flux cytometers and other costly equipment in most of the hospitals of third worl d countries. Third, there are few physicians specialized in the classification of leukemia, and then the s emi-automated tool can also be used to train new physicians and hematologists. Besides, this tool can be used in places where no specialists are available (such as rural hospitals where a bone marrow te st can be obtained and be sent to central hospitals with the appropriate equipment, probably being i ncluded under the structure of telemedicine programs). These are the reasons that motivate the creation of semi-automated applications that perform the analysis with a lower error rate and at a lower cost.

We just described why the creation of a semi-automatic tool t o classify leukemia is necessary, but we also know that this is a complex task. Among the difficultie s to overcoming the automation of the leukemia classification process from a morphological analy sis we have the cells segmentation problem (separating the cells of interest from the whole image). Ano ther problem consists on obtaining descriptive characteristics from the interest cells that allow high acc uracy during the classification step. We also need to train a classifier to distinguish among the different leuk emia subtypes even when we have just a few examples of some of them. There have been some research works trying to overcome these problems. Here we briefly describe some of them. It is important to menti on that not all of them deal with exactly the same problem but are somehow complementary and related t o our work.

Because leukemia classification is a difficult task, it has be en approached in different ways. Some authors distinguish between ALL and AML (the acute leukemia families) as described in [1,6,7] while others classify among leukemia subtypes as described in [13 ,20,21]. Other researchers classify different types of leukocytes (including a malignancy such as chronic leukemia) as we can see in [14,17,19,22]. Some of these works may even consider the developing stage of the cells [13] which is an even harder task because of the increase of the amount of classes; that is , the class now is related to both the acute leukemia subtype and the cells maturity stage (the stage of d evelopment of the cells, when they become leukemia cells, has to do with the leukemia type but the more m ature the cells are, the more difficult they are to treat; then we could consider a maturity stage for each acute leukemia subtype, which would also increase the number of classes of our problem). There ar e also differences regarding the descriptive attributes obtained to find classification patterns. Most of these works use geometrical, texture, and statistical attributes (as in [13]), and others work with ot her types of attributes (as in [6]) where the authors use what they call spatial attributes. In this work t he authors call spatial attributes the relation of pixels in their vicinity, which are more related to the cells texture than to their geometry. In our future work we will extract spatial relations among parts of the cel ls (i.e. the nucleus and cytoplasm), to obtain topological, distance, and direction relations among them (i.e. the nucleus is contained by the cytoplasm) to be considered as spatial features that relate spatial fea tures (geometries) inside the cell and between cells contained in the same image. Another remarkable diffe rence in the way in which different authors approach the problem is the segmentation process used to iso late the cells of interest, commonly referred as regions of interest or ROIs. There are some research works that consider the whole cells during the morphological analysis [6,13] while others separate the nu cleus and cytoplasm of the cells to perform such analysis [5,8,17,19]. Considering the nucleus and cyt oplasm as different parts of the cell allow the use of more attributes that help to classify the different ty pes of cells (leukemia subtypes in our case). Finally, another problem to solve is the separation of cell c lusters, mainly for applications that count the amount of cells of each type (as in [5,17]).

Although many works have been done in areas related to the ide ntification of leukemia cells, our work differs from the others because it considers the whole K DD process in order to classify both, acute leukemia families (AML and ALL) and acute leukemia sub types (with the restrictions of the acute leukemia subtypes present in our database). Our metho dology follows the KDD process as we describe in Fig. 2, where we can see how the pre-processing st ep includes the cells segmentation and ROIs characteristics extraction phases. We then focus on th e whole process (not only the segmentation step), including the classification phase. On the other hand , we do not only work with one type of acute leukemia as in the case of [13] that only identifies Myelogeno us cases, or the case of [14,19,22] that in general, identify leukocytes. We process bone marrow sme ars differing from [20,21], which work with peripheral blood. Thus, the main contribution of our me thod consists of the inclusion of the whole process in order to provide the capability that a medical sup port tool requires (our current work). Even with the research progress in the area, there are still many p roblems to be solved. Some of them (as mentioned before) are the segmentation of blood cells and ob taining descriptive characteristics of these cells to make possible their accurate classification. We par ticularly focus in the classification of acute leukemia families and subtypes from bone marrow smears. 3. Leukemia database Our leukemia database was obtained from the specialties hos pital of the  X  X nidad M  X  edica de Alta Especialidad X  (UMAE  X  IMSS), in Puebla, M  X  exico. This hospital has a hematology department that analyzes tests of patients with clinical evidence of leukem ia. As the first step, a hematological study of a peripheral blood smear is analyzed. The chemist or physi cian that performs this test searches for anomalies such as blasts (immature cells) in different area s of the smear selected in a random process. If he finds a blast in the test, then the physician suspects that a patient suffers of leukemia and he sends him to the hematology department for further revision. When the patient reaches this department, and there is enough evidence of the illness (the symptoms are very clea r, a peripheral blood test indicates so, or the combination of those diagnostic tools indicates it), the he matologist orders a morphological study. This is the reason why healthy people samples are excluded, becau se this department only stores positive tests (the bone marrow smear is obtained when there is a very high pr obability that the patient has leukemia). For this test, a bone marrow sample is taken from the patient X  s spine and is put in a smear with the Wright X  X  staining method in order to make the white globules more visible to the analysis. Moreover, depending on the economical resources of the hospital, a flux cytometer test is ordered so that the specific leukemia type and sub-type can be identified and a proper trea tment can be given to the patient. It could be expected that being the flux cytomerter test so reliable, the morphological analysis has become obsolete, but because of the cost issue, sometimes it is impossible to p erform this test. Besides, most of the hospitals in Mexico do not have flux cytometer equipment and t hen, the morphological analysis is still a need. For further clinical analysis, these results are stor ed in a database, including the clinical diagnostic, the bone marrow smears (it is possible to have more than one sm ear per patient derived from several tests), the morphological classification (supplied by an ex pert), and the flux cytometer classification, in case it was ordered. Therefore, each of our database registe rs has a morphological classification but they do not necessarily have the classification obtained with a flu x cytometer, which determines the patient X  X  acute leukemia subtype.

Considering the abovementioned, we digitalized the existe nt database according to the following methodology: 1. For each record in the database we identified those smears p er patient that were representative of 2. After the previous step, our bone marrow smear images were digitized with an optical Carl Zeiss
Our leukemia database consists of 1,028 images from 74 patie nts, 415 images correspond to acute lymphoblastic leukemia (ALL) and 613 to acute myeloblastic leukemia (AML). These images were carefully selected by domain experts (chemists and physici ans) to be used in this project. Additionally we have the result of the flux cytometry test in order to obtain the leukemia subtype classification also with the help of specialized physicians. Table 1 shows the nu mber of images of each leukemia subtype obtained from our database. As we can see, we have a large numb er of samples of subtypes L1 and L2, a moderate number of samples of M2 and M3, just a few sample s of M5 and none for L3, M1, M6 and M7 (the amount of cases in our database is similar to the real world proportion of cases of the disease within this region of Mexico, since our samples were obtained without a selection process based on the leukemia type / subtype). We are still working in the cl assification of those images for which we do not know its subtype (when we started with this research we did not have tests results providing this information). We also plan to obtain more images for tho se subtypes out of which we do not have enough samples in order to improve our identification accura cy. Figure 1 shows four images from our acute leukemia database. 4. Methodology
In order to achieve our acute leukemia identification task, w e follow the knowledge discovery in databases (KDD) process also known as data mining [23]. The K DD process consists of the following steps: data collection, data selection, data pre-processi ng, data transformation, data mining, patterns evaluation, and knowledge application. In the first step we s elect the data source, which is the set of images that our domain experts helped us to obtain. We then ne ed to know which of the cells in the images are useful for the classification task and finally, to which ty pe of acute leukemia each cell corresponds. For this, we obtain a domain expert classification (through a morphological analysis) that was confirmed through flux cytometry tests results. This is the initial inf ormation needed to start the process. Next we isolate the white blood cells as indicated by the domain expe rt. We use machine vision techniques in order to segment our regions of interest (white blood cells) and be able to work with them. Once the cells are segmented we obtain different types of characteristics from our ROIs that are used to feed our data mining algorithms looking for patterns. Finally, the found patterns are evaluated for the classification task. Figure 2 shows the KDD process specialized in our acute leukemia identification task. There is an iterative nature in the KDD process. Then, at any step, we do c onsider going back to previous steps as necessary (i.e. going back to the preprocessing step in orde r to enhance the images, their segmentation, or to obtain more cell features, or going back to the data coll ection step to obtain more images of specific cases, or perhaps return to the data mining step in order to ob tain different descriptive patterns).
In Sections 4.1 to 4.3 we describe in detail the process follo wed to obtain regions of interest, their descriptive characteristics, and their descriptive patte rns.
 4.1. Obtaining regions of interest through image segmentat ion
Once we identify our ROIs in the images, we proceed to isolate them through machine vision tech-niques. This is a complex step because of several reasons. Fi rst, the white globule cell consists of a nucleus and cytoplasm that differ in tone and sometimes the c ytoplasm is not included in the ROI (some other times the cell does not have cytoplasm at all). Second, there are some parts of the cell which color is similar to the background or to red globules, depending on the staining quality (the Wright X  X  staining is prepared locally and this is why different smears may have very different tones). Third, there are many images where cells overlap and it is difficult to find the cell b orders. Because of this, we have worked with different segmentation algorithms specialized in our task, such as the one described in [15]. In this section, we describe the segmentation algorithm with which up to now, we have obtained our best results.
Our image segmentation is done in two phases. We first perform a segmentation technique based on color that uses the k -means algorithm with the standard Euclidean distance (in o ur future work we will try other techniques such as Self Organizing Maps). We work w ith images in the Lab format omitting the luminosity channel. We chose using the k -means algorithm to segment our images with k = 4 (which corresponds to the number of regions to segment), so that we c ould separate the image in four main tones, one for white globules, another for cytoplasm, one mo re for the background, and finally one for red globules. As result of the k -means segmentation we obtain four images, one for each grou p as shown in Fig. 3.
 For each of the resulting images, we analyze its histogram an d find out which image contains our ROIs, and which of them the background. We finally join three o f the images to get only one without background in RGB format (to which our Lab images are convert ed) and get an image as shown in Fig. 4.
After the color segmentation used to eliminate the backgrou nd, we perform a ROIs segmentation. In this process we use as input our image segmented by color (wit hout background) and separate it in its three bands (R, G, and B). Each image is then converted into it s binary format and we then find the boundaries of each region and assign an index to each of them a s shown in Fig. 5 where different tones indicate a different type of region. We only keep regions wit h an area larger than 500 pixels because smaller areas correspond to noise. Finally, with the help of the domain expert, we decided which of the identified regions could be used as our ROIs, which in our case correspond to white globules and from which we can identify acute leukemia (myeloblastic or lymph oblastic).

Once we identified our ROIs, we need to describe them using dif ferent types of characteristics (as we describe in next section) so that we can find classification pa tterns from them. 4.2. Describing regions of interest with features
After we segmented our ROIs, we are ready to find descriptive c haracteristics to be used in the data mining step in order to find descriptive patterns for each leu kemia type and subtype as we will describe in the following subsection and our experimental results in Section 5.

A feature of a ROI is a primitive distinctive attribute. Some features are defined by the visual appearance of an image, whereas others result from some spec ific manipulation. The features that we obtain from our ROIs are related with their geometry, their t exture, and with statistics obtained from the pixels that compose them. Another type of feature that we are using consists of the eigenvalues obtained from Principal Component Analysis (PCA). Our process to obt ain descriptive features from our ROIs begins with the conversion of the original ROI to gray tones u sing Matlab procedures (from its basic and the image processing toolboxes and some of them were program med). Table 2 shows the geometric, texture, and statistical features that we used to describe o ur ROIs. We did not verified correlation between attributes and let the algorithms choose which of them were i mportant for the classification task. We performed some feature selection tests but, as we mention in the experimental results section, these were not as good as the results obtained when we do not apply the fea tures selection step.

As we mentioned before, another type of feature that we used c omes from PCA and consists of a set of eigenvalues. The process that we follow to obtain eigenvalu es is described in [12] but we use the roots of the typical equation as attributes (the eigenvalues). Give n equation 1 (where  X  is the correlation matrix shown in equation 3, I is the identity matrix, and  X  is an eigenvalue), we find the eigenvalues  X  n x n matrix we find n eigenvalues) and given Eq. 2 we then find an eigenvector v for each eigenvalue  X  .
In this process we calculate the correlation matrix for each image (one for each of the three bands of our RGB images) and we obtain the eigenvalues and eigenvecto rs by solving equation 1. As our features we use the obtained eigenvalues that accumulate variabilit y greater or equal to 80%. For our experiments we used 10 eigenvalues for each band (30 eigenvalues for each ROI) to accumulate the required 80% of variability. Once we obtained our descriptive features, we were ready for the experimentation phase to find descriptive patterns and be able to classify acute leuke mia types and subtypes. 4.3. Finding descriptive patterns
The features obtained from ROIs are used to find patterns that help us to classify acute leukemia types and subtypes. We need to find those features that combined are good enough to differentiate a ROI of a leukemia type or subtype from the others. These are the patte rns that we need to achieve our classification goal. For our classification experiments we used the Weka dat a mining tool [23] and tested several of the algorithms implemented on it for each of them. Some of the algorithms produce results that are easy to understand such as J.48, which we showed to our domain expe rts so that they could analyze them and tell us if they find a relation among the features that they use when performing a morphological analysis and some of the features found by our semi-automatic process to identify leukemia. Once we found our best classification models, we use them to classify new image s. We tested our results using the 10-Fold Cross Validation with statistical significance technique. A detailed description of our experiments is presented in next section. 5. Experimental results
Our experiments were designed according to two main constra ints. The first one is related to the limitations of our database and the second one to the concept ion of the semi-automatic tool that we will build in our future work. A natural limitation of our databas e is its lack of healthy patients X  samples because a bone marrow sample (considered as an invasive proc edure) is taken only when there is a high probability that the patient has leukemia (confirmed by symp toms and peripheral blood tests). A second limitation of our database is its lack of some acute leukemia subtypes (L3, M0, M1, M4, M6 and M7) because those are rare cases in the region of the Hospital. As part of our current and future work, we are continuously adding cases to our database. Then, our experi ments are restricted to the cases available in our database; however, even with these restrictions, it c ontains a significant number of cases and we are able to create models to classify among the available acu te leukemia subtypes samples. The second restriction has to do with the way in which our MST-ALSI is pla nned to be created (as described in the introduction section).

In this section we present a description of our experiments a nd results. We performed two types of experiments. First, we differentiate between our two leu kemia families, ALL and AML. Then, we identify ALL and AML subtypes. For the leukemia subtype clas sification experiments we used the images of our database to obtain 169 ROIs as shown on Table 3. A s we can see, we have 176 images that correspond to ALL, from which 103 are of subtype L1 and 73 of su btype L2. From the L1 images we obtained 65 ROIs and from the L2 images 30 ROIs. We have 116 AML cases, from which 57 correspond to subtype M2, 48 to subtype M3, and 11 to subtype M5 with 38, 26 , and 10 ROIs of each subtype respectively. As we described in the database section, ther e are some images containing more than one ROI and others without any ROI. The images from which we did no t obtain ROIs were not used neither during the training nor testing phases; therefore, they are not included in the accuracy calculation. The reason that caused no ROIs to be added from these images has to do with quality problems, for example, from the segmentation point of view; the ROI X  X  were overlapp ed cells that our current segmentation algorithm is not able to obtain.

It is important to note that there are some leukemia subtypes for which we have a relative high amount of examples such as AML subtype M2 while there are others for w hich we only have a few as in the case of AML subtype M5. This is known as the class imbalance proble m and its effect can be seen because the classification accuracy of examples of the class with a hi gh amount of examples is good while the classification accuracy of the class with a low number of exam ples is poor. Because of this problem we use a technique known as SMOTE [4] to create artificial exam ples (new examples) of the minority classes to balance our data and allow for better classificati on recall results for those classes. Specifically, we oversampled subtypes L2 at 100% to obtain a total of 60 exam ples, M3 at 100% to get 52 examples, and M5 at 300% to get 40 examples. We used the artificial exampl es only during the training phase but not during the testing phase.

It is important to mention that our domain experts (chemists and hematologists from the IMSS) require accuracy above 90% for acute leukemia families and i deally, the same accuracy is desired for the acute leukemia subtypes. However, as we mentioned befor e, the accuracy reached by chemists and hematologist physicians may have an error rate up to 40% (als o according to our domain experts from the IMSS) depending on their level of experience. Hence, reachi ng accuracy over 80% is considered good for this difficult task. Accuracy over 90% was reached in our fi rst experiment between ALL and AML using all the samples of our database with this classificatio n. In the second experiment to distinguish between ALL and AML, in order to be consistent with the experi ments for acute leukemia subtypes, we used a reduced number of samples that corresponds to the same used for the acute leukemia subtypes experiments (this happened because not all of our samples ha ve their corresponding acute leukemia subtype classification). This reduction in the number of tra ining examples caused an accuracy decrease as we will see in the corresponding experimental results. In the acute leukemia subtypes classification task we need to consider the cumulative error coming from the acute leukemia families classification.
For all of our experiments we tested with different classific ation algorithms, but we only report the assigned acute leukemia family and subtype (actually, we do not have the subtype information for every sample of our database because the flux cytometry test for all the patients is not available). In our experimental task we use our cells dataset to train a classifi er so that given a new cell, it is able to identify its leukemia family and subtype. Then, the error rate of our c lassifier corresponds to the percentage of misclassified cells (in our MST-ALSI prototype we will focus to evaluate the error rate as the number of misclassified patients). In our experiments, in order to obt ain unbiased results, we performed a 10-Fold Cross Validation where the whole dataset is divided into 10 p arts and one of those data segments is used to validate the classifier while the other 9 segments are used to build (or train) the classifier. This is repeated 10 times and the average of the accuracy results i s calculated. The same procedure was performed with different classifiers as we could see that dif ferent classifiers behave different depending on the domain (the acute leukemia subtype). That is, we prese nt the results of the best classifiers but we performed a 10-Fold Cross Validation for each of them in orde r to obtain unbiased results. These are the classifiers that we will use in the prototype of our applicati on tool (MST-ALSI); classifiers specialized by leukemia subtypes. 5.1. Differentiating ALL and AML
We performed two experiments to distinguish between ALL and AML. In the first experiment, we used a larger set of ROIs from our database considering only descr iptive features as described in Table 2. We used 251 ALL and 63 AML examples and obtained accuracy of 95.5 % [15] with a multilayer perceptron neural network with one hidden layer with five neurons (with l ower recall for AML because there is a proportion of 80% of ALL and 20% of AML cases respectively). T able 4 shows the best results obtained in this first test, as we can see recall for ALL is higher than th e recall for AML. We believe that this is due to fewer training examples of the AML class. In this exp eriment, we could use a larger amount of images because for all of them we know whether they are ALL o r AML but we do not know their acute leukemia subtype. This is why for the second experimen t (acute leukemia subtype classification) we used a reduced amount of examples (for ALL). Actually only those for which we know the acute leukemia subtype classification (confirmed with a flux cytome try test).

For the second experiment we used descriptive features, eig envalues, and a combination of descriptive features and eigenvalues to classify our ROIs as ALL and AML t o see if we could reach an accuracy as good as that obtained in the first experiment. At this point ou r database changed as our domain expert gave us information about the acute leukemia subtype classi fication in order to perform the experiments described in Section 5.2. As we can see we have 95 and 74 ALL and AML ROIs respectively, which differ from the number of ROIs used for the previous result. W e used this number of ROIs (although we had more) because we wanted to use the same data that we use f or the acute leukemia subtype classification. We could not add more ROIs for the subtype cla ssification because we did not have yet the subtype confirmation from our domain expert (if there are errors in the data, the classification algorithms could generate an inaccurate model). However, i n order to improve our accuracy results, for these experiments we applied the SMOTE oversampling tec hnique to create artificial examples and balance our ROIs training set. We applied SMOTE to the exampl es of the AML M5 subtype so that we could balance the amount of ROIs with those of the other subty pes (M2 and M3).
 We can see our accuracy results for the second experiment in T able 5.

In this case, the best result was obtained either using only e igenvalues or combining eigenvalues with descriptive features with 88.24% of accuracy (with 88.89% o f accuracy for ALL and 87.50% for AML), and finally the classification using only descriptive featur es produced 82.35% of accuracy (with 77.78% for ALL and 87.50% for AML). As we can see, there is a global acc uracy reduction of more than 7% (from 95.5% obtained with the MultilayerPerceptron algorithm to 88.24% obtained with the J48 algorithm and eigenvalues as attributes and RandomForest with descripti ve plus eigenvalues as attributes) when we decrease the amount of training examples. Even with this glo bal accuracy reduction, it is important to note that the difference of accuracy between classes is sm aller for the second experiment (less than 2%) than for the first one (more than 8%). The following experi ment considers acute leukemia subtype classification. 5.2. Subtype classification using descriptive features
In this experiment we used geometric, texture, and statisti cal features to classify the ALL and AML subtypes. We have a total of 5 classes; two of them correspond to the ALL family (L1 and L2) and three to the AML family (M2, M3, and M5). It is important to mention t hat when we perform the subtype classification, we already know the ROIs family from the clas sification described in Section 4.1. We then have two groups, one for ALL and other for AML. For the AML subgroups we used a two class scheme (we created three data subgroups with a positive and a negative class where the positive class was M2, M3, or M5 respectively for each group). Our classifica tion results using descriptive features are shown in Table 6.

For these experiments we always set k = 3 for the IBk algorithm and we ordered the 30 features according to their correlation with the class (the leukemia subtype) using the ranker filter of Weka. As we can see in Table 6, our best results were obtained with the I Bk, RandomForest ensemble, AdaBostM. IBk ensemble, and the AdaBoostM.BayesNet.TAN ensemble alg orithms. We can also see that even when we have more examples of lymphoblastic leukemia, we obtaine d better results classifying myeloblastic subtypes. We believe this is due to the oversampling techniq ues that we used and that is why we obtained above 95% of accuracy to classify AML-M5 that was the one for w hich we had fewer original examples. We obtained 86.4% of accuracy to classify between the L1 and L 2 subtypes, 91.53% to classify M2, and 88.46 to classify M3. As we mentioned before, these are the be st results that we obtained, we also tested with attributes selection but those results were not as good .
In order to get the best possible results, we tried using othe r types of features, eigenvalues as described in the following section. 5.3. Subtype classification using eigenvalues
In our second experiment to classify leukemia subtypes our f eatures consisted of a set of eigenvalues that were obtained as described in Section 3.2. These eigenv alues are already ordered according to the variability that they represent and this was the reason for w hich we did not apply any attribute selection algorithm. We used 10 eigenvalues for each band in RGB format for a total of 30 features for each ROI. In this case, the best results were obtained with the ADtree, AdaBoostM.IB1, AdaBoostM.Ktar, and AdaBoostM.SMO algorithms as we show in Table 7.

As we can see from Table 7, we obtained better results for the m yeloblastic subtypes than for the lymphoblastic subtypes (just as it happened when we used geo metric, texture, and statistical features) and these results are generally better than those shown in Ta ble 6, except for the classification of subtype M2. We obtained 87.20% of accuracy to classify between subty pes L1 and L2, 90.76% to classify subtype M2, 90.00% for subtype M3, and 98.46% for subtype M5. Again, w e can notice that we obtained better results for subtype M5 than for the others even when we had the least original examples of this type.
As we mentioned before, these results are better than those o f Section 5.2 except for subtype M2, this was the reason why we decided to use a combination of geometri c, texture, and statistical features with eigenvalues, which is described below. 5.4. Subtype classification using descriptive features com bined with eigenvalues
For our last leukemia subtype classification experiment, we combined our descriptive features with eigenvalues, and then we used 60 attributes. Our best result s were obtained with the LMT, SMO, and AdaBoostM.SMO algorithms. In this case, we obtained 89.6% o f accuracy classifying the L1 and L2 subtypes, 92.30% for the M2 subtype, 88.46% for the M3 subt ype, and 99.23 for the M5 subtype. These results are in general better than those of the experim ents described in sections 5.2 and 5.3 except for subtype M3 for which classification using only eigenvalu es was better. 6. Discussion
The goal of creating an automatic tool to classify leukemia i n families and subtypes pretends to decrease the accuracy error of physicians for the task of mor phological leukemia classification. We want to create a support tool that physicians can use to confir m their diagnosis or that can be used in rural places where there are not specialists, or even to trai n physicians in this matter. For this, there is a requirement for the tool to achieve high accuracy in the tas k and this is why we tried to improve our results as much as possible. An accuracy rate of 90% was set by our domain expert to accept the tool. As we can see in Fig. 6, when we used what we call descriptive fe atures, we did not reach our goal for the L1, L2, and M3 subtypes. With our second experiment using eigenvalues we did not reach our goal for the L1 and L2 subtypes, and finally with our third experime nt, we did not reach our goal for the L1, L2, and M3 subtypes, although we are really close to the L1 and L2 subtypes with 89.6% of accuracy.
On the other hand, if we combine our experiments, we almost ac hieve our goal because we can use the highest accuracies of each experiment as we show in Table 9 where we use the result obtained with eigenvalues for the M3 subtype and the results of our combine d approach for all other subtypes.
It is also desirable to compare our results with other resear ch works as those mentioned in Section 2 but this is not an easy task. Some of these results are describ ed next. In [6] an accuracy of 97.1% was achieved to distinguish between AML and ALL with a training s ample of 25 AML and 25 ALL ROIs but they did not describe the testing methodology. The works des cribed in [3,19] differentiate among 5 types of leukocytes, obtaining an accuracy of 89.07% and 91% respe ctively. Another related work distinguishes among 17 types of myelogenous leukemia cells [13], obtainin g an accuracy of 81.29% when they work with their entire database and 93.24%when they neglect erro rs produced by cells belonging to the same cellular line (very difficult cases). In [22], the authors di stinguish among six types of cells, one of them corresponding to CLL with accuracies from 86% to 100% wi th 90% for CLL. The previous results show that current research to identify leukemia has differe nt areas of interest, such as differentiating between acute lymphoblastic and acute myeloblastic leukem ia, identifying different types of leukocytes, classifying ALL subtypes, classifying AML subtypes, and id entifying CLL. Finally, a classification of ALL subtypes is presented in [20] which was performed with pe ripheral blood samples and achieved an accuracy of 98.67%. In our research, we focus in the classific ation of ALL and AML subtypes, but it is very difficult to compare our results with the results of ot her authors. First, because we use different databases (the amount of examples is different as well as the characteristics of the cells images) and second because we do not use the same testing methodology. Ev en with this difficulty, we can say that the accuracy obtained by us in the classification of the ALL an d AML families could be compared to that obtained in [6] with 95.5% and 97.1% respectively. We cannot compare our results for acute leukemia subtypes identification because previous works perform ver y different tasks (the experiments settings are also very different), for example, we only work with 3 AML sub types while [13] works with 17 AML subtypes (considering the maturity state of the cells, whic h we do not consider) but without considering any of the ALL subtypes (that we do consider). In the case of AL L we work with bone marrow samples while the work by Scotti [20] was done with peripheral blood s amples. Other works only focus on the cells segmentation phase [5] and some others classify the di fferent types of leukocytes [14,17,19,22]. This is the reason why a comparison of results is not compatib le; we are working on different tasks of the problem. 7. Conclusions and future work
In this work, we found how the combination of different types of features helps to distinguish among different acute leukemia families and subtypes, we specific ally combined descriptive features (geometric, texture, and statistical) with eigenvalues. With this feat ures combination we were not only able to dis-tinguish among those acute leukemia families and subtypes b ut also show how we increase classification accuracy and recall for the acute leukemia classification ta sk. We could see that although classification using eigenvalues was superior to classification using desc riptive features, a combination of them could increase classification accuracy for most of the cases.

The classification accuracy results obtained with our metho d are considered satisfactory by our domain experts, above 90% (except for ALL with accuracy of 89.6%). T his conclusion considers both, the difficulty of the classification task (because the subtype ce lls are very similar among them) and also that human experts have an error ranging from 30% to 40% for the sam e task (as described by our domain experts). This is a good indicator that we are getting close t o the results that we need to achieve our goal, implementing a medical diagnosis support tool for the morph ological classification of acute leukemia families and subtypes, and we know this is going to be a new cha llenge.

Comparing our results with those found in related work, we ha ve the advantage of being able to both, segment bone marrow cells and classify acute leukemia , that is; we consider the whole process in order to segment the bone marrow cells, classify their acute leukemia family, and their acute leukemia subtype. We follow this process in order to create the core al gorithms of our medical support tool for acute leukemia diagnosis.

As our future work we will complement our leukemia database o btaining more examples for the categories where we only have a few and will also try to obtain examples of those subtypes for which we do not have any. We are also going to work to improve the clas sification accuracy that we have reached up to now by exploring other features (probably spat ial features), working with feature selection, and improving our oversampling techniques. We are also goin g to start with the construction of a GUI to automate the process and create the medical diagnosis support tool for acute leukemia subtype classification. We also need to improve our segmentation alg orithms in order to be able to automatically segment our ROIs, even when our smears are not standardized b ecause of illumination and staining differences and when we find overlapping cells. Finally, we w ould like to create a benchmark database that can be used to compare different research works under th e same environment.
 References
