
Li Xue 1 ,YunXiong 1 , Yangyong Zhu 1 , Jianfeng Wu 2 , and Zhiyuan Chen 3 According to the EMH theory[1], many researchers believe it is a promising way to predict stock movement using the information appears on the web. Among current literature, most studies have tr ied to analyze the correlation between the time of web news release and that of stock movement. Although text mining based methods using news articles hav e achieved some success, the accuracy of prediction could hardly rea ch a satisfactory level[2].

Recently, inspired by the idea of opini on mining, a few st udies[3,4,13] have appeared to predict stock market movement by mining sentiment information on the web, such as blog, twitter and editorial, which we call subjective anal-ysis method. Although many studies of this research line have achieved higher prediction accuracy than be fore, some problems still exist. For example, most of previous studies focused on the opinions about individual events and evaluated them separately, which could hardly capture the overall opinion about hot issues.
Furthermore, most current studies cannot be directly applied to universal corpus covering multiple topics. However, the online financial corpus usually involves many topics, just like the corpus listed in Table 1, which covers the main topics of March 15, 2011 on SinaFinance. In addition, the trends of stock market are usually determined by the hot issues on the market, which would always be written as the key topics of financial articles. Thus, it would be a promising way to make stock prediction by the overall opinion on the key topics of daily financial articles.

In this paper, we introduce a novel stock prediction method using aggrega-tive topic-opinion of web financial corpus. Firstly, we extract article opinion by lexicon-based opinion mining method, which takes intensity and polarity as the measures of article opinion. Secondly, we transform the article opinion into a multidimensional topic-opinion vector according to our proposed topic-opinion model. Thirdly, an opinion integration method by using article weight and topic weight is used to generate the Aggregative Topic-Opinion Vectors(ATOV). Fi-nally, the stock market trend could be predicted by these ATOVs.

The rest of this paper is organized as follows. In Section II, we review some previous works on text mining based stock prediction. Next, we present the Topic-Opinion model in Section III and show details about the weighted Topic-Opinion aggregation model in Section IV. Stock trend prediction using ATOV is introduced in Section V. Then in Sect ion VI, we perform two groups of exper-iments on three datasets and make compar ison between the results. Finally, we summarize the paper in Section VII. Generally, text mining based stock prediction studies mainly follow two lines: ob-jective analysis and subjective analysis. The objective analysis focuses on mining correlation between objective information of textual articles and stock market movement trend. There have been numerous interesting attempts including the earlier works by Wthrich, et al.[5] which s tarted to use textual news articles for financial forecasting. Later, Lavrenko et al.[6] presen tedastockpredictionap-proach by extracting most influential news. Recently, many scholars have turned to studying the market response to financial text streams. For example, Ing-valdsen et al.[7] addressed the problem of extracting, analyzing and synthesizing valuable information from continuous financial text streams. Other than news articles, Kloptchenko et a l.[8] presented a technique analyzing quantitative data from annual financial reports.

In recent years, sentiment analysis and opinion mining techniques have at-tracted much research attention in text mining community. For example, Ah-mad et al.[9] studied on extracting multi-lingual sentiment from financial news streams, which could deal with sentiment analysis on Arabic and Chinese corpus; Devitt et al.[10] explored a computable metric of positive or negative polarity in financial news text which was consistent with human judgments and could be used in a quantitative analysis of news sentiment impact on financial markets; Sehgal et al.[3] made stock prediction using web sentiment extracted from mes-sage board; Wong et al.[4] brought out a pattern-based opinion mining method for stock trend prediction. Another amazing study that predicted stock index movement by public mood and sentiment extracted from twitter, was carried out by Bollen et al.[11].

Compared with the works mentioned above, our study is more similar to some works of the second line,such as the method proposed by Mahajan et al.[12]. However, their work made stock prediction by the major events extracted from financial news, instead of by the opinion extracted from universal financial corpus. 3.1 Definitions Definition 1. (Article-Opinion) For each article d i ,PS d i and NS d i are used to by lexicon-based method. That is, for article d i , we determine whether d i contains any number of negative and positive terms from the sentiment lexicon. For each occurrence, we increase the score of either negative or positive by one. Definition 2. (Topic-Opinion) Similar to the idea of topic model,for each article d , two vectors, P-TOV d i and N-TOV d i are defined as topic-opinion of article d i . negative lexicon-based opinion of article d i on topic k respectively. 3.2 Topic-Opinion Generation Step One: Topic Extraction It is more reasonable to predict stock movement trend according to emerging topics from new incoming corpus slice, which capture evolutions of existing top-ics. Thus, we apply an online LDA model[13] rather than basic LDA model in our study to extract the latest hot issues on stock market.

In this study, we assume that the articles arrive in discrete time slices, the size of which is set to a day.Thus, the topic distribution over words on day t ,  X  k , is drawn from a Dirichlet distribution governed by the model on day t which is presented below: 0 &lt; X   X  1 is an evolution tuning parameter introduced to control the evolution rate of the model. Thus, the generative model for day t of online LDA model can be summarized as follows: 1. For each topic k =1 ,...,K 2. For each document, d =1 ,...,D t : Similar to many other applications of topic model, there is no fixed rules for setting the value of topic number K . According to our method, it is unreasonable to set K to a large number, since we mainly focuses on opinions about the hot issues in a day. Therefore, topic number K is set to a small integer, 10 in our case.
 Step Two: TOV Calculation After applying online LDA process on corpus slice D t , the lexicon-based Article-Opinion of each article d i could be reformulated as TOV d i by Equations (1-2): Where PS d i and NS d i are positive and negative Lexicon-based Article-Opinions of d i respectively.
 4.1 Weighted Topic-Opinion Aggregation Definition 3. (Aggregative Topic-Opinion) For corpus D , two vectors, P-ATOV D and N-ATOV D are defined as aggregative topic-opinion of corpus D . of corpus D on topic k respectively.
 Simply speaking, the ATOV of corpus slice D t is generated by calculating the aggregate opinions on individual topic one by one. A simple way of aggregating the opinions of corpus slice D t on topic k is showed in Equation (3): Obviously, the opinion aggregation approach by Equation (3) assumes every article has an equal weight. However, it is unreasonable to hold this assumption in many cases. Next, we will explain this issue by the case listed in Table 1.
Among the corpus listed in Table 1, 42 articles were written about isolated events that were related to individual stock or company, the other 113 arti-cles mainly focused on eight topics, suc h as Intellectual Property Protection, Japanese Nuclear Leakage, Property Pur chase Restriction etc. All these topics were hot issues on March 15, 2011, which had the major influence on the stock market or some individual securities. Intuitively, the articles written about hot issues would have more impact on stock market than ordinary ones. Thus, the importance of each article should be considered when we aggregate the opinions presented by this corpus.

In addition, the number of articles on different topics varies as shown in the first column of Table 1. For example, 36 articles were written about the topic of Intellectual Property Protection and Food Security, and only 3 articles discussed the problem about the Flood happening in New Jersey. Although, both the topics were key topics on March 15, their influences on stock market were obviously not equal, so the topic importance should also be put into consideration as we aggregate the opinions on different topics. Due to these reasons, we introduce two parameters, w d j and w topic k into Equation (3), thus the opinion aggregation method is transformed into the following way: where, w d j and w topic k represent article-weight and topic-weight respectively. 4.2 Article-Weight In our study,we acknowledge the following two assumptions.
 Assumption 1: Articles involving similar topics are likely to have similar im-pacts on stork market.
 Assumption 2: Articles involving hot issues are likely to have large impacts on stock market.

Following the above assumptions, the article-weight of d i could be described by Equation (5): cates the dissimilarity of topic distributions of d j and d i . 4.3 Article-Weight Calculation By the online LDA method, a document is represented as a vector of probabil-ities over K topics. Compared with Euclidean distance measure, the Kullback Leibler (KL) divergence is more suitable for computing the distance between two documents distributions, p and q [14], which is given by: Since the KL divergence is not symmetric, we regard the average of KL ( p q ) and KL ( q p ) as KL distance(KLD) in the rest of the paper.

Taking KL distance as the distance measure for document-topic vectors, we choose K-means as the cluster algorithm . Since the clustering task is performed on the articles issued within a time slice, the article number is relatively small, which is usually less than one thousand. Thus, we can determine the optimal value of k (the number of clusters) by minimizing the Davies-Bouldin index[15] for k =1 , 2 ,..., issued within time slice t .

By K-Means cluster algorithm, the articles inside corpus slice D t are clustered into M clusters. Based on Equation (5), we reformulate article-weight of d i in the following way: Where, | Cluster m | represents the size of cluster m , which is equal to the number of articles inside Cluster m . 4.4 Topic-Weight The topic importance of topic i is assumed to be in direct proportion to its lexicon-based opinion intensity, and in reverse proportion to the sum of lexicon-based opinion intensity of all topics. According to this idea, for topic i , positive (8-9): Where, PS topic i and NS topic i represent positive and negative lexicon-based opin-ion of topic i , respectively. To evaluate the effectiveness of our approach, the composite index of Shanghai Stock Exchanges(SHCOMP) is chosen as the object to be predicted. In this study, SHCOMP-Trend belongs to one of the following possible cases:  X  X p: It means the SHCOMP of the next day will rise up above one percent  X  X own: It means the SHCOMP of the next day will drop down more than  X  X table: It means the fluctuation of SHCOMP will be less than one percent. The outline of our method is illustrated in Fig.1, which mainly consists of four steps.
 In the experiment,directio nal accuracy is taken as eva luation metric.For com-parison, another two groups of comparison experiments are performed:  X  Making SHCOMP-Trend prediction by classifying Event-Topic-Vectors(ETVs).  X  Making SHCOMP-Trend prediction by classifying Basic-ATOVs.
 ETVs are generated according to the fe ature representation model proposed by the study[12], where each dimension represents a major event instead of an opinion. Basic-ATOV is the aggregate topic-opinion vector generated according to Equation (3), which aggregates TOVs without considering article-weight and topic-weight. 6.1 Sentiment Lexicon A Chinese Financial Sentiment Lexicon(CFSL) is used as the sentiment lexicon for lexicon-based Article-Opinion calculation. It consists of 7409 Chinese words in total, including 631 positive words, 575 negative words, and 6203 neutral words, labeled sentiment by financial experts of SSE. 6.2 Data Setting We crawled 287,686 financial articles issued from April 1, 2009 to September 29, 2011 from SinaFinance,a famous financial website in China,based on which we generate 912 pairs of ATOVs by applying ATOV generation method. Each pair of ATOVs consists of a P-ATOV and a N-ATOV, which represent positive aggregate topic-opinion and negative aggregate topic-opinion respectively. Among 912 pairs of ATOVs, we only select 601 pairs as the input of classifier, since only 601 days are trading days during this period time.In addition, two datasets used in comparison experiments are shown in Table 2.
 6.3 Experiment Setting ATOV Generation Setting The experiment of ATOV aggregation mainly involves online LDA algorithm and k -means clustering algorithm. As to online LDA model, we employ  X  X atlab Topic Modeling Toolbox X , authored by Mark Steyvers and Tom Griffiths in our exper-iment. The models were run for 200 iterations and the last sample of the Gibbs sampler was used for evaluation. As discussed in Section IV, the number of topics, K , is set to 10 in all experiments. Following the settings in works[17], a and b are number k is determined dynamic by minimizing the Davies-Bouldin index. Classification Setting According to current literatures, many studies take Support Vector Machine(SVM) as classifier. For comparison with the prediction accuracy by using other data features, i.e., Basic-ATOV, ETV, a SVM classifier, namely LibSVM 2 is adopted in our experiments.Besides, a classifier based on multiple data domain descrip-tion(MDDD) is also adopted in the experiments, which was claimed more suit-able for multi-class classification task[16].
 For the SVM classifier, we use a linear kernel with default parameters ( C= 1). As to the MDDD classifier, the parameter  X  is set to 0 . 2accordingtothesettings of study[16]. 6.4 Result Result by ATOV Table 3 shows the directional accuracy of SHCOMP-Trend prediction obtained by classifying P-ATOV and N-ATOV in two-round experiments. From the re-sults, we can clearly find that the N-ATOV d ataset achieves higher directional accuracy than P-ATOV in both rounds. In the first round experiments, the directional accuracy of N-ATOV reaches 75.1% when we take MDDD as the validation method, the average directional accuracy of N-ATOV are 70.3% and 74.7% achieved by SVM and MDDD respect ively. This is a clear improvement over 65.2% and 69.5% when the P-ATOV dataset is used, which suggests the N-ATOV has higher predictive ability than the P-ATOV. In other words, our findings imply that negative opinions of hot topics usually have greater impact on stock market than positive ones. Besides, we can also find that all of the di-rectional accuracies achieved by MDDD are higher than the corresponding ones achieved by SVM.
 Comparison Result For comparison, the results of experiments using ETV and Basic-ATOV are shown in Table 4 and Table 5 respectiv ely. According to Table 4, the over-all directional accuracy achieved by Basi c-ATOV(i.e., Basic-P-ATOV, Basic-N-ATOV) is lower than that achieved by ATOV(i.e., P-ATOV, N-ATOV), and the best result is 62.2%, which is attained by SVM on Basic-N-ATOV. Furthermore, negative opinions(i.e.,Basic-N-ATOV) also display higher predictive ability than positive ones(i.e., Basic-P-ATOV) according to Table 4.
 In Table 5, the average directional a ccuracies achieved by SVM and MDDD on ETV are 59.4% and 60.8% respectively, which are very close to the result claimed by the study[14].From Fig.2, the differe nce between the directional accuracies obtained by Basic-ATOV and ETV is indi stinct. Thus, we can hardly conclude that opinion-based information(i.e., ATOV, Basic-ATOV) has higher predictive ability than event-based information(i.e., ETV), which was claimed by Wong et al.[4].However, both types of ATOV outperform Basic-ATOV and ETV in predicting SHCOMP-Trend.
 In this study, we have explored a new way of predicting stock trend according to the overall opinions on hot topics discussed in web financial corpus. To achieve this goal, a weighted topic-opinion aggregation method is first proposed, by which the aggregative topic-opinion vector(ATOV) can be generated according to article weight and topic weight. By classifying such ATOVs, the stock market movement trend can be predicted with h igh accuracies. To prove the effective-ness of this method, several groups of experiments on real world data have been carried out, among which the highest di rectional accuracy of SHCOMP-Trend prediction is up to 75.1%. Furthermore, based on the outcomes of comparison experiments, the ATOV gains a notable advantage over Basic-ATOV and ETV, which are the aggregative opinion generated by a basic integration method and the event-based informatio n extracted by the topic model respectively. In addi-tion, the negative aggregative topic-opinions are found to have higher predictive to relatively large variations of predict ion accuracy. Consequently, how to select a suitable classifier according to the type of specific prediction task, i.e., binary classification, multiple classification, becomes one issue of our future works. Acknowledgment. The research was supported by the National Science Foun-dation Project of China under Grant .No.61170096 and Natio nal Science and Technology Support Program of Ch ina under Grant. No.2012BAH13F02.

