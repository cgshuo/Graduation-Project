 1. Introduction
Environmental tests of fuel cells submitted to vibrations are realized at FCLAB laboratory. The vibrating platform ( Figs. 1 and 2 ) is associated to accelerometers to measure the system response. To precisely monitor reliability tests, a real time pre-diction of the behaviour is necessary. The fuel cell system is too complex to have a physical i.e. a mechanical model. A  X  X  X lack box X  X  modelling is thus an appropriate solution. As such systems may present a non-linear behaviour, neural networks are best suited. Neural networks are inspired by our biological nervous system. are used in a wide variety of fields such as pattern recognition, market estimates, the approximation of unknown functions and control systems ( Demuth et al., 2010 ). Due to their property of recurrence, dynamic neural netwo rks are used in applications like Tioursi (2009) the voltage of fuel cell is estimated as a function of current density. The results show that the estimated tension is achieved with good accuracy according to the different operating temperatures. Predictions on the performance of commercial 1.2 kW fuel cell developed by Ballard we re performed using two different neural architectures the BP, back propagation, and RBF, radial basis of the fuel cell using the air flow and temperature of the battery as input. The neural architecture MLP, multi-layer perceptron, is also used to predict the electrochemical behaviour of a 5 kW Nuvera fuel cell ( Chavez-Ramirez et al., 2009 ). Neural networks and genetic algorithms are used in the control of PEMFC systems that are used in hybrid vehicles with other systems such as batteries and NIH well for power management.

In mechanics,  X  X  X lack box X  X  techniques are used for modelling and controlling dynamical systems as fuel cell in different environmental conditions. The experimental protocol for a fuel cell linked to aircraft applications tested under vibrating condi-tions is presented in Rouss and Charon (2008a) . The modelling of the fuel cell system is realised using a multi input and multi output based on the artificial neural network approach ( Rouss et al., 2008b ; Rouss and Charon, 2008c ). Neural networks asso-ciated to NARX ( Bhashan et al., 2011 ) are validated with non-linear mechanical systems ( Rouss et al., 2009a ). The neural net-work method is able to model any complex system without taking into consideration the geometrical and mechanical aspects. The neural architecture developed by Rouss et al. (2009a) uses the MLP (Multilayer Perceptron) mod el, which represents temporal information by making use of the dynamics of the neurons ( N X rgaad et al., 2000 ) and it was chosen because the separate discretisation process is rendered redundant considering that a non-linear discrete model is available immediately ( N X rgaad, 2000 ).
In Rouss and Charon (2009b) is presented a study concerning the detection and the characterisation of the non-linearities linked to the behaviour of fuel cell system under vibrating conditions. A library of non-linearity signatures is created using techniques like return and recurrence plots.
 has not been presented yet. The best values of the main para-meters, like the number of hidden layers or the number of neurons in each hidden layer, are chosen by estimating different kinds of combinations between them. The optimal architecture obtained is used in a precise application and purpose. This paper presents a neural network adapted to the dynamic mechanical behaviour of fuel cell systems. The objective is to define a strategy concerning the choice of neural network architecture and parameters. The consideration of a single spring/mass/damper oscillator excited by the base was enough to explore the issue. Vibration tests are set up on the experimental platform using swept sinus and random accelerations as excitations. The information collected is used to train and validate the neural architecture. 2. The test workbench system are the main components of the test workbench. A short description of each element is given below. 2.1. The vibrating platform ones. In this experimental programme, only the horizontal capacity ofthesystemisused.Itspropertiesare: using specific software. The vibrating platform has also the capability of reproducing any kind of signals.
 this purpose a Servatin climatic chamber is available. Its char-acteristics are: vibrating conditions. 2.2. The fuel cell system conditions is a fuel cell with the following characteristics ( Table 1 ).
 positioned either on the vibrating platform, to measure and control the excitation signal, or on multiple locations of the fuel cell to obtain a diversity of responses of the system. The sensitivity of the accelerometer placed on the vibrating table is 9.92 mV/(m/s 2 ). The accelerometers fixed on the fuel cell have sensitivity equal to 10.56 mV/(m/s 2 ). 2.3. The acquisition system KUSB-3116 which can provide simultaneous analogue input, analogue output, digital I/O, and counter/timer operations. It also provides maximum flexibility: 16-bit resolution, 16 single-ended inputs, four 16-bit waveform quality analogue outputs at sam-pling rates up to 500 k Samples/s, 16 digital input lines, 16 digital output lines, and five 32-bit counter/timer channels. The KUSB-3116 is fully compliant with USB 2.0. 3. Modelling approach 3.1. The vibration tests
The aim of environmental tests is to better understand the mechanical behaviour of a fuel cell in operating conditions, such as representative vibrations for automotive applications. The tests were performed considering a random excitation for 4 h. The requirements on the vibration amplitude were expressed in terms of power spectral density (PSD) described in Table 2 . The chosen sampling frequency was at 10,000 Hz. 3.2. Theoretical approach 3.2.1. Artificial neural network
Dynamic neural networks are intensively explored into iden-tification and adaptive control of complex nonlinear systems. They can approximate any linear or non-linear mapping between the input and output of the system and they are able to learn in order to perform this approximation ( Bhashan et al., 2011 ). To remind how neural networks are functioning we consider the one-layer neural model of Fig. 3 . Each element, R , of the input vector p is connected to each neuron input through the weight matrix W . The ith neuron has a summer that gathers its weighted taken together form an S-element net input vector n . Finally, the neuron layer outputs form a column vector a . The output of the neuron, a , is then computed by the equation a  X  f  X  Wp  X  b  X  X  1  X  3.2.2. Customised neural model for the fuel cell system
The simulations realized showed that the initial values of the weights can influence the prediction made by the neural model. Usually a random function is used to generate the weights X  initial values, but this represents an instability factor and it may have a negative influence on the simulation X  X  results. To remove this disadvantage we need to develop a theoretical approach to compute the initial values of the weights. The steps of the theoretical approach are presented below. 3.2.2.1. Heuristic model. The fuel cell positioned on the vibrating platform is considered as equivalent to the mechanical system mass/ spring/ damper excited by the base ( Gilbert, 1988 ) see Fig. 4 . The chosen values leads to an eigenfrequency of 1.59 Hz.
Mathematically, it can be described as m  X  q  X  c  X  _ q _ u  X  X  k  X  q u  X  X  0  X  2  X  where m is the mass of the fuel cell, c is the viscous damping fuel cell,  X  u is the acceleration of the vibrating table, _ q is the the displacement of the fuel cell and u is the displacement of the vibrating table.

In Laplace space Eq. (2) is equivalent to q  X  s  X  X  2 x o s  X  o 2 s 2  X  2 x o s  X  o 2 u  X  s  X  X  3  X  where x is the damping ratio and o is the natural frequency of the system.

Multiplying both sides of Eq. (3) with s 2 shows that Eq. (2) is also valid when y and u represent accelerations. 3.2.2.2. Euler X  X  integration algorithm. To determine the simplest discretised form, we have to consider the integration step, h , which must be small enough to ensure stability. According to the Euler scheme, the time derivatives yield  X  q  X  _ q  X  _ u  X 
Introducing Eqs. (4), (5) and (6) into (2) one obtains m y  X  n  X  1  X  2 y  X  n  X  X  y  X  n 1  X   X  c or, after rearrangement q  X  n  X  1  X  X  q  X  n  X  2  X  1  X  x o h  X  which is the expression of the prediction of the system response.
By shifting the series regarding the solicitation of the system, past concerning the excitation q  X  n  X  1  X  X  q  X  n  X  2  X  1  X  x o h  X  Eq. (9) mandatory for the identification because this avoids a linear dependence between coefficients. An output layer is conserved for future evolution taking account of nonlinear behaviours. the natural frequencies and give an estimation of the modal damping. Hence, initial values can be estimated.
 often suggested in the initialisation of neural network identifica-tion process, precise initial values guaranty here the best con-vergence and the best performance of predictions.
 time ( n  X  1) previous knowledge about the system is needed, real time, no delay on predicted values are used but values from the acquisition. This allows a correction at each acquisition time. hidden layer contains only one neuron and the weight identifica-tion takes only a few seconds. But the simulations showed that the sampling frequency level has an important influence on the precision of the results. Translated into vibrational test require-ments concerning fuel cell stacks, a sampling frequency of 1,00,000 Hz would be necessary.
 implement another neural network architecture that allows a sampling frequency of 10,000 Hz. 3.2.2.3. Matrix transition integration algorithm. This new archi-tecture is based on the solution of a linear system with constant coefficient described with the state representation. Defining A , B and C as constant matrices, the evolution and the output (11) equations yield respectively _ x  X  t  X  X  Ax  X  t  X  X  Bu  X  t  X  X  10  X  y  X  t  X  X  Cx  X  t  X  X  11  X  where x , u and y are the state vector, the input and the output, respectively.
 (10) involves the transition matrix e Ah x  X  n  X  1  X  X  e Ah x  X  n  X  X  A 1  X  e Ah I  X  Bu  X  n  X  X  12  X  output equations yields x  X  n  X  1  X  X  Ax  X  n  X  X  bu  X  n  X  X  13  X  Y  X  n  X  1  X  X  Cx  X  n  X  1  X  X  14  X  excited from the base ( Lalanne, 1999 ; Del Pedro and Pahud, 1992 ), Eq. (2) can still be written as m  X   X  q  X  u  X  X  c  X  _ q _ u  X  X  k  X  q u  X  X  m  X  u  X  15  X  y  X   X  q  X  16  X  equations corresponding to (10) and (11) become "# y  X  2 x o _ q o 2 q  X  18  X  Eqs. (13) and (14) are
A  X  e Ah ; A  X  2 x o o 2
C  X  2 x o o 2 which are normed in the interval [ 1,  X  1] and thus we define Y  X  c y y and U  X  c u  X  u  X  21  X  x  X  n  X  1  X  X  Ax  X  n  X  X  b = c u U  X  n  X  X  22  X  Y  X  n  X  1  X  X  C = c y x  X  n  X  1  X  X  23  X  network. As clearly shown by Eqs. (17) and (18) , these coefficients are not independent. This is a problem for the identification process. The following variable change can solve it x  X  n  X  1  X  X  R ~ x  X  n  X  1  X  X  24  X 
Introducing (24) into Eqs. (22) and (23) gives ~ x  X  n  X  1  X  X  R 1 AR ~ x  X  n  X  X  R 1 b = c u U  X  n  X  X  25  X  Y  X  n  X  1  X  X  C = c y R ~ x  X  n  X  1  X  X  26  X  The matrix R can be chosen such as C/c y R  X  [11]. This gives R  X  c y
The system equations finally yield ~ x  X  n  X  1  X  X  ~ x  X  n  X  X  ~ bU  X  n  X  X  28  X  Y  X  n  X  1  X  X  X  11 ~ x  X  n  X  1  X  X  29  X 
With ~ A  X  R 1 AR ~ b  X  R 1 b = c u  X  30  X  The resulting neural network architecture is presented in Fig. 5 . The model uses the information concerning the solicitation U ( t )of the system, and includes a local recurrence. The model still have only one hidden layer but with two neurons. With this architecture a very good approximation of the mechanical behaviour is obtained using an acquisition frequency which is about the 10th of the acquisition frequency necessary with the Euler scheme, hence compatible with the characteristics of the equipment.
The neural network of Fig. 6 can be used for simulation, and for weight identification; the initial values of the weights are given to 1 as for the Euler algorithm.

But as far as real time is concerned this scheme is not complete because of unresolved modelling errors and perturbations. An increasing divergence between simulation and measured values has to be expected. A corrector is thus necessary. The theory of the optimal filtering helps to give an answer to this problem. Fig. 7 gives the principle.

The mechanical system (the fuel cell stack) is mechanically loaded with the force w ( t ) supposed to be random and approxi-mated by a white noise of known covariance W . The measurement of the sensors (accelerometers) fixed on the mechanical system supposed to be a white noise of known covariance V .Theobserver is a reduced model of the mechanical system (neural network) to be integrated in real time and corrected by the difference between the predicted value of the measurement and the actual measure-is determined using information items included in the linear quadratic Gaussian (LQG) theory ( M X  X aad, 2000 ; Samson, 1983 ). not necessary a measured variable.

Coming back to the mechanical system of Fig. 4 , the state evolution is given by Eq. (17) and Eq. (18) defines the output, i.e. the estimation of the measured acceleration.

The sensor and observer equations are given by Eqs. (32) and (31) z  X  11 ~ x  X  v  X  t  X  X  M ~ x  X  v  X  t  X  X  31  X  _ x  X  ~ A ~ x  X  ~ bU  X  F  X  z M ~ x  X  X  32  X  where ~ A is the state matrix given by Eq. (30) .

Since we can suppose that the most important error comes from the uncertainty on the shaker excitation, the matrix D is the same as the matrix B already given by Eq. (17) D  X  The matrix F is computed as below
The covariance of the difference between actual and predicted ~ X with ~ d  X  R 1 d = c u and d  X  A 1  X  e Ah I  X  D F  X  ~ X 11 M T V 1  X  35  X  corresponding neural network architecture is presented in Fig. 8 . tom neural network defined by Eqs. (31) and (32) and presented in Fig. 8 consists of 4. Numerical results and discussions and 11 a and b refer to the mass/spring/damper system and the
Euler scheme. Swept sine signals linearly varying with time from 0.1 Hz to 6 Hz are used as inputs. Fig. 7 zooms on the input and output acceleration signals over time, generated by simulation.
The excitation has a magnitude of 1 g or 10 m/s 2 . Let take this figure for comparison with prediction errors. 4.1. Euler scheme  X  global recurrence outputs with the architecture of Fig. 5 a (Euler scheme  X  global recurrence) associated to two integration steps: 0.01 s ( Fig. 10 a) and 0.001 s ( Fig. 10 b). In the first case the error reaches 0.4 g (compared to the response magnitude of 1 g) but in the second case the error is smaller than 0.1 g. As a first conclusion, a very small integration step is mandatory.
 4.2. Transition matrix scheme  X  local recurrence
Fig. 11 shows the difference between actual and predicted outputs with the architecture of Fig. 6 (transition matrix scheme  X  local recurrence) and both integration steps. Now the error is obviously tiny: 10 6 g for the integration step of 0.01 s and 10 for 0.001 s. An integration step of 0.01 s is enough. Translated into vibrational test requirements concerning fuel cell stacks, it corre-sponds to a sampling frequency of 10,000 Hz which is realistic.
In order to validate this neural network with 0.01 s integration step, the response to a random signal was generated by simula-tion ( Fig. 12 ) and compared to the results of the neural network prediction. Concerning the network with transition matrix scheme, the error was less than 0.01 g (about 0.1%). The conclu-sions concerning the errors are therefore unchanged. 4.3. Fuel cell
The transition matrix neural network was validated using signals measured on the fuel cell of Fig. 2 . Fig. 13 a shows the input and the output signals while Fig. 13 b shows the difference between the measured signal and the neural network predicted: the error is smaller than 0.2 g compared to the 1 g response. This can be explained by the presence of the electrical and environ-mental noise and, the case occurs, the presence of the nonlinea-rities, not yet taken into account. 5. Conclusion and future work
The objective of this paper was to present a step by step method creating a neural network architecture adapted for monitoring vibrational tests on fuel cell systems. This method is obviously interesting for creating black box models of any dynamic mechan-ical systems. The start point was a simple oscillator dynamically loaded at the base which approximately corresponds to the fuel cell system under vibrating conditions.

The weight identification of the neural networks showed that their initial values are an influent factor on the neural network validity. Random initial weights are not adapted and the method showed how to define the initial weights from some knowledge on mechanical properties obtained from a simple swept sinus test.

The first architecture using the Euler integration scheme shows a very fast convergence and rather good predictions. It also uses the past information of the system response which is adapted to the model correction in real time. Unfortunately it needs a far too small integration step not adapted to the acquisi-tion process. This architecture was therefore rejected.
The second architecture base on transition matrix integration scheme needs a smaller integration step adapted the acquisition process. The network is only a little bit more complex. But it presents a disadvantage the recurrence needed to simulate dynamic system is intern and not based on the measured values. The basic architecture is not adapted for monitoring since no correction is possible. A new input is added to this neural architecture which corresponds to the difference between the predicted output and the measured output. The Linear Quadratic Gaussian theory is implemented to create an observer of the system permitting a correction in real time.

To validate the architectures, simulated signals without noise and signals measured during the vibration tests were used. The error with measured signals is of course larger due to electrical and environmental noise and, the case occurs, because of the nonlinearities that can appear at different levels of frequencies during the endurance tests. The implementation of the neural architecture in real time and the adaptation of the retained neural network to fuel cell nonlinearities are the next steps of our work. References
