 1. Introduction
Over the last few decades, visual image quality has been actively improved using contrast enhancement techniques, which are increasingly necessary for the design of digital multimedia systems, such as video surveillance systems ( Havasi et al., 2007 ; Eng et al., 2008 ), digital photography ( Oakley and Bu, 2007 ; Fattal, 2008 ), medical imaging systems ( Chen et al., 2005 ; Yang et al., 2009 ), and low power systems ( Lai and Tsai, 2008 ). Moreover, contrast enhancement has become widely available to provide a  X  X  X etter X  X  transform representation for real image processing systems with both software and hardware environments, including Photoshop ( Chen et al., 2006a ), mobile devices, digital TV, and digital cameras
In recent years, contrast enhancement techniques have been used in many digital multimedia systems, such as for object tracking in video surveillance systems ( Chen et al., 2008 ), radio-graphy applications ( Dippel et al., 2002 ), arterial visualization of medical imaging ( Bemmel et al., 2003 ), tumor microcirculation ( Koh et al., 2003 ), virtual restoration of ancient Chinese paintings recovery of underwater visibility ( Schechner and Karpel, 2005 ), bas-relief generation ( Sun et al., 2009 ), and face recognition ( Xie and Lam, 2005 ). Therefore, the aim of this study is to develop a high-performance contrast enhancement method that fits the current requirements ( Perner et al., 1999 ; Shin et al., 1992 ; Zhang et al., 2010 ).

Contrast enhancement methods can be broadly categorized into two major classes: direct and indirect methods ( Arici et al., 2009 ). Direct methods ( Beghdadi and Negrate, 1989 ; Cheng and Xu, 2000 ) try to improve image using the definition of a contrast measure. Indirect methods ( Sherrier and Johnson, 1987 ; Polesel et al., 2000 ) exploit the under-utilized dynamic range of the images to improve contrast without a contrast measurement. Almost all the most popular contrast enhancement methods in the literature fall into the second category ( Arici et al., 2009 ). Furthermore, the indirect methods can be divided into two sub-classes: histogram modification techniques (i.e., spatial domain techniques) and transform domain techniques ( Arici et al., 2009 ; Hanmandlu and Jha, 2006 ). In particular, histogram modification techniques have attracted significant attention from researchers due to their simplicity and computational efficiency.
Generally speaking, histogram modification techniques can be categorized into two main types, global histogram modification and local histogram modification ( Kim et al., 2001 ; Lamberti et al., 2006 ). Global histogram modification techniques attempt to modify the spatial histogram of an image in order to closely match a uniform distribution via the transform function. This is generated by using the histogram information of the entire input image ( Abdullah-Al-Wadud et al., 2007 ). However, global histogram modification technique cannot adapt to local brightness features. This causes limitations in the amount of contrast enhancement in some parts of the image ( Chen et al., 2006a ; Abdullah-Al-Wadud et al., 2007 ).

A direct extension of global histogram modification is termed local histogram modification. In order to efficiently improve the visibility of the small-scale detail, local histogram modification techniques independently equalize each sub-histogram on the basis of histogram separation ( Chen et al., 2006b ). However, local histogram modification techniques sometimes cause over-enhancement and noise-enhancing artifacts in some portion of an image ( Abdullah-Al-Wadud et al., 2007 ).

A good contrast enhancement technique should specifically address several significant properties, some of which are listed below. (1) Noise tolerance: The contrast enhancement technique should exhibit appropriate noise immunity. (2) Uniform contrast: The contrast enhancement technique should provide uniform contrast of the entire image. (3) Brightness preservation: The contrast enhancement techni-que should enhance the contrast of the image without losing brightness. (4) Convenient implementation: The contrast enhancement tech-nique should be able to be set up quickly and reliably.
In this paper, a novel contrast enhancement method is pre-sented to enhance the contrast of an image without losing the original histogram characteristics. It is expected to eliminate the abovementioned drawbacks of the conventional global-based and local-based histogram modification methods effectively.
The proposed method can be briefly described as follows: 1. Separation of a histogram with the proposed multiple thresh-olding procedure by using a prompt mean function and standard deviation. 2. Achievement of contrast enhancement by equalizing sub-histograms in small-scale detail.

Experimental results show that the proposed method gives more accurate results than other state-of-the-art methods in the case of a wide range of natural digital images. The performance of the proposed method will be demonstrated through qualitative and quantitative evaluations.

The rest of this paper is divided into Sections 2 X 5 .In Section 2 , we present a relatively compact overview of the popular histo-gram modification methods. Section 3 describes the proposed contrast enhancement method in detail. Section 4 presents a comparison of the experimental results of the proposed method and some of the other existing methods. Our concluding remarks are presented in Section 5 . 2. Related work
Known as one of the most popular contrast enhancement techniques, histogram equalization (HE) can efficiently perform contrast enhancement because of its simplicity and effectiveness.
The basic idea of the HE method is to re-map the gray levels of an input image using a transformation function with the cumulative distribution of the input image. HE attends to and stretches the dynamic range of the image histogram to improve the overall contrast of the original image. However, the HE method is unsuitable for consumer electronic applications because the calculated transformation function may significantly change the brightness of the original input image.

To overcome this problem, several researchers have studied the preservation of image brightness in HE-based enhancement methods. In 1997, brightness preserving bi-histogram equaliza-tion (BBHE) ( Kim, 1997 ) was proposed for separating an image histogram into two sub-histograms with the mean of the gray-level for the input image before equalizing them independently.
Later, Wang et al. (1999) proposed dualistic sub-image histogram equalization (DSIHE) for separating a histogram on the basis of the median instead of the mean of the gray levels. Sim et al. (2007) proposed recursive sub-image histogram equalization (RSIHE) by extending DSIHE ( Wang et al., 1999 ). In RSIHE ( Sim et al., 2007 ), the median-based histogram separation is applied several times to obtain the local median values, whereas DSIHE ( Wang et al., 1999 ) performs the separation only once.
Although the HE method can attain a significant improvement in image contrast, the equalized image may distort the mean brightness of the input image ( Kim, 1997 ). Because the BBHE ( Kim, 1997 ) method only performs the local histogram equaliza-tion with one separation, the enhanced image may contain an extreme over-enhancement and noise artifacts. Further, because the DSIHE method ( Wang et al., 1999 ) is similar to the BBHE method ( Kim, 1997 ) with respect to a single histogram separa-tion, an image enhanced using DSIHE may contain an extreme over-enhancement and noise artifacts. Although the RSIHE method ( Sim et al., 2007 ) is better than the traditional HE, BBHE ( Kim, 1997 ), and DSIHE ( Wang et al., 1999 ) methods, some serious over-enhancement and noise artifacts still exist in the enhanced image because of the number of sub-histograms gen-erated experimentally using the calculated local median values.
As mentioned before, the number of sub-images and its corre-sponding calculation of threshold determination necessitate the development of an effective histogram equalization algorithm. 3. Proposed method
In this section, we propose a novel contrast enhancement method, which involves two important modules: a histogram separation module and an intensity transformation module. First, the proposed histogram separation module is a combination of the proposed prompt multiple thresholding procedure and an optimum PSNR calculation to separate the histogram in small-scale detail. As the final step of the proposed process, the use of the intensity transformation module can enhance the image with complete brightness preservation for each generated sub-histogram. 3.1. Histogram separation Each M N discrete input image I xy can be defined as an M -by-
N matrix, where xy denotes an arbitrary pixel in the spatial domain. The matrix of the original image I xy is expressed as follows:
I  X  2 6 6 6 6 4 (1) Prompt multiple threshold selection: Suppose that an input image I is composed of G discrete intensity levels; thus, the statistical histogram H of an input image I is expressed as follows: H  X  h  X  X  n h where h  X  0 , 1 , 2 , ... , G 1 :  X  2  X 
Note that n h represents the number of pixels that correspond to the intensity h of the input image I . Based on the statistical histogram H of the input image I , the mean value m can be calculated using the following mean function:  X 
After the mean value m is calculated, the standard deviation function s is expressed as follows:  X 
Notice that  X  a , b represents the interval of calculation, which is initialized as  X  0 , 255 . According to the calculated mean value and standard deviation, three threshold values, m s , m , and m  X  s , can be defined to further separate the histogram. (2) Optimum recursion level: For each recursion level, the low boundary is set to m s and the high boundary b is set to m  X  s .
According to the new calculated interval  X  a , b , mean function, and standard deviation, the two new threshold values m s and m  X  s are calculated as an addition to the thresholds, and then, the existing threshold is replaced with m when it is closest to the new mean value.

In order to accurately decide the appropriate number of sub-images, we calculate the peak signal-to-noise ratio ( PSNR )( Arora et al., 2008 ) at each recursion level. The PSNR is defined as follows:
PSNR  X  20 log 10 255 RMSE ,  X  5  X  where RMSE is the root-mean-square error, defined as RMSE  X  1 MN
Here, I and ^ I are the original and enhanced images of size M N , respectively. Note that a higher PSNR value represents a better image quality. According to Arora et al. (2008) , the optimum recursion level can be determined when the increasable PSNR is lower than a particular value of 0.1, which tends to saturate the sub-histograms generation by separating the image histogram. 3.2. Intensity transformation
Based on the histogram separation, the optimum number t of sub-images can be expressed as follows: I  X f I xy 9 S k r I xy o S k  X  1 , 8 I xy A I g ,  X  7  X  where k  X  0 , 1 , 2 , ... , t 1, and I t xy represents each sub-image. (1) Probability density function and cumulative distribution function: For each sub-image I k , the probability density function ( pdf ) is expressed as follows: pdf k  X  h  X  X  n h P n where h  X  S k  X  1 , S k  X  2 , ... , S k  X  1 . Notice that pdf with the histogram of the k -th sub-image to represent the frequency of a specific input intensity h . Then, the cumulative distribution function ( cdf ) is expressed as follows: cdf k  X  h  X  X  X h (2) Transformation mapping function: Finally, the transformation mapping function is used for enhancing the original image. This is characterized by utilizing the cdf k of sub-image I k for k segments. Then, the transformation mapping function is defined as follows: T  X  h  X  X  S k  X  X  S k  X  1 S k  X  cdf k  X  h  X  ,  X  10  X  where k  X  0 , 1 , ... , t 1and h  X  S k  X  1 , S k  X  2 , ... , S
The flowchart of the proposed approach involves an automatic histogram separation module and an intensity transformation module for achieving our objective of contrast enhancement, as shown in Fig. 1 . As shown in the top-left of Fig. 1 , the original image has insufficient contrast between the human face and the background. In order to enhance the contrast along with complete brightness preservation, the automatic histogram separation module separates the original histogram into small-scale detail. Each separated sub-histogram region is shown in the top-right of
Fig. 1 . Based on the separated sub-histograms, the piecewise transformation function illustrates the hybrid mapping curve shown in the bottom-right of Fig. 1 . The solid line represents the mapping curve of the proposed method, and the dotted line represents the mapping curve of traditional HE. As can be seen, the proposed method has a smoother curve than the traditional
HE. Notice that the x -coordinates represent the original intensity of the input image, and the y -coordinates denote the enhanced intensity after the contrast enhancement is achieved. As a result, the enhanced image mapped by using the proposed smooth mapping curve produces a relatively perceivable contrast between human hair, face, and the background, as shown in the bottom-left of Fig. 1 . 4. Experimental results
For a robust visual quality of contrast enhancement, some specific properties are extremely desirable in an effective contrast enhancement method. These are the noise tolerance ability, brightness preservation of uniform contrast enhancement, and convenient implementation. In order to demonstrate the advan-tages of the proposed method for the necessary specific proper-ties, this section presents a comparison of the proposed method with some of the aforementioned existing methods. Experimental results are produced using a variety of original images in three evaluations: 1. Qualitative evaluation of enhancement results is carried out using each method. 2. Quantitative evaluation for all test images is carried out on the basis of two well-known metrics. 3. Time complexity is evaluated for each contrast enhancement method. 4.1. Qualitative evaluation
Fig. 2 shows the original  X  X  X irl X  X  image ( Fig. 2 (a)) and the corres-ponding contrast-enhanced versions (Fig. 2 (b X  X )). Fig. 2 (b) shows the traditional histogram equalized image of the original  X  X  X irl X  X  image. An extreme contrast of the image can be observed between the background and the human hair, body, and face.
BBHE ( Kim, 1997 ), DSIHE ( Wang et al., 1999 ), and RSIHE ( Sim et al., 2007 ) use the local histogram information to reduce the extreme effect of HE. However, their histogram-equalized images still have some aspects of the HE result: the hair and clothing are relatively dark; the bright face is relatively bright; and the background region is involved with the amplified noise. This situation can be easily observed in the images of Fig. 2 (c X  X ). Fig. 2 (f) shows the enhancement result of the proposed method.
With complete brightness preservation, the proposed method gives a relatively natural brightness improvement on the hair and face of the circled region. 4.2. Quantitative evaluation
In addition to the qualitative evaluation, accuracy measure-ment is necessary for a further comparison between the proposed method and other state-of-the-art methods, on the basis of absolute mean brightness error ( AMBE )( Kim and Chung, 2008 ) instead of PSNR ( Arora et al., 2008 ). The performance of brightness preservation is rated using an objective measurement referred to as AMBE , which is defined as the absolute differential gray-level mean between the original image and the enhanced image: AMBE  X  9 I e ^ I e 9 :  X  11  X 
I and ^ I e denote the gray-level mean of the original and the enhanced image, respectively. Note that a lower AMBE value indicates better brightness preservation.

Table 1 lists the PSNR values of the enhancement results obtained using each method for 15 test images. Because the proposed method enhances the image by equalizing the optimum sub-histograms in small-scale detail, the enhanced images obtained using the proposed method produce neither noise arti-facts nor over-enhancement to achieve the highest PSNR values.
Table 2 lists the AMBE values of the enhancement results obtained using each method for 15 test images. The proposed method can preserve the complete mean brightness, which is achieved by enhancing the image with the optimum sub-histogram equalization. Therefore, the proposed method effec-tively achieves the lowest AMBE values among all. 4.3. Time complexity
Based on the Bachmann X  X andau notation, the time complex-ities of the HE, BBHE ( Kim, 1997 ), DSIHE ( Wang et al., 1999 ),
RSIHE ( Sim et al., 2007 ), and the proposed methods are analyzed for the image size M N . In the case of the traditional HE method, the computation of the histogram requires O ( MN ) time. Calculat-ing the mapping function from the histogram requires O ( L ) time, where L denotes the discrete level of the input image. Finally, the enhanced image is obtained using the mapping function in O ( MN ) time. Hence, the total time complexity of the traditional HE method is O  X  2 MN  X  L  X  .

In the case of the BBHE ( Kim, 1997 ) method, the computation of the histogram requires O ( MN ) time. The computation of the mean value requires O ( L ) time, where L denotes the discrete level of the input image. Calculating the mapping function from the histogram requires O ( L ) time. Finally, the enhanced image is obtained using the mapping function in O ( MN ) time. Hence, the total time complexity of the traditional BBHE ( Kim, 1997 ) method is O  X  2 MN  X  2 L  X  .

In the case of the DSIHE ( Wang et al., 1999 ) method, the computation of the histogram requires O ( MN ) time. The compu-tation of the median value requires O ( L ) time, where L denotes the discrete level of the input image. Calculating the mapping func-tion from the histogram requires O ( L ) time. Finally, the enhanced image is obtained using the mapping function in O ( MN ) time. Hence, the total time complexity of the traditional DSIHE ( Wang et al., 1999 ) method is O  X  2 MN  X  2 L  X  .

In the case of RSIHE ( Sim et al., 2007 ) method, the computa-tion of the histogram requires O ( MN ) time. The computation of all the sub-median values requires O ( L ) time, where L denotes the discrete level of the input image. Calculating the mapping func-tion from the histogram requires O ( L ) time. Finally, the enhanced image is obtained using the mapping function in O ( MN ) time. Hence, the total time complexity of the RSIHE ( Sim et al., 2007 ) method is O  X  2 MN  X  2 L  X  .

In the case of the proposed method, the computation of the histogram requires O ( MN ) time. Separating the histogram by using mean and standard deviation requires O ( L ) time, where L denotes the discrete level of the input image. The calculation of the optimum recursive level requires O ( L ) time. Calculating the mapping function from the histogram requires O ( L ) time. Finally, the enhanced image is obtained using the mapping function in O ( MN ) time. Hence, the total time complexity of the proposed method is O  X  2 MN  X  3 L  X  .

Because the image size M N is considerably greater than L , the time complexity of each method is rounded off to O ( MN ). As a result, the proposed method and other state-of-the-art methods are easy to implement for real-time applications. 5. Conclusion
In this paper, we presented a novel histogram equalization method for enhancing the contrast of an image. First, the original histogram was separated into several sub-histograms automati-cally by using the proposed histogram separation module. The generated sub-histograms were then equalized by the inten-sity transformation module to achieve an accurate contrast enhancement. Experimental results revealed that the proposed method generated very high-quality enhancement images, as demonstrated using a qualitative visual inspection and quantita-tive PSNR and AMBE evaluations, as compared to the other state-of-the-art methods.
 Acknowledgments
The authors would like to thank the National Science Council of the Republic of China, Taiwan, for financially supporting this research under Contract no. NSC 100-2628-E-027-012-MY3. References
