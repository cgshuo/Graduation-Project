 ORIGINAL PAPER A. Papandreou  X  B. Gatos  X  S. J. Perantonis  X  I. Gerardis Abstract Document skew is often introduced during the capturing process of the document image processing pipeline and may seriously affect the performance of subsequent stages of segmentation and recognition. Skew detection is often accomplished with the use of horizontal projections, while recently, a new approach that is based on vertical pro-jections has been introduced. In this paper, we use the tech-nique of minimum bounding box area in order to combine a horizontal with a new reinforced vertical projection profile method. We are motivated by the fact that the horizontal and the novel vertical projection profiles are found to be comple-mentary to each other. We claim that the proposed approach has more accurate performance compared with other state-of-the-art skew detection algorithms; it deals with all the drawbacks of the projection profile methods; it is more noise and warp resistant and gives accurate results for any kind of printed document image. For these reasons, it can be effi-ciently applied to historical machine printed or multicolumn documents, documents with figures and tables, while it is robust for any kind of script. Extended experimental results on two databases in different skew angle range, with repre-sentative printed documents of all kinds, as well as printed documents of two historical books, prove the efficiency of the proposed approach. There is also a comparison with com-mercial products in several cases where the contribution of the proposed algorithm is demonstrated at optical character recognition level. Moreover, an analysis of the accuracy per-formance of the main elements of the proposed technique is also performed.
 Keywords Document skew correction  X  Projection profiles  X  Document image preprocessing 1 Introduction In order to proceed with optical character recognition (OCR), document image preprocessing is always essential as a start-ing step. The task of preprocessing mainly includes the removal of noise as well as image normalization in order to remove unwanted variations, while it can be divided into several steps such as binarization, skew correction, noise removal, and enhancement. In this paper, we focus on the task of skew detection in machine-printed documents.
The detection and correction of the document skew is one of the most important document image analysis steps. Some degree of skew is unavoidable to be introduced when a document is scanned manually or mechanically [ 1 ]. This may seriously affect the performance of subsequent stages of segmentation and recognition, while skew of as little as 0 . 1  X  may be apparent to a human observer. To this end, a reliable skew estimation and correction technique have to be used in scanned documents as a preprocessing stage in almost all document analysis and recognition systems [ 2 ]. Existing skew estimation algorithms mainly consider documents with plain structure. This limitation appears too restrictive with respect to the diversity of current documents. The require-ment of more and more sophisticated tools is promoted by the large diffusion of complex documents characterized by creative geometric layouts [ 3 ]. To this end, skew detection is still a challenging task especially for documents with graph-ics, charts, figures or various font sizes [ 4 ]. In the literature, a variety of skew detection techniques are available and fall broadly into the following four categories according to the basic approach they adopt [ 3 , 5 ]: Hough transform [ 6  X  10 ], nearest neighbor clustering [ 11  X  14 ], interline cross-correla-tion [ 15  X  19 ] and projection profile [ 20  X  24 ]-based methods.
Hough transform (HT) is a popular approach for machine vision. Despite its computational demerit, it has been widely employed to detect lines and curves in digital images. According to Srihari and Govindaraju [ 6 ], each black pixel is mapped to the Hough space (  X , X  ) and the skew is esti-mated as the angle in the parameter space that gives the maximum accumulation along the  X  component. In order to improve the computational efficiency of the HT-based approaches, several variants that reduce the number of points which are mapped in the Hough space have been proposed. Hinds et al. [ 7 ] fuse HT and run-length encoding in order to reduce data. They create a burst image which is built by replacing each vertical black run with its length placed in the bottom-most pixel of the run. The bin with maximum value in the Hough space determines the skew angle. Fur-thermore, Wang et al. [ 8 ] use bottom pixels of the candidate objects within a selected region for the HT. Document skew is then estimated by finding a local peak in Hough space. Yu and Jain in [ 9 ] fuse hierarchical HT and centroids of con-nected components. They first compute the connected com-ponents and their centroids, and then the HT is applied to the centroids using two angular resolutions. Finally, Singh et al. [ 10 ] introduce a block adjacency graph (BAG) in a pre-processing stage and document skew is calculated based on voting using the HT. As mentioned by the authors, the tech-nique is language dependent. Researchers proposed different strategies to reduce the amount of input data, but the com-putational cost of HT is still very high. Furthermore, prior to applying, it is requisite to extract text regions in the docu-ment images. However, this is very hard in document images since layouts may be unknown and complex.

According to nearest neighbor approaches, spatial rela-tionships and mutual distances of connected components are used to estimate the page skew. In the work of Hashizume et al. [ 11 ], the direction vector of all nearest neighbor pairs of connected components is accumulated in a histogram and the peak in the histogram gives the dominant skew. This method is generalized by O X  X orman [ 12 ] where nearest neighbor clustering uses the K-neighbors for each connected com-ponent. However it is accurate for a resolution of 0 . 5  X  and Tan [ 13 ] propose an improved nearest neighbor chain-based approach for document skew estimation with high-accuracy and language-independent capability. The meth-ods of this class aim at exploiting the general assumptions that characters in a line are aligned and close to each other. They are characterized by a bottom-up process, which starts from a set of objects and utilizes their mutual distances and spatial relationships to estimate the document skew. Okun et al. [ 14 ] propose a method that consists of spatial image-resolution reduction, connected component detection, classi-fication into different categories and text line accumulation. For the last step, a simple technique is applied, which utilizes the first eigenvector of the data covariance matrix. The line slopes are accumulated into an angle histogram, whose peak corresponds to the desired document skew. Few researchers prefer the nearest neighbor clustering techniques for docu-ment skew removal since the text lines can be grouped in any direction, and connections with noisy subparts of characters reduce the accuracy of the method. Furthermore, skew detec-tion based on nearest neighbor clustering methods is rather slow due to the component labeling phase that is performed bottom-up and has quadratic time complexity O ( n 2 ) .
The interline cross-correlation approaches are based on the assumption that de-skewed images present a homoge-neous horizontal structure. Therefore, such approaches aim at estimating the document skew by measuring vertical and horizontaldeviationsamongforegroundpixelsalongthedoc-ument image. Cross-correlation between lines at a fixed dis-tance is used by Yan [ 15 ]. This method is based on the obser-vation that the correlation between two vertical lines of a skewed document image is maximized if one line is shifted relatively to the other so that the character base line levels for the two lines are coincident. The accumulated correla-tion for many pairs of lines can provide a precise estima-tion of the page skew. In [ 16 ], Gatos et al. proposed that the image should first be smoothed by a horizontal run-length algorithm, and then, only the information existing in two or more vertical lines should be used for skew detection. Chou et al. in [ 17 ] proposed piece-wise coverings of objects by parallelograms (PCPs) for estimating the skew angle of a scanned document. A document image is initially split into a number of non-overlapping slabs and subsequently paral-lelograms at various angles cover the components in each slab. The angle at which maximum white space is obtained indicates the estimated skew angle of the document. In [ 18 ], Deya and Noushath have enhanced PCP (e-PCP) with a cri-terion to classify a document as a landscape or portrait mode, while they have introduced a confidence measure for filtering the estimated skew angles that may not be reliable. Finally, Alireza et al. [ 19 ] proposed an algorithm which applies piece-wise painting on both directions of a document and creates two painted images. Those images provide statistical infor-mation about regions with specific height and width. The points of those regions are grouped, a few lines are obtained with the use of linear regression and line drawing concepts, and their individual slopes are calculated.

The traditional projection profile approach is a simple solution to detect the skew angle of a document image. It is initially proposed by Postl [ 20 ] and is based on hor-izontal projection profiles. According to this approach, a series of horizontal projection profiles are calculated at a range of angles. The profile with maximum variation corre-sponds to the best alignment of the text lines. In order to reduce high computational cost, several variations of this basic method have been proposed. Papandreou and Gatos have proposed an improvement of the traditional horizontal projection profile approach by combining it with the mini-mization of the bounding box area technique [ 21 ]. According to this approach, the maximum variations are divided by the bounding box area that includes the text. This amount is min-imized when the document is horizontally aligned. Baird [ 22 ] proposed a technique for selecting the points to be projected: For each connected component, only the midpoint of the bottom side of the bounding box is projected. An objective function is used to compute the sum of the squares of the pro-files. Ciardiello et al. [ 23 ] calculate projections on selected subregions, with high density of black pixels per row, of the document image. The algorithm detects the skew angle by maximizing the mean square deviation of the profile. Ishitani [ 24 ]usesaprofile,whichisdefinedinadifferentstyle.Aclus-terofparallellinesontheimageisselected,andthebinsofthe profile store the number of black to white transitions along the lines. Finally, Papandreou and Gatos [ 21 ] have proposed a vertical projection profile approach, taking advantage of the alignment of vertical strokes of the Latin alphabet when the document is deskewed. This approach proved to be more noise and warp resistant.

Projection profile techniques can efficiently deal with clean text, and they are accurate in small angles, while on the other hand, they are computationally expensive, and they are limited to estimating skew angle within  X  10  X  [ 2 ]. Addition-ally, horizontal projection profile-based approaches cannot deal with noisy or warped documents, with broken charac-ters [ 2 ], and they also fail as much as multicolumn documents and documents with figures are concerned. The horizontal projection profile method is a quite accurate skew estima-tion method as much as plain text document images are con-cerned since it utilizes the alignment of letters and words in printed lines. It detects the gaps between the lines and the succeeding space when the document is properly deskewed, while the accuracy of the method depends on the width of the document image. Consequently, in multicolumn documents where the lines of different columns are not aligned, in docu-ment images with significant noise and in warped documents that do not have straight text lines, there are no gaps to be detected, and the horizontal projections (as well as the Hough transform-based methods) may fail.

On the contrary, the vertical projection profiles [ 21 ] can deal with noise, multicolumn documents and tables in a great range of angles accurately and are more robust in warped documents (see Fig. 1 ). They are based on the right, left or full alignment of a text, on the alignment of vertical strokes or the existence of vertical lines such as borders, and their accuracy dependsontheheightofthedocumentimage.Duetothisfact, they are favored concerning multicolumn documents since there is vertical alignment in every column. Furthermore, the noise does not affect the detection of the vertical black runs, which are additionally stressed with the reinforced version of the algorithm. Finally, the warped documents keep their vertical strokes in vertical direction in the correct skew angle, and they mostly maintain their right, left or full alignment of the text.

In Fig. 1 a, a typical example of a warped document is demonstrated. As shown in Fig. 1 b, the baselines of the doc-ument are not straight lines, and consequently, neither hori-zontalprojectionprofilemethodsnorHoughtransform-based methods can detect the skew of the document accurately. On the other hand, as demonstrated in Fig. 1 c, d, when the dom-inant skew is corrected, the vertical strokes of the letters are almost at 90 degrees.

As mentioned above, horizontal and vertical projection profiles are complementary to each other and can handle accurately all kinds of documents even if they consist of few lines or columns since one approach is accurate depending on the width and the other on the height of the document image. In this work, a new technique based on combined enhanced projection profiles (CEPP) is introduced, and fur-thermore, the proposed method is accelerated with a coarse-to-fine technique (CEPP c-f) for faster convergence and more profound combination of the projection profile methods. It is based on both, horizontal and vertical projection profiles while we are motivated by their complementarity. The mini-mization of the bounding box area is introduced as an appro-priate criterion for combining these different kinds of profile. The efficiency of the minimum bounding box area criterion, in order to select between horizontal and vertical profiles, as well as the fact that the reinforced vertical projection pro-files and the enhanced horizontal profiles are complemen-tary, are proved through exhaustive testing. We also claim that the proposed approach is more accurate compared with state-of-the-art skew detection algorithms. Classical projec-tion profile methods are obsolete due to their restrictions and the disadvantages listed above. Nevertheless, despite the fact that the proposed method falls broadly in the same category, it deals with all the drawbacks of the projection profile meth-ods due to the complementarity of vertical and horizontal profiles. Furthermore, the proposed technique is noise and warp resistant, and it gives more accurate results in any kind of printed document image; it is not constrained by any range of angles, and it is fast due to the proposed coarse-to-fine con-vergence. For these reasons, it can be efficiently applied to historical machine printed or multicolumn documents, doc-uments with figures and tables, while it is robust in any kind of script and in a wide range of angles.

The proposed technique is an extension of our previ-ous work on skew detection in printed documents [ 21 ]. The advancement compared with [ 21 ] is summarized in the fol-lowing points: (1) introduction of an innovative criterion which can operate as a skew estimation technique selector. The minimization of the bounding box area proved to be an effective algorithm selector, which can combine two or more different skew estimation techniques. (2) In the proposed method, the vertical projection profiles are reinforced, stress-ing the existence of black runs, instead of those described in Papandreou and Gatos [ 21 ]. (3) In Papandreou and Gatos [ 21 ], the maximization of an energy function was used in ordertodeterminetheminimumentropycorrespondingtothe correct skew angle. On the contrary, in the proposed method, the difference between three successive values of each his-togram is computed to determine the correct skew angle. Finally, (4) in the proposed method, a coarse-to-fine algo-rithm is introduced in order to accelerate the convergence of the algorithm. The proposed combination of horizontal and verticalprojectionprofilesismorerobustconcerningthevari-ations of the document layout and the range of skew angles detectedthanthemethodsdescribedinPapandreouandGatos [ 21 ]; a fact that is demonstrated through the extended exper-imental results and the diversity of the datasets used.
The remainder of the paper is organized as follows. Sec-tion 2 focuses on the proposed methodology and it provides a detailed analysis of the steps involved. Extensive experimen-tal results, in multiple datasets and various angles, indicat-ing the accuracy performance of the proposed methodology compared with other state-of-the-art methods are presented and discussed in Sect. 3 , while conclusions are drawn and remarks are made in Sect. 4 . 2 Proposed methodology In the proposed CEPP methodology, we combine novel rein-forced vertical and enhanced horizontal projection profiles with the use of the minimum bounding box area criterion in order to achieve an accurate and robust document skew detection. The estimation of the foreground area bounding box is commonly used in the literature as a skew estimation technique, since the area of the rectangle that contains all the foreground pixels of a document image is expected to be minimum when the document image is properly deskewed [ 1 , 25 ]. Papandreou and Gatos have recently combined it with the classical projection profile technique in order to achieve an improved estimation [ 21 ]. In the CEPP approach, we also use it as a criterion, in order to determine which of the two projection profile algorithms (horizontal or vertical), oper-ates better in each case. As demonstrated in the experimental results (Sect. 3.2.5), the bounding box method can perform well in plain text document images but it has low accuracy in documents with complex layout due to the outliers (compo-nents that are beyond the main rectangular body of the page). This is why in the proposed work the minimum bounding box area is not used to estimate directly the skew angle but is used mainly as a selection criterion. The main contribu-tion of the bounding box algorithm is the selection between the results of two much more accurate algorithms. More-over, in our approach, horizontal and vertical histograms are divided by the bounding box area (as in Papandreou and Gatos [ 21 ]) in order to normalize the result better. At the correct skew angle there is a great accumulation of fore-ground pixels in certain lines and columns. Since this may also occur for near diagonal angles where information may be accumulated, we use the division by the bounding box area which, in this case, is larger and thus capable of making a distinction between the correct skew and the near diagonal angle.

In order to estimate the skew, the document image is rotated by a range of angles  X   X  X   X  min , X  max ] .Let I  X  be the binary document image in angle  X  having 1s for black (foreground) pixels and 0s for white (background) pixels and I and I  X  y be the width and the height of the rotated document image (see Fig. 2 ).

The proposed skew estimation methodology consists of three steps demonstrated in the flowchart in Fig. 3 . At a first step, the document image is rotated by a range of angles and the rectangle box that bounds the foreground pixels is com-puted. Then, two of histograms, a reinforced vertical and an enhanced horizontal, are calculated for every angle. Finally, these histograms are analyzed providing two candidate skew angles, one of which is selected with respect to the minimum bounding box area criterion. 2.1 Computation of the bounding box In order to compute the minimum rectangle area E  X  that bounds the foreground pixels for each angle  X  , we calculate following equations: x y x y E For each angle  X  , after we have calculated the extreme points of the image, we calculate a pair of histograms within these boundaries, the reinforced vertical H  X  v () and the horizontal H 2.2 Reinforced vertical projection profile In order to calculate the reinforced vertical histogram H we first compute an initial histogram v H  X  () for each angle in which we focus on the vertical black runs of the document imageandstresstheexistenceoflongverticalstrokesorlines. Those vertical black runs are expected to have significant contribution in the vertical profile, to be in larger number and to have greater values when the document is properly deskewed. The vertical black run profile v H  X  () is defined as follows: v H  X  ( x ) = where B ( x ) is the number of black runs in the vertical scan of line x , L ( i , x ) is the length of the i th black run of line x and br ( j ) is defined as follows: br ( j ) = j
The parameter br ( j ) is restricted and cannot take values thatexceed4sothatstraightlineswillnotdeterminetheresult in an absolute but in a dominant way. Although the value 4 is determined experimentally, it is observed that setting values &gt; 4 does not have significant impact on the skew detection performance. A comparison between the classical and the reinforced ( v H  X  () ) vertical projection profiles calculation is exhibited, respectively, in Fig. 5 a, b, while in Fig. 5 there is also an example of the reinforced vertical histogram when the document image is properly aligned (Fig. 5 c) and when it has skew (Fig. 5 d).
 At a next step, we divide the values of v H  X  () by the area E  X  of the box that bounds the foreground pixels in order to calculate H  X  v () : H v ( x ) = v H As explained in Papandreou and Gatos [ 21 ], when the doc-ument image is properly deskewed, the area of the bound-ing box E  X  is expected to be minimum (see Fig. 4 ) and the concentration of foreground pixels will be higher in certain columns of the image. So, by dividing these high values of the histogram by the low values of the area of the bounding box, the algorithm is facilitated to distinguish the correct skew angle from the rest of the angles where the concentration of the foreground pixels is lower and the area of the bounding box is bigger. Despite the fact that the bounding box mini-mization criterion may have low accuracy in documents with complex layout due to outliers, the division by the bounding box area is capable of distinguishing between big accumula-tions of foreground pixels in the histograms due to the align-ment in the correct skew angle and accumulations in the near diagonal angles where information may be accumulated.
The reinforced vertical projection profiles take advantage of the black borders of the document image that originate from the image capturing processes (see Fig. 6 a, b). In some rare cases where the vertical border (or frame) does not iden-tify the skew angle of the text, the br ( j ) upper limit assures that the border will have a dominant but not decisive con-tribution to the calculation of the skew angle. Even if the reinforced vertical projection profiles fail to detect the cor-rect skew angle, the proposed method has the advantage of combining methods. The horizontal projection is likely to find the correct skew angle and in this way the outcome will be correct.

The use of reinforced vertical projection profiles is also suitable for multicolumn documents. The proposed projec-tion profiles, unlike the classical horizontal projection pro-files, have extremely accurate performance in multicolumn documents, since this kind of documents has several areas fully aligned. This results in several high peaks which corre-spond to high concentration of black pixels (see Fig. 6 c). 2.3 Horizontal projection profiles At this step, we calculate the initial horizontal histogram
H  X  () for each angle  X  , which is defined as follows:
H  X  ( y ) = and then divide it by the area of the bounding box E  X  in order to form H  X  h () as follows: H 2.4 Skew estimation and minimum bounding box area In order to estimate the correct skew of the document image, we seek for the angles  X  v and  X  h in which the difference between three successive values of, respectively, H  X  v () H  X  v = arg max  X  ( D v ( X  )) (11)  X  where  X  varies in the range of the image document skew expected while D v ( X  ) and D h ( X  ) are defined as: D v ( X  ) = arg max H  X  v ( x )  X  H  X  v ( x  X  1 ) D where x  X  X  x  X  l , x  X  r ] and y  X  X  y  X  u , y  X  d ] and values of H and H  X  h ( y ) with x and y exceeding their range are considered to be zero. We use the difference between three successive values in Eqs. ( 13 , 14 ) in order to have a smoothed function that is more robust in degradations, significant noise, broken characters, etc.

In order to decide which of the two candidate skew angles,  X  v or  X  h , corresponds to the estimated skew of the document image, we compare the areas of the bounding boxes in each is the one that corresponds to the minimum bounding area.  X  = 2.5 Faster convergence: coarse-to-fine technique In order to make our method faster and reduce the compu-tational cost, a coarse-to-fine technique, similar to the one proposed by Li et al. [ 26 ], is applied. In that way, the number of angles that the document image is rotated is reduced with-out restricting the range of the angles that the document is rotated. This coarse-to-fine technique, furthermore, enables the extension of the range of the expected skew angle since it accelerates the proposed algorithm multiple times, depend-ing on the range of angles of the expected skew, without affecting significantly the accuracy of the proposed method. The flowchart of CEPP using this coarse-to-fine technique (CEPP c-f) is presented in Fig. 7 .

Given that we have a wide range of angles [  X  min , X  max ] in which the document skew is expected, a classical projec-tion profile method [ 20  X  24 ] would rotate the document by every angle from  X  min to  X  max with a certain step which cor-responds to the required accuracy. In that way, the algorithm would have to perform [ ( X  max  X   X  min + 1 )  X  20 ] rotations in order to achieve an accuracy of 0 . 05  X  . Instead, in the pro-posed method the document image is rotated from  X  min to  X  max with step 1 Afterward, the document image is rotated from ( X  d 1  X  0 . ( X  skew angle  X  d 2 . Then, the document image is rotated from ( X  angle is re-adjusted in  X  d 3 , while finally, the image is rotated from ( X  d 3  X  0 . 05 ) to ( X  d 3 + 0 . 05 ) and so the skew angle determined. With the use of this coarse-to-fine technique the rotations required are reduced to ( X  max  X   X  min + 13 ) . As a con-clusion the proposed algorithm accomplishes a faster conver-gence and performs 9 times faster in a range between  X  5  X  and 5  X  and 17 , 5 times faster in a range between  X  45  X 
It is to be noted that the accuracy of 0 . 05  X  is quite satis-factory for document images scanned in a resolution of 300 dpi or greater, while for lower resolution document images the last iterative step of the CEPP c-f can be omitted without affecting the accuracy of the method. 2.6 Implementation and computational complexity In order to optimize the computational cost of the proposed algorithm, the following implementation is suggested. In this way the proposed algorithm scans the rectangle that contains the information only once in each angle in order to compute the outcome of both vertical and horizontal pro-files. The time complexity of the proposed implementation is detailed below.

During skew detection, the calculation of the maximum difference between three successive values is done for a con-stant number of times in a constant number of iterations. In the case of CEPP c-f method for a range of angles between  X  5  X  and5  X  andaccuracy0 . 05  X  ,thenumberofiterationsis23. We find the maximum values among the variations computed and since finding the maximum value involves a constant number of comparisons the time complexity of the proposed algorithm mainly depends on the time complexity of the cal-culation of the variation values. The variation calculation for each angle involves iteratively checking each pixel inside the rectangle area that contains the foreground pixels. Hence, the overall time complexity is O (( I x + 1 )  X  I y ) , which is linear withrespecttothetotalnumberofpixelsintheimage. ( I x + 1 ) stands for the number of columns of the image, I x , plus one that stands for the histogram of the horizontal profiles which is also of the same size as the height of the document image. 3 Qualitative and quantitative evaluation of the method 3.1 Qualitative testing on the combination of vertical and As mentioned in the introduction and Sect. 2 , horizontal and verticalprojectionprofileapproachesarecomplementaryone to the other. To summarize, (1) horizontal projection profiles can accurately deal with single column printed documents with minimum noise and are accurate for a restricted range of angles and (2) vertical projection profiles are very efficient in dealing with noise, warp, multicolumn documents and tables while they perform well for a great range of angles.
The two types of projection profiles, besides their suitabil-ity for different cases, can also contribute in a cooperative way in the process of a single complex document due to the coarse-to-fine technique, since in each step of the iterative process a different method may detect the dominant skew. In this way, the enhanced projection methods are combined in a more profound way. In order to demonstrate how the com-bination of the enhanced projection profiles can contribute to an accurate skew estimation, two artificial images have been created and rotated by common and wide range skew angles (see images of Table 1 ). These images involve the major drawback cases of both vertical and horizontal projec-tion profiles since they represent double column documents with no vertical or horizontal alignment, while in the sec-ond case there are also vacant spaces and significant warping simulated in the left side of the image.

The results of each projection profile method used in each iterative step are demonstrated in Table 1 . The result of the projection profile method that is closer to the outcome of the minimum bounding box area algorithm is qualifying in each step and is considered as an input angle for the next step. The selected result is highlighted in order to demonstrate the swapping among the contributing projection profile meth-ods during the convergence process. Steps 1 X 4 correspond to the successive iterations of CEPP c-f with respective step of rotation for the projection profile methods from 1  X  to 0
As can be observed in the cases demonstrated above, the optimal algorithm is altered during the converenge process of CEPP c-f and a more profound combination of the two projection profile methods is evident. It is worth mentioning, neither the reinforced vertical nor the enhanced horizontal projection profiles alone could achieve the accuracy of the proposed method. 3.2 Quantitative testing on the accuracy of CEPP on real 3.2.1 Datasets In order to test the estimation accuracy of the proposed method, we created two datasets. Dataset A is formed by contemporary document images of various types and dataset B is formed by two historical books.

Dataset A For the construction of dataset A, we scanned in 300 dpi resolution, manually deskewed, binarized [ 27 ] and rotated by a range of angles 200 document images from var-ious types of documents, representative of the most realistic cases that an algorithm might come up against (see Fig. 8 ). The document images used contain figures, tables, diagrams, block diagrams, architectural plans, electrical circuits, and are obtained from newspapers, scientific journals, scientific books, literature books, poetry anthologies, course books, dictionaries, travel guides, museum guides, museum tickets, menus, comic books, official state documents and various other sources. The image documents of dataset A are writ-ten mainly in English, Chinese and Greek, while there are several documents written in Japanese, French, Bulgarian, Russian, Danish, Italian, Turkish and ancient Greek. There are representative cases of various sizes of image documents, any kind of mixed content, vertical and horizontal writing, multisized fonts and multiple different number of columns in the same document, while some of the documents suffer from degradations and distortion. A description of the lan-guages and the layout types that are included in dataset A are detailed in Tables 2 and 3 , respectively. Dataset A is publicly available [ 28 ].

As can be observed, only 30% of the dataset is written in Latin script, 40% is written in Greek (contemporary and ancient), 25% is written in Chinese and the rest is written in different non-Latin script languages.

From the above table, it is derived that only 20% of the documents contain only plain text, while most of the remain-ing documents have a complex layout combining figures, tables, diagrams and multi-column formats. Due to this fact the total number accumulated (260) exceeds the number of documents (200). 35% of the documents have multiple columns, 45% of the documents have either figures or dia-grams while 25% of the documents contain various styles of tables. It should also be noticed that 5% of the dataset was written in vertical orientation.

Dataset B In order to test the accuracy performance of the proposed method in severe cases of degraded documents, we formed dataset B. Dataset B contains two entire histor-ical books, one from Eckartshausen, which was published in 1788 and is owned by the Bavarian State Library [ 29 ] (126 document pages), and a French historical book, which was published in 1838, and is owned by the Biblioth X que nationale de France [ 30 ] (152 document pages). Samples of the dataset are demonstrated in Fig. 9 . The two books consist of 278 pages and none of them was excluded, while some of the images of the books suffer from several problems such as warp,noise,brokencharactersanddegradations(seeFig. 10 ). Although all pages of dataset B suffer from a level of noise and warp, in Table 4 the number of pages with extended noise (see Fig. 10 a) and significant warp (see Fig. 10 b) is presented. Over 73% of the German book and almost 62% of the French suffer from warping while over 16% of dataset B suffers from extended noise. The use of dataset B aims at proving the robustness of the proposed algorithm in extended degradations, noise, warp and broken characters.

All the printed document images were scanned in 300 dpi resolution, deskewed manually, binarized with the method described in Gatos et al. [ 27 ] and were rotated by different angles, while dataset B is a superset of the one used in Papan-dreou and Gatos [ 21 ]. 3.2.2 Evaluation metrics For every document image j of the datasets used, the dis-tance E ( j ) between the ground-truth and the estimation of each tested algorithm was calculated. It should be noted that the estimations of each algorithm were rounded to the sec-onddecimalplace.Inordertomeasuretheperformanceofthe submittedmethods,thefollowingthreecriteriawereused:(1) the average error deviation (AED), (2) the percentage of cor-rect estimations (CEs) and (3) the percentage of estimations the above criteria is given below.
 The AED criterion is described by: AED = where N equals to the number of images of each dataset. The CE criterion is determined as: CE = Finally, the E &lt; 0 . 2 criterion is determined as: E &lt; 0 . 2 = The threshold of 0 . 2  X  was chosen due to the fact that a skew angle smaller than this threshold is well accepted from the scientific community. 3.2.3 Experimental results Four experiments were performed, two with each dataset (A and B) comparing the proposed algorithm with six other state-of-the-art methods. The first two experiments were in common skew angles (from  X  5  X  to 5  X  ) and the other two in wide range skew angles (from  X  42  X  to 42  X  ) .

Common skew angles experiments At first all the docu-ments of dataset A and dataset B were rotated by 11 different angles, from  X  5  X  to 5  X  with step 1  X  , and 2,200 (dataset A) and 3,058 (dataset B) image documents with known ground truth were created. In order to make a comparison of the CEPP method with current state-of-the-art skew estimation techniques, we also implemented (1) the classical projec-tion profiles (PPs) of Postl et al. [ 20 ], (2) the Papandreou and Gatos enhanced horizontal profile (eHPP) [ 21 ], (3) the Papandreou and Gatos enhanced vertical profile (eVPP) [ 21 ], (4) the classical Hough transform (HT) of Srihari and Govin-daraju [ 6 ], (5) the Yan cross-correlation (CC) [ 15 ] and (6) the Alireza et al. piece-wise painting (PPA) [ 19 ] algorithms. The range of expected skew for all projection algorithms was set from  X  6  X  to 6  X  while the step of rotation, and consequently its accuracy, was 0 . 05  X  . Besides CEPP, CEPP c-f algorithm was implemented and tested in which the coarse-to-fine tech-nique was applied. The results presented in Table 5 demon-stratethatourmethodoutperformsthecurrentstate-of-the-art skew estimation methods. methods. It should also be noted that the bold in the result tables denote the best performance.
In Table 5 it is demonstrated that CEPP method has an average error deviation around 0 . 055  X  regardless of the type of the document image and CEPP c-f method has a simi-lar performance ( 0 . 051  X  ) in contemporary documents, while its performance in historical documents is not significantly lower than CEPP X  X . The results in dataset A show that CEPP can handle any kind of printed image document (see Fig. 8 ), regardless of layout and script, with an almost zero average error deviation. Also, by observing the results from dataset B, it is derived that the proposed method can handle historical books that suffer from multiple degradations (see Fig. 9 ) and havecommonskew,withaverageerrordeviationsmallerthan the one observed by the human eye ( 0 . 1  X  ) , while almost 90% of the 3,058 image documents were deskewed under the well accepted threshold of 0 . 2  X  . It can be observed that dataset B has significant warping and noise since all the methods that project horizontally or track horizontal lines have lower accuracy performance than the performance that they have in dataset A. On the other hand, there are multiple different layouts in dataset A and as a result the cross-correlation and painting methods accuracy is decreased.

Wide range of skew angles experiments In order to exam-ine the operating range of each state-of-the-art algorithm and prove the robustness of CEPP method, all the docu-ment images of dataset A and dataset B were rotated by 15 different angles, from  X  42  X  to 42  X  with step 6  X  , and 4,170 (dataset A) and 3,000 (dataset B) image documents with known ground truth were created. The proposed method was compared with all the above mentioned state-of-the-art skew estimation techniques, where the coarse-to-fine tech-nique was applied in all of the projection profile algorithms for faster convergence. So, we compared with: (1) the clas-sical projection profiles (PPs c-f), (2) enhanced horizontal profile (eHPP c-f), (3) enhanced vertical profile (eVPP c-f), (4) the classical Hough transform (HT) of Srihari and Govin-daraju [ 6 ], (5) the Yan cross-correlation (CC) [ 15 ] and (6) the Alireza et al. piece-wise painting (PPA) [ 19 ] algorithms. The range of expected skew for all projection algorithms was from  X  43  X  to 43  X  while their accuracy was 0 . 05  X  all these methods the average skew error deviation for every document image skew angle in degrees was calculated and the results are presented in Table 6 .

As demonstrated in Table 6 , the CEPP c-f method out-performs the state-of-the-art techniques, while it is robust in every range of skew since it has the same accuracy perfor-mance as in the first experiment of common skew angles. The proposed algorithm has a smaller average error devi-ation than the skew observed by the human eye ( 0 . 1  X  ) both datasets, while it can be applied to the whole spectrum of the expected skew. Furthermore, from Table 6 , the operat-ing range of each state-of-the-art algorithm implemented can be observed. Most of the state-of-the-art algorithms have an acceptable accuracy performance between 6  X  and  X  6  X  , with the exception of PPA that seems to operate in the range of  X  12  X  to 12  X  and eVPP that seems to be robust in all angles with document images of standard book layout (dataset B) and an operating range between 24  X  and  X  30  X  when the lay-out varies. It is also interesting to observe that in dataset B, due to the warping and noise, the PP fails along with the eHPP in angles beyond  X  6  X  , while in dataset A, unlike PP, eHPP seems to be robust in angles for 30  X  to  X  30  X  . 3.2.4 Qualitative comparative experiments with Some qualitative tests comparing the proposed algorithm with highly acknowledged commercial products in randomly chosen cases of our datasets are also performed. Through these results it is demonstrated that CEPP and CEPP c-f can make a significant contribution in the OCR level.
 In Table 7 there is a comparison between the results of CEPP c-f method and scan tailor (ST) software in samples of both datasets A and B, while it should be mentioned that ST software does not perform when the skew exceeds  X  7 . 5  X 
In Table 8 , there are also comparative word recognition accuracy results from ABBYY Fine Reader 2011 (FR X 11) software, using its own skew estimation algorithm and the proposed one. Some document images from the ones used in the previous experiments were picked and the FR X 11 soft-ware was used for OCR. Then, the document images were deskewed with the proposed method and were fed in the OCR FR X 11 engine, which provided improved OCR results. In that way, the contribution of CEPP c-f method is also indirectly demonstrated through recognition improvement. It should be mentioned that the FR X 11 software cannot detect skew that exceeds  X  20  X  and is not efficient with vertical writ-ing.
 As demonstrated in Table 8 , there are cases in which the CEPP c-f method improves the OCR results, even after the use of layout analysis and dictionaries, proving its efficiency and contribution in the recognition accuracy. 3.2.5 Analysis of the individual components of the CEPP Finally, experiments to analyze the proposed method in its components were made in order to measure the influence of the components of the proposed technique. In Tables 9 and 10 , the skew estimation results of (1) the reinforced ver-ticalprojectionprofile,(2)theenhancedhorizontalprojection profile and (3) the minimum bounding box area [ 25 ] algo-rithms for the experiments in common and wide range are demonstrated, respectively.

From Tables 9 and 10 , it can be observed that the CEPP method outperforms each of its components. Furthermore, the reinforced vertical and enhanced horizontal profiles used, outperform eVPP and eHPP, respectively. The minimization of the bounding box area technique, although not proved robust for both datasets, is a very efficient criterion in order to select among various methods and candidate angle esti-mations. 4 Conclusion In this paper, a new technique based on combined reinforced projection profiles (CEPP) was introduced. We are motivated by the fact that the horizontal and vertical projection profile approaches are found to be complementary, so we introduce the minimum bounding box area as the appropriate crite-rion in order to combine novel reinforced horizontal and enhanced vertical projection profiles. Despite the fact that the proposed method falls broadly in the category of projec-tion profile methods, CEPP deals with all the drawbacks of the projection profile methods. In more detail, it is noise and warp resistant, it gives more accurate results in any kind of printed document image, it is not restrained by any range of angles and can achieve fast convergence if the coarse-to-fine search version (CEPP c-f) is used. For these reasons, it can be efficiently applied to historical machine-printed or multicol-umn documents, documents with figures and tables, while it is robust for any kind of script and a wide range of angles.
Besides the efficiency and complementarity of the verti-cal and horizontal projection profiles that was proved, the proposed method introduces the following innovative ele-ments: (1) An innovative criterion which can operate as a skew estimation technique selector. The minimization of the bounding box area proved to be an effective algorithm selec-tor which can combine two and perhaps more different skew estimation techniques. (2) Novel reinforced vertical projec-tion profiles which take advantage of the vertical lines and strokes in a way which is dominant but not absolute were pro-posed. Finally, (3) the candidate skew angles that are com-puted by the reinforced vertical and the horizontal projection profiles are determined by the maximization of the differ-ence between three successive values of the corresponding histograms instead of two. In this way, the calculations have greater confidence and provide improved results especially in degraded and noisy images.

The proposed skew estimation technique was extensively tested in two different datasets, one with document images of entire historical books with serious degradations and another of various document images representative of every kind of realistic case that an algorithm might come up against and it outperformed the state-of-the-art techniques. The CEPP method proved to be accurate, with an average error devi-ation which is not observed by human eye, it is noise and warp resistant, while it deals with documents with broken characters. The proposed method can be efficiently applied to any range of expected skew angles, it applies in vertical and horizontal oriented text, it deals with figures, tables, var-ious font sizes and multicolumn documents, while it is faster due to a coarse-to-fine convergence technique.

To sum up, skew detection is a preprocessing task that has concerned the computer vision community for many years. The major difficulty though is given by the fact that many of the proposed state-of-the-art algorithms address very differ-ent specific problems. Also, they mainly consider documents with plain structure. This limitation appears too restrictive with respect to current documents. Furthermore, it is com-mon for authors to declare performance computed on their own databases, generally not available, making a strict com-parison very difficult [ 3 ]. To this end, we propose CEPP and CEPP c-f from a generic point of view, since skew detection is still an interesting and challenging issue and needs further improvement in order to meet the modern requirements of OCR on-the-fly, especially regarding documents with graph-ics, charts, figures or various font sizes. CEPP and CEPPc-f methods are moving in that direction since they are fast and accurate without any restrictions in layout, script, range of angles or context. Furthermore, this paper, with the exten-sive experimental results and the publicly available generic dataset [ 28 ], provides a benchmark for the scientific commu-nity and tackles the difficulty of strict comparison between different methods.
 References
