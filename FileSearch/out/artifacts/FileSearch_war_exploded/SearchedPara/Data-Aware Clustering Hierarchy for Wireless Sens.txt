 In recent years, the wireless sensor network.(WSN) [1, 2] is employed a wide range of Except some high accuracy required applica tions (for example, applications in maximize the life span of the network, clustering techniques based on data fusion [3] such as LEACH [4], LEACH-C [5], BCDCP [6] etc. have been proposed. sion and spread energy consumption around all the sensors more evenly. The sensors some adjacent sensors are similar. The sensing field can be divided into regions with lected from indoor sensors and outdoor sensors may be similar respectively. However, during the running of the wireless sensor network, we can estimate data distribution in the network using some data mining methods. And based on this information, the clusters can be organized not only according to the mutual distance, but also the char-acquire more information from the network with less energy cost. 
In this paper, we propose a Data-Aware Clustering Hierarchy (DACH), which is network. In DACH, data distribution is estimated by a data mining process based on collected data and the sensors are distribute d into a clustering hierarchy according to the discriminations between the collected data. Furthermore, we introduce a multi-granularity query processing method based on DACH to estimate the query results using a few sensors X  data instead of all of them. Our Contributions 1. We propose a data mining method to estimate the data distribution in wireless sen-sor network, and based on it we introduce a new clustering structure and also a new communication protocol for WSN. 2. We propose a multi-granularity query processing method based on DACH to esti-mate the query results using a few sensors X  data instead of all of them. 2.1 Data Distribution in Wireless Sensor Network In many applications of wireless sensor network, the sensing field can be divided into a series of regions with different characteristics. In the example mentioned in section 1, the whole building site contains the indoor regions and the outdoor regions, and the space inside a building still can be divided into different building stories, rooms and property as the  X  X egional Property X . 
As the regional property of the sensing field, data collected from sensors deployed outdoor sensors may be very different from data collected from indoor sensors, as the difference of the physical conditions between outdoor and indoor regions. And in the mean time, data collected from sensors in a same room may be similar. crimination between data collected from diff erent sensors or sensor sets (discrimina-collected from each sensor as a time series and define the discrimination of sensors by with length n is: TS=TS 1 , TS 2 , ..., TS n . eliminate the influence of the length of time series: 
Moreover, we can estimate the discrimination between two sensor sets by the dis-crimination between centroids of corresponding time series of sensors in each set. 2.2 Data-Aware Clustering Hierarchy temperatures of a building site as shown in figure 1a. The gray region indicates out-methods, the clustering structure in a certain round may be organized as Figure 1b [4]. It shows that there are 17 nodes in the cluster A, nine of which are in the gray region and other eight are in the white one. Data collected from sensors in this cluster may be very different between each other. 
An ideal clustering structure is shown in figure 1c. It still contains 5 clusters. The difference from figure 1b is that each cluster represents a section of outdoor or indoor WSN using less energy. We can compress data volume more efficiently after data fusion and prolong the network X  X  life span further. Moreover, in some applications of approximate queries, we can only query a few sensors X  data instead of all of them. 
In the figure 1d, similar clusters in figure 1c are merged to larger clusters respec-one contains sensors in the indoor regions. The cluster structures in these two figures constitute a clustering hierarchy showed in figure 1e. 2.3 Algorithm for Building Data-Aware Clustering Hierarchy In this section we propose an algorithm for building the data-aware clustering hierar-chy based on topological structure of network and data distribution. To facilitate our discussion, we first give some general definitions: 
Def.2 Relay: The indirectly transmission from node A to node B through node C is called Relay. The node C is called Relay node. 
Def.3 Relay Region: Given a node s and a relay node r, the relay region of s with respect to r is defined as follows: where ||xy|| denotes the distance between node x and node y,  X  and c are two constant model. Obviously, the nodes in the relay region of s with respect to r can be reached with least energy by relaying r. 
Def.4 Neighbor: The node not in any relay region of s is called neighbor of s. For-mally, we define it as follows: 
Furthermore, two sensor sets A and B are called neighborhood sets if there are two neighborhood sensors a and b, where sensor a is in the set A and b is in set B. 
Before building a k-level clustering hierarchy, we define a series of thresholds,  X  0 ,  X  to the sensing scenarios. For example, in a temperature monitoring system, the thresholds can be specified as 0, 0.5, 1, 2, 4 (  X C ). ries. In the lowest level (level 0), we initialize a set for each sensor in the network and compute the discrimination between each pair of sets using following equation: 
Then, we build clusters on higher level in a bottom-up way by following steps: 1. Find the pair of sets with minimum mutual discrimination d min ; ture of level-i; 3. Combine these two sets into a new set, compute the centroid of all the time se-ries in the new set and update its discrimination with other sets threshold  X  k-2 level, which contains all the sensors in the network. 
After that, we obtained a clustering hierarchy. Every set on every level contains a set X . Based on the DACH proposed in last section, we introduce a novel communication the context of not leading to any ambiguity. DACH operates in three phases: initiali-zation, setup and data transmission. initialization phase. given period and generates a time series for every sensor. Based on these time series, the base station computes the discriminations between each pair of sensors and builds the clustering hierarchy using the method proposed in section 2.3. Setup Phase: When the system is initialized, the network enters the setup phase. The The base station receives information of the current energy status from all the nodes in the network. Based on the feedback and the clustering hierarchy, base station gen-erates the routing path in a bottom-up way. since each cluster only contains one node, each node is a cluster-head. For each clus-ter C on level-i (i&gt;0), the cluster-head must satisfy following two conditions: 1) It is a cluster-head of one of its children clusters; 2) Its residual energy is the highest among cluster-heads of all its children clusters. 
Now the routing path of each sensor node can be obtained easily. It first transmits data to the corresponding cluster-head which subsequently transmits data to the clus-ter-head of its parent cluster. This process continues until the data is transmitted to the only cluster-head on the highest level. And the data is sent to the base station finally. 
The cluster-head of a level-i cluster and all the cluster-heads in its children cluster sensors transmit data using a multi-hop method. Data Transmission Phase: The data transmission phase consists of three major activi-The cluster-head on highest level transmits the aggregated data to the base station. 
For spreading energy consumption between sensors more evenly, after a period of cluster-head and regenerate the routing path for every sensor. In most performance-driven application, WSN may have less stringent performance requirements and can be implemented at much lower cost. J. Frolik proposed random access techniques to help facilitate such requirements [9]. In [9] the quality of service (QoS) measures application reliability with a goal of energy efficiency. According to the user-defined quality of service, the random access system selects a proportion of sensors for data gathering. These sensors are called  X  X ctive sensors X . But as the active sensors are selected randomly, the data collected by a random access system may not be able to simulate the whole data set appropriately. In this section, we discuss our multi-granularity query processing method based on sensor nodes. The multi-granularity queries have the following basic structure: SELECT expr1, expr2... FROM network WHERE pred1 [and|or] pred2 LEVEL ON levelNum The SELECT, FROM and WHERE clauses are defined as the standard SQL. The hierarchy, it can be seen that the data of all nodes are similar in a certain cluster, and approximate estimating error using the LEVEL ON clause. sensors in the same cluster based on its own data. That is, the query is processed on the cluster-heads on level-k. method can estimates the query result accurately. Data gathered by the random access system may omit data of sensors in some small and special region because the prob-ignore these regions. To test the performance of DACH and the multi-granularity query processing method, we simulate an environment temperature monitoring system. Using this simulated system, we compare the energy efficiency of DACH with LEACH and the estimating accuracy of the multi-granularity query processing method with the random access environment is PC with AMD Athlon processors 3000+, 1GB of RAM, and running Windows XP Professional. 
We use the network model and radio model discussed in [4, 5, 6] and simulate the the sensors randomly and set the parameters of temperature based on RGB colors of the corresponding pixels. The value of R/10 represents the average temperature in one day. The value of G/10 represents the maximum temperature in one day. And the value of B/10 represents the time of the maximum temperature. We simulate denoted by: 
We assume that the base station locates at point (-20, -20). Each node is assigned an initial energy of 2J. The number of data frames transmitted for each round is set at 10; the data message size for all simulations is fixed at 500 bytes, of which 25 bytes is the length of the packet header. In the first experiment we compare the energy efficiency of DACH and LEACH. We simulate a 50m X 50m network with 200 sensors. Figure 2a shows the average residual energy of sensors of DACH and LEACH at different number of operation rounds. It can be seen that DACH has more desirable energy efficiency than LEACH. 
Figure 2b shows the number of nodes that remain alive at different number of remain alive. It indicates that DACH distributes the energy load among the sensors in the network more efficiently. 
In the second experiment, we compare the accuracy of the query results between the multi-granularity query processing method based on DACH and the random ac-cess system. We simulate a 50m X 50m network with 100 sensors and compute the average temperature in the network. The figure 2c shows that our method always processes the query more accurately than the random access system. On average, our method reduces the estimating error by 0.5 degrees. In this paper we proposed a data-aware clustering hierarchy for wireless sensors net-work (DACH) and a multi-granularity query processing method based on DACH. mutual distance between sensors. Using the similarity of data collected from sensors show that DACH has much higher energy efficiency than LEACH. And the estimat-access approach. 
