 1. Introduction
Double-level air flow field dyna mic vacuum system (DAFDV) is that the air flow temperatures in two concatenate chambers maintain and out of the chambers. DAFDV syste ms have great application value for the simulation of dynamic atmospheric environments, calibration of meteorological instruments and research of humidity generation technology based on two-tempera ture or two-temperature two-Air temperature control of single chamber has been widely studied by Thompson and Dexter, 2005 ; Qi and Deng, 2009 ; Li et al., 2011 ), and some findings have been extensively applied in industrial practices. However, researches on DAFDV systems have scarcely been repre-sented in the open literature. This may be attributed to two major fuzzy decoupling, neural networks decoupling, prediction decou-pling, intelligent decoupling methods represented mainly by the fuzzy decoupling and the neural networks decoupling, have been proposed and applied in many control practices. The detailed introduction to these decoupling methods are summarized ( Dong et al., 2011 ), this paper no longer repeats them.

Adaptive decoupling has merits in decoupling a system with many uncertain factors and can solve the system X  X  uncertainty to a certain extent. Multilayer neural networks have adaptive, self-learning, strong fault tolerance abilities and are universal approx-imators capable of approximating any nonlinear function to any desired degree of accuracy, making it a powerful tool for the decoupling control of nonlinear systems. The modified output X  input feedback (OIF) Elman neural network, as a kind of recurrent neural network, is superior to the static neural network such as back-propagation (BP) and radial basis function (RBF) neural network on the dynamic characteristic ( Wu et al., 2011a ), and it is now extensively applied in the fields of system identification, nonlinear control and prediction control ( Serhat et al., 2003 ; Qi et al., 2005 ; Gao and Wang, 2007 ). However, neural networks commonly require to be combined with other algorithms to realize decoupling control ( Wu and Chai, 1997 ; Li, 2006 ).
Prediction is an effective means to control a time-delay system. Furthermore, the proportional-integral-derivative (PID) controller is widely used in many fields due to its simplicity and
Based on the above discussions, an adaptive PID decoupling control method based on the modified OIF Elman neural network and prediction principle is proposed in this paper. Because the Nomenclature A cross section area c specific heat capacity(kJ/kg K) D time coefficient (s) F mass flow rate (kg/s) h convective heat transfer coefficient(kW/(m 2 K)) L spatial coefficient (m) t time (s) T temperature (K) Fig. 1 , the air flows in the dash dotted arrows direction while the liquid (water or ethanol) in the solid arrows direction. The middle part of the air flowing through is the pressure control loop. The temperature control system is constituted of water bath tem-perature control (WBTC) subsystem and ethanol bath tempera-ture control (EBTC) subsystem. These two subsystems, which are used to achieve air temperature control in the downstream chamber C2 within ranges from 5 1 Cto80 1 C and from 70 1 C to 5 1 C, respectively, are symmetrical about the pressure control loop. The air from C1 passes through heat exchanger (HX) E1 when the controlled objective air temperature is between 5 1 C and 80 1 C. Otherwise, the air from C1 passes through heat exchanger E2. Since the temperature control circuit of C1 is same as that of C2, only the structure of temperature control circuit for C2 is presented in Fig. 1 . Moreover, only the WBTC subsystem is introduced due to the same framework as that of the EBTC subsystem.

The air flow temperature control in C2 is achieved by heat exchange between water and air in E1. E1 transfers heat from water to air or in the opposite direction, and the objective is to control the outlet air temperature, by changing the inlet water temperature. The inlet water temperature of the E1 is acquired by controlling the temperature of thermostatic water bath T1. How-ever, the real actuators for water temperature control are heater H1 installed at the bottom of T1 and industrial chiller D1 connecting with T1. In the process of heating-up, the H1 start to work and the liquid circulate between T1 and E1 with the aid of pump P3.

Double-level voltage control strategy is adopted to improve the control precision. First, the input voltage supplied to H1 is adjusted by the voltage regulator. Moreover, PID-controlled pulse-width modulated signal is employed to regulate the duty ratio of the control voltage. At the stage of decreasing process of temperature, the D1 which is switched on manually operate at full speed, valve v5 and v6 open, and the water circulate between T1 and D1 by the driving of variable pump P1. The water temperature in T1 is regulated by altering the speed of P1.
The pressure control system is mainly constituted of four parts: the air source system with adjustable vacuum pressure (ASSAVP), upstream vacuum chamber, downstream vacuum chamber and the high vacuum system with adjustable vacuum pressure (C4). The ASSAVP are employed to supply adjustable and relatively stable pressure continuously for C1, and the C4 are used to regulate the pressure in C2 and provide a high vacuum environment, respectively. In order to improve the regulation ability and provide the driving power for air flowing, the pressure ratio between the upstream vacuum pressure and the down-stream vacuum air pressure should be within the scope from 1.05 to 20 (this scope is determined in the experimental processes on a real plant-DAFDV system when the two air pressures are within the given range in this paper). Thus, the vacuum pump of HVS system needs to work in advance. To reduce the influence of the external environment, a 200 mm thermal insulation layer is set outside of the DAFDV system. 3. Modeling of the DAFDV system
In this section, the models of the DAFDV system are qualita-tively developed for analyzing the system properties conveni-ently. The temperature control process of the DAFDV system is that: (1) the water temperature of T1 is manipulated by the heater or chiller. (2) The air temperature in C2 is controlled by changing the inlet water temperature of E1, i.e., the water temperature of T1. (m), respectively, and are defined as follows:
L  X  h w U w , L a  X 
D  X 
First, from Eqs. (5) X (7) , we can know that the air temperature depends on not only structure parameters of HX but also both fluid properties through HX. In this study, our objective is achieving rapid, accurate and independent control for the air flow temperatures in two concatenate chambers within operating ranges from 70 1 Cto80 1 C. As the temperature changing over this wide operating range, the property parameters of two fluids, significantly. Furthermore, the air speed passing through HX and corresponding Reynolds number are, respectively described: u  X  _ Q a = A  X  9  X 
Re  X  r a u a d in = m a  X  4 r a _ Q a = m a p d in  X  10  X  flow rate, d m is the tube diameter (m). From Eq. (10) , it can be seen that the air speed ( u a ) reduces with the air volume flow rate  X  _
Q
 X  and Re alters with _ Q a , this fact implies that the flow state may be laminar flow or turbulent flow. However, the convective states and it is well known that h a is decreasing as the air speed reduction and exchange efficiency of HX degrade enormously. The lower h a means the heat exchange time is longer between the two fluids in the HX, namely, the time-delay from the inlet liquid temperature to the outlet air temperature become longer.
Finally, the air flowing process from C1 to C2 is an exchange process of mass and energy. The two temperature couplings between C1 and C2 are mainly caused by the flow rate variation of air passing through control valve V2. The flow rate is deter-mined by the upstream pressure ( P 1 ), the downstream pressure ( P ) the upstream air temperature  X  T a u  X  , and the opening percen-tage of the control valve (O). The relationship between flow rate and the four variables can be expressed as the following nonlinear equation ( Dong et al., 2011 ): _
Q  X  f  X  P 1 , P 2 , T a u , O  X  X  11  X 
According to conservation of energy of HX in steady state, we can obtained, c F where T a in and T a out are, respectively the inlet and outlet air temperature of the HX, T w in and T w out are, respectively the inlet and outlet liquid temperature of the HX.

Considering that the pipelines between E1 and C2 as well as between T1 and E1 (HX) are short, we can think that the liquid downstream air temperature ( T a d ) is equal to T a out ,namely,
T
Combining Eq. (11) with (12) and (13) , the downstream air temperature ( T a d ) can be described as
T  X 
From Eq. (14) , it can obviously that the variation of _ Q a has is caused by _ Q a . The air flow rate is modified by altering the percentage of opening of valve V2.
 loop is treated as exterior disturbance on the first main loop while the coupling effect from the first loop is treated as exterior disturbance to the second main loop. Thus, one TITO system can be divided into two independent single-input single-output (SISO) systems. Therefore, the combination of the PID controller with the modified OIF Elman neural network and prediction algorithm is appropriate to eliminate couplings and disturbances by identification of system dynamic model and reduce or elim-inate the time-delays of the system by prediction. 4.2. Modified OIF Elman neural network model for DAFDV system
The controlled DAFDV system can be described by the follow-ing nonlinear model with time-delay: where y are the upstream air temperature, T u , and the down-stream air temperature, T d , u is the air volume flow rate altered by regulating the opening percentage (O) of the control valve V2, and voltage supplied to the heater or the speed of liquid circulation tively, d is the time-delay from output to input, and F ( )isa nonlinear function which is identified by a modified OIF Elman neural network identification model.

The OIF Elman neural network is a kind of recurrent neural network, which consists of the input, hidden, context, context 2 and output layers. The context layer and context 2 layers are used to memorize the former values of the hidden and output layer nodes, respectively. The feed-forward connections are modifiable, whereas the recurrent connections are fixed. The structure of OIF Elman neural network is shown in Fig. 4 ( Wu et al., 2011a ).
In Fig. 4 , w u is the weight between the input layer and hidden layer, w y is the weight between the hidden layer and the output, w c is the weight from the context layer to the hidden layer, and w yc is the weight from the context 2 layer to the hidden layer. x ( k ) and x ( k ) are the outputs of the context unit and the hidden 2 layer and output layer, respectively. a and b are, respectively the feedback gains of the self-connections of context and context 2 layers,0 r a , b r 1. Here, a and b are selected as 0.5.
The mathematical model of the OIF Elman model neural network is expressed as follows: x  X  k  X  X  F  X  w c x c  X  k  X  X  w u u  X  k 1  X  X  w yc y c  X  k  X  X  X  16  X 
The recursive multi-step-ahead prediction expression can be written: ^ y  X  k  X  j 9 k  X  X  f  X  ^ y  X  k  X  j 1  X  , ^ y  X  k  X  j 2  X  , ^ y  X  k  X  j 3  X  at time-step k.
 input values u  X  k  X  i  X  X  i  X  1 j 1  X  are used. Here, u  X  k  X  i  X  X  u  X  k  X  X  i  X  1 j 1  X  . Obviously, the future output at time-step k and before k can be substituted with the real system output ^ y  X  k  X  i j  X  X  y  X  k  X  i j  X  X  i j r 0  X  . 4.4. Self-tuning PID decoupling control based on modified OIF Elman model
The digital incremental PID control algorithm is used in this paper, which is described as: u where x  X  1  X  X  x  X  2  X  X  x  X  3  X  X  r is the system set point at time-step k. k pi , k ii and k di are, respectively the proportional, integral and differential coefficient.
Since the time delays are uncertain and variable to some degree, thus, it is unreliable to determine the control actions based on output prediction for a specific point of time in the future. As a result, predictions contain a series of future time instants about a target point given by the time delay values used.
The control actions are determined from the average of the series of predictions. This approach improves the control robustness against inaccuracies and variations in the time delays. Define the cost function J i as follows:
J  X  X  e i  X  k  X  2 = 2  X  X  r i  X  k  X  y i  X  k  X  2 = 2 o e  X  30  X  In this research, e is selected as 0.0036.

According to the steepest Descent method, k pi , k ii and k di are regulated as the following: k  X  k  X  X  k pi  X  k 1  X  Z p @ J i @ k k  X  k  X  X  k ii  X  k 1  X  Z i @ J i @ k k  X  k  X  X  k di  X  k 1  X  Z d @ J i @ k differential learning rate, which are Z p  X  0.09, Z i  X  0.25, and  X  0.15 in this research. q y i / q u i is the Jacobian information of
The experiments on real-time DAFDV system are performed under the following given conditions: the upstream and down-stream pressures are, respectively taken as [35,75] kPa and [25,65] kPa, the air volume flow rate is about 400 L/min (it is changed by the opening percentage of V2 and the frequency of the vacuum pump with adjustable flow rate in C4, when the upstream and downstream air pressures reach the steady state equilibrium, the air flow rate passing through each parts of the whole pressure control system can be considered as equal, thus the air volume flow rate is approximated as that of the vacuum pump with adjustable flow rate in C4, this air volume flow rate can calculated from the relationship between the frequency and flow rate of the vacuum pump).

Due to space limitations, only the experiment results are presented here when the upstream/downstream pressures are about 60 kPa and 50 kPa. (However, it should be noted that the decoupling control method can be expanded to other varying operating pressure ranges according to the practical demand).
First, two groups of experiments are carried out for the case of the upstream/downstream temperatures stepping from 13.5/ 14.5 1 C to 15.5/16.5 1 C. The results before decoupling (only tradi-tional PID controllers are used) are shown in Fig. 7 and Fig. 8 . Fig. 9 and Fig. 10 show the experiment results after decoupling (using the self-tuning PID decoupling control method). Fig. 8 and Fig. 10 are the local enlargement part of Fig. 7 and Fig. 9 , respectively.

Itcanbeseenfrom Fig. 7 that the transient oscillation process of the upstream air temperature is same as that of the downstream air temperature. However, Fig. 8 shows that the upstream air tempera-ture fluctuates along the downstream air temperature variation in the same direction and equal period with small delay, which indicate that the obvious interactions and dead-time between the two tempera-tures are exist. Furthermore, an unstable temperature output is observed due to effects of the time delays and the couplings between the two temperatures. Therefore, the independent, rapid and stable control of the DAFDV system is imp ossible to accomplish until the effects of coupling and time-delay are eliminated or reduced significantly.

Compared Fig. 9 and Fig. 10 with Fig. 7 and Fig. 8 , it is clearly found that: (1) both the upstream and the downstream air temperatures arrived at steady-state equilibrium about 1228 s and 1247 s late, respectively. (2) One air temperature no longer fluctuates with the other. (3) the two temperatures remain the set-value at the most time except the occasionally abrupt varia-tion, and the steady error of the two is 0.06 1 C, which indicate that the couplings caused by the time delay and the variation of the air flow rate are obviously decreased. This is because the three PID parameters of the self-tuning PID decoupling controller can be timely tuned with the variation of disturbance and thus the two temperatures are controlled independently. (4) In the steady-state controlling processes for the two temperatures, with the two temperatures reaching the steady states, the high-power heating and cooling equipments are shut off, and thus the two temperatures are subject to relatively small disturbances. In this case, the two temperatures showing like pulse signals are mainly determined by the resolutions of the temperature sensors and actuators.

In the practical application such as the simulation of dynamic atmospheric environments, calibration of meteorological instru-ments and research of humidity generation technology, another typical case that one temperature stepping from one state to another while the other temperature remain a constant value is often encountered. For this kind of typical case, two groups of experimental results for a case that the upstream air temperature decreases from 16.5 1 C to 14.5 1 C while the downstream air temperature keep in constant value (13.5 1 C) are shown in Fig. 11 and Fig. 12 . Fig. 11 and Fig. 12 show the experiment results before and after decoupling for the DAFDV system, respectively.

From Fig. 11 , it is clearly seen that the downstream air temperature hardly keep in the steady state with the rapid drop of the upstream air temperature during the initial stage (about 0 X 38 s). During the period from 0 s to 38 s, due to the existence of the delay, the downstream air temperature has no immediate descent with the rapid drop of the upstream air temperature. The effect of the upstream air temperature to the downstream air temperature reflects until 38 s late and the overshoot reach nearly 0.1 1 C. About 1600 s late, the downstream air temperature resumes reaching steady state. Similarly, these results fully indicate the control performance of the upstream and down-stream air temperatures are largely influenced by the couplings and time-delays.

Fig. 12 shows the deviation is only about 7 0.05 1 C and the settling times of the upstream and downstream air temperatures are shortened to 1450 s and 1200 s, the reason is that: (1) the outputs of the two temperatures are beforehand predicted by the prediction principle, and thus the actuators work in advance. (2) The self-tuning PID decoupling controller can timely adjust the parameters of the controller according to the disturbance to the downstream temperature, which make the controller operating in an optimum state.

From Fig. 12 , it also can be seen that: in the transient state (before about 1200 s), the downstream temperature varies with a relative large error limit around the operating point while its variation becomes small with the upstream temperature reaching steady state (about 1200 s late), this phenomenon may be caused by different external disturbances. In the transient state, the upstream high-power cooling equipments, which are still work-ing, lead to large disturbances to the sensors and actuators. With the upstream temperature reaching steady state, these high-power cooling equipments are shut off and accordingly the disturbances become small.

Above these results indicate the decoupling control method proposed in this paper is effective. 6. Conclusions
Based on the modified OIF Elman neural networks and the prediction principle, an adaptive PID decoupling controller is designed to achieve the rapid, precise and especially independent control for the upstream and downstream temperatures of the DAFDV coupling system. As for the two kinds of typical applica-tion cases of the DAFDV system, corresponding field experiments based on a real plant (the DAFDV system) are carried out. The experimental results show that the settling times of the upstream and downstream air temperature are notably decreased and most important of all is that one temperature no longer fluctuates with the other, which indicate that the proposed adaptive PID decou-pling control algorithm based on the modified OIF Elman neural networks and the prediction principle is an effective method to solve the time-delay, nonlinear DAFDV coupling temperature system.

