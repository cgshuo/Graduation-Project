 Sev eral statistical problems encoun tered in real w orld appli-cations app ear to b e sp eci c instances of a general frame-w ork based on h ybrid P oisson mo dels. Restating these prob-lem in this framew ork allo ws us to dra w up on a large n um ber of statistical analysis tec hniques and suggests a v ariet yof al-gorithms whic hpro vide new and more robust metho ds for analysis. In particular, w e dev elop a new metho d for detect-ing b eha vioral c hanges of a class of sto c hastic pro cess. One of the ma jor c hallenges in data customer b eha vior man-agemen t is predicting consumer b eha vior and when a par-ticular consumer is lik ely to switc h to another beha vioral pattern. Consider for example the case of a credit card holder. In general, the card holder will ha v ea fairly pre-dictable purc hasing statistics, e.g., v e transactions a w eek. If ho w ev er, the card holder gets a new card, the rate of using the card is lik ely to b e impacted e.g. the purc hase rate migh t drop to sa y 2 transactions aw eek. Early detection of the switc hing in consumer b eha vior allo ws the original service pro vider to activ ely in terv ene and try to win the customer bac k. F or example, a credit card issuer migh t send the card holder new incen tiv es, frequen t ier program and other pro-motional items. Ho w ev er, a k ey issue in trying to win the customer bac k is timely in terv en tion and detection of the change p oint . If the service pro vider w aits for to o long, it migh tbe to late to win the customer bac k. On the other hand, the service pro vider do es not w an t to prematurely in-terv ene with a customer who sho ws no sign of beha vioral changes since this w ould result in higher op erating exp enses and more imp ortan tly migh t div ert resources from border line accoun ts.
 Another area where early detection of the switc hing in b e-ha vior pro vides added v alue is in the analysis of consumer mark et data.In general, the consumer will ha v e a fairly pre-dictable purc hasing statistics, e.g., a college studen tmigh t ha v ean a v erage of one transactions a w eek at a restauran t, one transaction a w eek at gas station, and t w o transactions ay ear at the departmen t store. When the studen t gradu-ates and is emplo y ed the b eha vior migh tc hange to sa yt w o transactions a w eek at a restauran t, tw o transactions a w eek at a gas station and t w o transactions a mon th at the depart-men t store. If this c hange is detected, an opp ortunit y exists for cross-selling other services e.g., car loan, credit card, etc. Detection of the switc hing in the b eha vior of cellular telecom-m unication subscrib ers can pro vide an ecien t metho d for detecting fraud [3]. The subscrib er will ha v e a fairly sta-ble calling pattern, e.g., an a v erage of v elocal calls, and tw o long distance calls a da y .In case of fraud, the calling rates migh tc hange to sa yt w o lo cal calls and nine long dis-tance calls. If this c hange in calling rates is detected early , the phone compan y can tak e action to insure that the calls w ere legitimate or to deactiv ate the cellular phone. Another application of switc hing detection is in the area of net w ork in trusion detection [3].
 In all these cases, the observ ed data consist of individual activities whic h happ en at particular times during a sp ec-i ed p erio d of observ ation. Th us the observ ation consists of a total observ ation time, t , the total n um ber of sym bols observ ed, n , and an n -long sequence of sym b ol/time pairs ( 1 ;t 1 ) ::: ( n ;t n ).
 At ypical metho d for approac hing these problems is to re-duce the observ ations to coun ts for eac h di eren t kind of sym b ol. This reduction results in a sequence of coun ts k whic h is as long as the size of the v o cabulary from whic hthe sym b ols are dra wn. These coun ts can then b e analyzed using con tingency table metho ds suc h as log-lik eliho o d ratio tests [2], term w eigh ting metho ds [6] or reduced dimensional term w eigh ting metho ds [1]. Unfortunately , none of these tec h-niques mak ean y use of the a v ailable temp oral information. None of these tec hniques could, for instance, distinguish b e-tw een t w o fair coins, one ipp ed at an a v erage rate of once p er second and another ipp ed at an a v erage rate of once p er min ute. There is a di erence b et w een t w osuc h coins, of course, and if our goal is to discriminate b et w een them, then w e m ust pa y atten tion to the temp oral information since that is the only di erence that w e will b e able to dis-cern.
 In [3], F a w cett and Pro v ost use uniform pro ling to detect change poin ts. A large n um ber of hand-tagged reference data ev en ts are compiled and used to train a regression mo del. F or example, in a telephone fraud detection appli-cation, transactions are tagged as fraud or no fraud. These transaction are then used to train a regression mo del e.g., a neural net w ork or a classi cation tree. The input v ari-ables used to train the mo del could b e ra w transaction data e.g., the duration of the call or deriv ed v ariables computed from the transaction data. In order to determine if a new transaction is fraudulen t, the ra w data are rst used to com-pute deriv ed v ariables whic h are then used b y the regression mo del to compute a ra w score. If the ra w score is ab o v ea certain threshold the transaction is classi ed as fraudulen t otherwise the transaction is classi ed as no fraud [3]. While this approac h b een used in real w orld applications it has a n um ber of short coming. The rst dra w bac k of this ap-proac h is that the transactions of eac huser are compared to a pro le built using transactions of all users. Another dra w bac k of this algorithm is its p erformance in detecting rare ev en ts. A third dra w bac k of this approac h is that the transactions are often hand tagged whic h could result in a considerable dela y from the time the fraudulen t transaction is committed to the time the transaction is used to build the mo del.
 Another related approac hw as recen tly presen ted b yb y Gurlaink e.t. al. [4]. Gurlaink address the same problem addressed b y this w ork, namely dev eloping a general approac hto c hange p oin t detection. The approac h adopted b y Gurlaink divides the time series of in terest in to t w odisjoin t sets T 1and T 2. A function from a set of candidate p olynomial functions are used to t the t w o subsets T 1and T 2 as w ell as the original time series T . The criteria used to select the tting function is a go o dness of t criteria. If the data is b etter tted b y t w o p olynomials, a c hange p oin t is declared. The algorithm is then applied recursiv ely on the t w o new segmen ts T 1 and T 2. While this approac hhas a n um b er of desirable features, it is b etter suited for deterministic data with a small amoun t of random noise. It do es not ho w ev er, handle the case where the data is generated b y a sto c hastic pro cess e.g., n um ber of phone calls a customer mak es eac hw eek.
 In a large n um ber of practical applications, the observ ed data can be mo deled b ya P oisson pro cess. Mo deling the data b ya P oisson pro cess allo ws us to handle a wide range of sto c hastic pro cess of practical in terest. In addition, mo d-eling the data b ya P oisson pro cess allo ws us to analyze an observ ed data sequence b y analyzing its generativ emodel. Generativ emodelsha v e b een used in discriminativ e classi-ers [5] and can b e used to compare t w o observ ed data sets b y comparing their generativ e mo dels. In addition, gen-erativ e mo dels allo w us to dra w up on a large n um ber of statistical analysis tec hniques. One suc h tec hnique is the log-likleho o d ratio tec hnique [2]. In this pap er, w e com-bine generativ e mo dels with log-likleho o d ratio tec hniques to pro vide a robust tec hnique that can capture the temp oral nature of the data. These tec hniques are also more robust to lo w coun ts and can b e used in situations where traditional tec hniques suc has 2 test can not b e used.
 This pap er is organized as follo ws: In Section 2w egiv ean o v erview of the log-lik eliho o d metho d,presen t a mathemati-cal mo del of the Hybrid P oisson pro cesses and giv e a formal description of the problem addressed b y this w ork. In sec-tion 3w edev elop an algorithm for c hange p oin t detection based on log-lik eliho o d and compare the p erformance of our algorithm to a p erfect kno wledge reference. Finally , in Sec-tion 5, w e giv e our conclusion and directions for future w ork. The con tributions of this pap er are: Consider the case of a sym bolic v ariable A that w as observ ed A 1 times out of a total T 1 observ ations in pro cess P 1 and A times out of a total T 2 observ ations in class P 2 . W e p ose the follo wing question: Did the same binomial pr o c ess gener ate the symb ol Ainb oth class or wher e they gener ate d by two dif-fer ent pr o c esses? This question can b e form ulated in terms h yp othesis testing. In this case, the n ull h yp otheses H that the same pro cess generated both A 1 and A 2 and the alternate h yp othesis H 1 is that the observ ations w ere gener-ated b yt w o di eren t pro cesses. If the n ull h yp othesis is true, the probabilit y of observing A 1 + A 2 is p ( A 1 ;A 2 j p and the maxim um lik eliho o d estimate of the parameters of the P oisson pro cess is giv en If ho w ev er, the n ull h yp othesis is not true, the probabilit y of observing A 1 and A 2 observ ations is giv en b y where the maxim um likleho o d estimates are giv en b y The closer the probabilities p ( A 1 ;A 2 j p A 1 ;p A 2 ) and p ( A the more lik ely the n ull h yp othesis. Con v ersely , the test for the likeliho o d of the n ull h yp othesis can b e form ulated as the ratio of the log of t w o probabilities to giv e AP oisson distribution de nes the probabilit y p ( k j t )that k ev en ts are observ ed in an y p erio d of time t long. The P oisson distribution is de ned suc hthat then um ber of ev en ts that app ear in disjoin t p erio ds of time are indep enden t and suc h that lim t 0. The indep endence constrain t has the consequence that p ( k 1 + k 2 j t 1 + t 2 )= p ( k 1 j t 1 ) p ( k 2 j t 2 discrete con v olution o v er the non-negativ ein tegers.The nal result, giv en here without pro of is F romthisitis relativ ely easy to determine that the maxi-m um lik eliho o d estimator for is the v ery natural k=t . If w e observ et w oP oisson pro cesses and note that the rst has k 1 ev en ts in time t 1 and the second k 2 ev en ts in time t then w e can use the follo wing generalized log-lik eliho o d ra-tio test statistic to test for the h yp othesis that b oth P oisson pro cesses ha v e the same parameter : where ^ =( k 1 + k 2 ) = ( t 1 + t 2 ) and ^ i = k i =t i constan t whic h do es not dep end on the parameters 1 ; 2 If the n ull h yp othesis is true, then this statistic will be 2 ( m 1) distributed. This same form ula can also b e gen-eralized to the case of m P oisson pro cesses simply b yletting i range o v er 1 :::m . The n ull h yp othesis in the case of m P oisson pro cesses is that the observ ations w ere generated b y the same P oisson pro cesses. Consider a time series denoted b y y ( t ) ;t 2 [ t 0 ;T ]where t is a time v ariable. W e assume that the time series y ( t )w as generated b y Hybrid P oisson Pro cess. In addition,w ew an t to test the h yp othesis that y ( t ) has a c hange p oin t m 2 [0 ;T ] and that the observ ations w ere generated b yt w o pro cess. In order to compute the c hange p oin t, w e rewrite Equation 8as F or eac hv alue of m Equation 9 splits the time series in to a time series [ t 0 ;t ] and the time series ( t; m ] ;t m and computes the 1 ratio that the t w o time series w ere generated b y the same P oisson pro cess.
 Figure 1 sho ws the v alue of the test statistic for a P oisson pro cess that w as generated with t = 1 ;t 2 (0 ; 10) and t =3 ;t 2 (10 ; 20). The curv e m =6 represen ts the test statistic computed at time 6 where the x axes represen ts the time and the y axes represen ts the v alue of the test statistic at this time giv en all information up to time 6. Curv es m =15 ;m = 20 represen t the test statistic computed with information up to times 15 and 20 resp ectiv ely . Note that at m = 15, the test statistic reac hes its maxim um v alue at time t = 10. As more information b ecomes a v ailable, the time at whic hthe test statistic reac hes is maxim um v alue remains unc hanged.
 In view of the ab o v e discussion and Figure 1, w e prop ose to detect c hanges in P oisson pro cesses b y computing the maxim um of test statistic and declaring a c hange p oin twhen the test statistic exceeded a certain threshold. W e select the threshold suc h that the probabilit y of a false p ositiv eis belo w a certain v alue e.g. 5%.
 Figure ?? sho ws the Cum ulativ e distribution function for the test statistic computed b y Equation 9 of 100,000 P ois-son pro cesses. The distribution whic h has a log normal lik e distribution, can be used to compute the threshold score corresp onding to sp eci c false p ositiv e rate. A maxim um test statistic greater than 7 indicates that w e can accept the n ull h yp othesis with only 10% con dence. A score of 8.23 indicates that w e can accept the n ull h yp othesis with 5% con dence. Going bac k to Figure 1, w e can see that at m = 15, w e can declare a c hange in the P oisson at time t = 10 with 90% con dence. Also note that t time t =2, w e w ere able to correctly attribute the observ ed c hange in the rates of the P oisson pro cess to c hance and did not declare a c hange p oin tat t =2 ev en though w e had t w o observ ations separated b ya v ery short time.
 In order to ev aluate our mo del, w e need to compare its p er-formance to a reference system. Of particular in terest, is a p erfect kno wledge reference for whic hw eha v e p erfect kno wl-edge of a subset of parameters that are not kno wn to our mo del. In the case of P oisson pro cess, an example of a p er-fect kno wledge reference is when the c hange time is kno wn and w e are in terested in v erifying the c hange with a cer-tain con dence e.g. at the the 90% con dence lev el. The rates of the P oisson pro cess can b e used to compute an ex-p ected v ector of observ ations in a n um ber of in terv als after the c hange p oin t, E T . This is compared to the actual v ector of observ ations after the c hange p oin t O T using a 2 test. where i is the n um ber of in terv als . In this case, the test statistic per f ect has a 2 distribution and w e can use stan-dard tables to compute the con dence.
 Figure 3 sho ws the v alue of the test statistic for a P ois-son pro cess that w as generated with t =1 t 2 0 ; 10 ; t 3 t 2 10 ; 20 . A ttime m =14 : 627, the LLR metho d detected that the time series had a c hange at t =13 : 7374 with 90% con dence. The time at whic h the c hange o ccurred w as con-rmed b y computing the c hange p oin tat m = 20. By com-parison, a 2 test detected the c hange p oin tat t =15 : 4945 with con dence lev el %90. W e applied our algorithm to analyze retail data from a de-partmen t store. Our data included transaction data for a period of t w oy ears. T able 1 sho ws the detection times as w ell as the actual c hange times for the rst 10 customers that w ere iden ti ed as c hanging their shopping beha vior computed using the LLR metho ds at the 90% con dence lev el. W e did not use the 2 test since with an a v erage in-ter arriv al time of 66 : 59 da ys, it w ould tak e ab out one y ear to observ e v epurc hases and another y ear to compute the exp ected purc hases.
 In order to in v estigate the p erformance of our metho d, w e pic k ed a customer at random and studied that customers beha vior. Consider for example customer 6, with purc hase of the customer slo ws do wn after t = 7 and pic ks up at t =61. Due to the lo wn um b er of coun ts, w e can not detect the c hange at t = 7 with 90% con dence. Ho w ev er, w ecan detect the c hange at t = 61 with 90%. In this pap er w e presen ted a new algorithm based on log lik eliho o d ratio for c hange p oin t detection for a large class of real w orld problems. The approac h presen tedinthisw ork address a n um b er of short comings of other approac hes in-cluding its abilit y to deal with rare ev en ts. In addition, the w ork presen ted in this pap er pro videsav ehicle for individual discrimination as compared to the uniform discrimination approac hemplo y ed b y con v en tional systems. This pro vides a new lev el of p ersonalization. The utilit y of this approac h w as demonstrated b y comparing it to a p erfect kno wledge reference system. It w as sho wn that the log lik eliho o d ratio test out p erformed a p erfect kno wledge system. The author w ould lik eto thank T ed Dunning for his help with w ork. In particular, T ed w as resp onsible for pioneering this w ork while at eHNC. [1] W. R. Caid, S. T. Dumais, and S. I. Gallan t. Learned [2] T. E. Dunning. Accurate metho ds for the statistics of [3] T. F a w cett and F. Pro v ost. Activit y monitoring: [4] V. Guralnik and J. Sriv asta v a. Ev en t detection from [5] T. Jaakk ola and D. Haussler. Exploiting generativ e [6] G. Salton and M. McGill. Intr o duction to Mo dern
Customer Num ber
