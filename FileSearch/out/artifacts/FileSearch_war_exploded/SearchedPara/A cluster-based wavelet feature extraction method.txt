 1. Introduction
Over the past few decades, we have witnessed a substantial interest in the development of feature extraction techniques, which has been motivated largely by the need for addressing pattern recognition and image processing problems. Selecting features that can effectively classify patterns is often a nontrivial task in many applications. Due to its excellent properties of time X  frequency localization and adaptive multi-scale decomposition, the two-dimensional (2-D) discrete wavelet transform (DWT) proposed by Mallat (1989) has been applied extensively for feature extraction for image processing applications. A 2-D DWT can be viewed as an image filtered by a series of band-pass filters at different scales into a set of independent spatially oriented frequency channels. The image features are then extracted from the decomposed sub-images in different frequency channels and different resolution levels. Chen and Kuo (1993) proposed a tree-structured wavelet transform for texture classification. They used an energy criterion to select the sub-image for decomposition. A set of textural features was derived from the energy values of the dominant channels, and certain distance measures were then employed to discriminate between the texture classes. Lambert and Bock (1997) proposed a feature extraction approach for texture defect detection. The textural features were derived from the wavelet packet decomposition coefficients. Arivazhagan and
Ganesan (2003) applied DWT for a set of texture images, and extracted both statistical features and co-occurrence features. It was found that the texture classification rate is significantly improved by combining wavelet-based statistical and co-occur-rence features. The wavelet-based feature extraction methods were also applied to industrial material inspection such as LSI wafers (Lee et al., 1997; Maruo et al., 1999) , cold rolled strips (Sari-Sarraf and Goddard, 1998) , woven fabrics (Tsai and Huang, 2003) , and copper clad laminate defects (Li, 2009).

It is obvious that all these wavelet-based image processing and analysis techniques benefit from the collective information extracted from the different frequency channels involved (Scheunders, 2003) . Nevertheless, in most wavelet-based feature extraction methods the patterns within a frequency channel are assumed to be uniform. Such simplistic treatment of patterns ignores the details that lie within the boundaries of a frequency channel. Therefore, these classical feature extraction methods might not have enough discriminating ability to deal with the images with complex shapes, irregular texture, and a wide variability within the same class of patterns.

In previous work (Pittner and Kamarthi, 1999) , we developed a new cluster-based feature extraction method for signals based on one-dimensional discrete wavelet transform, and verified the effectiveness of the method on a flank wear estimation problem in turning processes and on a lung sound classification problem.
In this paper, we extend the idea of cluster-based feature extraction from a one-dimensional signal to 2-D images. In this context, we develop a new clustering scheme that divides the matrices of computed 2-D wavelet coefficients into clusters at each scale. The energy of each of these clusters is treated as a feature that contains an useful piece of information about the image. The feature vector of an image thus computed serves as input pattern to a neural network for image classification. The results from the applications on texture classification and wood surface defect detection show that the discrimination perfor-mance obtained with the proposed cluster-based method is superior to that obtained using just channel energies from the standard matrices of 2-D wavelet coefficients.
 wavelet transform for image analysis and then introduce the proposed wavelet-based clustering method in Section 3. Sections 4 and 5 demonstrate the effectiveness of the proposed method by applications on texture classification and wood surface defect detection, respectively. 2. 2-D discrete wavelet transform denote the set of integers and R the real numbers. Let  X  V a separable multi-resolution approximation of L 2 ( R 2 ), and let the one-dimensional wavelet associated with the scaling function f ( x ), then the 2-D separable wavelets can be defined as c 1 ( x , y )= f ( x ) c ( y ), c 2 ( x , y )= c ( x ) f ( y ), and c any wavelet decomposition scale J 4 0, an image f ( x , y ) can be completely represented by the hierarchy of 3 J +1 discrete images f A 2 J f ; D 1 2 j f ; D 2 2 j f ; D 3 2 j f ; 1 r j r J g , where
A 2 j f  X  m ; n  X  :  X  X  f  X  x ; y  X  f 2 j  X  x ; y  X  X  X  2 j m ; 2 wavelet representation in two dimensions (Mallat, 1989) .The wavelet decomposition of an image can then be interpreted as a set of independent, spatially oriented frequency channels. The schematic of 2-D wavelet decomposition for an original image is shown in Fig. 1 , where the maximum decomposition scale J is taken to be 3 for simplicity in this illustration. It can be seen that the original image is decomposed into a pyramid structure composed of a smooth image frequency details in the vertical, horizontal, and diagonal directions, respectively, at resolution 2 j ( j =1,2,3).Duetotheorthogonalityof this representation, the total number of coefficients in this new representation is equal to the number of coefficients in the original image. 3. A new clustering scheme for feature extraction
In this section, a novel clustering method for extracting features from the 2-D wavelet coefficient matrix of each frequency channel is introduced. The 2-D wavelet coefficients of each matrix are segregated into clusters in unsupervised mode by using a set of representative images that are specific to a given application. In a practical situation, this set of representative images can be the same as the ones kept aside for training the image classifier (e.g., a neural network). The following subsections describe the cluster formation method. The procedure proposed in this section divides each of the wavelet transform coefficient matrices into disjoint clusters U 1 , U 2 , y , U c ; from each of these clusters a single robust feature u i ( i =1,2, y , c ) is computed. The so obtained feature vector u 1 , u 2 , y , u c is considered the compact representation of the image from which these features are extracted; it serves as input patterns to an image classifier, such as a neural network. 3.1. Binary matrices for cluster determination
To determine the clusters, the proposed method uses a set of K images that represent the whole spectrum of possible types of images specific to an application.

First, the complete 2-D discrete wavelet transform is com-puted for all K representative images. As shown in Fig. 1 , an image can be completely represented by 3 J +1 coefficient matrices f A J f ; D 1 2 j f ; D 2 2 j f ; D 3 2 j f ; 1 r j r J g . The matrices
SD
SD
SD are constructed as the sum of the corresponding wavelet images. For any matrix A , we denote the sample mean and standard deviation of the elements of the matrix by m ( A ) and s ( A ), respectively. Then, we construct the matrices
G and expect the elements of each matrix G p distributed by the central limit theorem (Pittner and Kamarthi, 1999) . Applying a threshold of the form T 2 j :  X  with g Z e 2 ( e is the Euler X  X  number), to the elements of the matrices G p at each scale, we get the corresponding binary matrices
B j :  X  X  Y  X  G with the Heavyside function: Y ( x )=1 for x Z 0 and Y ( x )=0 for x o 0. We expect B p obtained by applying the thresholds T 2 j to the matrices G scale.

After we computed the binary matrices B p coefficient matrices of K representative images, we pass the binary matrices B p boundaries of the clusters. The clusters U 1 , U 2 , y , U Fig. 3 are determined once all the computed wavelet coefficients from each and every scale are labeled according to a scheme described in the next section. Here the clusters thus formed neither overlap across different scales nor cross the boundaries of different frequency channels. 3.2. Cluster boundary formation
The clustering procedure for the cluster boundary formation in each fixed binary matrix is illustrated in Fig. 4 . It has the following steps.

Step 1: Label each occurrence of 1 in the binary matrix with a unique label. For example, if there are three 1 scattered in the matrix, label them, say, as A, B, and C; in this example the matrix is eventually divided into three clusters, but the cluster bound-aries are determined using the process described in steps 2 and 3.
Step 2: Use the labeled 1 (e.g., A X  X ) as the  X  X  X eed centers X  X  to grow the clusters. In the first growth iteration, each seed center label is expanded by one cell to the left, one to the right, one to the top, and one to the bottom. Expansion in any direction is carried out only if the neighboring cell is 0; no expansion is carried out if the cell is either at the matrix boundary or if the neighboring cell is already labeled.

Step 3: Repeat the same growth pattern of labels until matrix has no more 0.

Step 4: Once all the 0 in the matrix are labeled, cluster boundaries are drawn respecting the homogeneity of the labels in each cluster. In other words, the boundaries are drawn at the interface of differently labeled clusters. 3.3. Feature extraction method
Through the procedure described in the previous subsections, the boundaries of the clusters U 1 , U 2 , y , U c are demarked. Using this boundary template the feature vector of an image is computed in three steps. In the first step, the 2-D DWT is applied to the image to obtain the matrix of wavelet coefficients. In the second step, it is divided into clusters U 1 , U 2 , y , U the cluster boundary template. In the third step, the image features u 1 , u 2 , y , u c are determined by simply computing the
Euclidean norm of the clusters u :  X 
In other words, each feature u i is determined as the square root of the energy of the wavelet coefficients in cluster U i . Consequently, the number of features, c , of an image is equal to the number of clusters determined with the method described in the previous section. 4. Application on texture classification
Texture analysis is a fundamental problem in computer vision and pattern recognition with a wide variety of applications such as remote sensing, medical image analysis, and quality inspection.
A critical issue in texture analysis is how to characterize textural structure and define a perceptually meaningful distance/similar-ity measure between textures. Despite extensive research work that has been in progress for a long time, this issue remains unresolved. In this section, we apply the proposed cluster-based wavelet feature extraction method for a texture classification problem. 4.1. Experimental data set
The 12 textures from the Brodatz album (Brodatz, 1966) that are shown in Fig. 5 are equalized to 256 256 pixels and 256 gray levels. Each image is divided into 16 disjoint 64 64 blocks, and each block is independently histogram-equalized to abolish luminance differences among textures. In addition, each original texture block is transformed into one additional block: a 64 64 scaled block obtained from the 45 45 pixels in the middle. The 12 texture categories included 384 blocks altogether. On half of these texture blocks are randomly selected for training the neural networks and the remaining blocks are used for evaluating the classification accuracy. The classification accuracy is evaluated on 10 different random selections of training data sets and tested on their complementary testing data sets. 4.2. Texture features and classification algorithms
Two sets of features, one based on the new clustering scheme and the other based just on the DWT, are extracted using the Haar wavelet transform at the maximum decomposition scale J =6. The texture images meant for training the neural networks are used to determine the cluster boundaries to form feature vectors u u . In this application, we obtained 28 clusters and hence 28 features using the proposed clustering scheme. We call this feature set F1.
Using the traditional DWT, we obtained 19 (=3 6+1) features that are computed by taking square root s of energy contents of frequency channels of the DWT. We call this feature set F2.

Two different neural network classifiers are used for generating the classification results. One is the Multilayer Perceptron (MLP) developed by Rumelhart and McClelland (1986) , which is the most popular network architecture in use today. The other one is the Probabilistic Neural Network (PNN) proposed by Specht (1990) . The original PNN is a direct neural network implementation of the
Parzen nonparametric probability density function estimation (Parzen, 1962) and Bayes classification rule; it has the advantages of rapid training and guaranteed convergence (Wesserman, 1993) . 4.3. Results
The evaluation of the classification accuracy based on the proposed clustering scheme and the standard DWT feature extraction methods is presented in Table 1 . The results show that in most cases the classification accuracy based on feature set
F1 is better than that based on feature set F2. These results indicate that the proposed wavelet-based clustering scheme provides additional discriminatory information for texture classification. In the texture classification experiments, the results again indicate that the PNN generally gives better classification accuracy than the MLP. 5. Application on wood surface defect classification
In machine vision-based classification of wood defects, feature extraction is the main problem. Geometric features (Alapuranen and Westman, 1992) , texture-based features (Kim and Koivo, 1994) , and color-based features (Lampinen, 1994) have been applied with limited success for classifying wood knots. In this section, we investigate the effectiveness of the proposed feature extraction method described in the previous section for a problem
Wood knots are the most commonly encountered defects in wood industry and have a crucial role in sorting lumber. A knot is the hard, cross-grained mass of wood at the place where a branch joins the trunk of a tree. Knots of the same kind may occur in different sizes, shapes, and orientations. Some examples of five wood knots are shown in Fig. 6 . 5.1. Experimental data set
The color images of five types of wood knots are extracted from an image database (Machine Vision Group, 2004) .We transformed all the images into the format of 64 64 pixels with 8 bit/pixel gray level. From a total of 329 wood knot images, we used 264 images for training the neural network classifiers and 65 for evaluating the classification accuracy. 5.2. Wood knot image features and classification algorithms
One of the main objectives of this study is to demonstrate how the proposed feature extraction method improves the texture classification accuracy relative to the methods that use little more than the DWT. Two sets of features, one based on the new clustering scheme and the other based just on the DWT, are extracted using the Haar wavelet transform at the maximum decomposition scale J =6. The wood knot images from the training set are used to determine the cluster boundaries to form feature vectors u 1 , u 2 , y , u c . Coincidentally, we obtained 28 features in feature set F1 and 19 features in feature set F2 just like in the previous application. The PNN and the MLP are again used for the wood knot image classification experiments. 5.3. Results
The evaluation of the classification accuracy for the wood knot detection experiments is presented in Table 2 . Both feature sets,
F1 and F2, based on a standard DWT feature extraction method, are used as input vectors to the MLP and PNN neural networks for classification. The results show that the overall classification accuracy based on feature set F1 is better than that based on feature set F2. The results also indicate that the PNN generally gives better classification accuracy than the MLP in the wood knot detection experiments as well. 6. Conclusions
In this paper, we presented a new clustering scheme based on the 2-D discrete wavelet transform, which especially deals with the classification problems using the features extracted from the wavelet coefficients of the images. The results from the applications on texture classification and wood knot classification have shown that the proposed wavelet-based clustering scheme can efficiently extract most of the problem-specific information content intrinsic in input images. The classification performance obtained with the pro-posed clustering scheme is superior to the performance obtained using just the energies of the standard 2-D discrete wavelet transform coefficients. The proposed method has a great potential for other image processing applications such as medical image analysis.
 Appendix References
