 1. Introduction
The water quality is a subject of ongoing concern. Deterioration of water quality has initiated serious management efforts in many countries. Most acceptable ecological and water related decisions are difficult to make without careful modeling, prediction and analysis of river water quality for typical development scenarios. Accurate predictions of future phenomena are the lifeblood of optimal water resources management in a watershed. Computer science and statistics have improved modeling approaches for discovering patterns found in water resources time series data. Much effort has been devoted over the past several decades to the development and improvement of time series prediction models. One of the most important and widely used time series model is the autoregressive integrated moving average (ARIMA) model (Shahwan and Odening, 2007 ).

Over the past several years, nonlinear models have been proposed as alternative techniques, as i.e. in Pisoni et al. (2009), real-life time series are extremely complex to be modeled using simple approaches especially when high accuracy is required.
There have been several studies suggesting hybrid models, combining the ARIMA model and neural networks. Su et al. (1997) used a hybrid model to predict a time series of reliability data with growth trend. Their results showed that the hybrid model produced better predictions than either the ARIMA model or the neural network by itself. Zhang (2003) proposed a hybrid
ARIMA and ANN model to take advantage of the two techniques and applied the proposed hybrid model to some real data sets. He concluded that the combined model can be an effective way to improving predictions achieved by either of the models used separately. Jain and Kumar (2006) proposed a hybrid approach for time series forecasting using monthly stream flow data at
Colorado river. They indicated that the approach of combining the strengths of the conventional and ANN techniques provides a robust modeling framework capable of capturing the nonlinear nature of the complex time series and thus producing more accurate forecasts.

ARIMA model and neural network backpropagation model, is developed to predict water quality time series data. The use of combined models in water quality time series data could be complementary in capturing patterns of data sets and could improve the prediction accuracy. The motivation behind this hybrid approach is largely due to the fact that a water quality problem is often complex in nature and any individual model may not be able to capture different patterns equally well. The objectives of the present study are to: (1) develop a hybrid model, an ANN and an ARIMA model, to predict water quality time series data, (2) assess the performance of each modeling approach using observed data versus predicted data and (3) evaluate the predictive performance of hybrid model in comparison to ANN architecture and ARIMA model using accuracy measures. 2. Materials and methods 2.1. Study area and water quality data country, is located in southwest Turkey and it drains a total area of 25,000 km 2 into the Aegean Sea ( Fig. 1 ). Annual rainfall ranges between 350 and 1000 mm and total mean annual evaporation, measured by Class A pans, is 2122 mm. Precipitation occurs s is the seasonal differencing operator, z t is the observed value at time point t , y is the MA operator of order q , Y is the seasonal MA parameter of order Q and a t is the noise component of the stochastic model assumed to be NID(0, s 2 ).

The ARIMA modeling approach involves the following three steps: model identification, parameter estimation, diagnostic checking. Identification of the general form of a model includes two stages: (1) if it is necessary, appropriate differencing of the series is performed to achieve stationary and normality; (2) the temporal correlation structure of the transformed data is identified by examining its autocorrelation (ACF) and partial autocorrelation (PACF) functions ( Mishra and Desai, 2005 ). The ACF is a useful statistical tool that measures if earlier values in the series have some relation to later values. PACF is the amount of correlation between a variable and a lag of itself that is not explained by correlations at all low order lags. Considering the ACF and PACF graphs of water quality concentration series, different ARIMA models are identified to model selection. The model that gives the minimum Akaike Information Criterion (AIC) is selected as the best fit model. The mathematical formulation for the AIC is developed as AIC  X  n  X  ln  X  X  2 p RSS  X  = n  X  X  1  X  X  2 m  X  2  X  where m =( p + q + P + Q ) is the number of terms estimated in the model and RSS denotes the sum of squared residuals.

After the functions of the ARIMA model have been specified, the parameters of these functions must be estimated. Once an appropriate model is chosen and its parameters are estimated, the Box X  X enkins methodology requires examining the residuals of the model to verify that the model is an adequate one for the series. Several tests are employed for diagnostic check to determine whether the residuals of the selected ARIMA models from the ACF and PACF graphs are independent, homoscedastic and normally distributed. If the homoscedasticity and normality assumptions are not provided, the observations are transformed by a Box X  X ox transformation ( Wei, 1990 ). For a good forecasting model, the residuals, left over after fitting the model, must satisfy the requirements of a white noise process (uncorrelated and normally distributed around a zero mean). In order to determine whether water quality time series are independent, the residual auto-correlation (RACF) function of the series is studied. There are several useful tests related to RACF for the independence of residuals. The first one is the correlograms drawn by plotting the residual ACF function against lag number. If the ARIMA model is correct, the estimated autocorrelations of the residuals are uncorrelated and distributed approximately normally about zero. The second one is Ljung X  X ox X  X ierce statistics. In order to test the null hypothesis that a current set of autocorrelations is white noise, test statistics are calculated for different total numbers of successive lagged autocorrelations using the Ljung X  X ox X  X ierce statistics ( Q(r) test) to test the adequacy of the model. Q(r) values are compared to a critical test value ( w 2 ) distribution with respective degree of freedom at a 5% significant level. The third one is the cumulative periodogram, employed to diagnose the residuals for a white noise sequence. When modeling seasonal time series line the one in the present study, the periodic characteristics of water quality concentration time series might not be taken into account, therefore, the periodicities in the residuals should be investigated ( El-Din and Smith, 2002 ). 2.3. Structure of neural network model
Among many neural network architectures, the three-layer-feedforward back propagation network is the most commonly used ( Haykin, 1999 ). This network architecture consists of one hidden layer of neurons with nonlinear transfer functions and an zigzag path to the minimum, typical for a steepest gradient descent method ( Falas and Stafylopatis, 2005 ). A conjugate gradient algorithm avoids the zigzag approach to the minimum point by incorporating a special relationship between the direction and gradient vector at each iteration. If D k represents the direction vector at iteration k of the algorithm, then the weight vector is updated according to the rule the objective function as much as possible needs to be found.
After a small number of iterations, the search along the line direction to find the optimum step size for the actual minimum should stop. Estimating the optimum step size with scaled conjugate gradient (SCG) training algorithm increases the learning speed and eliminates the dependence on critical user-selected parameters. The main idea behind the algorithm is the use of a factor r which is raised or lowered within each iteration during the execution of the algorithm, looking at the sign of the quantity d k , which reveals if the Hessian matrix is not positive definite. A brief algorithm of SCG in neural network is given as follows ( Falas and Stafylopatis, 2005 ). 2. If success=true, then calculate second order information: 4. If d k r 0 then make the Hessian positive definite 6. Calculate the comparison parameter c k : c k  X  2 d k b f  X  W k  X  8. If c k Z 0 : 25 then increase the scale parameter to r k  X  r k  X  9. Repetition: If the steepest descent direction G k a 0 ; set k 2.4. Hybrid model by stand-alone models because water quality time series data could include a variety of characteristics such as seasonality, heteroskedasticity or a non-Gaussian error. The approximation of
ARIMA models to complex nonlinear problems may not be adequate. On the other hand, using ANNs to model linear problems have yielded unsatisfactory results. Zhang (2003) indicated that it is not wise to apply ANNs blindly to any type predictor as the model, a perfect fit and a better predictor than the model, respectively ( Palani et al., 2008 ). Decision makers can decide whether the predictability of the ANN model is accurate enough to make important decisions regarding to data usage depending on the mismatch between the forecasted water quality parameters and that measured. 3. Results and discussion 3.1. ARIMA modeling
In the present study, several trails were made to choose the optimal ARIMA model parameters. The model parameters that satisfy the statistical residual diagnostic checking were chosen in the ARIMA forecasting model. The ARIMA models were used to predict monthly water quality time series over the period between 1996 and 2004. The water quality data for the period between 1996 and 2001 were used for model calibration and to obtain the best model fit for each water quality parameter. The data for the period between 2002 and 2004 were used for model verification and comparisons for prediction purposes. In the ARIMA modeling process, the input and output water quality data sets for each parameter were normalized to the range of [0, 1].

To fit ARIMA model to the available water quality time series data, three-stage procedure of model identification, estimation of model parameters and diagnostic checking of the estimated parameters was employed. In the identification stage, to deter-mine the possible persistence structure in the time series data, the autocorrelation function (ACF) and the partial autocorrelation function (PACF) were used. Using Akaike Information Criteria (AIC), the best fitted model has been identified out of the various competing models. As demonstrated in Table 2 , the seasonal components ( P , D , Q ) of best fit ARIMA models are (0, 0, 1) for water temperature, (0, 1,1) for boron and (1, 0, 0) for dissolved oxygen. The nonseasonal components ( p , d , q ) are (1, 1,1), (1, 0, 1) and (1, 1, 0) for water temperature, boron and dissolved oxygen, respectively. The AICs for the best fit ARIMA models are 478, 126.3 and 192.1 for water temperature, boron and dissolved oxygen, respectively ( Table 2 ). In the estimation of model parameters stage, the best fit ARIMA model statistical parameters were estimated. The computational method outlined by Box and Jenkins (1976) was employed to estimate model parameters. In the diagnostic checking of the estimated parameters stage, diagnostic checks were done to insure that the best fit model was selected by checking that assumptions of ARIMA modeling such as independence, homoscedastic (constant variance) and normality of the residual a t were satisfied. In order to check the independence of residuals, the residual autocorrelation function (RACF), Ljung X  X ox X  X ierce statistics and cumulative periodograms were used. The values of residual autocorrelation functions (RACF) were well settled within confidence limits except very few individual correlations appear large compared to the confidence limits, which were acceptable normal probability plot of residuals were investigated and they clearly supported the assumption of normality. In order to investigate homoscedasticity of the residuals, a plot of residuals versus fitted values were examined and the plots showed a random scatter around zero. In other words, the residuals were evenly distributed around mean, which explains the models were adequate.
 data set for the period of 36 months. As shown in Fig. 3 , although the ARIMA models generally vary with the range of most of the water quality data, the model predictions are not quite satisfied.
The correlation coefficient values between models predicted values and observed data for boron, dissolved oxygen and water temperature are 0.483, 0.507 and 0.742, respectively, which are not satisfactory in common model applications ( Fig. 4 ). Although the ARIMA models were able to show the cycles of the high and low water quality values in a year, they were not able to provide good predictions of the water quality value magnitudes, which changed from month to month. This limitation was due mainly to the limitations of the linear modeling algorithm in the ARIMA model, the performance of which was generally not quite satisfactory in recognizing and reproducing the nonlinear time series of water quality data. of 0.001 ( Fig. 5 b). By comparing model predictions with observations, model parameters (weights) were calibrated. It takes 100 epochs for the neural network model to reach the required training goal of 0.001 for water temperature data (Fig. 5 c). These results indicate that the ANN model can be trained to adjust model weights so that the model predicted water quality parameters match well with observed data.

In the model verification phase, the trained network was used to predict the monthly water quality parameters. Fig. 6 compares the model predictions for water quality parameters with the observations. The verifications stage indicate that the model prediction results reasonably match the observed water quality parameters. The correlation coefficient between the ANN model predicted values and observed data for boron, dissolved oxygen and water temperature are 0.885, 0.878 and 0.896, respectively, which are satisfactory in common model applications ( Fig. 7 ). These results indicate that the neural network model is able to recognize the pattern of the water quality parameters to provide good predictions of the monthly variations of water quality data of the B  X  uy  X  uk Menderes river. 3.3. Hybrid modeling
The proposed algorithm of the hybrid system consisted of two steps. In the first step, to analyze the linear part of the problem, an
Scaled boron data
Scaled d.oxygen data
Scaled temperature data 3.4. Comparison of model performances predicted data and observed data for the period of 36-months from the hybrid, ANN and ARIMA models were compared to determine the best performed model. The predicted water quality parameters using the ARIMA models were not found to be in reasonable agreement with the observed data. However, the hybrid and ANN approaches provided reasonable precision for all water quality parameters. Table 3 gives the error estimates of the three different approaches used in the study for predicting water quality parameters. The RMSEs between observed and predicted data were calculated in ARIMA models as 0.102 1 C, 0.165 and 0.113 mg l 1 for water temperature, boron and dissolved oxygen, respectively. In the case of ANN modeling approach, the RMSEs between observed and predicted data were computed as 0.048 1 C, 0.074 and 0.061 mg l 1 for water temperature, boron and dissolved oxygen, respectively. Applying the hybrid method, there were a decrease of 18.75%, 14.86% and 16.39% in the RMSE values of ANN for water temperature, boron and dissolved oxygen, respectively. Furthermore, the MAPEs between observed and predicted data for water temperature, boron and dissolved oxygen were appeared to be slightly lower for the ANN modeling approach. Prediction error statistics for the ANN approach produced MAPEs of 21%, 36% and 29% for water discharges of oxygen consuming substances like ammonia. The developed hybrid algorithm for boron constitute was able to recognize the pattern of the input data to provide good predictions of the monthly variations of boron content. Therefore, it can be concluded that the hybrid modeling approach can give more reliable predictions of water temperature, boron and dissolved oxygen time series of a river than the ANN and ARIMA modeling approach. 4. Conclusions
A new approach of modeling water quality time series, capable of exploiting the advantages of both the conventional methods and the ANNs, was proposed. An empirical comparative evalua-tion of the performance of hybrid model to the ANN and ARIMA modeling approach was presented for river water quality predic-tions. The proposed modeling framework gradually receives the data filtered using the ARIMA models and then the residuals from the ARIMA approach were analyzed by ANNs to capture the nonlinearity in the time series involved. Investigations were conducted to examine the hybrid model performance for predict-ing river water quality in monthly time steps. The results from the ARIMA models poorly represented the pattern of water quality data for boron and dissolved oxygen, but the model produced acceptable results for water temperature. The results from the ANN model were capable of providing accurate predictions of water quality parameters at the proposed time step. In the proposed hybrid model, an ARIMA model was used to analyze the linear part of the problem and then the residuals from the ARIMA model were modeled by using a neural network model. The results from the hybrid model indicated that the modeling approach gave more reliable predictions of water temperature, boron and dissolved oxygen time series data.

The predictions from hybrid model were compared with those obtained from the ANN and ARIMA traditional time series approaches. Owing to its ability in recognizing time series patterns and nonlinear characteristics, the accuracy measures RMSE, MAPE and NSC demonstrated that the hybrid model provided much better accuracy over the ANNs and ARIMA methods for water quality predictions. Therefore, the proposed hybrid algorithm can be used for the B  X  uy  X  uk Menderes river and other hydrometerologically similar rivers for predicting water quality data of monthly time step to detect water quality severity with respect to water temperature, boron and dissolved oxygen in future. The hybrid model developed for the B  X  uy  X  uk Menderes river can be employed for the development of a water quality emergency management plan so as to ensure sustainable water resources management in the basin.

