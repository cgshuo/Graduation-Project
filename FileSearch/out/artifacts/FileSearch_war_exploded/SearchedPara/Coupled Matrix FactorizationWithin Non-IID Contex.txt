 Recommender systems (RS) become increasingly important as they deeply involve our daily living, online, social, mobile and business activities. Typically, a set of users and items are involved, where each user u rates various items according to his/her respective preferences (embodied by preference rates) [ 12 ]. A new rate or item is then recommended to a user based on the rating behaviors of similar users on existing items.
 aggregated understanding of individual commonality. A rate is then predicted for a new item to a given user or a new user for a given item. The performance of applying such algorithms for real-time recommendation for specific users and items is often not very impressive. There are two important aspect that have not been considered thoroughly in RS. (1) The heterogeneity between users and between items, namely users and items are personalized and thus rating needs to be tailored according to individual characteristics. (2) The coupling relationships between users, between items, and between users and items, namely users and items are coupled and hence rating needs to capture the underlying interactions. These two aspects together essentially bring the recommendation problem to a non-IID context [ 4 ][ 3 ], namely users and items are not as independent and identically distributed (IID) as usually assumed in the existing RS. The existing RS algorithms and systems such as collaborative filtering and matrix factorization have been mainly built on the IID context, consequently they may overlook or may not fully capture the intrinsic heterogeneity and cou-plings. For example, many researchers try to influence or precisely estimate the mation of users and items for latent factor models. Nevertheless, most of the existing methods assume that the attributes are IID. This is a very fundamen-tal and critical issue for the RS community, as the big recommendation data in online, social, mobile and business applications is essentially non-IID. For example, a user X  X  preference may influence his/her friends, item attributes are Therefore in this paper, we deeply analyse the coupling relationships between users and between items based on their attributes, and incorporate the coupling interactions into MF to improve recommendation qualities.
 To illustrate the coupling relationships in RS, we give a toy example in Table 1 . There is a rating matrix consisting of three users and four movies with their attributes. Most existing CF methods utilize the rating matrix for recom-mendation but ignore the attributes of users and items. However, when the rating matrix is very sparse, the attributes within users and items may also contribute to solving the challenges. Specifically, we can infer the relationship of u from the  X  X ge X ,  X  X ipCode X ,  X  X ountry X  and  X  X ex X  attribute space. Similarly, we can get the movies X  relationship from the  X  X irector X ,  X  X ctor X  and  X  X enre X  attribute space. Intuitively, the existing similarity methods such as Pearson or Jaccard measures can be applied to compute the similarities within users or items, based on the IID assumption. In reality, however this assumption is not always held and there are more or less exist coupling relations between instances and attributes. One observation is that the similarity of two attributes values are dependent on other attributes, for example, two directors X  relationship is depen-dent on  X  X ctor X  and  X  X enre X  attributes over all the movies. This dependent relation is called the inter-coupled similarity between attributes. Alternatively, within an attribute, one attribute value will also be dependent on other values of the same attribute. Specifically, two attribute values are similar if they present the analogous frequency distribution on one attribute, which leads to another so-called intra-coupled similarity within an attribute. For example, two direc-tors  X  X corsese X  and  X  X oppola X  are considered similar because they appear with the same frequency. We believe that the coupled similarities between values and between attributes should simultaneously contribute to the relationships within users and within items, namely user coupling and item coupling. Incorporating the user coupling and item coupling into MF model may reach more satisfactory recommendations.
 interactions between different attributes by disclosing IID assumption. A com-plete consideration of couplings may provide a practical mean for enhancing the effectiveness of RS. Especially, if we do not have ample rating data, the objective user coupling and item coupling can be utilized to make recommendations. To date, our study is the first work to simultaneously consider the user coupling and item coupling based on their objective attributes, and integrate them together into the matrix factorization model.
  X  We propose a coupled measure to capture the relationships for users and  X  We propose a Coupled Matrix Factorization (CMF) model by accommodat- X  We conduct experiments to evaluate the superiority of couplings and the work. In Section 3, we formally state the recommendation and couplings prob-lems. Section 4 first analyses the couplings in RS, then details the coupled MF model integrating the couplings together. Experimental results and analysis are presented in Section 5. The paper is concluded in the last Section. advantage of user rating history to predict users X  interests. As one of the most accurate single models for collaborative filtering, matrix factorization (MF) is a latent factor model [ 8 ] which generally effective at estimating overall structure that relates simultaneously to most items. MF approach tries to decompose the rating matrix to user latent matrix and item latent matrix. Then the estimated rating is predicted by the multiplication of the two decomposed matrices. With the advent of social network, many researchers have started to analyse social recommender systems and various models integrating social networks have been proposed [ 20 ]. Social friendship is an outstanding explicit factor to improve the effectiveness of recommendation, however, not every web site have social or trust mechanisms. This explicit social gap greatly motivates us to explore the user and item couplings to improve recommendation qualities. Indeed, such couplings help to make reasonable recommendations when lacking valuable rating information. Content-based techniques are another successful methods which recommend relevant items to users according to users X  personal interests. Content-based methods often assume item X  X  attributes are independent which is not always have been proposed to handle the challenging issues. However, user couplings are item couplings are still not completely considered for RS. This motivates us to completely consider the non-IID couplings and integrate the user couplings and item couplings into the MF model. A large number of user and item sets with attributes can be organized by a triple S = &lt;S U ,S O ,h &gt; , where S U = &lt; U,A,V,f &gt; attribute space, U = { u 1 ,u 2 , ..., u n } is a nonempty finite set of users, { A , ..., A M } is a finite set of attributes for users; V = attribute values for users, in which V j is the set of attribute values of attribute A (1  X  j  X  J ), V ij is the attribute value of attribute A j for user f = lar value of each feature to every user. Similar to S U , expresses the items X  attribute space where O = { o 1 , ..., o V =  X  J j =1 V j , f =  X  M j =1 f j ( f j : O  X  V j ) are all for items. In the triple S = item o j for user u i . User rating preferences on items are then converted into a user-item matrix R , with n rows and m columns. Each element U = { u 1 ,u 2 ,u 3 } and four items O = { GodF ather, GoodF ellas, V ertigo, N byN W } A = { Age, ZipCode, Country, Sex } , V Australia ,and A = { Director, Actor, Genre } , V (
Vertigo )= T hriller ,and h ( u for computing the relationships assumed that the attributes are independent from each other. However, all the attributes should be coupled together and fur-an attribute A j , there is dependent relation between values While a value V li of an attribute A i is further influenced by the values of other attributes A j ( j = i ). For example, attributes A 1 , A influence the values of V 12 to V n 2 of attribute A 2 . In this section, we mainly introduce the coupled MF approach as shown in Fig. 2 . CMF first computes the user coupling and item coupling which integrate the coupled interactions based on the objective attributes. Then, user coupling, item coupling and users X  rating preferences are incorporated together into MF model. 4.1 User Coupling Users are non-IID, as users share diverse properties but may also be inter-related for some reasons such as educational or cultural background. The user coupling can be calculated on top of the dependent relations for all attributes S
Ob = S U = &lt; U,A,V,f &gt; . For two users described by the attribute space, the Coupled User Similarity ( CUS ) is defined by incorporating intra-couplings between values within an attribute and inter-couplings between attributes [ 16 ] to measure the similarity between users.
 Definition 1. Formally, given user attribute space S U = &lt; U,A,V,f &gt; pled User Similarity (CUS) between two users u i and u j is defined as follows. where V ik and V jk are the values of attribute k for users and k is the intra-coupling within attribute A k ,  X  Ie k is the inter-coupling between different attributes. 4.2 Item Coupling Similarly, items are non-IID. Each item owns different characteristics from oth-ers, and there may be coupling relationships between items such as the comple-mentation between purposes. Similar to user coupling, the item coupling can be calculated by setting S Ob = S O = &lt;O,A ,V ,f &gt; . For two items described by the attribute space, the Coupled Item Similarity ( CIS ) is defined to measure the similarity between items by integrating intra-couplings within an attribute and inter-couplings between attributes.
 Definition 2. Formally, given item attribute space S O = &lt;O,A ,V ,f &gt; Coupled Item Similarity (CIS) between two items o i and o follows.
 where V ik and V jk are the values of attribute j for items and k is the intra-coupling within attribute A k ,  X  Ie k is the inter-coupling between different attributes. 4.3 Coupled MF Model MF approaches have been recognized as the main stream in RS through a latent topic projection learning model. In this work, we attempt to incorporate all discussed couplings into a MF scheme. Traditionally, the matrix of predicted ratings  X  R  X  R n  X  m , where n , m respectively denote the number of users and the number of items, can be modeled as:  X  R = r m + PQ T with matrices and
Q  X  R m  X  d , where d is the rank (or dimension of the latent space) with d  X  n, m ,and r m  X  R is a global offset value. Through this modelling, the prediction task of matrix  X  R is transferred to compute the mapping of items and users to factor matrices P and Q . Once this mapping is completed, easily reconstructed to predict the rating given by one user to an item. coupling and item coupling, into account. All these aspects should be accom-modated into a unified learning model. The learning procedure is constrained by three-fold: the learned rating values should be as close as possible to the observed rating values, the predicted user and item profiles should be similar to their neighbourhoods as well, which are derived from their coupling information. Specifically, in order to incorporate the user coupling and item coupling, we add two additional regularization factors in the optimization step. Then the compu-tation of the mapping can be similarly optimized by minimizing the regularized squared error. The objective function is given as Eqn. 3 .
 and item coupling have been all incorporated together. Specifically, the first part reflects the subjective rating preferences and the latter two parts reflect the user coupling and item coupling, respectively. This means when we recommend rel-evant items to users, the users X  rating preferences may take the dominant role. Besides this, another distinct advantage is that, when we do not have ample rating data, it is still possible to make satisfactory recommendations via lever-aging the coupling information, e.g., one user will be recommended what his/her neighbours like or items similar to what he/she preferred before.
 L by the gradient descent approach: where I u,o i is the function indicating that whether user has rated item means rated, 0 means not rated. CUS ( u, v ) is the coupled similarity of users and v ,and CIS ( o i ,o j ) is the coupled similarity of items N ( o i ) respectively represent the user and item neighborhood filtered by coupled similarity. Model Training. Through the above gradient descent approach, the best matrices P and Q can be computed in terms of the user coupling, item cou-pling and user-item coupling. The whole process of the coupled model starts at computing user coupling and item coupling based on their objective attribute space, then neighbors of users and items are selected from the couplings. Next, values of P and Q are randomly initiated followed by an iteration step to update P and Q until convergence according to Eqn. 4 and 5 . After from the training process, we can predict the ratings for user-item pairs ( In this section, we evaluate our proposed model and compare it with the existing approaches respectively using Movielens 1 and Bookcrossing 5.1 Data Sets Movielens data set has been widely explored in RS research in last decade. Movielens 1M data set consists of 1,000,209 anonymous ratings of approximately 3,900 movies made by 6,040 Movielens users who joined Movielens in 2000. Only users providing basic demographic information such as  X  X ender X ,  X  X ge X ,  X  X ccupation X  and  X  X ipcode X  are included in this data set. The movies also have a special  X  X enre X  attribute which is applied for computing the item couplings. Similarly, collected by Cai-Nicolas Ziegler, Bookcrossing data set contains 278,858 users with demographic information providing 1,149,780 ratings on 271, 379 books. The ratings range from 1 to 10 and the users X   X  X ender X  and  X  X ge X  attributes and the books X   X  X ook-author X ,  X  X ear of publication X  and  X  X ublisher X  have been used to form user and item couplings. 5.2 Experimental Settings The 5-fold cross validation is performed in our experiments. In each fold, we have 80% of data as the training set and the remaining 20% as testing set. Here we use Root Mean Square Error (RMSE) and Mean Absolute Error (MAE) as evaluation metrics.
 To evaluate the performance of our proposed CMF we consider five baseline approaches: (1) The basic probabilistic matrix factorization (PMF) approach [ 14 ]; (2) Singular value decomposition (RSVD) [ 2 ] is a factorization method to decompose the rating matrix; (3) Implicit social matrix factorization (ISMF) [ 11 ] is an unified model which incorporates implicit social relationships between users and between items computed by Pearson similarity based on the user-item rating matrix; (4) User-based CF (UBCF) [ 15 ] first computes users X  similarity by Pearson Correlation on the rating matrix, then recommends relevant items to the given user according to the users who have strong relationships; (5) Item-based CF (IBCF) [ 6 ] first considers items X  similarity by Pearson Correlation on the rating matrix, then recommends relevant items which have strong relationships with the given user X  X  interested items.
 ignore the attributes of users and items. In order to demonstrate the effective-ness of our proposed method, we also compare it with other three hybrid models PSMF, CSMF and JSMF which respectively augment MF with Pearson Corre-lation Coefficient, Cosine and Jaccard similarity measures to compute the rela-tionships within users and items based on their attributes. Simply put, we first respectively apply Pearson Correlation Coefficient, Cosine and Jaccard similarity to compute the similarities for users and items based on their attributes. Then we utilize the similarities within users and items to update and optimize the objective function to acquire the best P and Q as CMF. The objective function of PSMF, CSMF and JSMF is similarly constructed as Eqn. 3 by respectively jaccard similarity between users and between items. 5.3 Experimental Results and Discussions We respectively evaluate the effectiveness of our CMF model in comparison with the above baselines and the other three hybrid methods PSMF, CSMF and JSMF by selecting the optimal parameters  X  =1.0,  X  =0.2 for Movielens, and  X  =0.6,  X  =1.0 for Bookcrossing.
 Superiority over MF Methods. Because the users of Movielens data set have the basic demographic data for user coupling, and the movies also have natural genre attribute for item coupling, the experimental results compared to the MF methods in Table 2 can show the effect of user coupling and item coupling. In this experiment, we respectively compared the experimental results regarding different latent dimensions with MAE and RMSE metrics. When the latent dimension is set as 100, 50 and 10, in terms of MAE, our proposed CMF can reach an average improvements of 21.24%, 12.88% compared with PMF and RSVD approaches. Similarly, CMF can also improves averagely 58.77%, 39.93% regarding RMSE over PMF and RSVD approaches. Besides the basic compar-isons, we also compare our CMF with the latest research outcome ISMF which utilizes the implicit relationships between users and items based on the rating matrix by Pearson similarity. From the experimental result, we can see that CMF can averagely improve 15.22% and 45.87% regarding MAE and RMSE respec-tively. In conclusion, the experiments on Movielens data set clearly indicate that CMF is more effective than the baseline MF approaches and the state-of-the-art ISMF method regarding MAE and RMSE when latent dimension is respectively set to 100, 50 and 10, due to the strength of user coupling and item coupling. information, and rich book content information such as  X  X ook-Title X ,  X  X ook-Author X ,  X  X ear-Of-Publication X  and  X  X ublisher X . After removing all the invalid ISBNs, all the books in the data set are cleaned. Therefore the experimental results on the Bookcrossing data set can also demonstrate the impacts of user and item couplings. We depict the effectiveness comparisons with respect to dif-ferent methods on Bookcrossing data set in Table 2 . We can clearly see that, our proposed CMF method outperforms all the counterparts in terms of MAE and RMSE. Specifically, when the latent dimension is set as 100, 50 and 10, in terms of MAE, our proposed CMF can reach an average improvements of 3.68%, 3.70% compared with PMF and RSVD approaches. While CMF can averagely increase 0.98% and 2.78% regarding RMSE over PMF and RSVD approach. Fur-thermore, the prominent improvements compared with the baseline approaches regarding MAE and RMSE are resulted from considering complete couplings. Additionally, we also compare the CMF with the state-of-the-art method ISMF, the result shows that the improvements can reach to 3.41% and 0.44% regard-ing MAE and RMSE respectively. Therefore, we can conclude that our CMF method not only outperforms PMF and SVD which are basic MF methods, but also performs better than the state-of-the-art model ISMF in terms of MAE and RMSE metrics.
 Superiority over CF Methods. In addition to the MF methods, we also com-pare our proposed CMF model with two different CF methods UBCF and IBCF. In this experiment, we fix the latent dimension to 100 for our proposed CMF model. On Movielens, the results in Table 3 indicate that CMF can respectively improve 0.49% and 2.42% regarding MAE, and 0.18% and 19.54% in terms of RMSE. Similarly compared with UBCF and IBCF, on Bookcrossing data set, the results show that the CMF can reach huge improvements respectively 33.02% and 31.03% regarding MAE, and 24.68% and 19.04% regarding RMSE. There-fore, this experiment clearly demonstrates that our proposed CMF performs better than UBCF and IBCF methods. The improvements are contributed by the full consideration of the couplings in RS.
 Superiority over Hybrid Methods. In order to demonstrate the effectiveness of our proposed method, we also compare it with other three hybrid methods PSMF, CSMF and JSMF. From the resultant Fig. 3 on Movielens data set, we can clearly see that the proposed CMF method greatly outperforms PSMF, CSMF and JSMF in terms of MAE and RMSE. Specifically, CMF can averagely improve PSMF, CSMF, JSMF by 20.14%, 19.63%, 27.78% regarding MAE, and by 54.58%, 53.45%, 79.50% regarding RMSE. Similarly on Bookcrossing data set, the results in Fig. 3 clearly indicate that the CMF method also perform better than PSMF, CSMF and JSMF regarding MAE and RMSE. The results show that CMF can respectively improve 2.24%, 19.57%, 2.2% in average regarding MAE, and 8.13%, 44.18%, 8.38% in terms of RSME compared with PSMF, CSMF, JSMF. From this experiment, we can conclude that our proposed CMF is more effective than these three hybrid methods. In this paper, we studied Recommender System from a non-IID perspective, between users and between items to improve the quality of recommendations. The couplings disclosed the traditional IID assumption and deeply analysed the intrinsic relationships between users and between items. Furthermore, a cou-pled matrix factorization model was proposed to incorporate the coupling rela-tions and the explicit rating information. The experiments conducted on the real data sets demonstrated the superiority of the proposed CMF method and suggested that non-IID couplings can be effectively applied in RS. The hetero-geneity between users and between items is still not thoroughly considered in this paper. We need to further explore the heterogeneity challenge for enhancing our recommendation model in the future.

