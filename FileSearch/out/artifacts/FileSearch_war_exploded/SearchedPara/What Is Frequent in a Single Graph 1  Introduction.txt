 The traditional transactional setting of pattern mining is popular for many types of data with well-known examples being basket analysis [1], or molecular frag-ment mining [10]. As stated in the abstract, the single-graph setting introduces problems that do not appear in the transactional setting; the most prominent one being the definition of the support of a pattern. Na  X   X ve definitions of support have the problem that they are not anti-monotonic; thus they cannot be used ef-fectively in pattern mining, as anti-monotonicity is required to prune the search space. To address this problem, Kuramochi and Karypis [7] as well as Fiedler and Borgelt [5] studied anti-monotonic support measures based on computing maximum independent sets ( MIS ) in overlap graphs.

Anti-monotonicity is however not the on ly requirement for efficient frequent pattern mining. It is also important that the frequency measure can be evaluated efficiently. We argue that the computation of overlap-based support measures is not feasible in many graph databases, and that more scalable support measures are needed to enable the use of frequent graph mining algorithms on network data. We propose a new support measure, and provide practical and theoreti-cal evidence that this measure is more scalable, more general and more widely applicable than the support measures men tioned earlier. We show how this mea-sure, and the overlap-graph based measures, relate to each other, thus providing deeper understanding in support measures for graph mining.
 A labeled graph g =( V g , E g , X  g ) consists of a set of nodes V g ,asetofedges E g  X  V g  X  V g and a labeling function  X  g : V g  X  E g  X   X  that maps each element of the graph to an element of the alphabet  X  .Let G  X  be the set of all graphs over the alphabet  X  . We define support as a function  X  : G  X   X  G  X   X  N .
As stated earlier, minimum support needs to be anti-monotonic to allow effi-cient search. This means that for all graphs g , p and p ,where p is a subgraph of p ,itmustholdthat  X  ( p, g )  X   X  ( p ,g ). Anti-monotonicity is quite easily upheld in the transactional setting, but is more tricky for the single-graph setting. The cause of this problem is that it is not clear what exactly should be counted. Occurrence of a Pattern. Given a pattern p =( V p , E p , X  p )andadatagraph g =( V g , E g , X  g ), an occurrence is a function  X  : V p  X  V g mapping the nodes of p to the nodes in g such that (I)  X  v  X  V p  X   X  p ( v )=  X  g (  X  ( v )) and (II)  X 
The problem of the support measure on a single graph is explained in Figure 1. p has one occurrence in g ,and p 2 is a specialization of p 1 . What is the support of p 2 in g ? In the transactional se tting every instance with at least one occurrence counts. This is undesirable in the single-graph setting, since every graph would have a support of either zero or one. A na  X   X ve measure that assigns a support of 2 in our example, would not be anti-monotonic.
 Single Graph Support Measures. For the support measure introduced in [7], all possible occurrences  X  i of a pattern p in the graph g are calculated. An overlap-graph is constructed where each occurrence  X  i corresponds to a node and The support for the pattern p is defined as the size of the maximum independent set ( MIS ) of the overlap-graph. For example, in Figure 2 there would be four occurrences of the pattern p in the graph g . Even though [7] defined overlap in terms of edges, the concept can also be applied to vertices. For this case, we formalize the following binary relationship: Definition 1. A simple overlap of occurrences  X  and  X  of pattern p exists if  X  ( V p )  X   X  ( V p ) =  X  .
 We denote the support measure based on simple overlap as  X   X  .Itcanbeshown that this support measure is anti-monotonic. However, solving a MIS problem is NP-complete.

A refinement of the simple overlap based support measure was introduced in [5] and named harmful overlap . We will denote this by  X   X  . The basic idea of this measure is that some of the simple overlaps can be disregarded without harming the anti-monotonicity of the support m easure. As before, an overlap graph is constructed and the support is defined as the size of the MIS . Different is the definition of overlap: Definition 2. A harmful overlap of occurrences  X  and  X  of pattern p exists if  X  v  X  V p :  X  ( v ) , X  ( v )  X   X  ( V p )  X   X  ( V p ) .
Note that both simple overlap  X   X  and harmful overlap  X   X  are based on shared nodes here. However, all measures can be used either based on edges or on nodes .
Both measures rely on computing an overlap graph, and subsequently solving a MIS problem. We propose a measure of support, which avoids potentially expensive MIS computations 1 . It is based on the number of unique nodes in the graph g =( V g , E g ) to which a node of the pattern p =( V p , E p )ismapped. Definition 3. The minimum image based support of p in g is defined as By taking the node in p which is mapped to the least number of unique nodes in g , we can ensure the anti-monotonicity of  X   X  . From our definition of support, we can deduce several co mputational benefits: (i) instead of O ( n 2 ) potential overlaps, where n is the possibly exponential nu mber of occurrences, we only need to maintain a set of data vertices for every node in the pattern, which can be done in O ( n ); (ii) we do not need to solve an NP complete MIS problem; (iii) it is not necessary to compute all occurre nces: it is sufficient to determine for every pair of v  X  V p and v  X  V g if there is one occurrence in which  X  ( v )= v . The computational burden can be reduced further by taking into account the automorphisms of the pattern graph.
 Relationships and Dependencies. All measures introduced are based on the occurrence of patterns, but they can give different results on the same data. An example for how the three measures work and that they give different results can be found in Figure 2.

Nevertheless, several relationships between these measures hold. We can show that our measure  X   X  is an upper bound for the harmful overlap measure  X   X  ,which is in turn an upper bound for the simple overlap based measure  X   X  . Theorem 1.  X   X  is an upper bound for  X   X  :  X  p  X  X  :  X   X  ( p, T )  X   X   X  ( p, T ) . Proof. Let v  X  =argmin that  X   X ,  X  :  X  ( v  X  )=  X  ( v  X  ) there is a harmful overlap of  X  and  X  and hence at most one of the occurrences  X  and  X  can be a member of the MIS .Fromthis the claim follows.
 Theorem 2.  X   X  is an upper bound for  X   X  :  X  p  X  X  :  X   X  ( p, T )  X   X   X  ( p, T ) Proof. We know that for all  X ,  X  such that  X  and  X  overlap harmfully, there is a simple overlap. Hence the overlap graphs for both measures have the same nodes, and the edges for the harmful overlap are a subset of the edges for the simple overlap. Thus, the harmful overlap contains less constraints for the MIS , and the set is at least as big as for the simple overlap.
 Finally it is easy to see that all described measures are bounded by the real number of pattern occurrences in the graph. To compare with the overlap-based support measures from [7,5] we obtained the datasets Aviation and Credit described in [7] from the SUBDUE website 2 .We used the same thresholds as used in [7] and obtained for all three measures the same sets of frequent patterns as reported in [7]. A closer look revealed that both datasets are rather transactional than single graphs, consisting only of sets of trees of depth one .Inthe Credit dataset all trees have 21 nodes. A traditional transactional graph miner [10] yields identical results; no additional information on this data can be discovered using single graph mining.

The WebKB dataset 3 does not have this drawback and consists of four large graphs that correspond to the hyperlink structure of web pages from a computer science department. Nodes are labeled according to the seven types of web-page that they represent. Edges are unlabel ed. Figure 4 summari zes the character-istics of the datasets. Table 1 lists details of the computation of the MIS for all patterns found on the Cornell dataset using our measure with a minimum support threshold of 61. QUALEX-MS [3] 4 , a state of the art (approximative) MIS solver [8] was used to calculate the MIS . The table shows that for larger patterns, the number of occurrences is prohibitive; we were not able to compute the overlap graph, and consequently could not solve the MIS problem. As usually bigger patterns are of interest, this is a problem for the overlap-based measures. The results of the experiments on the WebKB datasets are summarized in Figure 3. They suggest a relationship between the size of the database and the computational costs of the frequent pattern extraction. Expressing the support relative to the number of nodes in the data graphs, most datasets show the same behavior, except for Washington , where lower relative supports were feasible.
Moreover, we applied our algorithm to a life science database with up to 18.000 nodes and 24.000 edges [9]. However, these results require more research. We introduced a new support measure for mining frequent subgraphs in large single graphs and compared it experimentally and theoretically with existing measures. Existing measures are based on constructing overlap graphs, which soon grow impractically large; this makes solving the subsequent NP complete problem impossible. Since the proposed new measure does not suffer from this problem, it can be evaluated in cases where the old measures cannot be evaluated. Furthermore we showed that the new measure is an upper bound for the other measures, allowing us to guarantee a superset of patterns. We believe there are no clear advantages or disadvantages with respect to the interpretability of any of the measures.

We only compared with complete freque nt (single)subgraph miners. Further applications may be found in heuristic single graph miners, of which SubDue [6] is an example, and graph miners dealing with additional constraints [4].
The proposed support measure is extendible in multiple ways. We present one example here. Our measure was introdu ced as a node-based support measure and is easily turned into an edge-based measure. More interestingly, it is possible to generalize our measure to more general substructures than nodes or edges.
Given a parameter k , we can define a support measure based on determining where each connect ed subgraph with k nodes of the pattern can be matched to. Definition 4. For a pattern p , a graph g , and a parameter k , the minimum k -image based support is defined as:  X   X  ( p, g )= min Intuitively, we obtain a measure which achieves counts that are closer to the total number of occurrences of a pattern, while the counts are still anti-monotonic. Especially in larger patterns, it is sometimes more intuitive to allow for more overlap between occurrences than when only single nodes or edges are used. Acknowledgments. We thank Luc De Raedt for helpful comments and dis-cussion, as well as Hannu Toivonen for pro viding the life sciences database. We thank Christian Borgelt for making the MoSS mining tool publicly available. The authors were supported by the EU FET IST project  X  X nductive Querying X , contract number FP6-516169 and by a doctoral research grant by the KU Leuven research fund.

