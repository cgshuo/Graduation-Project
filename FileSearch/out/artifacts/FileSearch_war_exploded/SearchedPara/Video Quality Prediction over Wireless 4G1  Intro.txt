 Fourth generation (4G) of mobile communication standards, such as Long Term Evolution Advanced (LTE-Advanced) and Worldwide Interoperability for Mi-crowave Access Release 2 (WiMAX2), pr ovide high speed and large range of wireless connectivity. Because of the la rge coverage of a base station (BS), users within the coverage area result in different channel quality causing the multi-users diversity problem. In order to provide a reliable video multicast/broadcast service by high speed wireless channels, She et al. proposed Superposition Coded Multicasting(SCM)methodin[1].Inthi s scheme, a scalabl e video bitstream consists of two different quality layers that are modulated into two signals by two different modulations. These two signals are then superimposed into one broadcasting signal for all receivers under the BS coverage. Since the transmis-sion of superimposed signal can be affected by wireless channel conditions, the quality of received video is key concern for both the providers and receivers.
From the video providers X  point of view, the Quality of Service (QoS) is determined by the quality of video that customers will receive. If the quality of video can be predicted according to network conditions and video parame-ters, providers can guarantee certain leve l of service by taking effective actions. On the one hand, before broadcasting a video, providers can set the input fea-tures/parameters to achieve the targeted video quality. On the other hand, dur-ing video transmission, operators can adjust the video and network parameters according to this prediction m odel for various conditions.

There are three main challenges facing the accurate prediction of video quality over wireless channels. First, the behavior of wireless signal is difficult to predict and measure, since it fluctuates and can be significantly affected by complex and mixed factors, such as attenuation, fading, and interference [2]. Attenuation happens due to the distance between tran smitter and receiver. Fading may vary over time, position or radio frequency due to multi-path propagation. Second, multi-user channel diversity challenge where users at different geographic loca-tions within the same BS coverage area have different channel quality [3]. Third, collecting data for analysis and predict ion is expensive. In order to accurately predict the video quality, all possible conditions that may affect video quality must be considered, and all correspondi ng data should be coll ected. Construct-ing an emulation testbed with implementation of SCM is often expensive. To the best of our knowledge, the testbed used in this paper is the first built emula-tion testbed on this research area. This work assists research work without real testbed by building a practical prediction model. It helps to reduce the depen-dence on the expensive testbed system through estimating transmission results, instead of conducting real experiments.

Video quality prediction can be formalized as a regressionproblem. Video trans-mission is described by a set of features, including video and network parameters. Video quality, measured by a common quality metric called Peak Signal-to-Noise Ratio (PSNR), is the target for prediction [4]. Given a raw data, feature selection is first used for selecting the useful features from the data set. Three popular regres-sion approaches, k -nearest neighbor algorithm ( k -NN), Support Vector Machines (SVM) and Neuron Network (NN) are employed for prediction. Nominal type fea-ture ( modulation ) and a ratio type feature ( power boosting ) are transformed to-gether into one ratio type feature. The improved results from advance approaches including the transformed feature demon strate the main factors affecting video quality and should gain more attention in video transmission.

The rest of this paper is organized as follows. Section 2 introduces the back-ground and related work of video quality prediction problem. Section 3 describes the methodology for prediction, which con sists of data collection on real testbed, feature transformation and selection, and employed prediction techniques. Section 4 reports experimental results. Section 5 finally concludes and gives perspectives. Researchers face many challenges on video quality prediction. One of the difficul-ties is the videos are affected by numerous parameters. Through collecting data from simulations of 3G and WLAN network, Khan et al. predicted the video quality with both application and network level parameters [5]. However, this was limited to four parameters, which are frame rate, send bitrate, packet error rate, and link bandwidth. These limited number of features cannot represent the network condition well especially when network condition becomes complex in the wireless 4G.

Garcia et al. proposed a framework to find a parametric content description of videos [6]. Assuming that video content influences the video quality, they proposed to decompose the input video to spatial and temporal features which highlight a strong adequation with the perceived video quality. However, predic-tion of video quality was not quantified in their approach.
Dalal et al. investigated the feature selection for predicting video quality after network transmission [7]. Network statistic such as packet lost rate and error rate were considered as features. Two methods correlation ranking and principal component analysis (PCA) were investi gated. However, video they studied were collected from a wired network.

Liu et al. proposed a framework for video prediction after encoding process, which can reduce time cost for choosing correct parameters for video encod-ing process [8]. Their approach was simple and efficient. However, they did not consider the parameters of network transmission for the prediction.
All of the above reported studies omitted the wireless network characteristics and assumed a simulation based data. Therefore, we attempt to collect real-life data and perform more accurate prediction considering the wireless network characteristics. In the next section, we introduce our methodology. This section introduces our proposed approach of video quality prediction. We first introduce the testbed for data collection. Then, as pre-processing is a cru-cial part of prediction, we introduce feature transformation, normalization and ranking mechanisms. Finally, k -NN, SVM and NN are introduced to build the regression models for video quality prediction. 3.1 Testbed Description and Data Collection Video data in this paper is collected by a real-time SCM testbed, which con-sists of two network emulators, two personal computers (PC) and one variable attenuator. In the transmitter side, one PC is connected to one network emula-tor acted as the video server and BS. The other PC is connected to the second emulator acted as the mobile receiver and mobile device. Videos are transmitted over the emulators connected by coaxial radio frequency cables through the vari-able attenuator acting as the wireless channel with different values of channel attenuation. The emulators are implemented by National Instruments NI PXIe-1062Q chassis with embedded controller PXIe-8130, IF transceiver PXIe-5641R, RF Up converter PXIe-5610 and RF Down converter PXIe-5600. Figure 1 shows the system architecture of SCM with transmitter on the top. The video data passes through all layers and become superposition coded signal broadcast over the emulated wireless channel. Receive r receives the broadcasting signals that go through all the layers to reconstruct the video data.

Video streams are encoded as H.264-SVC [9] bitstream, and are stored in the video server. Each video sequence consists of two layers, base layer and enhancement layer. Base layer contains most of the important information of the video and should be correctly receive d and decoded in order to reconstruct the video after transmission. Enhancement layer is additional information of the base layer to improve the video quality when successfully decoded. It is expected that enhancement layer bitrat e is higher than base layer bitrate since the encoding quantization parameters ( QP) of enhancement layer is lower than the base layer QP. Different number of gro up of pictures (GOP) and intra period are considered as the video features/parameters in the system.

From the network prospective, transmi ssion power, and reception power sensi-tivity are controlled by the transmitter a nd receiver emulators in physical layer. Channel attenuation is controlled manually by the variable attenuator. Assume that during each of the transmission, the attenuation value is constant to re-main a static transmission environment to reduce complexity. Carrier frequency, modulation, power boosting, cyclic prefix and bandwidth are selected from the MAC layer control software.

A video transmission, when complet ed, is described by a set of video and network features. The first three column s of Table 1 show the features considered in this work. The last row is the prediction target PSNR, which is commonly used to measure the quality of the reconstructed video after network transmission. It is calculated by comparing the video f rame by frame and pixel by pixel between the received video and the original vide o before encoding and transmission. A higher PSNR value introduces a higher video quality received. Given a video with its known feature values, our target is t o predict the PSNR after it is received.
In our experiments throughout the paper, the video transmitted is a 40 sec-onds length movie trailer, which is a standard video provided by Durian Open Movie project named as  X  X intel X  [10]. Each test of experimental operation takes around 2 minutes. In addition, calcula ting the PSNR value between received video with original video requires 1 to 2 minutes. 985 testes were conducted in total. Ten random chosen examples are shown in Table 2. 3.2 Feature Transformation Two network features called Base Layer Modulation and Enhancement Layer Modulation are of our interest while predicting video quality. The possible values of these two features are BPSK, QPSK, 16QAM and 64QAM, which are difficult to be directly used for p rediction. Therefore, Base Layer Modulation and Base Layer Power Boosting are transformed to Base Layer Probability of transmitted symbol error . Similarly for Enhancement layer, Enhancement Layer Modulation and Enhancement Layer Power Boosting are transformed to Enhancement Layer Probability of transmitted symbol error . The idea of the transformation is con-sidering the transmitted symbol energy and the receiver symbol decision area. Probability of symbol error means a transmitted symbol falls into other symbols decision area with the amount of Gaussian noise added onto it. The probability of symbol error is calculated as follows according to [11]. Assuming that base layer modulation is always BPSK, the probability of correctly detecting the abscissa of each SPC symbol in the i th region is: where  X  y i is the mean for received symbol abscissa coordination and  X  y i is the variance. Base layer probability of transmitted symbol error is: where M = m 1  X  m 2 , m 1 is the base layer modulation number and m 2 is the enhancement layer modulation number.

After the symbol is decoded on base layer by successive interference cancel-lation (SIC), the remained symbol will be decoded by enhancement layer de-modulator. The standard symbol error equation for m 2 -QAM demodulation is expressed as follow: where Q ( . ) is known as Q-function, E 2 is the remained energy after SIC of symbol for enhancement layer decoding process, N 0 is the Gaussian noise power. Finally the probability of enhancement symbol error is calculated as follow: Transformed feature P b and P e range from 0.00024 to 0.08858 for base layer and 0.0789 to 0.5253 for enhancement layer . 3.3 Feature Normalization Since values of raw video features are on different scale, normalization is per-formed to linearly scale them to unit range. An original value x of a feature is normalized to be x  X  : where x min is the smallest value and x max is the largest value of the feature. To further investigate the improvement that can be made by normalization, original and normalized data are compared in the experimental results. 3.4 Feature Ranking In order to eliminate irrelevant and redundant features in the raw data, supervised feature selection is performed in data pr eprocessing phase. Features are ranked by their Pearson correlation coefficients R f with respect to the target PSNR in training data. As a measure of the linear dependence of a feature and the target, R f = +1 indicates a strong linear r elationship between them, R f = a negative linear relationship and R f = 0 shows the independence of them. For a feature X f , its coefficient w.r.t. target Y is defined as: Features with R f close to 0 will be eliminated when learning a prediction model. 3.5 Regression Models Three regression algorithms are employed in this paper for predicting video quality, k -Nearest Neighbor, Support Vector Machine and Neural Network. k -Nearest neighbor algorithm ( k -NN) is a lazy learning method. The quality of a testing video is estimated based on its k nearest neighbors in training data, which have similar feature values to the testing video. Assuming that its k most similar videos have PSNR value T j ,j =1 ...k , the quality of the video i is where w i,j is the weight function inversely proportional to the distance of the training object j . It is defined as: w i,j = 1 c +( d parameter and d i,j is the distance between video i and j . Considering the feature correlation coefficients, we define distance d i,j by d i,j = where x i,f and x j,f is the value of feature f in video i and j .

To acquire the best results, the number of nearest neighbors k is set from 1 to 10, and the parameter c is tested by values in [10  X  4  X  10  X  3 ]steppedby5  X  10  X  5 .
Support Vector Machine (SVM) is considered as one of the most robust and powerful algorithms for classification and regression. In this work, Epsilon-SVR, the regression model of LIBSVM 3.12 [12], is employed for video quality pre-diction. After testing of various kernel functions, Radial Basis Function (RBF) kernel is selected for its best performance:  X  ( x,x i )= e  X   X  x  X  x i 2 . The setting of SVM parameters C ( cost ) and kernel parameter  X  ( gamma ) are explored by searching in [1  X  100] for C andin[10  X  400] for  X  . Experimental results on different settings of C and  X  will be demonstrated in Figure 3 of the next section.

Neural Network (NN) has been widely used in predicting video quality based on application and network parameters [5,13,14]. Given enough hidden units, any continuous function can be uniformly approximated to arbitrary accuracy [15]. We applied two to three hidden layers NN with back-propagation learning algorithm. Different numbers of hidden neurons are evaluated ranged from 1  X  F to 3  X  F ,where F is the number of features. Results of NN with different topology settings will be reported in next section.
 This section presents the experimental re sults on 985 video testings. 5-fold cross validation is applied for reliable evaluation reason. In order to investigate the impact of feature normalization and transformation introduced in last section, four different cases summarized in Table 3 are evaluated and compared.
Root Mean Squared Error (RMSE) and Coefficient of Determination ( R 2 )are considered as the criteria to evaluate the performance of the prediction methods. RMSE is used to quantify the difference between the predicted and actual PSNR value. A smaller value indicates a bette r result with higher accuracy. RMSE is calculated as and actual PSNR respectively, and N is the number of testing videos.
R 2 is another performance measuremen t of prediction. It is calculated by R 2 = 1 and sum of squares error SSE = N i =1 ( T i  X  act  X  T i ) 2 . R 2 is in [0 1], where the maximum value 1 indicates the best prediction model. 4.1 Feature Ranking As introduced in section 3.4, each featu re is ranked by its Pearson correlation coefficient R f . The last two columns of Table 1 show the R f and corresponding P-values of all features. Those features with  X  0 . 03 &lt;R f &lt; 0 . 03 or NaN 1 are eliminated, such as Enhancement Encoding QP (0.028953), Transmission Power (NaN), Reception Power Sensitivity (-0.028953), Carrier Frequency (0.000000), and Cyclic Prefix (NaN). Their large P-values ( &gt; 0 . 05) also confirm that these feature and the target value have no significant correlation. 4.2 Importance of Transforming Modulation and Power Boosting To investigate the importance of transforming modulation and power boosting features presented in Section 3.2, we compare results of Case 1 and 2 with that of Case 3 and 4.

Figure 2a and 2b show the RMSE and R 2 of k -NNoneachcase.Thebest setting of kernel parameter c when calculating w i,j was exhaustively explored. Figure 2 presents the results with the best setting. As we can see for all values of k , Case 3 and 4 are significantly better than Case 1 and 2 with lower RMSE values and higher R 2 . We can then conclude that feature transformation plays a very important role on correct ly predicting video quality.

Figure 3 presents the prediction performance of SVM. As observed in k -NN, better results are obtained from Case 3 and 4 rather than Case 1 and 2. The setting of SVM parameter C and  X  is tested by combinations of values indexed by k on x -axis. The best prediction is on Case 4 when C =9and  X  = 120 ( k = 332) resulting RMSE = 3.218 and R 2 = 0.7669.
Figure 4 shows the results of NN with different network topology setting indexed by k , e.g., k =1whenNNhas F  X  F neurons (2 hidden layers, each of which has F hidden neurons), k =5whenNNhas F  X  F  X  F neurons (3 hidden layers), where F is the number of features after selection. The same observation can be found that Case 3 and 4 perform better than Case 1 and 2. The best prediction results with lowest RMSE and highest R 2 happened on Case 3 when NN has 3 F  X  3 F neurons ( k =4).

Results of k -NN, SVM and NN consistently show that prediction excluding modulation and power boosting features (Case 1 and 2) gives worse results than transforming them into probability of symbol errors (Case 3 and 4). In other words, transformation of modulation and power boosting is essential. 4.3 Effects of Normalization of Data Since Case 3 and 4 achieve better prediction results, we study the normalization effect on these two cases in this subsection (Case 1 and 2 are exempted). In k -NN, normalization does not make significant effect. In Figure 2, normalized data (Case 4) performs exactly the same as original data (Case 3) when k is less than 4. Normalized data (Case 4) leads to better results than original data (Case 3) when k increases.

Normalization stabilized the performance of SVM when varying parameter setting. Fluctuating curves of Case 3 and smoothing curves of Case 4 in Figure 3 indicate that normalized data can produce better (lower RMSE and higher R 2 ) and more stable results. However, NN does not significantly benefit from normalization.

In summary, normalization can generally further improve the prediction per-formance. 4.4 Comparison of Regression Models Table 4 compares the pre diction performance of k -NN, SVM, and NN on Case 3 and Case 4. Case 1 and 2 are excluded because their prediction results are much worse than that of Case 3 and 4. The best RMSE and R 2 value of each model were presented when its model parameters are set appropriately. In general, three models give similar results, and they all produce small RMSE and high R 2 .SVM on Case 4 can lead to the smallest RMSE and the highest R 2 .

Figure 5 shows the predicted and actual PSNR values for the best prediction of all models, k -NN on Case 4 when k =10, c =0.0002, SVM on Case 4 when C =9,  X  =120, and NN on Case 3 when topology is 3 F  X  3 F =30  X  30, where F is the number of features after feature transformation and selection. Videos on x -axis are ordered by their actual PSNR value s. We can observe that all prediction methods can give good prediction when actual PSNR is high. Especially, the prediction of SVM is more accurate when actual PSNR is larger than 54dB. The prediction deviates more from the true target when actual PSNR is relatively low. However, the deviation is only around 5% of the target on average. These less accurate predictions are due to the lac k of effective learning examples. Videos with low PSNR have worse quality. In a well-developed transmission system, the number of damaged videos is smaller than the number of undamaged videos. This paper studies the problem of video quality prediction in wireless 4G net-work transmission. A real testbed is built for collecting videos transmitted under various network conditions. The raw tran smission data is pre-processed by fea-ture transformation, normalization and ranking. Regression models are learned by three different algorithms and used for predicting the quality of video.
The first motivation of this work is to investigate which features are strongly correlated to video quality. From the feature ranking results, we find that atten-uation and base layer probability of symbol error are the two important features that highly correlated to the PSNR (target of prediction) with the correlation coefficient R f = -0.5027 and -0.1905, P-value = 3.372e-64 and 1.667e-9, respec-tively. In addition, according to the evaluation results, we observe that feature transformation of modulation and power boosting for both base layer and en-hancement layer significantly affected th e prediction accuracy of video quality.
Through pre-processing raw data and exploring the most suitable parameter setting, we built prediction models based on three different regression algorithms. The experimental results demonstrate that these models can accurately predict video quality with small errors and high relevance with target values.
This first attempt of video quality prediction in wireless 4G opens several perspectives for further research. First, the models are useful to reduce the time spent on running real experiments. As we mentioned in the introduction, imi-tating all of the different channel conditions and conducting video transmitting experiments are very time consuming. Our discovery of key features and pre-diction model can be used to guide the d esign of experiments. Second, we will enhance the prediction models to make them perform well on more complex channel conditions.

