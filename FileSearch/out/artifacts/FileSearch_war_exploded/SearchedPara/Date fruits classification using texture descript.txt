 1. Introduction According to the Food &amp; Agricultural Organization (FAO), the
Middle-East and the North African countries are currently the largest date producer countries in the world ( Food and Agriculture commodities production, 2012 ). Fig. 1 shows the production amount in tons of dates for the top fi fteen countries.
Dates of the Arab region are well known for their taste. Dates are delicious and rich in nutrition. Fresh date is a very good source of vitamin C, though it disappears once it is dried. It is also a good source of sugar, carbohydrate, fi ber, calcium, iron, and potassium. However, it does not have signi fi cant amount of fat or cholesterol.
The scienti fi c research on dates in an automated way is not very old. It started roughly around 15 years back; however, many things are still in questions. Most of the previous research focused on the grading of the date fruits. Al-Janobi proposed two methods, one with co-occurrence matrix and the other with color machine vision technique, to grade the date fruits in late 90s and early of this century ( Al-Janobi, 1998; Al-Janobi, 2000 ). Defect dates were sorted out by image analysis in a method proposed by Wulfsohn et al. Wulfsohn et al., (1993) ; however it was a binary classi that classi fi ed the dates as either defected or of good quality.
The maturity inspection of the dates by near infrared spec-trometry was investigated by Schmilovitch et al. (1999) .Shape and size based date grading system was introduced by Hobani et al. (2003) using neural network classi fi er. A similar approach but by using probabilistic neural networks was proposed in Fadel (2007) .

Alohali by using computer vision techniques ( Ohali, 2011 ). Size, shape, intensity features were extracted in RGB color space and back-propagation neural network was used to classify the dates according to the grades. In another research, the three color information, perimeter, length, width, and length-to-width ratio features together with multilayer neural network classi fi used to grade the dates ( Alrajeh and Alzohairy, 2012 ). Some other recent automatic dates grading systems are proposed in Alavi (2013) and Abdellahhalimi et al. (2013) . These systems either use fuzzy inference, computer vision techniques, or distinguished camera sensors. A list of recent date research can be found in the Date Palm Research Group, 2006 .
 decades, much more are still needed . For example, there is no or little research in date recognition/classi fi cation (what kind of date). Almost dates based on the grades. In Haidar et al. (2012) ,atotalof features including mean, standard deviation, and entropy of each color component of RGB, shapes an d size were used to classify dates; however, only 140 images were used in the experiments. We would like to mention that there are many works in the literature to classify other fruits, such as apples ( Xiaobo et al., 2007; Mehl et al., 2004 ), berries ( ElMasry et al., 2007 ), etc. Comparing to the amount of this research, date fruit research is less, though it is very important to this part of the world (Middle-East and North Africa). Alohali reported in 2010 that the date sorting is performed completely by humans (manually) and it is the main reason of delay in date production cycle ( Ohali, 2011 ). Therefore, an automated computer vision based system can signi fi cantly reduce the delay in date industry.

In this paper, we propose a system to automatically classify the dates using shape, size features and texture descriptors. The major contribution of this system is the introduction of two well-known and powerful local texture descriptors in the form of local binary pattern (LBP) ( Ahonen et al., 2006 ) and Weber local descriptor (WLD) ( Chen et al., 2010 ). We also use multi-class support vector machine (SVM) as a classi fi er. The proposed system does not require any physical instruments to measure the size or the shape, and thereby can operate fast and is inexpensive.

The rest of the paper is organized as follows. Section 2 describes the proposed method; Section 3 givesexperimentalresultswith discussion, and Section 4 draws some conclusions. 2. Proposed method
Fig. 2 shows a block diagram of the proposed date fruits classi fi cation system. In the following, we describe the steps in detail.

The input of the system is a color image of a single date. The image can be taken with a uniform (non-texture) color background. There is no restriction on the size of the image. Once the image is input to the system, some pre-processing is applied. In the pre-processing step, fi rst, a copy of the color image is converted into black and white imageusingtheimagehistogram.Theminimumandthemaximum vertical and horizontal coordinates of the black image (corresponding to the date) are identi fi ed. Based on these coordinates, the original color image is cropped to produce the region of interest. Fig. 3 shows examples of four types of dates' images after cropping. The four types of the dates are Ajwah, Sagai, Sellaj, and Sukkary. These dates are available in plenty in the Arab region, especially in the Gulf countries.
The cropped color image of a date fruit is converted into three separate color channels. We investigate the color spaces {red (R), green (G), and blue (B)}, {luminance (Y), chrominance (Cb and Cr)}, and {hue (H), saturation (S), and intensity (I)}. It can be noted that a color image is passed through three color fi lters (R, G, and B) inside the camera. YCbCr color space stores the color in terms of luminance and chrominance, where the human eyes are less sensitive to chrominance than luminance. Chrominance compo-nents can unveil some of the cues of differentiating the dates that can be impossible to detect by the naked human eyes. On the other hand, HSI attributes are the closest approximation to human interpretation of color. The logic behind using these color spaces is that the dates vary in colors and therefore contain important information in different color spaces. In this paper, we investigate the feasibility of using these color spaces in date fruits classi tion. Texture information in the form of LBP and WLD histograms is then extracted from these color components. 2.1. Shape and size features
The shape and the size of the dates are important features as they have high discriminative power between the types of the dates. The farmers usually consider shape and size features to recognize dates.

To de fi ne the shape and the size of a particular date, the cropped image is fi ttoanellipseusingthebestleast-square fi tting ellipse method ( Fitzgibbon et al., 1999 ). In this method, fi rst, represent a general conic by an implicit polynomial of the set of N points ( x , y )as Eq. (1) .The N points are taken from the edges of the black and white image of the date.
 F  X  a ; x  X  X  a x  X  ax 2  X  bxy  X  cy 2  X  dx  X  ey  X  f  X  0 ;  X  1  X  where, a  X  X  abcdef T and x  X  X  x 2 xy y 2 xy 1 T :
The minimization of the sum of squared distances between the points ( x , y ) and the conic F can be solved by a rank de eigenvalue system as Eq. (2) .
 D Da  X   X  Ca ;  X  2  X  where D  X  X  x 1 x 2 ; ... ; x n T is called the design matrix and C is the constraint matrix. The matrix C is de fi ned as
C  X 
The pseudo code of the best least-square fi tting ellipse method is given in Fig. 4 ( Fitzgibbon et al., 1999 ).

After fi tting the date image to an ellipse, the following four shape and size features are calculated in terms of pixels. Major axis length Minor axis length Ellipse eccentricity Area
Fig. 5 shows an example of a fi tted ellipse to an Ajwah date fruit image. Major and minor axes lengths are also shown in the
The ellipse eccentricity is calculated as a ratio between p and m , where p is the distance from the center to a focus of the ellipse and m is the distance from a vertex to that focus.
 pixels in the black and white image (obtained before). 2.2. LBP et al., 2006 ). The LBP labels the pixels of an image by decimal numbers called LBP codes. The local structure around the center pixel is encoded by thresholding the eight neighbors' pixels' grayscale values in a 3 3 neighborhood with the center value and considering the result as a binary number. The center pixel is subtracted from each of its eight neighbors. If the result of the subtraction is negative, it is encoded with 0, otherwise it is encoded with 1. The eight binary values are concatenated either clockwise or counter clockwise to form an 8-bit binary number.
The corresponding decimal value of the generated binary number is then used as a label for the given center pixel. Fig. 6 shows an illustration of LBP calculation.

It has been realized that certain patterns contain more infor-mation than others, so it is possible to use a small subset of the total number of patterns to describe any texture. This subset is called  X  uniform' and it includes at most two bitwise transitions from 0 to 1 or vice versa. In the proposed method, a uniform located on a circular position with radius 1 ( R  X  1).

Fig. 7 shows examples of LBP histograms of green channel of the four types of dates, Ajwah, Sagai, Sellaj, and Sukkary. From the fi gure, it can be seen that the histograms are different from each other, which implies the discrimination capabilities of the LBP between different types of dates. 2.3. WLD
The WLD was based on psychological law called  X  Weber's Law that states the fact that human perception of a pattern depends not only on the change of a stimulus like sound, lighting, but also on the original intensity of the stimulus. WLD includes two components, which are differential excitation (DE) and gradient orientation (GO) ( Chen et al., 2010 ). The DE is a function of the ratio between two terms: one is the relative intensity differences of a current pixel against its neighbors and the other is the intensity of the current pixel. The orientation component is the GO of the current pixel.

If x c is the center pixel of a 3 3 window, and x i , i  X  1,2, the neighbors of the center pixel, DE is calculated as Eq. (4) . DE  X  tan 1  X  N where I is the gray level intensity of the corresponding pixel. The positive value of DE indicates that the current pixel is darker than the neighboring pixel, while the negative value represents the opposite.
 The GE of the center pixel x c is calculated as Eq. (5) . GO  X  tan 1 I 7 I 3 I where the numerator is the intensity difference between the left and the right of x c , while the denominator is the intensity difference between the below and the above of x c . The GO is then quantized into T dominant orientations. For each dominant orien-histogram is then divided into M sub-histograms each with S bins. Sub-histograms are concatenated to represent the feature of the image. For details, the readers can go through ( Chen et al., 2010 ). There are three parameters ( T , M ,and S )associatedwiththeWLD. In the experiments, we investigated different combinations of the values of T , M ,and S .Wefound( T  X  6, M  X  4, S  X  5) combination to be the optimum. Fig. 8 showsexamplesofWLDhistogramsofgreen channel of the four types of dates. From the histograms, we see that they are different for various types of dates, though similarity exists to some extent between the histograms of Sellaj and Sagai. 2.4. Fisher discrimination ratio (FDR)
The feature dimension of the proposed system using either LBP or WLD is relatively high. Not all the features (histogram bins) are equally important to a particular task. In the proposed method, the FDR is applied to select the important features from LBP or WLD.
FDR takes both the mean and the variance of the features. For a two-class problem, the i th feature FDR ( Fi ) is expressed by Eq. (6) . F  X  1 ; 2  X  X  of the i th feature of class 1 and class 2, respectively. For A num-ber of classes and B dimensional features, Eq. (6) will produce [ A ( A 1)/2] B entries (column row). The overall FDR for the i th feature can be calculated by Eq. (7) .
 FDR i  X  where, m i and  X  i are mean and variance of Fi across columns. The higher the value of FDR, the better the feature for a given classi fi cation problem. After sorting the FDR values in the des-cending order, we select the highest 10 features from the LBP histogram or the WLD histograms. It can be mentioned that the total number of features in LBP histograms is 3 59  X  177 (3 channels, each channel has 59 bins), and in WLD histogram is 3 120  X  360. The 10 features are then combined with the shape and size features to feed into the classi fi er. 2.5. SVM
The SVM classi fi er is a binary classi fi er that is widely used for data classi fi cation in many applications. It follows a procedure to fi nd the optimal boundary that separates two classes with the largest margin between separating boundary and support vec-tors. SVM nonlinearly maps the original input space into a higher-dimensional feature space. This mapping maximizes the generalization capabilities of the classi fi er. Because SVM is a two-class classi fi er, the output given by this classi fi image sample can be interpreted as the likelihood that the sample belongs to a speci fi cclass( Vapnik, 1998 ). Support vectors are created during training phase, and these vectors are used to classify the samples during testing phase. Given the training samples f X  x i ; lab i  X  : i  X  1 ; 2 ;:::; n g ,where x i lab i A  X  1 ;  X  1 is the class label, respectively, of the i th training samples, the optimum boundary is de fi ned as f  X  x  X  X  w x  X  b  X  8  X  where w and b can be found by solving the following optimiza-tion problem, where C is the penalty parameter (C 4 0), and the error:
Minimize 1 2 jj w jj 2  X  C  X 
Subject to the constraints lab i  X  w x i  X  b  X  Z 1  X  i ; i  X  1
The solution of this optimization problem maximizes the margin of the boundary. SVM is basically a linear classi fi however, in most of the cases, the features are not linearly separable. Therefore, a kernel function is used to map the original input space to a higher dimensional space, where the features are linearly separable. Radial basis function (RBF) kernel gives the best results in many applications, and hence we use it in the proposed solution. With RBF kernel, f(x) in Eq. (8) becomes f  X  x  X  X   X  where  X  i is the Lagrange coef fi cient,  X  is the set of nonzero indices of s,  X  is a free parameter, x is a testing sample, and || . Euclidean distance.

As the proposed method deals with four types of dates, we apply a multi-class SVM for classi fi cation. In the multiclass SVM, we adopted one versus the rest approach. For implementation, the well-known LIBSVM is used ( Chang and Lin, 2011 ). 3. Experiments To evaluate the proposed system, an image database is created.
The database contains 200 different images of each of the four types of the dates (Ajwah, Sagai, Sellaj, and Sukkary). Therefore, the total number of images is 800 (all are distinct dates). The images are taken by iPhone 5 mobile. Each image contains only one date picture with uniform background.

In the experiments, a 10-fold cross validation approach is utilized. In the 10-fold cross validation approach, the whole database is divided into 10 folds (with equal number of each of the four types). In one iteration, 9 folds are used for training, while the remaining is used for testing. Therefore, after ten iterations, all the folds are tested. The feature selection step is carried out with the training data. The optimal values for the RBF kernel parameter and the penalty parameter C of SVM are automatically set by an intensive grid search process using the training set. The perfor-mance of the proposed system is given in terms of accuracy averaged over the 10 iterations.

The proposed system is evaluated with fi ve different combina-tions, which are (i) selected LBP (10 features), (ii) selected WLD (10 features), (iii) shape, size features (4 features), (iv) selected
LBP  X  shape, size features (14 features), and (v) selected WLD  X  shape, size features (14 features).

Fig. 9 shows dates classi fi cation accuracy using LBP with different number of bins in three color spaces. In the fi gure,  X  All the LBP histogram bins without feature selection. From the see that though the highest accuracy is obtained using all the bins, there is no signi fi cant drop of accuracy until 10 selected features.
Therefore, we choose 10 selected features keeping in mind that a high number of features causes delay in execution. Among the three color spaces, YCbCr performs the best. Using 10 selected features in
YCbCr color space, the accuracy is 94.7%. It can be noted that the chrominance channels (Cb and Cr) are less sensitive to human eyes; however, the results suggest that they are useful for automatic classi fi cation of date fruits.

A similar trend in accuracy is observed using WLD. Fig. 10 shows the accuracy using WLD. The best performance is obtained with the YCbCr color space, and using 10 selected WLD features, the accuracy is 95%. This accuracy is slightly better than that of using LBP. WLD takes into account the ratio information, while LBP considers only subtractive information; this is the reason why WLD performs better than LBP.

Using the shape-size features, the system achieves 87% accu-racy with 3.12 average standard deviation. It can be mentioned that these features are independent of the color space.
The last two experiments involve fusion of texture descriptors and 4 shape-size features achieve 97.5% accuracy in YCbCr color space, while 10 selected WLD and 4 shape-size features obtain 98.1% accuracy in the same color space. The confusion matrix in the case of YCbCr color space and WLD  X  shape-size features is given in Table 1 . From the confusion matrix, we see that the dates Ajwah and Sukkary are almost correctly classi fi ed; however, Sagai and Sellaj confuse between each other. This confusion is also evident visually from Fig. 3 .
To compare the performance of the proposed system with that of other system, we chose the system described in ( Haidar et al., 2012 ), because it is the only one existing date classi fi that was evaluated using many classi fi ers. There are 15 features in ( Haidar et al., 2012 ) and we chose the arti fi cial neural network classi fi er to implement ( Haidar et al., 2012 ). Both the systems were evaluated on the same database that we created. Table 2 shows the average accuracy obtained by the proposed system with selected
WLD and shape-size features in three color spaces, and the system in ( Haidar et al., 2012 ). From the result, we fi nd that the proposed system outperformed the system in ( Haidar et al., 2012 ). 4. Conclusion
An automatic date fruit classi fi cation system based on local texture descriptors and shape, size features has been proposed.
SVM with RBF kernel is used for the classi fi cation. Four types of dates are used in the experiments. The fi ndings of the date fruit classi fi cation can be summarized as follows.

Texture descriptors, either LBP or WLD, are better than shape, size features.
 WLD performs better than LBP.

Texture descriptors fused with shape, size features give the highest accuracy.

YCbCr and HSI color spaces provide more discriminative information than RGB color space.

The highest accuracy of 98.1% is obtained by the combination of selected WLD descriptors together with shape and size features in
YCbCr color space. One area to investigate in future is the confusion between Sellaj and Sagai dates.
 Acknowledgment Computer and Information Sciences, King Saud University, Riyadh, Saudi Arabia under project number RC140218.
 References
