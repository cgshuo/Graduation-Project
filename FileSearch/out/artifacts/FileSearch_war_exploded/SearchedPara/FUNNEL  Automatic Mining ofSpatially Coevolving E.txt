 Given a large collection of epidemiological data consisting of the count of d contagious diseases for l locations of duration n ,how can we find patterns, rules and outliers? For example, the Project Tycho provides open access to the count infections for U.S. states from 1888 to 2013, for 56 contagious diseases (e.g., measles, in-fluenza), which include missing values, possible recording errors, sudden spikes (or dives) of infections, etc. So how can we find a combined model, for all these diseases, locations, and time-ticks?
In this paper, we present F UNNEL , a unifying analytical model for large scale epidemiological data, as well as a novel fitting algo-rithm, F UNNEL F IT , which solves the above problem. Our method has the following properties: (a) Sense-making : it detects impor-tant patterns of epidemics, such as periodicities, the appearance of vaccines, external shock events, and more; (b) Parameter-free :our modeling framework frees the user from providing parameter val-ues; (c) Scalable :F UNNEL F IT is carefully designed to be linear on the input size; (d) General : our model is general and practi-cal, which can be applied to various types of epidemics, including computer-virus propagation, as well as human diseases.
 Extensive experiments on real data demonstrate that F UNNEL does indeed discover important properties of epidemics: (P1) dis-ease seasonality, e.g., influenza spikes in January, Lyme disease spikes in July and the absence of yearly periodicity for gonorrhea; (P2) disease reduction effect, e.g., the appearance of vaccines; ( P3) local/state-level sensitivity, e.g., many measles cases in NY; (P4) external shock events, e.g., historical flu pandemics; (P5) detect incongruous values, i.e., data reporting errors.
 Categories and Subject Descriptors: H.2.8 [ Database manage-ment ]: Database applications X  Data mining Keywords: Epidemics; Time-series; Automatic mining
Given a huge collection of co-evolving epidemic time-series, such as measles and influenza, how can we find typical patterns or anomalies, and statistically summarize all the epidemic sequences? In this paper, we present a unifying model, namely F UNNEL provides a good description of large collections of epidemiological data. 1 Intuitively, the problem we wish to solve is as follows:
I NFORMAL P ROBLEM 1. Given a large collection of epidemi-ological data, which consists of d diseases in l locations of duration n , with missing values and recording errors, we want to
Uncovering the mechanisms and patterns of contagious diseases is an important and challenging task for public health scientists and policy makers. In this paper, we study a publicly available resource of epidemiological data: Tycho [32], which contains the count of infections of 56 diseases in the U.S, covering over 125 years on a weekly basis. 2 Preview of our results. Figure 1 (a) shows the number of measles cases in the United States from 1928 to 1982, as gray circles, and our fitted model, as a solid red line. The sequence has a clear yearly periodicity, but also characteristic bi-and triennial patterns result-ing in alternating large (1941, 1958) and small (1940, 1947) epi-demic years [22], which is known as  X  X kip X  phenomena [29]. It should also be noted that the number of cases suddenly dropped in 1965. This was achieved because of the vaccination program that started in 1963. Figure 1 (b) shows the potential population of sus-ceptibles for measles for each state in the U.S. The top three states in this respect are, NY, PA, and CA.

Figure 1 (c) shows a scatter plot of the seasonality strength vs. the peak season for each disease. We determined four categories of diseases in terms of (1) the strength of annual periodicity (radius) and (2) their phase difference, i.e., the month in which they peak (angle). For example, we found previously characterized epidemic peaks for influenza in January-February and for respiratory child-hood diseases (e.g., measles) in the spring [ 27], and for tick-borne diseases (e.g., Lyme disease) peaks in the summer [ 28]; There is no periodicity for sexually transmitted diseases, (e.g., gonorrhea).
We can capture these important patterns in epidemic data with our proposed model, simply by changing its parameters. More im-portantly, our method is fully-automatic , that is, it provides a good description of a large collection of epidemiological data, without user intervention, prior training, or parameter tuning.
 Contrast with competitors. Table 1 illustrates the relative advan-tages of our method. Only our approach has checks against all entries, while,
Project Tycho at University of Pittsburgh: http://www.tycho.pitt.edu/ Table 1: Capabilities of approaches. Only our approach meets all specifications.
 Most importantly, none of above are parameter-free methods. Contributions. Our method has the following desirable properties: 1. Sense-making : thanks to our modeling framework, our method 2. Automatic : it is fully automatic, requiring no human inter-3. Scalable : it scales linearly with the input size. 4. Generality : it includes earlier patterns and models as special Outline. The rest of the paper is organized in the conventional way: Next we describe related work, followed by our proposed model and algorithms, experiments, discussion and conclusions.
We provide a survey of the related literature, which falls broadly into two categories: (1) epidemiology, and (2) pattern discovery in time series.
 Epidemiology. The canonical textbook for epidemiological mod-els including SI/SIR is Anderson and May [ 2]. Grenfell et al. [9] studied the recurrent travelling waves for measles, while the work in [8] explained the complex dynamical transitions in epidemics. Stone et al. [29] studied the seasonal dynamics of recurrent epi-demics including measles, and identified a new threshold for pre-dicting the occurrence of either a future epidemic, or a  X  X kip X  (i.e., a year in which an epidemic fails to initiate). Van Panhuis et al. [32] digitized the entire history of weekly Nationally Notifiable Disease Surveillance Reports for the U.S. from 1888 to 2013.
 Pattern discovery in time series. In recent years, there has been an explosion of interest in mining time series [4, 6, 21, 16]. Tra-ditional approaches applied to data mining include auto-regression (AR), linear dynamical systems (LDS), Kalman filters (KF) and their variants [10, 15, 31]. Similarity search and pattern discov-ery in time sequences have also attracted huge interest [33, 13, 30, 26, 7]. Regarding large-scale time-series mining, TriMine [18 ] is a scalable method for forecasting co-evolving multiple (thousands of) sequences, while, [17] developed a fully-automatic mining al-gorithm for co-evolving time sequences. Rakthanmanon et al. [25] proposed a similarity search algorithm for  X  X rillions of time series X  under the DTW distance. Recently, analyses of epidemics, so-cial media, propagation and the cascades they create have attracted much interest [24, 12, 14, 23, 19].

However, none of these methods specifically focused on auto-matic mining of non-linear dynamics in coevolving epidemics.
In this section we present our proposed model. Data description. The Project Tycho [32] covers more than a cen-tury of weekly surveillance reports of nationally notifiable diseases (56 diseases in total) for all 50 states in the U.S, from 1888 to the present, with 87,950,807 reported individual cases for diseases.
This dataset consists of tuples of the form: (disease, location, timestamp) . We then have a collection of entries with d unique diseases, and l states, with duration n (on a weekly basis). We can (a) Influenza (in CA, TX, VA) (b) Measles (in CA, NY, PA) Figure 2: The air temperature vs. # of cases: (a) influenza is completely anti-correlated with the air temperature (i.e., peak-ing in the winter), while, (b) measles also has strong periodicity, but it peaks in the spring (i.e., with a phase shift). treat this set of d  X  l epidemic sequences as a 3rd-order tensor, i.e., X  X  N d  X  l  X  n , where the element x ij ( t ) of X shows the total number of entries of the i -th disease in the j -th state at time-tick t .
For example, ( X  X easles X ,  X  X A X ,  X  X pril 1-7, 1931 X ; 4740), means that the number of cases due to  X  X easles X  in  X  X A X  on  X  X pril 1-7 in 1931 X  is  X 4740 X .

We refer to each sequence of the i -th disease in the j -th state: x ij = { x ij ( t ) } n t =1 , as a  X  X ocal/state X -level epidemic sequence. Similarly, we can turn these local sequences into  X  X lobal/country X -level epidemics:  X  x i = {  X  x i ( t ) } n t =1 ,where  X  x count of the i -th disease at time-tick t , i.e.,  X  x i ( t )= ! Preliminary observations. Here, we provide the reader with sev-eral important observations. Figure 2 shows the scatter plots (top) and sequence plots (bottom) of the original local-level sequences of influenza and measles counts in three states, versus the aver-age air temperature for five years. 3 In Figure 2 (a), influenza cases are strongly anti-correlated with the air temperature, corre-sponding to influenza epidemics in colder seasons. On the other hand, for measles (Figure 2 (b)), the scatter plot exhibits charac-teristic loop shapes, which indicates that there is a phase shift of measles vs. temperature -actually, measles peaks in the spring. As shown in Figure 1 (c), there are several groups of infectious dis-eases with specific seasonal patterns, including children X  X  diseases (e.g., measles, mumps) in the spring, and tick-borne diseases (e.g., Lyme disease) in the summer. Consequently we have: have yearly cycles with different phases, that is, they are correlated with air temperature and the seasons.

The next observation refers to the abrupt decline of several dis-eases. Luckily, many diseases have been eradicated or significantly reduced over the last century, through various factors including vac-cination, sanitation and antibiotics. For example, in Figure 1 (a), the number of measles cases has been decreasing since the vacci-nation program was introduced in 1963. We will collectively refer to such abrupt declines as disease reduction effects.
 fectious diseases have been reduced or eliminated through vacci-nation programs, antibiotics, sanitation, etc.
 Next, let us look at the topic from a local point of view. In Figure 2, three local sequences are correlated with each other, but with different fractions of patients, which correspond to the number of susceptible people in each state. For example, measles mainly affects children, and so, the more children there are, the more cases of measles there will be (see, NY, PA, CA, TX, in Figure 1 (b)). National climate data center: http://www.ncdc.noaa.gov/cag/ each disease, neighbors are correlated with different sensitivity. The last two observations are the extra properties of epidemics. Figure 1 (a) shows large outbreaks of measles in 1941 and 1958, while Figure 2 (a) shows two large flu pandemics in 1944 and 1946. extreme spikes, representing major events such as historical flu pandemics.

Basically, real-world datasets are subject to quality constraints such as typing errors and incorrect reports (we refer to them as  X  X istakes X ).

O BSERVATION 5(M ISTAKES ). There are some implausible spikes, which are completely independent of the dynamics of epi-demic patterns.
 Summary. In this paper, we propose a new model, namely, F UN -NEL , which tries to incorporate all the above important proper-ties that we observed in the real epidemic data. Consequently, we would like to capture the following properties:
For simplicity, let X  X  focus on a simple step first, where (a) we as-sume that we are given a single epidemic sequence, say, the number of measles cases in NY. We then (b) extend our model to multiple co-evolving epidemics, that is, to capture the individual patterns of d diseases in l states.
We begin with the simplest case, where we assume that we are given a single epidemic sequence.
The model we propose has nodes (=people) of three classes:
Figure 3 (a) shows a diagram of our base model, where,  X  ( t ) represents the rate of effective contacts between infected and sus-ceptible individuals;  X  is the rate at which infected individuals re-covered;  X  is the immunization loss probability for a recovered or Figure 3: F UNNEL diagrams: there are three classes -suscep-tible (i.e., healthy, but can get infected), infected (i.e., capable of transmission), vigilant (i.e., healthy, and cannot get infected). vigilant individual. 4 More importantly, to handle the first prop-erty of epidemics: ( P1 ), we assume that the infection rate  X  ( t ) is a periodic function of time t . We refer to it as F UNNEL -
M ODEL 1(F UNNEL -BASE ). Let S ( t ) , I ( t ) , V ( t ) be the num-ber of susceptible, infected, vigilant people at time-tick t .Ourbase model is governed by the following equations: where  X  ( t )=  X  0  X  " 1+ P a  X  cos # 2  X  P and, we have the invariant N = S ( t )+ I ( t )+ V ( t ) , with initial conditions S (1) = N  X  1 ,I (1) = 1 ,V (1) = 0 .
 Consequently, F UNNEL -BASE consists of a set of the following pa-rameters: b = { N,  X  0 ,  X  ,  X  ,P a ,P s } , specifically,
With respect to the second property: ( P2 ), we also introduce an essential concept, namely, the  X  X isease reduction X  effect.
M ODEL 2(F UNNEL -R). We add a disease reduction rate:  X  ( t ) , to capture the effect of the disease reduction program, that is, S ( t +1)= S ( t )  X   X  ( t ) S ( t ) I ( t )+  X  V ( t )  X   X  ( t ) S ( t )
V ( t +1)= V ( t )+  X  I ( t )  X   X  V ( t )+  X  ( t ) S ( t ) (2) where, the disease reduction program started at time t  X  and  X  ( t ) is defined as:  X  ( t )= The model is identical to F UNNEL -BASE , with the addition of the disease reduction factor,  X  ( t ) , which corresponds to the direct im-munization probability when susceptible (see Figure 3 (b)). Note that this effect is due to vaccination, antibiotics and any other anti-disease factors. Hereafter, we simply say the  X  X isease reduction effect X , unless otherwise specified.

In addition to the base parameters b ,F UNNEL -R requires a set of two parameters, r = { t  X  ,  X  0 } ,where,
This factor also incorporates the birth and mortality rate.
We have 52 time-ticks (weeks) in one year.
Next, with respect to the property: ( P4 ), we assume that there are external shock events, such as flu pandemics. So how do we go about capturing such unexpected patterns? Assume that there is a swine flu pandemic. In this situation, many more people in the susceptible class would become infected than in previous years.
An elementary concept we need to introduce is the temporal sus-ceptible rate :  X  ( t ) . Figure 3 (b) describes how this is done. The idea is that the number of susceptibles S ( t ) is the count of vic-tims available for infection, and if there is an external shock event at time-tick t , the virus attacks are much stronger than usual, and, each victim-attack pair would lead to a new victim, and will even-tually cause a major pandemic.

M ODEL 3(F UNNEL -RE). Our full model can be described as the following equations: I ( t +1)= I ( t )+  X  ( t )  X  ( t ) S ( t ) I ( t )  X   X  I ( t ) V ( t +1)= V ( t )+  X  I ( t )  X   X  V ( t )+  X  ( t ) S ( t ) (3) In addition, we introduce the temporal susceptible rate,  X  ( t ) , which is defined as follows: where, k is the number of shocks, and if k =0 , then  X  ( t )=1 . Here, each external shock consists of e ( T ) = { t  X  ,t  X 
So far we have seen how F UNNEL captures the dynamics of a single epidemic sequence. The next question is,  X  X ow can we apply F
UNNEL to multiple co-evolving epidemics in X , and capture the individual behavior of d diseases in l states? X 
We want to estimate the parameter set of F UNNEL , for each in-dividual epidemic sequence in X . The straightforward solution would be that we consider a set of ( d  X  l ) sequences of length n generated from X : { x ij } d,l i,j =1 , (i.e,  X  X ocal-level X  epidemic se-quences), and estimate parameter set: { b , r , e ( T ) } for each se-quence. However, some of the (disease, state) pairs have very sparse sequences (e.g., Lyme disease in Alaska), which derails the fitting result. Also, we are interested in capturing global/country-level patterns, as well as local/state-level trends. So how can we deal with this issue? We thus propose  X  X haring X  the global-level parameters for all l states, to achieve much better modeling. FUNNEL -full model parameter set. Our goal is to extract the main trends and external patterns of co-evolving epidemics X  X  N d  X  l  X  n , and make a good representation of X . Figure 4 shows our modeling framework. Given epidemic data X , we try to find important patterns with respect to the following five aspects, ( P1 ) B : base properties of diseases, ( P2 ) R : disease reduction effects, ( P3 ) N : locations vs. diseases, ( P4 ) E : external shock events, and ( P5 ) M : mistake values. The first two are global/country-level parameter sets, and the third is a local/state-level parameter set, and the last two are used for describing extra trends in X . complete set of parameters (namely, F = { B , R , N , E , M } ) that describe the global/local/extra patterns of epidemics in X .
Next, we will see each property in detail. (P1), (P2) Global/country view. Basically, we assume that the following parameters are the same for all l states. l (e ) external shock tensor E can be described as a set of matrices i.e., { E , E ( T ) , E ( S ) } ,for disease, state, time .

D EFINITION 2(B ASE MATRIX B ( d  X  6) ). Let B be a set of base parameters of d diseases, i.e., B = { b 1 ,..., b d } where b the parameter set of the i -th disease.
 For example, the infection/healing rate of measles should be the same for NY and FL. Similarly, once the measles vaccine has been introduced, (i.e., the disease reduction effect), it could be imme-diately spread all over the country, that is, the starting time of the disease reduction effect would be the same for all locations. D EFINITION 3(D ISEASE REDUCTION MATRIX R ( d  X  2) ).
 Let R be a parameter set of the reduction of d diseases, i.e., R = { r 1 ,..., r d } where r i is the parameter set of the i -th disease. (P3) Local/state view. We also want to analyze and explain local-specific patterns and trends in X . So, what is the difference be-tween measles in NY and in FL ? Our answer is: they are exactly the same, except for the  X  X ocal sensitivity X  of the disease. The idea is that we share the parameters of the global-level matrices for all l states with but one exception, local sensitivity, N ij , which de-scribes the potential population of the disease i in the j -th state. Specifically, we set the invariant, N ij = S ij ( t )+ I ij Model 3. This parameter corresponds to the fraction of individuals who are likely to be infected by the disease. For example, NY has more measles patients than FL, because it mainly affects children (i.e., there were more children in NY than FL, in the last century).
D EFINITION 4(G EO -DISEASE MATRIX N ( d  X  l ) ). Let N be a parameter set of the potential population of d diseases and l states, i.e., N = { N ij } d,l i,j =1 ,where N ij is the potential popula-tion of susceptibles of the i -th disease in the j -th state. (P4) Extra view -external shocks. Consider that in 1946 a serious flu pandemic spread throughout the country. We want to describe this external shock event in terms of three aspects, (disease, state, time) , e.g., (e1)  X  X nfluenza, country-wide, 1946 X . Similarly, there was a community-wide outbreak of cryptosporidiosis in Utah, in 2007. i.e., (e2)  X  X ryptosporidiosis, Utah, 2007 X . To describe these external shock events, we create a new parameter set, namely ex-ternal shock tensor E , which consists of a set of k external shock events, as described in Figure 4 (b).

The external shock tensor E can be also decomposed into three-terns in terms of disease, state, time . A single external shock event can be described as triplet vectors { e ( D ) , e ( S ) , e Figure 5: External shock vs. mistake for giardiasis in 2007: (a) the model (i.e., red line) is greatly influenced by the large distance of the outlier from the original sequence, while (b) it filters out the mistake point, and fits the sequence very well. Specifically, e ( T ) is the global-level parameters, as described in subsubsection 3.2.3 ,and e ( S ) is the local-level parameters, i.e., e the strength of the external shock for l individual locations. That is, the strength of the shock effect in the j -th state is,  X  Consequently, we have the following: 3rd-order tensor of k external shock events, i.e., E = { E E ( T ) } , where triplet matrices show the parameters in terms of three aspects, namely,  X  X isease X ,  X  X tate X , and  X  X ime X . (P5) Extra view -Mistakes. Basically, real datasets contain many errors such as incorrect reports. F UNNEL should detect and filter them out as outliers. We thus introduce an additional concept. tensor of mistake data points, where, the element m ij ( t ) of M shows the entry of the i -th disease in the j -th state at time-tick t . Note that M is very sparse, and very often m ij ( t )=0 .
Figure 5 compares the fitting results of the external shock vs. mistake for the giardiasis cases, which contains an incongruous point in 2006 (approximately, 10 , 000 ). In this case, the point should be treated as (b) a mistake value, instead of (a) an external shock event; in figure (a), the model (red line) is strongly influenced by the extreme point, while in (b), it successfully captures the real patterns of the original sequence. In this section, we describe our fitting algorithm, F UNNEL Our goal is to extract the important patterns of epidemics from X . More specifically, the problem that we want to solve is as follows: P ROBLEM 1. Given a tensor X of ( disease, state, time ) triplets, Find a compact description that best summarizes X , that is, F = { B , R , N , E , M } .
 We want to find a good representation F to solve the problem. The essential questions are: (a) How can we estimate the parameter set that best captures the dynamics and patterns in X ? (b) How should we decide the number of external shocks k ? (c) How can we ignore mistake (i.e., outlier) values in X ?
We provide a new intuitive coding scheme, which is based on the minimum description length (MDL) principle. In short, it follows the assumption that the more we can compress the data, the more we can learn about its underlying patterns.
 Model description cost. The description complexity of model pa-rameter set consists of the following terms, Similarly, the model description cost of the external shock tensor Consequently, the model cost of the external shock tensor E is Cost M ( E )=log  X  ( k )+ k # log( d )+2log( n )+ c F  X  (1 + l ) $ . The model cost of mistake tensor M consists of Thus, Cost M ( M )=log  X  ( | M | )+ ! | M | m log( n )+log  X  ( m ij ( t ))) ,where, | M | is the number of non-zero elements in M .
 Data coding cost. Once we have decided the full parameter set F , we can encode the data X using Huffman coding [3], i.e., a number of bits is assigned to each value in X , which is the log-arithm of the inverse of the probability of the values (here, we use a Gaussian distribution). The encoding cost of X given F I ( t )) ,where, x ij ( t ) , m ij ( t ) are the elements in X and the mis-take tensor M , respectively, and I ij ( t ) is the estimated count of infections (i.e., Model 3). Also,  X  and  X  are the mean and variance of the distance between the original and estimated values. Putting it all together. Consequently, the total code length for X with respect to a given parameter set F can be described as follows:
Here, log  X  is the universal code length for integers.
We used 4  X  8 bits in our setting.
Here,  X  ,  X  need 2 c F bits, but we can eliminate them because they are constant values and independent of our modeling.
 Thus our next goal is to minimize the above function.
Until now, we have seen how we can measure the goodness of the representation of X , if we are given a candidate parameter set F . The next question is, how to find an optimal solution of the full parameter set: F = { B , R , N , E , M } .

As described in subsection 3.3,ourF UNNEL model consists of multiple parameter sets, each of which explains either the local or global pattern of epidemics in X . For example, the base and re-duction matrices B , R explain the global-level behavior of each disease, while the geo-disease matrix N describes the local-level trends. Also, the extra tensors E , M consist of both the global and local-level parameters. More specifically, the external shocks consists of E = { E ( D ) , E ( S ) , E ( T ) } ), where, the first two are the global-level, and the last one is the local-level. Similarly, the mistake tensor can also be describes by the triplet matrix M = { M ( D ) , M ( S ) , M ( T ) } ), each of which describes the location of the mistake values in terms of disease, state, time .So,howcanwe efficiently estimate these model parameters?
We propose a multi-layer optimization algorithm, to search for the optimal solution in terms of both the global and local-level pa-rameters. The idea is that we split parameter set F into two subsets, i.e., F G and F L , each of which corresponds to a global/local-level parameter set, and try to fit the parameter sets separately. Our algo-rithm consists of the following two phases: Here, the global epidemic sequence of the i -th disease:  X  x be described as the sum of the l local sequences, i.e.,  X  x ! j =1 x ij ( t ) . Algorithm 1 shows an overview of F UNNEL Given a tensor X , it finds the full set of F UNNEL parameters. Algorithm 1 F UNNEL F IT ( X ) 2: Output: Complete set of parameters, i.e., F = { B , R , N , E , M } 3: /* Parameter fitting for global-level sequences */ 5: /* Parameter fitting for local-level sequences */
Given a tensor X , our sub-goal is to find the optimal global-level parameter set: F G , to minimize the cost function (i.e., Equation 4 ). We want to fit the basic parameters of each disease (i.e., the base and reduction matrices), and estimate the appropriate number of external shocks and mistake values, simultaneously. Finding the appropriate number of external-shocks/mistakes is a particular is-sue here, because the parameter fittings are very sensitive to out-liers, as described in Figure 5 (a). To find a good basic parameter set for X , we have to filter out the external shocks and mistakes appropriately. Simultaneously, a good external-shock/mistake fil-ter requires a well estimated base model. We escape this circular dependency by applying an iterative method that employs external-shocks/mistakes detection and filtering, and basic model fitting in an alternating way until the cost function reaches a minimum value. Algorithm 2 G LOBAL F IT ( X ) 1: Input: Tensor X 2: Output: Set of global-level parameters F G 3: for i =1: d do 5: /* Initialize external shocks and mistake values for disease i */ 7: while improving the cost do 11: /* Find external shocks and mistakes for disease i */ 12: while improving the cost do 15: /* Compare external shock vs. mistake */ 17: /* External shock wins -treat as an external shock */ 19: else 20: /* Mistake wins -treat as a mistake value */ 22: end if 23: end while 24: end while 25: /* Update parameter set of i -th disease */ 29: end for External shock vs. mistake. There is also an important issue re-garding the external shock vs. the mistake value. We want to distin-guish automatically between an external shock event and a typing error. For example, in Figure 5, there is a clear  X  X ypo X , rather than an external shock event. Our coding scheme enables us to provide the answer. The idea is that we try to fit the parameters by treating the data as both an external shock event and a mistake value, and then compare the cost of the two alternatives. For Figure 5, the cost of (b) is less than (a), thus the algorithm determines that there is a mistake value in 2007.
 Algorithm. Algorithm 2 is a detailed algorithm of the global-level fitting. Given a tensor X , it creates a set of d global sequences: {  X  x i } d i =1 . It tries to fit the global-level parameter set, as well as find the appropriate number of external-shocks/mistakes. We use the Levenberg-Marquardt (LM) algorithm to minimize the cost func-tion. Note that the extra tensors E and M consist of an entry ( disease, state, time ) , but this algorithm can find only the global-level entry, which consists of ( disease, time ) . The local-level entries E ( S ) and M ( S ) can be computed by local-level parame-ter fitting, as shown next in Algorithm 3. Also, the cost function (Equation 4) includes the cost of local-level parameters such as N , but these terms are independent of the global model fitting. Hence, we can simply consider them to be constant.
Given a set of d  X  l local-level sequences, { x ij } d,l i,j =1 and a set of global-level parameters, F G , our next goal is to fit the individual parameters of each disease in each state, that is, F { N , E ( S ) , M ( S ) } . We propose an iterative optimization algorithm (see Algorithm 3). Our algorithm searches for the optimal solution with respect to (a) the geo-disease matrix N , (b) the local-level Algorithm 3 L OCAL F IT ( X , B , R , E ( D ) , E ( T ) , M 1: Input: (a) Tensor X , (b) global-level parameter set F 2: Output: Set of local-level parameters, i.e., F L 3: while improving the cost do 4: /* For each local sequence x ij of i -th disease in j -th state */ 5: for i =1: d do 6: for j =1: l do 8: end for 9: end for 12: end for 15: end for 16: end while external shocks E ( S ) , and (c) the local-level mistake values M so that the total coding cost is minimized.
 L EMMA 1. The computation time of F UNNEL F IT is O ( dln ) .
P ROOF . To create the global-level sequences from X , the algo-rithm requires O ( dln ) time. For global-level parameter fitting, it needs O (# iter  X  ( k + | M | )  X  dn ) time, where # iter is the number of iterations, k and | M | show the number of external shocks and non-zero values in M , respectively. Similarly, for the local-level parameter fitting, it needs O (# iter  X  ( k + | M | )  X  dln ) time to fit the parameters. Note that # iter , k and | M | are small constant values that are negligible. Thus, the complexity is O ( dln ) .
In this section we demonstrate the effectiveness of F UNNEL real epidemic data. The experiments were designed to answer the following questions:
Q1 Sense-making : Can our method help us understand the given Q2 Accuracy : How well does our method match the data?
Q3 Scalability : How does our method scale in terms of compu-
We demonstrate how effectively F UNNEL can learn important patterns given a large collection of epidemics. Figure 6 shows the results of model fitting on 15 typical diseases. We show the original sequences (i.e., black dots) and estimated sequences: I ( t ) (i.e., red line) in linear-linear (top) and linear-log (bottom) scales. In the log-log scale, we also show the susceptible S ( t ) and vigilant V ( t ) counts. We made several important observations, which correspond to the five properties of the epidemic sequences. (P1) Disease seasonality. As we have already seen in the introduc-tion section (Figure 1(c)), we identified four categories i.e., (P2) Disease reduction effects. F UNNEL is capable of automati-cally detecting the disease reduction impact. For example, in Figure 6 Figure 7: The year of vaccine licensure [32] vs. detection.
Figure 8: Local-level fittings for measles: as with the global fitting shown in Figure 1,F UNNEL fits very well.

Figure 9: Fitting accuracy for the (a) global sequences: {  X  x performs the previous models w.r.t. ther RMSE between real and estimated values (lower is better). (a) Diseases ( d ) (b) States ( l ) (c) Duration ( n )
Figure 10: F UNNEL F IT scales linearly: wall clock time vs. dataset size ( d  X  l  X  n ). Our method is linear on the data size. (a-f), most children X  X  diseases include the reduction patterns. Figure 7 shows the year the first vaccine was licensed vs. the year detected as the starting point of the disease reduction effect. Basically, there is a lag of 2-3 years between the licensure and the detected point, which could be related to the diffusion rate of a vaccination pro-gram. Note that F UNNEL does not detect any disease reduction effect for influenza; This is because influenza epidemics continue to occur due to high mutation rates in influenza virus that limit pro-tective immunity. (P3) Area specificity. F UNNEL can find the local dynamics of each disease, as well as the global-level pattern of epidemics. For exam-ple, as described in Figure 1 (b), there are many measles patients in NY and PA. Specifically, Figure 8 shows the original local-level epidemic sequences of measles in (a) NY and (b) PA, and the re-sults of our fittings. F UNNEL successfully captures yearly-periodic patterns, the disease reduction effects, and, also , the local spikes of each location (i.e., notice that the strengths of the external shock effects differ state to state). (P4) External shock events. Figure 6 shows that F UNNEL F IT au-tomatically detects some important external shock events, e.g., (P5) Mistakes. One of the strong points of F UNNEL F IT is its robustness against noise. It can handle  X  X istake X  points as well as missing values (e.g., Figure 6 (i) typhoid fever, which contains missing values in the 1940s, and a mistake value in 1953).
Next, we discuss the quality of F UNNEL in terms of fitting ac-curacy. We compared F UNNEL with the standard SIRS model and SKIPS [29]. To evaluate the effect of the disease reduction param-eters, we also compared with F UNNEL -R, (i.e., removing external shocks and mistakes). Figure 9 (a) shows the root mean square error between the original and predicted counts of the global se-ting accuracy. Note that the SIRS model cannot capture seasonal dynamics, while SKIPS has the ability to capture periodic patterns. Moreover, they are not intended to detect disease reductions, or ex-ternal shocks. As shown in the figures, the SIRS model and SKIPS failed to capture the complicated patterns of epidemics, while our method achieved high fitting accuracy.

We also evaluated the scalability of F UNNEL F IT , and verified the complexity of our method, which we discussed in Lemma 1, in section 4. Figure 10 shows the computational cost of F UNNEL in terms of the dataset size. We varied the dataset size with respect to (a) diseases d , (b) states l , and (c) duration n . As shown in Figure 10,F UNNEL F IT is linear with respect to data size.
Here, we describe important applications and potential directions for our method.
 F
UNNEL at work -forecasting. Since F UNNEL has a very high fit-ting accuracy on real epidemic data, the most practical application would be forecasting. Figure 11 shows results of our forecasting in relation to three different diseases. We trained the model parame-ters by using the 2 / 3 values for each sequence (solid black lines in the figure), and then forecasted the following years (solid red lines). Note that the vertical axis uses a logarithmic scale.

We compared F UNNEL with the auto regressive (AR) model, where we used the regression coefficients: r =52 (i.e., one year), 26 (i.e., half year), and 8 (i.e., the same size as our base (6) + reduc-tion (2) parameters). Also, since the original sequences are bursty we took their logarithm for the AR forecast.
 Our method achieves high forecasting accuracy while AR failed. Specifically, for (a) influenza, and (b) cryptosporidiosis, F captured the future trend correctly, while AR was strongly affected by multiple extreme spikes (e.g., in figure (b), there is a spike in 2007). Similarly, for (c) typhoid fever, which includes the disease reduction pattern, missing/mistake values, F UNNEL successfully forecasted the periodic patterns after the disease reduction effect. Generality -epidemics on computer networks. Another promis-ing step for F UNNEL would be its generalization to other domains such as modeling computer viruses. Computer viruses have similar characteristics to biological viruses [ 11]. For example, Figure 12 shows the fitting result of F UNNEL on publicly available reports Figure 12: F UNNEL is general: our model (solid lines) fits com-puter virus data (in circles) very well. It captures rising spikes and viruse reduction effects (i.e., anti-virus software). Note that it shows the reported case count for each virus. published by IPA, 9 which consists of annual reports on computer virus infections in Japan (e.g., private companies and public schools) covering more than ten years. The figure shows the original counts for the top five viruses (circles) and our fittings (solid lines) from 2000 to 2010. Here are some interesting observations: (a)  X  X ad-trans X  and  X  X lez X  spread in 2001-2002 by exploiting a security hole in Microsoft Outlook. It spread very quickly due to the strong infection effect, but it also decayed very quick thanks to anti-virus software (i.e., the virus reduction effect); (b)  X  X etsky X , which spre ads via email attachment: there were huge infections in 2004, and it gradually decreased over the next 10 years, but still remains. Also, there is a weekly periodicity (i.e., less infection at weekends); (c)  X  X ytob X , which spreads through corporate networks: there are some local-level (i.e., intra-office) infections. Very recently, there have been several worms (e.g.,  X  X oobface X ,  X  X bphotofake X ) that sp read quickly through social networking sites including Facebook and Twitter, where they have a high potential population (# of users).
Our proposed method has the following appealing advantages: 1. It is sense-making :F UNNEL captures all essential aspects, 2. It is automatic :F UNNEL F IT requires no training set and no 3. It is scalable :F UNNEL F IT scales very well, being linear on 4. It is general : We demonstrated the generality of F UNNEL
