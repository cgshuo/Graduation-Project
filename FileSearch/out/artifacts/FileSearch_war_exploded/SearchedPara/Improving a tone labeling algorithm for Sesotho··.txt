 Mpho Raborife  X  Sigrid Ewert  X  Sabine Zerbian Abstract We report on a study that aimed to improve an existing tone label prediction algorithm for Sesotho, an official language of South Africa. Tone is an important prosodic feature of Sesotho, since speakers use tone to distinguish meaning. In order to implement tone in a Text-to-Speech system for Sesotho, a tone modeling algorithm must receive as input the tone labels of the syllables of each word. Then it can predict the appropriate intonation of the word. Since Sesotho does not mark tone labels in orthography, the labels have to be predicted according to the tonal rules of the language. The existing tone label prediction algorithm has two drawbacks, namely it implements three tonal rules only and is restricted to the clitic phrase domain. In our study, we developed an algorithm that implements four additional tonal rules and addresses all parts of speech. The results show that the latter algorithm significantly improves the existing one by increasing the number of matched tone labels.
 Keywords Tone  X  Algorithm  X  Sesotho  X  Bantu languages  X  Text-to-Speech systems 1 Introduction Sesotho is a Bantu language spoken primarily in South Africa and Lesotho. It is an official language in both countries with a reported 4.2 million primary speakers in South Africa and 1.7 million primary speakers in Lesotho (Lewis 2009 ).
Bantu languages are tonal languages with a two-tone level system (high or low); they use pitch variation to distinguish meaning. Tone in Bantu languages may be used to differentiate meaning on a lexical level as shown in Example 1. 1 The word bona has different tonal patterns in this example. It is this difference in tonal patterns that affects the meaning of the word.
 Example 1 bo  X  na - X  X ee X  Tone may also be used to show grammatical relationships. For instance, in Example 2, the first person singular can only be distinguished from the third person by means of tone (Doke and Mofokeng 1957 ).
 Example 2 Ke  X  motho - X  X t is a person X 
Prosody modeling is a fundamental component of any Text-to-Speech (TTS) system. The prosody prediction module of such a system generates, amongst others, pitch, stress and duration as inherent to the language being modeled. This module should generate sound as close to human speech as possible.
 The prosody prediction module in a TTS system for Sesotho has to model tone. can assign the appropriate pitch values to the syllables and generate audible tone patterns.

In Sesotho, tone labels are not marked in orthography. This makes it difficult to investigate the relationship between tone labels and pitch values.

Louw et al. ( 2005 ) listed two prerequisites for successfully modeling tone in Bantu languages that do not mark tone in orthography, such as isiZulu and Sesotho, namely 1. an algorithm that predicts whether a syllable has a high or a low tone, and 2. another that predicts the overall intonation of a word.

An algorithm developed by Raborife ( 2009 ) addresses the first aspect of Louw et al. ( 2005 ) X  X  suggestion, in this case for Sesotho. This algorithm predicts tone labels based on three Sesotho tonal rules, namely the High Tone Spread (HTS1), Iterative High Tone Spread (HTS2) and Grammatical Tone Insertion (GTI) rules, and is restricted to the clitic phrase domain.

The study reported here aimed to improve that algorithm. The algorithm developed by Raborife ( 2011 ) implemented four additional tonal rules, namely the Right Branch Delinking (RBD), Left Branch Delinking (LBD), Specifier High Tone Delinking (SHTD) and the Finality Restriction (FR) rules. Moreover, it was applied to all parts of speech.
Hereafter, we refer to the algorithm developed by Raborife ( 2009 ) as the basic algorithm , and to the current version of the algorithm as the extended algorithm .
The second aspect of Louw et al. ( 2005 ) X  X  suggestion would require an algorithm that would, amongst others, map the tone mark on a syllable to an actual pitch value. Our study did not address this and therefore we cannot at this stage measure how tone affects the perceived naturalness of a TTS system.

In Sect. 2 we give the motivation for the study. In Sect. 3 , we discuss the prosodic hierarchy with reference to the tonal rules of Sesotho. In Sect. 4 we discuss the seven tonal rules that were implemented in the extended algorithm. The context for the research is discussed in Sect. 5 , while the aims are given in Sect. 6 and the approach in Sect. 7 . In Sect. 8 we give more detail about the compilation of the corpus. The output of the algorithms is analyzed in Sect. 9 , while Sect. 10 gives the results in detail. We suggest future work in Sect. 11 and conclude in Sect. 12 . 2 Motivation for the research study Extensive research has been done on modeling tone in East-Asian languages, such as Chinese (Wang et al. 1996 ; Lee et al. 2002 ;Lietal. 2004 ;Nietal. 2008 ). Recently, studies have begun to address tone modeling for languages spoken in Africa, such as Yoruba, a language of Nigeria (O 2008 ). To our knowledge, there is only one publication on modeling tone for Bantu languages, namely on an approach to implement tone in a TTS system for isiZulu (Louw et al. 2005 ). The perceived naturalness and the intelligibility of a TTS system for a tonal language depend heavily on having tone implemented. There is therefore an acute need for research on tone modeling for Bantu languages.

The tone systems of East-Asian languages (e.g., Chinese) and African languages, here specifically Bantu languages, are very different. First, there is a difference in the tonal inventory: Whereas Bantu tone systems have been analyzed as having two surface tone levels (namely high and low), the tonal inventory of East-Asian tone languages is much more complex, both in the number of level tones as well as in the additional presence of contour tones. It can be observed that tone carries a higher functional load in East-Asian languages than in Bantu languages (evidence is, for example, in the number of minimal pairs). Second, due to their agglutinative structure, tones interact strongly with morphology in Bantu languages (see Sects. 3 and 4 below), whereas there are fewer tonal interactions in East-Asian languages.
In Yoruba, tone labels are marked in orthography. To model tone in TTS systems for this language, the tone labels on the syllables were assigned appropriate pitch values, using methods such as fuzzy logic and decision trees (Odejobi et al. 2008 ). In contrast, Bantu languages do not mark tone in orthography. It is difficult to assign the appropriate pitch value to a syllable, since the orthography doesn X  X  indicate whether a syllable has a high or a low tone.
 This problem needs to be addressed if the development of TTS systems for Southern Bantu languages is to keep up with the development of TTS systems for other tonal languages. As mentioned in the previous section, Louw et al. ( 2005 ) suggests a solution, namely algorithms that predict both the tone of the syllables of each word and the appropriate intonation of the word. The authors argue that a TTS system that includes such algorithms, would produce more  X  X atural X  tones.
The study by Raborife ( 2009 ) investigated how an algorithm that predicts the tone of syllables could be implemented. The author came to the conclusion that the algorithm would require linguistically-defined tonal rules to make the tone mark predictions. 3 The prosodic hierarchy with reference to Sesotho According to Zerbian ( 2006 ),  X  X he behaviour of high tones is one of the most fundamental phenomena of Bantu tonology X . Although Bantu languages share the tonal inventory of two surface tones, high and low, the specific rules that target or trigger tonal changes as well as the domains in which tonal rules apply, differ quite considerably across Bantu languages. The current study deals with the tonal rules as they have been reported for Sesotho.

In Sesotho, a high tone does not only surface on the syllable with which it is associated underlyingly, but also on succeeding syllables, as is discussed in Sect. 4 . This does not occur at arbitrary places in a sentence, but within certain phonological (prosodic) constituents, which we discuss in this section. The prosodic hierarchy lists a series of increasingly smaller regions of prosodic constituents (Nespor and Vogel 1986 ), namely the 1. utterance phrase, 2. intonational phrase, 3. phonological phrase, 4. clitic phrase, 5. phonological word, 6. foot, and 7. syllable.

The constituents of this hierarchy form domains within which phonological rules apply. When a phonological (or tonal) rule is restricted within a domain, it only applies if the segments triggering the application of the rule and the segments undergoing the change are all within that domain.
 Some Sesotho tonal rules, e.g., the High Tone Spread and Iterative High Tone Spread rules, are restricted within certain phonological constituents. Consider, for instance, the High Tone Spread rule, which spreads a high tone from the syllable it of the noun stem nama , as shown in Example 3. 2 However, this does not occur. Therefore we place an asterisk before the sentence to show that the behavior of the high tones in the sentence is incorrect. There is no explanation for the high tone on the verb stem not spreading to the first syllable of the noun stem, other than to refer to the prosodic constituent, which in this case is the phonological word. Example 3 *(ke j a  X  ) -na  X  ma word, the clitic phrase and the phonological phrase, since the tonal rules which form the basis of the study are restricted within these constituents. Therefore, we discuss these constituents in the following sections. 3.1 The phonological word The phonological word ( -) is one domain within which the High Tone Spread and Iterative High Tone Spread rules, which are discussed in Sect. 4.1 , apply.
In Sesotho, the phonological word domain for monosyllabic verb stems is different from that for polysyllabic verb stems.

A monosyllabic verb stem and the prefix to its left constitute a phonological word domain as shown in Example 4 (from Khoali 1991 , p. 216). In this example, the verb stem ja is in the same phonological word domain as the object prefix  X e . Example 4 o  X  ya ( e  X  ej a  X  ) -shown in Example 5 (from Khoali 1991 , p. 224). In this example, the verb stem tsamaya is in a separate phonological word domain from the future marker tla . Example 5 o  X  tla  X  (tsamaya) -syllable as a consequence of the High Tone Spread rule, and particles that do not.
In the first case, the particle forms a phonological word with the noun class prefix of the noun stem following it, as is shown in Example 6 (from Khoali 1991 , p. 126). In this example, the particle h  X  belongs to the same phonological word domain as the prefix mo .
 Example 6 (h o  X  mo  X  ) --(rena) -shown in Example 7 (from Khoali 1991 , p. 126). In this example, the particle k  X  belongs to a different phonological word from the noun class prefix of the noun stem following it.
 Example 7 (k e  X  ) -(morena) -own phonological word domain. A special case exists for a noun stem that is preceded by a particle of which the underlying tone spreads by the High Tone Spread rule X  X n this case the class marker of the noun stem and the preceding particle form a single --domain as shown in Example 6. 3.2 The clitic phrase The clitic phrase (C) is one domain within which the High Tone Spread rule applies. A clitic is a word that cannot stand on its own, but has to attach to another word, e. g., the English clitic  X  X  X  in  X  X pho X  X  coming X .

In Sesotho, the clitic phrase consists of the verb stem and all the clitics (prefixes) to the left of it (Khoali 1991 ).

In Example 8 (from Khoali 1991 , p. 216), the polysyllabic verb stem j  X sa forms a This illustrates that the clitic phrase is a higher domain than the phonological word, i.e., the phonological word is contained in the clitic phrase.
 Example 8 ( o  X  ya  X  e  X  (j e  X  sa) -)C by any clitics. Hence the phonological word is equivalent to the clitic phrase, which in this case is equal to a morphological word (the verb stem).
 Example 9 ((paqa  X  ma) -)C such as nouns and adjectives, do not make reference to this domain (Khoali 1991 ). This is shown in Example 10, where the noun p  X di is not contained in a clitic phrase, while the verb stem r  X ta is in the same clitic phrase domain as the subject marker ke that precedes it.
 Example 10 (ke (r a  X  ta  X  ) -)C (p o  X  d X   X  ) -(hah o  X  lo) -the function words preceding it. 3.3 The phonological phrase The phonological phrase ( / ) is one domain within which the Finality Restriction rule applies. In Sesotho, this domain consists of the phrasal head, for example, the noun in a noun phrase, and the words which precede it in that phrase (Nespor and Vogel 1986 ).

Khoali ( 1991 ) uses the concept of Chomsky-adjoined phrases, which are also known as modi fi ers , to define the boundaries of the phonological phrase domain. Modifiers are phrases that are not required for their heads to be meaningful. For example, post-nominal modifiers, such as adjectives, are not needed for a noun to have meaning. This is shown in Example 11 (from Khoali 1991 , p. 67), where the adjectival phrase  X kg  X l X  can be removed without affecting the grammaticality of the sentence. Example 11 (a) P o  X  di e  X  kg o  X  lo  X  e  X  j a  X  mabel e  X  domains than their heads.

The right edge of a phonological phrase domain is inserted by default between a phrasal head and its modifier, as well as at the end of a sentence.

For the first case, consider Example 12 (from Khoali 1991 , p. 196). 3 Here the verb stem r  X ta is followed by an adverb, haholo . Adverbs are modifiers, since they are not Example 12 Ke r a  X  ta) / hah o  X  lo ho tsamaya the last word of a sentence. The sentence can be simple, compound or complex, as shown in 13(a), (b) 4 and (c), respectively (from Khoali 1991 , p. 57). Example 13 (a) Thabo o  X  r a  X  ta  X  p o  X  di) / a sentence, be it simple, compound or complex, as well as immediately before a right edge.

For the first case, consider Example 14 (from Khoali 1991 , p. 57), where the left edge is placed at the beginning of the sentence.
 example, the left edge is inserted immediately after the right edge that follows the noun stem lekala .
 Example 15 (Ke na l e  X  le  X  kala) / (l e  X  le  X  tle) / 4 The phonological rules In this section, we discuss the seven Sesotho tonal rules that are incorporated in the extended algorithm. First, in Sect. 4.1 , we present the three rules that were implemented in the basic algorithm (Raborife 2009 ). Then, in Sect. 4.2 , we present the four tonal rules that were added to the basic algorithm to constitute the extended algorithm. For all rules, we discuss their domain of application with reference to the prosodic constituents. 4.1 Tonal rules in the basic algorithm The basic algorithm incorporates three tonal rules, namely the High Tone Spread, Grammatical Tone Insertion and Iterative High Tone Spread rules. 4.1.1 High Tone Spread rule According to this rule, which is also called the High Tone Doubling rule, e.g., in Demuth ( 1995 ), an underlying lexical high tone spreads to the next syllable.
For instance, in Example 16 (from Demuth 1995 , p. 13), a high tone on the first explain this behavior by referring to the High Tone Spread rule.
 Example 16 ke r e  X  ke  X  la ... domain, as shown in Example 17 (from Demuth 1995 , p. 13), and the clitic phrase domain, as shown in Example 18 (from Demuth 1995 , p. 13).
 In Example 17, the polysyllabic verb stem r  X kela constitutes a phonological word. Therefore the underlying high tone of the verb stem spreads to the next syllable. Example 17 (ke (r e  X  ke  X  la) -)C ... of the verb stem.
 Example 18 ( o  X  (le  X  ma) -)C ... 4.1.2 Grammatical Tone Insertion rule According to this rule, the second syllable of a verb stem is associated with a high tone, as shown in Example 19 (from Khoali 1991 ). Here, batle is the verb stem and the second syllable is tle .
 Example 19 (ha b a  X  (batle  X  ) -)C batho following morphological contexts Khoali ( 1991 ):  X  The imperative mood, which is discussed in detail below.  X  The negative verb form, which indicates a negative of the verb.  X  The participial narrative past tense, which indicates a sequence of past events  X  The habitual verb form, which expresses an action that happens often.  X  The perfect tense, which expresses an action that has been completed.  X  The subjunctive mood, which expresses an action that might occur.
 There is no need to refer to prosodic constituents in the application of this rule.
We only discuss the imperative here. For the morphological formations of all above mentioned contexts, the interested reader is referred to (Doke and Mofokeng 1957 , pp. 184 X 240).

In Sesotho, the imperative mood expresses an instruction, a command or a politely strong request, e.g., thola!  X  X eep quiet! X . This mood always surfaces with a high tone on the second syllable, as shown in Example 20 (from Khoali 1991 ,p. 291). In this example, a high tone surfaces on the second syllable, la , of a verb stem that is underlyingly low-toned. This high tone is referred to as the grammatical tone. Example 20 batla  X  second syllable, as shown in Example 21. In this example, the high tone on the first syllable, ba , of the verb stem batla is acquired by the High Tone Spread rule. Example 21 ( o  X  (ba  X  tla) -)C nama 4.1.3 Iterative High Tone Spread rule According to this rule, a grammatical high tone spreads iteratively within the phonological word domain. For instance, in Example 22 (from Khoali 1991 , p. 293), a grammatical high tone surfaces on the second syllable, r X  , of the low-toned imperative verb kgarakgarametsang . This high tone then spreads iteratively until the end of the verb.
 Example 22 ((kgara  X  kga  X  ra  X  me  X  tsa  X  ng) -)C with the second syllable of a verb stem in a context listed in Sect. 4.1.2 . Therefore the Iterative High Tone Spread rule is ordered after the Grammatical Tone Insertion rule. Furthermore, the former rule applies strictly within the phonological word domain. For instance, the verb stem in Example 22 is polysyllabic and thus forms its own phonological word. The high tone in this example spreads iteratively within the verb stem which constitutes the phonological word domain.

Monosyllabic verb stems show a complex tonal behaviour. For instance, the high tone of an object prefix does not spread to the adjacent monosyllabic verb stem as would be expected by the High Tone Spread rule (Khoali 1991 ). Therefore, both the basic and the extended algorithms were restricted to polysyllabic verb stems. 4.2 Tonal rules in the extended algorithm In this section we discuss the four tonal rules that we added to the basic algorithm in order to improve it. These are the Right Branch Delinking, Left Branch Delinking, Specifier High Tone Delinking and Finality Restriction rules. 4.2.1 Right Branch Delinking rule According to this rule, the right branch of a multiply-linked high tone is disassociated in all cases where a high tone immediately follows the target syllable Khoali ( 1991 ). A multiply-linked high tone is a high tone that is linked to more than one syllable after the application of a tone spread rule, eg., High Tone Spread rule, where the high tone of the source syllable is linked to both the source and the target syllables.

For instance, suppose the High Tone Spread rule spreads an underlying high tone r  X  2 has a high tone, then the high tone which has spread to and therefore r i  X  1 will have a low tone.

Consider Example 23 (from Raborife 2009 , p. 43). We would expect the present tense marker X  X he first instance of a  X  X o surface with a high tone after the high tone on the subject marker, b  X  , has spread to a . However, a is followed by a high-toned verb stem,  X ga . Therefore the high tone that is linked to both b  X  and a ,is disassociated from a .
 Example 23 B a  X  a a  X  ga ba n  X  na a  X  mo  X  tse b a  X  a a  X  ga. clitic phrase domain span rule.

Example 24 (from Khoali 1991 , p. 143) shows the application of this rule within the phonological word domain. In this example, the high tone on the second followed by a high-toned syllable, t  X  . Therefore the high tone on le is delinked. Example 24 (leb e  X  let e  X  ) -the clitic phrase domain. In this example, the high tone on the subject marker X  X he first instance of b  X   X  X preads to the past tense marker ne by the High Tone Spread rule. Therefore this high tone is linked to both b  X  and ne . However, ne is followed by a high-toned subject marker, b  X  . Therefore the high tone on ne is delinked and ne surfaces with a low tone.
 Example 25 (B a  X  ne b a  X  (tsa  X  maya) -)C 4.2.2 Left Branch Delinking rule According to this rule, the left branch of a multiply-linked high tone is disassociated if it is preceded by a high tone Khoali ( 1991 ).

For instance, suppose the High Tone Spread rule spreads an underlying high tone the syllable r i 1 has a high tone, then the high tone on r i will be delinked and therefore r i will have a low tone.
 The Left Branch Delinking rule is a phonological word domain span rule.
Consider Example 26 (from Khoali 1991 , p. 254). Since the verb stem high tone by the Grammatical Tone Insertion rule. This high tone then spreads by the Iterative High Tone Spread rule to the penultimate syllable, me . However, the first syllable, kg  X  , is high-toned. Therefore the high tone on ru is delinked and ru surfaces with a low tone.
 Example 26 ha ke kg u  X  r u  X  kgu  X  ru  X  me  X  tse  X  in Example 27, where the term reduplication refers to the repetition of the stem of a word. The explanation of the application of the Left Branch Delinking rule given for Example 26, holds for Example 27 too. In the latter example, all the syllables involved in the application of this rule are within the same verb stem. Example 27 (ha ke (kg u  X  r u  X  me  X  tse  X  ) -)C 4.2.3 Speci fi er High Tone Delinking rule According to this rule, a high tone on an object concord or reflexive prefix is delinked if they are not in the same phonological word as the stem (Khoali 1991 ). This rule only delinks the high tone after the High Tone Spread rule has been the rule differs from the Left Branch Delinking rule, which only applies when the high tone on the source syllable is linked to both the source and the target syllables.
Example 28 (from Khoali 1991 , p. 274) shows an underlyingly high-toned object prefix, m  X  , surfacing with a low tone. This occurs because the high tone on m  X  spreads by the High Tone Spread rule to the first syllable, kga , of the verb stem kgarameditse . Then the high tone on m  X  delinks, as it is not in the same phonological word domain as kgarameditse .
 Example 28 ( o  X  mo (kga  X  r a  X  me  X  d X   X  tse  X  ) -)C 4.2.4 Finality Restriction rule According to this rule, syllables at the end of a phonological phrase are exempted from the application of tonal rules Khoali ( 1991 ).
In Example 29 (from Khoali 1991 , p. 38), we would expect the high tone on the High Tone Spread rule. However, a high tone on ka is blocked by the Finality Restriction rule.
 Example 29 ((ho (r e  X  ka) -)C) /
In Example 30, the second syllable, ka , of the verb stem r  X ka surfaces with a high tone. This syllable is not at the end of the phonological phrase domain and thus the Finality Restriction rule does not apply. However, this rule does apply in the noun b  X ka to spread to the second syllable, ka . However, ka is at the end of the phonological phrase domain. Therefore, by the Finality Restriction rule, it surfaces with a low tone.
 Example 30 ((ho (r e  X  ka  X  ) -)C (b u  X  ka) -) / 5 Research context The intelligibility of Text-to-Speech systems depends heavily on reliable tone and intonation models (Zerbian and Barnard 2008 ). However, not much research has been done on developing tone models for Bantu languages. Louw et al. ( 2005 ) attempted to implement tone into a TTS system for isiZulu. However, the authors concluded that treating all tones as unmarked would produce more understandable speech than their system. They then suggested that algorithms that could predict the tone labels of syllables and the appropriate intonation of words, would result in TTS systems producing more natural tones.

Zerbian and Barnard ( 2010 ) discussed the steps that are necessary to develop such algorithms, specifically for the Sotho-Tswana languages. Steps 1 and 2 are discussed in Sect. 7 . The basic algorithm implements Steps 3 and 4 of the above hierarchy, but for three Sesotho tonal rules only (Raborife 2009 ). We aimed to improve this algorithm in order to increase the number of matched tone labels between the labels given by transcribers and the labels output by the algorithm, where the term matched tone label indicates a label predicted by an algorithm that is exactly like its transcribed counterpart. Steps 1 X 4 are as follows. 1. Morphological analysis: This is important for the tagging of both parts-of-2. Pronunciation dictionaries: These are required for assigning tone patterns to 3. Algorithm for prosodic phrase boundaries: In the Sotho-Tswana languages, a 4. Application of the tonal rules: Once the above three steps have been
Our analysis at the current stage does not consider where we obtain the underlying labels. One could obtain such labels by, for example, semantic analysis or recordings of human speech. 6 Research aims We sought to improve the basic algorithm by Raborife ( 2009 ). This involved the following:  X  Implementing four additional tonal rules.  X  Extending the application of the tonal rules to other parts of speech, e.g., adverbs  X  Implementing the tonal rules on each verb stem independently in sentences that 7 Approach Table 1 provides an overview of the processes involved in our study, where the processes correspond to Steps 1 X 4 of Sect. 5 .

The first two steps were done manually, since currently a morphological analyzer and a tone-marked pronunciation dictionary do not exist for Sesotho. In the final step, the high tone spread occurs within the phonological word domain for the noun stem, and within the clitic phrase domain for the verb stem and its preceding clitics.
The following sections describe the processes in detail. 7.1 Preparation of input data The first two steps in Table 1 represent the processes required to prepare the sentences that would be used to test the algorithms, in particular, tagging the parts-of-speech of the words in the sentences, and marking the underlying tone labels on the syllables. 7.1.1 Part-of-Speech tagging We tagged the POS category of each word using the dictionary by Du Plessis et al. ( 1974 ). This was important for two reasons. Firstly, the Grammatical Tone Insertion rule applies only to words of certain grammatical categories. Secondly, the extended algorithm uses grammatical information as a cue when inserting phonological boundaries. Faasz et al. ( 2009 ) describes an automatic POS tagger developed for Northern Sotho. In our study, it was not sufficient to tag just the parts-of-speech. We also needed information on whether a particle spreads or not, and whether a certain word precedes a modifier. In the latter case, the extended algorithm would insert the right edge of the phonological phrase domain before this word.

Our study would have been facilitated by a refined POS tagger, which is both a morphological analyzer as well as a POS tagger. However, to our knowledge, there is currently no refined POS tagger for the Sotho-Tswana languages. 7.1.2 Labeling of underlying tones According to Schadeberg ( 1981 ), there are only two Sesotho dictionaries that study, we used Du Plessis et al. ( 1974 ) to mark the underlying tones, since we could not find a copy of Mabille et al. ( 1961 ). According to our knowledge, the dictionary by Du Plessis et al. ( 1974 ) is the most recent tone marked Sesotho dictionary. Some of the words we used were not in Du Plessis et al. ( 1974 ) and we had to consult other sources.
 The result of high tone spread is presented by Du Plessis et al. ( 1974 ) as follows: Example 31 re  X  ke  X  la spreads to the second syllable, ke . We know that the high tone on the second syllable is not underlying, as it would have been deleted by the Meeussens rule, a rule that deletes the second high tone of two adjacent underlying high tones (Khoali 1991 ). In our study, we did not tag high tones which are a consequence of the High Tone Spread rule, since this rule is implemented by the basic algorithm (Raborife 2009 ).
As a further example, the dictionary Du Plessis et al. ( 1974 ) marks the tones of the noun stem kunutu as k X n X t X  . We can assume that the high tone on n X  is not underlying, but a consequence of the High Tone Spread rule. This high tone is delinked by the Right Branch Delinking rule. Since we only tagged underlying tones, we assumed the following marking: Example 32 ku  X  nutu  X  7.2 The algorithm The last two steps in Table 1 were the focus of the study that implemented the extended algorithm. As said above, the algorithm assumes that there are no monosyllabic verb stems in the input.

The algorithm first inserts the phonological domains within which the tonal rules apply, and then applies the rules. In this section, we present an overview of the extended algorithm, as well as pseudo-code for it. Then we briefly address the time complexity of the algorithm. 7.2.1 Insertion of phonological boundaries The tonal rules apply within three phonological domains, namely, the clitic phrase, the phonological word, and the phonological phrase.

The clitic phrase The clitic phrase domain is only defined for verb stems. For each verb stem, the algorithm inserts  X  the right edge of the domain immediately after the stem, and  X  the left edge before the closest subject marker preceding the stem. The phonological word In order to insert the phonological word domain, the algorithm determines the part-of-speech category of each word. If the word is  X  a content word, but not a noun, the algorithm inserts this domain around the  X  a noun, the algorithm checks if the word preceding it is a particle that spreads by The phonological phrase In order to insert the phonological phrase domain, the algorithm inserts a right edge  X  between a head and its modifier, where the head of a phrase defines its category,  X  after the last word of a sentence.
 It then inserts a left edge  X  immediately after every right edge, as well as  X  before the first word of a sentence. 7.2.2 Application of the tonal rules The algorithm searches for all clitic phrases in a sentence and applies the High Tone Spread rule within each clitic phrase.

Following the processing of the clitic phrases, the algorithm then searches all phonological words in a sentence. For each phonological word, it checks the part of speech of the word within the phonological word. If the word is a verb stem, it checks the tense, mood and aspect (TMA) of the verb stem. If the TMA of the verb stem falls in the category that allows for the application of Grammatical Tone Insertion rule, the algorithm applies this rule followed by the Iterative High Tone Spread rule. Otherwise, the algorithm applies the High Tone Spread rule and then the Right or Left Branch Delinking rule, as applicable. If the word within the phonological word is not a verb stem, the algorithm applies the High Tone Spread rule and then the Right or Left Branch Delinking rule, as applicable.
After processing all the phonological words, the algorithm searches for all the phonological phrases in a sentence. For each phonological phrase, the algorithm checks the final syllable in the domain and lowers it if it is a high tone.
Moreover, after any application of the High Tone Spread rule, the algorithm applies the Specifier High Tone Delinking rule. This changes the tone on all object concords to low.
 Algorithm 1 presents pseudo-code for the extended algorithm.
 7.2.3 Trace of the extended algorithm on a sentence Consider the sentence in Example 33 (from Khoali 1991 , p. 224).
 Example 33 o  X  tla tsamaya Table 2 shows the trace of the algorithm on this input.

The input sentence is  X  tla tsamaya . The algorithm first inserts the prosodic boundaries:  X  The clitic phrase domain consists of the verb stem, tsamaya , and all the clitics  X  There are two phonological word domains:  X  The phonological phrase domain consists of the whole sentence, i.e.,  X  tla
The sentence has a future tense morpheme tla . The Grammatical Tone Insertion rule doesn X  X  apply in this context.

In the clitic phrase, the algorithm applies the High Tone Spread rule. As a result, the high tone on the subject concord o spreads to the future tense marker tla .
The algorithm then examines each phonological word. However, none has the context required for the application of the High Tone Spread rule.

The algorithm finally examines the phonological phrase domain, in particular, the rule does not apply. Moreover, the Specifier High Tone Delinking rule does not apply, because there are no object concords in the input.

The algorithm outputs the sentence  X  tl X  tsamaya . 7.3 Time complexity An inspection of Algorithm 1 shows that there are no nested loops. Therefore the time complexity for processing one sentence is linear in the number of syllables in that sentence.

In the next section we discuss how the sentences used to test the extended algorithm were compiled, recorded and transcribed. 8 Corpus compilation A detailed description of the corpus compilation is provided in Raborife et al. ( 2011 ). In this section, we provide an overview.

Forty-five sentences were chosen from a large corpus of Sesotho data. 5 These sentences were chosen to reflect the phonological boundaries of interest in our study, ranging from a sentence of length 3 to a sentence of length 11. We considered the syllables, since this is the level on which the rules apply, as bounded by phonological structures. The sentences were selected to include the following:  X  The present principal tense.  X  The past tense.  X  The perfect tense.  X  The imperative mood.  X  The future tense.
 The sentences did not include the following:  X  Proper nouns and loan words, since their tone patterns are not available in the  X  Verb forms in the Potential Mood, i.e., forms using -ka , since the tonology of  X  Monosyllabic verb stems, since they have complex tonal characteristics (Khoali
The extended algorithm output the 45 sentences with the predicted tone marks on the syllables. To evaluate the algorithm, we compared its output to speech recorded by a native Sesotho speaker. We did not have pre-recorded Sesotho sentences. Therefore the sentences were recorded by three native Sesotho speakers. The speech had to be encoded in a way that would allow this comparison, that is, it had to have high and low tone marks. We therefore transcribed the recorded speech to orthography and added tone marks on the syllables.

In the next sections, we discuss the recording process as well as the transcriptions. 8.1 Recording process Three native Sesotho speakers (or respondents) each recorded all 45 sentences. They were not remunerated.

Before recording the sentences, each speaker recorded eight Sesotho tonal minimal pairs, where such a pair consists of two words or phrases that are spelled identically, but differ in tone, and have different meanings. These minimal pairs were used to select the respondent with the most pronounced tones, as discussed below.
 Neither the minimal pairs, nor the sentences, had tone labels. However, the English meaning for the minimal pairs was given beneath the sentence or phrase in order to guide the respondent as to which tone pattern was to be pronounced for each word or phrase. 8.2 Speaker selection It was not necessary to transcribe the recordings by all three respondents, because the tonal rules implemented by the algorithm are not restricted to speakers of a specific Sesotho dialect. We therefore used only one respondent X  X  recording. We chose the respondent who had produced the largest number of clearest tones, where  X  X learest X  refers to the most pronounced tones.
We used two processes to choose the speaker with the clearest tones. Firstly, to determine the speaker X  X  ability to distinguish tone, we used eight tonal minimal pairs. Secondly, the clarity of the tones produced by each speaker was verified perceptually and acoustically using a speech software with a pitch tracking algorithm.
 We named the respondents 1, 2 and 3.
 Respondent 3 could not identify the tonal distinction in one of the minimal pairs. We thus excluded this respondent X  X  recording from the transcriptions.
Respondent 2 spoke in an unnatural voice and exaggerated the tone and words. In some instances, this respondent produced each word without taking the context into consideration. This is problematic, since the tonal rules are restricted within phonological boundaries, and some rules in specific morphological contexts. Moreover, a word in isolation might be tonally ambiguous and one would need the context to pronounce the appropriate tone pattern.
 We consequently also excluded respondent 2 X  X  recording.

Respondent 1 produced clear tones and spoke in a natural voice. This respondent X  X  recording was transcribed by three independent labelers, each with some experience in tonal studies. The transcriptions are in orthography with added tone labels. In the next section, we discuss how the labelers transcribed the speech. 8.3 Transcription of sentences 8.3.1 Transcription process The transcription of prosody is widely used in linguistic research as well as in the development and testing of speech systems Syrdal and McGory ( 2000 ). It is used to understand linguistic variables and their relation to the interpretation of human speech.

In our study, three independent expert labelers transcribed tone as perceived from respondent 1 X  X  speech. The transcriptions represent spoken language in written form with added tone labels.

We used transcriptions to evaluate our algorithm, since they represent Sesotho speech as pronounced by a native speaker. Given that our algorithm was developed for tone modeling in a Sesotho TTS system, it is crucial that the tone labels predicted by our algorithm match those in the transcriptions.

We did not use any statistical methods to predict the tone labels, since such methods are not based on perception, and thus cannot give us an indication of how well our algorithm can fare on a perception test. However, we used statistical methods to establish the reliability of the transcriptions as discussed in the next section.
 Initially, we aimed to use 12 labelers to transcribe respondent 1 X  X  recording. These labelers were to be divided into two groups, six being experts in tonal studies and the other six having no experience in tonal studies. In each of the two groups, three labelers were to be native Sesotho speakers and the other three were to be speakers of non-tonal languages. However, we could only find three labelers who are experts in tonal studies, while we found six labelers who are not experts. Table 3 summarizes the characteristics of the labelers.

The labelers in the non-expert group X  X ven the native speakers X  X ad difficulty transcribing the tone labels. Transcribing tone is an acquired skill. Moreover, native speakers of tonal languages in South Africa are usually not aware of their language X  X  tonal system, as this is not taught at school.

Since there were more labelers in the non-expert group, they would have outnumbered the expert labelers in the majority vote used to choose the tone label of a syllable in those cases where the labelers did not agree. Thus, we chose to use only the three expert labelers for the transcriptions.

The transcribers have different backgrounds in tonal studies, with two being linguists and the third a speech engineer. Furthermore, two of the transcribers are speakers of Germanic languages (linguist A and speech engineer B) and the third is a native Sesotho speaker (linguist C). They have the following backgrounds in tonal studies: A and B have developed a framework that introduces an algorithm that derives word-level tone assignments for the Sotho-Tswana languages (Zerbian and Barnard 2010 ). Labeler C implemented this framework by developing the basic algorithm (Raborife 2009 ).
 As far as we know, currently a framework for tone transcription does not exist for Bantu language, thus, the labelers could not be given a training manual. Consequently, they relied on perception and acoustic means to label the tones. The transcriptions were compared across the labelers, resulting in an agreement of 55.9%, or 316 out of 565 tone-bearing syllables. In the cases where all three labelers didn X  X  agree, the final tone label was decided by a majority vote.

The agreement between the transcribers is given in Table 4 . 8.3.2 Inter-transcriber reliability As stated above, the three labelers reached agreement on the tone labels in 55.9% of the cases. A reason for such a low agreement might be that perception is subjective and that the transcribers did not have a training manual. Another factor might be that our labelers had experience with tone, even though two of them are speakers of non-tonal languages. Studies have shown that speakers of non-tonal languages are less sensitive to the perception of tone, even if they are not necessarily  X  X one deaf X  (Halle et al. 2004 ; Gandour and Harshman 1978 ).

The transcriptions formed a central part in evaluating our algorithm. Since there was a fairly low agreement between the transcribers, it was important to statistically verify the reliability of the transcriptions. For this purpose, we used the kappa ( j ) coefficient, which is a statistical measure used in observer reliability studies for analyzing the reliability of agreement between a number of labelers (or raters) (Fleiss 1971 ; Brennan and Prediger 1981 ; Randolph 2005 ). This statistical measure is more reliable than a simple percentage agreement calculation, since it takes into account the agreement occurring by chance between labelers.

Fleiss X  kappa is a well-known multi-rater kappa that assumes that raters are forced to assign a certain number of cases to each category. Hence, it is referred to as a fixed-marginal kappa Brennan and Prediger ( 1981 ). For instance, in our study, it would assume that the labelers were restricted in the number of syllables (cases) they could assign to each of the tone labels (categories). However, our labelers were free to assign any number of syllables to each of the two tone labels. We thus used a free-marginal kappa, as proposed by Brennan and Prediger ( 1981 ). Randolph ( 2005 ) defines the free-marginal kappa, j , as follows: where P is the observed agreement, while P e is the agreement expected by chance, i.e., as if the raters had simply guessed every rating.

According to Fleiss ( 1971 ), the factor 1 P e gives the agreement that is attainable above chance, while P P e is the degree of agreement achieved above chance. If j = 1, then there is complete agreement between the labelers. If j 0 , then there is no agreement other than what would be expected by chance.
The free-marginal j -value between three labelers that assigned 565 syllables to two categories, as calculated by Randolph ( 2008 ), is as follows: j  X  0 : 41 .To interpret this value, we use Table 5 (Landis and Koch 1977 ). According to this, the labelers were in moderate agreement. Thus we may use the transcriptions to evaluate the extended algorithm.
 9 Analysis The analysis of the basic algorithm in the study by Raborife ( 2009 ) has shown that there are at least three other tonal rules that need to be implemented into TTS systems necessary for tone modelling, namely, Right Branch Delinking, Left Branch Delinkingand Finality Restriction. The Finality Restrictionaccounted for a signif-icantly large amount of the mismatches in that study. The EA extends the BA by applying these rules in addition to the Specifier High Tone Delinking. 9.1 Introduction In the analysis we compared both the tone labels predicted by the basic algorithm, and those predicted by the extended algorithm, to the tone labels in the transcriptions.

This analysis covered the tone labels of all syllables in the phonological phrase domain. Since the basic algorithm is restricted to the clitic phrase domain, we used the underlying tones as defined by Du Plessis et al. ( 1974 ) for all syllables outside this domain when comparing the labels predicted by the basic algorithm to their transcribed counterparts.

Consider Example 34. The transcribed sentence and the output by the basic algorithm are given in the lines labeled TR and BA, respectively. In this example, there are five mismatches between the transcription and the basic algorithm. Two are in the clitic phrase; the other three are outside the scope of application of this algorithm.

It seems that in the transcription, the underlying high tone is on the second syllable, n , of the verb stem kganna and spreads to the last syllable, na by the High Tone Spread rule. In contrast, the basic algorithm applies the High Tone Spread rule stem spreads to the second syllable, n .
 Example 34 TR: Mod X   X  sa  X  na o  X  kgan  X  na  X  dinku tse  X  sekete. sentence. Here EA labels the output of the algorithm. In this example, there are three mismatched syllables. The first two mismatches are in the clitic phrase domain and were discussed above. The third mismatch is on the last syllable, ku , of the noun syllable is underlyingly high-toned.
 Example 35 TR: Mod X   X  sa  X  na o  X  kgan  X  na  X  dinku tse  X  sekete. the basic algorithm in terms of the number of matches between the tone labels assigned by the transcribers and the labels output by the algorithm. The basic algorithm yielded 365 matched labels out of 565, while the extended algorithm yielded 409 matches. Table 6 summarizes the results.

In the next section, we provide an analysis of the mismatches between the extended algorithm and the transcriptions. 9.2 Analysis There are 565 tone-bearing syllables in the 45 sentences. In total, there were 156 mismatches between the extended algorithm and the transcriptions. We grouped the sentences according to the similarities found in the mismatches. This yielded six groups, called B X  X . Table 7 shows the number of mismatches in each of these groups. 9.2.1 Group B In this group, the transcriptions give underlying high tones at the end of the phonological phrase as low tones. This cannot be as a consequence of the Finality Restriction rule, since the high tones are underlying and not the result of a high tone spread.

A rule that can account for this is the Mid-Tone Insertion rule Khoali ( 1991 ). By this rule, a high tone on the final syllable of a phonological phrase domain that follows a falling tone, or HL-tone, is realized as a mid-tone Khoali ( 1991 ). However, the transcribers used only two tone levels, high and low, and not the mid-tone. Therefore they assigned a low tone to the syllables which meet the requirements of the Mid-Tone Insertion rule. On the other hand, the extended algorithm does not implement the Mid-Tone Insertion rule either, and left the high tone on the above syllables.

Consider Example 36, in which the diacritic  X  indicates a mid-tone. In this example, the underlying high tone on the final syllable, na , of the pronoun lona surfaces as a low tone. This syllable is at the end of the phonological phrase domain. The two syllables preceding it, ya and lo , have high and low tones respectively; together they form a falling tone. By the Mid-Tone Insertion rule, na is realized as a mid-tone. However, the labelers indicated a low tone.
 Example 36 ((Re tla (hl  X   X  pha) -)C (meetlo) -) / (y a  X  (lona  X  ) -) / 9.2.2 Group C In this group, the transcriptions show a pattern where an underlying high tone on a High Tone Spread rule. The high tone on r i  X  1 then spreads to the next syllable, say r  X  2 , while the high tone on domain span rule. Moreover, the clitic phrase affected must not be the last such phrase in the phonological phrase domain that contains it.

Consider Example 37. According to Du Plessis et al. ( 1974 ), the subject marker a in the second clitic phrase is underlyingly high-toned, while the first two syllables, fe and to , of the verb stem fetoha are underlyingly low-toned. However, a surfaces with a low tone. The syllable fe surfaces with a high tone as a result of high tone spread from a to fe . The syllable to also surfaces with a high tone. Since fe is underlyingly low-toned, the high tone on to cannot be a result of high tone spread from fe . It seems to be associated with a . In other words, the high tone on a spreads to the next two syllables before delinking on the source.
 9.2.3 Group D In this group, a syllable which is underlyingly high-toned according to Du Plessis et al. ( 1974 ), is indicated as low-toned by the transcribers, and vice versa.
Consider Example 38 (from Khoali 1991 , p. 126). The preposition ho is underlyingly high-toned according to Du Plessis et al. ( 1974 ). Therefore the algorithm indicates ho as high-toned. Moreover, it applies the High Tone Spread rule and spreads the high tone on ho to the first syllable, mo , of the noun morena .In cannot apply the High Tone Spread rule and therefore also indicate mo as low-toned.

In summary, there are two mismatches between TR and EA. The first is because of the difference in underlying tones, and the second a consequence of the first. Example 38 TR: ho morena
Recall that there is only a moderate agreement between the transcribers. It is therefore possible that the mismatches in this group are due to chance agreement between the labelers. Moreover, it is possible that the literature Du Plessis et al. ( 1974 ) is not accurate, or that the speaker has different tone assignments compared to the literature of 1974. 9.2.4 Group E In this group, trisyllabic noun stems. 6 at the end of the phonological phrase domain surface with high tones on their first syllables and low tones on the succeeding
Consider Example 39. According to Du Plessis et al. ( 1974 ), the noun stem dipotso has an underlying high tone on its second syllable, po . Therefore the algorithm outputs it as high-toned. However, the transcription indicates po as low-with a high tone, even though all class markers are underlyingly low-toned according to Khoali ( 1991 ).
 Example 39 TR: O  X  tla u  X  tlwa  X  ba  X  bo  X  tsa  X  d X   X  potso 9.2.5 Group F The mismatches in this group show patterns that are neither represented in Groups B X  X , nor explained by any of the tonal rules discussed in Khoali ( 1991 ). Further research on the tonal behaviour of Sesotho may provide reasons for these mismatches. 10 Results Our hypothesis stated that there would be more matched tone labels between the extended algorithm and the transcriptions than between the basic algorithm and the transcriptions. To test the hypothesis, we compared the algorithms in two phases, namely where 1. both algorithms were restricted to the clitic phrase domain, and 2. both algorithms were applied to the whole input.
 In both cases, we determined the statistical significance of the comparison. To do so, there is a significant difference between two groups of dependent samples Boslaugh and Watters ( 2008 ). It is mainly used when the variances of two normal distributions are unknown and the sample size is relatively small.

A t -test may be one-tailed or two-tailed. A one-tailed test indicates the difference between groups and the direction of the difference. A two-tailed t -test indicates the difference between groups only. We used the one-tailed t -test.

For our case, the t -value is calculated as where, for alg 2f EA ; BA g ,  X  p alg 2 X  0 ; 1 is the probability that the algorithm alg will produce a matched  X  N alg is the total number of tone labels used by algorithm alg ,
The t -value has a distribution df with N EA  X  N BA 2 degrees of freedom 7 that advances the normal distribution. In our case, df  X  N EA  X  N BA 2  X  565  X  565 2  X  1128 1 , where 1 indicates infinity.

To test significance, we set a significance level, a . Generally, a result of probability greater or equal to 0.05 is considered significant.

We then compared the t -value to the appropriate critical t -value in the t -test table (see Boslaugh and Watters ( 2008 ) for the t -test table). The critical t -value is calculated by aligning a  X  0 : 05 with df 1 . This gives a critical t -value of 1.645. In other words, if t 1 : 645 , then the extended algorithm is significantly better than the basic algorithm.

In the following sections, we discuss the two phases listed above in detail. 10.1 Restriction in the application of the algorithms In this phase, we considered the performance of the algorithms on the clitic phrase domains of the 45 selected sentences. The syllables that are outside the clitic phrase domains were excluded, leaving 327 syllables.

For each algorithm, we compared its predicted tone labels to the tone labels in the transcriptions. The basic algorithm yielded 194 matched labels, while the extended algorithm yielded 226. Therefore the latter predicted 32 more labels correctly. To statistically verify the results, we performed the t -test.

Firstly Then Since t [ 1 : 645 , the extended algorithm is a significant improvement on the basic algorithm in the clitic phrase domain. 10.2 No restriction in the application of the algorithms The previous section shows that the extended algorithm is an improvement on the basic algorithm when both algorithms are restricted to the clitic phrase domain.
In the second phase, we considered the performance of the algorithms on the whole sentence, in total 565 syllables. When we evaluated the basic algorithm, the syllables outside the clitic phrase domain were assigned their underlying tones as defined in Du Plessis et al. ( 1974 ).

For each algorithm, we compared its predicted tone labels to the labels in the transcriptions. The basic algorithm yielded 365 matched tone labels, while the extended algorithm yielded 409. Therefore the extended algorithm predicted 44 more labels correctly.

To statistically verify the results, we performed the t -test. Firstly Then Since t [ 1 : 645 , the extended algorithm is a significant improvement on the basic algorithm on the whole sentence. 11 Suggestions for further research This study provides the first step towards tone modeling for Bantu languages that do not include tone in orthography, such as Sesotho. A tone modeling algorithm for such languages requires tone marks on syllables in order to assign appropriate pitch values to the syllables and consequently predict the overall intonation of the word.
The study for Yoruba by Odejobi et al. ( 2008 ) predicts the overall intonation of a word using decision trees which are based on tone labels in orthography. This involves predicting, say, the pitch value to be assigned to a high tone that is preceded by a high tone. Such an algorithm can now be developed for Sesotho, since we have a tone label predictor for this language.

Currently, our algorithm is not fully integrated into a TTS system due to the lack of the necessary linguistics resources, such as a Sesotho tone-marked pronunciation dictionary. Until this has been done, we cannot verify the extent to which implementing tone in a TTS system for Sesotho affects the perceived naturalness of the system. Once an algorithm that assigns pitch values to the tone labels predicted by our algorithm has been developed, a perception test should be conducted. Such a test would allow native speakers of Sesotho to grade the synthesized speech. 12 Conclusion Our main aim was to improve the basic algorithm developed by Raborife ( 2009 ), which predicts the tone labels on syllables in Sesotho sentences, using three Sesotho tonal rules. We have improved this algorithm by implementing its extended version, which  X  Implements four further Sesotho tonal rules,  X  Applies the tonal rules to all grammatical categories, and  X  Treats each verb stem in a sentence according to its own context and
Our research study verifies the first part of the suggestion by Louw et al. ( 2005 ), that we need algorithms that predict not only tone marks of syllables, but also the appropriate intonation of words, if we want to implement tone in TTS systems for languages such as isiZulu or the Sotho-Tswana languages. The extended algorithm predicts the tone marks. The appropriate intonation of words can only be dealt with once the relationship between tone labels and fundamental frequency is known for Sesotho Van Niekerk and Barnard ( 2010 ).
 References
 Mpho Raborife  X  Sigrid Ewert  X  Sabine Zerbian Abstract We report on a study that aimed to improve an existing tone label prediction algorithm for Sesotho, an official language of South Africa. Tone is an important prosodic feature of Sesotho, since speakers use tone to distinguish meaning. In order to implement tone in a Text-to-Speech system for Sesotho, a tone modeling algorithm must receive as input the tone labels of the syllables of each word. Then it can predict the appropriate intonation of the word. Since Sesotho does not mark tone labels in orthography, the labels have to be predicted according to the tonal rules of the language. The existing tone label prediction algorithm has two drawbacks, namely it implements three tonal rules only and is restricted to the clitic phrase domain. In our study, we developed an algorithm that implements four additional tonal rules and addresses all parts of speech. The results show that the latter algorithm significantly improves the existing one by increasing the number of matched tone labels.
 Keywords Tone  X  Algorithm  X  Sesotho  X  Bantu languages  X  Text-to-Speech systems 1 Introduction Sesotho is a Bantu language spoken primarily in South Africa and Lesotho. It is an official language in both countries with a reported 4.2 million primary speakers in South Africa and 1.7 million primary speakers in Lesotho (Lewis 2009 ).
Bantu languages are tonal languages with a two-tone level system (high or low); they use pitch variation to distinguish meaning. Tone in Bantu languages may be used to differentiate meaning on a lexical level as shown in Example 1. 1 The word bona has different tonal patterns in this example. It is this difference in tonal patterns that affects the meaning of the word.
 Example 1 bo  X  na - X  X ee X  Tone may also be used to show grammatical relationships. For instance, in Example 2, the first person singular can only be distinguished from the third person by means of tone (Doke and Mofokeng 1957 ).
 Example 2 Ke  X  motho - X  X t is a person X 
Prosody modeling is a fundamental component of any Text-to-Speech (TTS) system. The prosody prediction module of such a system generates, amongst others, pitch, stress and duration as inherent to the language being modeled. This module should generate sound as close to human speech as possible.
 The prosody prediction module in a TTS system for Sesotho has to model tone. can assign the appropriate pitch values to the syllables and generate audible tone patterns.

In Sesotho, tone labels are not marked in orthography. This makes it difficult to investigate the relationship between tone labels and pitch values.

Louw et al. ( 2005 ) listed two prerequisites for successfully modeling tone in Bantu languages that do not mark tone in orthography, such as isiZulu and Sesotho, namely 1. an algorithm that predicts whether a syllable has a high or a low tone, and 2. another that predicts the overall intonation of a word.

An algorithm developed by Raborife ( 2009 ) addresses the first aspect of Louw et al. ( 2005 ) X  X  suggestion, in this case for Sesotho. This algorithm predicts tone labels based on three Sesotho tonal rules, namely the High Tone Spread (HTS1), Iterative High Tone Spread (HTS2) and Grammatical Tone Insertion (GTI) rules, and is restricted to the clitic phrase domain.

The study reported here aimed to improve that algorithm. The algorithm developed by Raborife ( 2011 ) implemented four additional tonal rules, namely the Right Branch Delinking (RBD), Left Branch Delinking (LBD), Specifier High Tone Delinking (SHTD) and the Finality Restriction (FR) rules. Moreover, it was applied to all parts of speech.
Hereafter, we refer to the algorithm developed by Raborife ( 2009 ) as the basic algorithm , and to the current version of the algorithm as the extended algorithm .
The second aspect of Louw et al. ( 2005 ) X  X  suggestion would require an algorithm that would, amongst others, map the tone mark on a syllable to an actual pitch value. Our study did not address this and therefore we cannot at this stage measure how tone affects the perceived naturalness of a TTS system.

In Sect. 2 we give the motivation for the study. In Sect. 3 , we discuss the prosodic hierarchy with reference to the tonal rules of Sesotho. In Sect. 4 we discuss the seven tonal rules that were implemented in the extended algorithm. The context for the research is discussed in Sect. 5 , while the aims are given in Sect. 6 and the approach in Sect. 7 . In Sect. 8 we give more detail about the compilation of the corpus. The output of the algorithms is analyzed in Sect. 9 , while Sect. 10 gives the results in detail. We suggest future work in Sect. 11 and conclude in Sect. 12 . 2 Motivation for the research study Extensive research has been done on modeling tone in East-Asian languages, such as Chinese (Wang et al. 1996 ; Lee et al. 2002 ;Lietal. 2004 ;Nietal. 2008 ). Recently, studies have begun to address tone modeling for languages spoken in Africa, such as Yoruba, a language of Nigeria (O 2008 ). To our knowledge, there is only one publication on modeling tone for Bantu languages, namely on an approach to implement tone in a TTS system for isiZulu (Louw et al. 2005 ). The perceived naturalness and the intelligibility of a TTS system for a tonal language depend heavily on having tone implemented. There is therefore an acute need for research on tone modeling for Bantu languages.

The tone systems of East-Asian languages (e.g., Chinese) and African languages, here specifically Bantu languages, are very different. First, there is a difference in the tonal inventory: Whereas Bantu tone systems have been analyzed as having two surface tone levels (namely high and low), the tonal inventory of East-Asian tone languages is much more complex, both in the number of level tones as well as in the additional presence of contour tones. It can be observed that tone carries a higher functional load in East-Asian languages than in Bantu languages (evidence is, for example, in the number of minimal pairs). Second, due to their agglutinative structure, tones interact strongly with morphology in Bantu languages (see Sects. 3 and 4 below), whereas there are fewer tonal interactions in East-Asian languages.
In Yoruba, tone labels are marked in orthography. To model tone in TTS systems for this language, the tone labels on the syllables were assigned appropriate pitch values, using methods such as fuzzy logic and decision trees (Odejobi et al. 2008 ). In contrast, Bantu languages do not mark tone in orthography. It is difficult to assign the appropriate pitch value to a syllable, since the orthography doesn X  X  indicate whether a syllable has a high or a low tone.
 This problem needs to be addressed if the development of TTS systems for Southern Bantu languages is to keep up with the development of TTS systems for other tonal languages. As mentioned in the previous section, Louw et al. ( 2005 ) suggests a solution, namely algorithms that predict both the tone of the syllables of each word and the appropriate intonation of the word. The authors argue that a TTS system that includes such algorithms, would produce more  X  X atural X  tones.
The study by Raborife ( 2009 ) investigated how an algorithm that predicts the tone of syllables could be implemented. The author came to the conclusion that the algorithm would require linguistically-defined tonal rules to make the tone mark predictions. 3 The prosodic hierarchy with reference to Sesotho According to Zerbian ( 2006 ),  X  X he behaviour of high tones is one of the most fundamental phenomena of Bantu tonology X . Although Bantu languages share the tonal inventory of two surface tones, high and low, the specific rules that target or trigger tonal changes as well as the domains in which tonal rules apply, differ quite considerably across Bantu languages. The current study deals with the tonal rules as they have been reported for Sesotho.

In Sesotho, a high tone does not only surface on the syllable with which it is associated underlyingly, but also on succeeding syllables, as is discussed in Sect. 4 . This does not occur at arbitrary places in a sentence, but within certain phonological (prosodic) constituents, which we discuss in this section. The prosodic hierarchy lists a series of increasingly smaller regions of prosodic constituents (Nespor and Vogel 1986 ), namely the 1. utterance phrase, 2. intonational phrase, 3. phonological phrase, 4. clitic phrase, 5. phonological word, 6. foot, and 7. syllable.

The constituents of this hierarchy form domains within which phonological rules apply. When a phonological (or tonal) rule is restricted within a domain, it only applies if the segments triggering the application of the rule and the segments undergoing the change are all within that domain.
 Some Sesotho tonal rules, e.g., the High Tone Spread and Iterative High Tone Spread rules, are restricted within certain phonological constituents. Consider, for instance, the High Tone Spread rule, which spreads a high tone from the syllable it of the noun stem nama , as shown in Example 3. 2 However, this does not occur. Therefore we place an asterisk before the sentence to show that the behavior of the high tones in the sentence is incorrect. There is no explanation for the high tone on the verb stem not spreading to the first syllable of the noun stem, other than to refer to the prosodic constituent, which in this case is the phonological word. Example 3 *(ke j a  X  ) -na  X  ma word, the clitic phrase and the phonological phrase, since the tonal rules which form the basis of the study are restricted within these constituents. Therefore, we discuss these constituents in the following sections. 3.1 The phonological word The phonological word ( -) is one domain within which the High Tone Spread and Iterative High Tone Spread rules, which are discussed in Sect. 4.1 , apply.
In Sesotho, the phonological word domain for monosyllabic verb stems is different from that for polysyllabic verb stems.

A monosyllabic verb stem and the prefix to its left constitute a phonological word domain as shown in Example 4 (from Khoali 1991 , p. 216). In this example, the verb stem ja is in the same phonological word domain as the object prefix  X e . Example 4 o  X  ya ( e  X  ej a  X  ) -shown in Example 5 (from Khoali 1991 , p. 224). In this example, the verb stem tsamaya is in a separate phonological word domain from the future marker tla . Example 5 o  X  tla  X  (tsamaya) -syllable as a consequence of the High Tone Spread rule, and particles that do not.
In the first case, the particle forms a phonological word with the noun class prefix of the noun stem following it, as is shown in Example 6 (from Khoali 1991 , p. 126). In this example, the particle h  X  belongs to the same phonological word domain as the prefix mo .
 Example 6 (h o  X  mo  X  ) --(rena) -shown in Example 7 (from Khoali 1991 , p. 126). In this example, the particle k  X  belongs to a different phonological word from the noun class prefix of the noun stem following it.
 Example 7 (k e  X  ) -(morena) -own phonological word domain. A special case exists for a noun stem that is preceded by a particle of which the underlying tone spreads by the High Tone Spread rule X  X n this case the class marker of the noun stem and the preceding particle form a single --domain as shown in Example 6. 3.2 The clitic phrase The clitic phrase (C) is one domain within which the High Tone Spread rule applies. A clitic is a word that cannot stand on its own, but has to attach to another word, e. g., the English clitic  X  X  X  in  X  X pho X  X  coming X .

In Sesotho, the clitic phrase consists of the verb stem and all the clitics (prefixes) to the left of it (Khoali 1991 ).

In Example 8 (from Khoali 1991 , p. 216), the polysyllabic verb stem j  X sa forms a This illustrates that the clitic phrase is a higher domain than the phonological word, i.e., the phonological word is contained in the clitic phrase.
 Example 8 ( o  X  ya  X  e  X  (j e  X  sa) -)C by any clitics. Hence the phonological word is equivalent to the clitic phrase, which in this case is equal to a morphological word (the verb stem).
 Example 9 ((paqa  X  ma) -)C such as nouns and adjectives, do not make reference to this domain (Khoali 1991 ). This is shown in Example 10, where the noun p  X di is not contained in a clitic phrase, while the verb stem r  X ta is in the same clitic phrase domain as the subject marker ke that precedes it.
 Example 10 (ke (r a  X  ta  X  ) -)C (p o  X  d X   X  ) -(hah o  X  lo) -the function words preceding it. 3.3 The phonological phrase The phonological phrase ( / ) is one domain within which the Finality Restriction rule applies. In Sesotho, this domain consists of the phrasal head, for example, the noun in a noun phrase, and the words which precede it in that phrase (Nespor and Vogel 1986 ).

Khoali ( 1991 ) uses the concept of Chomsky-adjoined phrases, which are also known as modi fi ers , to define the boundaries of the phonological phrase domain. Modifiers are phrases that are not required for their heads to be meaningful. For example, post-nominal modifiers, such as adjectives, are not needed for a noun to have meaning. This is shown in Example 11 (from Khoali 1991 , p. 67), where the adjectival phrase  X kg  X l X  can be removed without affecting the grammaticality of the sentence. Example 11 (a) P o  X  di e  X  kg o  X  lo  X  e  X  j a  X  mabel e  X  domains than their heads.

The right edge of a phonological phrase domain is inserted by default between a phrasal head and its modifier, as well as at the end of a sentence.

For the first case, consider Example 12 (from Khoali 1991 , p. 196). 3 Here the verb stem r  X ta is followed by an adverb, haholo . Adverbs are modifiers, since they are not Example 12 Ke r a  X  ta) / hah o  X  lo ho tsamaya the last word of a sentence. The sentence can be simple, compound or complex, as shown in 13(a), (b) 4 and (c), respectively (from Khoali 1991 , p. 57). Example 13 (a) Thabo o  X  r a  X  ta  X  p o  X  di) / a sentence, be it simple, compound or complex, as well as immediately before a right edge.

For the first case, consider Example 14 (from Khoali 1991 , p. 57), where the left edge is placed at the beginning of the sentence.
 example, the left edge is inserted immediately after the right edge that follows the noun stem lekala .
 Example 15 (Ke na l e  X  le  X  kala) / (l e  X  le  X  tle) / 4 The phonological rules In this section, we discuss the seven Sesotho tonal rules that are incorporated in the extended algorithm. First, in Sect. 4.1 , we present the three rules that were implemented in the basic algorithm (Raborife 2009 ). Then, in Sect. 4.2 , we present the four tonal rules that were added to the basic algorithm to constitute the extended algorithm. For all rules, we discuss their domain of application with reference to the prosodic constituents. 4.1 Tonal rules in the basic algorithm The basic algorithm incorporates three tonal rules, namely the High Tone Spread, Grammatical Tone Insertion and Iterative High Tone Spread rules. 4.1.1 High Tone Spread rule According to this rule, which is also called the High Tone Doubling rule, e.g., in Demuth ( 1995 ), an underlying lexical high tone spreads to the next syllable.
For instance, in Example 16 (from Demuth 1995 , p. 13), a high tone on the first explain this behavior by referring to the High Tone Spread rule.
 Example 16 ke r e  X  ke  X  la ... domain, as shown in Example 17 (from Demuth 1995 , p. 13), and the clitic phrase domain, as shown in Example 18 (from Demuth 1995 , p. 13).
 In Example 17, the polysyllabic verb stem r  X kela constitutes a phonological word. Therefore the underlying high tone of the verb stem spreads to the next syllable. Example 17 (ke (r e  X  ke  X  la) -)C ... of the verb stem.
 Example 18 ( o  X  (le  X  ma) -)C ... 4.1.2 Grammatical Tone Insertion rule According to this rule, the second syllable of a verb stem is associated with a high tone, as shown in Example 19 (from Khoali 1991 ). Here, batle is the verb stem and the second syllable is tle .
 Example 19 (ha b a  X  (batle  X  ) -)C batho following morphological contexts Khoali ( 1991 ):  X  The imperative mood, which is discussed in detail below.  X  The negative verb form, which indicates a negative of the verb.  X  The participial narrative past tense, which indicates a sequence of past events  X  The habitual verb form, which expresses an action that happens often.  X  The perfect tense, which expresses an action that has been completed.  X  The subjunctive mood, which expresses an action that might occur.
 There is no need to refer to prosodic constituents in the application of this rule.
We only discuss the imperative here. For the morphological formations of all above mentioned contexts, the interested reader is referred to (Doke and Mofokeng 1957 , pp. 184 X 240).

In Sesotho, the imperative mood expresses an instruction, a command or a politely strong request, e.g., thola!  X  X eep quiet! X . This mood always surfaces with a high tone on the second syllable, as shown in Example 20 (from Khoali 1991 ,p. 291). In this example, a high tone surfaces on the second syllable, la , of a verb stem that is underlyingly low-toned. This high tone is referred to as the grammatical tone. Example 20 batla  X  second syllable, as shown in Example 21. In this example, the high tone on the first syllable, ba , of the verb stem batla is acquired by the High Tone Spread rule. Example 21 ( o  X  (ba  X  tla) -)C nama 4.1.3 Iterative High Tone Spread rule According to this rule, a grammatical high tone spreads iteratively within the phonological word domain. For instance, in Example 22 (from Khoali 1991 , p. 293), a grammatical high tone surfaces on the second syllable, r X  , of the low-toned imperative verb kgarakgarametsang . This high tone then spreads iteratively until the end of the verb.
 Example 22 ((kgara  X  kga  X  ra  X  me  X  tsa  X  ng) -)C with the second syllable of a verb stem in a context listed in Sect. 4.1.2 . Therefore the Iterative High Tone Spread rule is ordered after the Grammatical Tone Insertion rule. Furthermore, the former rule applies strictly within the phonological word domain. For instance, the verb stem in Example 22 is polysyllabic and thus forms its own phonological word. The high tone in this example spreads iteratively within the verb stem which constitutes the phonological word domain.

Monosyllabic verb stems show a complex tonal behaviour. For instance, the high tone of an object prefix does not spread to the adjacent monosyllabic verb stem as would be expected by the High Tone Spread rule (Khoali 1991 ). Therefore, both the basic and the extended algorithms were restricted to polysyllabic verb stems. 4.2 Tonal rules in the extended algorithm In this section we discuss the four tonal rules that we added to the basic algorithm in order to improve it. These are the Right Branch Delinking, Left Branch Delinking, Specifier High Tone Delinking and Finality Restriction rules. 4.2.1 Right Branch Delinking rule According to this rule, the right branch of a multiply-linked high tone is disassociated in all cases where a high tone immediately follows the target syllable Khoali ( 1991 ). A multiply-linked high tone is a high tone that is linked to more than one syllable after the application of a tone spread rule, eg., High Tone Spread rule, where the high tone of the source syllable is linked to both the source and the target syllables.

For instance, suppose the High Tone Spread rule spreads an underlying high tone r  X  2 has a high tone, then the high tone which has spread to and therefore r i  X  1 will have a low tone.

Consider Example 23 (from Raborife 2009 , p. 43). We would expect the present tense marker X  X he first instance of a  X  X o surface with a high tone after the high tone on the subject marker, b  X  , has spread to a . However, a is followed by a high-toned verb stem,  X ga . Therefore the high tone that is linked to both b  X  and a ,is disassociated from a .
 Example 23 B a  X  a a  X  ga ba n  X  na a  X  mo  X  tse b a  X  a a  X  ga. clitic phrase domain span rule.

Example 24 (from Khoali 1991 , p. 143) shows the application of this rule within the phonological word domain. In this example, the high tone on the second followed by a high-toned syllable, t  X  . Therefore the high tone on le is delinked. Example 24 (leb e  X  let e  X  ) -the clitic phrase domain. In this example, the high tone on the subject marker X  X he first instance of b  X   X  X preads to the past tense marker ne by the High Tone Spread rule. Therefore this high tone is linked to both b  X  and ne . However, ne is followed by a high-toned subject marker, b  X  . Therefore the high tone on ne is delinked and ne surfaces with a low tone.
 Example 25 (B a  X  ne b a  X  (tsa  X  maya) -)C 4.2.2 Left Branch Delinking rule According to this rule, the left branch of a multiply-linked high tone is disassociated if it is preceded by a high tone Khoali ( 1991 ).

For instance, suppose the High Tone Spread rule spreads an underlying high tone the syllable r i 1 has a high tone, then the high tone on r i will be delinked and therefore r i will have a low tone.
 The Left Branch Delinking rule is a phonological word domain span rule.
Consider Example 26 (from Khoali 1991 , p. 254). Since the verb stem high tone by the Grammatical Tone Insertion rule. This high tone then spreads by the Iterative High Tone Spread rule to the penultimate syllable, me . However, the first syllable, kg  X  , is high-toned. Therefore the high tone on ru is delinked and ru surfaces with a low tone.
 Example 26 ha ke kg u  X  r u  X  kgu  X  ru  X  me  X  tse  X  in Example 27, where the term reduplication refers to the repetition of the stem of a word. The explanation of the application of the Left Branch Delinking rule given for Example 26, holds for Example 27 too. In the latter example, all the syllables involved in the application of this rule are within the same verb stem. Example 27 (ha ke (kg u  X  r u  X  me  X  tse  X  ) -)C 4.2.3 Speci fi er High Tone Delinking rule According to this rule, a high tone on an object concord or reflexive prefix is delinked if they are not in the same phonological word as the stem (Khoali 1991 ). This rule only delinks the high tone after the High Tone Spread rule has been the rule differs from the Left Branch Delinking rule, which only applies when the high tone on the source syllable is linked to both the source and the target syllables.
Example 28 (from Khoali 1991 , p. 274) shows an underlyingly high-toned object prefix, m  X  , surfacing with a low tone. This occurs because the high tone on m  X  spreads by the High Tone Spread rule to the first syllable, kga , of the verb stem kgarameditse . Then the high tone on m  X  delinks, as it is not in the same phonological word domain as kgarameditse .
 Example 28 ( o  X  mo (kga  X  r a  X  me  X  d X   X  tse  X  ) -)C 4.2.4 Finality Restriction rule According to this rule, syllables at the end of a phonological phrase are exempted from the application of tonal rules Khoali ( 1991 ).
In Example 29 (from Khoali 1991 , p. 38), we would expect the high tone on the High Tone Spread rule. However, a high tone on ka is blocked by the Finality Restriction rule.
 Example 29 ((ho (r e  X  ka) -)C) /
In Example 30, the second syllable, ka , of the verb stem r  X ka surfaces with a high tone. This syllable is not at the end of the phonological phrase domain and thus the Finality Restriction rule does not apply. However, this rule does apply in the noun b  X ka to spread to the second syllable, ka . However, ka is at the end of the phonological phrase domain. Therefore, by the Finality Restriction rule, it surfaces with a low tone.
 Example 30 ((ho (r e  X  ka  X  ) -)C (b u  X  ka) -) / 5 Research context The intelligibility of Text-to-Speech systems depends heavily on reliable tone and intonation models (Zerbian and Barnard 2008 ). However, not much research has been done on developing tone models for Bantu languages. Louw et al. ( 2005 ) attempted to implement tone into a TTS system for isiZulu. However, the authors concluded that treating all tones as unmarked would produce more understandable speech than their system. They then suggested that algorithms that could predict the tone labels of syllables and the appropriate intonation of words, would result in TTS systems producing more natural tones.

Zerbian and Barnard ( 2010 ) discussed the steps that are necessary to develop such algorithms, specifically for the Sotho-Tswana languages. Steps 1 and 2 are discussed in Sect. 7 . The basic algorithm implements Steps 3 and 4 of the above hierarchy, but for three Sesotho tonal rules only (Raborife 2009 ). We aimed to improve this algorithm in order to increase the number of matched tone labels between the labels given by transcribers and the labels output by the algorithm, where the term matched tone label indicates a label predicted by an algorithm that is exactly like its transcribed counterpart. Steps 1 X 4 are as follows. 1. Morphological analysis: This is important for the tagging of both parts-of-2. Pronunciation dictionaries: These are required for assigning tone patterns to 3. Algorithm for prosodic phrase boundaries: In the Sotho-Tswana languages, a 4. Application of the tonal rules: Once the above three steps have been
Our analysis at the current stage does not consider where we obtain the underlying labels. One could obtain such labels by, for example, semantic analysis or recordings of human speech. 6 Research aims We sought to improve the basic algorithm by Raborife ( 2009 ). This involved the following:  X  Implementing four additional tonal rules.  X  Extending the application of the tonal rules to other parts of speech, e.g., adverbs  X  Implementing the tonal rules on each verb stem independently in sentences that 7 Approach Table 1 provides an overview of the processes involved in our study, where the processes correspond to Steps 1 X 4 of Sect. 5 .

The first two steps were done manually, since currently a morphological analyzer and a tone-marked pronunciation dictionary do not exist for Sesotho. In the final step, the high tone spread occurs within the phonological word domain for the noun stem, and within the clitic phrase domain for the verb stem and its preceding clitics.
The following sections describe the processes in detail. 7.1 Preparation of input data The first two steps in Table 1 represent the processes required to prepare the sentences that would be used to test the algorithms, in particular, tagging the parts-of-speech of the words in the sentences, and marking the underlying tone labels on the syllables. 7.1.1 Part-of-Speech tagging We tagged the POS category of each word using the dictionary by Du Plessis et al. ( 1974 ). This was important for two reasons. Firstly, the Grammatical Tone Insertion rule applies only to words of certain grammatical categories. Secondly, the extended algorithm uses grammatical information as a cue when inserting phonological boundaries. Faasz et al. ( 2009 ) describes an automatic POS tagger developed for Northern Sotho. In our study, it was not sufficient to tag just the parts-of-speech. We also needed information on whether a particle spreads or not, and whether a certain word precedes a modifier. In the latter case, the extended algorithm would insert the right edge of the phonological phrase domain before this word.

Our study would have been facilitated by a refined POS tagger, which is both a morphological analyzer as well as a POS tagger. However, to our knowledge, there is currently no refined POS tagger for the Sotho-Tswana languages. 7.1.2 Labeling of underlying tones According to Schadeberg ( 1981 ), there are only two Sesotho dictionaries that study, we used Du Plessis et al. ( 1974 ) to mark the underlying tones, since we could not find a copy of Mabille et al. ( 1961 ). According to our knowledge, the dictionary by Du Plessis et al. ( 1974 ) is the most recent tone marked Sesotho dictionary. Some of the words we used were not in Du Plessis et al. ( 1974 ) and we had to consult other sources.
 The result of high tone spread is presented by Du Plessis et al. ( 1974 ) as follows: Example 31 re  X  ke  X  la spreads to the second syllable, ke . We know that the high tone on the second syllable is not underlying, as it would have been deleted by the Meeussens rule, a rule that deletes the second high tone of two adjacent underlying high tones (Khoali 1991 ). In our study, we did not tag high tones which are a consequence of the High Tone Spread rule, since this rule is implemented by the basic algorithm (Raborife 2009 ).
As a further example, the dictionary Du Plessis et al. ( 1974 ) marks the tones of the noun stem kunutu as k X n X t X  . We can assume that the high tone on n X  is not underlying, but a consequence of the High Tone Spread rule. This high tone is delinked by the Right Branch Delinking rule. Since we only tagged underlying tones, we assumed the following marking: Example 32 ku  X  nutu  X  7.2 The algorithm The last two steps in Table 1 were the focus of the study that implemented the extended algorithm. As said above, the algorithm assumes that there are no monosyllabic verb stems in the input.

The algorithm first inserts the phonological domains within which the tonal rules apply, and then applies the rules. In this section, we present an overview of the extended algorithm, as well as pseudo-code for it. Then we briefly address the time complexity of the algorithm. 7.2.1 Insertion of phonological boundaries The tonal rules apply within three phonological domains, namely, the clitic phrase, the phonological word, and the phonological phrase.

The clitic phrase The clitic phrase domain is only defined for verb stems. For each verb stem, the algorithm inserts  X  the right edge of the domain immediately after the stem, and  X  the left edge before the closest subject marker preceding the stem. The phonological word In order to insert the phonological word domain, the algorithm determines the part-of-speech category of each word. If the word is  X  a content word, but not a noun, the algorithm inserts this domain around the  X  a noun, the algorithm checks if the word preceding it is a particle that spreads by The phonological phrase In order to insert the phonological phrase domain, the algorithm inserts a right edge  X  between a head and its modifier, where the head of a phrase defines its category,  X  after the last word of a sentence.
 It then inserts a left edge  X  immediately after every right edge, as well as  X  before the first word of a sentence. 7.2.2 Application of the tonal rules The algorithm searches for all clitic phrases in a sentence and applies the High Tone Spread rule within each clitic phrase.

Following the processing of the clitic phrases, the algorithm then searches all phonological words in a sentence. For each phonological word, it checks the part of speech of the word within the phonological word. If the word is a verb stem, it checks the tense, mood and aspect (TMA) of the verb stem. If the TMA of the verb stem falls in the category that allows for the application of Grammatical Tone Insertion rule, the algorithm applies this rule followed by the Iterative High Tone Spread rule. Otherwise, the algorithm applies the High Tone Spread rule and then the Right or Left Branch Delinking rule, as applicable. If the word within the phonological word is not a verb stem, the algorithm applies the High Tone Spread rule and then the Right or Left Branch Delinking rule, as applicable.
After processing all the phonological words, the algorithm searches for all the phonological phrases in a sentence. For each phonological phrase, the algorithm checks the final syllable in the domain and lowers it if it is a high tone.
Moreover, after any application of the High Tone Spread rule, the algorithm applies the Specifier High Tone Delinking rule. This changes the tone on all object concords to low.
 Algorithm 1 presents pseudo-code for the extended algorithm.
 7.2.3 Trace of the extended algorithm on a sentence Consider the sentence in Example 33 (from Khoali 1991 , p. 224).
 Example 33 o  X  tla tsamaya Table 2 shows the trace of the algorithm on this input.

The input sentence is  X  tla tsamaya . The algorithm first inserts the prosodic boundaries:  X  The clitic phrase domain consists of the verb stem, tsamaya , and all the clitics  X  There are two phonological word domains:  X  The phonological phrase domain consists of the whole sentence, i.e.,  X  tla
The sentence has a future tense morpheme tla . The Grammatical Tone Insertion rule doesn X  X  apply in this context.

In the clitic phrase, the algorithm applies the High Tone Spread rule. As a result, the high tone on the subject concord o spreads to the future tense marker tla .
The algorithm then examines each phonological word. However, none has the context required for the application of the High Tone Spread rule.

The algorithm finally examines the phonological phrase domain, in particular, the rule does not apply. Moreover, the Specifier High Tone Delinking rule does not apply, because there are no object concords in the input.

The algorithm outputs the sentence  X  tl X  tsamaya . 7.3 Time complexity An inspection of Algorithm 1 shows that there are no nested loops. Therefore the time complexity for processing one sentence is linear in the number of syllables in that sentence.

In the next section we discuss how the sentences used to test the extended algorithm were compiled, recorded and transcribed. 8 Corpus compilation A detailed description of the corpus compilation is provided in Raborife et al. ( 2011 ). In this section, we provide an overview.

Forty-five sentences were chosen from a large corpus of Sesotho data. 5 These sentences were chosen to reflect the phonological boundaries of interest in our study, ranging from a sentence of length 3 to a sentence of length 11. We considered the syllables, since this is the level on which the rules apply, as bounded by phonological structures. The sentences were selected to include the following:  X  The present principal tense.  X  The past tense.  X  The perfect tense.  X  The imperative mood.  X  The future tense.
 The sentences did not include the following:  X  Proper nouns and loan words, since their tone patterns are not available in the  X  Verb forms in the Potential Mood, i.e., forms using -ka , since the tonology of  X  Monosyllabic verb stems, since they have complex tonal characteristics (Khoali
The extended algorithm output the 45 sentences with the predicted tone marks on the syllables. To evaluate the algorithm, we compared its output to speech recorded by a native Sesotho speaker. We did not have pre-recorded Sesotho sentences. Therefore the sentences were recorded by three native Sesotho speakers. The speech had to be encoded in a way that would allow this comparison, that is, it had to have high and low tone marks. We therefore transcribed the recorded speech to orthography and added tone marks on the syllables.

In the next sections, we discuss the recording process as well as the transcriptions. 8.1 Recording process Three native Sesotho speakers (or respondents) each recorded all 45 sentences. They were not remunerated.

Before recording the sentences, each speaker recorded eight Sesotho tonal minimal pairs, where such a pair consists of two words or phrases that are spelled identically, but differ in tone, and have different meanings. These minimal pairs were used to select the respondent with the most pronounced tones, as discussed below.
 Neither the minimal pairs, nor the sentences, had tone labels. However, the English meaning for the minimal pairs was given beneath the sentence or phrase in order to guide the respondent as to which tone pattern was to be pronounced for each word or phrase. 8.2 Speaker selection It was not necessary to transcribe the recordings by all three respondents, because the tonal rules implemented by the algorithm are not restricted to speakers of a specific Sesotho dialect. We therefore used only one respondent X  X  recording. We chose the respondent who had produced the largest number of clearest tones, where  X  X learest X  refers to the most pronounced tones.
We used two processes to choose the speaker with the clearest tones. Firstly, to determine the speaker X  X  ability to distinguish tone, we used eight tonal minimal pairs. Secondly, the clarity of the tones produced by each speaker was verified perceptually and acoustically using a speech software with a pitch tracking algorithm.
 We named the respondents 1, 2 and 3.
 Respondent 3 could not identify the tonal distinction in one of the minimal pairs. We thus excluded this respondent X  X  recording from the transcriptions.
Respondent 2 spoke in an unnatural voice and exaggerated the tone and words. In some instances, this respondent produced each word without taking the context into consideration. This is problematic, since the tonal rules are restricted within phonological boundaries, and some rules in specific morphological contexts. Moreover, a word in isolation might be tonally ambiguous and one would need the context to pronounce the appropriate tone pattern.
 We consequently also excluded respondent 2 X  X  recording.

Respondent 1 produced clear tones and spoke in a natural voice. This respondent X  X  recording was transcribed by three independent labelers, each with some experience in tonal studies. The transcriptions are in orthography with added tone labels. In the next section, we discuss how the labelers transcribed the speech. 8.3 Transcription of sentences 8.3.1 Transcription process The transcription of prosody is widely used in linguistic research as well as in the development and testing of speech systems Syrdal and McGory ( 2000 ). It is used to understand linguistic variables and their relation to the interpretation of human speech.

In our study, three independent expert labelers transcribed tone as perceived from respondent 1 X  X  speech. The transcriptions represent spoken language in written form with added tone labels.

We used transcriptions to evaluate our algorithm, since they represent Sesotho speech as pronounced by a native speaker. Given that our algorithm was developed for tone modeling in a Sesotho TTS system, it is crucial that the tone labels predicted by our algorithm match those in the transcriptions.

We did not use any statistical methods to predict the tone labels, since such methods are not based on perception, and thus cannot give us an indication of how well our algorithm can fare on a perception test. However, we used statistical methods to establish the reliability of the transcriptions as discussed in the next section.
 Initially, we aimed to use 12 labelers to transcribe respondent 1 X  X  recording. These labelers were to be divided into two groups, six being experts in tonal studies and the other six having no experience in tonal studies. In each of the two groups, three labelers were to be native Sesotho speakers and the other three were to be speakers of non-tonal languages. However, we could only find three labelers who are experts in tonal studies, while we found six labelers who are not experts. Table 3 summarizes the characteristics of the labelers.

The labelers in the non-expert group X  X ven the native speakers X  X ad difficulty transcribing the tone labels. Transcribing tone is an acquired skill. Moreover, native speakers of tonal languages in South Africa are usually not aware of their language X  X  tonal system, as this is not taught at school.

Since there were more labelers in the non-expert group, they would have outnumbered the expert labelers in the majority vote used to choose the tone label of a syllable in those cases where the labelers did not agree. Thus, we chose to use only the three expert labelers for the transcriptions.

The transcribers have different backgrounds in tonal studies, with two being linguists and the third a speech engineer. Furthermore, two of the transcribers are speakers of Germanic languages (linguist A and speech engineer B) and the third is a native Sesotho speaker (linguist C). They have the following backgrounds in tonal studies: A and B have developed a framework that introduces an algorithm that derives word-level tone assignments for the Sotho-Tswana languages (Zerbian and Barnard 2010 ). Labeler C implemented this framework by developing the basic algorithm (Raborife 2009 ).
 As far as we know, currently a framework for tone transcription does not exist for Bantu language, thus, the labelers could not be given a training manual. Consequently, they relied on perception and acoustic means to label the tones. The transcriptions were compared across the labelers, resulting in an agreement of 55.9%, or 316 out of 565 tone-bearing syllables. In the cases where all three labelers didn X  X  agree, the final tone label was decided by a majority vote.

The agreement between the transcribers is given in Table 4 . 8.3.2 Inter-transcriber reliability As stated above, the three labelers reached agreement on the tone labels in 55.9% of the cases. A reason for such a low agreement might be that perception is subjective and that the transcribers did not have a training manual. Another factor might be that our labelers had experience with tone, even though two of them are speakers of non-tonal languages. Studies have shown that speakers of non-tonal languages are less sensitive to the perception of tone, even if they are not necessarily  X  X one deaf X  (Halle et al. 2004 ; Gandour and Harshman 1978 ).

The transcriptions formed a central part in evaluating our algorithm. Since there was a fairly low agreement between the transcribers, it was important to statistically verify the reliability of the transcriptions. For this purpose, we used the kappa ( j ) coefficient, which is a statistical measure used in observer reliability studies for analyzing the reliability of agreement between a number of labelers (or raters) (Fleiss 1971 ; Brennan and Prediger 1981 ; Randolph 2005 ). This statistical measure is more reliable than a simple percentage agreement calculation, since it takes into account the agreement occurring by chance between labelers.

Fleiss X  kappa is a well-known multi-rater kappa that assumes that raters are forced to assign a certain number of cases to each category. Hence, it is referred to as a fixed-marginal kappa Brennan and Prediger ( 1981 ). For instance, in our study, it would assume that the labelers were restricted in the number of syllables (cases) they could assign to each of the tone labels (categories). However, our labelers were free to assign any number of syllables to each of the two tone labels. We thus used a free-marginal kappa, as proposed by Brennan and Prediger ( 1981 ). Randolph ( 2005 ) defines the free-marginal kappa, j , as follows: where P is the observed agreement, while P e is the agreement expected by chance, i.e., as if the raters had simply guessed every rating.

According to Fleiss ( 1971 ), the factor 1 P e gives the agreement that is attainable above chance, while P P e is the degree of agreement achieved above chance. If j = 1, then there is complete agreement between the labelers. If j 0 , then there is no agreement other than what would be expected by chance.
The free-marginal j -value between three labelers that assigned 565 syllables to two categories, as calculated by Randolph ( 2008 ), is as follows: j  X  0 : 41 .To interpret this value, we use Table 5 (Landis and Koch 1977 ). According to this, the labelers were in moderate agreement. Thus we may use the transcriptions to evaluate the extended algorithm.
 9 Analysis The analysis of the basic algorithm in the study by Raborife ( 2009 ) has shown that there are at least three other tonal rules that need to be implemented into TTS systems necessary for tone modelling, namely, Right Branch Delinking, Left Branch Delinkingand Finality Restriction. The Finality Restrictionaccounted for a signif-icantly large amount of the mismatches in that study. The EA extends the BA by applying these rules in addition to the Specifier High Tone Delinking. 9.1 Introduction In the analysis we compared both the tone labels predicted by the basic algorithm, and those predicted by the extended algorithm, to the tone labels in the transcriptions.

This analysis covered the tone labels of all syllables in the phonological phrase domain. Since the basic algorithm is restricted to the clitic phrase domain, we used the underlying tones as defined by Du Plessis et al. ( 1974 ) for all syllables outside this domain when comparing the labels predicted by the basic algorithm to their transcribed counterparts.

Consider Example 34. The transcribed sentence and the output by the basic algorithm are given in the lines labeled TR and BA, respectively. In this example, there are five mismatches between the transcription and the basic algorithm. Two are in the clitic phrase; the other three are outside the scope of application of this algorithm.

It seems that in the transcription, the underlying high tone is on the second syllable, n , of the verb stem kganna and spreads to the last syllable, na by the High Tone Spread rule. In contrast, the basic algorithm applies the High Tone Spread rule stem spreads to the second syllable, n .
 Example 34 TR: Mod X   X  sa  X  na o  X  kgan  X  na  X  dinku tse  X  sekete. sentence. Here EA labels the output of the algorithm. In this example, there are three mismatched syllables. The first two mismatches are in the clitic phrase domain and were discussed above. The third mismatch is on the last syllable, ku , of the noun syllable is underlyingly high-toned.
 Example 35 TR: Mod X   X  sa  X  na o  X  kgan  X  na  X  dinku tse  X  sekete. the basic algorithm in terms of the number of matches between the tone labels assigned by the transcribers and the labels output by the algorithm. The basic algorithm yielded 365 matched labels out of 565, while the extended algorithm yielded 409 matches. Table 6 summarizes the results.

In the next section, we provide an analysis of the mismatches between the extended algorithm and the transcriptions. 9.2 Analysis There are 565 tone-bearing syllables in the 45 sentences. In total, there were 156 mismatches between the extended algorithm and the transcriptions. We grouped the sentences according to the similarities found in the mismatches. This yielded six groups, called B X  X . Table 7 shows the number of mismatches in each of these groups. 9.2.1 Group B In this group, the transcriptions give underlying high tones at the end of the phonological phrase as low tones. This cannot be as a consequence of the Finality Restriction rule, since the high tones are underlying and not the result of a high tone spread.

A rule that can account for this is the Mid-Tone Insertion rule Khoali ( 1991 ). By this rule, a high tone on the final syllable of a phonological phrase domain that follows a falling tone, or HL-tone, is realized as a mid-tone Khoali ( 1991 ). However, the transcribers used only two tone levels, high and low, and not the mid-tone. Therefore they assigned a low tone to the syllables which meet the requirements of the Mid-Tone Insertion rule. On the other hand, the extended algorithm does not implement the Mid-Tone Insertion rule either, and left the high tone on the above syllables.

Consider Example 36, in which the diacritic  X  indicates a mid-tone. In this example, the underlying high tone on the final syllable, na , of the pronoun lona surfaces as a low tone. This syllable is at the end of the phonological phrase domain. The two syllables preceding it, ya and lo , have high and low tones respectively; together they form a falling tone. By the Mid-Tone Insertion rule, na is realized as a mid-tone. However, the labelers indicated a low tone.
 Example 36 ((Re tla (hl  X   X  pha) -)C (meetlo) -) / (y a  X  (lona  X  ) -) / 9.2.2 Group C In this group, the transcriptions show a pattern where an underlying high tone on a High Tone Spread rule. The high tone on r i  X  1 then spreads to the next syllable, say r  X  2 , while the high tone on domain span rule. Moreover, the clitic phrase affected must not be the last such phrase in the phonological phrase domain that contains it.

Consider Example 37. According to Du Plessis et al. ( 1974 ), the subject marker a in the second clitic phrase is underlyingly high-toned, while the first two syllables, fe and to , of the verb stem fetoha are underlyingly low-toned. However, a surfaces with a low tone. The syllable fe surfaces with a high tone as a result of high tone spread from a to fe . The syllable to also surfaces with a high tone. Since fe is underlyingly low-toned, the high tone on to cannot be a result of high tone spread from fe . It seems to be associated with a . In other words, the high tone on a spreads to the next two syllables before delinking on the source.
 9.2.3 Group D In this group, a syllable which is underlyingly high-toned according to Du Plessis et al. ( 1974 ), is indicated as low-toned by the transcribers, and vice versa.
Consider Example 38 (from Khoali 1991 , p. 126). The preposition ho is underlyingly high-toned according to Du Plessis et al. ( 1974 ). Therefore the algorithm indicates ho as high-toned. Moreover, it applies the High Tone Spread rule and spreads the high tone on ho to the first syllable, mo , of the noun morena .In cannot apply the High Tone Spread rule and therefore also indicate mo as low-toned.

In summary, there are two mismatches between TR and EA. The first is because of the difference in underlying tones, and the second a consequence of the first. Example 38 TR: ho morena
Recall that there is only a moderate agreement between the transcribers. It is therefore possible that the mismatches in this group are due to chance agreement between the labelers. Moreover, it is possible that the literature Du Plessis et al. ( 1974 ) is not accurate, or that the speaker has different tone assignments compared to the literature of 1974. 9.2.4 Group E In this group, trisyllabic noun stems. 6 at the end of the phonological phrase domain surface with high tones on their first syllables and low tones on the succeeding
Consider Example 39. According to Du Plessis et al. ( 1974 ), the noun stem dipotso has an underlying high tone on its second syllable, po . Therefore the algorithm outputs it as high-toned. However, the transcription indicates po as low-with a high tone, even though all class markers are underlyingly low-toned according to Khoali ( 1991 ).
 Example 39 TR: O  X  tla u  X  tlwa  X  ba  X  bo  X  tsa  X  d X   X  potso 9.2.5 Group F The mismatches in this group show patterns that are neither represented in Groups B X  X , nor explained by any of the tonal rules discussed in Khoali ( 1991 ). Further research on the tonal behaviour of Sesotho may provide reasons for these mismatches. 10 Results Our hypothesis stated that there would be more matched tone labels between the extended algorithm and the transcriptions than between the basic algorithm and the transcriptions. To test the hypothesis, we compared the algorithms in two phases, namely where 1. both algorithms were restricted to the clitic phrase domain, and 2. both algorithms were applied to the whole input.
 In both cases, we determined the statistical significance of the comparison. To do so, there is a significant difference between two groups of dependent samples Boslaugh and Watters ( 2008 ). It is mainly used when the variances of two normal distributions are unknown and the sample size is relatively small.

A t -test may be one-tailed or two-tailed. A one-tailed test indicates the difference between groups and the direction of the difference. A two-tailed t -test indicates the difference between groups only. We used the one-tailed t -test.

For our case, the t -value is calculated as where, for alg 2f EA ; BA g ,  X  p alg 2 X  0 ; 1 is the probability that the algorithm alg will produce a matched  X  N alg is the total number of tone labels used by algorithm alg ,
The t -value has a distribution df with N EA  X  N BA 2 degrees of freedom 7 that advances the normal distribution. In our case, df  X  N EA  X  N BA 2  X  565  X  565 2  X  1128 1 , where 1 indicates infinity.

To test significance, we set a significance level, a . Generally, a result of probability greater or equal to 0.05 is considered significant.

We then compared the t -value to the appropriate critical t -value in the t -test table (see Boslaugh and Watters ( 2008 ) for the t -test table). The critical t -value is calculated by aligning a  X  0 : 05 with df 1 . This gives a critical t -value of 1.645. In other words, if t 1 : 645 , then the extended algorithm is significantly better than the basic algorithm.

In the following sections, we discuss the two phases listed above in detail. 10.1 Restriction in the application of the algorithms In this phase, we considered the performance of the algorithms on the clitic phrase domains of the 45 selected sentences. The syllables that are outside the clitic phrase domains were excluded, leaving 327 syllables.

For each algorithm, we compared its predicted tone labels to the tone labels in the transcriptions. The basic algorithm yielded 194 matched labels, while the extended algorithm yielded 226. Therefore the latter predicted 32 more labels correctly. To statistically verify the results, we performed the t -test.

Firstly Then Since t [ 1 : 645 , the extended algorithm is a significant improvement on the basic algorithm in the clitic phrase domain. 10.2 No restriction in the application of the algorithms The previous section shows that the extended algorithm is an improvement on the basic algorithm when both algorithms are restricted to the clitic phrase domain.
In the second phase, we considered the performance of the algorithms on the whole sentence, in total 565 syllables. When we evaluated the basic algorithm, the syllables outside the clitic phrase domain were assigned their underlying tones as defined in Du Plessis et al. ( 1974 ).

For each algorithm, we compared its predicted tone labels to the labels in the transcriptions. The basic algorithm yielded 365 matched tone labels, while the extended algorithm yielded 409. Therefore the extended algorithm predicted 44 more labels correctly.

To statistically verify the results, we performed the t -test. Firstly Then Since t [ 1 : 645 , the extended algorithm is a significant improvement on the basic algorithm on the whole sentence. 11 Suggestions for further research This study provides the first step towards tone modeling for Bantu languages that do not include tone in orthography, such as Sesotho. A tone modeling algorithm for such languages requires tone marks on syllables in order to assign appropriate pitch values to the syllables and consequently predict the overall intonation of the word.
The study for Yoruba by Odejobi et al. ( 2008 ) predicts the overall intonation of a word using decision trees which are based on tone labels in orthography. This involves predicting, say, the pitch value to be assigned to a high tone that is preceded by a high tone. Such an algorithm can now be developed for Sesotho, since we have a tone label predictor for this language.

Currently, our algorithm is not fully integrated into a TTS system due to the lack of the necessary linguistics resources, such as a Sesotho tone-marked pronunciation dictionary. Until this has been done, we cannot verify the extent to which implementing tone in a TTS system for Sesotho affects the perceived naturalness of the system. Once an algorithm that assigns pitch values to the tone labels predicted by our algorithm has been developed, a perception test should be conducted. Such a test would allow native speakers of Sesotho to grade the synthesized speech. 12 Conclusion Our main aim was to improve the basic algorithm developed by Raborife ( 2009 ), which predicts the tone labels on syllables in Sesotho sentences, using three Sesotho tonal rules. We have improved this algorithm by implementing its extended version, which  X  Implements four further Sesotho tonal rules,  X  Applies the tonal rules to all grammatical categories, and  X  Treats each verb stem in a sentence according to its own context and
Our research study verifies the first part of the suggestion by Louw et al. ( 2005 ), that we need algorithms that predict not only tone marks of syllables, but also the appropriate intonation of words, if we want to implement tone in TTS systems for languages such as isiZulu or the Sotho-Tswana languages. The extended algorithm predicts the tone marks. The appropriate intonation of words can only be dealt with once the relationship between tone labels and fundamental frequency is known for Sesotho Van Niekerk and Barnard ( 2010 ).
 References
