 With the wide availability of GPS devices, current location-based services and applications already have high spatial and temporal requirements for predicting individuals X  future locations [1]. These requirements pose a nontrivial challenge to location predictions. For instance, in pervasive or mobile computing, the spa-tial resolution expected of a predict ion is in the order of 10 meters and the temporal resolution can be as high as a few seconds. In [3,2] both the theoret-ical studies and experimental studies show that individual X  X  next locations are highly predictable, which is around 90%, in either cell tower data or GPS data. However, in two respects these two studies are incomplete. Firstly, the predicted results in these two studies are too coarse in terms of both spatial and temporal resolutions. Specifically, the temporal resolution in two datasets are one hour, and the spatial resolution in cell tower data is a few kilometers and in GPS data is around 500 meters [2]. Secondly, the high prediction accuracy indicates the overall predictability during the entire 14 weeks. This high predictability may be dominated by the cases when the individuals stay at home or in the office for most of the time. However, in certa in cases, such as, when making moves, it may be difficult to predict individual X  X  next location at high spatial-temporal resolutions.

In this paper, the location prediction problem is defined as follows. Given a set of historical positioning records of an individual and a sequence of samples in the current trace, where all position ing records are GPS readings with a fixed sampling rate, e.g., 60 seconds, the problem is to predict this individual X  X  location in the near future, e.g., 60 seconds, 120 s econds, or 180 seconds later. To achieve such purpose, a location prediction method making use of historical records while observing current mobility behaviors is proposed. Since previous studies suggest that there is a high probability that the individuals will follow previous traces [3,2], the current trace may be similar to some traces in the past. Therefore, we propose to use dynamic time warping [4] to measure the similarity between traces. However, when using similar traces to estimate the future location, there may not be a record that corresponds exactly to the required point of time, and hence there is a need to model the individual X  X  movements in between two sampled positions. A Brownian Bridge model [12], therefore, is proposed to model the variance of an inferred location in between two existing sample points. In the Brownian Bridge model, the location at any time is modeled as a Gaussian distribution to cater for the measurement errors associated with GPS readings. A linear extrapolation method is also used to model the individual X  X  current mobility behaviors. The predicted location is a combination of the results from the Brownian Bridge models and the result from the linear extrapolation method.
In order to evaluate our location prediction method, we compare our method with two baseline methods, namely, the linear extrapolation method and a method that only uses similar traces. In t erms of average prediction errors, the experimental results show that our method is much better than either method that uses only linear extrapolation or similar traces alone, in predicting locations at different time horizons.

Our contributions consist of a few parts. Firstly, we propose an algorithm of applying the edit distance for measuring the similarity between mobility traces. Secondly, we present and evaluate the Brownian Bridge model for modeling a person X  X  movements in between any two sample points. Thirdly, we present a prediction method that is capable of high spatial-temporal resolution predic-tion by exploiting the individual X  X  mobility behaviors in the current trace and historical records. The existing approaches for location prediction can be classified into two groups. In the first group, individual X  X  mobility history is constructed based on either significant locations [5,6] or region-of-interest [7], both of which are generated by applying a clustering method, such as DBSCAN [8] or K-Means [9], on histori-cal records from either the given person o r a large population. Then, according to the transition records between the significant locations or region-of-interest, a probabilistic model based on either Bayesian theory or Markovian theory is constructed to infer the next location. A major issue here is that, the con-structed probabilistic models can be applied to infer the next locations only when individuals visit the significant location; otherwise the model fails. Also, in these studies, the transition time between two locations is generally disregarded.
In the second group of approaches, the next move is predicted entirely based on trajectory patterns [10,11]. In such cases, the trajectories are represented as spatio-temporal items, e.g, a list of locations and the corresponding transition times. The current trace is matched to the historical records by searching through the pattern tree. Two methods [10,11] that make use of the trajectory patterns alone typically suffer from the major limitation in the timing allowed for making predictions, because of the tight coup ling between the prediction time and the sampling rate. Similarly, the trajectory pattern mining method is only applicable to inferring the location at a point in time for which the corresponding sample is available in the matched traces; predicting the location at any other time in between the sampling method is impossible. In this section, we describe our method for measuring the distance between traces based on two ideas. Firstly, there is a high probability for the individuals to follow the same routes [3,2]; howeve r, the recorded traces may be largely different due to different initial recording time or the errors in GPS readings. Therefore, it should be useful to find the most similar subtraces while tolerating certain degree of inexactness. Secondly, individuals often traverse a route in both directions. Thus, we compar e the traces in both direct ions and record the results that satisfy the distance threshold.

According to these ideas, we pres ent a trace matching algorithm Trace-matching based on dynamic time warping. Note that a matching need not be starting from the first index, but it should always end with the last index | t p | . This ensures using the last location in finding a match, which is further elab-orated in Section 4.3. The matching procedure starts by finding a sequence of Algorithm 1. Trace-matching( T p , T tr ,  X  init ,  X  thd ) Algorithm 2. follow-up-matching( T p , M , T tr ,  X  thd ) locations in each trace in T tr , such that each location is within  X  init distance to the initial index in T p (Line 3 to Line 11). Given the traces with the points within  X  init distance to the initial index of the target trace, we start matching from the second location of the target trace to the following locations given in Alg. 2. If there is a matched candidate within a given distance threshold  X  thd , we output the matched results. Otherwise, we shorten the current trace by removing the most temporally-distant one (Line 19), and the matching process repeats.
Alg. 2 describes the follo w-up matching steps given the matched traces from the initial phase. We determine the direction of the matching when calling the follow-up-matching for the first time. Specifically, if the starting index sid is less than the ending index eid , the current candidate trace is from index sid to eid + 1 (Line 3). Otherwise, the current candidate trace is the reverse of the given trace from index sid to eid  X  1. Also, when calling follow-up-matching for the first time, (Line 5), we add an additional piece of information by reversing the previous matching. The reason is that when comparing two line segments, we do not consider the direction of each line, therefore the subsequent matching may be conducted in either direction. The distance of the two traces, given as D ( T p ,T j ), is measured by dynamic time warping [4]. If the distance is less than the threshold  X  thd , we update the matching information according to the current direction, otherwise we remove the current matching.

Here the complexity of the two algorithms is analyzed. In Alg. 1, the most computationally expensive part is the initial matching. The complexity of find-ing the initial matching in each trace is O ( N p ), where N p is the total number of sample points in existing traces. The space requirement is O ( N p ). In Alg. 2, the complexity of the matching procedure is O ( | T p | 2 ), where | T p | is the length of the target trace. However, once all the current distance values in the matrix are greater than the threshold, the calculation can be terminated and current match-ing can be removed. The space requirement is upper-bounded by the distance tice, the time complexity is determined b y the longest trace in each individual X  X  data. The overall spa ce requirement is O ( | T p | 2 ). In this section, we consider the issue of p redicting the next location at a specific point in time, given a few previous locations and historical trajectories that match the current trace. 4.1 Method A: Linear Extrapolation The first location prediction method is based on linear extrapolation without using historical records. We predict the location at time t x basedonthelast two locations on the current trace. Let the two locations arise at t i  X  1 and t i , and there is no record in current trace in between time t i to t x . In the linear extrapolation, the location at time t x is given as 4.2 Method B: Estimation According to the Distance The predicted location is the weighted m ean location from the results of extend-ing the matched traces one step further following the matched sequence, where the weight of each location is proportional to the inverse of the corresponding edit distance to the current trace 1 . 4.3 Method C: Estimation by Brownian Bridge This location prediction method combin es the inferred location according to the Brownian Bridge model of each matched trace.
 Preliminary. Brownian Bridge is a random process following a specific rule to generate a path between two given locations.
 Definition 1. A one-dimensional Brownian motion [12] W ( t )  X  R is a continuous-time stochastic process satisfying the following properties: 1) W 0 =0 , 2) W t is almost surely continuous, and 3) for 0  X  s  X  t , W t has independent increment, and W t  X  W s  X  X  (0 ,t  X  s ) ,where N (  X ,  X  2 ) denotes the normal distribution with mean  X  and standard deviation  X  .
 Definition 2. Let W ( t ) be a one-dimensional Brownian motion. Given T&gt; 0 , the Brownian Bridge [12] from W 0 =0 to W T =0 on [0 ,T ] is the process X ( t )= W ( t )  X  t T W ( T ) ,where t  X  [0 ,T ] .
 The Brownian Bridge from W 0 = a to W T = b on [0 ,T ] is the process where X ( t )= X 0  X  0 is the Brownian Bridge given in Def. 2.

The Brownian Bridge from a to b is described in the following way. At time t , the estimated location is chosen from a Gaussian distribution, where the mean of the Gaussian distribution is given by the linear estimation and the variance varies with respect to time. Specifically, the variance increases at time T/ 2to the maximum, and decreases till time T . The property of the variance is very suitable for modeling the uncertainties about a person X  X  locations between two known locations. When the predicted time is very close to the time obtained from the existing position samples, the mobility may not change greatly and the prediction can be of high accuracy. When the time of interest lies in between the two actual samples, the accuracy of the prediction result decreases.

In our case, the one-dimensional Brownian Bridge is extended to the two-dimensional version, where the x and y coordinates vary independently. An ad-ditional parameter, the variance of each trace  X  2 m , is introduced to model the mobility behaviors in each trace. Therefore, the variance of the estimated loca-tion is adjusted to 2
According to the Brownian Bridge model, the method of estimating the loca-tion at time t x based on the current trace is given as follows. In the current trace, two existing points p k and p k +1 satisfy that t k &lt;t x &lt;t k +1 . When considering the error of each point, the locations at time t k and t k +1 are generated from p of the GPS reading. The location at t x is given as p x  X  X  (  X  x ,  X  2 x ), where where  X  m is the standard deviation of the trace.  X  k = t x  X  t k t Location Prediction. Given individual X  X  current records in the given trace T we focus on predicting the location at the time t x .
 Algorithm 3. location-prediction( M , t x , T p , i p )
Alg. 3 presents the details of the location prediction method. Firstly, we nor-malize the time in both predicted trace and the matched trace according to the initial matched index (Line 1 and Line 4). This is because the estimated results for the Brownian Bridge model is highly time dependant. Secondly, the estimated location p i based on current matched trace is given as a Gaussian distribution N (  X  i ,  X  2 i ), where the parameters are inferred according to Eq. (4) and Eq. (5), respectively. Lastly, we combine the estimated results from each Brownian Bridge and also the linear extrapolation result from the current trace. The estimated location p b is given by p b  X  X  (  X  b ,  X  2 b ), where  X  b = 1  X  k  X | M | ,and j is the index of the matched trace. For k = | M | +1,  X 
M | +1 = p l and w | M | +1 =1 / X  init , which is the result from linear extrapolation. In this section, we co mpare three location prediction methods. 5.1 Mobility Data The mobility data used in this study is a subset of the GPS dataset released by Zheng Yu [14,15]. From this dataset, we extract 40 individual X  X  trajectories over 14 weeks. The following preprocessing is conducted. Firstly, each individual X  X  trajectory is divided into a series of t races based on the time gap between two GPS points. If the gap is longer than 300 seconds, the sequence will be divided into different traces. Each trace is resampled at the rate of 60 seconds, and the dataset is denoted as T tr, 60 . Each individual X  X  traces are randomly separately into a training set and predicting set, where the training set contains 70% of all the traces and the remaining traces are use d to evaluate the location prediction methods. To cater for the characteristics of individual X  X  mobility behavior, the training and prediction steps are separately evaluated on the individual X  X  own data. The location of each point indicated by a pair of latitude and longitude is converted to x and y co ordinates according to 0  X  in both latitudinal and longitudinal direction [16].
 When estimating the standard deviation of each trace fitted by Brownian Bridge model according to our method [13], among the 3225 training traces in our dataset for 82.5% of the traces show a standard deviation of less than 0.05 km, with only one trace presents a standard deviation of 0.069 km, and the mean standard deviation is 0.021 km, indicating that the Brownian Bridge model is a suitable choice for predicting the location given the locations before and after the predicting time. 5.2 Location Prediction In this subsection, we evaluate the location prediction methods based on T tr, 60 in two respects. Here, firstly the three location prediction methods are compared. For each prediction, all the previous locations in the current trace and the time for prediction are given. The performance is evaluated by the distance of the predicted location to the actual location in the current trace. Note that when predicting using the Brownian Bridge model, the estimated mean location is the result. Also the parameter  X  thd is tested with the values of 0 . 3km,0 . 2km,0 . 1 km and 0 . 05 km, with the initial threshold set to be  X  init =0 . 05 km in all these cases.
In all the cases tested, the prediction errors given by Method C, the com-bination of linear extrapolation and Brownian Bridge model, is always lower than either Method A or Method B that us es linear extrapolation or similar traces alone, respectively. Secondly, in Method B the choice of using either the most similar trace or the list of similar traces depends on the distance threshold. Specifically, in Method B, when the similarity threshold is large, e.g.,  X  thd =0.3 or 0.2, the prediction result is adversely influenced by the most similar trace, since using only the most similar trace results in a larger mean prediction error than that by using all the matched traces . However, when the distance threshold is small, e.g.,  X  thd = 0.1 or 0.05, using the most similar trace is more effective than using all the matched traces in Method B, which may be due to the stricter distance criterion in measu ring similarity. However, for the prediction results by Method C, in all the cases mentioned before, making use of the most similar trace is slightly worse than that obtained by using all the similar traces. This is because the Brownian Bridge model is able to adjust the prediction with respect to the given point of time. Thirdly, given  X  thd =0 . 1, Method C is much more discriminative than both the linear extrapolation method (Method A) and the prediction using only similar traces (Method B). Specifically, the mean predic-tion error for Method C is 0.084 km, while that of the Method A and Method B is 0.099 km and 0.105 km, respectively.

Note that the prediction results may be affected by  X  thd when using either method B or method C according to the most similar trace. This is because varying  X  thd the most similar trace may be d ifferent. For instance, when  X  thd is small, the most similar trace may have only two or three samples. When increasing  X  thd , a longer matched trace or subtrace may be found. Therefore, the distance threshold  X  thd also affects the prediction results obtained by the most similar trace.
Secondly, we evaluate our method for predicting location with time horizons of 120 seconds and 180 seconds. Note that the location prediction by using similar traces is only suitable for the case to predict the location at a point in the similar traces. This is because the longer the prediction time is, the less likely to find a location at roughly the same time in the similar traces. Therefore, the comparison is only made between the linear extrapolation method and Method C. The prediction results, which are given in terms of the distribution of errors shown in Figure 2 (a). The mean errors for the consecutive steps are 0.099 km, 0.214 km, and 0.345 km for the linear extrapolation method, while the corresponding result for the Brownian Bridge model are 0.084 km, 0.173 km, 0.281 km, respectively. In all these ca ses, the Brownian Bridge model shows lower mean errors than the linear extrapolation, especially for predicting the location in longer time horizons.

Moreover, Figure 2 (b) shows the distributions of the estimated standard deviation of the predictions in Method C in the case of predicting the future location at t x = 60, t x = 120, and t x = 180. A few observations can be made from this figure. Firstly, in all the cases, the estimated standard deviation is very small, which is less than 0.03 in the most cases. This is due to that the estimated standard deviation is calculated according to each Brownian Bridge model given by Eq. (5).
 The mean standard deviation  X  m for the traces is 0.021 km and the error of GPS measurement is  X  g =0 . 01 km. Therefore, the maximum standard deviation given by Eq. (5) is when  X  x = 1 2 , indicating inferring a location in between two samples, which is roughly 0.082 when t x = 60 in our case. However, a much smaller standard deviation given in Figure 2 (b) indicates that the predictions are mostly near either the starting location or the ending location in the similar traces. This is because when constructing the Brownian Bridge model in the similar traces, the predicted locations with low standard deviations are mostly near either the starting point or the ending point (c.f. Eq. (5)). Secondly, the estimated standard deviation does not in crease significantly when predicting the location in longer time horizons, e.g., when t x =120 or 180. Recall that in each prediction the time is always nor malized according to the corresponding initial index in both the current trace and a matched trace. The locations used in constructing the Brownian Bridge model are always the two locations that correspond to right before and right after the normalized time of prediction.
According to the comparisons based on the mean prediction errors and the estimated standard deviations, combining the linear extrapolation method and individual X  X  historical records is a suitable choice for location prediction. 5.3 Discussions For the few location prediction methods discussed before, the Brownian Bridge model fails to predict if there is no similar trace within a given distance threshold to the current trace. Because the linea r extrapolation method shows decent re-sults while using only two location samples. A possible remedy to the Brownian Bridge method is to apply the linear extrapolation in the case of failing to find a match in the records.

One useful method for location prediction is the Kalman filter. We do not choose Kalman filter for the following reasons. Firstly, a Kalman filter needs to be specifically designed for each trace since the mobility behaviors may change greatly even for the same individual. Secondly, learning the parameters in each trace needs sufficient number of sample points, implying that the method is unable to make any prediction for traces with few records. In contrast, with our Method C, since the matching can be based on a subsequence of the current trace with a few existing samples, it will be able to predict the future location even with a few records. In this paper, we have presented a new algorithm for location prediction by making use of similar traces and individual X  X  current mobility information. The similar traces with current target trace are found on the basis of the edit dis-tance. In order to predict individual X  X  location at any given point of time, we use a Brownian Bridge to model the uncertain ties about person X  X  movements in be-tween any two locations. The final prediction combine both the current mobility behaviors described by the linear extra polation method and also the estimated results from the individual X  X  Brownian Bridge models from similar traces. Ex-perimental results show that our location prediction method by using Brownian Bridge model is better than that using only the historical records or the linear extrapolation method.

There are a few issues unresolved in thi s study. For instance, we have shown in some cases, the linear extrapolation method is better than using the histor-ical records or vice versa. Therefore, how to choose the right method at each predicting time is a relevant question for future research.

