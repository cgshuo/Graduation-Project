 1.1 Utility of discriminant analysis in EEG Brain computer interface (BCI) algorithms [1][2][3][4] ai m to decode brain activity, on a single-trial basis, in order to provide a direct control pathway bet ween a user X  X  intentions and a computer. Such an interface could provide  X  X ocked in patients X  a more d irect and natural control over a neu-roprosthesis or other computer applications [2]. Further, by providing an additional communication channel for healthy individuals, BCI systems can be used to i ncrease productivity and efficiency in high-throughput tasks [5, 6].
 of behavior. By extracting activity that differs maximally between two experimental conditions, the typically low signal-noise ratio of EEG can be overcome. The resulting discriminant components while the improved SNR can be leveraged to correlate variabi lity of neural activity across trials to behavioral variability and behavioral performance [7, 5]. In essence, discriminant analysis adds to the existing set of multi-variate statistical tools common ly used in neuroscience research (ANOVA, Hoteling T 2 , Wilks X   X  test). 1.2 Linear and quadratic approaches In EEG the signal-to-noise ratio of individual channels is l ow, often at -20dB or less. To overcome this limitation, all analysis methods perform some form of a veraging, either across repeated trials, across time, or across electrodes. Traditional EEG analysi s averages signals across many repeated trials for individual electrodes. A conventional method is to average the measured potentials follow-ing stimulus presentation, thereby canceling uncorrelate d noise that is not reproducible from one in phase to the timing of the stimulus. Alternatively, many s tudies compute the oscillatory activity in specific frequency bands by filtering and squaring the sign al prior to averaging. Thus, changes in oscillatory activity are termed event related synchroniza tion or desynchronization (ERS/ERD). Surprisingly, discriminant analysis methods developed th us far by the machine learning community have followed this dichotomy: First order methods in which t he amplitude of the EEG signal is considered to be the feature of interest in classification  X  c orresponding to ERP  X  and second or-der methods in which the power of the feature is considered to be of importance for classification  X  corresponding to ERS/ERD. First order methods include tem poral filtering + thresholding [2], hierarchical linear classifiers [5] and bilinear discrimin ant analysis [8, 9]. Second order methods include the logistic regression with a quadratic term [11] a nd the well known common spatial pat-terns method (CSP) [10] and its variants: common spatio-spe ctral patterns (CSSP)[12], and common sparse spectral spatial patterns (CSSSP)[13] .
 Choosing what kind of features to use traditionally has been an ad hoc process motivated by knowl-edge of the underlying neurophysiology and task. From a mach ine-learning point of view, it seems method to extract the relevant neurophysiological activit y de novo with minimal prior expectations. In this paper we present a new framework that combines both th e first order features and the sec-ond order features in the analysis of EEG. We use a bilinear fo rmulation which can simultaneously extract spatial linear components as well as temporal (filte red) features. 2.1 Problem setting Given a set of sample points D = { X to the EEG signal of D channels and T sample points and y conditions, etc.), the task is then to predict the class labe l y for an unobserved trial X . 2.2 Second order bilinear model Define a function, where  X  = { U  X  R D  X  R , V  X  R T  X  R , A  X  R D  X  K B  X  R T  X  T 0 } are the parameters of the model, following discriminative model ; we model the log-odds ratio of the posterior class probabil ity to be the sum of a bilinear function with respect to the EEG signal a mplitude and linear with respect to the second order statistics of the EEG signal: 2.2.1 Interpretation of the model The first term of the equation (1) can be interpreted as a spati o-temporal projection of the signal, u v where we defined W = UV T , it is easy to see that the bilinear projection is a linear com bination of elements of X with the rank  X  R constrained on W . This expression is linear in X and thus evoked response versus negative evoked response) will cont ribute significantly to discrimination if the EEG signal.
 The second term of equation (1), is a projection of the power o f the filtered signal, which captures the second order statistics of the signal. As before, each co lumn of matrix A and B , represent components that project the data in space and time respectiv ely. Depending on the structure one enforces in matrix B different interpretations of the model can be archived. In t he general case where no structure on B is assumed, the model captures a linear combination of the el ements of a rank  X  T 0 second order matrix approximation of the signal  X  = XB ( XB ) T . In the case where Toeplitz structure is enforced on B , then B defines a temporal filter on the signal and the model captures the linear combination of the power of the second or der matrix of the filtered signal. For example if B is fixed to a Toeplitz matrix with coefficients corresponding to a 8Hz-12Hz band pass filter, then the second term is able to extract differences in the alpha-band which is known to be modulated during motor related tasks. Further, by learning B from the data, we may be able to identify new frequency bands that have so far not been identi fied in novel experimental paradigms. The spatial weights A together with the Trace operation ensure that the power is measured, not in individual electrodes, but in some component space that m ay reflect activity distributed across several electrodes.
 Finally, the scaling factor  X  (which may seem superfluous given the available degrees of fr eedom) is necessary once regularization terms are added to the log-likelihood function. 2.3 Logistic regression We use a logistic Rregression (LR) formalism as it is particu larly convenient when imposing ad-addition, in our experience, LR performs well in strongly ov erlapping high-dimensional datasets Under the logistic regression model (2) the class posterior probability P ( y | X ;  X  ) is modeled as and the resulting log likelihood is given by We minimize the negative log likelihood and add a log-prior o n each of the columns of U , V and A and parameters of B that act as a regularization term, which is written as: where the log-priors are given for each of the parameters as log p ( u , K trol the smoothness of the parameter space. Details on the re gularization procedure can be found in [8].
 by: where we define where u 2.4 Fourier Basis for B If matrix B is constrained to have a circular toepliz structure then it c an be represented as B = F  X  1 DF , where F  X  1 denotes the inverse Fourier matrix, and D is a diagonal complex-valued matrix of Fourier coefficients. In such a case, we can re-write equat ions (9) and (10) as where  X  D = DD T , and the parameters are now optimized with respect to Fourie r coefficients d D 3.1 Simulated data In order to validate our method and its ability to capture bot h linear and second order features, we generated simulated data that contained both types of featu res; namely ERP type of features and ERS/ERD type of features. The simulated signals were genera ted with a signal to noise ratio of  X  20 dB which is a typical noise level for EEG. A total of 28 channels, 500 ms long signals and at a sampling frequency of 100Hz where generated, resulting in a matrix of X of 28 by 50 elements, for mean Gaussian noise (representing baseline conditions), w ith the other 500 trials having the signal of interest added to the noise (representing the stimulus co ndition): For channels 1-9 the signal was composed of a 10Hz sinusoid with random phase in each of the ni ne channels, and across trials. The Figure 1: Spatial and temporal component extracted on simul ated data for the linear term (top) and quadratic term (bottom). sinusoids were scaled to match the  X  20 dB SNR. This simulates an ERS type feature. For channels 10-18, a peak represented by a half cycle sinusoid was added a t approximately 400 ms, which T simulates an ERP type feature.
 The extracted components are shown in Figure 1. The linear co mponent U (in this case only a col-umn vector) has non-zero coefficients for channels 10 to 18 on ly, showing that the method correctly profile that matches the time course of the simulated evoked r esponse. Similarly, the second order components A have non-zero weights for only channels 1-9 showing that the method also identified the spatial distribution of the non-phase locked activity. The temporal filter B was trained in the frequency domain and the resulting filter is shown here in the time domain. It exhibits a dominant 10Hz component, which is indeed the frequency of the non-pha se locked activity. 3.2 BCI competition dataset To evaluate the performance of the proposed method on real da ta we applied the algorithm to an EEG was recorded on 28 channels for a single subject performi ng self-paced key typing, that is, pressing the corresponding keys with the index and little fin gers in a self-chosen order and timing (i.e. self-paced). Key-presses occurred at an average spee d of 1 key per second. Trial matrices were extracted by epoching the data starting 630ms before ea ch key-press. A total of 416 epochs were recorded, each of length 500ms. For the competition, th e first 316 epochs were to be used for classifier training, while the remaining 100 epochs were to b e used as a test set. Data were recorded at 1000 Hz with a pass-band between 0.05 and 200 Hz, then downs ampled to 100Hz sampling rate. For this experiment, the matrix B was fixed to a Toeplitz structure that encodes a 10Hz-33Hz bandpass filter and only the parameters U , V , A and w flexibility of our approach to either incorporate prior know ledge when available or extract it from Figure 2: Spatial and temporal component (top), and two spat ial components for second order fea-tures (bottom) learned on the benchmark dataset data otherwise. Regularization parameters where chosen vi a a five fold cross validation procedure (details can be found in [8]). The resulting components for t his dataset are shown in Figure 2. Benchmark performance was measured on the test set which had not been used during either train-operator characteristic (ROC) curve for cross validation a nd for the independent testset are shown in the two types of key-presses. The figure shows that the two ter ms provide independent information and that in this case the optimal relative weighting factor i s C  X  0 . 5 . In this paper we have presented a framework for uncovering sp atial as well as temporal features in EEG that combine the two predominant paradigms used in EEG an alysis: event related potentials and non-phase locked activity (where only the power of the si gnal is relevant). We used the proba-increased number of parameters. We have evaluated the propo sed method on both simulated data, and a real BCI benchmark dataset, achieving state-of-the-a rt classification performance. The proposed method provides a basis for various future dire ctions. For example, different sets of basis functions (other than a Fourier basis) can be enforced on the temporal decomposition of the data through the matrix B (e.g. wavelet basis). Further, the method can be easily gene ralized to Figure 3: ROC curve with area under the curve 0.96 for the cros s validation on the benchmark dataset (left). ROC curve with area under the curve 0.93, on the indep endent test set, for the benchmark reported, placing this method in first place in the benchmark ranking. Figure 4: Scatter plot of the first order term vs second order t erm of the model, on the training and of features contain independent information that can help i mprove the classification performance. L
