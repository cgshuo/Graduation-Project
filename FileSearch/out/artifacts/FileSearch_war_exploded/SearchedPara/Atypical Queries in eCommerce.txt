 Understanding how specific, ambiguous, or broad the intent of a search query is, across all users of the system, is important in im-proving search relevance in eCommerce. There is scant literature on such a structural characterization of queries in eCommerce. In this paper, we use query-click log data to address the problem of identifying  X  X typical queries X : these are queries that are extremal in terms of specificity, ambiguity, or breadth of intent. We isolate three components of atypicality: geometric, statistical, and topo-logical. We demonstrate, using query-click logs at Groupon, that certain combinations of these properties render a query atypical, and discuss how search analysts treat such queries differently. Our work is being used to improve search relevance at Groupon. H.3.3 [ Information Storage and Retrieval ]: Information Search and Retrieval X  search process; relevance feedback eCommerce search; atypical queries; query intent disambiguation eCommerce is one of the cornerstones of the internet age. As of 2013, the global eCommerce business-to-consumer market was valued at USD 1.3 Trillion. eCommerce companies devote a large amount of effort in trying to gain structural insights about user in-tent for high-volume queries. In particular, they are highly inter-ested in the specificity, breadth, and ambiguity associated with a query. Understanding these properties of a query allows them to show an appealing result set to their users. It also enables them to personalize this result set based on user attributes. Finally, such an understanding powers alternative product recommendations made to users who have issued the query.

Although characterizing queries in the manner described above requires intensive effort, often with a significant manual compo-nent, there is scant literature on this problem. In contrast, the prob-lem of understanding query ambiguity (and its relationship to query performance) is an active field in text document retrieval.
In this paper, we address this gap. We consider the research ques-tion of automatically identifying queries that are extremal in each of the aforementioned aspects: namely, queries that are highly spe-cific, or very broad, or highly ambiguous. We call such queries atypical queries . Furthermore, we would like to identify atypical queries with very little manual intervention or inspection, except for an initial configuration of our system.

The hurdle to answering our research questions lies in extracting notions of typicality that are general enough to capture aggregate user behavior. Our approach is to bootstrap out notions of typicality from query-click data, without external knowledge . This makes our methods completely general. We demonstrate our approach on a dataset of six months of query logs from the Groupon site.
Our contributions are outlined below. 1. We introduce research on a broad structural understanding of 2. We provide a theoretical framework for identifying queries 3. Our framework considers three aspects of a query-click dis-4. The three properties above, being inherent to the query-click Users interact with eCommerce sites primarily through searches. A specific search is called a query and may consist of one or more terms (e.g.  X  X didas X  or  X  X pple iMac X ). Each product in the in-ventory is placed into one or more categories in the product tax-onomy (e.g. men X  X  shoes or electronics, for the previous exam-ples). Let us assume that we are studying the set of all queries Q = { Q 1 , Q 2 ,..., Q m } made over a specific period of time. Let the set of categories in the product taxonomy be C = { C 1 , C
When a user makes a query, and then clicks on products in the result set, these clicks are recorded against the categories that the products are in. For each query, we aggregate these user clicks over a certain time period. These aggregated clicks, when normalized, form a distribution over categories. For example, the query  X  X in-tage X  might result in a bimodal distribution, with peaks over the categories  X  X ine stores X  and  X  X uto parts. X  Some formal definitions are in order.
 Definition 1. The signature of a query Q i  X  Q , is denoted by sign ( Q and defined as the vector w i = ( w i 1 ,..., w in ) , where w some queries and where they lie in the distribution. gregate number of clicks on (products of) category C j , generated by query Q i .

The signature sign ( Q i ) can be converted into a probability dis-tribution over C by normalizing by  X  j = n j = 1 w i j . We refer to this as the normalized signature . To keep notation light, we use the same symbols for the signature and the normalized signature.
 Definition 2. The support of a query Q i is defined as Namely, it is the set of categories where the query Q i has a non-zero signature.
 Definition 3. The set of signatures for all Q  X  Q is called the query-category click model .
 The key idea that guides our approach is the following.

The question now is: what are these properties of the query X  X  sig-nature? Based on our extensive collaboration with search analysts at Groupon, we have identified three properties that we call locality, flow, and coverage. These are formalized in the next section.
In this section, we build a mathematical framework in which the ideas of the previous section can be precisely expressed.
In order to define the quantities of our interest, it will help to place some preliminary definitions.
 Definition 4. Let w i j be the aggregate number of clicks generated by Q i that go to category C j in the query-category click model (Def. 3). The signature of a category C j is defined as Definition 5. The similarity between two categories C i and C defined as the cosine similarity of their query signatures. Definition 6. The closure of a category C i , w.r.t. a threshold T is defined as follows:
The value of T is determined empirically based on the applica-tion, and is suppressed in order to keep notation light. Definition 7. The locality of a query is the average of the pairwise similarities of the categories in its support. Namely, locality ( Q ) = avg { sim ( C i , C j ) : C i , C j  X  supp ( Q ) and C If | supp ( Q ) | = 1, then locality ( Q ) = 1 by definition.
Locality is a geometric notion: it measures distances between the categories in supp ( Q ) . These distances are, in turn, based on the aggregate query-click log. Namely, two categories are  X  X lose X  when many queries have clicks that distribute over both categories. We refer the reader to [2] for a detailed treatment of entropy. Definition 8. The (information-theoretic) entropy of a discrete prob-ability distribution P , whose masses are { p i } , is defined as Definition 9. The flow for a query is defined as the entropy of its normalized signature.
Flow is a statistical notion: it measures how  X  X venly X  the distri-bution over categories in supp ( Q ) is. Namely, what is the uncer-tainty (in the sense of information theory) in this distribution. Definition 10. The coverage of a query Q is defined as
Co verage is related to the notion of local cover in topology [7]. It examines how closed supp ( Q ) is w.r.t.  X  X imilar X  categories. Namely, if C i  X  supp ( Q ) , then how many categories similar to C supp ( Q ) .
In this section, we argue that there are certain combinations of locality, flow, and coverage that mark a query as being atypical.
Our framework is general, and the set of atypical combinations can be expanded for specific applications. We provide three such combinations as working examples, explain why they are atypical, and what eCommerce search analysts aim to do in each case.  X 6.4 gives examples of queries in each of the three regions.
Locality measures how similar are the categories that appear in the signature of a query. Low locality means that the clicks gen-erated by a query are distributing over dissimilar categories. High flow means that there is a more uniform distribution over several such categories. Due to this, it is more likely that the query is broad, having inventory in multiple categories. For such queries, search analysts aim to maximize recall so that all products that could potentially match the broad query be shown.
This combination of properties indicates that the query is being made by a small number of different sets of users having different intents. A toy example would be a query such as  X  X pple X  which might be made with intents varying between food and computers. Food and computers have a low similarity score since they do not frequently co-occur in query signatures; consequently, such a query would have low locality. Such queries are candidates for disam-biguation by eCommerce search analysts. 1
The combination of properties in this case indicate high speci-ficity of the query. Not only does the signature not have a large support, the support is very  X  X elective X  in that it has low coverage, and high locality. eCommerce search analysts treat such queries as being highly specific, and aim for high precision here in order to satisfy the user. Ensuring high recall is secondary for such queries.
To our knowledge, this is the first work focused on the question of characterizing atypical queries in the context of eCommerce. There are a few related areas of research in information retrieval that our work touches upon.

The problem of predicting query performance has been studied by many research groups in the context of content-based queries [3, 1, 10] or, more generally, web search queries [11, 6]. The re-search can broadly be categorized as being focused on pre-retrieval or post-retrieval performance measures. Pre-retrieval measures pre-dict how a query would perform in a search system by using only the properties associated with the query and assuming that the result-set is not available. A survey of pre-retrieval performance predic-tors can be found in [5]. We focus specifically on post-retrieval measures as the low dimensionality of the query space in eCom-merce negates many of the advantages of pre-retrieval performance predictors. Some examples of post-retrieval measures are Jensen-Shannon divergence [1] and weighted information gain [11], which predict the performance of a query in terms of average precision on a retrieval task, using characteristics of the query and the result-set.
A related area of research is the problem of detecting ambigu-ous queries. In [3], the authors claim that a strong predictor of low performing queries is lack of query ambiguity, namely how much information does the query term contain with regard to specify-ing user intent. They have quantified this through a measure called clarity score which measures the relative entropy between the query and the retrieved result-set. The variability in user intent, captured by query ambiguity measures, has also been studied in the context of search personalization by [9, 4]. Dou et al. [4] introduce the
A frequently used technique is  X  X earch in: X  where the user is pre-sented with (for the example of apple) the choice to search in elec-tronics or in food, in order to disambiguate. click entropy measure for a query to judge its suitability for per-sonalization. This is one of the measures that we use in the classi-fication of atypical queries. Song et al. [8] developed a supervised learning model to classify ambiguous queries and recognized that queries that are not ambiguous could either be  X  X road X  or  X  X lear X  queries. Their model, however, does not distinguish between these two classes. Our notion of atypicality in the context of eCommerce is broader. Rather than defining a single measure of ambiguity, we focus on measures derived from the implicit query-click data that can be collectively used to categorize queries in terms of the broad-ness or ambiguity of user intent. Our framework is general and can be adapted to any domain-specific search engine.
We demonstrate our approach on a dataset, Groupon_QL, con-taining roughly 41,000 distinct queries with the highest query vol-ume, aggregated from search logs at Groupon over a six month period beginning October 2014. For each query, the aggregated user clicks are normalized to form a distribution over the set of cat-egories. The number of categories is 986. In order to reduce noise in the computation of locality, we only consider categories having at least 10% contribution in the normalized query signature. Objective. To examine the distributions of locality, flow, and cov-erage in Groupon_QL.
 Methodology. We computed locality, flow, and coverage for each of the queries in Groupon_QL to obtain the distribution.
 Results. The results are shown in Fig. 1.
 Discussion. Each of the three distributions displays different char-acteristics. Locality is roughly evenly distributed in its range of [ 0 , 1 ] . This is surprising, since we might expect the distribution to be significantly concentrated at higher values; however this is not so. This shows that queries are not, in general, significantly more local. Flow peaks around the value of 1. Since flow is an entropy, its unit is  X  X umber of bits. X  One bit of entropy describes a two state even distribution, and this is roughly the mode of the flow distribu-tion. Coverage displays a falling mean-trend with increased values, except for a peak at coverage of one. The pearson correlation be-tween the three quantities is very low, except for locality and flow which are negatively correlated 2 . Objective. To identify atypical queries in Groupon_QL, and inves-tigate the accuracy of the proposed techniques.
 Methodology. We isolated a set of 3000 previously untagged queries in Groupon_QL which had sufficient query volume (i.e. were queried more than 100 times in 6 months). We computed locality, flow, and coverage for each of these queries, and then used the framework of  X 4 to identify atypical queries. The thresholds to define the regions were: Region I (locality &lt; 0 . 05 and flow &gt; 3 . 5), Region flow &lt; 1 . 4, and coverage &lt; 0 . 05). This gave us 590 queries, out of which 120 were randomly sampled from each of the three regions to generate the test data set. Then, two experienced search analysts at Groupon were asked to tag each of these 120 queries as  X  X axi-mize recall, X   X  X isambiguate X  or  X  X aximize precision, X  (resp.) de-pending on which region of atypicality the query lay.
Correlation between coverage and locality is near zero, between locality and flow is -0.47 and between coverage and entropy is 0.11. Results. Shown in Table 2 Discussion. Region III queries were most easily isolated by the two analysts, due to predominance of easily distinguishable brands, both local and global. The lowest agreement was found on Region II queries, and almost all the differing queries were assigned the label  X  X aximize precision X  by the analysts. This is both due to a certain amount of randomness in click activity and the presence of dual intent behind some seemingly specific queries. For instance, when people search for  X  X erta X , the underlying intent is commonly assumed to be a mattress purchase, but it could also refer to a furni-ture purchase intent. Some Region I queries were assigned the label  X  X aximize precision X  due to specific keywords like  X  X ams Club X  but the underlying click activity has very high flow because the in-tent cannot be localized to a definite category. Despite the shift in labels, the common consensus amongst the analysts was that all the queries were atypical, and needed to be flagged for special care. Table 2: Analysts verdict (proportion of agreement) on top 120 queries tagged as atypical with our approach.
 Objective. To provide examples of atypical queries in Groupon_QL. Methodology. From the atypical queries identified in  X 6.3, we show four of each of the three types.
 Results. Twelve examples results are shown in Table. 1. Specifi-cally, queries of type described in  X 4 . 1 ,  X 4 . 2 ,  X 4 . 3 are color coded orange, green, and blue, respectively.
 Discussion. In table.
In this paper, we have introduced work on the important problem of structural understanding of queries in eCommerce in terms of specificity, breadth, and ambiguity. We identified three inherent properties of query-click distributions: geometric, statistical, and topological. We studied these properties, and showed that queries that have certain combinations of these properties are atypical in certain senses. By way of example, we showed three regions of atypicality. The framework that we established is flexible, and can be adapted by search analysts for specific applications.

Our work is being used in production to improve relevance of search results at Groupon. We would like to bring research ques-tions from eCommerce retrieval to the attention of the broader re-trieval community, and this work is a starting step in that direction.
This work is dedicated to Shiva Kashid (d. July 1660) for his sacrifice in enabling Shivaji to escape from the siege of Panhala.
