 In this paper, we study the problem of personalized restau-rant recommendations. Specifically, we develop a probabilis-tic factor analysis framework, named RMSQ-MF, which has the ability in exploiting multi-source information, such as the users X  task, their friends X  preferences, and human mobil-ity patterns, for personalized restaurant recommendations. The rationale of this work is motivated by two observations. First, people X  X  preferences can be affected by their friends. Second, human mobility patterns can reflect the popularity of restaurants to a certain degree. Finally, empirical studies on real-world data demonstrate that the proposed method outperforms benchmark methods with a significant margin. H.3.3 [ Information Search and Retrieval ]: Information filtering Restaurant Recommendation, Matrix Factorization, Bayesi-an models, Mobile Computing
Recent years have witnessed a rapid development on resta-urant recommendation and advertisements. With the emer-gence of social media and mobility applications, a more com-prehensive and effective restaurant recommendation strat-egy provides the opportunity to offer convenience to cus-tomers as well as to improve profits for restaurants. The largest social media of restaurant, Yelp, 1 have provided a http://www.yelp.com set of benchmark 5-point rating for restaurants in US, ex-pressing the extent of the customers X  favors on each restau-rant. Previous work [3] exploited the multi-aspect ratings of restaurant to uncover the user preference. However, without considering the social factor and mobility factor, the recom-mendation accuracy is not high enough and need further improvement.

Indeed, traditional recommender systems usually assume that the user and the item data are independent and iden-tically distributed, which ignores the interrelationships a-mong items. As users X  preferences are not actually binary decisions and have a certain granularity, manually specify-ing personal preferences is obstructive and usually bring a biased recommendation to users. To the best of our knowl-edge, limited efforts have been made for understanding cus-tomers X  preferences for restaurants. Indeed, the tradition personalized ranking targets at building ranking models to disclose the user interests from profiles of rating event, such as user-dependent features, item-dependent features, and shared features. Also, filtering based methods can be divid-ed into two categories: collaborative filtering and content-based filtering. Collaborative filtering recommends items to the users whose tastes are similar whereas content-based fil-tering recommends items similar to those the user has liked in the past. Recently, matrix factorization models in col-laborative filtering become more and more popular. Matrix factorization assumes users X  preferences can be generated by user latent factors and item latent factor in a latent space.
However, restaurants interact with people through daily dining. There are several unique characteristics of restauran-t review systems, which make traditional matrix factoriza-tion techniques difficult to be adapted for restaurant recom-mendation. In fact, the decision process of a user choosing a restaurant is more complicated because of so many influ-ence factors: 1) users tend to check around several centers, where the check-in locations follow Gaussian distribution at each center for a typical user X  X  rating behavior. Second, users can be easily influenced by the friends they trust, and prefer their friends X  recommendations. 2) two restaurants with similar or the same semantic topics can have differ-ent popularities if they are located in different regions. 3) popularity affects purchase behaviors. The probability of a user choosing a restaurant is partly affected by the traffic conditions around the restaurant. 4) the users have dynam-ic mobility behaviors, which impose the challenges on the modeling of restaurant decision. While there are some stud-ies on restaurant recommendations [3, 2], it is necessary to build an integrated analysis of the joint effect of the factors mentioned above. Intuitively, if a flexible method is utilized to collect more information, then better performance may be achieve. Therefore, we need a model that jointly encodes the user ratings, social factors, region topic and mobility fac-tors into the user decision process to learn user preferences for effective recommendation recommendations.

In this paper, a Bayesian graphical model taking account of both collaborative filtering latent factors, the social factor and mobility factor is proposed to learn the user preferences. We carried out the experiments to show the efficiency and effectiveness of the proposed approach with real world data evaluations.
Content-based approaches and collaborative filtering (CF) approaches have been the prevailing recommendation strate-gies. Content-based algorithms are based on a description of the item and profile of the user X  X  preference, which try to recommend items according to a user X  X  historical prefer-ence. CF algorithms assume that people X  X  behavior is af-fected by someone with similar preferences, and user X  X  rat-ings are adjusted by his neighbors X  ratings or recommenda-tion. CF approaches can be categorized into two classes: memory-based CF and model-based CF. Memory-based CF algorithms first search for neighbors who have similar rating histories to the target user. Then the target user X  X  rating histories can be predicted according to his neighbors X  rat-ings. Model-based CF algorithms use various models and machine learning techniques such as clustering algorithms or Bayesian networks to discover latent factors that account for the observed ratings. A particular type of CF algorithm uses matrix factorization, a low-rank matrix approximation technique [4].

In contrast, restaurant recommender systems can also be developed in terms of users X  past preferences via matrix fac-torization (MF), such as SVD++ [8], PMF [6], NMF [1]. One drawback of MF is the so-called ramp-up problem, in which MF performs poorly when the recommender system is not initialized with a sufficient number of ratings. There-fore, more studies such as BiasedMF [8] and SocialMF [5] incorporated side and prior information into latent factor models by exploring users X  and items X  observable features. The work [7] studied on restaurant recommendation relied on knowledge about users and restaurants to generate rec-ommendations. However, previous studies in restaurant rec-ommendation still have several limitations: they lack of in-tegrated modeling of the joint influence of personalization in user ratings, social factors, geographic interrelationship between users and restaurants, bias effect and profile simi-larity.
The problem of restaurant recommendation is to recom-mend restaurant to a user based on ratings and other side information (e.g.,user profile, social factor and mobility fac-tor information) collected from a web site. Let U = { u 1  X  X  X  ,u u ,  X  X  X  ,u p } be a set of users, where each user has a user profile (e.g.location, yelping time). Let V = { v 1 ,v 2  X  X  X  ,v q } be a set of restaurants, where each restaurant has a location l i = { lon i ,lat i } in terms of longitude and latitude, and observable restaurant-dependent features (e.g.business hours, cuisine categories, etc.) which describe the restau-rant features. We denote the rating as R ui for the pair of user u and restaurant i . We also have social influence weight between two friends that is based on both of their social connections and similarity of their visiting activities. S rameter ranging within [0,1], and  X  ( u ) and A u denote the friend set and visiting restaurants set of user u , respectively. Also, we refer u as user and i as restaurant in the following unless otherwise specified.
Figure 1 shows the decision process of user u to choose restaurant i in a generative way. RSMQ-MF model fuses personal interest in restaurants( Q ), personal interest in the area around restaurants( M ) and social influence( S ). The main contribution of the approach is that we fuse the infor-mation of the region around the restaurants and use the taxi drop-off as the popularity of the region. Here, we firstly infer the proposed personalized recommendation model to predict users X  ratings. And then, we show the training method of our approach. For the user and restaurant latent feature on Figure 1: The graphical representation of the pro-posed RSMQ-MF model. the personal interest, we have the conditional distribution according to: where N (  X  |  X ,  X ) is the gaussian distribution with mean  X  and variance  X . I R u,i is the indicator function which is equal to 1 if user u has rated restaurant i and equal to 0 otherwise. Note that the condition distribution based on the users X  ratings is similar with the conditional probability based on personal latent interest:
Given the latent features on the topic interest of his friend-s, for the user latent feature based on interest topic, we have the conditional distributions as follows: Here, f is a friend of user u . As mentioned above, there are three main aspects influencing personalized recommen-dation in our model: 1) social influence S u,f , which means you would trust your friends; 2) interest topic M u,f , which means your region interest topic is similar with your friends X , which is probability affected by the taxi drop-off information (see in the Experiment section); 3) personal interest Q u,i which means the effect on the restaurants you are interested based on user and restaurant profiles. Thus, by combining the social influence S , interest similarity M of the friends and user personal interest Q with the observed ratings R , the proposed RSMQ-MF model decreases the training error. According to the basic MF model, through bayesian infer-ence, the posterior probability of our model is as follows: p ( U,V | R,S,M,Q, X  )  X  p ( R | U,V,  X ) p ( U | S,  X ) p ( U | M,  X ) p ( Q | U,V,  X ) p ( U |  X ) p ( V |  X ) = Y
Y
Y
Y
Keeping the prior variance and observation noise fixed, we have the loss function:
L ( R,U,V,S,M,Q ) = 1 k V k 2 F ) +  X  +  X  +  X 
Here,  X  R u,i is the predicted rating. k . k 2 F denotes Frobenius norm.  X  is regularization weight, and  X  ,  X  and  X  are itera-tion step size. In Eq.(5), the idea of social influence is the second term, which means that user personal interest would be similar with the friends latent interest. The third term is enforced as the similarity of the interest topic. And the factor of user personal interest is the last term which means that users would be interested with several restaurant. To obtain a local minimum of the objective function given by Eq.(5), we perform gradient descent in U u and V i : Figure 2: A demonstration of restaurants and taxis drop-off points in the dataset. where I R u,i is the indicator function that is equal to 1 if user u has rated restaurant i , and 0 otherwise. The initial values of U and V are sampled from the Gaussian distribution with zero mean. The latent feature matrix learning was empiri-cally affected. We adjust the step size based on the previous values of the two latent feature matrix U and V in each iteration.
Data set. We crawled the data from yelp.com site cov-ering Manhattan district. We collect a complete snapshot, including users X  profile, user X  X  rating, users X  friend list, and restaurants X  profile, from Yelp. The total number of restau-rant is 7,115. In order to easy to do experiments to validate the performance of our model. We positively pick the restau-rant to limit other type of potential impact. And we select 1,000 restaurants using a greedy algorithm with max dis-tance, which keep we don X  X  have nearest restaurants. The detailed statistics of the final dataset are shown in Table 1. Density is the percentage of entries in the user-restaurant matrix that have ratings.

Moreover, to measure the popularity in Manhattan, we adopt the taxi drop-off information from New York City taxi Data 2 which was collected from Jan. 2013 to Jun. 2013. Set-ting lunch time period as 11:00-13:30, and dinner time peri-od as 17:30-20:00 in Manhattan. Then, match the restaurant location and taxi customer drop-off longitude and latitude distance, select those restaurant recently and the distance between two is less than 10 meters. Get 21,684,273 taxi drop-off records related to the 1000 restaurants. Figure 2 https://uofi.box.com/NYCtaxidata Figure 3: The average MAE and RMSE values at different latent dimensions k . is a map illustration of restaurants and taxis in Manhattan Area. Each black point representing one restaurant in Fig-ure 2(a) or one taxi drop-off location in Figure 2(b). This map shows there are lots of taxi drop-off behaviors around the restaurant of Manhattan.

Evaluation Metrics. We use the following two metrics for evaluation. (1) the Mean Absolute Error,
MAE = P u,i | r ui  X   X  r ui | /N , (2) the Root Mean Square Error,
RMSE = q P u,i ( r ui  X   X  r ui ) 2 /N , where r ui and  X  r ui denote the observed rating and the pre-dicted rating, and N denotes the total number of the tested data. The smaller the value of MAE or RMSE, the more precise a recommendation.
To show the effectiveness of the proposed RSMQ-MF mod-el, we compare the performances of our model against the following baseline algorithms: 1)Nonnegative Matrix Fac-torization (NMF) [1]. 2)SVD++ [8], which directly incorpo-rates implicit feedback into the singular value decomposition (SVD) model. 3)BiasedMF [8], which is a multifaceted col-laborative filtering model. 4)Probabilistic Matrix Factoriza-tion (PMF)[6]. 5)SocialMF [5], which is a matrix factoriza-tion technique with trust propagation for recommendation in social networks. We randomly selected 80% of data from our dataset as training data and different number of latent factors ( k =5,10,15,50) to test all the methods. We set learn-ing rate as 0.01, regularization  X  U = 0 . 01 and  X  V = 0 . 05 for all methods. For our approach, we set  X  = 20,  X  = 20 ,  X  = 20.

From the Figure 3(a), it is clear that our approach out-performs the other methods on different number of latent factors ( k ). The MAE values of our approach (with average 0.79) are lower than the MAE values of SVD++, BiasedMF, NMF, SocialMF or PMF (with average 1.03). In addition, in all the baselines, BiasedMF and SVD++ works better than NMF, SocialMF and PMF in all k value settings. PMF gives comparatively low performance with 2.219 MAE( k =5), since the model is a pure probabilistic factor model and does not take advantage of social or mobility factors.

Figure 3(b) shows the RMSE comparisons: our approach outperforms all the completing models. For example, the average RMSE of five baselines is about 1.28 whereas the RMSE of our method is only 0.98. SocialMF works better than NMF and PMF because of its aggregation of user so-cial links. The present method not only consider social fac-tors, but also incorporates taxi drop-off information, which makes our approach performing more effective recommen-dation method.
In this paper, in order to provide more accurate and effi-cient restaurant recommendation, we propose a novel fused matrix factorization framework to take into account multi-source information. To incorporate the side information, we explored the bias effect which was regressed from user pro-files and restaurant characteristics, as well as exploited the similarity from social factors and mobility factors between users and restaurants. Our model not only discovered the so-cial influence of user by flexibly collecting information from user X  X  social network, but also incorporates the taxi drop-off information into the user preference indices. Experimental results on real-world data shows the proposed RSMQ-MF model can achieve significantly better performance than oth-er state-of-the-art methods.
This work was supported in part by grants from the Na-tional Natural Science Foundation of China under Grant No.61170096,71331005.The work was also partially support-ed by grants from Shanghai Foundation for Developmen-t of Science and Technology under Grant No.13dz2260200 13511504300, 14511107302. [1] D.D.Lee and H. Seung. Algorithms for non-negative [2] F.Yanjie, L.Bin, G.Yong, and X.Hui. User preference [3] H.H.Lee and G.W.Teng. Incorporating multi-criteria [4] I.Markovsky. Low-Rank Approximation: Algorithms, [5] M.Jamali and M.Ester. A matrix factorization [6] R.Salakhutdinov and A.Mnih. Probabilistic matrix [7] S.Trewin. Knowledge-based recommender systems. [8] Y.Koren. Factorization meets the neighborhood: a
