 Department of Engineering Science blaschko@robots.ox.ac.uk In this work we study the use of resting state activity for the semi-supervised analysis of human fMRI studies. We wish to use resting state activity as an additional source of unlabeled data in a semi-supervised regression setting. We analyze the weights of a trained regressor to infer brain regions that are implicated in visual processing tasks. As the recording of human fMRI data is constrained by limits on the time a subject can safely remain in a scanner, and by the high demand for high-resolution scanning facilities, it is important to fully utilize available data. One source of such additional data is resting state activity, the brain activation that arises in the absence of any task. This data has been the subject of many studies in recent years, and has the important advantage of not being biased by a specific task. We show in this work that the marginal distribution of resting state activity is suitable to improve regression performance when employed for semi-supervised learning. In neuroscience there has been a recent surge of interest in analyzing brain activity in more natural, complex settings, e.g. with volunteers viewing movies, in order to gain insight in brain processes and connectivity underlying more natural processing. The problem has been approached from dif-ferent routes: linear regression was used to identify brain areas correlating with particular labels in the movie [2], the perceived content was inferred based on brain activity [23], data-driven methods were used to subdivide the brain into units with distinct response profiles [1], and correlation across subjects was used to infer stimulus-driven brain processes at different timescales [24]. Several pat-tern recognition techniques have previously been applied to fMRI data of brains, including support vector machines and Fisher linear discriminant analysis [26, 27, 29]. In [22], kernel canonical corre-lation analysis (KCCA) was applied to fMRI data from human subjects. We have recently applied a semi-supervised extension of KCCA to human fMRI data [32] where the unlabeled data source was given by the subjects viewing a movie for which the labels were not known. In this work, we ex-plore the more realistic setting in which unlabeled data are available as a side product of other fMRI studies. This enables the more efficient use of available data, and obviates the necessity to waste scanner time and human labeling effort in order to produce sufficiently large data sets to achieve satisfactory results.
 In Section 2 we discuss the generation and significance of resting state activity. We then discuss the statistical assumptions implicit in semi-supervised learning in Section 3. We present the exper-imental setup for data acquisition in Section 4, and discuss the semi-supervised regression model in Section 5. In Section 6, we show empirically that resting state activity is an effective source of unlabeled data for semi-supervised learning. Resting state activity has attracted the attention of neuroscientists now for over a decade [8, 20]. It is defined as brain activation that arises in the absence of any task, and it is usually measured in awake subjects during prolonged fMRI scanning sessions, where no other instructions are given than to close the eyes and to do nothing. The basic idea is that spontaneous fluctuations of neural activity in the brain may reveal some fundamental characteristics of brain function. This may include functional aspects, but also structural ones.
 For example, certain networks of areas have been shown to be more active at rest than during the execution of a task, leading to the hypothesis that these areas may be involved in maintaining the de-fault state of the brain, performing mental house-keeping functions, such as monitoring own bodily states or the self [9, 30, 31], or being involved in intrinsic as opposed to extrinsic (i.e. stimulus-driven) tasks [17]. Additionally, spontaneous fluctuations of brain activity in particular brain re-gions have been shown to be directly correlated with metabolic activity and also with behavioural task performance, thus providing evidence that these fluctuations do not merely reflect artefacts of vascular perfusion, heart rate or breathing [9, 7]. Instead, evidence suggests that spontaneous ac-tivity changes reflect to some extent neural activity that may account for trial-to-trial variability of human behaviour [14, 28].
 Resting state activity however also has structural implications, in that temporal correlations between spatially separate regions (functional connectivity) may be indicative of underlying neural commu-nication between them, which in turn may be mediated by anatomical connections. Several studies have shown that homologue regions of the hemispheres (e.g. left and right motor cortex, Wernickes regions, etc) have high temporal correlations during rest [8, 3]. Also networks known to be anatom-ically connected, such as those belonging to the language network (Brocas area, Wernickes area, Geschwinds territory) within a given hemisphere show strong correlations during resting state, in-dicating that spontaneous activity (or activity driven by mental imagery, etc) in one region may affect others that are directly connected with it [21, 3]. Some recent studies also attempt to reveal that resting state connectivity directly relates to structural activity as revealed using diffusion tensor imaging [33, 19]. Finally, alterations in resting state activity patterns have recently been shown to be diagnostic for clinical conditions such as neuropsychiatric disorders [18], and have been shown to alter with increasing age [34].
 However, the analysis of resting state activity poses a challenge, as it is not stimulus-driven, and is therefore difficult to analyze or to reveal using hypothesis-driven analysis methods. One common approach has been to reveal functional networks and their connectivity by measuring the temporal correlations of a seed region with the remaining voxels of the brain [8, 21, 3, 33, 19]. Another approach has been to apply data-driven spatio-temporal clustering methods such as independent component analysis (ICA) to reveal distinct functional areas or networks at rest [35, 1]. The over-whelming evidence of these studies shows that groups of voxels, but also widespread networks of cortical areas that are co-engaged during task performances are also consistently co-activated during rest [35, 1, 12].
 We provide an alternative, computationally driven approach to assess whether and to which extent externally driven functional networks coincide with spontaneous fluctuations during rest. We stim-ulated volunteers using natural movies, and measured resting state activity during the same session in separate runs that each lasted 20 min. Prior work has shown that natural movie viewing leads not only to wide-spread cortical activation, but also to a higher functional separation of distinct networks and areas compared to that obtained using traditional stimulation with controlled stimuli [23, 1, 17]. This is most likely so because distinct cortical regions responded each to distinct features occurring in the movie, thus revealing the functional division of labor in cortex [2, 4, 23].
 In subsequent sections we show that semi-supervised learning algorithms improve when resting state data are added to aide feature-regression of movie-viewing data. This improvement indicates that a similar cortical structure underlies resting state data as that underlying movie-viewing data. These results thus fall in line with prior work demonstrating consistency of resting state networks across subjects [35, 12], and reveal that feature-driven activity during natural viewing induces a similar functional clustering as that occurring during rest. Importantly however, this approach may also be of other methodological interest, in that data obtained at rest may actually be used to augment the performance of feature-driven regression of stimulus-driven data. Semi-supervised learning makes use of a combination of labeled and unlabeled training points in order to better learn a mapping from an input space, X (in this case voxels recorded from fMRI), to an output space, Y (variables recording viewing conditions). Discriminative models typically attempt to infer a mapping f : X  X  Y based on properties the conditional distribution p ( y | x ) . In order to incorporate training data in X for which no correspondence is known to Y , additional assumptions must be made about the properties of the joint distribution over X  X Y . This often gives semi-supervised learning more of a generative flavor in that we assume some properties of the joint distribution in order to better make use of the marginal distribution p ( x ) [11].
 There are several closely related assumptions employed in the development of semi-supervised learning algorithms, but we focus here on the manifold assumption [6]. We assume that our high dimensional data lie on a low dimensional manifold, and that changes in p ( y | x ) vary slowly as mea-sured by distances within the manifold. The additional unlabeled data in X allow us to better model the manifold on which the data lie.
 In the case of fMRI acquired data, we expect that brain activity follow certain common patterns of activation. Furthermore, transitions between these patterns of activation will not be discontinuous. We can therefore be fairly confident in the assumption that the manifold assumption holds in prin-ciple. Of crucial importance, however, is that the distribution of the unlabeled samples not result in a degenerate marginal distribution with respect to the discriminative task at hand, that is to say that p ( y | x ) be slowly varying as measured by distances measured within the manifold estimated from labeled and unlabeled samples from X .
 Theoretical accounts of semi-supervised learning frequently assume that all samples from X be drawn i.i.d. In practice, in a data poor domain, we may have to resort to a source of unlabeled data that is derived by a (slightly) different process than that of the labeled samples. As resting state data is a representative byproduct of the experimental design of fMRI studies, we explore the empirical performance of its employment as a source of unlabeled data. This gives us vital insight into whether the distribution of brain states is sufficiently similar to that of subjects who are performing a visual processing task, and suggests a general and powerful improvement to the design of fMRI studies by making use of this ready source of unlabeled information. A Siemens 3TTIM scanner was used to acquire the fMRI data of 5 human volunteers and consisted of 350 time slices of 3-dimensional fMRI brain volumes. Time-slices were separated by 3.2 s (TR), each with a spatial resolution of 46 slices (2.6 mm width, 0.4 mm gap) with 64x64 pixels of 3x3 mm, resulting in a spatial resolution of 3x3x3 mm. Each subject watched 2 movies of 18.5 min length, wherein one movie had labels indicating the continuous content of the movie (i.e. degree of visual contrast, or the degree to which a face was present, etc.) and the other remained unlabeled. The subjects additionally were recorded during a resting state of the same length of time. The imaging data were pre-processed using standard procedures using the Statistical Parametric Mapping (SPM) toolbox before analysis [15]. Included was a slice-time correction to compensate for acquisition delays between slices, a spatial realignment to correct for small head-movements, a spatial normal-ization to the SPM standard brain space (near MNI), and spatial smoothing using a Gaussian filter of 12 mm full width at half maximum (FWHM). Subsequently, images were skull-and-eye stripped and the mean of each time-slice was set to the same value (global scaling). A temporal high-pass filter with a cut-off of 512 s was applied, as well as a low-pass filter with the temporal properties of the hemodynamic response function (hrf), in order to reduce temporal acquisition noise.
 For the movie with corresponding labels, the label time-series were obtained using two separate methods. First by using computer frame-by-frame analysis of the movie [4], and second using subjective ratings averaged across an independent set of five human observers [1]. The computer-derived labels indicated luminance change over time (temporal contrast), visual motion energy (i.e. the fraction of temporal contrast that can be explained by motion in the movie). The human-derived labels indicated the intensity of subjectively experienced color, and the degree to which faces and human bodies were present in the movie. In prior studies, each of these labels had been shown to correlate with brain activity in particular and distinct sets of areas specialized to process the particular label in question [1, 4]. We have applied a semi-supervised Laplacian regularized ridge regression framework to learn our discriminant function. We assume multivariate data x i  X  X with associated labels y i  X  R , for i = 1 , . . . , n , although the setting is directly extensible to arbitrary input and output domains [10]. Ridge regression is classically formulated as where x and y are assumed to be zero mean [25]. This is equivalent to maximizing (Tikhonov regularized) correlation between y and the projection of x onto w [16]. In order to extend this to the semi-supervised setting [11], we assume the manifold assumption and employ Laplacian regularization [37, 38, 5, 36, 6]. We assume that we have p x additional unlabeled training samples and use the variable m x = n + p x for notational convenience. We denote the design matrix of labeled data as X and that of labeled and unlabeled data  X  X . We can now write our Laplacian regularized objective function as where L is an empirical graph Laplacian [6].
 The two regularization parameters,  X  and  X  , are set using a model selection step. We have employed a variant of the model selection used in [32], which employs a grid search to maximize the difference in objective functions between a randomized permutation of the correspondences between x and y and the unpermuted data. We have used a symmetric normalized graph Laplacian where the weights are given by a Gaussian function with the bandwidth set to the median distance between training data points where S is a similarity matrix and D is a diagonal matrix whose entries are the row sums of S . We have primarily chosen this regression model for its simplicity. Provided the manifold assump-tion holds for our source of data, and that the conditional distribution, p ( y | x ) , is slowly varying as measured by the manifold estimated from both labeled and unlabeled data, we can expect that semi-supervised Laplacian regularization will improve results across a range of loss functions and output spaces. Table 1: Mean holdout correlations for motion in the five subjects across all experiments. For a description of the experiments, see Section 5. In all cases, semi-supervision from resting state activity (Exp C) improves over regression using only fully labeled data (Exp A).
 Table 2: Mean holdout correlations for human body in the five subjects across all experiments. For a description of the experiments, see Section 5. In all cases, semi-supervision from resting state activity (Exp C) improves over regression using only fully labeled data (Exp A).
 As our data consist of (i) recordings from a completely labeled movie, (ii) recordings from resting state activity, and (iii) recordings from an unlabeled movie, we are able to employ several variants of semi-supervision in the above framework: In order to evaluate the performance of the regression model with different semi-supervised variants, we have performed five fold cross validation. For each fold, we measure the correlation between the projected data and its associated labels. We have performed these experiments across five different subjects with three different output variables. Table 1 shows the test correlations for all subjects and experiments for the motion output variable, while Table 2 shows results for the human body variable, and Table 3 for the language variable. Wilcoxon signed-rank tests have shown significant Table 3: Mean holdout correlations for language in the five subjects across all experiments. For a description of the experiments, see Section 5. In all cases, semi-supervision from resting state activity (Exp C) improves over regression using only fully labeled data (Exp A).
 Figure 1: Illustration of weight maps obtained for the visual motion feature in experiments A, B, and D. Transverse slices are shown through a single subjects T1-weighted structural image with superimposed weight-maps, colored in red for positive weights (left column), and colored in blue for negative weights (right column). The positive weight maps (left column) reveal the motion processing area V5/MT+, as well as posterior in the midline a part of peripheral early visual area V1 (not labelled). The negative weight maps reveal a reduction of BOLD signal in the occipital poles (the foveal representation of early visual areas V1-V3). Both results are in agreement with the findings reported in a prior study[4]. Figure 2: Illustration of weight maps for the human body feature. Weight maps (in red) are show on transverse (left) and sagittal (right) brain sections of a single subject. Activity involves the object-responsive lateral occipital cortex (LOC) extending dorsally into region responsive to human bodies, dubbed extrastriate body area (EBA) [13]. The weights in all experiments are very strong for this feature (see colorbar), and nearly no difference in the extent of activation is visible across experiments. improvement between ridge regression and semi-supervised Laplacian regularization with confi-dence &gt; 95% for all variables. We also provide a qualitative evaluation of the results in the form of a map of the significant weights onto slices shown through single subjects. Figure 1 shows the weights for the motion variable, Figure 2 for the human body variable, and Figure 3 for the language variable. One can observe several trends in Tables 1-3. First, we notice that the results for experiment A are not satisfactory. Correlations appear to be non-existent or low, and show high variation across sub-jects. We conclude that the labeled training data alone are not sufficient to learn a reliable regressor for these learning problems. The results in experiment B are mixed. For some subjects and variables performance improved, but it is not consistent. We expect that this indicates non-linearity in the data, but that the labeled data alone are not sufficient to accurately estimate the manifold. We see consis-tent improvement in experiment C over experiment A. This supports the primary hypothesis of this work  X  that the marginal distribution of resting state activity in combination of that from the visual Figure 3: Illustration of weight maps obtained for the language feature across the different exper-iments. Weight maps (in red) are superimposed on sagittal, coronal and transverse sections of a single subjects brain. The activation associated to this feature involved the superior temporal sul-cus (STS), extending anteriorly to include parts of Wernickes speech processing area, and posterior and ventrally (increasing with experiments A, B and D) object-responsive region LOC, involved in analyzing facial features (in accord with the findings in [2]). processing task allows us to robustly estimate a manifold structure that improves regression perfor-mance. The results for experiment C and D are similar, with neither data source dominating the other. As the unlabeled data for experiment D were generated specifically to match the distribution of the labeled data, we conclude that resting state activity gives a similar increase in performance to semi-supervised learning with i.i.d. data. Finally, the setup in experiment E  X  in which we use both sources of semi-supervised data  X  performs similarly on average to that in experiments C and D. We conclude that the two sources of unlabeled data may not hold complimentary data, indicating that a wholesale replacement of one source by another is an effective strategy.
 The feature-weight maps shown in Figures 1-3 were all in accord with established findings in neu-roscience, in that distinct features such as visual motion, the perception of human bodies or of language correlated with activation of distinct brain regions, such as V5+/MT+, the lateral occipital complex (LOC) and the extrastriate body area (EBA), as well as regions of the STS and Wernickes area, respectively. These findings have now been established in studies using controlled stimuli, as well as those showing movie-clips to volunteers [13, 2, 4, 23].
 Here we asked whether using semi-supervised learning methods can improve a feature-driven anal-ysis when adding data obtained in the resting state. The motivation for this stems from prior studies that suggest a functionally relevant involvement of cortical regions during rest. Data-driven analy-ses of resting state activity reveals a similar functional architecture that can also be observed during stimulus-driven activity, and which can be reproducibly found across subjects [12, 35]. In addition, also the functional connectivity between distinct regions appears to be physiologically plausible at rest [21, 8, 20], and in fact is very similar to the functional connectivity observed during viewing of movies [3]. Taken together, these findings would suggest that resting state activity may in theory be able to augment in a non-biased way datasets obtained in a functional setting. At the same time, if resting state data were indeed found to augment results of feature-driven analyses, this would form an important finding, as it would directly indicate that resting state activity indeed is similar in its nature to that induced by stimulus-driven settings. Our findings indeed appear to show such an effect, as is illustrated in Figures 1-3. For example, the activation of visual motion responsive cortex V5+/MT+ clearly increased in experiments A-C. Note that this was not only reflected in the positive weights, but also in the negative ones; in complete consistency with the findings reported in [4] even the negative involvement of foveal visual representations with increase of visual motion became amplified with the addition of resting state data. Similar findings concerned the cortical re-gions involved in the perception of language. However, this augmenting effect was not observed in all subjects for all features Figure 2 for example shows a subject in whom the human body feature obtained very high weights already in the most basic analysis, and no augmentation was apparent in the weight maps for the more complex analyses, perhaps reflecting a saturation effect. Since the resting state is not well-defined, it may also be that particular internal states, sleepiness, etc. would not guarantee augmenting in all datasets.
 All in all however our results show that adding resting state data can indeed augment findings ob-tained in stimulus-inducing settings. This method may therefore be useful for the increasing number of imaging centres acquiring resting state data for completely different purposes, which may then be used to augment functional data, entirely free of cost in terms of scan time. An even more promising prospect however is that also the baseline or rest condition within stimulus-driven sessions may be used to augment the results obtained in the stimulus conditions. This may be especially valuable, since almost all imaging sessions contain baseline conditions, that are often not used for further analysis, but take up considerable amount of scan time.
 Apart from the above, application-orientated considerations, our findings also provide new evidence that brain-states during rest which are difficult to characterize indeed resemble those during ex-posure to complex, natural stimulation. Our approach is therefore an extension of prior attempts to characterize the complex, rich, yet difficult to characterize brain activation during the absence of externally driven stimulation. In this work, we have proposed the use of resting state data as a source for the unlabeled component of semi-supervised learning for fMRI studies. Experimental results show that one of the primary assumptions of semi-supervised learning, the manifold assumption, holds well for this data, and that the marginal distribution of unlabeled resting state data is observed to augment that of labeled data to consistently improve regression performance. Semi-supervised Laplacian regularization is a widely applicable regularization technique that can be added to many kinds of machine learning algorithms. As we have shown that the basic assumptions of semi-supervised learning hold for this kind of data, we expect that this approach would work on these other discriminant/regression methods as well, including kernel logistic regression, support vector machines, and kernel canonical correlation analysis.
 As data acquisition and the manual labeling of stimulus data are expensive components of brain imaging, the benefits of exploiting additional unlabeled data are clear. Resting state data is a promis-ing source as there are no task specific biases introduced. In future work we intend to further study the properties of the distribution of resting state activity. We also intend to pursue cross subject studies. If brain activity is consistent across subjects for the specific task measured by a study, a large cross subject sample of resting state data may be employed to improve results.
 Acknowledgments The first author is supported by the Royal Academy of Engineering through a Newton International Fellowship. The second author is supported by an ACM-W scholarship.

