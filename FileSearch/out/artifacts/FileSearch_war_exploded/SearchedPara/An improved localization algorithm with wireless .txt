 1. Introduction
Relapsed psychiatric patients are placed in intensive therapy wards and are treated with medication, psychotherapy, and behavior therapy. Routine medical diagnoses and assessments are also conducted to stabilize and monitor the patients X  condi-tions and ensure proper medical care. One of the most important vital signs to be assessed is the patient X  X  heartbeat. In general, several conditions cause abnormal heartbeat in psychiatric patients, including anxiety, medication, and side effects such as constipation. For example, over-excitability or pharmaceutical side effects may cause patients X  heart rates to fluctuate higher than 120 bpm or lower than 60 bpm. Patients with bipolar or antisocial personality disorders are more prone to having high heart rates during periods of agitation. Therefore, psychiatric patients in the psychiatric wards often require continuous mon-itoring for long-term assessment and the prevention of dangerous behavior ( Leon, 2011 ).

Generally, psychiatric wards are equipped with CCTV to help nurses monitor patient activity. Psychiatric patients are prohibited from entering prohibited zones, such as nursing sta-tions, entrance areas, and balconies. Male patients are forbidden from entering female restrooms and vice versa. Long stays inside restrooms may be associated with suicide by hanging or the risk of falling injuries. If any accident occurs to a patient, nurses can monitor the patient X  X  health status and locate the patient in real time.

Hospitals hire additional staff to monitor patients X  vital signs, keep patients out of danger, and ensure that patients do not leave the hospital without notice. Research has also shown psychiatric patients X  abnormal behaviors, for example a patient constantly repeating the same activity or making exaggerated gestures, can be observed to aid diagnosis. These abnormal behaviors can be more apparent when the mental patient relapses. Therefore, the accuracy of mental illness diagnosis depends on observation of patients X  behavior. Data recording during the monitoring phase can thus be used in behavior-and psychiatry-oriented research to help identify patients X  behavioral patterns and to provide an objective standard of evaluation of treatment and the effective-ness thereof.

ZigBee, a personal area network that receives and emits radio frequencies, is based on the IEEE 802 standard. Its low cost and low power consumption makes ZigBee a popular choice for wireless sensor networks in healthcare environments such as hospitals and homes. Healthcare environments can obtain accu-rate diagnosis by establishing a real-time analysis and tracking system that monitors patients X  behaviors, oversees their status, foresees the possibility of relapse, and saves on manpower. To the best of our knowledge, no wireless patient heartbeat monitoring system with accurate localization technology has ever been used in psychiatric wards. Therefore, this paper aims to develop a wireless monitoring system for patient safety in psychiatric wards.

This research uses relative radio signal strength indication (RSSI) within a ZigBee-based sensor network to locate patients. Heartbeat signals can be collected to prevent dangerous behavior.
This system can ease nurses X  workloads, help locate patients, and monitor patient X  X  heartbeats. The effectiveness of the proposed system is examined in later part of this research. Section 2 discusses healthcare-related literature, the concepts of location algorithm, and cluster analysis. Section 3 illustrates the proposed system and its structural design. Section 4 details a demonstration experiment and examines the system design. Finally, Section 5 includes the conclusion and highlights on follow-up research. 2. Literature review
Information about patients X  location and their vital signs, such as their heartbeats, can be stored in a database that nurses can use to check or retrieve relevant statistics ( Bromley and Brekke, 2010 ; Makela et al., 2006 ). Aside from adopting standard mea-sures for patient safety management, many hospitals have begun applying technologies such as radio frequency identification (RFID), wireless local area network (WLAN), Bluetooth, and ZigBee, to establish wireless sensor networks ( Fariborzi et al., 2008 ; Lee,
RFID has attracted considerable attention in recent years for its low cost, general availability, and location sensing functionality ( Daqiang et al., 2011 ). Remote monitoring healthcare systems evaluate the changes in a patient X  X  health and notify the patient about the measures to be followed, thereby improving the patient X  X  quality of life ( Tachakra et al., 2003 ). Two common functions of remote monitor healthcare systems are collection of bio-signals, such as heartbeats and blood pressure ( Budinger, 2003 ; Du et al., 2011; Gatzoulis and Iakovidis, 2007 ), and main-taining a long-term record of the patient X  X  daily activities and behavioral patterns ( Barro et al., 2002 ; Depledge and Andersen, 1990 ; Favela et al., 2006 ; Sahandi et al.; Tachakra et al., 2003 ).
Both functions are important for conducting research on preventive medicine based on early diagnosis of abnormal health conditions in or takes incorrect medication, a remote monitoring system tracks andimmediatelypassesontherelevantinformation( Ho et al., 2005 ). Most current research focuses on collecting bio-signal data.
A few studies have also discussed the importance of location in determining a patient X  X  health ( Li et al., 2004 ). 2.1. Healthcare system application research
Studies on the application of wireless sensor networks in healthcare environments have recently increased. These studies show that an intelligent healthcare system with a wireless sensor network could establish a healthcare environment that can con-tinuously monitor a patient X  X  health condition.

In general, accurate localization requires an algorithm that uses received signals from wireless devices. Localization algo-rithms can be divided into three major categories: triangulation ( Savvides et al., 2001 ), scene analysis ( Sanhae et al., 2009 ), and proximity ( Hightower and Borriello, 2001 ). Most algorithms have reliability issues because they rely on strongly variance radio signal strength indication (RSSI) measurement ( Bekkali et al., 2007 ; Want et al., 1992 ). Accordingly, several advanced localiza-tion algorithms that use the reference tags concept have been proposed recently ( Hightower et al., 2000 ; Wang et al., 2007 ). 2.2. Location identification based on dynamic active RFID calibration (LANDMARC) method The use of reference tags is an essential concept in the LAND-
MARC location algorithm. Under this concept, various relative locations are applied to different kinds of environments to identify a patient X  X  location ( Ni et al., 2003 ). This algorithm also uses RFID readers and tags to measure relative RSSI values. The best reference point is estimated using the K-nearest neighbor-hood (KNN) ( Kyuwon and Sung Ho, 2010 ). The location of any unknown item is identified by calculating the distances between advantages of using LANDMARC location algorithm include: usage of cheaper tags to replace expensive readers, higher compatibility with varied environment, and higher flexibility that speeds up the collection of information. Although the LANDMARC system pro-vides an effective measure of a patient X  X  location, it has certain limitations, such as that fact that too many reference tags might interfere with one another. Such system limitations may lead to practical difficulties.

By calculating the distance between reference points obtained, the location of any unknown item is identified. The three major advantages of using LANDMARC location algorithm include: usage of cheaper tags to replace expensive readers, higher compatibility of the system to a varied environment, and higher flexibility to obtain information more promptly. Although the LANDMARC system provides an effective measure of a patient X  X  location, it has certain limitations, such as too many reference tags might interfere with each other. Such limitations in the system may lead to difficulties while applying the equipment.
 However, a few other studies support the use of the LAND-
MARC method to overcome limitations. In these studies, one of the reference tags was assigned as a tracking tag to measure the set of all the tags. This method was applied to all the reference tags. The new coordinates were derived after calculating the sum of the errors. The same method was then repeatedly applied to the new coordinates until the error reached a minimum value.
This improved method uses the repeated calculation technique to estimate tags and follows a more precise approach than the
LANDMARC location algorithm. 2.3. Virtual reference elimination (VIRE) method VIRE ( Zhao et al., 2006 ) is a method proposed to improve the
LANDMARC system. Because LANDMARC uses active targets, many of these targets are required to cover an environment with a greater area. However, increasing the number of targets pro-duces mutual signal interference. Furthermore, active tags are rather expensive. Virtual tags can lower installation costs and increase the number of reference tags without creating mutual interference. Virtual tags separate the partition between actual reference tags into m virtual blocks, each with four virtual tags.
A threshold value is then set from the proximity maps maintained by each reader (see Fig. 1 ). When the signal difference between a reference tag and the target tag is within the threshold, the difference is retained as a hotspot. The hotspot overlap between each map is used to select effective virtual tags, which are then weighted as a group to deduce the target object X  X  location.
This algorithm dramatically decreases installation costs and creates more precise calculations than LANDMARC.

The VIRE method uses linear interpolation to calculate the RSSI value of virtual tags. However, linear interpolation does not indicate the precise value in complex situations because the distance between the RFID tags and readers, and the RSSI value, has a polynomial relation. Therefore, implementing polynomial interpo-lation to this method would provide a more accurate location-based calculation. After analyzing the drawbacks of VIRE, a new localiza-tion algorithm is proposed where the existing result is used to calculate the new tags X  RSSI when the grid has been expanded, in order to make the actual computing more convenient and to reduce errors ( Xin et al., 2010 ). 2.4. Ward X  X  method
Ward X  X  method is a type of hierarchical clustering also known as the minimum variance method (Ward, 1963). Ward X  X  method performs clustering by viewing each individual as a cluster, and then combining clusters sequentially ( Toronen, 2004 ). The order in which clusters are combined is determined by the size of the total variance within the clusters following clustering. Suppose that n samples with m variables are divided into T types and t X ikt represents the k th variable for the i th sample in the t th type. k represents the number of samples in the t th sample, and X The square deviation of the sample in the t th type is as shown below: S  X 
Let the n th sample form a type. At this time S  X  X  0. The two types are combined into a type, causing S to increase the least. At this time, the number of types is ( n -2). The two types are then combined again to cause S to increase minimally. This process is repeated until all samples are combined into one type. 3. Methods 3.1. Design of bio-signal sensing on ZigBee-based platform
The design of this study consists of two major parts. The first part has to do with the sensing element, and second part involves the ZigBee transmitter. Practical and convenient applications have been devised to increase the patients X  willingness to wear, and comfort while wearing the sensors. Signals transmit wirelessly between the sensing devices and the ZigBee transmitter. Using wireless signals can prevent the loss of sensing caused by patients pulling the transmission wire and removing the sensing element from their body. This wireless transmission also defines the difference between this sensor platform and other existing platforms ( Harland et al., 2003 ; Ko Keun et al., 2004 ; Oum et al., 2008 ; Watanabe et al., 2005 ).

Fig. 2 shows the functional block diagram for a heartbeat sensor. An infrared reflective sensor is used in this study. When blood density increases during heart contraction, the energy from the infrared sensor reflected back from the blood vessel decreases, leading to a change in the electrical potential of the sensor output.
After filtering out the noise, one needs only to amplify the signal to obtain the heartbeat signal better. After amplification and full-wave rectification of the sensor signal from the sensing element, the signal is sent to the ZigBee transmitter and is transmitted wirelessly through the antenna.
 The ZigBee wireless transmitter used in this experiment uses a
Texas Instruments CC2530 chip with a size of only 6 mm 6mm 1 mm, and has transmission power consumption of 24 mA and receiving power consumption of 29 mA. The small size of the transmitter, and thus the transmi ssion module, makes the latter convenient to wear. The main charac teristics of ZigBee include low power, low cost, and encryption abilities. Although the bandwidth of
ZigBee cannot be compared with those of other communication protocols, such as IEEE 802.11b and Bluetooth, ZigBee is mainly designed for low-speed applications such as temperature and humid-ity monitoring rather than video data transmission. Fig. 3 shows the design of the circuit, with each part of the modules described below. 3.2. Sensor
The first part of the module is the sensor, which is designed to sense weak heartbeat input signals. The sensing operation is based on the emission of light from the transmitter through the density of blood vessels during a heartbeat, and the reflection of this light back to the receiver. However, as a result of the inter-ference of surrounding noise, transmission and reception can only be sensed adequately over short distances. Common heartbeat sensing methods include visible li ght optical sensing, non-visible light infrared sensing, volume change sensing, non-contact capaci-tive sensing, and non-contact inductive sensing. Taking miniatur-ization and ease of wearing into account, non-visible light infra-red sensors were selected for this study. The sensor used in this study was the LTH-1550-01 photointerrupter made by the Lite-On Com-pany. This sensor has a simple cir cuit design, which has certain advantages in terms of miniaturization.
 3.3. Analog amplifiers The second module includes three-stage analog amplifiers. Each stage uses an inverter amplifier consisting of P-type and
N-type metal-oxide semiconductors ( Rzazvi, 2000 ). Using capaci-tance and resistance feedback, the amplifier can use low-pass filtering to filter out high-frequency noise and amplify sensor signals. 3.4. Full-wave rectifier circuit
The third module includes the full-wave rectifier circuit. Once transmitted from the third amplifiers, the signal is shown as a low-pass and inverted signal. Three inverters are designed to achieve the inverse effect of circuits. The output signal shows a completely square wave digital signal, which converts the original first-stage analog signal input into a last-stage digital signal.
Fig. 4 shows the waveform of the photosensor signal and the heartbeat signal output, where the x -axis represents time (s), the y -axis represents amplitude. The blue line represents the photo-sensor output signal, and the pink line represents the heartbeat signal from the circuit output. 3.5. Two-step clustering localization algorithm (TSCLA)
This study introduces a two-step localization algorithm divided into the establishment of a virtual network topology and a two-step cluster filtering mechanism. The framework for this algorithm is shown in Fig. 5 .

A. Virtual network topology: Virtual tags are used to establish a virtual network topology. Tag density in the environment is determined by virtual tag settings. Each reader can establish its own virtual network topology as a result. All tags within the topology include reference tags, target tags, and virtual tags, which are related in mutual dependence and influence. Refer-ence tags are deployed tags with known coordinates. Target tags are target objects with unknown coordinates. Virtual tags are replacements for real deployed tags used to increase the density of the sensing area and lower deployment costs. In addition to effectively reducing installation costs, this approach also enables flexible adjustment of the installation range and density in different environments.

B. Two-step cluster with signal data: Two-step of cluster analysis is performed during the filtering process. The first round utilizes the tags X  RSSI to perform clustering. Highly similar tags X 
RSSI, including those of reference and target tags, are identified by two-step cluster analysis. The RSSI of the cluster and the target object are identical or similar. This group of tags may neighbor or surround target objects. This study suggests that tag groups in the same cluster as a target object should be selected as a basis for the next round of clustering.
C. Two-step cluster with signal and coordinate data: The cluster then undergoes a second round of cluster analysis. The location information of the tags is incorporated during the second step of filtering. Together with highly similar cluster RSSI, location data can be used to determine the possible locations of the target object in case the possible region is expanded with deviated reference tags.
 strength for determining the weight of the distance between the target and reference tags in the possible region.
The next section explains the virtual network topology and the two-step cluster approach. 3.6. Virtual network topology
Virtual tags involve virtually installing additional reference tags in an environment, thereby increasing the tag density of a sensing environment, to increase accuracy and avoid the mutual interference produced by installing a greater number of real tags.
Virtual tags significantly reduce costs. This study extends the
In a sensing environment with K readers and n reference tags, each reference tag has a known coordinate R ( x i , y i ), and i  X   X  1,2, y , n. For the K readers, the signal strength of the reference tag ( R )is S R K , which can be expressed in matrix form, as shown in defined as S T K , and is expressed in Eq. (3) : S  X  2 6 6 6 6 4 S  X  S 1  X  T  X  , S 2  X  T  X  , ... S k  X  T  X   X   X  3  X 
The areas of the four actual reference tags are divided into m m areas, resulting in m 1 virtual tags between every two real tags. The number of virtual tags between real tags is (( m  X  1) as shown in Fig. 6 .
 The signal strength of the virtual tag is expressed as S V Eq. (4) yields the coordinate value of the virtual tag. X i X  s x -axis coordinate, and Y Ri is reader i X  s y -axis coordinate. a  X  X Ri  X 
The coordinates of the virtual tag are expressed as V ( a where j  X  X  1,2 y , m . The signal strength of the virtual tag at expressed in Eq. (5) . Similarly, the signal matrix of the virtual tag is as shown in Eq. (6) .
 S S  X  Therefore, each reader has its own virtual network topology. The density of the network topologies is determined by the number of virtual tags m . In this vast network topology, an effective filtering mechanism must be established to select possible neighboring tags. 3.7. Two-step cluster analysis
Two-step cluster analysis can effectively group large amounts of data based on identical or similar characteristics, thereby playing an important role in pattern identification. Based on the virtual network topology established in the previous step, the signal strength and location data of tags within the topology are related. The tags also influence each other.

Therefore, cluster analysis can be performed using tag signal patterns, replacing signal differences as the basis for filtering. The six steps of two-step cluster analysis are as follows:
Step 1 : The results of Ward X  X  clustering method determine the number of clusters C .

Step 2 : Randomly select signal values from C tags act as the center of cluster C .

Step 3 : Deploy tags to each cluster based on the shortest distance between each cluster and other tags.

Step 4 : Determines the mean of the signal values for tags within clusters to use as new centers.

Step 5 : Repeats Steps 3 and 4 until the centers of each cluster no longer changes.
 Step 6 : Output the results for cluster C .

The results of selecting clusters that include tracking tags are expressed in Eq. (7) . For example, tracking tags are present in cluster 3. Accordingly, a high degree of similarity exists between tags in the cluster and the signal strength of tracking tags S ( T ).
Real tags S 1  X  R X 1 , Y 1  X  ... S k  X  R X 1 , Y 1
Tracking tags S 1  X  T  X  ... S k  X  T  X  2 6 6 6 6 6 6 6 6 6 6 6 4 )
The clusters that include tracking tags are prepared for the second round of filtering. In this round, coordinate information is added to the clusters as a property. Two-step cluster analysis is then entered for computation. The cluster results select the largest cluster. This cluster is determined to be a possible location of the tracking tags.

S 2 6 6 6 6 6 6 6 6 6 4
The filtered clusters possess a high degree of similarity with the cluster is calculated. Eq. (9) is used to calculate signal differences between tags in the cluster and tracking tags. Those with smaller signal differences are given greater weight, based on Eq. (10) .
E
W
After calculating the weights of each tag, Eq. (11) can be used to calculate the estimated tag coordinates ( X T ,Y T ). X
T , Y T  X  X   X 
In an environment with severe multipath interference, perform-ing accurate localization based on signal differences is a difficult task ( Rappaport, 1996 ). The proposed algorithm utilizes highly correlated signal patterns and coordinates to establish a filtering mechanism, thereby reducing the impact of multipath interference. 4. System design 4.1. Experimental environment
ZigBee is a low-cost, energy-efficient system widely used in wireless sensor networks in healthcare environments, including hospitals and homes. The hardware component of the proposed system included the ZigBee CC2530 Development Kit. The experi-ment was performed at the Department of Psychiatry of Taichung
Veterans General Hospital. Fig. 7 illustrates the overall system framework. The experiment used a PC with Windows 7 Ultimate,
Intel(R) Core TM i5 CPU, 32-bit include a 3.20 GHz processor, and 1.81 GB RAM. The TSCLA is carried out using Microsoft Excel 2007. This study considered the following requirements for designing a healthcare system: 1) Wireless sensor network : The hospital environment consists of ZigBee equipment installed at a particular location with the patient wearing heartbeat sensors. These sensors deliver the patient X  X  information obtained within the sensing area to the system. 2) Tag packets : Information about the patient is stored in the form of packets. Each ZigBee packet consists of two types of data: one consists of fixed information about the patient, such as serial number, patient name, ID, and gender. The other type consists of variable information, such as the patient X  X  location (coordinates), heartbeat, and body temperature. 3) System layer : The system layer is set at the receiving end where the system receives all patient information from the sensors associated with the patients. Patient information can be divided into two parts: change of signal value and heartbeat signal. This signal value is calculated by the location algorithm module and then sent to the recording module and saved in the database. The system layers help in the prompt recording of all necessary information, which is finally displayed on-screen for the healthcare personnel.

This study makes various improvements in the current sys-tems of healthcare environments, including implementation of a comprehensive technology. The various functions of the enhanced healthcare systems include: 1) Patient identification function : In the improved system, each patient is assigned a unique ID so that the wireless sensor can easily identify the patient and his/her health records when needed. 2) Indoor location function : The patient wears a sensor that easily sends information about any changes via radio signals. These signals are calculated by applying the location algorithm to sense the patient X  X  location. 3) Bio-signal monitoring function : The patient X  X  bio-signals, such as heartbeat and body temperature, are sent to the system and saved in a database. These bio-signals help healthcare personnel diagnose the patients X  health issues and take immediate correc-tive measures.
 4) Remote monitoring function : Healthcare personnel take control of the human X  X achine interface via this function. As a result, the patient X  X  location and mental signals are displayed on-screen for easy and active monitoring. 5) Accidental event management function : The system sends the patients X  information to the database when the patients enter any danger zones. With this function, alarm messages are sent to healthcare personnel so that they can take immediate preventive measures and prevent the patients X  movement further into the danger zones.

Each patient wears a ZigBee transmitter that sends heartbeat signals to the server, and a wireless sensor capable of sensing any changes and sending signals. Antennas are placed at appropriate sensing areas. Received heartbeat signals are sent to a computer through a USB interface. The computer is used to count and analyze the heartbeats from the sensor information and to classify physiological signal i nformation is displayed on a human X  X achine interface. When a specific patient X  X  location and bio-signals change, the wireless sensor sends this information to the database. The nurses observe this information th rough a monitor set up to retrieve information from that database.

Fig. 8 shows an illustration of a heartbeat sensor wristband. All of the following event managements trigger the Mobile Alert System and the Nurses Monitor System by the Localization and Heartbeat server system. 1) Mobile Alert System : Aside from the accidental event manage-ment function, the system can be set to notify nurses with warning messages when patients linger in any danger zone for more than 15 min. 2) Localization and Heartbeat server : The indoor location function and bio-signal monitoring function can also be set to identify abnormal bio-signals when the heartbeat of a patient is 1.5 times higher or lower than the normal heartbeat count.
In such situations, the screen can display a warning message and also show the location of the patient in question. 3) Nurses Monitor System : Nurses can remotely observe patients by combining patient identification function with the remote monitoring function. 5. Result
This study applies the TSCLA to identify patients X  locations more accurately. The proposed system designed for this research was tested 50 times. The monitoring procedure was carried out for 10 min in each testing experiment, using 14 reference tags and 4 readers. The results of the experiments showed that the localiza-tion error distance using the TSCLA was approximately 1 m. The margins of error for LANDMARC, VIRE, and TSCLA are 1.87, 1.31, and 0.93, respectively. The average computation time is 2.46 s.

Fig. 9 presents a comparison of the cumulative probabilities obtained from the algorithms used in the LANDMARC method, the VIRE method, and in this research. The horizontal axis represents the error distance and the vertical axis represents the cumulative distribution function (CDF). The comparison graph implies that as the error distance decreases, CDF and location accuracy increase. Inversely, as the error distance increases, CDF and location accuracy decrease. The cumulative probabilities shown in Fig. 9 point to TSCLA as the best among three algorithms, with a location probability of 90% and an error distance of 3 m. 6. Conclusions
This paper proposed a wireless monitoring system that combines personal bio-signal and location data. This study also designed a heartbeat sensor that integrates wi th ZigBee-based wireless sensor networks. In the localization algorithm, the error distance calculated using the proposed TSCLA was approximately 1 m, the location accuracy obtained was 90% with the range of error distance reaching 3 m. This proposed system was found to perform better at locating patients accurately and promptl y compared with other suggested location algorithms.

Early diagnosis and treatment are made possible by observing and assessing patient behavior and deviations from the norm.
Behaviors commonly change prior to acute relapses, as mani-fested by a significant rise or fall in the frequency of behaviors, the intensity of actions, the duration of consciousness and activity, or the interval of actions. In future studies, our group aims to construct a clinical observation precautionary system by observing changes in patient behavior from stability through to relapse. Such a system can help patients, their families, and clinical workers to identify early symptoms, administer proper treatment, and reduce the functional and economic losses caused by acute relapses in psychiatric patients.
 Conflict of interest
The authors disclose that there is no  X  X  X onflict of interest X  X  including any financial and personal relationships with other people or organizations that could inappropriately influence (bias) their work.
 Acknowledgments Work on this paper is supported by Taichung Veterans General Hospital/Tunghai University Joint Research Program (TCVGH-T997804) and National Science Council, Republic of China, Grant no. NSC 99-2221-E-029-010.
 References
