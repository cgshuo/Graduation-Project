 To arrive at a better understanding of human brain function, functional neuroimaging traditionally studies the brain X  X  responses to controlled stimuli. Contr olled stimuli have the benefit of leading to clear and often localized response signals in fMRI as they ar e specifically designed to a ff ect only certain brain functions. The drawback of controlled stimul i is that they are a reduction of reality: one cannot be certain whether the response is due to the reductio n or due to the stimulus. Naturalistic stimuli open the possibility to avoid the question whether t he response is due to the reduction or the signal. Naturalistic stimuli, however, carry a high inf ormation content in their spatio-temporal structure that is likely to instigate complex brain states. The immediate consequence hereof is that one faces the task of isolating relevant responses amids com plex patterns.
 To reveal brain responses to naturalistic stimuli, advance d signal processing methods are required that go beyond conventional mass univariate data analysis. Univariate techniques generally lack su ffi cient power to capture the spatially distributed response o f the brain to naturalistic stimuli. Mul-tivariate pattern techniques, on the other hand, have the ca pacity to identify patterns of information when they are present across the full spatial extent of the br ain without attempting to localize func-tion. Here, we propose a multivariate pattern analysis appr oach for predicting naturalistic stimuli on the basis of fMRI data. Inverting the task from correlatin g stimuli with fMRI data to predicting stimuli from fMRI data makes it easier to evaluate brain resp onses to naturalistic stimuli and may extend the power of functional imaging substantially [1].
 Various multivariate approaches for reconstruction of bra in states directly from fMRI measurements have recently been proposed. In most of these approaches, a c lassifier is trained directly on the fMRI states on the basis of new and unknown fMRI data alone. Such ap proaches have been used to predict what percept is dominant in a binocular rivalry protocol [2] , what the orientation is of structures sub-jects are viewing [3] and what the semantic category is of obj ects [4] and words [5] subjects see on a screen. In one competition [6], participants trained patt ern analyzers on fMRI of subjects viewing two short movies as well as on the subject X  X  movie feature rat ings. Then participants employed the analyzers to predict the experience of subjects watching a t hird movie based purely on fMRI data. Very accurate predictions were reported for identifying th e presence of specific time varying movie features (e.g. faces, motion) and the observers who coded th e movies [7].
 where both the fMRI data and external stimuli are continuous . This approach di ff ers fundamentally from existing multivariate linear approaches (e.g. [8]) th at instantly fit a given model to the data within the linear framework under the assumption that both t he data and the model are discrete. Contemporary neuroimaging studies increasingly use high-resolution fMRI to accurately capture continuous brain processes, frequently instigated by cont inuous stimulations. Hence, we propose the use of functional data analysis [9], which treats data, o r the processes giving rise to them, as functions. This not only allows to overcome limitations in n euroimaing studies due to the large number of data points compared to the number of samples, but a lso allows to exploit the fact that functions defined on a specific domain form an inner product ve ctor space, and in most circum-stances can be treated algebraically like vectors [10].
 We extend classical multivariate regression analysis of fM RI data [11] to stochastic functional mea-surements. We show that, cast into an incremental pattern se arching framework, functional multi-variate regression provides a powerful technique for fMRI-based prediction of naturalistic stimuli. In the remainder, we consider stimuli data and data produced by fMRI scanners as continuous func-tions of time, sampled at the scan interval and subject to obs ervational noise. We treat the data within a functional linear model where both the predictant a nd predictor are functional, but where the design matrix that takes care of the linear mapping betwe en the two is vectorial. 2.1 The Predictor The predictor data are derived directly from the four-dimen sional fMRI data I ( x , t ), where x  X   X  3 denotes the spatial position of a voxel and t denotes its temporal position. We represent each of the S voxel time courses in functional form by f s ( t ), with t denoting the continuous path parameter and s = 1 ,..., S . Rather than directly using voxel time courses for predicti on, we use their principal components to eliminate collinearity in the predictor set. Following [10], we use functional principal component analysis. Viviani et al. [10] showed that functio nal principal components analysis is more e ff ective than is its ordinary counterpart in recovering the si gnal of interest in fMRI data, even if limited or no prior knowledge of the hemodynamic function or experimental design is specified. In contrast to [10], however, our approach incrementally zo oms in on stimuli-related voxel time courses for dimension reduction (see section 2.5).
 of modes to retain is determined from the proportion of the va riance that needs to be explained. Assuming this is Q , the central concept is that of taking the linear combinatio n components  X  q ( t ) , q = 1 ,.., Q are sought for one-by-one by optimizing where  X  q ( t ) is subject to the following orthonormal constraints The mapping of f s ( t ) onto the subspace spanned by the first Q principal component curves results in ponents scores as our predictor data in linear regression. T hat is, we perform principal component regression with F as model, allowing to naturally deal with temporal correlat ions, multicollinearity and systematic signal variation. 2.2 The Predictand We represent the stimulus pattern by the functional 1 ( t ), t being the continuous time parameter. We register 1 ( t ) to each voxel time course f s ( t ) in order to be able to compare equivalent time points on stimulus and brain activity data. Alignment reduces to fin ding the warping function  X  s ( t ) that produces the warped stimulus function care of a small shift and nonlinear transformation. A global alignment criteria and least squares estimation is used: registration over standard convolution of stimulus 1 ( t ) with the hemodynamic reponse function, is the large variability in hemodynamic delays across brain re gions and subjects. A non -linear warp of 1 ( t ) does not guarantee an outcome that is associated with brain physiology, however it allows to capture unknown subtle localized variations in hemodyna mic delays across brain regions and subjects. 2.3 The Model We employ the predictor data to explain the predictand data w ithin a linear modeling approach, i.e. our multivariate linear model is defined as are estimated by least squares minimization such that mally distributed with zero mean. The estimated regression functions provide the best estimate of g ( t ) in least squares sense: Given a new (sub)set of voxel time courses, prediction of a st imulus pattern now reduces to comput-ing the matrix of principal component scores from this new se t and weighting these scores by the estimated regression functions  X   X  ( t ). 2.4 The Objective The overall fit of the model to the data is expressed in terms of adjusted R 2 statistic. The functional  X  g ( t ). For the voxel set S , are derived, where the first term is the variation of the respo nse about its mean and the second the error sum of squares function. The adjusted R-square functi on is then defined as where degrees of freedom S  X  Q  X  1 and S  X  1 adjust the R-square. Our objective is to find the set of voxel time courses S defined as where S  X  denotes a subset of the entire collection of voxels time cour ses S extracted from a single fMRI scan. That is, we aim at finding spatially distributed vo xel responses S that best explain the naturalistic stimuli, without making any prior assumption s about location and size of voxel subsets. 2.5 The Search In order to e ffi ciently find the subset of voxels that maximizes Equation (12 ), we use Population-Based Incremental Learning (PBIL) [12], which combines Gen etic Algorithms with Competitive Learning. The PBIL algorithm uses a probability vector to ex plore the space of solutions. It in-crementally generates solutions by sampling from that prob ability vector, evaluates these solutions and selects promising ones to update the probability vector . Here, at increment i , the probability that for solution n the corresponding voxel time course f s ( t ) is included in the predictor set, while a value 0 indicates exclusion. Each member m i n is evaluated in terms of its adjusted R 2 value, and the members with highest values form the joint probability v ector p  X  . A new probability vector is subsequently constructed for the next generation via compe titive learning: The learning parameter  X  controls the search: a low value enables to focus entirely on the most recent voxel subset while a low value ensures that previousl y selected voxel subsets are exploited. In order to ensure spatial coherence and limit computation l oad, we employ the PBIl algorithm not on single time courses, but on averages of spatial clusters o f voxel time courses. That is, we first spatially cluster voxel locations as shown in Figure 1, then compute average time course for each cluster and then explore the averages via PBIL for model buil ding. 2.6 The Prediction The subset of voxel time courses that results from populatio n based incremental learning defines the most predictive voxel locations and associated regress ion functions. Given new and spatially to computing ulus. The matrix  X  F is the principal component scores matrix obtained from perf orming functional principal components analysis on subset  X  f as determined by training.
 Figure 1: Examples of K-means clustering of voxel locations using Euclidean distance. Left: 1024-means clustering output. Right: 512-means clustering outp ut. Di ff erent gray values indicate di ff er-ent clusters in a spatially normalized brain atlas. 3.1 Experiment Evaluation of our method is done on a data subset from the 2006 Pittsburgh brain activity interpre-tation competition (PBAIC) [6, 7], involving fMRI scans of t hree di ff erent subjects and two movie sessions. In each session, a subject viewed a new Home Improv ement sitcom movie for approxi-mately 20 minutes. The 20-minute movie contained 5 interrup tions where no video was present, only a white fixation cross on a black background. All three subjec ts watched the same two movies. The scans produced volumes with approximately 35,000 brain vox els, each approximately 3.28mm by 3.28mm by 3.5mm, with one volume produced every 1.75 seconds . These scans were preprocessed (motion correction, slice time correction, linear trend re moval) and spatially normalized (non-linear registration to the Montreal Neurological Institute brain atlas).
 After fMRI scanning, the three subjects watched the movie ag ain to rate 30 movie features at time intervals corresponding to the fMRI scan rate. In our experi ments, we focus on the 13 core movie features: amusement, attention, arousal, body parts, environmental sounds, faces, food, language, laughter, motion, music, sadness and tools . The real-valued ratings were convolved with a hemo-dynamic response function (HRF) modeled by two gamma functi ons, then subjected to voxel-wise non-linear registration as described in 2.2.
 For training and testing our model, we removed parts corresp onding with video presentations of a white fixation cross on a black background. Taking into accou nt the hemodynamic lag, we divided each fMRI scan and each subject rating into 6 parts correspon ding with the movie on parts. On average each movie part contained 105 discrete measurement s. We then functionalized these parts by fitting a 30 coe ffi cient B-spline to each voxel X  X  discrete time course. This re sulted in 18 data sets for training (3 subjects  X  6 movie parts) and another 18 for testing. We used movie 1 data for training and movie 2 data for prediction, and vice versa. We p erformed data analysis at two levels. For each feature, first the individual brain scans were analy zed with our method, resulting in a first sifting of voxels. First-level analysis results for a given feature were then subjected to second level analysis to identify across subject predictive voxels. Pea rson product-moment correlation coe ffi cient between manual feature rating functions and the automatica lly predicted feature functions was used as an evaluation measure. 3.2 Results All results were obtained with Q = 4 principal component dimensions, learning parameter valu e and  X  produced overall highest average cross correlation value i n a small parameter optimization experiment (data not shown here). Little performance di ff erences were seen for various numbers of dimensions, indicating that the essential information can be captured with as little as 4 dimension. Significant performance di ff erences across features, however, were observed for di ff erent learning parameter values, indicating considerable variation in br ain response to distinct stimuli. Figure 2: Left: normalized cross correlation values from cr oss-validation for 13 core movie features. Right: functionalized subject3 (solid red) and predicted ( dotted blue) rating for the language feature of part 5 of movie 1.
 Figure 2 (left) shows the average of 2  X  18 cross correlation coe ffi cients from cross validation for all 13 movie features. For features faces , language and motion cross correlation values above 0.5 were obtained, meaning that there is a significant degree of match between the subject ratings and the predicted ratings. Reasonable predictions were also obtai ned for features arousal and body parts . Our results are consistent with top 3 rank entries of 2006 PBA IC in that features faces and language are reliably predicted. These entries used recurrent neura l networks, ridge regression and a dynamic Gaussian Markov Random Field modeling on the entire test dat a benchmark, yielding across feature correlation value based on the reduced training data set is 0 .36. Note, that in the 2006 competition our method ranked first in the actor category [6]. We were able to accurately predict which actor the subjects were seeing purely based on fMRI scans [7].
 The best single result, with highest cross correlation valu e of 0.76, was obtained for feature language of subject 3 watching part 5 of movie 1. For this feature, first level analysis of each of the 18 training data sets associated with movie 2 produced a total number of 1 738 predictive voxels. In the second level analysis, these voxels were analyzed again to arrive a t a reduced data set of 680 voxels for building the multivariate functional linear model and dete rmining regression functions  X  ( t ). For prediction of feature language , corresponding voxel time courses were extracted from the f MRI data of subject 3 watching movie 1 part 5, and weighted by  X  ( t ). The manual rating of feature language of movie 1 part 5 by subject 3 and the average of the automatica lly predicted feature functions are shown in Figure 2 (right).
 Figure 3: Glass view, gray level image with color overlay and surface rendering of 1738 voxels from first level analysis. Color denotes predictive power and cro ss hair shows most predictive location. Figure 3 shows glass view, gray level image with color overla y and surface rendering of the 1738 voxels (approximately 40 clusters) from first level analysi s. The cross hair shows the voxel location in Brodman area 47 that was found to be predictive across most subjects and movie parts: it was the left and right inferior frontal gyrus, which are known to be involved in language processing. The distributed nature of these clusters is consistent with earlier findings that processing involved in language occurs in di ff use brain regions, including primary auditory and visual co rtex, frontal regions in the left and right hemisphere, in homologues regi ons [13].
 As we are dealing with curves, the possibility exists to expl ore additional data characteristics such as curvature. We performed an experiment with 1st order deriva tive functions, rather than the original correlation for 1st order derivative functions. The cross c orrelation values are similar to the ones shown in Figure 2. The average cross correlation value is sli ghtly better than for the original data: 0.38. This may indicate that higher order structures may con tain more predictive power. In order to get insight in the e ff ect of non-linear warping on prediction performance, we con ducted an experiment in which we used convolutions of the stimulus 1 ( t ) with di ff erent forms of a HRF function modeled by two gamma functions. Various HRF functi ons were obtained by varing the delay of response (relative to onset), delay of undershoot ( relative to onset), dispersion of response, dispersion of undershoot, ratio of response to undershoot. To determine g s ( t ), we convolved 1 ( t ) with 16 di ff erent HRF functions, and selected the convolved one with hig hest cross correlation with f ( t ) to be g s ( t ). Hence, we parametrically modeled the HRF and learned its p arameters from the data.
 Figure 4 (right) shows the results of the experiments with co nvolution of stimuli data with HRF models learned from the data. As can be seen, the cross correl ation values are much lower compared warping of stimulus onto voxel time course significantly enh ances the predictive power of our model. This suggests that non-linear warping is a potential altern ative for determining the best possible HRF estimate to overcome potential negative consequences of as suming HRF consistency across subjects or brain regions [14].
 Figure 4: Left: normalized cross correlation values from cr oss-validation for 13 core movie features, using 1st order derivative data. Right: cross correlation v alues from cross-validation for 13 core movie features, using HRF convoluted rather than warped sti muli data. Functional data analysis provides the possibility to fully exploit structure in inherently continuous data such as fMRI. The advantage of functional data analysis for principal component analysis of fMRI data was recently demonstrated in [10]. Here, we propos ed a functional linear model that treats fMRI and stimuli as stochastic functional measureme nts. Cast into an incremental pattern of spatially distributed brain responses and stimuli, i.e. it directly couples activation across brain regions rather than first localizing and then integrating fu nction. The method is suited for unbiased between complex stimuli and distributed brain responses. T his finding is supported by the good prediction performance of our method in the 2006 PBAIC inter national competition for brain activity interpretation. We are currently extending the method with new objective functions, dimension reduction techniques and multi-target search techniques t o cope with multiple (interacting) stimuli. Also, in this work we made use of spatial clusters at a single h ierarchical level. Preliminary results improve prediction power.
 [1] J. Haynes and G. Rees. Decoding mental states from brain a ctivity in humans. Nature Neuro-[2] J. Haynes and G. Rees. Predicting the orientation of invi sible stimuli from activity in human [3] Y. Kamitani and F. Tong. Decoding the visual and subjecti ve contents of the human brain. [4] S.M. Polyn, V.S. Natu, J.D. Cohen, and K.A. Norman. Categ ory-specific cortical activity [5] T.M. Mitchell, R. Hutchinson, R.S. Niculescu, F. Pereir a, X. Wang, M. Just, and S. Newman. [6] W. Schneider, A. Bartels, E. Formisano, J. Haxby, R. Goeb el, T. Mitchell, T. Nichols, and [7] Editorial. What X  X  on your mind. Nature Neuroscience , 6(8):981, 2006. [8] K.J. Worsley, J.B. Poline, K.J. Friston, and A.C. Evans. Characterizing the response of pet and [9] J. Ramsay and B. Silverman. Functional Data Analysis . Springer-Verlag, 1997. [10] R. Viviani, G. Grohn, and M. Spitzer. Functional princi pal component analysis of fmri data. [11] D.B. Rowe and R.G. Ho ff mann. Multivariate statistical analysis in fmri. IEEE Engineering in [12] Shumeet Baluja. Population-based incremental learni ng: A method for integrating genetic [13] M.A. Gernsbacher and M.P. Kaschak. Neuroimaging studi es of language production and com-[14] D.A. Handwerker, J.M. Ollinger, and M. D X  X sposito. Var iation of bold hemodynamic response
