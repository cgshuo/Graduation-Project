 As more and more people are willing to go shopping online, how to monitor and prevent the increasing online product f raud cases has become a major concern for both market surveillants and commercial companies [1]. Some online trading counterfeits of name brands or well-known products are always produced with misleading advertisements. Although t ext based searching methods have been used for illegal online trading detection, it is difficult for users to detect the counterfeits without brand-related words in their descriptions. To protect the interests of both dealers and customers, an automatic logo recognition system is required to prevent illegal trading activities and preserve the brand rights, even though there is not any corresponding brand related descriptions.

In logo recognition, one fundamental problem is to detect the logo regions in an image. The logo detection can be considered as a rare event detection and has a high demand of low false position rates. Although the adaptive boosting based Void-Jones approaches have become a commonplace in the general purpose pattern detection application [2,3], it suffers from the low noise-tolerant problem in the training datasets, which also is general in the application of logo image detection [4,5]. Actually, Logos are always made with all kinds of materials such as fabrics, glasses, leathers and metal. The larger intra-class variations or class noise (mis-labeled) would be created on the logo images  X  textures, intensities and design details. Therefore, a noise-tolerant classifier is essential for the application of the logo detection and recognition.

As the appearances of the same logo may vary due to different lighting condi-tions, scaling, and rotation effects during imaging, some logo images may respond poorly to some simple features or single feature. To improve the performance of logo detection and recognition, more methods need to be introduced as view cues to enhance the feature detection on logo images.
 In this paper, we propose a noise-tolerant classification method based on Random Forest for logo detection and recognition. Firstly, a fusion scheme of multi-type feature methods is designed to extract features from logo images, and normalize them using the Bag of Words model (BOW). Then, a random forest classification algorithm is used to detect logo regions by defining classification scoring rules, and the robustness of logo detection on realistic noise pictures is further improved using the comprehensi ve scoring on all decision trees. Lastly, the visual words with space information are used for logo recognition to improve the accuracy of results.

The rest of the paper is organized as fo llows. Section 2 introduces the related work on logo detection and recognition. Section 3 analyzes th e characteristics of the logo images and proposes the algorithm for a fusion of multi-type feature extraction methods. Section 4 describe s the Random Forest based classification method for logo detection and further presents the optimization approach for logo recognition. The experimental resul ts on the realistic datasets are provided in section 5, and a conclusion and future work are presented in Section 6. There are mainly two approaches for detecting logo regions. The first direction is automatic region matching using local or global characteristics. Joly and Buisson used SIFT features to search images with a special logo by a query expansion strategy [6]. David S. Doermann et al added some limited conditions in the logo recognition process, such as the invariants on the relationship between a circle and a line [7]. Li et al introduced a system architecture for segmentation-free and layout-independent logo detection and recognition in document images [8]. Hassanzadeh and Pourghassem extracted the spatial structure features of im-ages for the logo recognition in noise document images after image segmentation by the method of binarization [9]. Although, the characteristic based methods can lead to higher accuracy for the speci fic logo recognition, such as the docu-ment images, they suffer from the shape and material diversity of arbitrary logo images. Some logos may respond poorly to special features or shapes, and the direct boundary extraction may fail due to boundary shielding or noise images. Another direction is to detect logo regions based on machine leaning methods. Bayesian belief network was used for document logo detection and recognition in the literature [10], where a logo hypoth esis was computed by matching the nodes of a logo  X  s RAG (Region Adjacency Graph). Such a basic framework is efficient for the well-defined topological structures of logos. When processing with com-plex contours or incomplete boundaries, this method often falls to extract the sub-regions of logos and build an effective RAG for logos. As an application of the pattern detection, although the Viola-Jones can perform a fast and accurate detection in terms of Fale Positive (FP) [11], its performance degrades signifi-cantly on noisy training datasets [12]. For most logo images, the training dataset often has larger inter-class variations than the training datasets for other regular objects such as face. Yu and Vrizlynn upd ated the Viola-Johes classifier on the noisy training logo data by detecting the extreme training situation and adjust-ing the training constraints [13]. As the noisy training data would be trimmed adaptively in the training processing, more data with the same logo would be needed for training and the accuracy of classifier could be affected on the small dataset or the dataset with more noisy images. what X  X  more, more classifiers need to be built for multi-class logo detection while every classifier will be built only for one logo.

In this paper, a logo detection based on Random Forest learning is proposed for a wide range of the logo images in training and detection. More feature extraction methods are fused to enhance the discriminative feature phases. Then the classifier is designed for multi-class logo detection using Random Forest learning, which can avoid an extreme stage training situation by building more decision trees in the random forest. Finally, considering the fixed structure of logo images, a new method of similarity calculation based on spatial information is proposed for logo recognition. Different from general images, various logos always have the same or similar features on some aspect. For example, Heineken logo and Star Bucks logo have the same shapes as shown in figure 1(a), and Barilla logo and Pepsi logo have the similar colors as shown in figure 1(b). The similarity of different logos causes that it is difficult to detect logos only using simple or single type of features. Moreover, logo images are smaller than general images, so we can extract and process multi-type features of logo images with not larger computation cost.
In this research, considering the inherent attributes of logos and the different effects during image taking, we extract the hybrid features of logo images for the classifier training, including texture features ( F texture ), canny edge features ( F canny ), shape features ( F shape ), Histogram of Oriented Gradient (HOG) fea-tures [14] ( F HOG ), color features ( F color ), Scale Invariant Feature Transform (SIFT) features [15] ( F SIFT ), Speed Up Robust Feature (SURF) features [16] ( F SURF ). Then a logo image with class label can be described with F logo as follows: where logo is a class label of the logo image.
 Since the numbers of some features d epend on the sizes of images (such as HOG) and the numbers of extracted interest points (such as SURF and SIFT), we need to normalize image features using some rules for building the classifier. In order to get the same number values for the same feature on all logo images, we first normalize logo images using linear interpolation to the same size for feature extraction in this paper. For SURF and SIFT features obtained by detecting the image interest points, their numbers vary with the numbers of the extracted interest points in different images. Here we use BOW to obtain uniform k statistic features of SURF and SIFT on scaling invariability for logo images. In the other word, the BOW model is utilized to normalize the image features by preserving the original feature points of images. 4.1 Random Forest Based Classifier Training From the discussion in section 3, we know that logos  X  hybrid features need to be extracted for logo detection, and that there are also noise data in logo images. To perform the classification better on the noise dataset with high dimensions, we select Random Forest classification approach for logo detection. Random Forest is a machine learning algorithm combining the integration learning theory and random subspace method, which gets multi decision trees in training processing for multi-class classification [17].

Algorithm 1 gives the approach of the logo classifier building. Supposing we construct n decision trees for the Random Forest classifier, for each one, we firstly need to randomly select N cases from the original dataset D to create the training dataset, and randomly select m features from M image features as the training features, Then we construct decision tree t on the selected dataset using the selected features. Here the decision tree is created by C4. 5 algorithm [17]. 4.2 Logo Detecting The logos are usually superimposed on a nook and corner of boards or commodi-ties as well as the two images shown in Figure 2. The detection may fail if based on global features or features of main objects on these images. So we need to detect the logo areas on subspaces of an im age. In general object detection ap-plication, the sliding window is always used to detect target areas [13]. However, the sizes of logo regions often vary with the objects that they are adhered to in images, thus a wide range of sizes of windows need to be defined and detected on only one image. In this paper, we get subregions for logo detecting using random partition.
We randomly partition each image into M  X  N non-overlapping rectangular patches and perform such partitioning Q times independently. Thus we will obtain a subimage pool with M  X  N  X  Q patches. Each patch is denoted as the coordinates of the starting point of the patch in the q -th partition, w and h mean the width and the height of the patch respectively, while x and y are randomly generated in each part ition. For a given partition q  X  X  1 , 2 ,...,Q } , the M  X  N patches are non-overlapping, while the patch patch q patch q be overlapped. We apply the classifier cre ated in Section 4.1 to classify every partition patch, and the unoverlapped patches which scores from the classifier are larger than the defined threshold  X  are selected into the candidate set for further logo recognition.

The Random Forest classifier is made u p of several decision trees. When in-putting a test sample p , all decision tree would mak e a decision and give a class estimate. Here the last score of every partition will be decided by the most fre-quency of classes outputted by these deci sion trees. The classification score of p will be computed by: where N t is the total number of decision trees contained in the Random Forest classifier and n 1 ,n 2 ,...,n c respectively expresses the decision number of class 1 , 2 ,...,c given by N t decision trees for p .
 Algorithm 2. Logo detection Input: an image I , partition times Q ; Output: detected logo patch set P ; Description: 1) P =  X  ; 2) for i =1to Q 3) { Randomly partition I into M  X  N patches; 4) for j =1to M  X  N 6) score j = RandomForest ( patch j ); 7) if score j &gt; X  8) for each p from P 9) if patch j  X  p =  X  ; 10) P  X  patch j ; 11) elseif patch j  X  p =  X  and score p &lt;score j 12) Delete p from P ; 13) endif 14) endif 15) } 16) }
The processing of logo detection based on classification is described in Algo-rithm 2. Firstly we partition a given image to patches with different sizes and extract the feature vectors on every patc h. Then every partition is classified by Random Forest classifier and result in a c lassification score. When a received score is larger than the threshold  X  , we consider there is a high probability that a logo will be presented in the corresponding partition. As an image might in-clude more than one logo, we select the patches with the highest score respective in non-overlapping areas as the candidate logo regions in the image.
 4.3 Logo Recognizing Based on Spatial Structure After logo detecting, each subregion in the candidate set have a class tag from results of classification and such tags may be looked as the results of logo recogni-tion. However, the extracted feature vect ors in logo detection are used for global object areas without spatial depended relation. For example, the characters in word  X  X TARBUCKS  X  are reordered to a different sequence as shown in fig-ure 3(b) and result in a totally disparate lexeme, while the two images in figure 3 have the same visual words in the feature space.

Since product frauds always mislead customers by a little difference in their logos from luxury or well-recognized products, the results of classification in section 4.2 usually fail to detect a nice distinction of two similar images with same visual words like in figure 3. Therefore, we need to add spatial information into visual features for logo recognition according to the intrinsic characteristics of logos.
Inspired by the work of Zhang and Cheng [18], in this paper the object regions are recognized using visual words with spatial correlated information to a specific logo. The geometry-preserving in an image area is expressed by the co-occurrence of visual phrases in relative displacements. Firstly the object region and the logo image are partitioned into the small patches with the same size. Then the visual words are recovered in each patch following the result of clustering on BOW in section 3. The co-occurrence matrixes o f visual words are constructed at the relative offsets respectively on the object region, the logo image and between the object region and the logo image. Lastly Formula 3 is used to compute the similarity between the object region and the logo image for logo recognition. The processing steps are briefly described as follows: 1. We construct the visual word tables on the feature space for each patch 2. Given the max offset s , we construct the co-occurrence matrixes of visual 3. For each co-occurrence matrix, we count up the frequency of visual phrases 4. The similarity of the object region and the specific logo are computed for
Supposing r represents a subregion in the candidate set and l is a logo in the logo dataset, we give the definition of the similarity computation as follows: where co vp rl denotes the number that the same visual words co-occur in the same relative offset of two images; co vp r and co vp l respectively represent the numbers that visual words occur in image r and image l . Given a threshold  X  ,if VP Sim ( r, l ) &gt; X  , the object region r is regarded as the target logo l ,otherwise it is misclassified. 5.1 Experiment Setup  X  Training the classifier. For the classifier training, we apply Waikato Envi- X  Training Dataset. We used a recent proposed logo dataset DBMM-contest  X  Testing Dataset. Since there is no benchmark dataset for the logo detection  X  Evaluation Measure. We use F -Score to measure the performance of al-5.2 Experiment Results Feature Selection. Firstly we analyze the average performance of all-type logo detection using different combinations of image features. For the features de-pended on the sizes of images or the numbers of interest points, such as HOG, SURF and SIFT, we normalize their number respectively as k dimensions as described as in section 3. For the other features, we respectively extract 128 HSV color statistic features, 8 texture features based on GLCM [21], 8 canny operators [22] and 7 shape invariant moments [23].

The experiment result is shown in figure 4 and the parameter k is used to limit the dimensions of the features. In the figure, we can see that it has the worst performance when SIFT and SURF features are not used at all for any dimen-sion features. Moreover, SURF is more distinguished feature than the others for the classifier training. Obviously, the more satisfied results can be achieved us-ing SURF+HOG+others features or SIFT+SURF+HOG+others features when about k = 100 and the similar performances are got using these two combined features. Considering the complexity of SIFT extracting, we will use 100 dimen-sion SURF+HOG+others features of images for logo detection in the following experiments.
 Logo Detection. Random partition is used to get subregions for logo detecting and the partition time is aromatically estimated for every detected image by defining the stop condition. Here similarity parameter  X  is set to 0 . 7andthe maximum size of candidate is set to be 3. In other words, we think the logo number in one image is not more than 3. Table 2 presents the scores of the top ranked subregions for patches on an image. We can see that the patches No.1, No.5 and No.7 achieve the better classification scores. The patch No.7 will be detected as a candidate region with the largest classification score in non-overlapping areas and the class label  X  X epsi  X  X ill be returned for it.
Figure 5 shows the average performance of logo detection using the different feature combinations respectively for different categories when k = 100. Gen-erally, SURF is the important feature for nearly all logos, while the separate features may be remarkable for only few logos such as HOG for  X  X cDonald  X  s X  and  X  X epsi  X . The poorer results are got on the category  X  X in Zano X  nearly using all feature combinations, as the training set contains less logo images for this brand. So we need more logo training images for one brand on different imaging conditions to get better classification results.
 Logo Recognition. In Table 3, we compare the average performance of logo recognition using spatial correlated information and the classification perfor-mance before further recognition. Here the similarity parameter  X  is set to be 0 . 7 too. We can see from Table 3 that the further recognition has a better F -Score compared with the classification res ult in nearly all categories except  X  X in Zano  X . It is due to the poorer classification result from the insufficiency of training cases.
 At last, we compare our results with the N-TEC in the literature [13]. As the N-TEC only construct the classifier for one logo each time, We select the brand  X  X enilla X ,  X  X tarBucks X  X nd  X  X in Zano X  respectively to the training classifier and compare it with our method. The comparing result is shown in Table 4. Gener-ally speaking, our logo method can achie ve a better or comparable performance compared with N-TEC. For the dataset with less logo images, such as the brand  X  X in Zano X  including 3 logo images, the performance of our method is better than N-TEC due to the multi decision trees learning from different feature com-binations. The comparable performances are obtained for the brands with more training logo images, but N-TEC need to train more classifiers for different logos. In this paper, we explore to use the Random Forest classifier training method to detect logos from real images and the accuracy of the log recognition is fur-ther improved by using image spatial visual information. The key idea is that more feature extraction methods are fused to enhance the distinguishable visual phrases and the multi-class classification is designed to avoid an extreme stage training situation. Considering the variety of logo sizes adhered to images, the random partitioning is used to detect target regions instead of the sliding win-dow for saving the cost of computation. The experiment results validate that the performance of logo recognition outperforms the well-known adaptive boosting based Viola-Johes classifier on the real noise images with multi-category logos.
For the logo recognition adapting to different imaging conditions, we will consider a larger training data set to prove the robust of the method in our further work, and further analysis the features working well on logos comparing to other general images.
 Acknowledgments. This work is supported by the State Key Development Program for Basic Research of China (Grant No. 2011CB302200-G), State Key Program of National Natural Science of China (Grant No. 61370074, 61100026).
