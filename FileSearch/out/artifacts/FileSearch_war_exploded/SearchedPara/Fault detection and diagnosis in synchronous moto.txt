 fi cation process. Finally, the experimental results are provided and fi cation accuracy by nearly 21% and moreover utilization of the proposed 1. Introduction
Rotary electric motors (REM) provide the basis for the electro-mechanical energy conversion in all industrial environments ( Deauff and Za X m, 2010 ). Thus, as the industry grows, the impor-tance of fault detection and condition based maintenance in the rotary electric motors is increasing. Early fault detection and diagnosis can help to increase the availability of the industrial machines and reduce the economic loss pertaining to the main-tenance of the machinery systems ( Lei et al., 2009 ).
The most common fault in the REMs is bearing related faults which are responsible for about 50% of all rotary machine faults ( Nandi et al., 2005 ). The second most common fault is the unbalanced rotor which causes excessive vibrations in the machines ( Adams, 2001 ; Bently et al., 2002 ). Among the REMs, synchronous motors are one of the motor types that are widely used in all the industrial applications where constant speed is essential. In this paper, a new fault diagnosis approach is intro-duced to distinguish the two major faults namely bearing fault and unbalanced rotor bar from the healthy condition in synchronous motors over a wide range of operating speeds. In this work, vibration signatures are used for fault detection and diagnostics.
Among the common signatures analyzed during condition monitoring of machinery systems, vibration signature analysis seems to be the most responsive one ( McInerny and Dai, 2003 ; Bianchini et al., 2011 ; Jayaswal et al., 2011 ). Vibration is the most commonly measured signal used in monitoring machinery condi-tion and an effective media for diagnosing mechanical faults ( Adams, 2001 ; Stack et al., 2004 , 2006 ; Ocak et al., 2007 ; Lei et al., 2009 ; Immovilli et al., 2010 ). Machine vibration arises due to action-reaction forces acting on the surface-to-surface contacts of moving machine parts. A healthy machine exhibits low level of vibrations and a machine with unbalanced rotor or bearing defects generates unique vibration signatures ( Adams, 2001 ). However, the detection of bearing faults using vibration signals is affected by the machine speed ( Stack et al., 2003 ). In Stack et al. (2004) , an amplitude modulation detector is developed to identify and detect bearing fault while it is in its early stages based on bearing characteristic fault frequency. In this work, vibra-tion signals are used as the obs ervation sequences through timewhicharefedtothehiddenMarkovmodelsusedinthe proposed approach.

Hidden Markov models (HMM) are extensively used for fault detection and diagnosis in various rotary electrical motors ( Li et al., 2005 ; Xu and Ge, 2004 ; Ye et al., 2002 ; Miao and Makis, 2007 ;
Nelwamondo et al., 2006 ; Ocak and Loparo, 2001 ; Ocak et al., 2007 ; Maurya et al., 2007 ). Also, in Zaidi et al. (2011) , a failure prognosis method based on HMM that uses the extracted features from the motor current is proposed to predict future state of fault severity given that the fault has already diagnosed using a linear discriminant classi fi er. In all the detection and diagnosis cases, the HMM-based approach is successful in distinguishing healthy condition from faulty conditions (fault detection). The challenging part is to diagnose the faults as the amplitude of the vibration signals from various faults may be similar between various operating speeds. That increases the chance of misclassi fi based on maximum likelihood strategy considering the fact that the true model is not realizable in real applications. In this paper, to improve the performance of the existing HMM-based approach, a semi-nonparametric approach is proposed. In this approach, after training the HMM classi fi ers (parameter estimation stage), two matrices named probabilistic transition frequency pro average probabilistic emission are computed and stored based on the HMMs for each signature (nonparametric stage) in the training phase using probabilistic inference. When a new signature is given for fault diagnosis, after applying all HMM classi fi ers on the given signature and computing the required matrices based on each
HMM, the similarity between the given signature and the training signatures in each class is assessed with a scoring function based on the stored matrices. The introduced approach is named HMM-based semi-nonparametric (HMMSNP) since fi rstly it uses both
HMM (parametric) and similarity of the resultant matrices with the corresponding matrices from the training data (nonpara-metric), and ultimately the classi fi cation result is based on the nonparametric stage on top of the conventional (parametric) HMM classi fi ers. Performance of the proposed approach is compared with the conventional HMM-based approach. Furthermore, a pre-processing method named squeezing and stretching is proposed to rectify the dif fi culty of dealing with various operating speeds in the classi fi cation process.

The rest of the paper is organized as follows. In Section 2 , the mechanics of vibration for bearing and unbalanced rotor faults are introduced. In Section 3 , the experimental setup and data acquisition are presented. Section 4 describes the rationale and the procedure of the proposed preprocessing method. In Section 5 , the conventional HMM-based fault diagnosis approach is briefed, and the proposed HMMSNP approach is introduced. Preliminary experimental results are provided and compared for the mentioned approaches in Section 6 .In Section 7 , further investigations are carried out to show the statistical signi fi cance of the performance improvements. Sensitivity analysis is also conducted on the number of hidden state values and the length of input signatures. Finally, the paper is concluded in Section 8 . 2. Rotary machine fault mechanics
Machines with rolling elements have moving bearings, e.g. spherical balls, tapered rollers, or cylindrical rollers, to support the rotating shaft. These rolling elements are always in metal-to-metal contact with the inner and outer raceway, and as a result are subject to constant wear and tear. Bearing and raceway wear and tear present initially as general roughness and progresses to metal fatigue, and ultimately spall and chip on the surface of the rolling elements ( Nandi et al., 2005 ).

Defective surfaces on these components are a source of machine vibration. A chipped rolling element spins as it revolves around the raceway. When it is in contact with the defective surface of the raceway, an impact pulse is produced, creating a free vibration. In the absence of signi fi cant damping medium in the bearing assembly, the impact pulses decay exponentially. Another major fault in the rotary machines is unbalanced rotor.
Unbalanced rotor is the most common source of excessive vibra-tion. Possible causes are asymmetrical mass distribution of the rotating element as a result of wear, erosion, material build-up, thermal expansion or contraction, causing shaft bending or mis-alignment. As a result, the center of gravity of the rotating element does not coincide with the center of rotation, and at the point of unbalanced mass creates a synchronous radial perturbation force
F , causing a forced vibration. Assuming a rigid isotropic rotor system ( Bently et al., 2002 ), this phenomenon is described as
F where m is the unbalanced rotor mass, r is the distance between the unbalanced mass and the center of gravity of the rotor, t is time,  X  is the shaft rotational speed,  X  is the angular position of r and j is the complex operator. As a reference, healthy machine signatures are also recorded. Fig. 1 shows three sample vibration sequences under different conditions, i.e. bearing fault (BRG), unbalanced rotor (UBR) and healthy (HTY) conditions at 23 Hz as a medium rotating speed. As can be seen in Fig. 1 , a healthy machine has the lowest level of vibration compared to other conditions. 3. Fault generating setup
In this work, the two common fault modes in the synchronous motors, which are unbalanced rotor and bearing faults, are generated using a SpectraQuest fault simulator machine shown in Fig. 2 . Table 1 lists the operating parameters and the required components for the experiments.

The accumulated data comprises data sequences for the bear-ing fault (BRG), unbalanced rotor fault (UBR), and healthy machine (HTY), with 180 sequences (signatures) for each class, where 10 signatures are recorded at each machine operating speed of 15 Hz up to 32 Hz. The BRG class consists of a mixture of three possible faults associated with bearings, i.e. rolling element fault, inner raceway fault and outer raceway fault.

The acceleration of the machine vibration is measured by a stud-mounted piezoelectric accelerometer of 10 kHz bandwidth above the bearing journal. Vibration signatures are recorded by DEWETRON s digital data acquisition system with a sampling frequency of 5 kHz using Hanning window. Each data sequence (vibration signature) is 4000 samples in length, representing a snap-shot time window of 800 ms. Fig. 3 shows the experimental setups used to generate the various bearing faults and the unbalanced rotor.

As can be seen in Fig. 3 (b), two rotors with screws attached are mounted on the shaft to simulate unbalanced rotor fault. The weight of these screws generates unequal centrifugal forces when the rotor spins, thus creating vibrations due to unbalanced rotor.
Note that the signatures corresponding to the same fault are different in period and amplitude when the operating speeds are different. Fig. 4 depicts the unbalanced rotor fault signatures with the operating speed starting from 15 Hz and increased up to 32 Hz. As the operating speed increases from 15 Hz to 32 Hz, signatures are getting squeezed along the time horizon and increased in amplitude. Thus, a preprocessing procedure is required to map all the signatures acquired from various operating speeds to a common speed. For this purpose, a preprocessing method is proposed in the succeeding section. 4. Signature squeezing &amp; stretching
In this section, a signature preprocessing method named squeez-ing and stretching (SqS) is proposed. The idea of SqS method is similar to dynamic time warping (DTW), that is used extensively in data-
In DTW, the similar subsequences between the reference sequence and the testing sequence will be dynamically matched ( Keogh and
Ratanamahatana, 2005 ; Fu, 2011 ). This method warps the time axis at various points to match the two sequences. However, the length of these warpings is not fi xed and they have to be computed dynamically with the objective of achieving the highest similarity matching. In signature squeezing, as the operating speeds are known, thus the conversion of the time series to a common time line is simply possible through a fi xed warping and appropriate resampling. The vibration amplitude in the signals acquired from lower operating speeds can also be scaled to match a common higher operating speed through stretching in amplitude. 4.1. Squeezing in time
In this phase of preprocessing, all the signatures will be squeezed to a common high operating speed. After adopting a high operating speed (the highest operating speed available in the training set) as the common operating speed, since the operating speed is known for each signature, signatures will be squeezed based on their ratio of speed to the adopted common operating speed. The squeezing in time mappings for time ( x -axis) can be formulated as t  X 
 X  c t o ;  X  1  X  where t s is the squeezed time, t o is the time line in the original sequence,  X  o is the operating speed of the original signature and is the common operating speed. Fig. 5 shows examples of applying squeezing method on UBR and BRG signatures based on (1) .
As can be seen in Fig. 5 , after applying the squeezing pre-processing, the period of the sequences in both cases matches although the signatures are asynchronous and have relative phase difference. 4.2. Stretching in amplitude
After squeezing procedure, the period differences between the signatures are remedied. However, as can be seen in Fig. 5 , the amplitude differences between sequences acquired from various operating speeds are obvious. Thus, further preprocessing is done to map the amplitude of the given signatures to the common operating speed. Here, the signatures are stretched in the y -axis, based on the average peak-to-peak amplitude (APPA) in the signatures gathered from that operating speed and the common speed. After windowing the signatures, the minimum and max-imum amplitudes within each window are found and used to calculate APPA for each signature. The ratio of average APPA in common speed to the average APPA is used for scaling the signature signal in amplitude. It is noteworthy that in this procedure all the signatures, no matter which fault and condition they are indicating, are stretched based on the average APPA in the collected speed w.r.t. the common speed. Thus the stretching procedure can be formulated as y  X  APPA c
APPA o where y s is the stretched vibration signal, y o is the original vibration signal before transformation, APPA c is the average APPA in the common operating speed, and APPA o is the average APPA in the collected original operating speed.

Fig. 6 depicts the effect of signature stretching in matching the amplitudes from various operating speeds by relative magni tion of the vibration amplitudes. 5. HMM-based fault diagnosis
Hidden Markov models can be used as generative models in fault diagnostics. In its conventional form, each HMM is trained on a speci fi c fault. Whenever a new data is given to the system, each
HMM returns the log-likelihood that the new data is generated by the same fault as the one that the HMM is trained for based on the training data. This approach is used in many fault detection and diagnostics applications ( Ocak and Loparo, 2001 ; Ye et al., 2002 ; Xu and Ge, 2004 ; Li et al., 2005 ). In this paper, the conventional
HMM-based fault diagnostics is used as a benchmark to assess the proposed HMM-based approach. 5.1. Hidden Markov model Hidden Markov model is a simple dynamic Bayesian network.
This model has only one discrete hidden state variable, and a set of discrete or continuous observation nodes. The HMM parameters can be estimated using expectation-maximization techniques. The hidden state variable in the hidden Markov model can take different state values. As the number of these values increases, the computational cost for estimating the parameters and performing inference on the HMM becomes more and more expensive. Thus, an appropriate number of hidden state values for the HMM must be adopted and it can be done by considering either the average log-likelihood of the trained models with various number of hidden state values on the training set or cross-validation on the training set.

Assume the number of hidden state values adopted is M and the state values are f v 1 ; v 2 ; ... ; v M g . Then, a fi Markov model can be characterized by the assumption that
P  X  S t  X  v i j S t  X  1 ; S t  X  2 ; ... ; S 1  X  X  P  X  S t  X  v i j S where P  X j X  is a conditional probability, S t is the hidden state variable at time t and v i is the i th hidden state value.
Assuming stationarity, the initial state probabilities (prior probabilities), transition probabilities and emission probabilities, which connect the hidden states to the observations (vibration signals) are the only parameters to be identi fi ed. Given the training data, these parameters can be estimated using expectation-maximization technique ( Ocak and Loparo, 2001 ).
Task of fault diagnostics in REMs is to correctly classify a given signature (sequence of observations through time) into one of the prede fi ned classes such as healthy condition or various types of faults. This task is conventionally done by comparing the provided log-likelihoods from different HMMs each trained on the samples having speci fi c faulty or healthy condition ( Ocak and Loparo, 2001 ). The newly given signature is classi fi ed into the condition whose corresponding HMM achieves the maximum log-likelihood among all HMMs. Based on a trained HMM with estimated parameter set of  X  , the likelihood of a given sequence being generated by that HMM can be computed using forward  X  backward algorithm ( Rabiner, 1989 ). As the signatures are acquired asynchronously, no prior information can help us to identify the initial probability for the HMM and all the states are equally probable with a uniform distribution. Thus, the initial probability can be ignored in the calculations.

As illustrated in Fig. 7 , in the conventional HMM-based fault diagnostics, the newly given signature is classi fi corresponding class of the HMM that achieves the maximum log-likelihood. 5.2. HMM-based semi-nonparametric approach
As the true model in real applications is not always realizable, we will try to improve the classi fi cation performance by integrat-ing and taking the advantages of both parametric (model based) and nonparametric classi fi cation approaches.

Here, an HMM-based semi-nonparametric (HMMSNP) approach is developed to improve the performance of the conventional
HMM-based approach that relies on the log-likelihood. In this approach, after performing the squeezing and stretching preproces-sing, the parameters are learned from the training sequences. The parameter estimation procedure is identical with the conventional
HMM-based approach. When the expectation-maximization train-ing procedure is over, the trained HMMs are applied on their corresponding training sequences. Using the probabilistic infer-ence, two matrices named probabilistic transition frequency pro and average probabilistic emission which are denoted as F and E , respectively, are computed and stored for each training sequence.
The two F and E matrices can be interpreted as representations of the given signature based on the applied HMM in state space and observation domain, respectively. These matrices will be used to form a scoring function that is used as the classi fi cation basis. The procedure of computing F and E matrices and their computation rationale are explained in the succeeding subsections.
After training the HMMs based on the training signatures, given a signature, the state values that the state variable of an
HMM takes at each time step can be estimated using forward backward algorithm ( Rabiner,1989 ).  X  t is de fi ned as the probability distribution of the state values at time t . As described in Rabiner (1989) ,  X  t can be written as  X   X  X   X   X  i  X   X 
P  X  S t  X  v i j y 1 : T  X  X  P  X  S t  X  v i  X  where y 1 : T is the given sequence of observations, which in this case is the vibration signal (after SqS preprocessing) in terms of acceleration,  X  is the normalizing factor equals 1 =  X  M i  X  1
T is the length of the given sequence, and S t is the hidden state at that can be computed using the forward  X  backward algorithm ( Rabiner, 1989 ). 5.2.1. Probabilistic transition frequency pro fi le
Using the computed probabilities of each state at every time step, the probabilistic transitions between the states can be computed by the outer product of consequent probabilities. After computing all the probabilistic transitions given the sequence and the parameters of the HMM, the average of the computed matrices called probabilistic transition frequency pro fi le (PTFP) is stored and used as the overall transition pattern for the given signature based on a given HMM. Here, PTFP is denoted by F and it can be formulated using  X  t de fi ned in (3) as
F  X  X  f in matrix F , which indicates the probabilistic frequency that transition from i th state to j th state has occurred in that signature normalized by the total number of transitions throughout the sequence. In other words, matrix F captures a normalized three-dimensional transition frequency map for each signature.
The transition frequency map can be used to recognize differ-ences and distinguish between signatures which have distinct trend of transition frequency. Fig. 8 visualizes the average F matrices in the HTY, UBR, and BRG conditions (classes). It is noteworthy that although the number of state values in all the classes is set to be identical, the state values vary between the classes. However, in order to be able to visually compare the overall trends between matrices from different classes, the states are rearranged and sorted based on their average emission value in the vibration domain. 5.2.2. Average probabilistic emission
It is noteworthy that the map provided by F de fi ned in (4) only recognizes the differences between sequences of transitions in the state values after applying HMM on the signatures. However, as the probabilistic transition frequencies are normalized to become comparable between various classes, there may be cases that identical transitions correspond to very different real-valued observations in the vibration domain (e.g. when an HMM from
HTY class is applied on a signature from UBR class while perform-ing testing). Thus, another metric is required to assess how similar two identical transitions within two signatures are in their real-valued observed sequences (emitted vibrations). For this purpose, the average probabilistic emission (APE) matrix denoted by E is introduced as a metric used in the similarity scoring function.
Given an observation sequence (signature) and based on (3) , E can be computed as follows: e  X  where y t is the observed vibration at time t in the signature (after performing SqS preprocessing), and e i ; j is the i th row, j th column element in matrix E . e i ; j indicates the average observed vibration through the sequence with the probabilistic transition from i th state to j th state. Similar to F matrix, E can also be recognized as a three-dimensional graph. This graph indicates the average observed vibration through the sequence while the transition has taken place from i to j th state. Here, our goal is to the most similar training sequence to the given sequence in terms of PTFP and APE within each class. Then use the highest similarity scores achieved from each class and compare them to fi nally classify the given sequence. Fig. 9 schematizes the training stage in the HMMSNP approach implemented to classify the three condi-tions (HTY, UBR, and BRG) in this application. 5.2.3. Classi fi cation
When a new sequence is given to the system for fault diagnostics (classi fi cation), its PTFP and APE are fi rst computed based on each HMM corresponding to a speci fi c class (condition). In the testing phase, similar to the nonparametric nearest neighbor approach ( Casimir et al., 2006 ; Duda et al., 2000 ), we will try to the nearest training data in terms of F and E matrices and classify the newly given sequence as the same class that the most similar training data belongs to. To this end, fi rst we de fi ne a similarity measure  X   X  ;  X  for two given E (or F )matricesasfollows:  X   X  E 1 ; E 2  X  X   X  where E 1 and E 2 are two arbitrary E matrices.  X   X  ;  X  computes the summation of element-wise inverted relative difference between the two given matrices as an indicator of similarity. Then, the similarity of the signature with the training sequences used to train those HMMs is assessed based on a similarity scoring function that uses  X   X  ;  X  on the computed PTFP and APE matrices for the given sequence and those matrices previously computed and stored during the training phase. The goal of the similarity scoring function is to assess how similar two sequences are based on their PTFP and APE matrices taking into account that two signatures with high similarity scores must have relatively high similarity measure values in terms of both APE and PTFP. Thus, the similarity scoring function, G ,isde fi ned as multiplication of the two similarity measures based on  X   X  ;  X  in (6) as follows: where y  X  1 : T is the new observation sequence (signature) that has to be classi fi ed,  X  k is the parameter set of the k th HMM, D sponds to the k th condition. F i k , E i k , F k new and E matrices calculated based on k th HMM from the i th training signature, d i , used to train the k th HMM and the given sequence, respectively. After applying the HMMs (parametric phase) on the newly given sequence and computing the corresponding F new E new matrices, the most similar sequence (signature) to the new sequence based on (7) is found from each class (nonparametric phase). The highest similarity score within each class is regarded as the representative similarity score of that class as follows: Q  X  y  X  1 : T  X  X  max the highest score. Thus, the classi fi cation output can be written based on the highest similarity scores found in (8) as
C  X  y  X  1 : T  X  X  arg max f Q 1  X  y  X  1 : T  X  ; Q 2  X  y  X  1 : T  X  ; ... ; where K is the number of classes (conditions) and C  X  y  X  class index that y  X  1 : T is ultimately classi fi ed as based on HMMSNP approach. Fig. 10 schematizes the HMMSNP classi fi cation (testing phase) implemented for fault diagnostics. 6. Preliminary experimental results In this section, three fault diagnosis approaches which are
HMMSNP, the conventional HMM-based approach without SqS preprocessing and HMM-based approach with SqS preprocessing (HMMSqS) are evaluated and compared on a fi xed dataset. The
HMMs in all three approaches are trained on one training set and then tested on another testing set. These approaches are evaluated based on their accuracies and the confusion matrices shown in
Table 2 as well as the exempli fi ed average incurred cost using each approach. To have a fair comparison between the three approaches, the number of hidden state values in all the HMMs is fi xed to 10.

In this section the acquired dataset mentioned in Section 3 is partitioned into training and testing set based on the machine operating speed, the data from all the machine conditions that has been acquired from 15 Hz,17 Hz, ... ,31 Hz is considered as the training set and the rest of the dataset which is acquired from 16 Hz,18 Hz, ... ,32 Hz are regarded as the testing set. 6.1. Classi fi cation accuracy
Table 2 shows the classi fi cation accuracies and confusion matrices for the three aforementioned approaches on the testing set. As expected, the conventional HMM-based approach without the use of squeezing &amp; stretching preprocessing, achieves the least accuracy since it does not consider the differences between the signatures with various rotary speeds within the classes. The second best performance is achieved by the conventional HMM-based approach with the use of SqS preprocessing (HMMSqS), which uni fi es the speed within the signatures by mapping all the different rotary speeds to the highest rotary speed available in the set and scaling their vibration amplitude. Using the SqS preprocessing, the accuracy is signi fi cantly improved comparing to the conventional HMM-based approach by nearly 21%. How-ever, using the log-likelihood as the metric for classi fi misclassify some of the signatures where the log-likelihood fails to capture the signi fi cance of occurrence for some informative transitions in them (e.g. drastic vibration changes). Finally, the
HMM-based semi-nonparametric approach with the use of SqS preprocessing (HMMSNP) has achieved the highest accuracy on the testing set. The HMMSNP improves the classi fi cation accuracy of the conventional HMM-based and the HMMSqS approaches by nearly 28% and 6%, respectively.

Although, it can be seen from Table 2 that HMMSNP has improved the classi fi cation performance on the given testing set, further investigations are carried out in the succeeding section to see whether the improvement is repeatable and statistically signi fi cant. 6.2. Cost analysis
To compare the performance of the three mentioned approaches in terms of fi nancial bene fi t, here we de fi incurred cost matrix which exempli fi es the actual costs that various classi fi cations/misclassi fi cations can lead to. Table 3 shows the postulated costs and required hours of maintenance. The average incurred cost C , which takes into account material cost, downtime cost and man power cost is de fi ned as follows:
C
C
C
C
C
C
C
C
C where all the parameters and their postulated values are listed in Table 3 .

Based on Table 3 , the cost matrix C given in (10) can be evaluated as
C  X 
Table 4 shows the average incurred cost resulted from the three approaches. The cost matrices shown in Table 4 are calculated by element-wise multiplication of the confusion matrices and the average incurred cost matrix C in (11) . It is also shown that the incurred cost would be 148,500 if all the samples were detected correctly. And in case of taking a failure-driven approach (assum-ing that machine is healthy for all signatures) would incur a cost equal to 2,704,500. As it can be understood from Table 4 , in this example, the HMMSNP saves 325,400 and 39,000 compared to
HMM and HMMSqS, respectively. 7. Further investigations &amp; sensitivity analysis
In this section, the ef fi ciency of the proposed approach is further investigated to con fi rm whether it can statistically improve the performance. Moreover, the effect of the signature length and the hyper-parameter value on the classi fi cation accuracy is studied.

For this purpose, different trials are generated by randomly partitioning the whole acquired dataset in Section 3 and the aforementioned three approaches are compared based on the randomly partitioned trials. Assume that the operating speeds are categorized into three, that is, slow: 15  X  20 Hz, medium: 21  X  26 Hz, fast: 27  X  32 Hz. In each trial, two operating speeds out of six within each category are randomly adopted as the testing data and the rest as the training set. The categorization of speeds is done to make sure that all three ranges of speeds would be included within both testing and training set, although they are selected randomly. This investigation is carried out by randomly generating 30 trials out of 15 3 possible combinations (nearly 1% of all possible combinations). 7.1. Overall performance
Here, the three fault diagnostics approaches, which are the conventional HMM classi fi er, HMM-based classi fi er with SqS pre-processing, and the HMM-based semi-nonparametric approach, are examined and compared on the 30 randomly partitioned trials. In all three approaches, the number of the hidden state values in the HMMsisadoptedtobe10andthelengthofthesignaturesis fi xed to six motor rotations (six periods).

Fig. 11 shows the resultant classi fi cation accuracy of the aforementioned approaches on the 30 trials. It can be seen, that the accuracy has been signi fi cantly improved by the use of the SqS preprocessing (from 72.2% for HMM without SqS preprocessing to 87.6%). It can also be identi fi ed that the semi-nonparametric approach has achieved an overall better performance in compar-ison to the other two conventional HMM classi fi ers. A pair-wise t -test on the HMMSqS and the semi-nonparametric approaches indicates that the mean of the resultant accuracies from these two approaches are signi fi cantly different ( P -value  X  1.74e average accuracy using HMMSNP is 92.8% comparing to 87.6% in case of HMMSqS). Thus, the HMMSNP approach improves the
HMM and HMMSqS classi fi cation accuracies in a statistically signi fi cant manner by 28% and 6%, respectively.

Table 5 shows the average computation time required to classify a given signature using each approach in terms of milli-seconds. All the approaches are implemented and run on a same regular PC (Dell-OPTIPLEX 980). As expected by adding the nonparametric phase to the HMM-based classi fi cation approach, the computation time increases. However, the computation time required to classify a new given signature in all three approaches is less than a second that makes them computationally feasible for this task. 7.2. Hyper-parameter sensitivity
Here, the sensitivity of the aforementioned approaches w.r.t. the value of the hyper-parameter, i.e. number of the hidden state values is studied in terms of accuracy and computational cost.
Fig. 12 shows the performance of the three approaches w.r.t. various hyper-parameter values ranged from 2 to 20. Each point of the error bars in Fig. 12 indicates the mean and variance of the classi fi cation accuracies achieved by the approach in the 30 randomly partitioned trials given the speci fi ed number of hidden state values.

As can be seen in Fig. 12 , the performance of all three approaches would generally improves as the number of hidden state values increases. However, this increment in the accuracy is steeper for the smaller values and it starts to reduce for larger values. It can also be seen from Fig. 12 , that except for the case of two hidden state values, HMMSNP outperforms the other two approaches. This indicates that HMMSNP outperforms HMMSqS and conventional HMM classi fi er in fault diagnostics given that an appropriate number of hidden state values is adopted. It is noteworthy that in all three approaches, as the number of hidden state values ( M ) increases the computational complexity increases exponentially with O  X  M 2  X  . Thus, it is important to adopt the smallest number of states that can satisfy the required accuracy.
In this study, based on Fig. 12 , the number of hidden state values used for HMMs in the primary results section, which is 10, shows to be an appropriate value. Thus, the same value is adopted in the succeeding signature length sensitivity analysis. 7.3. Signature length sensitivity
In this part, the sensitivity of the aforementioned approaches w.r.t. the length of the given sequences (signatures) is studied. In
Fig. 13 , the performance of the three approaches is shown in terms of classi fi cation accuracy for various adopted signature lengths.
Each point of the error bars in Fig. 13 indicates the mean and variance of the classi fi cation accuracies achieved by the approach over the 30 randomly partitioned trials given the speci fi of signatures. As can be seen in Fig. 13 , the classi fi cation accuracy increases in all the three approaches up to a certain length and then starts to fl uctuate. This indicates that all three approaches are sensitive to the length of signatures while it is ranged between 1 and 6 rotations, but after passing that range, they become insensitive to the length. In this experiment, the classi accuracy of all three approaches monotonically increases up to the point that signature length is equal to six rotations. To have a fair comparison between the three approaches, the number of the hidden state values is fi xed and set to 10.

It can be seen from Fig. 13 , that except for the 1-rotation length case that is considered as inadequate information since the signa-ture is short, the HMMSNP outperforms the other two approaches in all the other cases. This indicates that HMMSNP can use the underlying information within the data more effectively. It is also noteworthy that the computational cost of all the three approaches increases linearly by increasing the length of signature. 8. Conclusion
In this paper, an HMM-based semi-nonparametric (HMMSNP) fault diagnostics approach is proposed to improve further the classi fi cation accuracy of the conventional HMM-based approach that relies on the log-likelihood. The HMMSNP approach improves the fault diagnostics performance by integrating and taking the advantages of both parametric and nonparametric classi fi approaches. In HMMSNP, based on the parametric HMMs, two matrices named probabilistic transition frequency pro fi le and aver-age probabilistic emission are computed for each signature which can represent the trend of that sequence in states and vibration domains. Furthermore to remedy the dif fi culty of dealing with various operating speeds in the fault diagnostics a preprocessing method named squeezing and stretching (SqS) is introduced. The experimental results indicate that using the SqS processing increases the classi fi cation accuracy in a statistically signi manner by nearly 21%.

The proposed approach is applied to fault diagnostics in a synchronous motor with two types of faults, i.e. bearing fault and unbalanced rotor. Experimental results indicate that the HMMSNP outperforms both the conventional HMM-based classi fi cation approach and the HMM-based classi fi cation with SqS preproces-sing (HMMSqS) by nearly 28% and 6%, respectively. The results from sensitivity analysis indicate that although the number of hidden state values and the length of signature affects the performance of all the approaches, but generally HMMSNP out-performs both the HMM and HMMSqS. Furthermore, it is under-stood from the sensitivity analysis for the length of signature, that vibration signal captured from six rotations of the motor has enough information for fault detection and diagnosis in the synchronous motors.

In future, the proposed fault diagnosis approach can be extended and examined on all types of electromechanical motors.
Moreover, the number of classes considered for diagnostics may be increased to make the experiments more realistic.
 References
