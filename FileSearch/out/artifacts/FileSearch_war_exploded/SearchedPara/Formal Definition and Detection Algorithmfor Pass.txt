 R FID s y stem c on s i sts o ff o ur c o mp on e n ts : tag ,in terr o gat o r , m i dd l e w are a n d app li cat ion. R FID m i dd l e w are ,w h i ch i sa l s on amed R FID edge ser v er ,i safu n-dame n ta lin frastructure w h i ch fac ili tates data a n d in f o rmat ion c o mmu ni cat ion bet w ee n aut o mat i c i de n t i ficat ion ph y s i ca ll a y er a n de n terpr i se app li cat ion s .In R FID m i dd l e w are ,w eca n de vi se R FID bus in ess lo g i c in t o h i erarch i ca l c o mp o s -i te e v e n ta n daut o mate bus in ess pr o cess in gase v e n t detect ion based on CE P ( C o mp l e x E v e n t P r o cess in g )[1] tech nolo g y.

In c o mp l e x e v e n tpr o cess in g , passive event refers t oon ek in d o fc o mp o s i te e v e n t , s o me o f w h o se c on st i tue n tsub -e v e n ts d ono t o ccur u n der certa in c on d i-t ion. In c on trast t o pass iv ee v e n t ,w edefi n e active event as a no ther k in d o fe v e n t w h i ch ca n be detected j ust b yw a i t in gf o r no t i ce o fupc o m in ge v e n t .P r i m i t iv e e v e n t i sthes i mp l est act iv ee v e n t .To pr o cess c o mp l e x R FID bus in ess lo g i c ,in add i t ion t o act iv ee v e n tt y pes ,w emusta l s o be ab l et o defi n ea wi de v ar i et y o fpass iv ee v e n tt y pes wi th r i g o r o us sema n t i cs .M ea nw h il e ,in pass iv ee v e n tde -tect ion pr o cess , R FID m i dd l e w are has t o perf o rm effic i e n tquer i es on e v e n t  X  s abse n ce in ru n t i me c on te x tbes i des w a i t in gf o r no t i ce o fpr i m i t iv ee v e n t o ccur -re n ce .T h o ugh m o st wo rk on e v e n tpr o cess in gpr o p o ses negation operator t o address pass iv ee v e n t i ssues [3, 4 ,5,6, 7 , 8 ,9], w earguethat i t n eeds m o re in-depth e x p lo rat ion in R FID e v e n tpr o cess in g research .

Our c on tr i but ion i sa n e x press iv ea n dr i g o r o us e v e n tdefi ni t ion l a n guage w h i ch espec i a lly w e ll supp o rts spec i f yin gpass iv ee v e n ta n da n effic i e n te v e n t detect ion a l g o r i thm based on P etr in et structure wi th a su i t o f o pt i m i zat ion tech nolo g y f o r rec o g ni z in gpass iv ee v e n t . Our wo rk i sbased on apr o t o t y pe o fR FID m i dd l e w are PKU R FID Edge S er v er (P RE S), a pure J a v am i dd l e w are w h i ch i sc o mpat i b l e wi th AL E [ 2 ]. T he rema in der o fth i spaper i s o rga ni zed as f ollow s .W efirst prese n ta nov er vi e wo fR FID e v e n t in sect ion 2 .S ect ion 3 a n d4 i saf o rma l prese n tat ion o fR FID e v e n tdefi ni t ion l a n guage a n de v e n t detect ion a l g o r i thm respect iv e ly. E x per i me n ta n dd i scuss ion i sdem on strated in sect ion 5, f ollow ed b y ac on c l us ion in sect ion 6. RFID Event i sthespec i ficat ion o fs i g ni fica n t o ccurre n ce in o rar o u n dR FID m i dd l e w are .T here are t wo k in ds o fR FID e v e n t : primitive event a n d composite event .W he n a tag passes thr o ugh the ra n ge o ftra n sm i ss ion, o rthr o ugh the gate -w a yo faR FID reader ,i tge n erates a ser i es o f  X  tag i ssee n X  e v e n ts .T hese e v e n ts are in sta n ta n e o us a n dat o m i c ,w h i ch f o rm ma in pr i m i t iv ee v e n tstream flowin g in t o R FID m i dd l e w are .Ano ther k in d o fpr i m i t iv ee v e n t i s messages se n tb y e x-ter n bus in ess app li cat ion w h il ee x ecut in gapart i cu l ar step o f bus in ess pr o cess . C o mp o s i te e v e n tt y pes are aggregated e v e n tt y pes that are created b y c o mb inin g o ther pr i m i t iv e o rc o mp o s i te e v e n tt y pes us in gaspec i fic set o fe v e n t o perat o rs such as d i s j u n ct ion, c onj u n ct ion, seque n ce , etc [10]. In th i spaper ,w e will use cap i ta ll etters li ke E a n d A t o represe n t ( c o mp o s i te o rpr i m i t iv e ) event type , w h il eusec o rresp on d in g low ercase l etters e a n d a t o represe n t event instance . T he e v e n tt i me o fe v e n t in sta n ce e i sat i me in ter v a l represe n ted b y[ e  X  ,e  X  ]. In ac l ear c on te x t ,w e will sa y event t o represe n t event type .W e use subscr i pt t o d i st in gu i sh d iff ere n t in sta n ces o fthesamee v e n tt y pe li ke e 1 a n d e 2 a n duse e x press ion li ke E ( t, t ) t o represe n ta nin sta n ce o f E o ccurs ov er the in ter v a l [ t, t ]. Fo rs i mp li c i t y, w e assume e v e n tt i me i sd i screte . Mo st e v e n tdefi ni t ion l a n guage will pr o p o se a set o fe v e n t o perat o rs li ke con-junction , disjunction a n d sequence .How e v er , there i sst ill no sta n dard l a n guage e xi sts f o r descr i b in ga ll c o mp o s i te e v e n ts p o ss i b l et o detect .S tart in gfr o mc o m -m on c o mp o s i te e v e n ts abstract fr o m bus in ess lo g i c o fR FID app li cat ion s li ke m oni t o r in ga n d supp ly-cha in ma n ageme n t ,w epr o p o se a n e v e n tdefi ni t ion l a n-guage f o r P RE S, w h i ch a i ms t o pr ovi de a w e ll supp o rt f o rpass iv ee v e n t .Sin ce w ema inly f o cus on the defi ni t ion a n d detect ion o fpass iv ee v e n t ,w ed ivi de e v e n t o perat o rs in t o active event operator a n d passive event operator ,in stead o fd i-vi d in gthem in t o temporal event operator a n d logic event operator .No te that c o mp l e x pass iv ee v e n tt y pe defi ni t ion ma y be embedded wi th b o th act iv ee v e n t o perat o ra n dact iv ee v e n t o perat o r .
T h o ugh o ur c on cer ni spass iv ee v e n t ,w eprese n tf o ur act iv ee v e n t o perat o rs f o r the sake o fc o mp l ete n ess o fe v e n tdefi ni t ion l a n guage .M ea nw h il e , pass iv ee v e n t ca n be defi n ed b y c o mb inin gpr i m i t iv ee v e n tus in gb o th pass iv ee v e n t o perat o r a n dact iv ee v e n t o perat o r .Fo rma l sema n t i cs o fact iv ee v e n t o perat o rs i sdefi n ed as f ollowin g :
E = A &amp; B : E ( t, t )  X  X  X  t 1 ,t 2 ,t 1 ,t 2 ( A ( t 1 ,t 2 )  X  B ( t 1 ,t 2 )  X  t = min ( t 1 ,t 1 )  X  t = E = A | B : E ( t, t )  X  A ( t, t )  X  B ( t, t ) E = A  X  B : E ( t, t )  X  X  X  t 1 ,t 1 ( A ( t, t 1 )  X  B ( t 1 ,t )  X  t 1 &lt;t ) E = w ( A, T ): E ( t, t )  X  t  X  t  X  T  X  A ( t, t )
P ass iv ee v e n t o perat o r i susedt o e x press abse n ce o fs o me e v e n tu n der s o me certa in c on d i t ion s .No matter defi nin g n egat ion o perat o rasb in ar yo rter n ar y o perat o r , the esse n ce i s i mp o s in gstr on ger c on stra in ts on e v e n tabse n ce .F r o m the perspect iv e o fe v e n t detect ion, these c on stra in ts actua lly te ll e v e n t detect ion e n g in e w he n t o check the abse n ce o fthec o rresp on d in ge v e n t .T hus ,w e n eed a m o re fl e xi b l emecha ni sm t o spec i f y c on stra in t on e v e n tabse n ce .W epr o p o se s ix pass iv ee v e n t o perat o rs f o rR FID app li cat ion.

W e assume there i sastartt i mestamp t 0 , a n ddefi n e Phi ( T ) as a seque n ce o ft i mestamp ,w here Phi ( T,i )= t 0 + T  X  i .U s in g  X  ( A, t, t ) t o de no te that  X  t o perat o rs as f ollowin g : E = AB : E ( t, t )  X   X  ( A, t, t )  X  B ( t, t ) E = bef ore ( A, B, T ): E ( t, t )  X  X  X  t 1 ( t  X  t 1 = T  X   X  ( A, t, t 1 )  X  B ( t 1 ,t )) E = af ter ( A, B, T ): E ( t, t )  X  X  X  t 1 ( t  X  t 1 = T  X   X  ( A, t 1 ,t )  X  B ( t, t 1)) E = between ( A, B, C ): E ( t, t )  X  X  X  t 1 ,t 2 ( t 2  X  t 1 &gt; 0  X   X  ( A, t 1 ,t 2 )  X  B ( t, t 1 )  X  E = between ( A, T 1 ,T 2 ): E ( t, t )  X   X  ( A, t, t )  X  t = T 1  X  t = T 2 E = between ( A, T ): E ( t, t )  X  X  X  i&gt; 0( t =  X  ( T,i  X  1)  X  t =  X  ( T,i )  X   X  ( A, t, t ))
T ake E = between ( A, B, C ) as a n e x amp l e , g iv e n B o ccurs in the t i me in ter v a l [ t, t 1 ] a n d A o ccurs in the t i me in ter v a l[ t 2 ,t ], i f t 1 &lt;t 2 a n dthere i s no A in sta n ces w h o se e n dt i mestamp fa ll in t o the t i me in ter v a l[ t 1 ,t 2 ], w esa y E o ccurs a n dthet i me in ter v a lo fth i se v e n t in sta n ce i s [ t, t ]. Sin ce i t i srather n atura l t o represe n tc o mp l e x e v e n tus in g P etr in et because o f i ts h i erarch y a n dc on curre n c y pr o pert i es ,w epr o p o se a P etr in et structure -based e v e n t detect ion a l g o r i thm .I t i sstra i ghtf o r w ard t o use place t o represe n te v e n t t y pe , use transition t o represe n te v e n t o perat o ra n duse token t o represe n te v e n t in sta n ce .How e v er , us in g P/T s y stem o rc olo red P etr in et [11] t o m o de l c o mp l e x pass iv ee v e n t will make the n et structure qu i te c o mp li cated .T hus ,in stead o f des i g nin ga n e wn et s y stem e x te n ded fr o m P/T s y stem o rc olo red P etr in et ,w e pr o p o se a set o f P etr in et -li ke structures based on te n e v e n t o perat o rs ,w h i ch are ill ustrated as in figure 1.

S tructures sh own in figure 1 are bas i cc o mp on e n ts o fm o re c o mp li cated struc -ture f o rh i erarch i ca l c o mp o s i te e v e n ta n d w eca ll them basic net .No te that in bas i c n et ,w euse inhibit arc t o c onn ect the e v e n t ( p l ace )w h i ch n eeds t o check abse n ce .W eca ll th i sk in d o fe v e n t negated event .Fo re x amp l e ,in c o m -p o s i te e v e n t E = between ( A, B, C ), A i sa n egated e v e n t .Fo reachc o mp o s -i te e v e n t ,w etra n sf o rm e v e n tdefi ni t ion t o a n abstract grammar tree ,w h i ch i s fi n a lly tra n sf o rmed t o a P etr in et -li ke structure .I fap l ace has no pre tra n s i-t ion s ,w eca ll i t input place ; a n d i fap l ace has no p o st tra n s i t ion s ,w eca ll i t output place .

In a n et structure ,in put p l ace represe n ts pr i m i t iv ee v e n t ,o utput p l ace rep -rese n ts c o mp o s i te e v e n t . Each k in d o ftra n s i t ion i sass o c i ated wi th a spec i a l fir in gru l e , acc o rd in g w h i ch c o mp o s i te (o rsub -c o mp o s i te ) e v e n t in sta n ces i s ge n erated .So based on P etr in et -li ke structure , t o descr i be e v e n t detect ion a l-g o r i thm ,w e j ust n eed t o descr i be h ow each k in d o ftra n s i t ion p l a y the t o ke n game .

T he detect ion pr o cess i s li ke th i s :in put p l aces w a i tf o r no t i ficat ion o fpr i m i t iv e e v e n t in sta n ces , a n dtra n s i t ion sp l a y t o ke n games acc o rd in gt o c o rresp on d in gfir -in gru l e ;on ce a t o ke ni sge n erated in o utput p l ace , ac o mp o s i te e v e n t in sta n ce i s detected .So, the w h ol e detect ion a l g o r i thm i sactua lly d ivi ded in t o te n k in ds o ffir in gru l es ass o c i ated wi th e v e n t o perat o rs .Fi r in gru l es in c l udes no t only c on d i t ion check in g on t o ke n s but a l s o quer y p l a n s . Each in h i b i tarcass o c i ated wi th pass iv ee v e n t o perat o rrequ i res a quer y p l a n t o check abse n ce o fthec o rre -sp on d in ge v e n t .
 To o pt i m i ze quer y p l a n, w e in tr o duce the f ollowin gt wo quer y fu n ct ion s ,w here N represe n ts non-n egat iv e in teger .  X  : PE  X  X  N,  X  1 } .  X  ( A ) retr i e v es the e n dt i mestamp o f l atest A in sta n ce .I f  X  : PE  X  N  X  N .  X  ( A, t ) retr i e v es the n umber o f A in sta n ces bef o re a W h il ep l a yin gthet o ke n game , each p l ace will h ol dat o ke n c oll ect ion represe n t c o rresp on d in ge v e n t in sta n ces .To ke n c oll ect ion usua lly ca nno tbesharedbe -cause o fd iff ere n te ff ect o fc on sumpt ion p oli c y. Sin ce t o ke n s in n egated p l ace will no tbec on sumed w h il etra n s i t ion fir in g ,w eca no pt i m i ze detect ion effic i e n c y b y shar in gt o ke n c oll ect ion o fthesame n egated p l ace t y pe .To ke n c oll ect ion o f n egated p l ace i susedt o check abse n ce o fe v e n t , s o there i s no n eed t o keep a ll n egated e v e n t in sta n ces .A m on gthes ix bas i c n et o fpass iv ee v e n t o perat o rs ,w e n eed only keep the l atest n egated e v e n t in sta n ce in detect ion pr o cess e x cept o p -erat o r bef ore ( A, B, T ) g iv e n that B i sac o mp o s i te e v e n tt y pe .In that s i tuat ion, w e n eed t o keep a ll A in sta n ces f o rquer y fu n ct ion  X  .W he n a B in sta n ce b i s detected a n d  X  ( A, b  X  )=( A, b  X  + T ), on e E in sta n ce i s detected . To e v a l uate o ur wo rk ,w emakeac o mpar i s on wi th Esper [ 8 ]w h i ch i sa no pe n s o urce c o mp on e n tf o rCE P a n dE SP ( E v e n t S tream P r o cess in g ) app li cat ion s . No te the c o mpar i s on i s only ab o ut CE P part o fEsper . Equ iv a l e n ce o fsema n t i cs o fe v e n tt y pe i saf o u n dat ion o fperf o rma n ce c o mpar i s on, s in ce the n umber o f detected e v e n t in sta n ce ma yv ar y e no rm o us ly f o rt wo s i m il ar but no tequ iv a l e n t e v e n tt y pes .How e v er , defi nin gequ iv a l e n tact iv ee v e n tt y pes i smucheas i er , s oin th i spaper w emakeaperf o rma n ce c o mpar i s on wi th Esper based on act iv ee v e n t t y pes .Fo rpass iv ee v e n tt y pes ,w echeckede v e n tpr o cess in gt i me v ersus the n um -ber o fpr i m i t iv ee v e n ts .T he hard w are e nvi r on me n tf o rperf o rma n ce e v a l uat ion i s In te lP e n t i um IV C PU at 2 . 4G H za n d 1 G B R AM .T he o perat ion s y stem i s Win d ow s XP P r o fess ion a lwi th JDK 1.6.0 05. W ege n erate pr i m i t iv ee v e n tata rate o f 1000 per sec on ds , a n dpr o cess 2 0 e v e n tt y pes in para ll e l each t i me . E x per -i me n tresu l t i s ill ustrated in figure 2 a n dfigure 3. E x per i me n tresu l tsh ow sthat o ur a l g o r i thm i seffic i e n tf o rb o th act iv ee v e n tt y pe a n dpass iv ee v e n tt y pe .A m o re matured c o mpar i s on strateg y f o rpass iv ee v e n t i s on e o f o ur future wo rks . P ass iv ee v e n t i s on ec o mm on k in d o fe v e n t in R FID m i dd l e w are ,w h il e i ts defi ni t ion faces s o me lo g i cd i fficu l t i es a n de x press iv e n ess pr o b l ems .Ai m in gat e x press in ga wi de v ar i et yo fR FID bus in ess lo g i c wi th r i g o ur o us sema n t i cs ,w e des i g n a n e v e n tdefi ni t ion l a n guage embedded wi th a set o fpass iv ee v e n t o per -at o rs a n dact iv ee v e n t o perat o rs ,o f w h i ch sema n t i cs i sspec i fied f o rma lly. Our l a n guage espec i a lly w e ll supp o rts spec i f yin gc o mp l e x h i erarch i ca l pass iv ee v e n t . W epr o p o se a P etr in et structure -based e v e n t detect ion a l g o r i thm wi th effic i e n t quer y p l a no rga ni zat ion f o rpass iv ee v e n t . E x per i me n tsh ow s that detect ion a l-g o r i thm i seffic i e n ta n dsca l ab l e .T ech nolo g y prese n ted in th i s research has in te -grated in t oo ur J a v a -based R FID m i dd l e w are .

