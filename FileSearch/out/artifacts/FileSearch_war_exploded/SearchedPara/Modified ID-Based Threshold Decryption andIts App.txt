 Chai, Cao and Lu [7] recently defined a s ecurity model for ID-based threshold decryption without random oracles and gave a construction. Their approach is based on an efficient selective ID-based encryption scheme (sIBE) [2] that was proved to be selected-ID secure against chosen plaintext attack without random oracles. However, to ensure correctness of their ID-based threshold decryption scheme, it is necessary to guarantee that the shared decryption is performed the encrypted ballots are anonymous through the use of an anonymous channel, a proof of correct decryption.

We modify the ID-based threshold decryption scheme,  X  X dThD X  of Chai et mediated ID-based encryption scheme without random oracles as an application of IdThD. Most ID-based mediated schemes [6,9] are based on the IBE [5], and security are proved under the random oracle model. Motivated by sIBE [2], we construct the first mediated ID-based encryption scheme without random oracles. authority PKG (Private Key Generator), who is charge of issuing private key or servers  X  i ( i =1 ,...,n ) under a single public identity ID .TheIdThDscheme consists of the following algorithms Setup , KeyGen , Encrypt Combine . To ensure correctness, it is necessary to guarantee that the shared decryption is performed correctly through some public verification functions, system of the equality of two discrete logarithms used in [8] for a signature scheme. We now modify Decrypt and Combine algorithms in Chai et al. X  X  scheme into three algorithms DShareGen , DShareVerify and as follows.  X  Setup. Given a security parameter k , the PKG chooses groups prime order q ,agenerator g  X  G , a bilinear map  X  e : G  X  G  X  G x, y, z uniformly at random from Z  X  q and computes X = g g . The system X  X  public parameters are params = &lt; G , G 1 while the master key ( x, y, z ) is kept secret by the PKG.  X  KeyGen. Givenanidentity ID , the number of decryption servers n and a threshold parameter t , the PKG picks randomly a polynomial over Z F ( u )= z + t  X  1 i =1 u i a i ,where a i  X  Z  X  q .Itpicks r K shared private key sk i =( r i ,K i ) and verification keys vk  X  Encrypt. To encrypt a message M  X  G pick a random s  X  Z  X  q and output ciphertext C =( A, B, C, D )= ( g s  X  ID X s ,Y s ,  X  e ( g, Z ) s  X  M, H ( A, B, C ) s ), where H :  X  DShareGen. To compute a decryption share  X  i,C of the ciphertext C = ( A, B, C, D )usingitsprivatekey sk i =( r i ,K i ), each decryption server  X  does the following: 1. Computes H = H ( A, B, C )andchecksif X  e ( g ID X, D )= X  e ( A, 2. If C has passed the above test, computes k i = X  e ( AB  X  DShareVerfy. Given a ciphertext C =( A, B, C, D ), a set of verification keys { vk 1 ,...,vk n } , and a decryption share  X  i,C , a dealer computes H ( A, B, C )andchecksif X  e ( g ID X, D )= X  e ( A, H )and X  e ( Y, D )= X  e ( B, If C has passed the above test then a dealer does the following: 1. If  X  i,C is of the form ( i,  X  Invalid Ciphertext  X ) then returns  X  Invalid 2. Else parses  X  i,C as ( i, k i ,t i 1 ,t i 2 ,vk i ,c Otherwise, does the following:  X  DShareComb. Given a ciphertext C and a set of valid decryption shares {  X  j,C } j  X   X  where |  X  | X  t , a dealer computes H = H ( A, B, C )andchecks if  X  e ( g ID X, D )= X  e ( A, H )and X  e ( Y, D )= X  e ( B, above test, the dealer returns  X  Invalid Ciphertext  X . Otherwise, he computes to construct a mediated ID-based encr yption scheme. Libert and Quisquater showed that the SEM architecture in a mRSA [4] can be applied to the Boneh-Franklin identity-based encryption and GDH signature schemes [9]. However, attack in a weaker sense. Here  X  X eak X  m eans that attackers are not allowed to obtain the user part of private key. Baek and Zheng proposed a mediated ID-based encryption scheme which is secure against ciphertext attack in a strong attacker who obtains the user part of private key.

We describe our mediated ID-based encryption scheme without random ora-cles, which is based on the Chai et al. X  X  IdThD scheme. Our scheme consists of the following algorithms. 1.
 Setup. Given a security parameter k , the PKG chooses groups of prime order q ,agenerator g  X  G , a bilinear map  X  e : Then it picks x, y, z uniformly at random from Z  X  q and computes X = g Y = g y ,and Z = g z . The system X  X  public parameters are params = &lt; G PKG. 2.
 KeyGen. Given a user of identity ID , the PKG picks randomly a z and computes z sem = z  X  z user . It computes d ID,sem = g d the SEM and d ID,user to the user. 3.
 Encrypt. Given a plaintext M  X  G a ciphertext C =( A, B, C ) such that: A = g s  X  ID X s ; B = Y M, where a random s  X  Z  X  q .
 4.
 Decrypt. When receiving C = &lt; A,B,C &gt; , a user forwards it to the SEM. They perform the following steps in parallel: (a) SEM: Checks if the user X  X  identity ID is revoked. If it is, return  X  X D Re-(b) USER: Computes k user = X  e ( AB r 2 ,d ID,user ). When receiving k Our scheme is secure against chosen plaintext attack and not against chosen ciphertext attack, because it do not us e random oracles. As Baek and Zheng the chosen ciphertext attack by using a mechanism for checking the validity of a ciphertext. without random oracles denoted by mHIBE. This mediated HIBE is obtained vectors of elements in Z l q and denote by ID l =( I 1 ,...,I 1.
 Root Setup. Given a security parameter k , the PKG chooses groups G 1 of prime order q and a bilinear map  X  e : random generator g from G  X  and  X  user ,  X  sem from Z  X  q elements g 2 ,g 3 ,h 1 ,h 2 ,...,h l from G . Then it computes  X  =  X  and sets g 1 = g  X  and g 4 = g  X  2 . The public parameters and the master key are params =( g, g 1 ,g 2 ,g 3 ,h 1 ,...,h l ) ,mkey = g 4 2.
 KeyGen. To generate the private key d ID ( I 1 ,...,I k ) To generate the private key d ID k ,sem for an identity ID of depth k  X  l , picks a random r sem  X  Z q and outputs d 3.
 Encrypt. To encrypt a message M  X  G ( I 1 ,I 2 ,...,I k ) 4.
 Decrypt. When receiving CT = &lt; A,B,C &gt; , a user forwards it to the SEM.TheSEMchecksiftheuser X  X identity ID k is revoked. If it is, re-d and sends  X  ID k ,sem,C =( sem k ,k sem,k ) to the user. He computes k the private key d ID k ,user =( a 0 , a 1 , b k +1 , ... , b  X 
ID k ,sem,C is of the form ( sem k ,  X  ID Revoked  X ) then he returns  X  X rror X  and terminates. Otherwise, he computes k = k sem,k  X  k user,k M = A  X  k .
 communities of users whose privileges change very dynamically as Nali et al. X  X  mHIBE scheme [10] does. In this paper, we analyzed an weakness of the Chai et al X  X  ID-based threshold decryption scheme and modified it to improve the security. We also showed how an ID-based threshold decryption scheme without random oracles can result in a mediated ID-based encryption scheme wi thout random oracles. As one possible extension of our scheme, we proposed a hierarchial ID-based encryption scheme. More work is needed to be finding more security applications where mediated ID-based encryption is particular useful.

