 some kind of analysis that is more sophisticated than simple summarization. Knowing which transactions are relevant to understanding a particular customer's current behavior may also be difficult. All transactions over the past 90 days may be relevant for a stable customer, but transactions more than a week old may be irrelevant for a fast-paced customer who changes behavior quickly. Analyzing a customer's past transactions for relevance at the time of a query is imprac-tical, though. 
Despite the challenges, our goal is to process a stream of transactions as it arrives to build multidimensional sum-maries (features) of customer behavior that are good enough for customer profiling or for providing approximate answers to queries about current customer behavior. For example, we would like to be able to provide up-to-date answers to such questions as how many callers make more than 100 minutes of calls per month, and for those that do what is the median number of calls? Such questions lie at the heart of exploratory data analysis and data mining, but they can-not be answered quickly enough for interactive data analysis unless customer behavior can be tracked efficiently and ac-curately from a stream of transactions. 
Sections 2 and 3 describe a statistically principled way to track customer behavior online with a transaction stream. The basic idea is to build and maintain an up-to-date, com-pact approximation of the full, multi-dimensional distribu-tion that describes which transactions a customer is likely (or unlikely) to make now. We allow dependencies among transaction variables, so that the size of a purchase may de-pend on the time of the purchase, for example. The struc-ture of the approximate distribution, including the relation-ships among transaction variables, is chosen to optimize a new criterion that is appropriate when the main goal is in-ference or prediction about a set of customers rather than about an entire database of transactions. 
Section 4 then shows how an initial approximate distri-bution can be assigned to a new customer who has made only a few transactions. A novel feature of the initializa-tion procedure is that the principles underlying the design of the customer summary justify initializing each compo-nent or dimension of the summary separately, giving an ex-tremely rich set of summaries that can be assigned to new customers. The initial summary then evolves as the cus-tomer makes more transactions, so that each customer may eventually move to a customer segment of size one. The initialization procedure we propose is simple to implement, but somewhat cumbersome to explain. The details of the procedure can be skipped without loss of continuity. A call record can be represented by a vector X = (X1,... , Xk) of one-dimensional variables, where X1 might be call duration, X2 call timing (day-of-week or hour-of-day), Xz time since last call, and so on. Some variables, such as duration, are explicit in the transaction record. Oth-ers, such as time since last transaction, are derived from the current and preceding records. A model of calling behav-ior is a multivariate distribution P(X) that describes which calls are likely and which are unlikely. The goal of customer tracking, then, is an approximation of P(X) that is accurate at the time of the current transaction. Note that the goal is not to reproduce tile customer's raw data, as it is in some database applications, but to assess tile customer's current behavior. The full multivariate distribution for a customer is which is a product of one-dimensional marginal and condi-tional distributions. (The same product is obtained regard-less of which of the M variables is assigned to X1, which is assigned to X2, and so on.) Including all terms in the product requires modeling all possible relationships among all variables for each customer, which is clearly impossible to do well with limited data even with no space limitations. So, we use only a subset of the possible marginal and condi-tional distributions in the product (1) to approximate In other words, no variable X~ is allowed to depend on all other variables, which is not an unreasonable constraint in practice. We do impose one strong constraint, however: the same subset of distributions must be used for all customers. For example, if call duration is conditioned on time-of-day for some customers, then it must be conditioned on time-of-day for all customers. Forcing all customers to have the same kind of approximation makes it easier to update the approximation because otherwise the structure of the ap-proximation, and not just the shape of each one-dimensional distribution in the approximation, would have to be learned as the customer makes transactions. The approximation to P(X) is called a signature, and each one-dimensional marginal and conditional distribution in the approximation is called a signature component. Each signature component can be thought of as a feature vector for the customer. 
There are two important steps in designing a signature: the distribution in each signature component of P(X) be modeled and a subset of the terms in the product (1) must be selected. The first task is more straightforward. Each dis-tribution is modeled by either a small set of probabilities or a small set of quantiles; i.e, by either a fixed-width histograzn or a fixed-depth histogram. Histograms are nonparametric, so they are appropriate for a wide range of customers, simple to update, and easy to understand. In principle, using other kinds of approximations instead of a vector of probabilities or quantiles would also be straightforward, though. 
The optimal set of conditional variables for approximat-ing tile full distribution of any signature variable X~ may vary across customers. For example, Customer 1 may tend to talk longer on outgoing calls than on incoming calls, but Customer 2 may not, so ideally duration would be condi-tioned on direction for Customer I but not Customer 2. Yet, we have to condition duration on direction for all customers or none. This is not a standard model selection, Bayes Net, 306 that are unrelated to Xk,... , XM. Also, the procedure here can handle signatures that are not based on histograms by replacing the X 2 test with another test that is appropriate for the structure of the signature component. 
A key feature of a signature is that it can be updated whenever the customer makes a transaction, which allows the signature to evolve. For example, consider a standard, fixed-width histogram that has bucket probabilities p~,,~ af-ter call n, and suppose call n + 1 is represented by a vector 
Zi,,+x that is zero in every bucket except the one that con-tains the observed value for call n + 1. Then with exponen-tially weighted moving averaging, the updated bucket prob-abilities are Pi,~,+l = (1-w)p~,,~+wZ~,,,+l, where 0 &lt; w &lt; 1 is a weight that controls how fast old calls are aged out. 
With larger w, a calling pattern adapts more quickly to changes but is more variable because the effective sample size is smaller. Variants of exponentially weighted moving averaging have been developed for incrementally updating quantiles [3] and histograms of chronological variables [6]. 
Variants for top-seller kinds of histograms are considered in [4], for example. 
Transaction-by-transaction updating requires a starting point, so an initial signature has to be assigned to a cus-tomer. This task resembles customer segmentation, in the sense that there is a set of initial signatures (or customer seg-ments) and the customer is assigned to one of them based on the information available at the time of the assignment. In our approach, however, the customer may belong to many segments, one for' each signature component. For example, the initial distributions for incoming call duration and out-going call duration can be assigned independently in our model because the signature is a product. Independent as-signment for different signature components allows a huge number of different initial signatures. 
Suppose that the signature component for X conditional customer i and that the initial values of p~ are "filled in" according to rules that depend on a set of index variables 
Z that are computed from customer i's first few or several transaction records. Thus, each value of Z points to a rep-resentative signature component rz = (rz,1,... ,rz,K) for 
X conditional on Y. The goal is to find rules so that rz is close to p, for each customer i in a training set. 
As in signature design, candidate index variables are added sequentially until the incremental benefit from adding any remaining candidate is insignificant. To start, suppose the histogram for X conditional on Y has K buckets, the can-didate index variable Z has J levels labeled 1,... , J, and no index variable has been chosen yet. Then index selection has the following steps. 1. Suppose there are Nj customers in the training set 2. Compute the average histogram ~hj = (thjj,... ,i~,g) 307 
The final representative signature corresponding to index variables Z for the signature component for X conditional on Y is then computed as follows. 1. Identify customers in the training set with Y = y and 
Z=z. 2. Find Pi, the signature component of X conditional on 
Y = y, for each customer i identified in Step 1. 3. Set rz = (rz,1,... ,rz,K) equal to the average of the components found in Step 2. If there are nz such customers, then 4. The representative signature component is then where the subscript j now denotes the jth possible value of the index variables Z. 
Our experiment is based on 18.23 million wireless call records for a sample of 95,893 customers who made at least 30 calls (some of which were only attempted and not com-pleted) over a three month period. These customers have a wide range of calling patterns, as Table 1 shows. Calls 30 61 116 207 131,447 190 Minutes 2 67 131 308 97,979 295 Days 1 76 82 85 89 77 Table 1: Per customer statistics for the study data. 
Seven variables were derived from each call record: Direc-tion (Incoming/Outgoing), Service Provider (Local/Roaming), 
Status (Completed/Attempted), Features (None/Call Wait-ing and/or Call Forwarding), Day-of-Week, Hour-of-Day (dis-cretized to nine intervals), and Duration of completed calls (represented by tile .1, .25, .5, .75, .9, .95 quantiles and the minimum and maximum). 
The procedure for designing signatures described in Sec-tion 2 gives signatures with 14 components. Direction and 
Features are unconditional, Day-of-Week and Hour-of-Day are conditioned on Provider only, Provider and Status are conditioned on Direction only, Duration is used only for completed calls and is conditioned on Direction and Provider. 
As always, the procedure for designing signatures produces signature components that describe a valid multidimensional probability distribution. 
A customer identifier and the total number of calls are also kept in tile signature. In all, the raw call records (with only the variables used in this study) fill 640 MB; the signatures fill 20 MB or about 3% of the space required by the raw data. No effort was made to save space by quantizing prob-abilities or removing components of the signature for which the customer had no calls. For example, day-of-week and hour-of-day components were kept for roaming calls even if the customer had no roaming calls. during lunch (11:30 am to 1:30 pm) 
Signatures can be updated sequentially, using fast proce-dures that require only the current signature and the current transaction. Incremental updating based on exponentially weighted moving averaging is particularly important with dynamic databases, in which individuals may change their behavior over time. The adaptive updating allows the sig-nature to track evolving behavior. 
We show that the signature database can be used for fast and accurate approximate query answering, at both the transaction and customer levels. This makes online ex-ploratory data analysis possible, even for huge number of customers, because signatures can be small enough to be maintained in main memory. Because signature databases have one record per customer, they are easily merged with other customer databases, and the expanded database can be used for more in-depth analysis and prediction of cus-tomer behavior. Signatures can also be thought of as a way to do automatic, multivariate feature extraction for cus-tomers without first summarizing the data (and perhaps los-ing interesting information). 
This paper has explored the use of signatures for answer-ing queries quickly and reliably, but only approximately. Queries are an important part of good exploratory data anal-ysis. Other possibilities, which we have not yet explored, include using signatures as features in cluster and discrim-inant analysis, classification trees, or logistic regression, for example. In data mining applications, signatures may also enable good, quick association rules at the customer rather, than at just tile transaction level. [1] A. Agresti. Cate9orical data analysis. John Wiley &amp; 
Soils, New York, NY, 1990. [2] D. BarbarA, W. DuMouchel, C. Faloutsos, P. J. Haas, J. M. Hellerstein, Y. Ioannidis, H. V. Jagadish, T. Johnson, R. Ng, V. Poosala, K. A. Ross, and K. C. 
Sevcik. The New Jersey data reduction report. Bulletin of the Technical Committee on Data Engineering, 20(4):3-42, 1997. [3] F. Chert, D. Lambert, and J. C. Pinheiro. Incremental quantile estimation for massive tracking. In Proceedings of KDD-2000, pages 516-522, 2000. [4] P. B. Gibbons, Y. E. Ioannidis, and V. Poosala. Fast incremental maintenance of approximate histograms. In 
Proceedings of the P3rd VLDB Conference, pages 466-475, 1997. [5] I. Grabec. Modelling of chaos by a self-organizing neural network. In K. Makisara, O. Simula, and J. Kangas, editors, Artificial Neural Networks, Proceedings of ICANN, volume 1, pages 151-156. 
Elsevier Science Publishers, 1991. [6} D. Lambert, J. C. Pinheiro, and D. X. Sun. Updating timing profiles for millions of customers in real-time. 
Journal of the American Statistical Association, 96(453):316-330, 2001. 
