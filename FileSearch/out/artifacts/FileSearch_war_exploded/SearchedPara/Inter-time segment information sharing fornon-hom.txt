 standard assumption underlying DBNs is that time-series ha ve been generated from a homogeneous erroneous conclusions. While there have been various effort s to relax the homogeneity assumption ing room for further methodological innovation. The method proposed in [3, 8] is non-Bayesian. with time. This assumption is too rigid when looking at proce sses where changes in the overall regulatory network structure are expected, e.g. in morphog enesis or embryogenesis. The method These limitations are addressed in [6, 7], where the authors propose a method for continuous data addresses the principled shortcomings of the three Bayesia n methods mentioned above. Unlike [1], data. Unlike [2], our model allows the network structure to c hange among segments, leading to greater model flexibility. As an improvement on [6, 7], our mo del introduces information sharing among time series segments, which provides an essential reg ularization effect. This section summarizes briefly the non-homogeneous DBN pro posed in [6, 7], which combines the Bayesian regression model of [10] with multiple changep oint processes and pursues Bayesian inference with reversible jump Markov chain Monte Carlo (RJ MCMC) [11]. In what follows, we will refer to nodes as genes and to the network as a gene regula tory network. The method is not restricted to molecular systems biology, though. 2.1 Model Multiple changepoints: Let p be the number of observed genes, whose expression values y = defined by a set of directed edges among the p genes. M regulatory relationships among the genes, defined by M , may vary across time, which we model with a multiple changepoint process. For each target gene i , an unknown number k define k stops before  X  h different structures M h satisfied by ordering the changepoints based on their positi on in the time series. Regression model: For all genes i , the random variable Y time t . Within any segment h , the expression of gene i depends on the p gene expression values measured at the previous time point through a regression mod el defined by (a) a set of s h denoted by M h ( where the noise  X  We define a h 2.2 Prior The k Poisson random variable with mean  X  and maximum k = N  X  2 : P ( k on k tions for the k and all segments h , the number s h mean  X  and maximum s = 5 : P ( s h The overall prior on the network structures is given by margi nalization:
Conditional on the parent set M h where the symbol  X  denotes matrix transposition,  X  and each ( j + 1) th column contains the observed values ( y in the variance (  X  h set the hyper-hyperparameters for shape,  X  a vague distribution. The terms  X  and  X  can be interpreted as the expected number of changepoints 2.3 Posterior Equation (1) implies that have been defined above: 2.4 Inference the posterior distribution of (5) is analytically tractabl e: P ( k,  X , M ,  X ,  X  ,  X  2 | y ) with RJMCMC [11]. A detailed description can be found in [6, 1 0]. Allowing the network structure to change between segments l eads to a highly flexible model. How-embryogenesis, we would assume that the network evolves gra dually and that networks associated with adjacent time intervals are a priori similar.
 To address these problems, we propose three methods of infor mation sharing among time series the nodes, using the exponential distribution proposed in [ 13]. The second scheme is also based by a soft information coupling scheme. 3.1 Hard information coupling based on an exponential prior Denote by K and recall that each time series segment y h . We impose a prior distribution P ( M h distribution factorizes according to a Markovian dependen ce: Similar to [13] we define for h  X  2 , where  X  is a hyperparameter that defines the strength of the coupling between M h tion function can be simplified: Z (  X  )  X  Q p in Section 2.4. When proposing a new network structure M h introduced for sampling the hyperparameter  X  from the posterior distribution. For a proposal move the hyperprior P (  X  ) was chosen as the uniform distribution on the interval [0 , 10] . 3.2 Hard information coupling based on a binomial prior An alternative way of information sharing among segments an d nodes is by using a binomial prior: where we have defined the following sufficient statistics: N 1 that are matched by an edge in M h edge in M h is the number of coinciding non-edges in M h  X  1 joint distribution can be expressed as: where we have defined N l
P ( {M h i }|  X ,  X ,  X ,  X  ) = Z Z P ( {M h i }| a, b ) P ( a, b |  X ,  X ,  X ,  X  ) dadb (12) The level-2 hyperparameters  X ,  X ,  X ,  X  are given a uniform hyperprior over [0 , 20] . The MCMC scheme of Section 2.4 has to be modified as follows. When propos ing a new network structure for node i and segment h , M h ratio via the expression P ( {M h a consequence of integrating out the hyperparameters, all n etwork structures become interdepen-dent, and information about the structures is contained in t he sufficient statistics N 1 A new proposal move for the level-2 hyperparameters is added to the existing RJMCMC scheme of Section 2.4. New values for the level-2 hyperparameters x  X  X   X ,  X ,  X ,  X  } are proposed from x designates hyperparameter  X  , and similarly for  X  ,  X  ,  X  . 3.3 Soft information coupling based on a binomial prior node-specific hyperparameters a This leads to a straightforward modification of eq. (11)  X  rep lacing a, b by a get as an equivalent to (13), using the definition N l
As in Section 3.2, we extend the RJMCMC scheme from Section 2. 4 so that when proposing a new network structure, M h probability becomes: A (  X  x | x ) = min  X  Q p The methods described in this paper have been implemented in R, based on code from [6, 7]. Our program sets up an RJMCMC simulation to sample the network st ructure, the changepoints and the hyperparameters from the posterior distribution. As a c onvergence diagnostic we monitor the potential scale reduction factor (PSRF) [14], computed fro m the within-chain and between-chain Figure 2: Network reconstruction performance comparison o f AUROC and AUPRC reconstruction scores for the four methods, HetDBN-0 (white), HetDBN-Exp ( light grey), HetDBN-Bino1 (dark datasets with 4 network segments each, where the horizontal bar shows the median, the box margins while  X  X ifferent Segs X  indicates that structure changes ar e applied to the segments sequentially. PSRF  X  1 . 05 was reached, and then sampled 1000 network and changepoint c onfigurations in inter-vals of 200 RJMCMC steps. From these samples we compute the ma rginal posterior probabilities accuracy in terms of the areas under these graphs (AUROC and A UPRC, respectively); see [15]. 4.1 Comparative evaluation on simulated data We randomly generated 10 networks with 10 nodes each, with th e number of parents per node drawn ated 4 different network segments by drawing the number of ch anges from a Poisson distribution and applying the changes uniformly at random to edges and non -edges in the previous segment. For sion weights were drawn from a Gaussian N (0 , 1) , and Gaussian observation noise N (0 , 1) was added. We compared the network reconstruction accuracy of t he non-homogeneous DBN without information sharing proposed in [6, 7] (HetDBN-0) with the t hree information sharing approaches, based on the exponential prior from Section 3.1 (HetDBN-Exp ), the binomial prior with hard node coupling from Section 3.2 (HetDBN-Bino1), and the binomial prior with soft node coupling from Section 3.3 (HetDBN-Bino2). Figures 2(a) and 2(b) shows the network reconstruction performance of the different information sharing methods in terms of AUR OC and AUPRC scores. All infor-mation sharing methods show a clear improvement in network r econstruction over HetDBN-0, as segment structures are the same (although edge weights are a llowed to vary) and the case where scores compared to HetDBN-0. When all segments are the same, H etDBN-Bino1 and HetDBN-difference between the information sharing methods is not s ignificant. 4.2 Morphogenesis in Drosophila melanogaster We applied our methods to a gene expression time series for el even genes involved in the muscle development of Drosophila melanogaster [16]. The microarray data measured gene expression lev-Figure 3: Changepoints inferred on gene expression data rel ated to morphogenesis in Drosophila melanogaster , and synthetic biology in Saccharomyces cerevisiae (yeast). All figures using HetDBN time. 3(a): HetDBN-0 changepoints for Drosophila (no infor mation sharing) 3(b): TESLA, L1-method is indicated by the legend. 3(d) HetDBN changepoints for the synthetic gene regulatory while in 3(d) the line indicates the boundary between  X  X witc h on X  and  X  X witch off X  data. ing methods. For comparison, we applied the method proposed in [3], using the authors X  software package TESLA (Figure 3(b)). Robinson and Hartemink applie d the discrete non-homogeneous Our non-homogeneous DBN methods are generally more success ful than TESLA, in that they re-cover changepoints for all three transitions (embryo  X  larva, larva  X  pupa, and pupa  X  adult). Figure 3(b) indicates that the last transition, pupa  X  adult, is less clearly detected with TESLA, during the embryo stage, which are missing in [1]. We would ar gue that a complex gene regulatory and on these grounds our model appears to outperform the two a lternative ones. We note that the morphological transition (embryo  X  larva) is less pronounced. 4.3 Reconstruction of a synthetic gene regulatory network i n Saccharomyces cerevisiae The highly topical field of synthetic biology enables biolog ists to design known gene regulatory constructed in Saccharomyces cerevisiae (yeast), and gene expression time series were measured with RT-PCR for 16 and 21 time points under two experimental c onditions, related to the carbon known gold-standard network from these time series with two established state-of-the-art methods from computational systems biology, one based on ordinary d ifferential equations (ODEs), called axis) curves. Results were averaged over 10 independent MCM C simulations. For comparison, conventional DBN, and TSNI, a method based on ODEs.
 TSNI, the other based on conventional DBNs, called Banjo; se e [17] for details. Both methods are optimization-based and output a single network. By comp arison with the known gold standard, homogeneous DBNs described before. Figure 3(d) shows the in ferred marginal posterior probability of potential changepoints. The most significant changepoin t is at the boundary between  X  X witch on X  and  X  X witch off X  data, confirming that the known true chan gepoint is consistently identified. The biological mechanism behind the other peaks is not known , and they are potentially spurious. Interestingly, the application of the proposed informatio n-coupling schemes reduces the height of these peaks, with the binomial models having a stronger effe ct than the exponential one. As we pursue a Bayesian inference scheme, we also obtain a ran king of the potential gene interac-curves [15] shown in Figure 4. Our non-homogeneous DBNs with information sharing outperform Banjo and TSNI both in the  X  X witch on X  and the  X  X witch off X  pha se. They also perform better than HetDBN-0 on the  X  X witch off X  data, but are slightly worse on t he  X  X witch on X  data. Note that the reconstruction accuracy on the  X  X witch off X  data is general ly poorer than on the  X  X witch on X  data accuracy on the poorer time series segment at the cost of a deg raded performance on the stronger a tighter coupling. The average areas under the PR curves, av eraged over both phases ( X  X witch on and off X ), are as follows. HetDBN-0= 0.70, HetDBN-Exp= 0.77 , HetDBN-Bino1= 0.75, HetDBN-Bino2= 0.75. Hence, the overall effect of information shari ng is a performance improvement. We have described a non-homogeneous DBN, which has various a dvantages over existing schemes: on simulated data has demonstrated an improved performance over [6, 7] when information sharing cle of Drosophila melanogaster has revealed better agreement with known morphogenic trans itions application to data from a topical study in synthetic biolog y, our methods have outperformed two established network reconstruction methods from computat ional systems biology. [1] J. W. Robinson and A. J. Hartemink. Non-stationary dynam ic Bayesian networks. In D. Koller, [2] M. Grzegorczyk and D. Husmeier. Non-stationary continu ous dynamic Bayesian networks. In [3] A. Ahmed and E. P. Xing. Recovering time-varying network s of dependencies in social and [4] M. Talih and N. Hengartner. Structural learning with tim e-varying components: Tracking the [5] X. Xuan and K. Murphy. Modeling changing dependency stru cture in multivariate time series. [9] B. Larget and D. L. Simon. Markov chain Monte Carlo algori thms for the Bayesian analysis [10] C. Andrieu and A. Doucet. Joint Bayesian model selectio n and estimation of noisy sinusoids [11] P. Green. Reversible jump Markov chain Monte Carlo comp utation and Bayesian model deter-[14] A. Gelman and D.B. Rubin. Inference from iterative simu lation using multiple sequences. [15] J. Davis and M. Goadrich. The relationship between prec ision-recall and ROC curves. In [16] M.N. Arbeitman, E.E.M. Furlong, F. Imam, E. Johnson, B. H. Null, B.S. Baker, M.A. Krasnow,
