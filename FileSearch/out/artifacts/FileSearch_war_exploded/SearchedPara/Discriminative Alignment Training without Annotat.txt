 In the first SMT systems (Brown et al., 1993), word alignment was introduced as a hidden variable of the translation model. When word-based translation models have been replaced by phrase-based mod-model training have become two separated tasks.
The system of Brown et al. was based on the noisy channel approach. Present SMT systems use a more general maximum entropy approach in which a log-linear combination of multiple feature functions is implemented (Och and Ney, 2002). Within this new framework translation quality can be tuned by adjusting the weight of each feature function in the log-linear combination. In order to improve transla-tion quality, this tuning can be effectively performed by minimizing translation error over a development corpus for which manually translated references are available (Och, 2003). As a separate first stage of the process, alignment is not in practice directly tuned in function of the machine translation task.

Tuning alignment for an MT system is subject to practical difficulties. Unsupervised systems (Och and Ney, 2003; Liang et al., 2006) are based on gen-erative models trained with the EM algorithm. They require large computational resources, and incorpo-rating new features is difficult. In contrast, adding new features to some supervised systems (Liu et al., 2005; Moore, 2005; Ittycheriah and Roukos, 2005) is easy, but the need of annotated data is a problem.
A more general difficulty, however, is that of find-ing an alignment evaluation metric favoring align-ments which benefit Machine Translation. The fact that the required alignment characteristics depend on each particular system makes it even more dif-ficult. It seems that high precision alignments are better for phrase-based SMT (Chen and Federico, 2006; Ayan and Dorr, 2006), whereas high recall alignments are more suited to N-gram SMT (Mari  X  no et al., 2006). In this context, alignment quality im-provements does not necessarily imply translation quality improvements. This is in agreement with the observation of a poor correlation between word alignment error rate (AER (Och and Ney, 2000)) and automatic translation evaluation metrics (Ittycheriah and Roukos, 2005; Vilar et al., 2006).
Recently some alignment evaluation metrics have been proposed which are more informative when the alignments are used to extract translation units (Fraser and Marcu, 2006; Ayan and Dorr, 2006). However, these metrics assess translation quality very indirectly.

In this paper, we propose a novel framework for discriminative training of alignment models with au-tomated translation metrics as maximization crite-rion. Thus we just need a reference aligned at the sentence level instead of link labels at the word level.
The paper is structured as follows. Section 2 ex-plains the models used in our word aligner, focusing on the features designed to account for the specifici-ties of the SMT system. In section 3, our minimum error training procedure is described and experimen-tal results are shown. Finally, some concluding re-marks and lines of further research are given. For versatility and efficiency requirements, we im-plemented BIA, a BIlingual word Aligner similar to that of Moore (2005). BIA consists in a beam-search decoder searching, for each sentence pair, the alignment which minimizes the cost of a linear com-bination of various models. The differences with the system of Moore lie in the features, which we specially designed to suit our translation system (N-gram SMT (Mari  X  no et al., 2006)). Its particularity is the translation model, which is based on a 4 -gram language model of bilingual units referred to as tu-ples. Two issues regarding this translation model can be dealt with at the alignment stage.

Firstly, in order to estimate the bilingual n-gram model, only one monotonic segmentation of each sentence pair is performed. Thus long reorderings cause long and sparse tuples to be extracted. For ex-ample, if the first source word is linked to the last target word, only one tuple can be extracted, which contains the whole sentence pair. This kind of tuple is not reusable, and the data between its two extreme words are lost.

Secondly, it occurs very often that unlinked words ( i.e. linked to NULL) end up producing tuples with NULL source sides. This cannot be allowed since no NULL is expected to occur in a translation input. This problem is solved by preprocessing alignments before tuple extraction such that any unlinked target word is attached to either its precedent or its follow-ing word.

Taking theses issues into account, we imple-mented the following features:  X  distinct source and target unlinked word penal- X  link bonus: in order to accommodate the N- X  embedded word position penalty: this feature In addition to the embedded word position feature, we used the same two distortion features as Moore to penalize reorderings in the alignment (one sums the number of crossing links, and the other one sums the amplitude of crossing links). We also used the  X  2 score (Gale and Church, 1991) as a word association model, and as a POS-tags association model. For these experiments we used the Chinese-English data provided for IWSLT X 06 evaluation campaign (Paul, 2006). The training set contains 46000 sentences (of 6.7 and 7.0 average length). Pa-rameters were tuned over the development set (dev4) provided, consisting of 489 sentences of 11.2 words in average, with 7 references. Our test set was a se-lection of 500 sentences (of 6 words in average, with 16 references) among dev1, dev2 and dev3 sets. 3.1 Optimization Procedure Once the alignment models were computed, a set of optimal log-linear coefficients was estimated via the optimization procedure depicted in Figure 2.
The training corpus was aligned with a set of ini-tial parameters  X  to extract tuples and build a bilingual N-gram trans-lation model (TM). A baseline SMT system, consist-ing of MARIE decoder and this translation model as (OUT) of the development source set. Then, trans-lation quality over the development set is maximized by iteratively varying the set of coefficients.
The optimization procedure was performed by us-ing the SPSA algorithm (Spall, 1992). SPSA is a stochastic implementation of the conjugate gradient method which requires only two evaluations of the objective function. It was observed to be more ro-bust than the Downhill Simplex method when tuning SMT coefficients (Lambert and Banchs, 2006).
Each function evaluation required to align the training corpus and build a new translation model. The algorithm converged after about 80 evaluations, lasting each 17 minutes with a 3 GHz processor. Alignment decoding was performed with a beam of 10 (it took 50 seconds and required 8 MB memory).
Finally, the corpus was aligned with the opti-mum set of coefficients, and a full SMT system was build, with a target language model (trained on the provided training data), a word bonus model and two lexical models. SMT models weights were op-timized with a standard Minimum Error Training with the full system. To contrast the results, full translation systems were also build extracting tuples from various combinations of GIZA++ alignments (trained with 50 classes and respectively 4,5 and 4 iterations of models 1,HMM and 4). In order to limit the error introduced by MET, we translated the test corpus with three sets of SMT model weights, and took the average and standard deviation. 3.2 Results Table 1 shows results obtained with the full SMT system on the test corpus, with GIZA++ alignments, and BIA alignments optimized in function of three metrics: BLEU, NIST, and BLEU+4*NIST. The standard deviation is indicated in parentheses. Al-though results for systems trained with different BIA alignments present more variability than systems trained with GIZA++ alignments, they achieve bet-ter average scores, and one of them obtains much higher scores. Unexpectedly, BIA alignments tuned with NIST yield the system with worse NIST score. We proposed a novel framework for discriminative training of alignment models with automated trans-lation metrics as maximization criterion. Accord-ing to this type of metrics, the translation systems trained from the optimized alignments clearly per-formed better than the ones trained from Giza++ alignment combinations.

In addition, this first version of the alignment system has very basic models and could be im-proved. We could certainly improve the association score model, for example adding discount factors or adding more association score types, or dictionaries.
During the alignment coefficient optimization de-picted in Figure 2, only the baseline SMT system is used. In future work, we could consider using various SMT features (as would be required for a phrase-based SMT system).

Our approach, as it is, cannot be applied to a large corpus, since it requires to align the whole training corpus at each iteration. Thus an interesting further research would consist in determining whether the alignment parameters trained on a part of the corpus are valid for the whole corpus.

Finally, some Giza++ parameters may also be tuned, in the same way as for BIA parameters. This work has been partially funded by the Euro-pean Union under the integrated project TC-STAR -Technology and Corpora for Speech to Speech Translation -(IST-2002-FP6-506738, http://www.tc-star.org) and by the Spanish Government under grant TEC2006-13964-C03 (AVIVAVOZ project).

