 Clustering is a very well studied problem that attempts to group similar data points. Most traditional clustering algo-rithms assume that the data is provided without measure-ment error. Often, however, real world data sets have such errors and one can obtain estimates of these errors. We present a clustering method that incorporates information contained in these error estimates. We present a new dis-tance function that is based on the distribution of errors in data. Using a Gaussian model for errors, the distance func-tion follows a Chi-Square distribution and is easy to com-pute. This distance function is used in hierarchical cluster-ing to discover meaningful clusters. The distance function is scale-invariant so that clustering results are independent of units of measuring data. In the special case when the error distribution is the same for each attribute of data points, the rank order of pair-wise distances is the same for our distance function and the Euclidean distance function. The cluster-ing method is applied to the seasonality estimation problem and experimental results are presented for the retail indus-try data as well as for simulated data, where it outperforms classical clustering methods. clustering, distance function, forecasting, Gaussian distribu-tion, product life cycle, seasonality, time-series. 
Definition of a good distance or dissimilarity function is a critical step in any distance based clustering method. Most of the work in this field assumes that a distance function defined on pairs of objects is available [3, 4]. Sometimes these distances are directly measured as pair-wise differences among objects, but often they are computed from measure-ments of a number of attributes for each object. Most tra-ditional clustering methods assume that these distances (or dissimilarities) can be computed from the data in hand with-out any error. However, in certain applications such as the permission and/or a fee. KDD '02 Edmonton, Alberta, Canada Copyright 2002 ACM 1-58113-567-X/02/0007 ...$5.00. more sense because the x values have large error in their measurements, whereas, y value measurements are accurate and should therefore dominate the clustering decision. 
Our research was motivated by the problem of estimat-ing seasonality for retailers based on the sales data from the previous year. In retail merchandizing it is very im-portant to understand the seasonal behavior in the sales of different items to correctly forecast demand and make appropriate business decisions. We model the seasonality estimation problem as a time-series clustering problem in the presence of errors and present the experimental results when applied to point-of-sale retail data. We were able to discover meaningful clusters of seasonality whereas classical methods which do not take account of errors did not ob-tain good clusters. To the best of our knowledge, this is not only the first attempt to cluster data while incorporating information about errors in data, we have not come across any work that attempts to find seasonal patterns in retail marketing using time-series clustering. 
Although our studies and results can be extended to ar-bitrary probability distributions, we assume that each point comes from a multidimensional Gaussian distribution with diagonal covariance matrix since this distribution is appro-priate for our application. Under this assumption we present a new distance function that is based on the distribution of error in data, Under a Gaussian model for errors, the dis-tance function follows a Chi-Square distribution and is easy to compute. The distance function is used in hierarchical clustering to develop a clustering method that is used in the seasonality estimation problem. 
The rest of the paper is organized as follows. In section 2 we briefly describe the seasonality estimation problem. In section 3 we provide a time-series representation of season-ality that models associated errors. In section 4 we define a distance function based on the distribution of errors in data. In section 5 we describe a hierarchical clustering algorithm using this distance function. In section 6 we present ex-perimental results based on real as well as simulated data. Finally in section 7 we present concluding remarks along with future research directions. 2. SEASONALITY ESTIMATION 
Seasonality is defined as the normalized underlying de-mand of a group of similar merchandize a~ a function of time of the year after taking into account other factors that impact sales such as discounts, inventory, promotions and random effects. Seasonality is a numeric index of seasonal buying behavior that is consistent from year to year. For ex-ample, a Christmas item will have high seasonality indices during the month of December, whereas shorts will have over the entire year. For example, one could group together a specific set of items that are known to be selling during Christmas, all items that are known to be selling during summer and not during winter, etc. The idea is to get a set of items following similar seasonality that are intro-duced and removed at different points of time during the year. This set, say S, consists of items having a variety of PLCs differing in their shape and time duration. If we take the weekly average of all PLCs in S then we would have a somewhat flat curve as shown in figure 3. This implies that weekly average of PLCs for all items in S can be assumed to be constant as shown in theorem 1. Figure 3: Averaging effect on a set of uniformly dis-tributed PLCs 
PROOF. Let us consider a given week, say week t. Since only those PLCs that have starting time between week t-51 and week t will contribute to the weekly average for week t, we consider only those PLCs that have t~ between week t-51 and week t. Let pl be the probability of t~ = l. Because of equally likely starting times, pl = ~ for I = t-51, t-50, ..., t. where c is a constant that does not depend on t. The vario ance of ~ Ties PLCi(t-t~) is inversely proportional to [S[ as in equation (8). If IS[ is large, the variance will be small and the weekly observed values of ~ Ties PLCi(t-t~) will be approximately constant and hence the result. [] 
If we take the average of weekly sales of all items in S then it would nullify the effect of PLCs as suggested by the following equations. Let Sales be the average sale during week t for items in S then 
Since all items in S are assumed to have the same season-ality, Seasis is the same for all items i E S, say equal to 
Consider two seasonal/ties A~ = {(xlx, ai,), (x~2, a~2) .... , 
Let N(#, a) denote a Gauss/an distribution with mean/z 
If Ai ~ A s then pit = pit and consequently the statistic 
Since X~(X) is a monotonically increasing function w.r.t, x The merge operation is used in the Algorithm hError to combine information from a pair of time-series to produce a new time-series that is an interpolation between the time-series used to produce it. The shape of the resulting time-series depends not only on the sample values of individual time-series but also on errors associated with them. Consider two time-series, A = {(x11, alx), (x12, a12) ..... 
Let C = {(xl,al), (x2, a2), ..., (xT, aT)} be the resulting time-series when A and B are merged. Let A and B come from the same true seasonality with means {pl, #2, ..., #T}-
A natural choice for the components of C are the maximum likelihood estimates of #'s and associated standard devia-tions. From the maximum likelihood principle [7] and the 
Gauss,an distribution assumption, it is easy to show that 
In this section we present experimental results using Al-gorithm hError on simulated data and also on data from a leading national retail chain. 
We generated artificial data using ten PLCs that differ in their peaks and shapes as shown in figure 4. The PLC data is randomly generated by choosing one of these ten PLCs with equal probability and a uniformly distributed starting time over a period of one year. Using three different sea-sonalities corresponding to Christmas, summer seasonality and winter seasonality (see figures 6 &amp; 7 ), we generated sales data by multiplying each generated PLC with one of the three seasonal,ties. We constructed 12 instances, where each instance consists of 25-35 PLCs. Sales data for each instance was generated by multiplying all the PLCs in that instance with one of the above seasonal,ties chosen at ran-dom. We hide the information about true seasonal,ties and use Algorithm hError to recover three seasonal,ties. 
We obtain an estimate of seasonality and associated errors for each instance by averaging weekly sales data in that in-stance as described in section 2. The estimated seasonal,ties and associated errors are shown in figure 5 with vertical bars representing standard errors. It can be seen from the figure that some of the seasonaiities do not correspond to any of the original seasonal,ties, for example, the middle one in the last row. Moreover, each of them has large errors. We ran hError and obtained the three cluster centers shown in figure 6. The resulting seasonal,ties match original season-alities very well as can be seen from this figure. We com-pared our result against k-means and Ward's method that do not consider the information about errors. The number of misclassifications were higher when we used these cluster-ing methods. The clusters were identical for both of them and the cluster centers are shown in figure 7. 
We assess the quality of a clustering result by computing its Average Estimation Error. Let there be r true seasonal,-Figure 7: Seasonaiities obtained by kmeans and 
Ward's method using Euclidean distances. which are further classified into several classes (example: men's winter shoes, formal shirts, etc.). Each class has a varying number of items for which sales data is available. 
For this experiment we considered only those classes that have sales data for at least 20 items. The data used con-sisted of two years of sales data. One year of data was used to estimate seasonalities. Using these estimated sea-sonalities, we forecast sales for the next year and compare it against the actual sales data. We considered 6 different departments (greeting cards, books, music and video, toys, automotive, and sporting goods). Each department has 4-15 classes and we used data from a total of 45 classes across all 6 departments. First we estimated seasonalities and asso-ciated errors for each class based on the method described in section 2. Having estimated seasonalities, we applied Al-gorithm hError to reconstruct seasonalities for each class. 
Using these seasonality estimates, we predicted sales for the items in the books department. We chose the hooks de-partment because the effects such as price, promotions and inventory were small for this department, thereby, weekly change in sales for the books department was mainly be-cause of seasonality. We assessed the quality of forecast by calculating average Forecast Error, which is the ratio of the 
