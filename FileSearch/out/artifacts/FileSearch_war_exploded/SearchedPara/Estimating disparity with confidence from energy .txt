 Binocular disparity, the displacement between the im age locations of an obj ect between two eyes or cameras, is an important depth cue. Mammalian brai ns appear to represent the stimulus disparity model is a first order model that explains the resp onses of individual disparity-tuned neurons [3]. In shifts between the left and right monocular receptive fields (RFs). Peak picking is a common disparity estimation strategy for these neur ons([4]-[6]). In this strategy, response among the neural population. Chen and Qi an [4] have suggested that the peak location in a population of phase-tuned disparity energy neuron s is a more reliable estimate than the peak loca-tion in a population of position-tuned neurons. range of preferred disparities of this population, the peak location changes linearly with the stimu-lus disparity. Thus, we can estimate the disparity from the peak . However, in natural viewing condi-the population [7]. The peak location no longer indicates the stimulus disparity, since the peaks still occur even when the stimulus dispar ity is outside the range of neur ons X  preferred disparities. The false peaks arise from two sources: the phase wrap-around due to the sinusoidal modulation in the Gabor function mo delling neuron X  X  receptive field (RF) pr ofile, or unmatching edges entering the neuron's RF [5].
 Although a single population can c over a large disparity range, the large size of the required recep-tive fields results in very low resolution depth es timates. To address this problem, Chen and Qian using populations tuned to finer scales.
 Here we present an alternative way to estimate the stimulus disparity using a biologically plausible confidence measure that indicates wh ether the stimulus disparity lies inside or outside the range of preferred disparities in a population of phase tune d neurons. We motivate th is measure by examin-better estimates than the coarse-to-fine approach [4], and can detect occlusions. In this section, we define different features of a population of phase-tuned neurons. These features will be used to define the confidence measure. Figure 2a illustrates the bi nocular disparity energy model of a phase-tuned neuron [3]. For simplicity , we assume 1D processing, which is equivalent to considering one orientation in the 2D case. Th e response of a binocular simple cell is modelled by summing of the outputs of linear monocular Gabor filters applied to both left and right images, followed by a positive or negative half squaring nonlinearity. The response of a binocular complex cell is the sum of the four simple cell responses. Formally, we define the left and right retina l images by and , where denotes the dis-tance from the RF center. The disparity is th e difference between the locations of corresponding image intensities weighted by pairs of phase quadr ature RF profiles, which are the real and imagi-nary parts of a complex-valued Gabor function ( ): where and are the spatial frequency and the phase of the left and right monocular RFs, and tial frequency bandwidth. The spatia l frequency and the standard devi ation of the left and right RFs are identical, but the phases may differ ( and ). We can compactly express the pairs of left and right monocular responses as the real and imaginary parts of and Fig. 1: Sample population responses of the phase -tuned disparity neurons for different disparities. This was generated by presenting the left image of the  X  X ones X  stereogram shown in Figure 5a to both eyes but varying the disparity by keeping the left image fixed and shifting the right image. At disparities of the population ( pixels). gx ()  X  V sum of the monocular responses: where the * superscript indicates the complex conjugation. The ph ase-shift between the right and left neurons controls the preferred disparity of the binocular complex cell [6].
 If we fix the stimulus and allow to vary between , the function in (3) describes the population response of phase-tuned neurons w hose preferred disparities range between and where responses. Note that , since . Th e feature is the peak location of the population response. Peak picking algorithm s compute the estimates from the peak location, i.e. [6]. In this section, we suggest a simple confidence measure that can be used to differentiate between ( ) and outside ( ) the range of preferred disparities in the population. ering and . We ignore . Intuitively, the peak location will be less effective in distin-The phase-shift between the left and right monocular RFs determines the preferred disparity of the neuron. The ne uron shown is tuned to a negative disparity of . (b) The population response of the phase-tuned neurons centered at a retinal location with the phase-shifts can be characteri zed by three features and . U l x ()
U r x ()  X  X   X  SP  X  X  d  X  X   X   X  d  X  X   X  &gt; RPS  X  = SR guishing between DIN and DOUT, since Figure 1 shows that the phase ranges between and for both disparity classes. The ratio is bounded between and , since .
 Because of the uncertainties in the natural scenes , the features and ar e random variables. In making a decision based on random features, Bayesi an classifiers minimize the classification error. DOUT) given the observed feature values. The decision can be specified by thresholding the Bayes factor. hood from data obtained using the  X  X ones X  and the  X  X eddy X  stereograms from Mid-correspondences are located in the same horizontal scan-lines. Each image has 1500 x 1800 pixels. We constructed a population of phase-tuned neuron s at each pixel. The di sparity neurons had the same spatial frequency and standard deviation, and were selective to vertical orientations. The spa-tial frequency was radians per pixel and the standard deviation in the horizontal direction was pixels, corresponding to a spatial bandwidth of 1.8 octaves. The standard deviation in the vertical direction was . The range of the preferred disparities (DIN) of the pop-ulation is between pixels. To reduce the variability in the classification, we also applied Gauss-ian spatial pooling with the standard deviation to the population [4][5 ]. The features and computed from popu lation were separated into two cla sses (DIN and DOUT) according to the ground truth in Figure 5b. Figure 3a-b show the empirically es timated joint conditional densities for the two disparity classes. They were computed by binning the features and with the bin sizes of 0.25 for and 0.01 for cates that the feature can be an indicator to distinguish between the in-range and out-of-range disparities. Mathematically, we can compute the optimal decision boundaries by applying different thresholds to the Bayes factor in (6). Figure 3c shows the boundaries. They are basically flat except at small . We also demonstrate the efficacy of thresholding instead of us ing the optimal decision boundar-Fig. 3: The empirical joint density of and given (a) DIN and (b) DOUT. Red indicates large factor. (d) The change in total probability of error between using a flat boundary (thresholding ) versus the optimal boundary. R
SR , {} P DIN [] P DOUT [] f SR , C sr , c () c DIN DOUT , {}  X  R error: We then compare this total probability of error with the one computed using the optimal decision boundaries derived in (6). Figure 3d shows the deviation in the total probability of error between the two approaches versus . The deviation is small (on the order of ) suggesting that thresholding results in similar performance as using the optimal decision boundaries. Thus, can be used as a confidence measure for distin guishing DIN and DOUT. Moreover, this measure can be computed by normalization, which is a common component in models for V1 neurons [11]. Our analysis above shows that is a simple indi cator to distinguish between in-range and out-of-disparity with validation. Figure 4 shows the proposed model, which consists of populations of hybrid tuned disparity neu-rons tuned to different phase-s hifts and position-sh ifts . For each popul ation tuned to the same position-shift but different phase-shifts (phase-tuned population), we compute the ratio entire phase-tuned neurons. The feature can be computed by subtracting the peak response by In additional to estimate the stimulus disparity , we also validate the estimates by comparing with a threshold . Instead of choosing a fixed threshold, we vary the threshold to show that the feature can be an occlusion detector. 4.1 Disparity estima tion with confidence grams, shown in Figure 5a. The sp atial frequency and the spatial st andard deviation of the neurons Fig. 4: Proposed disparity estimator with the validation of disparity estimates. P DIN [] c 01 , []  X  R S  X  c * R  X  c  X  X   X  c * pooling to improve the estimation. For spatial pooling, we applied a circularly symmetric Gaussian function with standard deviation . For orientatio n pooling, we pooled the responses over five ori-entations ranging from 30 to 150 degrees. The range of the position-shifts for the populations was set to the largest disparity range, pixels, according to the ground truth.
 We also implemented the coarse-to-fine model as described in [4] for comparison. In this model, an initial disparity estimate computed from a populatio n of phase-tuned neurons at the coarsest scale is successively refined by the populat ions of phase-tuned neurons at the finer scales. By choosing the coarsest scale large enough, the disparity range cove red by this method can be arbitrarily large. The coarsest and the finest scales had the Gabor period s of 512 and 16 pixels. The Gabor periods of the successive scales differed by a factor of . Neur ons at the finest scale had the same RF parame-ters as our model. Same spatial pooling and orientation pooling were applied on each scale. Figure 5d-e show the estimated disparity maps and the error maps of the tw o approaches. The error maps show the regions where the disparity estimates exceed 1 pixel of error in the disparity. Both accurate estimates. In the coarse-to-fine model, th e percentage of pixels being incorrectly estimated is 36.3%, while our proposed model is only 27.8%. truth disparity maps with respect to the left imag es, obtained by the structured light method. (c) The ground truth occlusion maps. (d) The disparity maps and the error maps computed by the coarse-to-detected invalid estimates are labell ed in black in the disparity maps. The coarse-to-fine model tends to make errors around the depth bou ndaries. This arises because the assumption that the stimulus disparity is constant ov er the RF of the neuron is unlikely at very large at the finer scales.
 On the other hand, the proposed model can not only estimate the stimulus disparity, but also can are not comparable, since they depend upon image contrast which varies at different spatial loca-tions. However, the feature , which is computed by normalizing the response peak by the average response, eliminates such dependency. Moreover, the invalid regions detected (the black regions on the disparity maps) are in excellent agreement with the error labels. 4.2 Occlusion detection Occlusion is one of the challenging problems in st ereo vision. Occlusion occurs near the depth dis-continuities where there is no correspondence betw een the left and right images. The disparity in Figure 5c.
 into each possibility as the thres hold applied to varies, e.g., These percentages sum to unity for any thresholds . For small thresholds, the detector mainly identifies the occlusion regions. As the threshold in creases, the detector also begins to detect incor-rect disparity estimates. Figure 6b shows the percentages of pixels in each possibility that are clas-sified as DOUT as a function of , e.g., For a large threshold ( close to unity), all estimates are labelled as DOUT, so the three percent-ages approach 100%. The proposed detector is eff ective in identifying occl usion. At the threshold with only ~10% misclassification.
 Fig. 6: The percentages of occluded pixels (thick), pixels with incorrect disparity estimates (thin) and pixels with correct estimates (dotted) identifi ed as DOUT. (a) Percentages as a fraction of total number of DOUT pixels. (b) Percentages as a fraction of number of pixels of each type. T
R 0.3 = (a) (b)
P1 (x100%) P2 (x100%) In this paper, we have proposed an algorithm to estimate stimulus disparities based on a confidence previously proposed models that estimate the stimulus disparity from populations of hybrid tuned neurons [4][10], our model is the first that also provides a confidence meas ure for these estimates. detection of occlusion, an important problem in stereo vision, was not addressed in these previous approaches.
 The confidence measure used in the proposed al gorithm can be computed using normalization, which has been used to model the responses of V1 neurons [11]. Previous work has emphasized the more representative of the confid ence in validating the hypothesis that the input disparity is close to close to that using the statistical optimal boundaries. Aggregating the neural responses over locations, or ientations and scales is a common technique to algorithm also applies spatial and orientation pooling before computing the confidence. An inter-esting question, which we are now investigating, is whether individual confidence measures com-puted from different locations or orient ations can be combined systematically. Acknowledgements This work was supported in part by the Hong Kong Research Grants Council under Grant 619205. References
