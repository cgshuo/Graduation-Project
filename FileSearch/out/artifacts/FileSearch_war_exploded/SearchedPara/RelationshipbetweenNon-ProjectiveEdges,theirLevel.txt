 D e pendenc y a nalysis o f n atural language has b een gaining a n e v e r i ncreasing i nterest t hanks to its ap-plicability in m a n y tasks o f N L P  X  X  recent e xam p le is the d ependenc y p arsing work of M c D onald et al. (2005), w hich introduces an approach based o n t he search for m axim um spanning trees, capable of han-dling non-projecti v e s tructures n aturally .

In this conte x t, the i ssue o f d elim iting d ependenc y structures perm issible i n n atural language gro w s i n im portance ( see e . g . N i v re (2006)). W e would lik e to point out that since n either syntactic structures in dependenc y t reebanks, nor structures arising i n d e-pendenc y p arsing need a p riori f all i nto a n y form al subclass of dependenc y t rees, w e n eed m eans o f d e-scribing an y non-projecti v e s tructure. 1
Kuhlm a nn and N i v re (2006) com p are s e v eral con-straints on dependenc y s tructures a nd am ong the considered ones fi nd w e ll-nestedness to be in good accord w ith em pirical data. H o w e v er , t he y d o not in-clude le v e l t ypes o f non-projecti v e e dges i ntroduced by H a v e lka ( 2005), w hich present a nother m eans o f characterizing a n y non-projecti v e s tructure and h a v e interesting f orm a l p roperties. W e link p roperties o f non-projecti v e e dges a nd their l e v el types t o t he con-straint o f w ell-nestedness and s ho w t hat t he y p ro vide a m o r e fi ne-grained m eans capable of capturing it.
T h e p aper is or ganized as follo w s : S ect. 2 con-tains f orm a l p relim inaries; S ect. 3 and 4 r e v ie w d ef-initions and s ho w t he necessary properties o f t he constraint of w e ll-nestedness and l e v el types o f non-projecti v e e dges; S ect. 5 presents the m ain r esults concerning the r elationship b etw een non-projecti v e edges ( and t heir le v e l t ypes) and w ell-nestedness. T o m a k e the p aper as self-contained a s possible, w e pro v ide a concise r eference w ith de fi nitions and s im -ple p roperties u sed i n s ubsequent sections.
 De fi ni t i o n 1 A dependency t r e e is a t riple ( V ,  X  , " ) , w h e r e V is a fi nite set o f nodes,  X  a de-pendency relation o n V , a n d " a t otal order o n V .
R e lation  X  m odels linguistic dependenc y , and s o represents a d irected, r ooted tree on V . T h e r e a r e m a n y ways of characterizing r ooted trees, w e g i v e here a c haracterization v ia the p roperties o f  X  : t h e r e is a r oot r  X  V such that r  X   X  v for a ll v  X  V and t here is a unique edg e p  X  v for a ll v  X  V , v % = r . R elation  X   X  is the r e fl e x i v e t ransiti v e closure o f  X  and i s usually called subor dination .

T h e f ollo w i ng de fi nitions allo w u s t o f orm u late our results succinctly . F or each node i we d e fi ne its le vel as the l ength o f t he path r  X   X  i ; w e d e -note i t le v e l i . T he sym m e trization  X  =  X   X   X   X  1 m a k e s i t possible t o t alk a bout edges ( pairs o f nodes i , j such that i  X  j ) w ithout e xplicitly specifying the par ent ( head etc. ; i here) a nd the c h ild ( de-pendent etc. ; j here); so  X  represents directed edges a nd  X  undirected edges. T o retain the a bil-ity to talk about the d irection o f e dges, w e de fi ne O u r notation f or rooted subtr ees is S ubt ree i = { v  X  V | i  X   X  v } , S ubt ree i  X  j = { v  X  V | P a rent i  X  j and f or ancestor s An c i = { v  X  V | v  X   X  i } , An c i  X  j { v  X  V | v  X   X  Pa r e n t i  X  j } . T o b e a ble t o t alk c on-cisely about the t otal order o n nodes " , w e d e -fi ne open and closed intervals w hose e ndpoints n eed not be in a p rescribed o rder: ( i , j ) = { v  X  V | mi n " { i , j }  X  v  X  ma x " { i , j } } and [ i , j ] = { v  X  V | mi n " { i , j } " v " ma x " { i , j } } , r esp. For a n y edge i  X  j we d e fi ne its gap as follo w s Ga p i  X  j = { v  X  em pty g ap is pr ojective , a n e dge w hose g ap is non-em pty i s non-pr ojective . ( S e e e . g . ( H a v e lka, 2005) for t he characterization o f p rojecti v ity via p roperties of edges a nd further r eferences. ) P r op erty 2 L e t a be a node and i  X  j any edg e disjoint fr om a. T h en i  X  S ubt ree a  X  j  X  S ubt ree a P
RO O F . F rom t he assum p tion i % = a % = j it follo w s P r op osition 3 Le t i  X  j, u  X  v b e d isjoint e dg es. (i) If u , v  X  ( i , j ) , t h e n u  X  Ga p i  X  j  X  v  X  Ga p P
R OOF . ( i) follo w s im m e diately from t he de fi nition of Ga p i  X  j and P roperty 2 . T o p ro v e (ii), a ssum e v  X  ( i , j ) and u sing (i) a rri v e at a c ontradiction. Kuhlm a nn and N i v re (2006) claim t hat t he constraint of w e ll-nestedness seem s t o a pproxim a te w e ll de-pendenc y s tructures o ccurring in natural l anguage. De fi ni t i o n 4 A d ependenc y t ree T is ill-nested if there a re disjoint subtrees T 1 , T 2 of T and nodes x , y 1  X  T 1 and x 2 , y 2  X  T 2 such that x 1  X  ( x 2 , y x 2  X  ( x 1 , y 1 ) . A dependenc y t ree T that is not ill-nested is w e ll-nested . 2
It is easy t o e xpress t he constraint in term s o f edges X  it w ill pro v e crucial i n S ect. 5 .
 The o r e m 5 A d ependency t r e e T is ill-nested if f ther e a r e edg e s i 1  X  j 1 , i 2  X  j 2 in disjoint subtr ees T , T 2 of T , r e sp. , suc h that i 1  X  ( i 2 , j 2 ) , i P R OOF . D irection  X  is ob vious.

D i rection  X  : L e t r i be the r oot of T i . T o fi nd i  X  j 1 , fi rst s uppose t hat r 1  X  ( x 2 , y 2 ) . C onsider the fi rst e dge v k  X  v k + 1 on the d o w nward p ath v 0 = r v , . . . , v m = y 1 , m &gt; 0, such that v k  X  ( x 2 , y v v k + 1  X  v k on the upward p ath v 0 = x 1 , v 1 , . . . , v r , n &gt; 0, such that v k  X  ( x 2 , y 2 ) and v k + 1 /  X  [ x L e t u s d enote i 1 = v k and j 1 = v k + 1 , a nd possibly r e-nam e x 2 , y 2 so that i 1  X  ( x 2 , y 2 ) and x 2  X  ( i fi nd i 2  X  j 2 such that i 1  X  ( i 2 , j 2 ) , i 2  X  ( i ceed sim ilarly a s a bo v e . O b v iously , e dges i 1  X  j i  X  j 2 are i n d isjoint s ubtrees. L e v e l t ypes o f non-projecti v e e dges a llo w t heir structural classi fi cation w ith interesting f orm a l p rop-erties. T h e y w e re introduced by H a v e lka ( 2005), w h o p resents t hem i n m ore d etail.
 De fi ni t i o n 6 Th e le vel type (or j ust type ) o f a non-projecti v e e dge i  X  j is de fi ned a s f ollo w s
T h e t ype of an edge is the d istance o f its child node and a node in its gap c losest to the r oot (dis-tance h ere m eans d if ference i n l e v els) X  X or sam p le con fi gurations see F igure 1 3 . N ote t hat t here m a y be m o re than one node w itnessing an edge X  s type. T h e t ype of an edge is not bounded X  it can tak e an y inte ger v alue (depending on the h eight of a t ree).
Ou r d e fi nition o f l e v el type of non-projecti v e edges e xtends naturally the o riginal d e fi nition i m -plicit in (H a v elka, 2005), w here classes c orrespond-ing t o positi v e , zero a nd ne gati v e types a re de fi ned.
W e no w s ho w a relationship b etw een edges o f cer -tain types t hat w ill allo w u s t o d eri v e a relationship betw een non-projecti v e e dges a nd w e ll-nestedness. The o r e m 7 F o r any non-pr ojective e dg e i  X  j i n a a non-pr ojective e dg e v  X  u i n T w ith Ty p e u  X  v  X  0 ( &gt; 0 ) s uc h t hat u  X  ar g m in n  X  Ga p P
RO O F . L e t u be an y node in ar g m in n  X  Ga p F r om the a ssum p tion Ty p e i  X  j  X  0 node u has a par -ent v /  X  Ga p i  X  j . O b v iously i  X  j , v  X  u are d is-joint, thus from P roposition 3 w e ha v e v /  X  [ i , j ] , a n d so either i  X  ( u , v ) , o r j  X  ( u , v ) . S i n c e le v e l so either i  X  Ga p u  X  v , o r j  X  Ga p u  X  v . F inally from ( &gt; 0), h ence Ty p e u  X  v  X  0 ( &gt; 0). W e gi v e characterizations of w e ll-nestedness solely in term s o f p roperties o f non-projecti v e e dges a nd sho w som e applications. 5. 1 C h a racterization u s in g p airs of ed ges F i rst w e g i v e a c haracterization o f p airs of edges i n T h eorem 5 in term s o f t heir gaps.
 The o r e m 8 Le t i 1  X  j 1 , i 2  X  j 2 be tw o e dg es in a dependency t r e e T . T he y a r e in disjoint subtr ees T T , r esp. , and satisfy i 1  X  ( i 2 , j 2 ) , i 2  X  ( i 1 , j follow i ng condition holds ( inp ) i 1  X  Ga p i P
R OOF . D irection  X  : R oot T k in P a rent i k  X  j k , k = 1 , 2. C ondition ( inp ) o b v iously im plies i 1  X  ( i i  X  ( i 1 , j 1 ) , w hich in turn im plies t hat e dges i 1 i  X  j 2 are d isjoint. F r om P r operty 2 w e get t hat S ubt ree i 2  X  j 2 , h ence subtrees T 1 , T 2 are d isjoint.
D i rection  X  : L et us consider the e dge i 2  X  j 2 and node i 1 . S i n c e T 1 is disjoint from T 2 , w e h a v e that i 1 /  X  S ubt ree i T h e p roof that i 2  X  Ga p i
C ondition ( inp ) a llo w s us to talk about pairs o f edges causing ill-nestedness and s o c haracterize w e ll-nestedness using p roperties o f p airs of edges. De fi ni t i o n 9 W e say t hat a n y two non-projecti v e edges i 1  X  j 1 , i 2  X  j 2 in a d ependenc y t ree T sat-isfying c ondition ( inp ) f o r m a n ill-nested pair o f edg e s .
 C o r o llary 10 A d ependency t r e e T is ill-nested if f i t contains an ill-nested pair o f e dg es.
 P
R OOF . F ollo w s from T heorem s 5 and 8 . 5 . 2 Suf fi cien t c on d i tion f o r ill-n e sted n e ss T h e r esults of S ection 4 and p re vious subsection g i v e the f ollo w i ng relationship b etw een types o f non-projecti v e e dges a nd w e ll-nestedness.
 The o r e m 1 1 If a d ependency t r e e c ontains a non-pr oj. e dg e o f nonpositive t ype , then it is ill-nested. P R OOF . F ollo w s from T heorem s 7 and 10.

W e see t hat t ypes o f non-projecti v e e dges a nd w e ll-nestedness share a com m o n g round; ho w e v e r , the s tatem e nt of T h eorem 1 1 cannot be strengthened to equi v a lence ( it is easy t o s ee that also two e dges of positi v e type can satisfy ( inp )). 5. 3 C h a racterization u s in g s in gle e d g es N o w w e s ho w t hat w ell-nestedness can be character -ized in term s o f p roperties o f s ingle non-projecti v e edges only . W e de fi ne the ill-nested set o f a n e dge and s ho w t hat i t g i v es the d esired characterization. De fi n i tion 12 Th e ill-nested set of an y e dge i  X  j is de fi ned a s f ollo w s
In i  X  j = { u  X  v | u  X  Ga p i  X  j &amp; v /  X  [ i , j ]
T h e n e x t p roposition e xposes the r elationship o f edges i n In i  X  j to the g ap of i  X  j .
 P r op osition 1 3 F o r any edg e i  X  j In i  X  j = { u  X  v | u  X  Ga p i  X  j &amp; v /  X  Ga p i  X  j &amp; u , v /  X  An c P
R OOF . T he inclusion  X  is ob vious. T he inclusion  X  follo w s from P roposition 3 ( u  X  Ga p i  X  j and v /  X  An c i  X  j im ply t hat e dges i  X  j , u  X  v are d isjoint).
W e are r eady t o f orm u late the m ain r esult o f t his section, w h ich g i v es as corollary a c haracterization of w e ll-nestedness using p roperties o f s ingle e dges. The o r e m 1 4 Le t i  X  j b e a n e dg e i n a dependency tr ee T . T h e e dg es that form an ill-nested pair w ith t h e e d g e i  X  j a r e e x actly the e dg es in In i  X  j P
R OOF . D irection  X  : L e t u  X  v be an edge form ing an ill-nested pair w ith the e dge i  X  j , i . e . i  X  Ga p w h ich i m m e diately g i v es v /  X  [ i , j ] . S upposing u  X  is in contradiction w ith i  X  Ga p u  X  v , a nd therefore u , v /  X  An c i  X  j . H ence u  X  v  X  In i  X  j .

D i rection  X  : L e t u  X  v  X  In i  X  j (i. e . u  X  Ga p i  X  j erality assum e i  X  ( u , v ) ). F r om the a ssum p tions u  X  Ga p i  X  j and v /  X  [ i , j ] w e get t hat e dges i  X  j , u  X  v are d isjoint. U s ing P roperty 2 , from t he as-sum p tion u , v /  X  An c i  X  j we g e t i /  X  S ubt ree u  X  v i  X  Ga p u  X  v . H ence i  X  j , u  X  v satisfy ( inp ). C o r o llary 15 A d ependency t r e e T is ill-nested if f i  X  j % = / 0 for s om e non-pr ojective e dg e i  X  j i n T . P
RO O F . F ollo w s from T heorem s 8 and 14. 5 . 4 C he c k i n g w e l l -ne s t e dne s s O u r c haracterization o f w ell-nestedness gi v e s a lso a no v e l w ay of checking it. H e re is a p seudocode of an algorithm f or fully determ ining a ll ill-nested sets: 1: fo r all e dges i  X  j do 2: fo r all e dges u  X  v s. t. u  X  ( i , j ) do Its tim e c om ple x ity is ob viously O ( n 2 ) , s ince the check on line 3 can be im plem ented s o a s t o t ak e constant tim e ( by precom puing  X   X  , w hich can be done in O ( n 2 ) tim e). T he bound is the s am e as for t he reported a lgorithm s for c hecking w ell-nestedness (M  X hl, 2006).

H o w e v e r , the f ollo w i ng theorem a llo w s w e ll-nestedness checking t o b e linear for p rojecti v e t rees, to be f a ster for r andom input, a nd to rem a in O ( n 2 The o r e m 1 6 In any ill-nested pair o f e dg es, a t l east one of the e dg es is of nonne gative t ype ( w itnessed b y an end-point of the o ther edg e ).
 P
RO O F . L e t i 1  X  j 1 , i 2  X  j 2 satisfy ( inp ). L e t pro v e d t hat i 2  X  j 2 is of nonne gati v e type.
H a v e lka ( 2005) presents a linear algorithm f or fi nding all non-projecti v e e dges o f nonne gati v e type. T hus w e ll-nestedness can be check ed as follo w s : fi rst fi nd all e dges o f nonne gati v e type, a nd then check their ill-nested sets for non-em ptiness. C o m -puting  X   X  on dem a nd for s ubtrees of the p rocessed edges, w e preserv e worst-case quadratic com p le xity . W e ha v e presented n e w form al results linking prop-erties o f non-projecti v e e dges a nd their l e v el types t o w e ll-nestedness. T h is work e x tends the c urrent body of research on non-projecti v e d ependenc y s tructures in natural l anguage. I n p articular , w e o f f er ne w i n-sights i nto f orm a l p roperties o f non-projecti v e e dges that, i f possible, both p ro vide adequate m eans f or linguistic description a nd at the s am e tim e a re use-ful a s f eatures in m achine-learning approaches. Ac kno wl e d g e me nt T h is work was s upported b y projects 1 E T 201120505 of the M inistry o f E du-cation o f t he C zech R e public and 374/2005/A -IN F / M F F o f G rant A g enc y of C h arles U ni v e rsity .
