 In everyday life, we can observe many phenomena occurring in space and time simultaneously. For example, the movem ents of a person associate spatial infor-mation (e.g. the departure and arrival coordinates) and temporal information (e.g. the departure and arrival dates). Other applications, with more complex dynamics, are much more difficult to analyze. It is the case of spread of infectious disease, which associates spatial and temporal information such as the number of patients, environmental or entomological data. Yuang in [13] describes this con-cept of dynamics as a set of dynamic forces impacting the behavior of a system and components, individually and collectively .

In this paper, we focus on spatio-temporal data mining methods to better understand the dynamics of complex systems for epidemiological surveillance. In the case of dengue epidemics, public health experts know that the evolution of the disease depends on environmental factors (e.g. climate, areas with water points, mangroves...) and interactions between human and vector transmission (e.g. the mosquito that carries the disease). However, the impact of environmental factors and their interactions remain unclear.

To address these issues, spatio-temporal data mining provides highly relevant solutions through the identification of relationships among variables and events, characterized in space and time without a priori hypothesis . For example, in our context, we will discover combinations of changes in environmental factors that lead epidemic peaks in specific spatial configurations. We will show in the related works section that existing methods are not completely adapted to our problem. For this reason, we have define new spatio-sequential patterns, based on an ex-tension of sequential patterns, to link t he spatial and temporal dimension. An example of pattern in the dengue context is: frequently over the past 10 years, if it rains in an area and if there is standing water and high temperatures in the neighborhood, then there is an increase number of mosquitoes in adjacent areas, followed by an increase of dengue cases . It can be used for analysis by health care professionals, to better understand how environmental factors influence the development of epidemics. Such patterns are very interesting because they en-able to capture evolution of areas conside ring their events and events in adjacent zones. However, they are very difficult to mine because the search space is very large. Proposing scalable methods to find these patterns are consequently very challenging. We have defined an interestingness measure to overcome this prob-lem of scalability and an efficient algorithm based on pattern-growth approach.
In section 2, we review existing spatio-temporal data mining methods and we show that these methods are not suitable for our problem. In section 3, we detail our theoretical framework. In section 4, we present our algorithm called DFS-S2PMiner . In section 5, we present experime nts on real datasets. The paper ends with our conclusions and future perspectives. In this related work section, we are not co ncerned by the trajectories problematic addressed in [1, 3]. We only focus on methods analyzing the evolution and the interaction of objects or events charact eristics through spa ce and time. Early work addressed the spatial and temporal dimensions separately. For example, Han et al. in [4] or Shekhar et al. in [10] looked for spatial patterns or co-location, i.e. subsets of features (object-types) wit h instances often identified as close in space. In our context, an example of co-location is within a radius of 200 m, mosquitoes nests are frequently found near ponds. On the contrary, other authors as Pei et al. in [9] have studied temporal sequences which only take into account the temporal dimension. Tsoukatos et al. in [11] have extended these works to represent sets of environmental features evolving in time. They extract sequences of characteristics that appear frequently in areas, but without taking into account the spatial neighborhood. An example of pattern obtained is: in many areas, heavy rain occurs before the formation of a pond, followed by the development of mosquito nest . If these two types of methods, only spatial or temporal, can be very relevant for epidemiological surveillance, they do not capture relations such as: often, a heavy rain occurs before the formation of a pond followed in a close area by the development of mosquito nests . In [12], Wang et al. focus on the extraction of sequences representing the propagation of spatiotemporal events in predefined time windows. They introduce two concepts: Flow patterns and Generalized Spatiotemporal Patterns in order to extract precisely the sequence of events that occur frequently in some locations. Thus, the authors will be able to identify patterns of the form: dengue cases appear frequently in area Z1 after the occurrence of high temperatures and the presence of ponds in area Z2 .
However, Huang et al. in [7] found that all the patterns discovered with others approaches are not all the time relevant because they may not be statistically sig-nificant and in particular not  X  X ense X  in space and time. They therefore proposed an interestingness measure taking into account the spatial and temporal aspects to extract global sequence of features. However, they study the events one after another. They don X  X  take into account the interactions such as often heavy rain and the occurrence of ponds are presented before the development of mosquito nests . Celik et al. in [2], proposed the concept of Mixed-Drove Spatiotemporal Co-occurrence Patterns , i.e. subsets of two or more different event-types whose instances are often located in spa tial and temporal proximity ( e.g. an event-type is heavy rain andaninstanceis heavy rain in zone Z1 the 10/17/2011 ). For similar reasons than Huang, they have proposed a specific monotonic composite interest measure based on spatial and temporal prevalence measures. However, they do not extract the frequent evolutions of event-types over time (events of each instance occur necessarily in the same time slot). For example, we can only extract patterns such as: heavy rain, ponds and development of mosquito nests are frequently found together in lots of time slots . Finally, approaches proposed by Wang, Huang and Celik cannot capture the evolution of areas with regard to their set of event-types and the sets of event-types of their neighbors.
In this paper, we describe a method for extracting spatio-temporal sequences of patterns (i.e. sequences of spatial sets of events) called S2P (Spatio-Sequential Patterns). We aim at identifying relationships such as: thepresenceofdengue cases in an area is often preceded of high temperatures and the presence of wa-ter tanks in a neighboring area . Thus, we will deal with the developments and interactions between the study area and its immediate environment. Moreover, as this type of patterns are very difficult to mine, because of the huge generated search space, we will introduce an interestingness measure to make our approach scalable. 3.1 Preliminaries A spatio-temporal database is a structured set of information including geo-graphic components (e.g. neighborhoods, rivers, etc.) and temporal components (e.g. rain, wind). Such a database is defined as a triplet DB =( D T ,D S ,D A ) where D T is the temporal dimension, D S the spatial dimension and D A = {
D A 1 ,D A 2 ,...,D A p } a set of analysis dimensions associated with attributes. The temporal dimension is associated with a domain of values denoted dom ( D T )= {
T 1 ,T 2 ,...,T t spatial dimension is associated with a domain of values denoted dom ( D S )= {
Z borhood relationship, denoted Neighbor by: Each dimension D A i (  X  i  X  [1 ..p ]) in the set of analysis dimensions D A , is asso-ciated with a domain of values denoted dom ( A i ). In these domains, the values can be ordered or not.

To illustrate the definitions, we use a sample of weather database, Table 1, which represents weather in three citie s on three consecutive days. The table lists temperature (Temp), precipitation (Prec), wind speed (Wind) and gusts in Km/h. The three cities are associated by a neighborhood relationship described in Figure 1.
 In Table 1, D T = { Date } , D S = { City } and D A = { Temp,Prec,Wind, Gusts } . The domain of the temporal dimension is dom ( D T )= { The domain of spatial dimension is dom ( D S )= { Z 1 ,Z 2 ,Z 3 } with Neighbor ( Z 1 ,Z 2 )= true , Neighbor ( Z 1 ,Z 3 )= true and Neighbor ( Z 2 ,Z 3 )= false . Finally, for the analysis dimensions Temp and Gusts , the domains are respectively dom ( Temp )= { T m ,T l ,T s } and dom ( Gusts )= { 55 , 75 } . 3.2 Spatio-sequential Patterns Definition 1. Item and Itemset. Let I be an item , a literal value for the I  X  dom ( A
All items in an itemset are associated with different dimensions. An itemset with k itemsiscalled k -itemset.
 We define the In relationship between zones and itemsets which describes the occurrence of itemset IS in zone Z at time t in the database DB : In ( IS,Z,t )istrueif IS is present in DB for zone Z at time t . In our example, consider the itemset IS =( T m P m V l )then In ( IS,Z 1 , 12 / 23 / 10) is true as the itemset ( T m P m V l ) occurs for zone Z 1 on 12/23/10 (see Table 1). We now define the notion of interaction with neighbor zones.
 Definition 2. Spatial itemset. Let IS i and IS j be two itemsets, we say that IS i and IS j are spatially close iff and IS j that are spatially close, is called a spatial itemset and denoted by I To facilitate notations, we introduce a n -ary group operator for itemsets to be assigned by the operator  X  ( near ), denoted []. The  X  symbol represents the absence of itemsets in a zone. Figure 2 shows the three types of spatial itemsets that we can build with the proposed notations. The dotted lines represent the spatial dynamics.
The spatial itemset I ST =( T m  X  ( V l P m )) describes that events T m and V l P m occur in neighboring zones at the same time. The spatial itemset I ST =(  X   X  [ T m ; P l ]) indicates that T m and P l occur in two different zones neighbor to a zone where no event appears.
 Definition 3. Inclusion of spatial itemset. Aspatialitemset I ST = IS i  X  IS j is included ,denoted  X  , in another spatial itemset I ST = IS k  X  IS l ,iff IS i  X  IS k and IS j  X  IS l .
 The spatial itemset I ST =( T m P m  X  V l )is included in the spatial itemset I ST = ( T
We now define the notion of zones evolution according to their spatial neigh-borhood relationship.
 Definition 4. Spatial Sequence. A spatial sequence or simply S2 is an ordered the constraint of temporal sequentiality for all i  X  [1 ..m  X  1] .
 where the arrows represent the temporal dynamics and the dotted lines represent the environment.

A relationship generalization (or specialization) between S2 X  X  is defined as follows: Definition 5. Inclusion of S2. AS2 s = I ST 1 I ST 2 ...I ST m is more specific because ( T l P m  X  P l V s )  X  ( T l P m  X  P l V s ) and (55)  X  (55  X  V s ).
For a specific zone, we note s Z the associated spatial data sequence in the database DB . s Z contains or supports a spatial sequence s if s is a subsequence of s Z . The support of a spatial sequence s is thus defined as the number of zone supporting s . If the support of the spatial sequence is greater than a user-defined threshold, the sequence is frequent and corresponds to a spatio-sequential pattern ( S 2 P ). Nevertheless, in a spatio-temporal context, we need to define a more precise and suitable prevalence mea sure, as explained in the next section. 3.3 Spatio-temporal Participation The proposed spatio-sequential pattern allow to tackle both spatial and temporal issues. In order to manage in an efficien t way the mining of such patterns, a new filtering measure has to be defined. To highlight the participation of an item in a spatial sequence, we propose an adaptation of the participation index [6] which is a combination of two measures: spatial participation index and temporal participation index taking into account respectiv ely the spatial dimension and the number of occurrences in time.
 Definition 6. Spatial participation ratio Let s be a spatial sequence and I be an item of s ,the spatial participation ratio for I in s , denoted by SPr ( s, I ) is the number of zones which contain s divided by the number of zones where the item I appears in the whole database: Definition 7. Spatial participation index Let s = I ST 1 ,I ST 2 ,...I ST n be a spatial sequence, the spatial participation index of s denoted SPi ( s ) is the minimum of spatial participation ratio : Definition 8. Temporal participation ratio Let s be a spatial sequence and I be an item of s ,the temporal participation ratio for I in s denoted TPr ( s, I ) is the number of occurrences of s (i.e. the number of instances over time) divided by the total number of occurrences of I : Definition 9. Temporal participation index Let s = I ST 1 ,I ST 2 ,...I ST n be a spatial sequence, the temporal participation index of s denoted TPi ( s ) is the minimum of temporal participation ratio : We define the spatio-temporal participation index of a spatial sequence s , STPi ( s ), as: Given a spatio-temporal database DB , the problem of spatio-sequential pattern mining is to find all spatial sequences whose spatio-temporal participation index is greater than a user-specified threshold min stpi .

Note that the predicate  X  X TPi is greater than a user-threshold X  is antimono-tonic. If a spatio-sequential pattern s is not frequent, all patterns s such as s is included in s ( s s ), are also not frequent. This property is used in our pattern mining algorithm to prune the search space and quickly find frequent spatio-sequential patterns. In this section, we propose an algorithm called DFS-S2PMiner to extract spatio-sequential patterns considering both spatial and temporal aspects. DFS-S2PMiner adopts a depth-first-search st rategy based on successive projections of the database such as FP-Growth [5] and Prefixspan [8] for scalability purpose. Specifically, this algorithm is based on the pattern-growth strategy used in [5]. The principle of this approach is to extract frequent patterns without a can-didate generation step. This approach recursively creates a projected database, associates it with a fragment of frequen t pattern, and  X  X ines X  each projected database separately. The frequent patterns are extended progressively along a depth-first exploration of the search space.

First, we introduce the definition of the projection of a spatio-temporal database used in the algorithm. Let s be a spatio-sequence of the database DB . The projection of database DB w.r.t. s , denoted DB | s , is the set of suffixes of s in DB .

The algorithm 1 describes our recursive algorithm DFS-S2PMiner. First, the setoffrequentitems I and  X   X  I , denoted F 1 , is extracted from the projected database DB |  X  (line 1 of Algorithm 1). These items constitute extensions of sequence  X  . Note that in the first recursive call, DB |  X  corresponds to the initial database DB (since  X  = {} ). Then, for each of these items X  X  F 1 ,weextend the spatio-sequential pattern  X  with X (lines 3 and 4). Two types of extension are possible : 1) adding X to the last spatial itemset of the sequence  X  (line 3) or 2) inserting X after (i.e. the next time) the last spatial itemset of  X  (line 4). We check the measure of interest for thes e two spatio-sequential patterns (lines 5 and 9) and record frequent ones in the set of solutions F (lines 6 and 10). For each frequent pattern, the algorithm then performs another projection of the database using DB |  X  and recursively extends the pattern by invoking again the algorithm (lines 7 and 11). The algorithm stops when no more projections can be generated.
 Algorithm 1. DFS-S2PMiner
We use our running example (Table 1 and Figure 1) with min stpi =2 / 3to illustrate this algorithm.
 Iteration 1 (  X  = {} )  X  Extraction on frequent items and spatial items (line 1). The first  X  Extension of current sequence  X  (lines 3-4).  X  STPi processing and Recording solutions (lines 5-6 and 9-10).  X  Projection and Recursive call (lines 7 and 11). For each frequent Iteration 2 (  X  = ( P m ) )  X  Extraction on frequent items and spatial items (line 1). The first  X  Extension of current sequence  X  (lines 3-4). The first frequent item  X  STPi processing and Recording solutions (lines 5-6 and 9-10). The  X  Projection and Recursive call (lines 7 and 11). Thus, the algorithm Iteration 3 (  X  = ( P m V m ) )  X  Extraction on frequent items and spatial items (line 1). The frequent  X  Extension of current sequence  X  (lines 3-4). For example, the spatial  X  STPi processing and Recording solutions (lines 5-6 and 9-10). This  X  Projection and Recursive call (lines 7 and 11). When all frequent The algorithm thus proceed s generally in the same way whether items are spatial or not. The main difference is how to compute the support. The support of a spatial item is the number of zones where the item occurs at least once in their neighborhood (so we have  X   X  V l : 3 in Table 2). Notice that when the item  X   X  Y , the operator of n -ary group is used to represent the sequence as ( I The approach proposed in this paper has been integrated in a Java prototype, and it has been experimented on two real d atasets. The first one represents the evolution of dengue infection in a city during an epidemic (26 dates). The city is divided in 81 districts each one charact erized by 12 epidemic and environmental attributes (e.g. number of dengue cases , precipitation per day or presence of pools). The second dataset is a record of biological indicators in the Sa X  one rivers, for example, IBGN (Standardized Global Biological Index) and IBD (Biological Diatom Index). These indicators are associated with hydrological stations along the watercourse and raised up made by some stations along the watersheds of the Sa X  one. This dataset includes 815 samples associated to 223 stations (zones) and 10 attributes.

We compared our approach with the work proposed by Tsoukatos [11] since it is the closest work. Indeed, this work e xtracts sequences of itemsets repre-senting the evolution of each zone individually (but without taking into account neighbors as in our approach). Experiments have been done on an Intel Core I5 processor with 4G of RAM on Linux.

First, a qualitative evaluation of the results was done. We compared the pat-terns obtained by our approach with the ones obtained by the DFS Mine algo-rithm of Tsoukatos on the dengue dataset.

For example, both approaches could find classical sequential patterns such as  X  X ew pools, few precipitations and few graveyard are followed by few dengue, few precipitations and wind X  . However, our approach could also find complex patterns such as  X  X ew pools, few precipitations and few graveyard, followed by few pools and few precipitations in neighbor zones, are followed by few dengue in neighbor zones X  . This example gives an idea of the richness of our patterns by enabling to highlight the influence of neighbor areas.

When using the spatio-temporal participation index as measure of interest, we can X  X  compare any further th e extracted patterns since prevalence measures are different. While the approach of Tsoukatos keeps sequences occurring in many zones but not necessarily several times , our approach keeps sequences occurring in many zones and several times. The interest of our proposal is to consider the temporal weight of patterns.

Second, a quantitative evaluation of our approach was done. We compared the execution time of our algorithm with the DFS Mine algorithm proposed by Tsoukatos in [11]. Figure 4 shows execution times of DFS Mine (classical support) and DFS-S2PMiner algorithms (using classical support and spatio-temporal participation index) on the studied datasets for several thresholds. Execution times are relatively similar while our approach is doing more complex processing. Indeed, as shown by figure 5, the STPi measure allows an efficient pruning of the search space, even for the large dataset of the Sa X  one river. In this paper, we propose a new concept of spatio-temporal patterns called spatio-sequential patterns (S2P) . This concept enables to analyze the evolution of areas considering their set of features and their neighboring environment. An example application of these patterns is the study of the spatiotemporal spread of dengue w.r.t. epidemic, district and environmental data. A formal framework is established to define S2P generically. To extract these patterns, we propose a generic method called DFS-S2PMiner based on a depth-first strategy. A new prevalence measure has been defined to cope with the limits of the classical sup-port w.r.t. spatial and temporal aspects. Our proposal has been experimented on two real datasets. Results show the inte rest of the approach to extract efficiently rich spatio-temporal patterns.
Among possible future developments, we plan to extend the concept of neighborhood to n neighborhoods while allowing scalability. No new defini-tions are needed but an heuristic exploration of the search space may be required. Acknowledgments. We wish to thank the Department of Health and Social Affairs of New Caledonia, The Institute Pasteur, IRD and UNC for giving us the Dengue data set (Convention 2010). This work was partly funded by French contract ANR-2010-COSI-012 FOSTER.

