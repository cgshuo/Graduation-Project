 1. Introduction
Genetic algorithms (GAs) have been revealed as powerful tools for solving a wide variety of problems since their introduction by
Holland in 1975. Basically, they act as optimization tools able to tackle complex problems which are practically intractable from and Engineering such as Economics, Structural Design, Network
Design, Game Theory and Operations Research, to cite a few of them, have benefited from the use of GAs ( Moyne et al. 1995 ).
Moreover, GAs have also found application in the area of context the controller is formulated to have a set of parameters, which the GA tries to optimize according to the closed-loop performance associated with each set of candidate values. GA-based approaches to controller design can be condensed into three major categories: (1) The first one consists of integrating GAs with fuzzy or neuro-(2) The second one consists of using the GA in the offline (3) Finally, the third approach employs GAs to determine the There are several works pointing out the advantages of using GAs in the online estimation of the controller parameters ( Marra and Walcott, 1996; Kristinsson and Dumont, 1992; Lennon and Passino, 1999; Kumon et al., 2003) . Reported advantages include the fast convergence to adequate controller parameters ( Lennon of poles and zeros instead of plant coefficients and improved robustness properties with respect to traditional recursive estimation schemes ( Kristinsson and Dumont ,1992; Lennon and is that GAs are powerful tools to be included within the adaptive control framework.

Nevertheless, most of these works (even the most recent ones) do not tackle explicitly the stability issue in their development their evolution, which basically obeys probabilistic rules. Hence, works covering the adaptive control of systems using GAs do not but just a validation, through simulation or experimental work, of their applicability in practice ( Kristinsson and Dumont, 1992;
Lennon and Passino, 1999 ). Furthermore, those exploring the stability issue usually include a number of probabilistic-type hypotheses on the parameter evolution in order to guarantee the
In this paper, a two-degree-of-freedom (2-DOF) scheme to implement reference tracking adaptive controllers based on GAs is proposed. The main feature of the suggested approach is that it benefits from the genetic estimation of good properties for tracking performance without affecting closed-loop stability. This is proved under weak, feasible conditions on the GA parameters evolution. This benefit is obtained by implementing the control law according to a 2-DOF topology appearing in Soroka and
Shaked (1986) and Kuroiwa and Kimura (2003) . As it will be seen, this scenario stability is mainly guaranteed by an internal and fixed feedback controller whereas the tracking performance is attained by virtue of online readjustment of the genetic compensator blocks. In summary, the idea is to delegate stability to the internal compensator, due to which it will be shown to be weakly influenced by the evolution of the genetic population. This way, GAs can be safely exploited for reference tracking purposes.
The paper is organised as follows: Section 2 introduces the problem formulation and main objectives. In Section 3, the genetic design of the controller is commented. Section 4 states the stability properties of the resulting closed-loop system.
Section 5 is devoted to simulation examples while some concluding remarks end the paper. 2. Problem formulation
We consider the problem of controlling a general LTI continuous-time system with m inputs and p outputs described by an irreducible Left Matrix Fraction Description:
G  X  s  X  X  N 1  X  s  X  M  X  s  X  X  1  X 
Laplace variable s with unknown (matrix) coefficients and satisfying the following assumption.

Assumption 1. Upper-bounds for the plant (matrix) polynomial degrees are known: deg N  X  s  X  r n ; deg M  X  s  X  r m with n Z m Z 0 known.

Thus, we are considering the nominal model affected by parametric uncertainty. In particular, no unmodelled dynamics the scalar transfer function representation.

Since nowadays it is very common to control a continuous-time process using a discrete-time controller, we will consider a discrete model of the plant in order to synthesize a discrete-time controller. Therefore, the design procedure proposed in this paper will apply to both discretized continuous systems and to purely discrete ones just avoiding the previous discretization step. This set-up is preferable to the original continuous-time one in order to incorporate into the theoretical framework the way in which control systems are commonly implemented in practice. 2.1. Discrete plant model
A discrete-time Left Matrix Fraction Description of (1) is obtained using a zero order hold ( ZOH ) with sampling period T according to
H  X  z  X  X  Z 1 e sT s s G  X  s  X   X  X  1 z 1  X  Z 1 s G  X  s  X   X  X  1 z 1  X  Z  X  X  1 z 1  X  D 0 1 p  X  z 1  X  N 0 p  X  z 1  X  X  D 1 p  X  z  X  N p with
N  X  z 1  X  X  B 1 z 1  X  ...  X  B m z m
D  X  z 1  X  X  I p p  X  A 1 z 1  X  ...  X  A n z n where Z denotes the zeta -transform and z 1 2 q 1 (while z is equivalent to the one sampling period backward operator (one sample period ahead operator). The pair N r p  X  z  X  , D r Right Matrix Fraction Description and it will be used later.
Moreover, upon Assumption 1, the following degree relations regarding the discrete plant (2) hold: deg D p  X  z  X  r n ; deg N p  X  z  X  r m  X  3  X  since a ZOH has been used to obtain the corresponding discrete-orders allows specifying the size of the chromosomes in the GA formulation. Hence, the original problem is reformulated into the control of a discrete-time linear system with parametric un-certainty. Since the plant parameters are unknown, a genetic estimation algorithm will be used to estimate the value of the such estimated (matrix) polynomials in such a way that its use within an online adaptive control scheme results into an asymptotically stable closed-loop system. As commented in
Section 1, GA utilization within an adaptive controller usually lacks stability considerations. In the sequel, a concrete imple-mentation of a 2-DOF control law allows linking the advantages of the genetic estimation along with conventional LTI closed-loop stability analysis under weak conditions on the evolution of the genetic population. This is the main contribution of the paper. 3. Controller design procedure
This section describes the control scheme proposed to assess the control scheme is introduced in the following section. 3.1. Two degree of freedom (2-DOF) control law implementation
In this section we concentrate on the basic 2-DOF control law implementation introduced in Soroka and Shaked (1986) and
Kuroiwa and Kimura (2003) and displayed in Fig. 1 for convenience.

Given a general two-parameter LTI compensator, different realizations are possible. As pointed out in Kwok and Davison (2007) not all of them possess the same properties. The above topology is adequate to be used within the genetic algorithm context. Let us see why: within this configuration, the (matrix) transfer function from the reference r k to the output y k computed to be (dropping z hereafter for the sake of simplicity):
T yr  X  N r p  X  RD r p  X  SN r p  X  1  X  RD r p  X  SN r p  X  C  X  N order to show the role played by each compensator in the closed-loop properties. Thus, the cancellation in (4) can be performed when RD r p + SN r p is stable. Note that this (matrix) polynomial represents the dynamic equation of the closed-loop system appearing when a single degree of freedom configuration (i.e., to be designed to stabilize the system as in a standard 1-DOF control configuration (stabilising compensator). Having stabilized the inner-loop, the cancellation in (4) can be finally performed leading to an output only conditioned (in the steady-state) by the external transfer function N r p C according to: y  X  Z 1  X  N r p Cr k  X  t k  X  5  X  where t k is an exponentially vanishing (vector) signal associated with potential non-zero initial conditions of the cancelled modes.
Hence, the steady-state output of the closed-loop is determined
C stabilizing the inner-loop. Thus, within this control configura-tion, both controllers can be designed independently according to different design criteria. Therefore, the problem is decomposed into the design of a 1-DOF robust stabilising compensator, followed by the design of a tandem of external compensators, which are aimed at selecting the behaviour of the output. The above scheme is enhanced when parametric uncertainty in the nominal model is taken into account in the following section. 3.2. 2-DOF control topology in the presence of parametric model uncertainty
If a nominal model of the plant, denoted by ^ N r p ; ^ D known instead of the actual plant N r p ; D r p ; N p ; D closed-loop control diagram ( Fig. 1 ) becomes: which implies a closed-loop transfer function
T  X  N r p  X  RD r p  X  SN r p  X  1  X  R ^ D r p  X  S ^ N r p  X  C  X  6  X 
Therefore, in the case when a parametric mismatch between the plant model and the actual plant is taken into account, the above separation principle is no longer valid since the stable cancellation in (4) cannot be performed in (6). Hence, the closed-loop response is impacted (and, in general, degraded) by the poles of the inner control loop.
 Moreover, it can be concluded from (6) that the compensator C is still playing the same role as before; it has to stabilize the inner loop but now, the tracking performance is associated with all compensators C 0 , C 1 and C 2 (involving ^ D r p and and consequently the design independence no longer holds .
Nevertheless, by converting the external compensators into adaptive, we will be able to correct the (potential) mismatch between the nominal model and the real system providing the cancellation in (6) achieving a certain level of tracking perfor-mance of the closed-loop while the stability will be (mainly) guaranteed by the internal compensator.
 In particular, we will consider the scenario where a stabilizing LTI controller C 0 is obtained from the nominal plant model in order to provide good stability margins whereas the external compensators C 1 , C 2 are adapted online and thus converted into external compensators obtained by setting the values of the estimated polynomials ^ N r p k ; ^ D r p k in C 1 k , C 2 k same transfer function C in Fig. 2 : C
The plant matrix factors are to be estimated taking the advantages of the GAs. In this way, the stability of the closed-loop is achieved by the internal feedback compensator while the genetic estimation is to be used to update the out-of-the-loop ones through the identified plant factors. Thus, a stable adaptive scheme able to achieve adequate closed-loop performance is proposed while incorporating the advantages of a genetic the advantages of the genetic estimation are used in the external compensators design. Thus the stability problem is separated from the design of the genetic algorithm leading to a modular way to design the genetic control law.

Note that, in this scenario, we do not worry about the design of the internal controller: it is obtained using any of the robust design procedures proposed in the literature for 1-DOF control configurations (see, for instance, Morari and Zafirou, 1989; is to stabilize the inner-loop system. Thus, the following assumption is made in order to carry out the stability proof:
Assumption 2. The fixed feedback controller C 0 stabilizes the actual inner loop. 3.3. Genetic estimation of the plant
The genetic estimation of the plant acts by modifying the external compensators. In order to subsequently state the stability of the closed-loop with time-varying external sub-systems, the following slight technical assumption on the GA population evolution is made:
Assumption 3. Each element of the population of the genetic algorithm is bounded at all time.

Remarks 1. This boundedness property is typical in many genetic algorithms used in identification (see, for instance, Kristinsson and Dumont, 1992; Lennon and Passino, 1999 ), and hence, is a very slight assumption on applications of GAs to control.
The above assumption is needed to guarantee closed-loop stability and enables the use of any genetic algorithm proposed in the literature satisfying Assumption 3 to perform the identifica-tion process. This makes the proposed setup of great flexibility and interest. However, in order to show some simulation examples showing the usefulness of the proposed scheme, the following genetic estimation algorithm is proposed, following the steps given in Ibeas and de la Sen (2006) : 3.4. Genetic estimation algorithm This section contains an estimation algorithm inspired from
GAs. Its main purpose relies on the fact of showing, in examples, the behaviour of the proposed 2-DOF scheme. Thus, in the simulation example. 3.4.1. Codification
Chromosomes (individuals) will be (matrix) real-valued vec-be denoted by h  X  k i  X  at each sampling time t  X  kT s ; k size of the population). These vectors are selected in such a way that the corresponding output of the plant could be written for each chromosome as: y  X  u T hi h  X  A 1 A 2 ... A n B 1 B 2 ... B m hi where f k is the so called regressor, containing input X  X utput measured data form the system. In other words, chromosomes are discrete-time plant proposed, for instance, in Astrom and Witten-mark (1984). 3.4.2. Fitness evaluation
The fitness of each individual is evaluated using the deviation of each potential chromosome output (8) from the actual output of the plant y k . In particular, the fitness measure at time t  X  kT s ; k A N is:
J  X  where J  X  i  X  k denotes the fitness of individual h  X  i  X  positive offset used to guarantee the well-posedness of (9). Note of the actual system. In Ibeas and de la Sen (2006) , interested reader can find a number of alternative fitness functions. 3.4.3. Offspring generation and mutation
The new individuals for the next generation (offspring) are obtained from the previous generation (parents) using the following algorithm:
Algorithm 1. Generation of offspring for k 4 1 else end_if end_for h ^
N end_for { h removed from the  X  X or X  loop and p is a random number belonging to the interval [ 1,1].

The algorithm works as follows: the designer initializes the tentative chromosomes either in a random way or taking into each sampling time, the potential set of plant parameters are evaluated according to their fitness evaluation figure (9). Then,
This element is used to parameterize the external compensators duals, the offspring is obtained by guiding the remaining elements in the direction of the best one with a gain proportional to the weighted distance from the original individual to the best one.
The weight is proportional to the difference in their evaluation functions. The best individual is not modified in this step. This process is schematically described in Fig. 3 .

Finally, as Fig. 4 below shows, the best individual is randomly mutated with amplitude proportional to its distance to the second best vector. Convergence properties are not analytically stated, but simulation examples will show that population finally converges to a finite fixed value of the estimated parameters as required by Assumption 3.
 3.5. Control law
The discrete-time control law composed of the sequence of control inputs u k 1 k  X  0 is generated according to the diagram the adequate behaviour of the scheme, the following feasible technical assumptions are considered.
 Assumption 4. The reference signal r is bounded.

Furthermore, since the external controller C determines the behaviour of the closed-loop response (4),(6) it must satisfy the following assumption to guarantee closed-loop stability. Assumption 5. The compensator C is strictly stable.

There are several ways to generate the control law depending on the design of the compensators. Interested reader can consult, for instance, Soroka and Shaked (1986) and Astrom and Witten-mark (1984) . Finally, the continuous-time control law is obtained by using a zero-order hold: u  X  t  X  X  u k ; t A kT s ;  X  k  X  1  X  T s  X   X  10  X  4. Closed-loop stability
With the above definitions for the plant and control law implementation, we are able to state the stability result. Theorem 1. The feedback control system for the plant (1) through its discretized model (2) described in Fig. 2 with compensators satisfying Assumptions (2) and (5) is globally stable provided that genetic estimation and reference signal satisfy Assumptions (3) and(4).
 the population of the GA has to be bounded at all time. The key property to assess the stability of the closed-loop despite any probabilistic GA (satisfying Assumption 3) being used is the particular implementation of the control law, which allows to the design of the external compensators.

The proof is organised into three steps: 1. The output of the first compensator C 1 is proved to be bounded provided Assumptions 3, 4 and 5 hold. be bounded provided Assumptions 3, 4 and 5 hold. 3. Finally, the closed-loop system is written as the internal-loop with two external bounded input signals, namely, r 1 and r shown in the following Fig. 5 .

Hence, the stability is deduced from the corresponding closed-loop calculation provided that Assumption 2 holds Let us proceed in more detail with each of the commented steps. 1. Proof of the boundedness of r 1 .

Consider the transfer function where r denotes the reference input which is bounded by Assumption 4. Therefore there exists G 4 0 such that : r : r
Note that (11) represents a system with time-varying (matrix) numerator (because of the ^ D r p k factor, adapted online by the
GA) and fixed (matrix) denominator, since C is fixed, i.e., it is chosen at the beginning to provide sufficient bandwidth for tracking purposes. Thus, the state-space discrete-time repre-sentation of (11) is of the form: r 1 k  X  C T 1 x k  X  D r k  X  12  X  Random Perturbation with  X  A 1 ; B 1  X  k  X  ; C 1  X  k  X  ; D 1  X  k  X  X  where A 1 stable matrix whose eigenvalues are the constant strictly stable zeros of C d ( z ) from Assumption 5, ( Astrom and Witten-mark, 1984). It is important to note that r 1 could still diverge due to presence of the time-varying polynomial operator ^ (Tsakalis and Ioannou, 1992 ), the state-space setting is conveniently adopted here to prove that this is not the case.
The solution to (12) is: x  X  A k 1 x 0  X 
Upon Assumption 3 holds, there exists b 4 0 such that : B 1  X  k  X  : ; : C 1  X  k  X  : ; : D 1  X  k  X  : o b 8 k Z 0
Moreover, there are constants C 4 1 and 0 o r o 1 such that :
A 1 : k r C r k since A 1 is strictly stable because the compen-sator block C is LTI stable by Assumption 5. Hence, (13) can be upper-bounded as: : x k : r C r k : x 0 :  X  b C C or, equivalently : x k : r C r k : x 0 :  X  b C C provided : x 0 : o 1 , since 0 o r o 1 and r k -0as k -N conclusion, : x k : o 1 , 8 k Z 0 and, hence, : r 1 k : r : C T 1 :: x k :  X  : D 1 :: r k : r b : x k :  X  b C
Finally proving in the boundedness of r 1 . 2. Proof of the boundedness of r 2 .

The relation between r 2 and the reference signal r is: r  X  ^ N r p k Cr  X  ^ N r p k C n C d 1 r state-space description of the above system given by  X  A state-space realization being the same as in the previous point and the properties of the estimation algorithm still hold, the boundedness of r 2 k is obtained by repeating the same steps as in the first point. Thus, we have already proved that the signals r 1 and r 2 are both bounded. 3. Representation of the closed-loop system as a system with exogenous inputs
Thus, we consider the control system with external signals represented in Fig. 5 . The output is then computed to be y  X  X  N r p  X  RD r p  X  SN r p  X  1 S r 2  X  X  R  X  D p R r  X  N
Since Assumption 2 holds and r 1 , r 2 are bounded signals from the previous steps, the output of the above LTI system is also bounded. Thus, the stability of the discrete-time closed-loop system is finally proved. Hence, provided the stability of the discrete-time system and considering that there is no finite escape time since the plant is linear, the boundedness of the continuous-time original system can be concluded from
Astrom and Wittenmark (1984). Furthermore, since steps 1 and 2 below hold for any : x 0 : o 1 , the stability is global, finally proving Theorem 1. 5. Simulation example
This section contains a simulation example concerning the genetic estimation algorithm described in the previous Section 3.
Without loss of generality, we will apply the described procedure to a SISO discrete-time plant, described by the following transfer function: H  X  z  X  X  z 2 0 : 6 z  X  0 : 0875 z 3 1 : 9 z 2  X  0 : 73 z 0 : 195
With associate parameter vector, according to (8) y  X  1 : 90 : 73 0 : 195 1 0 : 60 : 0875 
The population is composed of 250 individuals randomly initialized, while the updating of the offspring is done by the algorithm proposed in the previous Section 3. The internal controller used to stabilize the inner loop (and, hence, satisfies Assumption 2) is selected to be:
C  X  z  X  X 
This controller has been designed to robustly stabilize the nominal model of the plant, given by the first chromosome of the population
H  X  z  X  X  well. On the other hand, the compensator block C appearing in the two prefilters in (7) is selected to be:
C  X  z  X  X  1 z 3 0 : 6 z 2  X  0 : 11 z 0 : 006 according to bandwidth requirements for tracking performance.
The reference signal is r  X  t  X  X  sin  X  4 p t  X  X  3sin  X  6 p t  X  X  2sin  X  8 p t  X  with a sampling period of T s  X  0 : 02s. The following simulations are obtained:
As shown in Fig. 6 , the output of the system with the genetic estimation improves the use of a single traditional estimation algorithm. This property is not surprising due to the relationship between multi-estimation controllers and GA pointed out, for appropriate working of the control system with the genetic estimation introduced in Section 3.3. Fig. 7 shows the boundedness of the best estimator, leading to an adequate closed-loop performance as illustrated in Fig. 6 . 6. Conclusions
In this paper, a genetic adaptive control scheme capable of guaranteeing closed-loop stability is proposed. The control law is based on a 2-DOF scheme, which displaces the stability require-ments to an internal stabilizing compensator whereas genetic estimation provides online readjustments of two external com-pensators in charge of improving the closed-loop behaviour. If the LTI internal compensator provides robust stability, it has been proved under weak conditions on the population evolution (only required to remain bounded at all time) that the GA adaptation mechanism for the prefilters does not influence the closed-loop stability. This contrasts with previous works where the evolution of the chromosomes influences the stability properties, being difficult or even impossible to guarantee it. Moreover, the proposed approach is flexible enough to be integrated within a great variety of genetic estimation algorithms proposed in the literature, which can outperform traditional estimation methods, as it has been illustrated in the simulation example and reported in the literature.
 References
