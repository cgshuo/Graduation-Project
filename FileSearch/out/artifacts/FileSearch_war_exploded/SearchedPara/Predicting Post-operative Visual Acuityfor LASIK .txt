 Refractive surgeries for eye are performed to correct (normalize) the refractive state of the eye, to decrease or eliminate dependency on glasses or contact lenses. This can include various methods of surgical remodeling of the cornea or cataract surgery. LASIK is a refractive eye surgery that uses a laser to correct nearsight-edness, farsightedness, and/or astigmatism. In LASIK, a thin flap in the cornea is created using either a micro-keratome blade or a femto-second laser. The sur-geon folds back the flap, then removes some corneal tissue underneath using a laser. The flap is then laid back in place, covering the area where the corneal tissue was removed. With nearsighted people, the goal of LASIK is to flatten the steep cornea; with farsighted people, a steeper cornea is desired. LASIK can also correct astigmatism by smoothing an irregular cornea into a more normal shape. LASIK surgeries are highly popular; over 10 million LASIK procedures have been performed in the United States alone in the past decade Motivation. While overall patient satisfaction rates after primary LASIK surgery have been around 95 %, it may not be recommended for everybody for two reasons: (1) high cost with potentially no significant improvement for certain types of patients, and (2) possible eye complications after the surgery. LASIK surgeries cost approximately $2000 USD per surgery. An ability to predict post-operative UCVA can help patients make an informed decision about investing their money in undergoing a LASIK surgery or not. It can also help surgeons recommend the most promising type of laser surgery to the patients. How can we perform this prediction? Further, while performing such surgeries, surgeons need to set multiple parameters like suction time, flap and hinge details, etc. These are often set using manually designed rules. Can we design a data driven automated method to suggest the best settings for a patient undergoing a laser surgery of a certain type? Problem Definition. In this paper, we address the following problem. Given: Pre-operative examination results and demography information about a patient.
 Predict: Post-operative UCVA after one day, one week and one month of the surgery.
 Challenges. The problem is challenging because (1) large amount of data about such surgeries is not easily available; (2) there are a lot of pre-operative mea-surements that can be used as signals; and (3) data is sparse, i.e., there are a lot of missing values.
 Brief Overview of the Proposed Approach. We model the task as a regres-sion problem. We use domain knowledge to pre-process data by transforming a few categorical features into binary features. We also use average values to impute missing values for numeric features. For categorical features, we impute missing values using the most frequent value for the feature. We evaluate multi-ple regression approaches. Our experiments on a dataset of 791 surgeries provides an RMSE of 0.102, 0.094 and 0.074 for the predicted post-operative UCVA after one day, one week and one month of the surgery respectively.
 Main Contributions. In summary, we make the following contributions in this paper.  X  We propose a critical problem of predicting post-operative UCVA for patients undergoing LASIK surgeries.  X  We model the task as a regression problem. We explore the effectiveness of demographic, pre-operative features and surgery settings for the prediction task. To the best of our knowledge, this is the first work to systematically explore this critical problem using machine learning methods.  X  Using a dataset of 791 LASIK surgeries performed on 404 patients from 2013 and 2014, we show the effectiveness of the proposed methods. The dataset is made publicly available 2 .
 Paper Organization. The paper is organized as follows. We start with a basic introduction to laser surgery procedure in Sect. 2 . In Sect. 3 , we discuss various features that can be used for post-operative UCVA prediction. Further, in Sect. 4 , we discuss various kinds of regression methods that can be used for the task. In Sect. 5 , we present dataset details, and also insights from analysis of results. We discuss related work in Sect. 6 and conclude with a summary in Sect. 7 . In this section, we discuss main steps in a typical laser surgery. This will help us understand the importance of features discussed in Sect. 3 . Further, we also discuss various types of laser surgeries depending on the laser ablation profile.  X  Flap creation: A soft corneal suction ring is applied to the eye, holding the eye in place. Once the eye is immobilized, a flap is created by cutting through the corneal epithelium and Bowman X  X  layer. This process is achieved with a mechanical micro-keratome using a metal blade, or a femto-second laser that creates a series of tiny closely arranged bubbles within the cornea. A hinge is left at one end of this flap. The flap is folded back, revealing the stroma, the middle section of the cornea.  X  Laser remodelling: The second step of the procedure uses a laser to remodel the corneal stroma. The laser vaporizes the tissue in a finely controlled manner without damaging the adjacent stroma. The layers of tissue removed are tens of microns thick.  X  Repositioning of the flap: After the laser has reshaped the stromal layer, the
LASIK flap is carefully repositioned over the treatment area by the surgeon and checked for the presence of air bubbles, debris, and proper fit on the eye. The flap remains in position by natural adhesion until healing is completed. follows.  X  Plano-scan-LASIK: During the plano-scan LASIK procedure the corneal tissue is evenly ablated by the laser beam.  X  Aspheric-LASIK: Using the aspheric profile means to ablate the corneal tis-sue in an  X  X gg-shaped X  way using a  X  X lying spot X  laser beam, similar to an
American football.  X  Tissue-saving-LASIK: The tissue-saving profile is one where the aim is to save as much corneal tissue as possible during the laser ablation time in case of borderline cases with regard to the initial corneal thickness when the standard
LASIK procedure is no longer possible.  X  Wavefront-guided-LASIK: In case of the application of the wavefront guided
LASIK procedure, which is often also called  X  X ndividualized X  or  X  X ersonalized X  treatment LASIK, the eyes are measured pre-operatively using a wavefront pattern scanner. By using the wavefront guided LASIK procedure aberrations can be eliminated and therefore result in an optimum of visual acuity as well in daylight as in night-vision.
 For more details about the fundamentals, surgical techniques and complica-tions in LASIK surgeries, the reader is redirected to [ 2 ]. In this section, we discuss various features that we use to learn the regression model for predicting post-operative UCVA. 3.1 Demography Features Intuitively, post-operative UCVA must depend on features of the patient. Hence, we consider two important demography features: age and gender. 3.2 Pre-operative Examination Features Before the surgery, the patient X  X  corneas are examined with a pachymeter to determine their thickness, and with a topographer, or corneal topography machine, to measure their surface contour. Using a beam of light, a topographer creates a topographic map of the cornea. Using this information, the surgeon calculates the amount and the location of corneal tissue to be removed. We use the following features obtained using such pre-operative examination.  X  Left/right eye: This is a binary feature to indicate the eye which is being operated upon: OD (right) or OS (left).  X  Uncorrected Visual Acuity (UCVA): Visual acuity score without the aid of glasses or contact lenses.  X  Uncorrected Near vision: Visual acuity measured using a small chart held near the patient.  X  Corrected Near vision: Visual acuity measured using a small chart held near the patient with glasses.  X  BCVA with glasses: The best acuity score one can achieve with glasses.  X  Sphere: This indicates the amount of lens power, measured in diopters (D), prescribed to correct nearsightedness (  X  ) or farsightedness (+). The term  X  X phere X  means that the correction for nearsightedness or farsightedness is  X  X pherical, X  or equal in all meridians of the eye. This is measured using retinoscopy as well as using an auto-refractor leading to two separate features.  X  Cylinder: This indicates the amount of lens power for astigmatism. The term  X  X ylinder X  means that this lens power added to correct astigmatism is not spherical, but instead is shaped so one meridian has no added curvature, and the meridian perpendicular to this  X  X o added power X  meridian contains the maximum power and lens curvature to correct astigmatism. This is measured using retinoscopy as well as using an auto-refractor leading to two separate features.  X  Axis: This describes the lens meridian that contains no cylinder power to correct astigmatism. The axis is defined with a number from 1 to 180. The number 90 corresponds to the vertical meridian of the eye, and the number 180 corresponds to the horizontal meridian. This is measured using retinoscopy as well as using an auto-refractor leading to two separate features.  X  Spherical equivalent: This indicates the spherical power whose focal point coincides with the circle of least confusion of a sphero-cylindrical lens. Hence, the spherical equivalent is equal to the algebraic sum of the value of the sphere and half the cylindrical value.  X  Slit lamp Examination: Slit lamp is an apparatus for projecting a narrow flat beam of intense light into the eye. It helps in the microscopic study of various structures of the eye like eyelid(s), lashes, conjunctiva, cornea, anterior cham-ber, pupil, iris, vitreous, and retina. Typical values for this column could be  X  X ormal X ,  X  X orneal scar X ,  X  X ub epithelial scar X ,  X  X uchs heterochromic iridocy-clitis X , etc. We convert it to a binary column  X  X ormal X  versus  X  X bnormal X .  X  IOP (intraocular pressure): The pressure of the intraocular fluid, usually mea-sured in millimeters of mercury.  X  Retina examination: This is a binary feature and can take the following val-ues:  X  X ormal X  or  X  X bnormal X . Abnormal cases include various forms of retinal issues like  X  X horioretinal Atrophy X ,  X  X amilial Exudative Vitreo-retinopathy (FEVR) X ,  X  X arrage laser done X ,  X  X etinal pigment epithelium (RPE) atro-phy X ,  X  X ilted disc with temporal pallor X , etc.  X  Steep-K, Flat-K and Axis@Flat-K: For a given corneal topography reading, the lower diopter number represents the less steep meridian of the cornea, or the  X  X lat-K X . The higher diopter number represents the steepest meridian of the cornea, or the  X  X teep-K X . Usually these are numbers between 40 and 50. The difference between the horizontal (higher) and vertical (lower) diopter readings gives you the approximate amount of corneal astigmatism, or cylinder correction. Axis@Flat-K is a number from 1 to 180.  X  Thinnest Preop Corneal Thickness: The minimum thickness of the cornea.
This usually varies from 450 to 650 microns.  X  Topography machine: This indicates the type of topography machine used. In our dataset, three kinds of machines were used: Orbscan, Galilei and Oculyzer. 3.3 Surgery Settings This set of features include various settings used when performing the surgery. The following is the list of features used.  X  Surgery type: This depends on the laser ablation profiles and can be of 4 types: Plano-scan-LASIK, Aspheric-LASIK, tissue-saving-LASIK, or wavefront-guided-LASIK.  X  Flap thickness: Most surgeons choose flap thicknesses between 100 120  X  .  X  Suction time: Suction time should be as short as possible to minimize optic nerve head and retinal ischemia (i.e., reduced vision) during LASIK. This usually varies from half a minute to a minute.  X  Optic zone: This is the size of the treatment area. Common optic zone diameter is between 6 X 7 mm. It has been shown that a larger surgical optical zone diameter significantly decreases higher order aberrations after LASIK.  X  Flap diameter: Diameter of the flap.  X  Flap side cut angle: Previously, all side cuts were made at 90 surgeons believe that certain cut angles could lead to stronger adhesion, less dry eyes, or better cosmetic looks 3 .  X  Hinge details: This includes hinge position, hinge angle, and the hinge width.
Hinge position is usually kept at 90 for most of the surgeries. Hinge angle can be varied from 40 to 60  X  . Hinge width varies from 3 to 4.5 mm. We model the post-operative UCVA prediction task as a regression problem using the features described in Sect. 3 . We explore four approaches for regression as follows.  X  GDBT Regression: We used an efficient implementation of the Multiple Addi-tive Regression Trees (MART) gradient boosting algorithm. MART learns an ensemble of regression trees, which is a decision tree with scalar values in its leaves. The ensemble of trees is produced by computing, in each step, a regres-sion tree that approximates the gradient of the loss function, and adding it to the previous tree with coefficients that minimize the loss of the new tree. The output of the ensemble produced by MART on a given instance is the sum of the tree outputs.  X  Online Gradient Descent based Regression: Linear regression is used for mod-eling the relationship between a scalar dependent variable and one or more explanatory variables (or independent variables). Linear regression models are often fitted using the least squares approach. Stochastic gradient descent is a gradient descent optimization method for minimizing an objective function that is written as a sum of differentiable functions. Online Gradient Descent based Regression is a form of linear regression which uses Stochastic gradient descent for optimization.  X  Neural network based regression: A neural network model is defined by the structure of its graph (namely, the number of hidden layers and the number of neurons in each hidden layer), the choice of activation function, and the weights on the graph edges. The neural network algorithm tries to learn the optimal weights on the edges based on the training data. We use a neural network with one hidden layer and a single output neuron.  X  Poisson Regression: Poisson Regression assumes that the unknown func-tion, denoted Y has a Poisson distribution, i.e., given the instance x = is given by Eq. 1 . where E ( Y | x )= e  X  i x i . Given the set of training examples, the algorithm tries to find the optimal values for  X  0 , ...,  X  D  X  1 by trying to maximize the log likelihood of the parameters given the input. The likelihood of the parame-ters  X  0 , ...,  X  D  X  1 is the probability that the training data was sampled from a distribution with these parameters. In this section, we describe our dataset, metrics and experiments to analyze relative accuracy of various methods proposed in Sect. 4 for the post-operative UCVA prediction problem. 5.1 Dataset The dataset contains information for 404 patients in the age range of 18 to 47 years. 215 of these patients are females, and the rest are males. The 791 LASIK surgeries were done in 2013 and 2014. 397 of the surgeries were performed on the left eye and remaining ones on the right eye. Most of the surgeries are either of the Wavefront-guided-LASIK type or of the Plano-scan-LASIK type. Orbscan is the most popular topography machine used; Oculyzer being the second most popular one. Pre-operative UCVA values vary between 0.15 and 2. Post-operative UCVA values vary between  X  0 . 2 and 1 for day 1 ,  X  0 . 3 and 1 for week 1 and  X  0 . 2 and 0.95 for month 1 after the operation. Although usually large datasets improve accuracy of the learned machine learning models, it is difficult to obtain large datasets in this domain.
 Data Pre-processing. The dataset contains features like  X  X lit lamp examina-tion X  and  X  X etina examination X . Although these columns contain a few cases of various abnormalities, specific types of abnormalities are not very useful due to low occurrence frequency of such abnormal cases in the dataset. Hence, we group all abnormal cases into a single attribute value called  X  X bnormal X  and convert the two features to binary-valued features with two values:  X  X ormal X  and  X  X bnormal X .
 have missing values across all attributes. The most number of missing values (272) were for the IOP attribute. Categorical features were converted to numeric features by mapping them to consecutive integers. Missing values were replaced by the average value for the column for numeric features, and by the most frequent value for the column for categorical features. 5.2 Metrics Measuring Visual Acuity. Visual acuity is measured by a psycho-physical procedure and as such relates the physical characteristics of a stimulus to a subject X  X  percept and his/her resulting responses. Measurement can be done by using an eye chart, by optical instruments, or by computerized tests like the FrACT 4 . Visual acuity is often measured according to the size of letters viewed on a Snellen chart or the size of other symbols, such as Landolt Cs Tumbling E 6 .
 In some countries, acuity is expressed as a vulgar fraction, and in some as a decimal number. Using the meter as a unit of measurement, (fractional) visual acuity is expressed relative to 6/6 (normal vision). Otherwise, using the foot, visual acuity is expressed relative to 20/20. For all practical purposes, 20/20 vision is equivalent to 6/6. In the decimal system, acuity is defined as the recip-rocal value of the size of the gap (measured in arc minutes) of the smallest Landolt C, the orientation of which can be reliably identified. A value of 1.0 is equal to 6/6.
 LogMAR is another commonly used scale, expressed as the (decadic) log-arithm of the minimum angle of resolution. The LogMAR scale geometric sequence of a traditional chart to a linear scale. It measures visual acuity loss: positive values indicate vision loss, while negative values denote nor-mal or better visual acuity. In this paper, we use the LogMAR scale for visual acuity. In practice, LogMAR values can vary from  X  0 . 3 (equivalent to 20/10) to 2 (equivalent to 20/2000).
 Evaluating Regression Results. In this work, we use regression to predict post-operative UCVA in LogMAR. To evaluate regression results, we use three metrics: L1, L2 and Root Mean Squared Error (RMSE). Let N be the number of instances. Consider 2 vectors of UCVA across various instances: true (T) and predicted (P). The three metrics are then defined as follows.  X  RMSE (Root mean squared error) is the square-root of the L2 error. Lower values of L1, L2 and RMSE are better. 5.3 Results We use four different regression mechanisms for the prediction task. 10-fold cross validation is used to report accuracy values. Tables 1 , 2 and 3 show the accuracy numbers for day 1, week 1 and month 1 after the operation without using the surgery settings features. Values in the brackets indicate standard deviation. We can see that in all the cases, GDBT Regression performs the best. This is in line with various other studies which claim that ensemble based methods perform well.
 for the one-day after the surgery prediction. The figure illustrates the accuracy of the prediction model.
 improve a little compared to using only demography and pre-operative exami-nation features. However, the results are not significant. This could be because the current surgery settings are already set to optimum values, or because of the small amount of available training data.
 tures using the CfsSubsetEval attribute selector [ 13 ] and the Best First search method. CfsSubetEval evaluates the worth of a subset of attributes by consid-ering the individual predictive ability of each feature along with the degree of redundancy between them. The most important features across the datasets are shown in Table 4 .
 Surprisingly, pre-operative UCVA does not turn up in the top important features possibly due to high correlation with the above features. We show the variation of each of these important features with respect to the post-operative UCVA (day 1) in Fig. 2 .
 Data Mining in Healthcare. Recently there has been a lot of work in the data mining community across various aspects of health care. Main areas of focus include personalized medicine [ 9 ], phenotyping [ 7 , 14 , 15 ], analysis of electronic 6 ]. However, there has not been much work on applying machine learning and data mining techniques to problems in ophthalmology.
 Visual Acuity Prediction. Our work is most related to previous work on visual acuity prediction. There has been some previous work on predicting visual acuity in the ophthalmology community but it differs from our work in multi-ple aspects like the type of surgeries, the type of features used and the type of methods used for prediction as detailed in the following. Baron et al. [ 3 ]use pupil size, ablation size, refractive error, and photoreceptor directional sensi-tivity as features and a point-spread function as the method to predict visual acuity. We explore a much larger set of features using regression. Also, their aim is to predict correlations only rather than the post-operative UCVA values. Besides this they perform analysis for PRK (photorefractive keratectomy) surg-eries while we focus on LASIK surgeries. Olsen et al. [ 17 ] use coloboma size, optic nerve color, foveal development, and subfoveal retinal pigment epithelial changes as features and linear regression as the method to predict visual acuity for children. Unlike our work, this is not related to LASIK surgeries, and is useful for children only. There are various instruments like white-light interferometer (Lotmar Visometer) and a Snellen chart projector (Guyton-Minkowski Potential Acuity Meter) to predict visual acuity after cataract surgeries [ 10 , 19 ] but none for predicting post-operative UCVA for LASIK surgeries. Another line of work deals with expressing visual acuity as a function of various other eye metrics like  X  X upil plane X  and  X  X mage plane X  [ 12 ], 31 different metrics of image qual-ity [ 8 , 20 ], wavefront aberrations [ 21 ], Zernike Mode and Level of Root Mean Square Error [ 1 ]. However, all of these approaches are for estimating current visual acuity rather than for predicting post-operative visual acuity. In short, to the best of our knowledge, the proposed work is the first work to systematically explore the critical problem of predicting the UCVA after LASIK surgeries using machine learning methods. Predicting post-operative UCVA is a critical task. We modeled the task as a regression problem. We experimented with multiple regression models and also a large number of pre-operative examination features. We found that BCVA with glasses, Spherical equivalent, Slit lamp examination, IOP, Retina examination, Axis@Flat K are very important features. Our models can provide predictions for UCVA after 1 day, 1 week and 1 month with an RMSE of 0.102, 0.094 and 0.074 respectively. The surgery settings seemed to reduce the RMSE but the reduction was not statistically significant. In the future, we plan to examine the impact of surgery settings on the UCVA prediction task with larger amount of data. We also plan to extend the set of features to include other features like ethnicity and profession of patients, and also features related to surgeons like their expertise, experience, etc.

