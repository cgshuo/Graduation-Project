 1. Introduction for various reasons. It can be distributed over many machines (e.g., the Web and P2P networks), hidden behind searchable interfaces (e.g., search engines and online social networks), scattered among a larger graph (e.g., various communities in online social networks). Regardless of the causes, a common challenge is to reveal the properties of such graphs when we obtaining uniform random node (RN) samples, such as uniform random web pages from the Web ( Henzinger, Heydon, social networks ( Gjoka, Kurant, Butts, &amp; Markopoulou, 2009 ). Once uniform random samples are obtained, network  X  make sure that the estimation is within the range of 70 : 51 14 : 10 with 95% confidence, the relative standard error RSE should be around 0.1, and the required sample size n  X  35 : 95 are obtained with high cost because they are not provided directly by the data sources. Costly sampling methods, such as rejection sampling, have to be employed to obtain uniform samples. In the process, many samples are retrieved and rejected as invalid. The actual samples retrieved are many times larger than 129 ; 240, depending on the sampling methods allowed. random sampling to obtain meaningful estimations. With increasingly more applications of big data analyses, there is an urgent need to find a method to reduce such a large variance.

Recent developments made empirical observations that simple random walk (RW) sampling or its extensions can im-observations are data dependent. Random walk can be much worse than uniform random sampling for other datasets, even when the graph is scale-free and the variance is very high as we will show in Section 4.3 .

We find that it is random edge (RE) sampling, not RW sampling, that reduces the variance for graphs with large degree variation. In addition to this empirical observation, we explore the reason why RE outperforms RN sampling, and why RW clear whether RE sampling works better.

This paper shows that the variance of the RE estimator is bounded from above by a polynomial in the average degree and sample size. It implies that the performance of RE sampling does not deteriorate with the growth of degree variance of the tant for large graphs whose variance becomes larger compared with smaller data with the same distribution. Improvement new sampling methods that approximate RE sampling when it is not directly supported by the data source under investiga-sampling and exploits the large gap between RN and RE sampling.

The major contribution of the paper is our development of the upper bound of the variance of RE estimator. The result world networks. A direct consequence of the upper bound is the improvement ratio between RN and RE methods. To illus-approximate the performance of RE sampling only when the conductance of the graph is not very small, or, when the graph is well-enmeshed.

In the following sections, we first introduce the background of the research in Section 2 , including the sampling methods
RN and RE methods. In Section 4 , we verify our result on 18 real networks, and demonstrate that the performance of RW sampling depends on both degree variance and graph conductance. 2. Background and related work 2.1. RN, RE, and RW sampling 1 ; 2 ; ... ; N , and their corresponding degrees are d 1 by the mean of the degrees: Suppose that a sample of n elements  X  d x 1 ; ... ; d x n Our task is to estimate the average degree h d i using the sample. Table 1 summarizes the notations used in this paper.
There are different ways to take the samples, notably by RN, RE, and RW samplings. In RN sampling, each node is sampled uniformly at random with replacement. In RE sampling, edges are selected with equal probability and two nodes incident to node is sampled with probability proportional to its degree. RW sampling selects the next node in the current neighbour-hood uniformly at random. Its node selection probability is proportional to the degree asymptotically.
Different sampling methods require different estimators. The arithmetic mean is an unbiased estimator for RN sampling:
Instead, the harmonic mean should be used for these samples:
We refer to Salganik and Heckathorn (2004) for the detailed derivation of this estimator. RW sampling assumes that the is the variance of the RE estimator, particularly the comparison with the variance of the RN estimator.
The sampling and estimation methods can be illustrated using Fig. 1 . The average degree of the graph is 2. The sample degrees taken by RN, RE, and RW sampling methods are (1,1,1,1,2,8), (1,8,1,8,2,4), and (4,3,8,1,8,1), respectively. The estimations for RN, RE, and RW samples are:
To develop intuition about the high variance of RN sampling, and the variance reduction enabled by RE sampling to be necting with every other node (degree = N 1), while all the remaining (N 1) nodes connect with the large node only (de-gree = 1). Such a graph in a much larger scale is also found as a subgraph in the real NotreDame web graph as shown in
Fig. 11 . The average degree is  X  N 1  X  N 1  X  = N 2, assuming 1 = N 0. Most of the uniform random samples will include the small nodes only, even when the sample size is close to N . Thus most of the estimations will be 1, while occasionally there are very large estimations when the large node is sampled. When RE sampling is used, both small and large nodes 4 =  X  1  X  1 =  X  N 1  X  X  1  X  1 =  X  N 1  X  X  2. This approximates the true value very well. 2.2. Pertinent work practice is to use uniform random samples whenever possible. Quite often, uniform random sampling is not directly sup-ported. Other methods, such as Metropolis Hasting Random Walk (MHRW) ( Metropolis, Rosenbluth, Rosenbluth, Teller, &amp;
Teller, 1953 ) and rejection sampling, are utilized to approximate uniform random sampling ( Bar-Yossef &amp; Gurevich, 2008 ). When uniform random samples are not available, numerous sampling methods are proposed, in particular RW ( Lov X sz, 1993 ) for unequal probability sampling.

Recently, there are empirical observations that RW sampling can outperform MHRW sampling ( Rasti, 2009; Gjoka et al., 2009 ). Although MHRW does produce uniform random samples, it incurs additional cost, and is not the same as the direct
RN sampling. Therefore, it is easier to observe that RW can be better than MHRW sampling. Rasti et al. observed that random walk sampling can outperform MHRW in the context of peer-to-peer networks Rasti (2009) . Gjoka et al. showed that RW (called re-weighted random walk in their paper) and MHRW are comparable Gjoka et al. (2009) . This paper hand, is always inferior to RE sampling, and can be much worse than RE and RN sampling when the graph conductance is very small.

Our earlier work on the comparison between RW and RN samplings on the Twitter data ( Lu &amp; Li, 2012 ) motivated the studies conducted in this paper. Lu and Li (2012) found that, on the Twitter data, RW sampling is much better than RN sam-pling. Wang et al. (in press) experimented RW sampling on bipartite graphs representing term-document relationship in search engines. On such bipartite graphs, the performance of RW sampling does not have an obvious advantage over RN sam-pling. Our further study on dozens of other datasets also generated mixed results. Thereby, this paper tries to answer the question as for when and why RW is better than RN sampling. We identified two orthogonal factors influencing the sampling method: the degree variation and the conductance. High degree variation will guarantee that RE sampling works well, and the lack of loosely connected components ensures that RW sampling can approximate RE sampling.

The harmonic mean estimator was first derived and studied in depth by Salganik and Heckathorn (2004) to estimate the also received special attention. Stump and Wiuf studied the sampling of degree distribution Stumpf and Wiuf (2005) for two sampling schemes, i.e., random sampling and the degree dependent sampling of the nodes. For average degree estimation, the nodes that have less probability of being sampled.

The impact of sampling methods on the discovery of graph properties has also been studied in Leskovec and Faloutsos (2006), Stumpf, Wiuf, and May (2005), Stumpf and Wiuf (2005), Lee, Kim, and Jeong (2006) . They cover a wide range of net-connected components. Lee et al. (2006) showed that random node sampling performs better than random edge sampling in approximating the clustering coefficient of the graph. 2.3. Why average degree estimation
Graph properties need to be estimated when the graph in its entirety is not available. This happens when the graph is distributed without central data deposit, such as the Web, or, when it is hidden behind searchable web interfaces, such as search engines, online social networks, and millions of textual corpora hidden behind HTML search boxes. In either case the direct calculation of the property is impossible. Next, we highlight the importance of average degree estimation, and practical implications of RE sampling.

Average degree is an important metric for any graph ( Kolaczyk, 2009 ), and has many incarnations in the real world: when the graph is the Web, the average degree is the average number of in/out-links, which is an important property to charac-friends, messages and followers ( Gjoka et al., 2009 ); when the graph is a term-document network implemented by a search Gurevich, 2008 ); when the graph is an email network, the average degree is the average number of email contacts.
The applications can go beyond computer science to other disciplines such as finding the average degree (friends) of drug mating the expectation of a random variable. RN and RE samplings correspond to uniform sampling and PPS sampling, the problem in the setting of graph so that the RW sampling can be compared within the same framework. Besides, graph representation gives us a tangible illustration and straightforward implementation for the sampling process.
What is more important is that average degree can be used to derive other properties such as the variance and the data size. The variance h d 2 ih d i 2 , or equivalently, c 2  X h d can be estimated using c 2  X h d E i = h d i 1, where h d E can be used to estimate the number of nodes by b N  X  X  c 2  X  1  X  n the number of collisions in the samples. c 2 can be also used to measure the ratio between the number of friends of your friends, and the number of your friends. As the saying goes, your friends have more friends than you do on average. To be more precise, your friends have c 2  X  1 times more friends than you do. Along the same line c 2 can be used to quantify the diffusion of messages that is borrowed from epidemiology. In particular, it can be derived that the threshold for the occurrence of large component, or the occurrence of epidemics ( Jackson, 2008 ) (Eq. 7.8) is p  X  portion of the nodes that are immuned uniformly from the network. 3. Variance reduction using RE sampling
The performance of estimators can be evaluated in terms of bias and variance. The RN method is unbiased, and the RE 2004 ). Therefore, we focus on the comparison of the variances of the two methods.

The variance of the RN method depends on the variance of the degrees, which varies from data to data, and typically has an upper bound that does not depend on the degree variance. This upper bound guarantees the reduction of the variance of the RE method for very large data.

We develop the upper bound in three steps: first we use V imate the RE estimator. We demonstrate that such approximation is accurate using simulated data and real networks of var-we show that V 2 2 V 1 . In real networks, we observe that the ratio between V
V can be simplified further into V 3 when the average degree is large. 3.1. The large variance problem of RN sampling
The variance of the arithmetic mean estimator c h d i RN for RN sampling is: dard error) as defined as below:
Although c h d i RN is an unbiased estimator, its variance can be very large for some scale-free networks. The degrees of most real life networks are close to Zipf X  X  distribution ( Newman, 2005 ), inducing a large variation of the degrees.
However, it is hard to quantify the variance exactly because real data do not fit exactly the Zipf X  X  law, and the exponent and cut-off value vary from data to data. Nonetheless, we can assume a distribution to gain some understanding of the variance.
 When d i follows the power law, d i  X  A = i a , where A is a normalizing constant that satisfies where f  X  :  X  is the Riemann-zeta function f  X  a  X  P N i  X  1  X  a  X  1  X  ( Newman, 2005 ). Since the vast majority of networks have degree-frequency slope around 2( Newman, 2010 ), in the following we derive the variance when the slope is exactly 2, i.e., a  X  1 in the degree-rank equation. Note that f  X  1  X  ln N , and f  X  2  X  1 : 6. Therefore,
By the definition of variance, we can derive the variance of the degrees as below:
Therefore, when exponent a of the Zipf X  X  law is 1, the coefficient of variation is:
The intuition of this equation is that the variance grows almost linearly with data size N , in the order of O  X  N = ln mation is infeasible for very large scale-free graphs using uniform random sampling.

For instance, Twitter has N 5 10 8 users in 2012. If the degree distribution followed the power law as we assumed, its coefficient of variation would be c 2  X  1 : 6 N = ln 2 N  X  2 : 0 10 size n  X  c 2 = 0 : 1 2  X  2 : 0 10 8 so that the RSE could be 0.1. To achieve the 95% confidence interval 5 10 size is already in the same order of the total population. For the downloaded Twitter data in 2009 that contains 4 : 1 10 users, we find that the sample size needs to be 129,240 so that RSE is 0.1.

To verify our derivations, we generate 10 synthetic datasets with the same distribution ( a  X  1) but different data size N the same data. We can see that the slope of the frequency-degree plot is  X  a  X  1  X  X  2. Panel (D) compares the estimator variance for RE and RN methods when the sample size is 100. It shows that, for the same data distribution, the performance of RE method remains almost constant. But compared with the increasing variance of RN method, RE sampling becomes bet-ter when N &gt; 50 ; 000, and the advantage becomes larger with the increase of data size.
 3.2. Variance of RE sampling
Let random variables v  X  1 = d x i , and V  X  P n 1 1 = d x
E  X  V  X  X  n = h d i . Our first approximation to the variance is obtained by applying the Taylor expansion of result is:
By applying the variance on the first two terms of the Taylor expansion, we obtain an approximate variance of by V 1 ) as follows:
Next, we need to find a bound for v ar  X  v  X  . By the definition of variance,
Since d x i is obtained with probability p x P i  X  1 1 = d i varies from data to data, but a safe upper bound is N &gt; ar  X  c h d i RE  X  , which is called V 2 as defined below:
When h d i is a large number, the second term 1 = h d i 2 In summary, v ar  X  c h d i RE  X  V 1 &lt; V 2 &lt; V 3 . Thus, we derive the following theorem:
Theorem 1. The upper bound for the variance of RE sampling is h d i
We highlight two points regarding this result. First, the upper bound does not depend on the degree distribution or other degrees, the result holds no matter whether it is a scale-free graph, or has tightly knit communities. On the other hand, the performance of RW sampling depends on graph conductance as we will explain in Section 4.3 .

Second, the upper bound is surprisingly simple, involving only average degree and sample size. Unlike the variance of RN mined by average degree. Recall that the variance for RN estimator is mators c h d i RN and c h d i RE , we have:
Corollary 1. RE sampling reduces the variance at least by a factor of c 2 = h d i , i.e., 3.3. Simulation studies
To understand the relationship between the upper bound and the true variance, we demonstrate the variances using syn-thetic datasets whose degree distributions follow a power law d d  X  A = i a . When b  X  0, it is reduced to the Zipf X  X  law described in Section 3.1 .
 distribution. Panels (B) and (C) are the plots for the variances ( V ranging between 100 and 1000. Panels (C) and (D) are the corresponding log X  X og plots.
 We make the following observations from the simulation study:
V 3 vs. V 2 : According to our analysis in the previous subsection, the ratio between V very close to 10/9 as expected.
 V 2 vs. V 1 : The difference between V 1 and V 2 is determined by the difference of
That is, P N i  X  1 1 = d i  X  0 : 50 N . Therefore V 2 = V
When b  X  100 ; P N i  X  1 1 = d i  X  0 : 29 N , which is smaller than the previous case. Therefore, the gap between V approximation varies from data to data, it shows that the gap is really negligible in these two simulated data, and in 18 real network as we will show in Section 4 . 4. Experiments on real networks 4.1. Datasets We conducted experiments on 18 real networks, most of them are from the Stanford SNAP graph collection ( Leskovec &amp; between RN, RE, and RW samplings. For these categories, we choose only one graph for each category. In the category of the Web graph datasets, RW sampling deviates greatly from RE sampling. To investigate the cause for such deviation, we investigated several Web graphs on the domains of Notre Dame, Stanford, and Berkley-Stanford. The Facebook data is one of the few exceptions where RE sampling is inferior to RN sampling. Therefore, we include two Facebook graphs. Complete data description and programs can be found at http://cs.uwindsor.ca/jlu/degreevar . Their statistics are summarized in Table 2 , sorted according to c , the coefficient of variation of the degrees.

We make several observations on the datasets. First, most of them are scale-free networks as shown in Fig. 5 . The frequency-degree slope is around 2, their corresponding degree-rank slope shall be around 1, the same slope we selected in our simulation studies. Some datasets, such as Facebook and Citation networks, have a curve that is reflected by the Zipf X  X andelbrot law we used. One exception is the RoadNet network that is closer to normal or log-normal distribution. varieties of the datasets, we will show that our result withstands without exception.

Second, it is interesting to note that two representative social networks Twitter and Facebook are in the two extremes of large degree variation, while Facebook has a sharp dropping curve causing a low c value. Besides, Facebook datasets are much smaller. Because of their structural difference, for Twitter data RE is a hundred times better than RN sampling, for Facebook data RE and RN samplings are similar.

One technical detail needs to be mentioned is the sampling of Twitter data. It is the complete user network collected in store the data in hard drive and use search engine to mimic the random sampling methods. We treat all the neighbours of a node as a  X  X ocument X , and build a index for those  X  X ocuments X , or neighbours. Then, graph sampling can be accomplished by searching the index. 4.2. RE vs. RN sampling
Despite their variety in degree distribution and topology, all the 18 datasets support our analytical result. We demon-strate this using a fixed sample size first in Fig. 6 , then the trend over sample sizes in Fig. 7 .
Fig. 6 panel (A) demonstrates our main result, i.e., the variance ratios between RN and RE samplings have an almost linear
Both of the Citation and RoadNetwork are at the lower end of the c values. The RoadNetwork has maximal 12 degrees, and its degrees follow a log-normal distribution. The Facebook network has an upper limit on the number friends, thus the maximal bump around degree 100.

Panels (B) and (C) in Fig. 6 are plotted to corroborate our conclusion. Panel (B) shows that V
Epinion and Slashdots, the upper bound is rather close to the true variance. Panel (C) verifies that V tained by the Taylor expansion, is very close to the real variance.
 Fig. 7 shows the trend of the variances over various sample sizes, and reconfirms the relationship between variances
V ; V 2 ; V 3 , and the real one. It demonstrates that V 3 &gt; V to the observed variance, as the Taylor expansion can approximate the original function well. V
EmailEU, the difference between V 2 and V 3 is noticeable. The largest gap is between V N = and average degree is 10. That is, V 2 is about twice as large as V ing between 1.19 (WikiTalk) to 7.55 (Flickr).
 Another perspective to understand the reduced variance of RE sampling is the sample distributions that are depicted in small nodes still follow a power law as in the original data, while the large nodes can be sampled many times. In RE sam-where a is normally around two, we have:
Therefore, the sampling probability still follows a power law with the exponent a 1. Same as the power law for degree dis-quency, cannot be a fractional number. Instead, f  X  k  X  must be zeros in most cases so that in average they can follow the branch in the sampling frequency plot.

In other words, both small and large nodes are sampled multiple times but for different reasons. Small nodes are sampled because there are many of them. Although each individual small node has a very small probability of being sampled, collec-nodes are included by chance, inducing a large variance in estimation.

The datasets that do not have the  X  X  V  X  X  shape in RE sampling happen to be the ones not in favour of RE sampling. They do data, or to RN sample distribution. Therefore RE sampling does not have an advantage in this kind of data.
Two of the representative online social networks are Twitter and Facebook. It is interesting to see that they favour dif-ferent sampling methods, one RE sampling and the other RN sampling. Moreover, their RN/RE ratios happen to be on the two extremes of the spectrum. Twitter has the third highest RN/RE ratio because it is scale-free and the largest network in our experiment. Facebook-2 has the lowest RN/RE ratio because it has a cap on the number of friends. 4.3. RW sampling
RW sampling can be regarded as an approximation to RE sampling in that asymptotically the node sampling probability is estimator can no longer be omitted in our evaluation. Both bias and variance should be considered, and they can be mea-sured by RRMSE (Relative Root MSE) as defined below: where c h d i is an estimator, h d i is the true average degree, the RRMSE data are obtained by 5000 independent runs, except for Twitter data that has 2000 runs due to its large size and the long computation time of the sampling. Fig. 9 shows the comparison of three estimators.
 understand exactly how much worse RW is, we plot RW/RE ratio in Fig. 10 along graph conductance U ( Sinclair &amp; Jerrum, 1988 ), which can reflect mixing time of random walk. Very small graph conductance indicates the existence of loosely con-nected components. For datasets with small conductance such as NotreDame, Stanford, BerkStan and Flickr, RW is worse
Each RW trace contains 10 4 steps. All four datasets, especially Flickr and NotreDame, have an extremely dense component that dangles loosely from the main component. This shows that RW sampling depends not only on the variation of the de-grees, but also the topological structure of the graph. In the Flickr graph, there are two almost disconnected components. 5. Conclusions
The size of the data, compounded by the power law distribution, is changing the landscape of sampling practice. Uniform random sampling is no longer the method of choice. This does not happen until the data size reaches a threshold for a give important for web-based networks, such as online social networks and the deep web, where the sampling process is costly because of network traffic and daily quota.

It is remarkable to notice that it is uniform random node (RN) sampling that is on the downside of the comparison. In the past, great efforts are devoted to obtain uniform random samples using methods such as Metropolis X  X asting Random Walk rejected. In the end these precious uniform random samples can be much worse than the samples obtained using low cost RE or RW methods.

While it is easy to understand that uniform random sampling has large estimation error for data with large variance, it is not straightforward to see whether RE sampling can reduce the variance for data of various distributions. We show that the to verify and explain our derivations, and use 18 real networks to support our result.

The upper bound of the variance implies that RE reduces the variance of RN sampling when the graph is large. First, the 0.9867 among the 18 real networks we studied.
 vs. frequency power law slope is 2), we show that c 2 grows almost linearly with data size for the same data distribution. than a hundred for Twitter, EmailEU, and WikiTalk. In theory, we project larger improvement ratio can be found. The depen-the data is scale-free.

When RE sampling is not possible, we can use RW to approximate it in that both methods sample nodes with probability proportional to its size. The difference is that RW is a PPS sampling only asymptotically. Thus the performance of RW sam-expected, but sometimes it can be much worse, even worse than RN sampling when there are loosely connected components in the graph characterized by graph conductance.

In retrospect, RE sampling is not widely studied, probably because that in most real situations, nodes are the primary ob-various ways. Edges, on the other hand, come as secondary objects that reside in nodes, and can be accessed from the nodes only. In the Web, web pages (the nodes) can be sampled using various methods, while the edges are only revealed as a by-product when we crawl the Web from one page to another. In social networks, we sample people (the nodes), while the rela-tions between people can be accessed from people, not the other way around. In software component networks, classes and objects are represented explicitly, while the relations between the classes can be obtained from those objects or classes.
New developments in the digitalized world are making RE sampling more common. When using random queries to sam-ple documents, long documents are sampled more often. It is a PPS sampling, or RE sampling when we view the queries as edges connecting the documents. When using random messages/emails to sample users, it is a RE sampling for user network connected by messages/emails. In the semantic web, edges are explicitly represented as RDF triples. Acknowledgements
Chase Chance for their comments, and NSERC (Natural Sciences and Engineering Research Council of Canada) for its support on the research.
 References
