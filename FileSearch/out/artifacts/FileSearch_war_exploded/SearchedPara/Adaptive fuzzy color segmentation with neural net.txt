 Chieh-Li Chen, Chung-Li Tai n 1. Introduction
Color segmentation is an essential issue for vision applications,
Lin, 2007 ). The process of color segmentation consists of color representation, color feature extraction, similarity measurement and classification. In color representation, the RGB (red, green and blue) model, which expresses color as a mixture of red, green and blue three color components, is often used to depict color information of an image ( Weng et al., 2007 ; Bascle et al., 2007 ).
By a transformation, the secondary colors, which are CMY (cyan, magenta and yellow) or RG X  X B X  X R, can be obtained and used as an alternative color model ( Wang et al., 2007 ). Although the color information is completely reserved in these two color spaces, the chrominance and the luminance are mixed together. Therefore, the luminance would strongly affect the color similarity measure-ment and may cause poor segmented results. The HSI model, which transforms RGB into hue, saturation and intensity, is also a popular color model at present, and good performances are shown in many works ( Kim et al., 2008 , 2007; Wangenheim et al., 2007 ).
HSV (value) and HSL (luminance) are very similar to the HSI model due to the applied transformation formulas. Using the HSI color model, a specific color can be recognized regardless of variation of saturation and intensity. CIE Luv, CIE Lab and YCbCr (Wang and Huang, 2006 ; He et al., 2007 ) are color spaces that represent color by its intensity (L and Y) and chromaticity (uv, ab and CbCr). Using a color model that can de-correlate the luminance and the chrominance, the chrominance of a color is represented only by hue and saturation, whereas the chrominance of a color can completely reserved as three color channels using the RGB model. In this paper, we propose a new color model called the RGB color ratio model, which is based on the fact that a change of intensity of a reference color will lead to a change of
RGB color components, but their ratio to the reference color will be linear to the intensity change ( Benedek and Sziranyi, 2007 ;
Mikic et al., 2000 ). With this property, a specific color can be recognized despite intensity variation. Moreover, information of three color components (RGB) is reserved to describe the chromaticity by the proposed RGB ratio space. Therefore, inherit-ing the characteristics of HSI and RGB models, the RGB ratio has advantages on object recognition under intensity variations.
There exist many state-of-art and complex techniques for color segmentation that are excellent in partitioning an input image.
For example, Kato (2008) introduced a Bayesian color image model using a first-order Markov random fields (MRFs). The observed image is represented by a mixture of multivariate Gaussian distributions. Then a reversible jump Markov chain
Monte Carlo algorithm is applied to sample the whole posterior distribution in order to obtain a MAP estimate via simulated annealing. However, the computation of an excellent segmented result for a 730 500 image costs 15 min. The global color statistics can be also represented by a set of overlapping regions and modeled by a mixture of Gaussians (GMM), and a local mixture model is described by MRF. By optimizing parameters of the global and local model, the maximum likelihood is estimated and then a pixel can be classified. Although marvelous segmented results are revealed, a large number of iterations are necessary to determine optimal parameters. As a result, the computation time of an image with 256 256 resolution is 16 s ( Tai et al., 2007 ).
Hill manipulation of color histogram is another commonly used approach to achieve color segmentation. A three dimensional histogram clustering index ( Al Aghbari and Al-Haj, 2006 ).Theideaof X  X iston X , which is an encrustation of histogram such that the elements in the belonging to the same segment, was introduced for color segmentation by Murshrif and Ray (2008) . The total computation time for a 179 122 image is 2.41 s.

Image segmentation is considered as an energy function minimization of a Hopfield network by Campadelli et al. (1997) .
The layer number is the number of significant peaks of histogram, and the number of total neurons is defined as the image resolution multiplying the layer number. A multi-thresholding technique proposed by Papamarkos et al. (2000) is implemented by a principal component analyzer (PCA) and a Kohonen self-organized feature map (SOFM) neural network. The histogram is also used to determine thresholds of gray levels. A SOM neural network that classifies the pixels in an image according to color and spatial features, is proposed by Jiang and Zhou (2004) . Neural networks ( Bascle et al., 2007 ) are used as clustering kernel for color segmentation recently, where components of the RGB space and the intensity are used as inputs and three calibrated color components are considered as outputs of the modified multi-layer perceptron (MLP). After the training procedure, a good segmenta-tion performance is achieved. Furthermore, the look-up tables (LUTs) of the modified MLP can be applied for real-time applications such that the execution time for a 320 240 image is 0.00375 s. However, a huge size database is required to be created. If an input image is very different from the database, the network should be re-trained to improve the result. In the work of sub-image with identical color distribution to the original large printed image. Then, the precision of color separation can be enhanced by a recursive region splitting method. Using the obtained color clusters (cluster number) and color values (cluster centers), color separation for a large printed image can be obtained efficiently by the fuzzy C-means (FCM) approach. The template-matching method is then used to identify the pattern elements distribution with identical color, shape and orientation.
An adaptive mixed approach based on the combined use of the local structure tensor (LST) and the image components is proposed by Luis-Garcia et al. (2008) . Euclidean distance is used as the similarity measurement in both methods proposed by Kuo et al. (2008) and Luis-Garcia et al. (2008) ; Bosch et al. (2007) recognize grass, sky, snow and road using fuzzy logic with predefined classes, where the average processing time for image size of 180 120 X 250 250 is 60 s. The use of template image is another fast segmentation method. For instance, image database of eye is established beforehand. Skin color is obtained from a color conversion matrix with color of the sclera. Consequently, fixed thresholds of HSV space are introduced to detect skin area in an input image ( Do et al., 2007 ). However, the use of template image is restricted to specific objects, and may require a large image database. A well-known and powerful color segmentation method, JSEG, which is based on color quantification and region merging and splitting, is proposed by Deng and Manjunath (2001) , and comparisons with JSEG will be demonstrated in Section 5.

In this paper, we propose an adaptive fuzzy decision kernel to achieve a quality segmented result. Firstly, the linear model of RGB color ratio to intensity is estimated by the linear progressive method, and the color ratio difference between a pixel and this model is used as the similarity measurement. Secondly, an upper and a lower boundary (LB) are obtained statistically for each color ratio. These boundaries are used to define fuzzy membership functions of color ratio clusters, which dynamically vary corresponding to intensity changes. This makes the fuzzy decision more adaptive and more effective. In order to optimize the performance of the adaptive fuzzy decision, a basic backpropagation network is applied for parameters optimization.

This paper is organized as follows: the proposed RGB ratio space to represent color characteristic is defined in Section 2. Linear progressive method and parameter estimation, which are adopted to estimate linearity between RGB ratios and intensity, are described in Section 3. Upper and lower boundaries of the road color model are also obtained in Section 3 to describe fuzzy membership functions, which can be used to achieve segmenta-tion of an input image. The proposed segmentation method is applied for road detection in Section 4. The results and comparisons with JSEG are demonstrated to show its feasibility. Conclusions are given in Section 5. 2. RGB ratio space Road detection is a typical application of color segmentation. In this study, the central bottom area of an image defined by (2 N +1)(2 N +1) pixels should belong to the road as demonstrated in Fig. 1 . From projective geometry, this area is closest to the camera system. If this area is not part of the road, the navigation system should give a stop or turning command instead of evaluating the reference road color value. By calculating average values of RGB components of the (2 N +1)(2 N +1) pixels, the reference road color is defined as ref is ( x , y ) in the initial image, and wh the image resolution.
Based on the existence of the linear relation between RGB ratio f
RGB and intensity f I , we define the linear relation as follows: f  X  P j f I  X  Q j ; j  X  R ; G ; B  X  2  X 
Parameters P j and Q j in Eq. (2) are not available straightfor-wardly because the pixel set of the road is to be determined. Therefore, a sample pixel set C whose color is almost the same as the reference color values is required to obtain the parameter P and Q j using the regression. C  X  f HSI  X  x 1 ; y 1  X  ; f f  X  x k ; y k  X g , as shown in Fig. 2 , defined in the HSI space as described in (3) is introduced to estimate P j and Q j .
C  X  f i  X  x ; y  X  ref i r l i f HSI  X  x ; y  X  ; i  X  H ; S ; I  X  3  X  defined in the HSI space ( Gonzalez and Woods, 2002 ). Therefore, the RGB ratio value of the sample set C can be obtained as f  X  x ; y k  X  X  3. Segmentation method 3.1. Road model construction
With the sample set C , parameters P j and Q j can be determined using linear estimation ( Yates and Goodman, 2005 ) as follows:
P  X 
Q  X  where j = R , G , B ; m r intensity of C . The reference road color shown in Fig. 1 is (0.6063, 0.5219, 0.5395), and color ratios with respect to intensity for the sample set according to (3) are shown in Fig. 3 . The angles shown in Fig. 4 . Although P j and Q j are obtained based on the sample set C , the maximum/minimum intensity values ( L max of the actual road set are required to fully describe the road model. A searching procedure is applied as follows:
Step 1. Let z max  X  l max and z min  X  l min , where l max
Step 2. Let the searching range be z 1 A z max ; z max  X  d and
Step 3. Condition 1: f 0.5 1 1.5 f r RGB  X  x ; y  X  is the image represented by RGB ratio, d =0.05 and e =0.05.

With L max and L min , as shown in Fig. 5 , the boundary of the road color set can be described as follows. The line AB in Fig. 6 is estimated from the sample set C in one of the color ratio planes.
A  X  L obtained from the searching procedure. The arc _ AEB , which represents the upper boundary (UB) of the road color set, can be follows.
 R  X  D 2  X  K 2 2 D  X  7  X  I  X  I M 7 r where K  X  AM  X  BM , S  X  X  L min L max  X  =  X  r jB r jA  X  and D  X  EM  X  e is the mean squared color ratio error of the sample set C and a is a gain corresponding to model strictness; a = 2 in this study.
From (7) and (8), equations of the upper boundary _ AEB and the lower boundary _ AFB , as shown in Fig. 7 , can be represented as follows:
AEB _ : r
AFB _ : r 3.2. Adaptive fuzzy road detection
For robustness and flexibility, fuzzy logic is used as the decision maker of the proposed segmentation method, where the membership functions are adaptively defined according to the road set obtained in Section 3.1. In this paper, three RGB ratios and the corresponding intensity are four inputs of the fuzzy decision system. Figs. 8 (a) X (c) show three membership functions for input ratios, where the lower/upper represents the sets whose color ratio is smaller/greater than the lower/upper boundary of the road color set. The upper boundary (UB) and the lower boundary (LB) are obtained by (9) and (10), respectively; d = b e and b is a gain for the sensitivity of the fuzzy system. In this way, membership functions for each input are adaptively defined according to the intensity value. The membership functions of the two outputs, dissimilar and similar, are shown in Fig. 8 (d). The fuzzy decision table is shown as Table 1 , and max X  X in-composition method ( Zimmermann, 1991 ) is used as the defuzzification method.

To evaluate the performance of the road detection using the proposed color segmentation method, the detection rate, true (FNR), introduced by Do et al. (2007) is applied as follows. First of all, we define the exact road region as true ground (TG), while all pixels classified as road by the proposed method are defined as detected ground (DG). True positives (TPs) are correctly detected road pixels, false negatives (FNs) are incorrectly dropped road 0.485 0.49 0.495 0.5 0.505 0.51 0.515 0.9 R ratio pixels and false positives (FPs) are false road pixels outside the exact road region. The true positive rate (TPR), which is TP/TG, is the proportion of true positives to true ground, the false negative rate (FNR), which is FN/TG, is the proportion of false negatives to true ground, and the false positive rate (FPR), which is FP/DG, is the proportion of false positives to detected ground.
According to definitions of the detection rate, we define an evaluation function to evaluate the system performance under a specific b value as follows:
V  X  b  X  X 
It can be easily found in (11) that the optimal b value makes V ( b ) to be the maximum. We can use this to search the b max for the best system performance as follows: b  X  argmax
However, this searching method costs more computation effort and it is suitable only for cases where the exact road region is known. In this paper, a backpropagation neural network ( Freeman and Skapura, 1991 ) is trained offline and used for on-line estimation of the b value; y RG , y RB and y GB defined in Fig. 4 are inputs of the network, nine hidden neurons are used and b is the output, as shown in Fig. 9 . Using the backpropagation neural LB -d LB 1 0.8 0.6 0.4 0.2 1 0.8 0.6 0.4 0.2 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 network, the sensitivity parameter, b , can be determined by three angles in the RGB ratio space without using an optimal searching process. Quality road detection results using the proposed adaptive fuzzy decision are demonstrated in the next section. 4. Experimental results and discussion
For road detection studies, experimental images, which include brick pavement, terrazzo floor and asphalt road, are taken by the SONY EVI-D70 camera. Original image size is 640 480 and is resized to 128 128 for real-time performance. All algorithms are implemented with VC++ with Pentium-4 3.0 GHz CPU and DDR2 1 GB memory.

Road detected results using the proposed method on brick pavement, terrazzo floor and asphalt road are shown in Figs. 10 and 11. Unlike other road detection methods, this study uses color as the only feature for road detection instead of other geometry constrains. As shown in Fig. 10 , the brick pavement is more colorful than the other two road types. It was revealed that a color is difficult to be recognized when its intensity is close to 0 or 1 (Plataniotis and Venestsanopoulos, 2000). Comparing the segmented results corresponding to the original images and the intensity adjusted images as shown in Fig. 10 , most dark parts of the pavement that fail to be recognized as the ground are successfully detected after intensity adjustment. As shown in Fig. 10 (d), the brown box, whose color is similar to that of the road in the HSI and RGB spaces, can be successfully separated from the pavement by the proposed color segmentation method. The handle of the umbrella in Fig. 10 , whose color is very similar to that of the pavement in all color spaces, is also successfully segmented using the proposed adaptive fuzzy classifying rule. Therefore, an intensity adjustment is applied to avoid the achromatic case and to improve detected results for colorful ground cases.

Segmented results on terrazzo floor ( Figs. 11 (a) and (b)) and asphalt road ( Figs. 11 (c) and (d)) are demonstrated in Fig. 11 .
Because the colors of wall and pillar are almost the same as that of the terrazzo floor, the false detection rate is slightly higher than for the other two road types. The detected result on asphalt road in Fig. 11 , a white box, whose color is recognized as the same as that of the asphalt road except for intensity, is also successfully segmented and separated from the road. This is also true for a black box case as shown in Fig. 11 .
 From the average detection rate listed in Table 2 , the average
TPR of adjusted images is increased by 3.51% and the average FPR is decreased by 1.35%. Since the color of terrazzo floor is almost achromatic, the intensity adjustment is not applied. The average
TPR for the terrazzo floor case is 95.51% and the average FPR is 9.24%. As for asphalt road detection, the boundaries of the proposed road model, _ AEB and _ AFB in Fig. 7 , are replaced by two straight line segments paralleled with AB , which can be obtained with R = N in (7). This is because the color of asphalt road is achromatic and is dominated by intensity variation. The resulting average TPR is higher than 98% and the average FPR is less than 1.7%.
 Road detection results using the proposed approach and the
JSEG method are demonstrated in Fig. 12 . Fig. 12 (b) shows that the road is successfully detected for three road types and the obstacle is also correctly segmented using the proposed approach.
Segmented results of brick pavement by the JSEG method are shown in Fig. 12 (c). The green box is correctly detected until the parameter q is larger than 350, but the road region is always divided into multi-regions despite parameters tuning because of different illumination conditions on the left and right parts of the brick pavement. Similar situation happens on results of terrazzo floor until the color quantization, q , is larger than 450. However, the green box is misclassified to be part of the road for a large q .
This green box is successfully detected and segmented by JSEG only when the q value is smaller than 39, whereas the road is divided into too many fragment regions. It can be easily found that although the color of the road is recognized as the same by humans, JSEG recognized the road as two different regions because of high intensity difference. Better segmented results using JSEG for the asphalt road are shown in Fig. 12 (c) due to almost the same intensity of the whole road surface. According to the compared results, the road region is more precisely detected using the proposed approach.
 Detected results using the RGB model and the HSI model with
Euclidean distance measurement are compared with the proposed approach. From Tables 3 and 4 , the TPR of the proposed method on brick pavement is much higher and the FPR is much lower than for the conventional methods. Although the TPR of the terrazzo floor, listed in Table 5 , is not higher than for the other two methods, its
FPR is dramatically decreased by over 10%. Segmented results for the asphalt road case, demonstrated in Table 6 ,showthe superiority and the successfulness of the proposed method. 5. Conclusions
This paper proposed the RGB color ratio space to construct the road model of different road types. The road model described in the RGB color ratios and the intensity space is estimated by a detected road reference value, and is updated subsequently during the process. Adaptive fuzzy decision is also introduced as the clustering method to detect the road in a more effective manner. The use of dynamic membership functions according to the target pixel X  X  intensity for each color ratio achieves satisfac-tory performance for both indoor and outdoor road types. Unlike other road detection approaches, color is the only feature used for road detection instead of other geometry constrains in this study.
Experimental results demonstrate the feasibility and robustness of the proposed color segmentation approach.
 Acknowledgements This work was supported by the National Science Council, Taiwan, under Grant no. NSC97-2221-E006-181.
 References
