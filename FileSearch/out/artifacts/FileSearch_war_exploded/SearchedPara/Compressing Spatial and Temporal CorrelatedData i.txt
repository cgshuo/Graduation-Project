 Wireless sensor networks are widely used in military and civil fields, such as battle monitoring, environmental exploration, and traffic control [1, 2]. Sensor networks usually have limited energy and link bandwidth and hence sending the original data directly is not feasi ble. Wavelet data compression has been attracting extensive research efforts in w ireless sensor networks targeting at re-ducing network load and hence energy consumption and delay. Wavelets are a mathematics technique that can simultaneously represent the data X  X  time and frequency behavior. This representation inherently provides the multi-resolution analysis view needed by applications while still preserving the data X  X  statistical interpretation regardless of the scale or compression ratio. It X  X  fairly promis-ing for wavelets in both theory and application in sensor networks. WISDEN system [3] is designed for structural monitoring; it performs the wavelet com-pression in single sensor node firstly and then wavelet coefficients are sent for further processing centrally. Aiming at time-series sampled by a single sensor node, RACE [4] proposes a rate adaptive Haar wavelet compression algorithm. The support of Haar wavelet is 1 and its structure is simple, so the algorithm can come true easily. However, those wavelet algorithms do not exploit the fact that data originated from spatially close sensors are likely to be correlated. En-ergy would be wasted with the transmission of redundant data. DIMENSIONS [5] proposes a hierarchical routing with its wavRoute protocol, which exploits temporal data redundancy of sensor nodes in the bottom firstly, and then spatial data reduction in the middle hierarchy. Obviously, there exists the transmission of spatial redundancy from the bottom to middle hierarchy. Noticeably, a se-ries of papers have pioneered in wavelet based distributed compression [6, 7, 8] recently. While these papers have provided certain insights in employing dis-tributed wavelet transform(WT) to exploit spatial correlation among data, they are often limited to the cursory application of wavelet function. Although these algorithms are shown to be simple, they lack the consideration of property of WT, such as  X  X order effect X  [9], the level of WT, and so on. Furthermore, ex-isting schemes have often focused on either exploiting the temporal correlation or spatial correlation of the sensory data, but not both simultaneously. This, in turn has limited their performance and application scope.

Motivated thereby, in this paper, we propose a ring topology based distrib-uted wavelet compression algorithm. Our scheme simultaneously exploits the spatial and temporal correlation residing in the sensor data within a cluster. Furthermore, our scheme is capable of accommodating a broad range of wavelets which can be designated by different applications. Moreover, the ring model will naturally eliminate the  X  X order effects X  encountered by WT and hence further strengthen its support to general wavelets. The common dyadic decomposition based WT is not feasible in sensor networks, since temporal compression is local and far cheaper than spatial compression. We propose a  X  X ybrid X  decomposi-tion based WT and show that the optimal level of WT is different due to diverse natures of data and the distance between sensor nodes and cluster head. Theo-retically and experimentally, we analyze the performance of the ring based WT and perform comparison with non-distributed approach.

The remainder of this paper is organized as follows. In Section 2, we detail the ring model and describe the WT thereon. In Section 3, we analyze the perfor-mance of the proposed framework and study the optimal level WT theoretically. Experimental study is presented in Section 4 and we conclude in Section 5. In this section, we first present the network model and the construction of the virtual ring topology. The wavelet based algorithm for compressing spatial and temporal correlated data is then detailed.
 2.1 Virtual Grid and Ring Topology We assume that the sensor network is divided into different clusters, each of which is controlled by a cluster head [10]. Our focus is given to energy-efficient gathering of the sensory data from various cluster members to the cluster head. Routing the data from the cluster head to the sink is out of the scope of this paper although it may benefit from the compression algorithm presented in this paper. We assume that in each cluster, nodes are distributed in a virtual grid as illustrated in Fig. 1. Due to redundancy, one node in each grid cell is required to report its data to the cluster head. Without confusion, we will simply use node to refer to this reporting sensor. We remark that this model is neither restrictive nor unrealistic. In the worst case, a single node can be logically reside in one grid cell and can be required to report its data corresponding to every query or during every specified interval.

The key for our construction is that we form a ring topology among the reporting sensor nodes, as illustrated in Fig. 1. In this ring topology, neighboring nodes belong to spatial adjacent grid cells. A node on the ring receives data from one of its neighbors, fuses the data with its own, and further forward the results to the other neighbor. As the nodes are relaying the sensory data, WT will be executed and certain wavelet coefficients will be actually stored locally and some others will be actually forwarded. Indeed, nodes in a particular grid cell can alternatively participate in the ring and hence the data gathering procedure. This way, energy consumption can be more evenly distributed among the nodes and thus extend the network lifetime. Readers are referred to [11] for approaches of scheduling nodes within one grid, for example, power on and off, for this purpose.
Given the ring topology, in each data gathering round, a node will be cho-sen as the  X  X ead X  of the ring and the nodes will be indexed accordingly as s ,s 1 ,  X  X  X  ,s i ,  X  X  X  ,s N  X  1 ,where N is the number of nodes on the ring. In addi-tion, we assume that sensor i stores data c j i , j =0 , 1 ,  X  X  X  ,M  X  1, where j is the temporal index and c j i represents the sensory data of sensor i at time index j . Evidently, dependent on M , each sensor will window out history data. Accord-ingly, we can arrange the sensory data on the ring according to their spatial and temporal relationship to a matrix C 0 = { c j i } , 0  X  i&lt;N, 0  X  j &lt;M ,where column i represent the data of sensor node i . For ease of notation, we will use C i to denote column i .Noticethat C 0 and C N  X  1 are adjacent on the ring topol-ogy and hence will possess relatively higher correlation. As we will detail later, this unique feature of ring topology can effectively help us eliminate the  X  X order effects X  of WT. 2.2  X  X ybrid X  Decomposition Based Distributed Spatio-temporal Our goal is to employ the WT for compression sensory data on the ring so that it can be energy efficiently transmitted to the cluster head. The approach is to simultaneously exploit the temporal and spatial correlation among the nodes X  data and reduce the redundancy thereby. As the data is represented by matrix C 0 , the temporal (within a node) and spatial (among multiple nodes) correlation is then captured by the columns and rows respectively.
Intuitively, we can perform two-dimensional WT on the matrix C 0 to ex-ploit the spatio-temporal correlation. For two-dimensional tensor product WT, the common structure of decomposition is dyadic tree decomposition as illus-trated in Fig. 2(a). Using the structure of dyadic tree decomposition, we will first perform WT on each row, and then perform WT on the column. These row WT and column WT will be performed recursively to achieve a K -level WT. Communication constraints in sensor net works drive a time first, space next ap-proach to compressing the sensory data, since temporal compression is local and far cheaper than spatial compression. Correspondingly, the common dyadic tree decomposition will not adapt to sensor networks.

In this section, we propose a  X  X ybrid X  decomposition based distributed WT, as illustrated in Fig. 2(b). We will first perform K -level WT on all columns to exploit temporal correlation, followed by a dyadic WT on the row to exploit spatial correlation. Notice that column WT is within a single node hence no communication is required although data shall be buffered. On the contrary, the row WT is among the sensor nodes and hence require additional communications. This way, by reducing the temporal data firstly, the communication overhead of column WT is reduced. Without loss of generality, we consider K = 2 levels distributed spatio-temporal WT.

Our first step is to perform K -level transform on the columns of C 0 to exploit temporal correlation. Let L n and H n be lowpass analysis filter and highpass analysis filter respectively, we have where C L k c m , i represents the m th approximation wavelet coefficient in i th column ficient, where 1  X  k  X  K and C i ( n ) denotes the n th element of C i .Noticethat this transform is performed within each node on its own sensory data and thus does not require any communication among the nodes on the ring. Subsequently, we can realign the resultant wavelet coefficients and obtain matrix
Given matric C 1 , our second step is to perform K -level transform on its rows to explore the spatial correlation among the nodes. Note that the first and the last column are adjacent on the ring topology, and this resembles  X  X he periodic extension to signal X . Towards this end, for general wavelets with arbitrary sup-ports whose lowpass analysis filter is L n ,  X  i 1  X  n&lt; j 1 and highpass analysis of the row transform based on whether j 1 and j 2 are even or odd.
Case I: If j 1 is even and j 2 is odd, by performing the first WT on the rows in a similar way to the column WT, we obtain row WT to the approximation or detail coefficients generated by the k th 2 level cients. We remark that for a node with index i ,if i is even, the node stores coeffi-c
Notice that this transform is performed among the sensor nodes on the ring to harvest the spatial correlation and hence resultant wavelet coefficients cannot be realigned as in the column WT.

Based on the the approximation coefficients in C 2 , we can obtain matrix C 3 as follow:
We perform the second level row WT on matrix C 3 as those to matrix C 2 and extend to the K th level row WT.

After K -level distributed spatial-temporal WT are performed, the original data gathered by the nodes on the ring are transformed to wavelet domain. Since the spatial and temporal correlations are exploited, we can represent the original data using fewer bits. In lossless compression, all the wavelet coefficients are encoded and sent to the cluster head. In lossy compression, according to different application-specific requirements, such as error bound, energy cost, etc., we can accordingly select the wavelet coefficients, and then they are encoded and sent to the cluster head.

Case II: If j 1 and j 2 are both odd, while we can perform the transform follow-ing similar procedure, the matrices C 2 will be significantly different. Due space limitation, we omit them here but remarks that those nodes whose indexes are even will not store wavelet coefficients and become pure delays.

When j 1 is odd and j 2 is even, it will be similar to the first case, and when j 1 and j 2 are all even, it will be similar to the second case discussed above. i 1 and i will not affect the distribution of wavelet coefficients. The reason is that when we perform row WT, the first group of approximation coefficients are calculated using the data stored in the (( N  X  i 1 ) m odN ) th node to the ( j 1 m odN ) th node and are stored in the ( j 1 m odN ) th node. The corresponding detail coefficients are node and are stored in the ( j 2 m odN ) th node. 2.3 Discussion In the above WT, the ring head can be alternated among different nodes when performing the data gathering procedure. Consequently, the wavelet coefficients will be distributed to different nodes accordingly which in turn will balance the energy consumption within the cluster. Furthermore, neighboring nodes on the ring belong to spatial adjacent virtual grids, so the data gathered by the neighboring nodes are more likely spatially correlated. Because the calculation of approximation and detail wavelet coefficients are for neighboring nodes within a support length, performing WT based on the ring can make full use of spa-tial correlation to remove the data redundancy and hence reduce transmission cost.

More importantly, performing WT based on ring topology naturally eliminates the  X  X order effect X  problem inherent in WT. It is well known that general wavelet functions are defined on the real axis R while the signal is always limited in a finite region K. Therefore, the approximate space L 2 (R) will not match the signal space L 2 (K) which will result in the  X  X order effect X  and thus introduce errors during signal reconstruction. One of the general methods to deal with  X  X order effect X  is extending border. The ring topology resembles a periodic extension to the signal that naturally di ssolves the  X  X order effect X . We now briefly analysis the total energy consumption and delay of the proposed scheme and study the optimal level spatio-temporal WT. For this purpose, we adopt the first order radio model described in [10]. In this model, a radio dissi-pates E elec amount of energy at the transmitter or receiver circuitry and amp amount of energy for transmit amplifier. Signal attenuation is modelled to pro-portional to d 2 on the channel, where d denotes distance. For k bits data and a distance d , the transmission E T x and reception energy consumption E Rx can be calculated respectively as follows:
We further assume that the sensor nodes can transmit simultaneously and neglect the processing and propagation delay. Let the transmission time of one data unit be one unit time. For performance comparison, we employ a non-distributed approach for data gathering. In this approach, sensor nodes in the cluster will send their data to the cluster head directly, and thus no inter-nodes communications are required. 3.1 Energy Consumption and Delay Analysis In this subsection, We analysis the total energy consumption and delay of the proposed scheme. Let E I N and D I N represents the energy consumption and delay resulting from communication among the nodes within this cluster for performing the proposed WT, We can derive the following theorem.
 Theorem 1. For general wavelets with arbitrary supports, let the lowpass analy-i ,i 2 , j 1 , j 2  X  0 .Fora K -level distributed spatial-temporal WT based on the ring topology proposed above, to gather the sensory data in a cluster of N nodes, we have where q imation coefficient and the corresponding detail coefficient in the k th level row WT are calculated respectively, d j modN is the distance between the ( jm odN ) th node and the (( j +1) m odN ) th node, E P k , l is the processing energy of when the l th wavelet coefficients is calculated in the k th level WT.
 Proof. When the l th approximation wavelet coefficient in the k th level row WT is cost E p is: E P = the energy cost E I N is: E I N = K k =1 ( E p + (10), (11) and (12) into (14), we can obtain (8). The network delay of the k th WT (15). Hereby, it is easy to get (9).

Notice that E P k , l includes two parts: one is the processing cost when nodes perform column WT in single node, the other is the processing cost when nodes fuse data obtained from the proceeding nodes. We can conclude from the theorem that, along with increasing levels of the WT, the energy cost also increases. However, the detail wavelet coefficients stored by the nodes also increase. As a result, the data can be coded using fewer bits. 3.2 The Optimal Level Spatio-temporal Wavelet Transform In this subsection, we will study how many levels WT needed to be performed to obtain optimal network performance. From the viewpoint of information theory, only by decreasing entropy of wavelet coefficients is WT worthy. As we known, entropy corresponds to the average encoding bits. If the entropy of wavelet coef-ficients is smaller than those in above level WT, the average encoding bits would be decreased. Generally speaking, the entropy of wavelet coefficients lies on the magnitude of signal (set), the specific measured signal (data) and the wavelet function (wavelet). Let B k  X  1 and B k are the average encoding bits of wavelet coefficients in the ( k  X  1) th and k th level respectively, then we have:
Compared to non-distributed approach, our scheme reduces the data by elim-inating the spatio-temporal correlation among the sensory data. However, per-forming WT requires inter-nodes comm unication and computation within nodes, and thus need additional energy consumption and delay. Apparently, there are a trade-off point between WT and non-distributed approach. Studying the optimal level spatio-temporal WT, we have the following theorem: Theorem 2. Let the average distance between nodes and the cluster head be D K (13) and (15) in the above subsection respectively, then, the optimal level of spatio-temporal WT is K : K =max( K 1 , K 2 ) .
 Proof. The energy consumptions of sending ( B k  X  1  X  B k )bitsare( E elec ( B k  X  1  X  B tions and delays generated by the k th level WT are less than or equal to them respectively, the k th level WT would be performed. So, according to the theorem 1, we can easily obtain the theorem 2. In this section, using Haar wavelet we evaluate the performance of our algorithm and in particular compare it with the non-distributed approach.

We consider a ring composed of 96 nodes, assuming that the nodes are uni-formly distributed and the average distance among the neighboring nodes is 5 meters.We use real life data obtained from the Tropical Atmosphere Ocean Project (http://www.pmel.noaa.gov/tao/), which are the ocean temperatures sampled by 96 sensor nodes from different mornings at different depths at 12:00pm from 1/20/2004 to 5/26/2004. In the experiment, we employ uniform quantization and no entropy coding. Two cases are compared: optimal level Haar WT and non-distributed approach. The results are shown in Fig. 3 and 4. The re-lations among optimal level of WT(Opt-level), distance between nodes and clus-ter head(Distance), peak signal to noise ratio( PSNR ), energy consumption( E D ) and delay( D D ) are shown in Table 1.

As we can see, when the proportion of the discarding detail coefficients to total wavelet coefficients in the WT reachs 73 percent, the PSNR is still reach 49dB. We believe that the reasons are the data used in the simulation have strong spatio-temporal correlations and our algorithm can move them efficiently. In our simulation, the optimal level of WT is 0 when the distance between nodes and cluster head is less than 20 meters. This indicates that WT is not necessary under this case, for the non-distributed approach has no additional energy consumption. However, with increasing distance between the nodes and the cluster head, the benefit of compression outweigh the energy due to inter-node communication for performing the WT, and then the proposed algorithm will save more energy. In this paper, we have proposed a distributed spatio-temporal compression algo-rithm based on the ring model. Our algorithm accommodates to a broad range of wavelet function, and can remove the temporal and spatial correlation of original data simultaneously, the ring mode can cope with  X  X order effect X  and thus ben-efit WT. We have analyzed the energy cost and network delay and studied the optimal level WT. The Simulation experiment suggests that the optimal level of WT is different due to different PSNR and the distance between nodes and cluster head, along with the increasing of the distance between the nodes and cluster head, the distributed spatio-temporal wavelet compression algorithm has better performance than that of non-distributed approach.

How to accept or reject the detail wavelet coefficients produced by distributed spatio-temporal WT effectively, and thus gaining constant or limited bit rate to improve the transmitting scheduling in sensor networks is our future work.
