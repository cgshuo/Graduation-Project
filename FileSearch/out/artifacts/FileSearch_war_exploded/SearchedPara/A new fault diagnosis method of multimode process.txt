 Jie Yu n 1. Introduction
Process monitoring, particularly fault detection and diagnosis, is of critical importance to ensure plant safety and increase economic profit of chemical industry. During process operation, the automated detection of any abnormal events as well as the accurate identification of the root causes can effectively prevent the occurrence of serious incident, improve product quality and reduce maintenance cost. The first task of process monitoring is to detect an abnormal situation that can be a process or measure-ment fault driving certain number of process variables outside of normal operation range. Then the next objective is to further diagnose the alarmed fault in order to locate the underlying variable(s) that have caused process abnormality. Finally, appro-priate actions should be taken to fix the identified issues and return the plant operation to normal state ( Chiang et al., 2001 ;
Qin, 2003 ; Yu and Qin, 2009a ). The industrially desirable mon-itoring system should be able to learn faulty patterns from large amount of historical data, predict abnormal occurrence and determine faulty variables with minimal intervention of routine operation in a plant ( Yu and Qin, 2008a ).

Multivariate statistical techniques have been studied inten-sively with many successful applications in chemical process monitoring field ( Kresta et al., 1991 ; Wise and Gallagher, 1996 ;
Raich and C -inar, 1996 ; Lennox et al., 2001 ). As the most popular methods, principal component analysis (PCA) and partial least squares (PLS) are adopted to project high-dimensional process data onto lower-dimensional subspace and extract the input/ output variable correlation based features for fault detection and diagnosis. The SPE and T 2 indexes along with the corresponding control limits are developed to serve as fault indicators. Then the decomposition or reconstruction based contribution indices can be derived to identify the faulty variables ( Bakshi, 1998 ; Chiang et al., 2000 ; Piovoso and Hoo, 2002 ). The PCA or PLS based T indices and their confidence intervals rely upon the assumption that the normal operating data follow multivariate Gaussian distribution approximately. Particularly the SPE and T 2 control limits in PCA/PLS approach are established from the scores and residuals of Gaussian distribution. In industrial practice, however, such a priori requirement may not be fulfilled because the plant often runs at different operating conditions leading to multiple steady states. Thus the collected data are essentially the mixture of multiple Gaussian clusters and follow non-Gaussian distribu-tion as a whole ( Yu and Qin, 2008b ). The process monitoring framework under transition between different operating modes has been investigated in literature ( Sundarraman and Srinivasan, 2003 ). Though the multi-PCA/PLS methods have been developed to handle the intrinsic multimodality of process data, their major limitation lies in the fact that a priori knowledge on the number of operating modes existing in the process is usually needed ( Lane et al., 2001 ; Zhao et al., 2004 , 2006 ; Yu, 2011a , 2011b ; Rashid and
Yu, 2012 ). The more recent effort to tackle this issue has included the development of independent component analysis (ICA) based monitoring approach to detect and diagnose the process faults from non-Gaussian distributed data ( Kano et al., 2003 ; Lee et al., 2004 ). In ICA algorithm, the higher-order statistic of negentropy is used to measure the non-Gaussianity of process data and then a number of statistically independent components are extracted to capture the features of normal operation. The negentropy index, however, does not necessarily reflect the multimodality of pro-cess data, which is very common in industrial plants due to the shifting of operating conditions. Therefore, the monitoring per-formance of ICA method may be degraded for the processes with multiple steady states. Another type of multimode monitoring technique is built upon the Gaussian mixture model (GMM) and has been applied to various continuous or batch processes ( Choi et al., 2004 ; Thissen et al., 2005 ; Yu and Qin, 2008b , 2009b ).
Different from the ICA method, the GMM based monitoring approach specifically decomposes the process data into multiple
Gaussian clusters, each of which corresponds to one of the operating modes. Thus the underlying multimodality of data can be fully retained and the abnormal operation can be detected either through the SPE/ T 2 index within a particular mode or the Bayesian inference across multiple modes.

Though the GMM method has been witnessed great success in predicting abnormal events from multimode plant operation, the literature study is more focused on fault detection while little work has been reported to address the more challenging fault diagnosis issue ( Yu, 2012a , 2012b ). As an extension of the finite
Gaussian mixture model based monitoring approach, this paper is specifically targeted at the fault diagnosis problem in multimode processes through a new Bayesian inference based Gaussian mixture contribution (BIGMC) index. First, the finite Gaussian mixture model is built from the normal operating data with multiple steady states. The optimal number of Gaussian compo-nents is automatically obtained via iterative estimation. The
Mahalanobis distance based variable contribution index, which is analogous to a SPE/ T 2 combined contribution metric ( Yue and
Qin, 2001 ), is then decomposed within each identified Gaussian component. Further, the Bayesian inference strategy is conducted across all the Gaussian modes to integrate the multiple local contribution indices into a single global contribution index, which can be used to identify the major faulty variables.

The rest of this paper is laid out as follows. Section 2 presents a brief review of the finite GMM based fault detection technique. In
Section 3 , the novel Bayesian inference based Gaussian mixture contribution method is proposed to integrate multiple local contributions within all the Gaussian components. The fault diagnosis capability of the new BIGMC approach is demonstrated on the Tennessee Eastman challenge process in Section 4 . Finally
Section 5 outlines the concluding remarks of this paper. 2. Finite Gaussian mixture model based fault detection approach
In Gaussian mixture model ( Bishop, 1995 ; Duda et al., 2001 ), the probability density function of a m -dimensional sample point x from multimode process can be expressed as p  X  x where m i , S i and o i represent the mean, covariance and weight of the i th Gaussian component while G  X  x 9 m i , S i  X  denotes the multi-variate Gaussian probability density function with the mean m and covariance S i as given as follows: G  X  x 9 m i , S i  X  X  1 The total number of Gaussian components K along with the statistical parameters of each component can be estimated from a modified expectation maximization (EM) algorithm ( Figueiredo and Jain, 2002 ). The GMM model can be applied to the original process data without the preliminary step of dimension reduction through PCA.

For industrial multivariate process data, usually there is significant collinearity so that the covariance matrix of the measurement data often suffers from the issue of ill-condition. Thus the regularized instead of the standard Mahalanobis dis-tance metric is used in this work for fault detection within each individual operating mode. Define the regularized Mahalanobis distance D r of the sample point x relative to the i th Gaussian component C i as follows: D  X  X  x , C i  X  9 x A C i  X  X  X  x m i  X  T  X  S i  X  E I  X  1  X  x m where E is a small value used to remove the potential ill-condition of the covariance matrix S i ( Mao and Jain, 1996 ). The above distance D r obeys an approximate w 2 distribution as shown as follows ( Yu and Qin, 2008b ): D  X  X  x , C i  X  9 x A C i  X  -g w 2 h  X  4  X  where g and h are given by g  X  tr  X  S i  X  S i  X  E I  X  and h  X   X  tr  X  S i  X  S i  X  E I  X  The posterior probability of sample x belonging to the i th Gaussian component is computed by P  X  C i 9 x  X  X  P  X  C i  X  p  X  x  X  Then the Bayesian inference based probability index (BIP) of a monitored sample x t can be formulated as BIP  X  which is compared with a specified confidence level  X  1 a  X  100 % in order to determine if the operation is normal or faulty ( Yu and Qin, 2008b ). Here the Mahalanobis distance based probability Pr f D r  X  X  x , C i  X  9 x A C i  X  r D r  X  X  x t , C i  X  9 x that the data points in the i -th operating mode have the shorter distance from the mode center than the monitored sample x while the posterior probability P  X  C i 9 x t  X  corresponds to the like-lihood that the monitored sample x t belongs to the i -th mode. Thus the BIP index can be interpreted as the overall possibility that the data points in all different modes have the shorter distance from the corresponding mode centers than the moni-tored sample x t .
 3. Bayesian inference based Gaussian mixture contribution method for fault diagnosis
In this section, a new Bayesian inference based Gaussian mixture contribution method is developed to isolate and diagnose the leading faulty variables that most likely cause the abnormal operation of multimode processes. Such contribution index, built upon a probabilistic framework, takes into account all the possible operating modes in a process and therefore leads to a comprehensive fault diagnostic with process multimodality embedded.

Assume that the m -dimensional monitored sample x t is expressed as x the regularized Mahalanobis distance metric in Eq. (3) can be rewritten as
D  X  X  x , C i  X  9 x t A C i  X  X  X  x t m i  X  T  X  S i  X  E I  X  1  X  x t  X   X  where s  X  j  X   X  X  0 ... 0 |fflfflffl{zfflfflffl}
Thus the contribution index of the j th variable to the process abnormality under the assumption that x t comes from the i th operating mode can be defined as
CI 9 Selection of Gaussian kernel function Unlabeled training data set X
Identification of support vectors
Estimation of sphere centers  X  k and
Since the probability of the monitored sample x t belonging to the posterior probability weighted contribution index of the j th variable within the i th operating mode is formulated as
CI i  X  P  X  C i  X  P  X  C i 9 x t  X f s  X  j  X   X  S i  X  E I  X  1 = 2  X  x t m i  X g Plugging Eq. (7) into Eq. (12) yields
CI
Thus, the overall contribution of the j th variable to the process abnormality across all the K operating modes can be derived as  X  which is computed by The above contribution is an integrated index with the posterior probabilities as the weighting factors to combine all the K possible operating modes through Bayesian inference strategy, as illustrated in Fig. 1 . Within each operating mode, the regular-ized Mahalanobis distance based individual contribution metric serves as a measure of process variability around a single normal operation region represented by a multi-dimensional ellipsoid geometrically. In practice, the contribution index from Eq. (15) can be scaled as e
CI  X 
It should be noted that the above contribution index represents the quantitative likelihood that the corresponding process vari-able has abnormal behavior. That is, the larger the contribution index value is, the more possibly the corresponding variable has certain kind of abnormality in the process operation. The step-by-step procedure of the Bayesian inference based
Gaussian mixture contribution method is summarized below and the flow diagram of the algorithm is illustrated in Fig. 2 . (i) Collect process historical data as training set that includes (ii) Iterate the modified EM algorithm to search for the optimal (iii) For each monitored sample, compute its posterior prob-(iv) Further calculate the regularized M -distance and the BIP (v) If the BIP value is less than 1 a , the corresponding sample (vi) For the identified faulty sample, compute the local contri-(vii) Further calculate the posterior probability weighted con-(viii) Then compute the overall contribution index value based on (ix) The top variables with the leading contributions that are 4. Application study 4.1. Description of Tennessee Eastman chemical process
In this work, the proposed BIGMC method is applied to the industrial challenge problem, i.e. Tennessee Eastman process (TEP), to verify its fault diagnosis capability in handling the complex multimode processes. The unit operations of Tennessee
Eastman process include an two-phase reactor, a partial conden-ser, a recycle compressor and a stripper ( Downs and Vogel, 1993 ;
Ricker, 1996 ). The process produces two products G and H along with one byproduct F from four reactants A, C, D and E through a series of chemical reactions. Total 22 continuous measurement variables and 12 manipulated variables are selected for monitor-ing purpose while the other 19 lab measurement variable are excluded as they are sampled less frequently with various delays.
All the 41 measurement variables and 12 manipulated variables are listed in Table 1 . The plant operation has six different modes, which are summarized in Table 2 . Among those operating modes, the product composition can shift among 9 : 1, 1 : 9or1 : 1, while the production rate is either specified at a particular target or maximized ( Downs and Vogel, 1993 ). As illustrated in Fig. 3 , the decentralized regulatory control has been designed and deployed on the Tennessee Eastman process with the continuous measure-ment variables operated under closed-loop conditions ( Ricker, 1996 ). Table 3 lists 15 particular process faults that may be present in plant operation as unmeasured disturbances. During process operation, the sampling time of the 34 monitored vari-ables is 0.05 h and the training set consists of 5-day worth of data.
During the normal operation, the first three steady-state operat-ing conditions in Table 2 are assumed to be of the identical prior probability. Hence, 40-hour worth of data are generated under each of three operating modes to form the mixed training set. The Gaussian mixture model built from modified EM algorithm contains three normally distributed clusters with virtually equal weighting factors. In the testing stage, two faulty scenarios are designed to validate the diagnosis capacity of the proposed BIGMC method and demonstrate its superior performance over the single-PCA and multi-PCA based contribution approaches. 4.2. PCA based variable contribution for fault diagnosis
In PCA based process monitoring method, the SPE and T 2 indices are defined as SPE  X  J  X  I PP T  X  x t J 2  X  17  X  and T  X  x T t P L 1 P T x t  X  18  X  where x t denotes the monitored sample, P represents the PCA eigenvalues ( Nomikos and MacGregor, 1994 ; Qin, 2003 ; Aguado and Rosen, 2008 ). The SPE/ T 2 combined contribution indices within the single-PCA and multi-PCA models are used in the comparison of fault diagnosis performance. The combined con-tribution index f  X  j  X  can be expressed as f where m is the overall sample mean vector and F is computed as F  X  with d 2 and w 2 l being the confidence limits for SPE and T respectively ( Yue and Qin, 2001 ). In the multi-PCA method, the K -nearest neighbor ( K NN) clustering is first conducted to classify the samples into different operating modes so that the corre-sponding local PCA models can be built. 4.3. The first test case
In the first case, the process is initially running at mode 1 for 5 h and then switched to mode 3 for another 5 h. After total 10-hour normal operation, the pre-defined fault No. 4 (step change in reactor coolant inlet temperature) occurs in the process. The collected 300 test samples are first inspected through the BIP index to detect any abnormal points. With the specified 95% confidence level, the BIP trend plot is shown in Fig. 4 (a). It can be observed that the BIP index value exceeds the confidence limit line from the 201st sample and then remains the alarm status for nearly all the faulty points. There are only three abnormal samples that are not captured by the fault detection step, while the false alarm rate in this case is only 1 : 5 % . With the vast majority of faulty samples detected correctly, the Bayesian inference based contributions can be computed on all those points to further isolate the faulty variables from the normal ones. As a comparison, the single-PCA based contribution plot, the multi-PCA based contribution plot, and the new Bayesian infer-ence based Gaussian mixture contribution plots are shown in
Figs. 5 (a), 6 (a) and 7 (a), respectively. It should be noted that the contribution plots are generated from one randomly selected faulty sample. The single-PCA based contribution plot indicates that Variable No. 21 (reactor cooling water outlet temperature) has the largest contribution while there are another seven variables with the contributions of similar magnitudes. It appears that the major faulty variables are not well isolated from the others and it is difficult to tell exactly which subset of variables are abnormal ones except for Variable No. 21 (reactor cooling water outlet temperature) with the most dominant contribution.
Though the multi-PCA based contribution plot points out Vari-ables No. 9 (reactor temperature) and No. 32 (reactor coolant flow) as the leading faulty variables with the first and fourth largest contribution values, it also shows clearly that Variables
No. 14 (separator underflow) and No. 34 (agitator speed) have the second and third largest contributions, respectively. These two variables are not diagnosed correctly in the multi-PCA based contribution plot as they are not directly related to the abnormal operation event on reactor coolant temperature. In contrast, the new Bayesian inference based Gaussian mixture contribution plot effectively highlights the few major faulty variables with large contributions, whereas the rest have significantly smaller con-tributions. The four leading variables identified in BIGMC plot are
Variables No. 9 (reactor temperature), No. 21 (reactor cooling water outlet temperature), No. 32 (reactor coolant flow) and
No. 33 (condenser cooling water flow). The time-series trend plots of test data for the top three faulty variables are shown in
Fig. 8 . The unmeasured disturbance of step change in reactor cooling water inlet temperature occurs from the 201st sample, which causes both the reactor temperature and reactor cooling water outlet temperature to increase rapidly. As a result, the temperature control loop in the reactor then opens the cooling water flow valve in order to compensate for the temperature change and drag it back to the setpoint. The upset in reactor temperature profile can be further propagated to the downstream condenser process with decayed impact. That explains why
Variable No. 33 (condenser cooling water flow) has the fourth largest contribution to process abnormality. This test case demon-strates that the fault diagnosis results of BIGMC plot match well the variable interaction and fault propagation through the process while the conventional single-PCA and multi-PCA based contribu-tion plots are unable to accurately diagnose the complicated faults present in multimode processes. Though the multi-PCA based contribution method has improved fault diagnosis perfor-mance than the single-PCA based method, it is not as accurate and reliable as the proposed BIGMC method because some of the misclassified samples into the wrong operating modes by multi-PCA approach due to mode uncertainty or overlapping can cause biased diagnosis results. The proposed BIGMC method, however, adopts Bayesian inference strategy to combine different modes in a probabilistic way so that the risk of wrong classifications is mitigated. 4.4. The second test case
The second test scenario starts at operating mode 2 and remains for 5 h. Then the operating conditions are changed to mode 1 with additional 5-hour duration. In the end of two-mode normal operation, the pre-defined fault No. 10 (increased random variation in C feed temperature of stream 4) is added to the process. Overall 300 test samples are generated and the BIP index based fault detection result is depicted in Fig. 4 (b). Total 97 out of 100 abnormal points are accurately alarmed, while the false alarms are triggered only five times among the 200 normal samples. The average sample is further used to diagnose the introduced process disturbance. Those two kinds of variable contribution plots are shown in Figs. 5 (b) and 7 (b). Similar to the first case, the single-PCA based contribution plot does not well distinguish the abnormal variables from the remaining normal ones. The contribution decomposition is widely spread across a large range of variables so that it is not intuitive to determine the faulty ones. Moreover, the top variables with leading contributions do not coincide with the most abnormal ones driven by the unmeasured disturbance in feed temperature. The multi-PCA based contribution plot appears to be better than the single-PCA one in the aspect of separating the fewer leading variables with the largest contributions. Furthermore, it correctly identifies Vari-able No. 31 (steam valve) as the dominant faulty variable with the largest contribution. However, Variables No. 11 (separator tem-perature) and No. 30 (stripper valve) with the second and third largest contribution values are falsely captured as the variables with major abnormality. For the process fault feed temperature, the downstream separator temperature and the stripper valve should have very small upsets. As opposed to the unsatisfactory diagnosis performance of single-PCA and multi-PCA based con-tribution approaches, the BIGMC method successfully extracts the most significant contributions of the major faulty variables includ-ing Variables No. 18 (reactor level) and No. 31 (steam valve).
When the variation of C feed temperature is dramatically increased, the immediate impact is on the stripper temperature measurement. Further, the temperature control loop is cascaded to the steam flow controller and can result in inflated variations on stripper steam valve position. As validated in Fig. 9 , both stripper temperature and stripper steam valve show significantly increased variations as responses to the disturbance on stripper feed temperature. It is noted that the abnormal event due to unmea-sured disturbance in this case can also be detected as process fault by the GMM based monitoring approach. The proposed fault diagnosis method can point to the few monitored variables that are most significantly impacted by the unmeasured disturbance as the leading faulty variables. The application comparison of the three kinds of contribution methods on the TEP example verifies that the Bayesian inference based Gaussian mixture contribution plot excels the conventional single-PCA and multi-PCA methods in handling fault diagnosis of complex multimode processes. The proposed algorithm is not limited to single-fault scenarios and can be extended to more complicated cases with multiple faults. 5. Conclusions
In this paper, a novel Bayesian inference based Gaussian mixture contribution method is proposed for fault diagnosis of the complicated multimode processes. The traditional SPE/ T combined contribution index is typically based on a single statistical model, which ignores the possibility for the process to run at various operating conditions. However, the operating mode changes that are not uncommon in industrial practices often make the single-PCA based variable contribution approach fail to identify the leading faulty variables. Even the multi-PCA method takes into account the multiple operating modes and builds individual PCA model within each mode, the mode uncertainty and overlapped areas across different operating modes may cause some biased mode classifications so that the fault diagnosis results do not coincide well with the actual abnormal events.
The new BIGMC index is derived within a probabilistic framework with multiple Gaussian sub-models and the Bayesian inference strategy is adopted to integrate the variable contributions within each of the Gaussian components through posterior probabilities.
Compared to the single-PCA and multi-PCA based contribution approaches, the merits of the proposed BIGMC method lie in the facts that not only it takes into account the changes of different operating conditions or modes, but also the Bayesian inference based posterior probabilities across different modes are used to integrate the local contribution index into a global metric with mode uncertainty accounted for. Thus the Gaussian mixture based contribution decomposition tends to be more unbiased for multimode processes and the faulty variables can be isolated from normal ones more accurately.

The proposed fault diagnosis method is applied to the Tennes-see Eastman challenge process with a comparison to the single-
PCA and multi-PCA based contribution approaches. The results in two test scenarios show that the new BIGMC method performs much better than both single-PCA and multi-PCA based contribu-tion techniques in diagnosing the faults of multimode processes. Not only the major faulty variables can be correctly identified by
BIGMC method, but also its contribution index extracts and high-lights the abnormal behaviors hidden in the relevant variables so that they can be readily discriminated from the normal ones in the multivariate contribution plot. In the complex chemical processes like the TEP example, the fault propagation along the process flow can be captured and the root-cause area can be further located around the leading variables with the largest contributions. The present technique can be combined with the finite Gaussian mixture model based abnormality detection approach to offer a comprehensive multimode process monitoring and fault diagnosis solution. The current study is focused on the continuous processes and therefore the future effort may be extending its applications to batch or semi-batch processes.
 References Sample
