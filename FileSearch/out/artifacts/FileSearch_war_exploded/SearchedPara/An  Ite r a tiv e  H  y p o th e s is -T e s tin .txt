 P a tte r n d is c o v e r y h a s e m e r g e d a s a d ir e c t r e s u lt o f in c r e a s e d d a ta s to r a g e a n d a n a ly tic c a p a b ilitie s a v a ila b le to th e d a ta a n a ly s t. W ith o u t a m a s s iv e a m o u n t o f d a ta , w e d o n o t h a v e th e e v id e n c e to s u p p o r t th e d is c o v e r y o f th e lo c a l d e te r m in is tic s tr u c tu r e s th a t w e c a ll p a tte r n s . A s s u c h , p a tte r n d is c o v e r y is o n e o f th e fe w a r e a s o f d a ta m in in g th a t c a n n o t b e c o n s id e r e d s im p ly a s a  X  s c a lin g -u p  X  o f c u r r e n t s ta tis tic a l m e th o d o lo g y to a n a ly z e la r g e d a ta s e ts . H o w e v e r , th e p h ilo s o p h ie s o f h y p o th e s is te s tin g a n d m o d e lin g in tr a d itio n a l s ta tis tic s d o le n d th e m s e lv e s to fo r m in g a fr a m e w o r k fo r p a tte r n d is c o v e r y , a n d w e c a n a ls o d r a w fr o m id e a s r e la tin g to o u tlie r d is c o v e r y a n d r e s id u a l a n a ly s is to d is c o v e r p a tte r n s . W e illu s tr a te a n ite r a tiv e s tr a te g y in a s ta tis tic a l fr a m e w o r k b y w a y o f its a p p lic a tio n to o n e s im u la te d a n d tw o r e a l d a ta s e ts . I .5 .1 [ P a tte r n R e c o g n itio n ] : M o d e ls ---S ta tis tic a l D a ta m in in g , s ta tis tic a l m o d e ls , r e s id u a l a n a ly s is , o u tlie r d e te c tio n , u n c e r ta in ty . P a tte r n d is c o v e r y e m e r g e d in th e e a r ly d a y s o f d a ta m in in g th r o u g h m a r k e t b a s k e t a n a ly s is a n d a s s o c ia tio n r u le s [ 1 ] a n d h a s s in c e b e e n a p p lie d to s e v e r a l a r e a s o f d a ta a n a ly s is in c lu d in g s e q u e n c e a n a ly s is , tim e s e r ie s , te x t m in in g , im a g e a n a ly s is a n d fr a u d d e te c tio n . W e d e fin e a p a tte r n a s a lo c a l d e te r m in is tic s tr u c tu r e th a t g e n e r a te s d a ta w ith a n a n o m a lo u s ly h ig h d e n s ity c o m p a r e d to th a t e x p e c te d u n d e r a ( g lo b a l) b a s e lin e m o d e l. T h is d e fin itio n is e x p a n d e d u p o n in [ 1 5 ] . H y p o th e tic a l e x a m p le s o f p a tte r n s c o u ld in c lu d e th e p u r c h a s e o f b o th H a m a n d E g g s ( s o m e tim e s d e n o te d a s th e a s s o c ia tio n { H a m , E g g s } ) in 2 0 % o f b a s k e ts w h e n w e e x p e c t to s e e 5 % ; a n o th e r e x a m p le m ig h t b e d e c a d e s in fie ld s s u c h a s s ta tis tic s , n e u r a l n e tw o r k s a n d m a c h in e le a r n in g , th e d e v e lo p m e n t o f p a tte r n d is c o v e r y is a r e la tiv e ly n e w p h e n o m e n o n . S ta tis tic s , fo r e x a m p le , h a s to o ls th a t h a v e b e e n d e v e lo p e d s in c e th e e a r ly d e c a d e s o f th e la s t c e n tu r y s p e c ific a lly fo r g lo b a l m o d e lin g , th e m a x im u m -lik e lih o o d fr a m e w o r k a llo w in g fo r m a n y o f th e s e , b u t th e r e is n o s u c h h is to r ic a l d e v e lo p m e n t o f to o ls fo r p a tte r n d is c o v e r y . S ta tis tic a l to o ls w e r e d e v e lo p e d to a n a ly z e th e d a ta o f th e tim e w h ic h , u n til tw e n ty y e a r s a g o , c o n s is te d o f te n s o r h u n d r e d s r a th e r th a n th o u s a n d s o r m illio n s o f o b s e r v a tio n s . S ta tis tic ia n s tr a d itio n a lly m o d e l d a ta a s : I n a s m a ll d a ta s e t, p a tte r n s c a n b e lo s t in th e n o is e in th e d a ta ( c h a r a c te r iz e d b y th e R a n d o m N o is e te r m ) a s th e r e is in s u ffic ie n t e v id e n c e to d is tin g u is h th e s e lo c a l s tr u c tu r e s fr o m th e n o is e in th e d a ta . E q u a tio n ( 1 ) d o e s n o t a llo w fo r p a tte r n d is c o v e r y ; tr a d itio n a lly a n y th in g th a t d o e s n o t fit th e G lo b a l M o d e l is c o n s id e r e d a s n o is e . D ia g n o s tic s a r e e m p lo y e d to te s t th e fit o f th e d a ta to th e G lo b a l M o d e l b y c h e c k in g b o th th e a d e q u a c y o f fit a n d th e d is tr ib u tio n o f w h a t is le ft o v e r ( th e r e s id u a ls o r n o is e ) a fte r fittin g th e G lo b a l M o d e l. T h e R a n d o m N o is e te r m is u s u a lly g iv e n a p a r a m e tr ic d is tr ib u tio n a l fo r m a n d r e s id u a ls c h e c k e d to s e e if th e y s a tis fy th e R a n d o m N o is e d is tr ib u tio n . T h e p u r p o s e o f d ia g n o s tic c h e c k in g h e r e is to s a tis fy u s th a t th e G lo b a l M o d e l is c o r r e c t; if th e r e s id u a ls a r e g r e a tly d iffe r e n t fr o m th e fo r m o f th e R a n d o m N o is e d is tr ib u tio n th e n w e fe e l th a t w e h a v e m is -s p e c ifie d th e G lo b a l M o d e l a n d w o u ld lo o k to fit a n o th e r . W h e r e w e s ta r t to s e e p a tte r n d is c o v e r y is w h e r e m o s t r e s id u a ls s a tis fy th e R a n d o m N o is e fo r m b u t a s m a ll p e r c e n ta g e d o n o t. I n s m a ll d a ta s e ts , a s m a ll p e r c e n ta g e tr a n s la te s to r e s id u a ls c o r r e s p o n d in g to o n e o r tw o d a ta p o in ts ; s ta tis tic ia n s c a ll th e s e d a ta p o in ts  X  o u tlie r s  X  , a s in th e y lie o u ts id e o f th e G lo b a l M o d e l. O u tlie r s a r e g e n e r a lly s e e m a s n u is a n c e d a ta p o in ts th a t c a n a d v e r s e ly a ffe c t th e a c c u r a te fittin g o f th e G lo b a l M o d e l a n d , a s s u c h , o u tlie r s a r e u s u a lly e x a m in e d to s e e if th e r e h a s b e e n a m is ta k e in d a ta e n tr y o r w h e th e r th e d a ta p o in t c a n b e d is c a r d e d in th e d a ta fittin g . O u tlie r s a r e n o t u n c o m m o n a n d th e r e is a c o n s id e r a b le lite r a tu r e c o n c e r n in g th e d ia g n o s is o f o u tlie r s a n d th e fittin g o f m o d e ls th a t a r e r o b u s t to o u tlie r s . B u t th a t is w h e r e th e a n a ly s is e n d s . T h e g o a l is th e G lo b a l M o d e l a n d e v e r y th in g e ls e is R a n d o m N o is e . L a r g e d a ta s e ts c a n b e h e te r o g e n e o u s , o fte n b e c a u s e d a ta c o n c e r n p e o p le a n d p e o p le b e h a v e d iffe r e n tly to e a c h o th e r . T h is h e te r o g e n e ity m e a n s th a t th e r e c a n b e o u tlie r s to a G lo b a l M o d e l a n d in la r g e d a ta s e ts th e r e c a n b e m a n y m o r e o u tlie r s . O u tlie r s a r e g e n e r a te d b y s o m e lo c a l d a ta s tr u c tu r e o th e r th a n th e G lo b a l M o d e l a n d in la r g e d a ta s e ts w e m a y s e e e n o u g h o u tly in g d a ta p o in ts to p r o v id e e v id e n c e o f th is lo c a l g e n e r a tin g s tr u c tu r e o r P a tte r n . W e c a n u p d a te th e s ta tis tic a l v ie w o f d a ta to in c lu d e p a tte r n s a s fo llo w s : A lth o u g h th e s tr u c tu r e o f th e e q u a tio n is little d iffe r e n t fr o m E q u a tio n ( 1 ) , it is in th e u ltim a te g o a l th a t p a tte r n d is c o v e r y d iffe r s fr o m m o d e l b u ild in g . I t is th e P a tte r n s th a t w e a r e s e e k in g w h e n w e a p p ly p a tte r n d is c o v e r y . T h e s p e c ific a tio n o f th e G lo b a l M o d e l o r th e R a n d o m N o is e m a y b e u s e fu l in d is c o v e r in g g e n e r a te d b y a b a s e lin e m o d e l b y th e ir e x p e c te d fr e q u e n c y in th e s a m p le , th e n w e c a n c h a r a c te r iz e th e a lte r n a tiv e h y p o th e s is a s lo c a l r e g io n s o f th e d a ta s p a c e g e n e r a tin g d a ta m o r e ( o r le s s ) fr e q u e n tly th a n is s p e c ifie d b y th e e x p e c te d b a s e lin e d is tr ib u tio n . W h e r e a s th e r e je c tio n o f th e n u ll h y p o th e s is in tr a d itio n a l s ta tis tic s is a g lo b a l d e c is io n , b a s e d o n th e w h o le d a ta s p a c e , th e r e je c tio n o f th e b a s e lin e m o d e l in p a tte r n d is c o v e r y is a lo c a l d e c is io n . I n h y p o th e s is te s tin g w e a r e in te r e s te d in w h e th e r th e g lo b a l e x p e c ta tio n is c o r r e c t; in p a tte r n d is c o v e r y w e w a n t to fin d th e lo c a l r e g io n s w h e r e th e b a s e lin e e x p e c ta tio n is in c o r r e c t. A n o th e r d iffe r e n c e b e tw e e n p a tte r n d is c o v e r y a n d tr a d itio n a l h y p o th e s is te s tin g is th a t th e b a s e lin e m o d e l in p a tte r n d is c o v e r y is u s u a lly b u ilt e m p ir ic a lly fr o m th e d a ta w h e r e a s , in h y p o th e s is te s tin g , w e m a k e a fo r m a l s ta te m e n t b e fo r e th e d a ta a r e o b s e r v e d . S ta tis tic a l m o d e ls c a n h e lp to fo r m b a s e lin e m o d e ls a n d m e th o d s lik e e m p ir ic a l B a y e s [ 9 , 1 0 ] , th a t in c o r p o r a te in fo r m a tio n fr o m th e d a ta in to th e p r io r d is tr ib u tio n , a r e w e ll s u ite d to s u c h a p r a c tic e . A ls o , w h e r e a s h y p o th e s is te s tin g fix e s th e n u ll h y p o th e s is , in p a tte r n d is c o v e r y w e m a y w a n t to u p d a te th e b a s e lin e m o d e l to r e fle c t o u r e x p e c ta tio n s , g iv e n th e d a ta th a t w e h a v e o b s e r v e d . T h is in d ic a te s a n ite r a tiv e h y p o th e s is te s tin g s tr a te g y w ill b e e ffe c tiv e fo r th e p a tte r n d is c o v e r y p r o c e s s a n d w e d is c u s s th is in th e n e x t s e c tio n . F o r n o w w e la y d o w n a h y p o th e s is te s tin g fr a m e w o r k fo r p a tte r n d is c o v e r y . L e t X b e th e s p a c e s p a n n e d b y th e v a r ia b le s d e s c r ib in g th e ite m s in th e d a ta b a s e o r a r b itr a r y s u b s p a c e s o f th is s p a c e ( w e a r e b e in g d e lib e r a te ly v a g u e a b o u t th is -X w ill v a r y fr o m s itu a tio n to s itu a tio n ) . L e t ( ) X f r e p r e s e n t th e p r o b a b ility d e n s ity ( m a s s ) o f th e d a ta a t X a n d b ( X ) th e d e n s ity o f th e d a ta a c c o u n te d fo r b y th e b a s e lin e m o d e l a t X . W e a s s u m e th a t f ( X ) = b ( X ) ( th e b a s e lin e m o d e l is th e s o le d e te r m in is tic d a ta g e n e r a tin g m e c h a n is m fo r X ) a n d w e w a n t to te s t w h e th e r o u r b a s e lin e m o d e l g e n e r a te s th e d a ta in o u r s u b s p a c e o f in te r e s t, X . I t fo llo w s th a t w e a r e te s tin g th e h y p o th e s is th a t th e d a ta in X a r e g e n e r a te d b y o u r s p e c ifie d b a s e lin e m o d e l a g a in s t th e a lte r n a tiv e th a t th e d a ta a r e g e n e r a te d b y a n o th e r , d iffe r e n t b a s e lin e a t X . I f b 0 is o u r c u r r e n t b a s e lin e , th e n w e te s t: w h e r e h y p o th e s is w ith a n a s s o c ia te d a lte r n a tiv e b a s e lin e b 1 . A s in s ta n d a r d h y p o th e s is te s tin g , w e o b ta in a n e s tim a te o f b , b  X  , fr o m th e d a ta s a m p le . I f w e a r e to r e je c t th e n u ll h y p o th e s is ( r e je c tin g th e n u ll b a s e lin e a n d th u s a c c e p tin g th a t th e r e is a p a tte r n p r e s e n t a t X ) w e m u s t h a v e : a n d w h e r e ( ) X N fir s t c o n d itio n s e ts th e c r itic a l le v e l  X  fo r th e r e je c tio n o f a n d fo r w h a t is c o n s id e r e d to b e  X  a n o m a lo u s ly h ig h  X  a n d th e c o lle c tin g m o r e d a ta ( a s s u m in g te m p o r a l in d e p e n d e n c e ) . B a y e s ia n s ta tis tic a l m e th o d s in c o r p o r a te p a r a m e te r u n c e r ta in ty b u t th e u p d a tin g o f th e p o s te r io r d is tr ib u tio n c a n b e c o m p u ta tio n a lly in te n s iv e fo r fle x ib le ( i.e . n o n -c a n o n ic a l) m o d e ls , e v e n fo r s m a ll d a ta s e ts . I n o u r e x a m p le s w e tr e a t b a s e lin e e s tim a te s a s c o n s ta n ts fo r th e h y p o th e s is te s tin g a n d u s e th e s u b s e q u e n t p r o b a b ilitie s a s a g u id e lin e fo r p a tte r n d is c o v e r y r a th e r th a n a s p r o b a b ilitie s in th e tr u e s e n s e . A n o th e r p o in t w o r th m a k in g in th e c o n te x t o f h y p o th e s is te s tin g is th a t w h e n w e s e a r c h fo r p a tte r n s w e a r e p e r fo r m in g m u ltip le te s ts o v e r th e e n tir e s p a c e o f p a tte r n s . P a tte r n d is c o v e r y a lg o r ith m s s e le c t p r o m is in g a r e a s o f th e p a tte r n s p a c e to in v e s tig a te , b u t th o s e a r e a s th a t a r e a v o id e d b y th e a lg o r ith m b e c a u s e th e y fa il to m e e t s o m e c r ite r io n a r e s till te s te d , a t le a s t c o n c e p tu a lly if n o t p h y s ic a lly . C o r r e c tio n s fo r m u ltip le te s tin g fo r d a ta m in in g a r e d is c u s s e d in [ 5 ] , a lth o u g h , a s a b o v e , th e s e c o r r e c te d p r o b a b ilitie s s h o u ld b e u s e d a s a g u id e lin e fo r th e s ig n ific a n c e o f a p a tte r n r a th e r th a n a s p r o b a b ilitie s in th e tr u e s e n s e . B a s e lin e m o d e ls a r e s e ld o m c o m p le te a n d c o r r e c t w h e n w e fir s t b u ild th e m a s th e h e te r o g e n e ity in th e d a ta s p a c e is h a r d to c a p tu r e w ith a n in itia l, g lo b a lly p a r a m e te r iz e d , b a s e lin e m o d e l. T h e n a tu r a l a c tio n is to u p d a te th e b a s e lin e m o d e l a s w e s e e th e d a ta ; a s w e d is c o v e r p a tte r n s , w e c h a n g e o u r b a s e lin e to r e fle c t th e s e d is c o v e r ie s . B y u p d a tin g th e b a s e lin e w e m a y d is c o v e r fu r th e r p a tte r n s th a t h a v e b e e n  X  m a s k e d  X  b y th e ir p r o x im ity to o th e r p a tte r n s a n d u ltim a te ly e n d u p w ith a b a s e lin e th a t is m o r e r e p r e s e n ta tiv e o f o u r n e w e x p e c ta tio n s g iv e n th e d a ta . W e p r e s c r ib e a s tr a te g y fo r u p d a tin g th e b a s e lin e in th e n e x t s e c tio n . T h e r e a r e tw o k in d s o f ite r a tiv e b a s e lin e m o d e l-fittin g . T h e fir s t c o m p r is e s ite r a tio n w ith in a d a ta s e t w h e r e th e b a s e lin e is c o n s tr u c te d ite r a tiv e ly to u n c o v e r p a tte r n s th a t w o u ld o th e r w is e b e h id d e n b y la r g e r lo c a l p a tte r n s . O f c o u r s e , if th e g lo b a l b a s e lin e m o d e l-fittin g p r o c e s s is r o b u s t to a ll lo c a l s tr u c tu r e s in th e d a ta th e n s u c h ite r a tio n n e e d n o t b e n e c e s s a r y . H o w e v e r , th is is n o t th e c a s e in th e e x a m p le s th a t w e u s e to illu s tr a te th is m e th o d o lo g y . T h is k in d o f ite r a tiv e b a s e lin e m o d e l-fittin g w ill b e m o r e c o m m o n ly a p p lie d to d a ta s e ts w ith c o n tin u o u s o r o r d in a l v a r ia b le s w h e r e th e r e is s o m e s p a tia l r e la tio n ; th a t is , w e c a n e a s ily p u t a m e tr ic o n a v a r ia b le s u c h a s a g e ( if a p e r s o n is 4 5 , th e y a r e 2 3 y e a r s o ld e r th a n s o m e o n e w h o is 2 2 ) b u t p u ttin g a m e tr ic o n a c a te g o r ic a l v a r ia b le s u c h a s m a r ita l s ta tu s is n o t s o s tr a ig h tfo r w a r d ( h o w d o e s o n e d e fin e th e s p a tia l r e la tio n o f th e c a te g o r ie s  X  s in g le  X  ,  X  m a r r ie d  X  ,  X  d iv o r c e d  X  a n d  X  w id o w e d  X  ? ) . A s m a ll, y e t in te r e s tin g , p a tte r n a t a g e 2 3 m a y b e o v e r lo o k e d if th e r e is a la r g e r p a tte r n in th e c lo s e v ic in ity , s a y a t a g e 2 5 ; th e g lo b a l m o d e l m a y b e d is to r te d b y th e p a tte r n a t a g e 2 5 a n d th e r e b y m a s k th e p a tte r n a t a g e 2 3 . M o d e l-fittin g te c h n iq u e s fo r c a te g o r ic a l d a ta d o n o t g e n e r a lly e n c o u n te r th is m a s k in g p r o b le m a s c a te g o r ie s a r e n o t  X  c lo s e  X  to e a c h o th e r . T h e s e c o n d k in d o f b a s e lin e m o d e l-fittin g in v o lv e s ite r a tio n b e tw e e n d a ta s e ts , w h e r e a b a s e lin e is c r e a te d b y a p p ly in g p a tte r n d is c o v e r y o n th e fir s t d a ta s e t ( w h ic h m a y o r m a y n o t in v o lv e ite r a tio n o f th e fir s t k in d ) a n d th e n u p d a te d a s m o r e s a m p le d a ta s e ts a r is e a n d c a n b e a n a ly z e d . A n o n -s ta tis tic a l ite r a tiv e a p p r o a c h to u p d a tin g p r io r b e lie fs in th e c o n te x t o f a s s o c ia tio n r u le s c a n b e s e e n in [ 2 0 ] . O f c o u r s e , th e te m p o r a l a s p e c t o f th e s e c o n d ite r a tio n m e a n s th a t p o p u la tio n s A n a d v a n ta g e o f u s in g a s ta tis tic a l a p p r o a c h is th a t w e h a v e m e c h a n is m s a lr e a d y la id d o w n fo r d e a lin g w ith u n c e r ta in ty ; h o w e v e r , s ta tis tic a l m o d e ls c a n b e s o m e w h a t r e s tr ic tiv e in th e ir fo r m a n d th u s p r o v id e c h a lle n g e s in th e m o d e l-fittin g p r o c e s s . A d iffic u lty in s ta tis tic a l m o d e lin g h a s o fte n b e e n in p r o v id in g a r o b u s t m o d e l fit in s p ite o f th e p r e s e n c e o f o u tlie r s ; w h e n w e h a v e P a tte r n s in th e d a ta , th is d iffic u lty is e x a c e r b a te d . W e fe e l th a t th e b e s t w a y to illu s tr a te s o m e p o s s ib le a p p r o a c h e s to ite r a tiv e p a tte r n d is c o v e r y is th r o u g h s o m e s im p le e x a m p le s . W e d e m o n s tr a te ite r a tiv e b a s e lin e m o d e l fittin g a n d r e s id u a l c h e c k in g u s in g a s e le c tio n o f p a r a m e tr ic a n d n o n -p a r a m e tr ic s ta tis tic a l m o d e ls o n o n e a r tific ia l d a ta s e t, a r e a l d a ta s e t c o n s is tin g o f c r e d it c a r d p u r c h a s e s a t p e tr o l s ta tio n s a n d a n o th e r r e a l d a ta s e t fr o m a B e lg ia n s u p e r m a r k e t. W e u s e th e a r tific ia l d a ta s e t a n d p e tr o l d a ta s e t to d e m o n s tr a te ite r a tiv e b a s e lin e m o d e l-fittin g o f th e fir s t k in d ; w e d is c u s s ite r a tiv e b a s e lin e m o d e l-fittin g o f th e s e c o n d k in d u s in g th e B e lg ia n s u p e r m a r k e t d a ta b y fittin g th e fir s t ite r a tio n a n d d is c u s s in g p o s s ib le a p p r o a c h e s fo r th e s e c o n d ite r a tio n if th e s itu a tio n a r is e s w h e r e fu r th e r d a ta s a m p le s a r e a v a ila b le . T h e b a s e lin e m o d e ls in th e s e e x a m p le s a r e d e r iv e d e m p ir ic a lly fr o m g lo b a l fe a tu r e s o f th e d a ta s e ts r a th e r th a n b y p r io r b e lie fs . P a tte r n s d is c o v e r e d a t e a c h ite r a tio n a r e b u ilt in to th e b a s e lin e m o d e l w h e th e r th e y a r e u ltim a te ly  X  in te r e s tin g  X  to th e a n a ly s t o r n o t. A ll p a tte r n s d is c o v e r e d a t a p a r tic u la r ite r a tio n a r e u n e x p e c te d c o m p a r e d to th e b a s e lin e d e fin e d a t th a t ite r a tio n . W h e th e r th e y a r e u ltim a te ly in te r e s tin g is a q u e s tio n to b e a n s w e r e d o n c e th e ite r a tiv e p r o c e s s is c o m p le te a n d w e w ill d is c u s s th is fu r th e r in o u r c o n c lu s io n s . O u r fir s t e x a m p le is a s im u la te d d a ta s e t ( M I X 1 ) c o n ta in in g 9 9 ,7 5 0 o b s e r v a tio n s in d e p e n d e n tly s a m p le d fr o m a g lo b a l p o p u la tio n 1 P , r e p r e s e n te d b y a s ta n d a r d n o r m a l d is tr ib u tio n ( w ith m e a n e q u a l to 0 a n d s ta n d a r d d e v ia tio n e q u a l to 1 ) a n d 2 5 0 o b s e r v a tio n s in d e p e n d e n tly s a m p le d fr o m a lo c a l p o p u la tio n 2 P , r e p r e s e n te d b y a n o r m a l d is tr ib u tio n w ith m e a n e q u a l to 2 a n d s ta n d a r d d e v ia tio n e q u a l to 0 .0 1 . P o p u la tio n 2 P r e p r e s e n ts a p a tte r n in th e d a ta g e n e r a tin g m e c h a n is m s u p p o r te d b y 0 .2 5 % o f th e c o m b in e d p o p u la tio n . F ig u r e 1 s h o w s h is to g r a m s a n d a k e r n e l d e n s ity e s tim a te o f M I X 1 fo r v a r io u s s c a le s o f r e s o lu tio n . A s m o r e d e ta il in th e d e n s ity e s tim a te is s h o w n , s o w e s e e th e e m e r g e n c e o f e v id e n c e fo r p o p u la tio n 2 P . A n o r m a l q u a n tile -q u a n tile p lo t is a s ta tis tic a l d ia g n o s tic to o l fo r e x a m in in g w h e th e r a s a m p le is c o n s is te n t w ith a n o r m a l d is tr ib u tio n ; a s tr a ig h t lin e in d ic a te s a g o o d fit to th e n o r m a l d is tr ib u tio n . C lo s e in s p e c tio n o f s u c h a n o r m a l q u a n tile -q u a n tile p lo t fo r M I X 1 ( F ig u r e 2 ) s h o w s little e v id e n c e ( o th e r th a n a s lig h t  X  k in k  X  in th e p lo t) fo r p o p u la tio n 2 P . O th e r s ta tis tic a l d ia g n o s tic to o ls fo r m e a s u r in g th e in flu e n c e o f o b s e r v a tio n s , s u c h a s C o o k  X  s d is ta n c e [ 8 ] d o n o t id e n tify th e p a tte r n o b s e r v a tio n s a s h a v in g h ig h in flu e n c e , b u t r a th e r th o s e in th e ta ils o f th e s a m p le fr o m p o p u la tio n 1 P . n o w p e r fo r m p a tte r n d is c o v e r y b y lo o k in g a t q u a n tile s o f th e d e n s ity in a m a n n e r s im ila r to r e s id u a l c h e c k in g . Q u a n tile s a r e n e ig h b o r in g b in s c o n ta in in g d a ta in e q u a l d e n s ity . W e ta k e th e q u a n tile s , 1 0 0 / Q % in te r v a ls fr o m 0 to 1 0 0 % . U n d e r o u r b a s e lin e d is tr ib u tio n , w e e x p e c t th e d e n s ity b e tw e e n to b e e q u a l to 1 / Q . W e c a n m o d e l th e e v e n t th a t a n o b s e r v a tio n d r a w n r a n d o m ly fr o m th e b a s e lin e d is tr ib u tio n fa lls b e tw e e n T h is a s s u m p tio n is r e a s o n a b le to m a k e if th e p r o b a b ility d e n s ity o f th e d a ta r e g io n s p a n n e d b y th e q u a n tile is a p p r o x im a te ly u n ifo r m ; w e e n s u r e th is b y s e ttin g Q la r g e , th e r e b y m a k in g th e q u a n tile in te r v a ls s m a ll. S in c e w e h a v e n = 1 0 0 ,0 0 0 s a m p le o b s e r v a tio n s , w e u s e a B in o m ia l( 1 0 0 0 0 0 , 1 / Q ) d is tr ib u tio n to e s tim a te th e e x p e c te d n u m b e r o f o b s e r v a tio n s fa llin g b e tw e e n e a c h q u a n tile . S in c e th e n o r m a l d is tr ib u tio n is d e fin e d b y its m e a n a n d v a r ia n c e , a n d th e s e a r e e s tim a te d fr o m a la r g e s a m p le , th e v a r ia n c e a s s o c ia te d w ith o u r b a s e lin e d e n s ity e s tim a te is s m a ll r e la tiv e to a d e n s ity e s tim a te p r o v id e d b y q u a n tile s . S in c e w e h a v e Q q u a n tile s , w e m u s t a llo w fo r Q m u ltip le te s ts w h e n te s tin g w h e th e r w h a t w e h a v e o b s e r v e d in th e d a ta r e p r e s e n ts o u r e x p e c ta tio n s th r o u g h o u r b a s e lin e m o d e l. W e d o th is b y c o n tr o llin g th e fa m ily w is e e r r o r r a te ( s e e , fo r e x a m p le , [ 2 1 ] a n d fo r a p r a c tic a l e x a m p le in d a ta m in in g , [ 5 ] ) , a p p ly in g a B o n fe r r o n i c o r r e c tio n , a c o n s e r v a tiv e c o r r e c tio n fo r s ig n ific a n c e v a lu e s . T h e c h o ic e o f Q is a tr a d e -o ff b e tw e e n d e ta il a n d p o w e r ; if w e in c r e a s e Q , w e m a y fin d in c r e a s in g ly lo c a l a n d m ic r o s c o p ic e ffe c ts , h o w e v e r , in d o in g s o w e in c r e a s e th e n u m b e r o f m u ltip le te s ts , m a k in g th e B o n fe r r o n i c o r r e c tio n m o r e c o n s e r v a tiv e . I n th is e x a m p le w e s e t Q = 1 ,0 0 0 ; w e e x p e c t 1 0 0 o b s e r v a tio n s p e r q u a n tile in te r v a l w ith a B o n fe r r o n i 9 5 % c o r r e c te d c o n fid e n c e in te r v a l o f ( 6 2 ,1 4 3 ) . T h a t is , u n d e r th e n u ll h y p o th e s is w e e x p e c t s u c h a n in te r v a l to c o n ta in th e tr u e n u m b e r o f o b s e r v a tio n s p e r q u a n tile 1 0 0 .( 1 -0 .0 5 / Q ) % o f th e tim e . T h is ta k e s in to a c c o u n t th e m u ltip le te s ts th a t w e p e r fo r m b y in v e s tig a tin g e a c h q u a n tile  X  b in  X  in d iv id u a lly . W e u s e th e c o n s e r v a tiv e c o r r e c tio n a s w e a r e a w a r e th a t th e b a s e lin e d is tr ib u tio n is a n e s tim a te a n d th a t w e s h o u ld e r r o n th e s id e o f c a u tio n w h e n d e c id in g to r e je c t th e n u ll h y p o th e s is a n d a c c e p t a p a tte r n a s b e in g r e a l. W e s h o w a p lo t o f th e o b s e r v e d ( d a s h -d o t lin e ) a n d e x p e c te d ( s o lid lin e ) n u m b e r o f o b s e r v a tio n s fo r e a c h q u a n tile in te r v a l, to g e th e r w ith th e B o n fe r r o n i 9 5 % c o r r e c te d in te r v a l ( d o tte d lin e ) in F ig u r e 3 . W e o b s e r v e a p e a k b e tw e e n th e q u a n tile s d e fin e d b y x = 1 .9 9 4 a n d x = 2 .0 1 3 w h e r e th e r e a r e 2 4 6 o b s e r v a tio n s . I n th e q u a n tile in te r v a ls to e ith e r s id e o f th is p e a k w e o b s e r v e 1 8 0 a n d 1 3 5 o b s e r v a tio n s r e s p e c tiv e ly . T h e r e is a n in d ic a tio n o f th e p r e s e n c e o f a lo c a liz e d s tr u c tu r e ( a p a tte r n ) a r o u n d x = 2 w h ic h , fo r th e p u r p o s e s o f th is e x a m p le w e w ill m o d e l u s in g a fu n c tio n 1 h , r e p r e s e n te d b y a n o th e r n o r m a l d is tr ib u tio n . T h e m o d e l ( b a s e lin e + p a tte r n + r a n d o m n o is e ) c a n b e fitte d u s in g a m ix tu r e o f n o r m a l d is tr ib u tio n s . A t th e s ta r t o f th e ite r a tio n w e h a v e : 
F ig u r e 4 . O b s e r v e d a n d e x p e c t e d c o u n t s f o r e a c h q u a n t ile o f W e h a v e a d is c o v e r e d a p a tte r n a t 0 0 0 3 3 . 2 = x w ith r e s p e c t to th e in itia l b a s e lin e e x p e c ta tio n , n o r m a l d is tr ib u tio n . W h e th e r th is p a tte r n is  X  in te r e s tin g  X  d e p e n d s o n w h e th e r th e d o m a in e x p e r t X  s b a s e lin e c o r r e s p o n d s to b 0 r a th e r th a n b 1 . I f th e fo r m e r c a s e is tr u e , th e n w e h a v e d is c o v e r e d a n in te r e s tin g p a tte r n ; if th e la tte r is tr u e a n d b 1 r e p r e s e n ts th e ir b a s e lin e e x p e c ta tio n , th e n a t le a s t w e h a v e a m o r e c o m p le te a n d b e tte r s p e c ifie d b a s e lin e m o d e l fo r p a tte r n d is c o v e r y a p p lie d to fu tu r e s a m p le s fr o m th is p o p u la tio n . T h e s e c o n d e x a m p le e x a m in e s th e P E T R O L d a ta s e t. T h is d a ta s e t c o n ta in s 1 5 1 ,3 3 4 c r e d it c a r d tr a n s a c tio n s o f le s s th a n  X  6 0 ( r o u n d e d to th e n e a r e s t p o u n d ) m a d e a t p e tr o l s ta tio n s in th e U K o v e r a p e r io d o f tim e . A b a r c h a r t o f th e p u r c h a s e s ( to p h a lf o f F ig u r e 6 ) s h o w s s e v e r a l u n u s u a l m o d e s o f b e h a v io r . T h e r e s e e m to b e u n u s u a lly la r g e p e a k s a t m u ltip le s o f fiv e a n d te n p o u n d s a m o n g s t o th e r s ; r e m e m b e r th a t th e s e a r e c r e d it c a r d p u r c h a s e s ( in th is c a s e P = { 1 0 , 2 0 , 3 0 , 4 0 , 5 0 } ) th a t fa ll o u ts id e B o n fe r r o n i b o u n d s fo r th e e x p e c te d c o u n ts g iv e n th e s a m p le s iz e a n d th e b a s e lin e d e n s ity b 1 . A t th e e n d o f th is fir s t ite r a tio n w e h o p e to h a v e a b a s e lin e m o d e l o f th e fo r m ) ( ) 1 ( ) ( ) ( T h e fir s t s te p is to fit in te r m e d ia te e s tim a te s fo r g 1 a n d h 1 (  X  h r e s p e c tiv e ly ) b y ta k in g th e d e n s ity o f r e s id u a ls fr o m th e b a s e lin e m o d e l a t e a c h p a tte r n , s o r e s id u a l d e n s ity a t i = ( u s in g ) (  X  fo r m o f h  X  to a m ix tu r e o f in d ic a to r fu n c tio n s o n th e in te g e r s in P . A s h  X  is a m ix tu r e o f in d ic a to r fu n c tio n s w e c a n e s tim a te th e m ix in g p r o p o r tio n s a s th e r e s id u a l fr o m th e b a s e lin e m o d e l a t e a c h p a tte r n , d iv id e d b y th e s a m p le s iz e . T h e s e c o n d s te p is to r e fit th e g lo b a l m o d e l b y th e s a m e K D E m e th o d to th e d a ta n o w d e fin e d b y ) (  X  ) 1 ( ) ( r e m o v e th e e x c e s s d e n s ity a t th e p a tte r n lo c a tio n s . W e ite r a te p r o c e s s is to s m o o th o u t e a c h p a tte r n s o th a t th e g lo b a l d e n s ity a t th e lo c a tio n o f a p a tte r n b e c o m e s a w e ig h te d a v e r a g e o f th e d e n s ity o f its n e ig h b o r s . T h e tr a n s a c tio n a m o u n ts th a t a r e n o t id e n tifie d a s p a tte r n s , a n d w h o s e d e n s itie s f ( x ) a r e th u s fix e d in th e s e c o n d s te p , h e lp th e g lo b a l K D E s ta b iliz e . T o fit fu r th e r p a tte r n s w e p e r fo r m th e s a m e s c h e m e e x c e p t th a t w e s e t m ix in g p r o p o r tio n s fo r a ll p r e v io u s ly d is c o v e r e d p a tte r n s a r e u p d a te d d u r in g e a c h ite r a tio n . W e s h o w th e r e s u lt o f th is fir s t ite r a tio n a t th e to p o f F ig u r e 7 . T h e n e x t p a tte r n s id e n tifie d a r e th o s e a t x = 5 , 1 5 a n d 2 5 . W e fit th e s e p a tte r n s ( a lo n g w ith th e p a tte r n s a t x = 1 0 , 2 0 , 3 0 , 4 0 a n d 5 0 ) in th e s e c o n d ite r a tio n , th e r e s u lt o f w h ic h c a n b e s e e n in th e b o tto m h a lf o f F ig u r e 7 . F u r th e r p a tte r n s c a n b e id e n tifie d a t x = 6 , 1 2 , 1 8 a n d 2 4 . T h e s e p a tte r n s a r e a c c o u n te d fo r in th e th ir d ite r a tio n . F in a lly , w e a ls o s e e p a tte r n s a t x = 9 a n d 1 6 , w h ic h w e fit in th e fo u r th ite r a tio n . W e c a n s e e th e s e ite r a tio n s in F ig u r e 8 ; th e fin a l  X  r e s id u a l X  p lo t s h o w s th a t th e r e a r e n o m o r e p a tte r n s a t th is r e s o lu tio n . T h e p a tte r n a t x = 9 is o u r fir s t e x a m p le o f a  X  n e g a tiv e  X  p a tte r n w h e n c o m p a r e d to th e g lo b a l m o d e l. T h a t is n o t to s a y th a t w e h a v e o b s e r v e d a n e g a tiv e n u m b e r o f  X  9 tr a n s a c tio n s , b u t r a th e r th a t th e p a tte r n is o f lo w e r th a n e x p e c te d fr e q u e n c y o f th is p u r c h a s e a m o u n t w h e r e  X  e x p e c te d  X  is d e te r m in e d b y th e g lo b a l m o d e l. T h e n e x t s ta g e is to c o n s u lt th e d o m a in e x p e r t fo r a n e x p la n a tio n o f th e p a tte r n s . P e o p le r o u n d in g to th e n e a r e s t fiv e o r te n c a n e x p la in p a tte r n s a t m u ltip le s o f fiv e a n d te n p o u n d s . T h is is n o t n e c e s s a r y a s th e p u r c h a s e is m a d e u s in g a c r e d it c a r d ; h o w e v e r , m a y b e o ld c a s h p u r c h a s in g h a b its d ie h a r d , o r it m a k e s it e a s ie r fo r a m o to r is t to k e e p tr a c k o f th e ir s p e n d in g b e h a v io r . V o u c h e r s fo r g ifts a t p e tr o l s ta tio n s u s e d to b e is s u e d fo r e v e r y  X  6 o f p e tr o l p u r c h a s e d . T h is w o u ld e x p la in th e p a tte r n s a t m u ltip le s o f s ix p o u n d s . T h e  X  d ip  X  a t n in e p o u n d s c a n b e e x p la in e d b y p e o p le w a n tin g to r o u n d u p to te n p o u n d s , h o w e v e r w e c a n n o t, a s y e t, p r o v id e a n e x p la n a tio n fo r th e p a tte r n a t  X  1 6 . P a tte r n s 5 6 9 1 0 1 2 1 5 1 6 p 4 ,k 0 .0 0 9 8 0 .0 0 6 7 -0 .0 0 5 1 0 .0 7 0 8 0 .0 1 9 7 0 .0 4 1 4 0 .0 0 7 5 P a tte r n s 1 8 2 0 2 4 2 5 3 0 4 0 5 0 p 4 ,k 0 .0 1 1 5 0 .0 5 0 8 0 .0 0 6 0 0 .0 1 2 6 0 .0 1 0 6 0 .0 0 1 9 0 .0 0 1 3 P a tte r n d is c o v e r y w a s a p p lie d to a s u b s e t o f th e s e d a ta th r o u g h s im p le g r a p h ic a l a n a ly s e s in [ 1 2 ] a n d [ 1 3 ] . I n s p e c tio n o f h is to g r a m s o f th e d a ta r e v e a le d p a tte r n s a t m u ltip le s o f fiv e a n d te n p o u n d s a n d a ls o a t  X  1 2 a n d  X  1 8 . B y a p p ly in g ite r a tiv e p a tte r n d is c o v e r y w e h a v e d is c o v e r e d fu r th e r p a tte r n s in th e d a ta . T h e s e c o n d r e a l d a ta s e t is ta k e n fr o m a B e lg ia n S u p e r m a r k e t a n d r e p r e s e n ts th e c o n te n ts o f b a s k e ts p u r c h a s e d o v e r a p e r io d o f tim e . T h e p r o d u c ts p u r c h a s e d a r e a n o n y m iz e d fo r c o m m e r c ia l r e a s o n s . W e w o u ld lik e to illu s tr a te ite r a tiv e p a tte r n d is c o v e r y o f th e s e c o n d k in d ( ite r a tio n b e tw e e n d a ta s e ts ) ; h o w e v e r , in th e a b s e n c e o f fu r th e r d a ta s e ts ( s im p ly s a m p lin g o r s p littin g th e d a ta s e t to s im u la te s a m p le d a ta s e ts a t m u ltip le tim e p o in ts s h o u ld n o t r e v e a l n e w p a tte r n s a n d th e r e fo r e d o e s n o t illu s tr a te th e p o in t w e w is h to m a k e ) , w e u s e th is d a ta s e t to w o r k th r o u g h a th o u g h t e x p e r im e n t a s th o u g h s u c h in fo r m a tio n w e r e a v a ila b le . T h is d a ta s e t a ls o s e r v e s to illu s tr a te h o w w e w o u ld ta c k le p a tte r n d is c o v e r y o n c a te g o r ic a l d a ta u s in g a s s o c ia tio n s to r e p r e s e n t p a tte r n s , a c o m m o n e x e r c is e in d a ta m in in g . I n th is d a ta s e t th e r e a r e 7 7 ,4 2 5 b a s k e ts c o n ta in in g a n a v e r a g e 1 0 d is tin c t p r o d u c ts fr o m a p o s s ib le 1 5 ,9 7 2 p r o d u c ts . W e a r e in te r e s te d in th e fr e q u e n c y o f p a ir w is e a s s o c ia tio n s o v e r th e s e b a s k e ts ; w e tr e a t e a c h p r o d u c t a s a d is tin c t c a te g o r y a n d p la c e n o s im ila r ity m e tr ic o n th e p r o d u c ts fo r e a s e o f a n a ly s is a n d d e m o n s tr a tio n p u r p o s e s . W e a p p lie d o n e ite r a tio n o f p a tte r n d is c o v e r y u s in g a P o is s o n in d e p e n d e n c e b a s e lin e m o d e l, a s in [ 5 ] , r a n k in g p a ir w is e a s s o c ia tio n s a c c o r d in g to th e p r o b a b ility th a t th e y w e r e g e n e r a te d b y th e b a s e lin e P o is s o n d is tr ib u tio n w ith p a r a m e te r s e s tim a te d fr o m th e in d e p e n d e n c e m o d e l. T h o s e p a ir w is e a s s o c ia tio n s th a t a p p e a r a n o m a lo u s ly fr e q u e n tly w h e n c o m p a r e d w ith th e b a s e lin e m o d e l a r e c o n s id e r e d to b e p a tte r n s . A t th e B o n fe r r o n i c o r r e c te d 1 % c r itic a l le v e l w e o b s e r v e d 1 0 ,7 8 0 s ig n ific a n t p a tte r n s fr o m a p o s s ib le 1 2 7 ,5 6 0 ,3 7 8 . T h e a n o n y m o u s n a tu r e o f th e d a ta s e t p r e c lu d e s a d e ta ile d e v a lu a tio n o f th e d is c o v e r e d p a tte r n s r e g a r d in g th e ir  X  in te r e s tin g n e s s  X  w ith in th e d o m a in . H o w e v e r , w e s u b m itte d th e to p -r a n k e d 6 0 0 p a tte r n s ( th o s e w ith th e s m a lle s t p r o b a b ilitie s ) to th e d a ta s e t o w n e r fo r in s p e c tio n , w h o s a w n o th in g u n u s u a l in th e r e s u lts . T h is w o u ld s u g g e s t th a t n a  X v e e x p e c ta tio n s a r e n o t e n o u g h to c o m p le te th e b a s e lin e m o d e l; e x p e c te d p a tte r n s e x is t th a t v io la te th e a s s u m p tio n o f in d e p e n d e n c e . T h e n e x t s te p is to b u ild th e s e e x p e c te d p a tte r n s in to o u r b a s e lin e . A lth o u g h th is is a c o n s id e r a b le n u m b e r o f p a tte r n s to in v e s tig a te , it d o e s r e p r e s e n t le s s th a n 0 .0 0 0 5 % o f a ll p o s s ib le p a tte r n s . W e m a y w a n t to fu r th e r r e s tr ic t th e n u m b e r o f p a tte r n s th a t w e s u b m it to th e d o m a in e x p e r t fo r v e r ific a tio n ( in th e in te r e s ts o f m a in ta in in g m o r a le !) , w h ic h w e c a n d o b y s e le c tin g a m a n a g e a b le n u m b e r o f d im e n s io n s c a n s u ffe r fr o m th is  X  c u r s e o f d im e n s io n a lity  X  [ 2 ] a n d a lth o u g h d im e n s io n r e d u c tio n te c h n iq u e s s u c h a s p r o je c tio n p u r s u it [ 3 ] a im to o v e r c o m e th is  X  c u r s e  X  , th e ir s u ita b ility fo r a id in g p a tte r n d is c o v e r y h a s n o t b e e n in v e s tig a te d . N o n e o f th e e x a m p le s th a t w e u s e d to illu s tr a te ite r a tiv e m o d e l-b a s e d p a tte r n d is c o v e r y w e r e s e q u e n tia l, s u c h a s p r o te in s e q u e n c e s , te x t d a ta o r tim e s e r ie s d a ta ; h o w e v e r , b a s e lin e e x p e c ta tio n s c a n b e fitte d to s e q u e n tia l d a ta a s m o d e ls . I n [ 7 ] a H id d e n M a r k o v m o d e l fits b o th th e b a s e lin e m o d e l a n d p o s s ib le p a tte r n s o f fix e d d im e n s io n ; a n ite r a tiv e a p p r o a c h w o u ld tr y to fit th e b a s e lin e m o d e l a n d th e n lo o k fo r d e p a r tu r e s fr o m th is b a s e lin e a s c a n d id a te s fo r p a tte r n s , m u c h a s fr a u d d e te c tio n m e th o d s s e e k to m o d e l a b a s e lin e o f u s u a l b e h a v io r a n d lo o k fo r d e p a r tu r e s fr o m th is to in d ic a te in tr u s io n s [ 2 3 ] . T h is r e s e a r c h is s u p p o r te d b y D A R P A /A F R L u n d e r c o n tr a c t N o F 3 0 6 0 2 -0 1 -2 -0 5 8 0 . T h e U .S . G o v e r n m e n t is a u th o r iz e d to r e p r o d u c e a n d d is tr ib u te r e p r in ts fo r g o v e r n m e n ta l p u r p o s e s n o tw ith s ta n d in g a n y c o p y r ig h t n o ta tio n h e r e o n . T h e v ie w s a n d c o n c lu s io n s c o n ta in e d h e r e in a r e th o s e o f th e a u th o r s a n d s h o u ld n o t b e in te r p r e te d a s n e c e s s a r ily r e p r e s e n tin g th e o ffic ia l p o lic ie s o r e n d o r s e m e n ts e ith e r e x p r e s s e d o r im p lie d , o f th e D e fe n s e A d v a n c e d R e s e a r c h P r o je c ts A g e n c y /A ir F o r c e R e s e a r c h L a b s o r th e U .S . G o v e r n m e n t. W e w o u ld lik e to th a n k G o r d o n B lu n t fo r p r o v id in g th e P E T R O L d a ta s e t a n d T o m B r ijs fo r p r o v id in g th e B e lg ia n s u p e r m a r k e t d a ta s e t a n d g iv in g fe e d b a c k o n th e p a tte r n s d is c o v e r e d . [ 1 ] A g r a w a l, R ., I m ie lin s k i, T ., a n d S w a m i, A . ( 1 9 9 3 ) M in in g [ 2 ] B e llm a n , R . E . A d a p tiv e c o n tr o l p r o c e s s e s : a g u id e d to u r . [ 3 ] B o lto n , R . J . a n d K r z a n o w s k i, W . J . ( 1 9 9 9 ) A [ 4 ] B o lto n , R . J . a n d H a n d , D . J . S ig n ific a n c e te s ts fo r p a tte r n s in [ 5 ] B o lto n , R . J ., H a n d , D . J ., a n d A d a m s , N . M . D e te r m in in g [ 6 ] B r e im a n , L . ( 2 0 0 1 ) S ta tis tic a l m o d e lin g : T h e tw o c u ltu r e s , [ 7 ] C h u d o v a , D . a n d S m y th , P . P a tte r n d is c o v e r y in s e q u e n c e s 
