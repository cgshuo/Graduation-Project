 In the study of human learning, there is broad evidence that our ability to retain information improves with repeated ex-posure and decays with delay since last exposure. This plays a crucial role in the design of educational software, leading to a trade-off between teaching new material and reviewing what has already been taught. A common way to balance this trade-off is spaced repetition , which uses periodic review of content to improve long-term retention. Though spaced repetition is widely used in practice, e.g., in electronic flash-card software, there is little formal understanding of the design of these systems. Our paper addresses this gap in three ways. First, we mine log data from spaced repetition software to establish the functional dependence of retention on reinforcement and delay. Second, we use this memory model to develop a stochastic model for spaced repetition systems. We propose a queueing network model of the Leit-ner system for reviewing flashcards, along with a heuristic approximation that admits a tractable optimization prob-lem for review scheduling. Finally, we empirically evaluate our queueing model through a Mechanical Turk experiment, verifying a key qualitative prediction of our model: the exis-tence of a sharp phase transition in learning outcomes upon increasing the rate of new item introductions.
  X  Applied computing  X  Computer-assisted instruc-tion;  X  Mathematics of computing  X  Queueing the-ory; Spaced Repetition; Queueing Models; Human Memory
The ability to learn and retain a large number of new pieces of information is an essential component of human learning. Scientific theories of human memory, going all the way back to 1885 and the pioneering work of Ebbinghaus [9 ], identify two critical variables that determine the probability of recalling an item: reinforcement , i.e., repeated exposure to the item, and delay , i.e., time since the item was last re-viewed. Accordingly, scientists have long been proponents of the spacing effect for learning: the phenomenon in which periodic, spaced review of content improves long-term reten-tion.

A significant development in recent years has been a grow-ing body of work that attempts to  X  X ngineer X  the process of human learning, creating tools that enhance the learning process by building on the scientific understanding of hu-man memory. These educational devices usually take the form of  X  X lashcards X   X  small pieces of information content which are repeatedly presented to the learner on a sched-ule determined by a spaced repetition algorithm [ 4]. Though flashcards have existed for a while in physical form, a new generation of spaced repetition software such as SuperMemo [20], Anki [10 ], Mnemosyne [2 ], Pimsleur [18 ], and Duolingo [3] allow a much greater degree of control and monitoring of the review process. These software applications are growing in popularity [4 ], but there is a lack of formal mathemati-cal models for reasoning about and optimizing such systems. In this work, we combine memory models from psychology with ideas from queueing theory to develop such a mathe-matical model for these systems. In particular, we focus on one of the simplest and oldest spaced repetition methods: the Leitner system [13].

The Leitner system, first introduced in 1970, is a heuristic for prioritizing items for review. It is based on a series of decks of flashcards. After the user sees a new item for the first time, it enters the system at deck 1. The items at each deck form a first-in-first-out (FIFO) queue, and when the user requests an item to review, the system chooses a deck i according to some schedule, and presents the top item. If the user does not recall the item, the item is added to the bottom of deck i  X  1; else, it is added to the bottom of deck i +1. The aim of the scheduler is to ensure that items from lower decks are reviewed more often than those from higher decks, so the user spends more time working on forgotten items and less time on recalled items. Existing schemes for assigning review frequencies to different decks are based on heuristics that are not founded on any formal reasoning, and hence, have no optimality guarantees. One of our main contributions is a principled method for determining appropriate deck review frequencies.

The problem of deciding how frequently to review different decks in the Leitner system is a specific instance of the more general problem of review scheduling for spaced repetition software. The main challenge in all settings is that schedules must balance competing priorities of introducing new items and reviewing old items in order to maximize the rate of learning. While most existing systems use heuristics to make this trade-off, our work presents a principled understanding of the tension between novelty and reinforcement.
The scientific literature on modeling human memory is highly active and dates back more than a century. One of the simplest memory models, the exponential forgetting curve , was first studied by Ebbinghaus in 1885 [ 9]  X  it models the probability of recalling an item as an exponentially-decaying function of the time elapsed since previous review and the memory  X  X trength X . The exact nature of how strength evolves as a function of the number of reviews, length of review in-tervals, and other factors is a topic of debate, though there is some consensus on the existence of a spacing effect , in which spaced reviews lead to greater strength than massed reviews (i.e., cramming) [8 , 5]. Recent studies have proposed more sophisticated probabilistic models of learning and forgetting [17 , 15 ], and there is a large body of related work on item response theory and knowledge tracing [ 14, 7]. Our work both contributes to this literature (via observational studies on log data from the Mnemosyne software) and uses it as the basis for our queueing model and scheduling algorithm.
Though used extensively in practice (see [ 4] for an excel-lent overview), there is very limited literature on the de-sign of spaced repetition software. One notable work in this regard is that of Novikoff et al. [16 ], who propose a theoretical framework for spaced repetition based on a set of deterministic operations on an infinite string of content pieces. They assume identical items and design schedules to implement deterministic spacing constraints, which are based on an intuitive understanding of the effect of mem-ory models on different learning objectives. The focus in [16 ] is on characterizing the combinatorial properties (e.g., maximum asymptotic throughput) of schedules that imple-ment various spacing constraints. Though our work shares the same spirit of formalizing the spaced repetition problem, we improve upon their work in three ways: (1) in terms of empirical verification, as our work leverages both software log data and large-scale experimentation to verify the mem-ory models we use, and test the predictions made by our mathematical models; (2) in computational terms, wherein, by using appropriate stochastic models and approximations, we formulate optimization problems that are much easier to solve; and (3) in terms of flexibility, as our model can more easily incorporate various parameters such as the user X  X  re-view frequency, non-identical item difficulties, and different memory models.
The key contributions of this paper fall into two cate-gories. First, the paper introduces a principled methodol-ogy for designing review scheduling systems with various learning objectives. Second, the models we develop provide qualitative insights and general principles for spaced repe-tition. The overall argument in this paper consists of the following three steps: 1. Mining large-scale log data to validate human memory models : First, we perform observational studies on data from Mnemosyne [ 2], a popular flashcard software tool, to compare different models of retention probability as a function of reinforcement and delay. Our results, pre-sented in Section 2, add to the existing literature on mem-ory models and provide the empirical foundation upon which we base our mathematical model of spaced repeti-tion. 2. Mathematical modeling of spaced repetition systems : Our main contribution lies in embedding the above memory model into a stochastic model for spaced repetition sys-tems, and using this model to optimize the review sched-ule. Our framework, which we refer to as the Leitner
Queue Network , is based on ideas from queueing theory and job scheduling. Though conceptually simple and easy to simulate, the Leitner Queue Network does not provide a tractable way to optimize the review schedule. To this end, we propose a (heuristic) approximate model, which in simulations is close to our original model for low ar-rival rates, and which leverages the theory of product-form networks [ 11 , 6] to greatly simplify the scheduling problem. This allows us to study several relevant ques-tions: the maximum rate of learning, the effect of item difficulties, and the effect of a learner X  X  review frequency on their overall rate of learning. We present our model, theory, and simulations in Section 3. 3. Verifying the mathematical model in controlled experi-ments : Finally, we use Amazon Mechanical Turk [1 ] to perform large-scale experiments to test our mathemati-cal models. In particular, we verify a critical qualitative prediction of our mathematical model: the existence of a phase transition in learning outcomes upon increasing the rate of introduction of new content beyond a maximum threshold. Our experimental results agree well with our model X  X  predictions, reaffirming the utility of our frame-work.

Our work provides the first mathematical model for spaced repetition systems which is empirically tested and admits a tractable optimization problem for review scheduling. It opens several directions for further research: developing bet-ter models for such systems, providing better analysis for the resulting models, and performing more empirical studies to understand these systems. We discuss some of these open questions in detail in Section 5. Our experimental platform can help serve as a testbed for future studies; to this end, we release all our data and software tools to facilitate repli-cation and follow-up studies (see Section 4).
To design a principled spaced repetition system, we must first understand how a user X  X  ability to recall an item is affected by various system parameters. One well-studied model of human memory from the psychology literature is the exponential forgetting curve , which claims that the prob-ability of recalling an item decays exponentially with the time elapsed since it was last reviewed, at a rate which de-creases with the  X  X trength X  of the item X  X  memory trace. In this section, we conduct an observational study on large-scale log data collected from the Mnemosyne [ 2] flashcard software to validate the exponential forgetting curve.
We adopt a variant of the standard exponential forget-ting curve model, where recall is binary (i.e., a user either completely recalls or forgets an item) and the probability of recalling an item has the following functional form: where  X   X  R + is the item difficulty, d  X  R + is the time elapsed since previous review, and s  X  R + is the memory strength. Our formulation is slightly different from that of Ebbinghaus [ 9], in that we have added an explicit item diffi-culty parameter  X  , which corresponds to the assumption that there is a constant, item-specific component of the memory decay rate.

To justify the use of this memory model in our schedul-ing algorithm, we first explore how different forms of the exponential forgetting curve model fit empirical data. In particular, we explore the use of a global item difficulty  X  vs. an item-specific difficulty  X  i , as well as several simple models of memory strength: a constant strength s = 1, a strength s = n ij equal to the number of repetitions of item i for user j (where n ij  X  1), and a strength s = q ij equal to the position of item i in the Leitner system for user j (where q ij  X  1).

We use large-scale log data collected from Mnemosyne [2 ], a popular flashcard software tool, to validate our assump-tions about the forgetting curve. After filtering out users and items with fewer than five interactions, we select a ran-dom subset of the data that contains 859 , 591 interactions, 2 , 742 users, and 88 , 892 items. Each interaction is anno-tated with a grade (on a 0-5 scale) that was self-reported by the user. Users are instructed by the Mnemosyne soft-ware to use a grade of 0 or 1 to indicate that they did not recall the item, and a grade of 2-5 to indicate that they did recall the item, with higher grades implying eas-ier recall. We discretize grades into binary outcomes, where recall , grade  X  2 and, and observe an overall recall rate of 0 . 56 in the data. Additionally, we scale the time intervals between reviews to days.

We compare the exponential forgetting curve from Eqn. 1 to three benchmark models: the zero-and one-parameter logistic item response theory models (henceforth, 0PL-IRT and 1PL-IRT) and logistic regression. The 0PL-IRT user model assumes the recall likelihood follows P [recall] =  X  (  X  for each user j observed in the training set (where  X  is the logistic link function); similarly, the 0PL-IRT item model assumes P [recall] =  X  (  X  i ) for each item i in the training set. The 1PL-IRT model [14 ], a mathematical formulation of the Rasch cognitive model [ 19], has the following recall likelihood: P [recall] =  X  (  X  j  X   X  i ) for user j and item i , where  X  is user proficiency and  X  is item difficulty. The logistic re-Figure 1: Schematic of the classification task used to evaluate memory models: Each square corresponds to a user-item interaction with a binary outcome. The gray squares are thrown out. This training-validation split occurs on each fold, with sets of full and truncated histories changing across folds. gression model uses the following statistics of the previous review intervals and outcomes to predict recall: mean, me-dian, min, max, range, length, first, and last.

Logistic regression and 1PL-IRT are trained using MAP estimation with an L2 penalty, where the regularization con-stant is selected to maximize log-likelihood on a validation set. All other models are trained using maximum-likelihood estimation (i.e., with an implicit uniform prior on model parameters). The hyperparameters in the IRT models are user abilities ~  X  and/or item difficulties ~  X  ; the hyperparam-eters in the exponential forgetting models are item-specific difficulties ~  X  or a global difficulty  X  . We use ten-fold cross-validation to evaluate the memory models on the task of pre-dicting held-out outcomes. Our performance metric is area under the ROC curve (AUC), which measures the discrimi-native ability of a binary classifier that assigns probabilities to class membership. 1 On each fold, we train on the full his-tories of 90% of user-item pairs and the truncated histories of 10% of user-item pairs, and validate on the interactions immediately following the truncated histories. Truncations are made uniformly at random  X  see Fig. 1 for an illustra-tion of this scheme. After using cross-validation to perform model selection, we evaluate the models on a held-out test set of truncated user-item histories (20% of the user-item pairs in the complete data set) that was not visible during the earlier model selection phase.

Table 2 summarizes all the models that were evaluated, with rows 1-4 representing the benchmarks and rows 5-14 variants of the exponential forgetting curve model. We com-pare models which use a global item-difficulty parameter  X  (rows 5-9) vs. item-specific difficulties  X  i (rows 10-14); more-over, we allow the memory strength to be constant (rows 6 and 11), proportional to the number of reviews n ij 5,7,10,12), or proportional to the position of the item in the Leitner system q ij (rows 8,9,13,14).

The predictive performance of the models on validation and test data is given in Fig. 2 and 3. We make four key
We use AUC as a metric instead of raw prediction accuracy because it is insensitive to class imbalance. 1  X  (  X  j ) 0PL-IRT user 2  X  (  X   X  i ) 0PL-IRT item 3  X  (  X  j  X   X  i ) 1PL-IRT 4  X  (  X   X  x ) Logistic regression 5 exp (  X   X   X  d ij /n ij ) Exponential forgetting curve 6 exp (  X   X   X  d ij ) 7 exp (  X   X /n ij ) 8 exp (  X   X   X  d ij /q ij ) 9 exp (  X   X /q ij ) 10 exp (  X   X  i  X  d ij /n ij ) 11 exp (  X   X  i  X  d ij ) 12 exp (  X   X  i /n ij ) 13 exp (  X   X  i  X  d ij /q ij ) 14 exp (  X   X  i /q ij ) Table 1: Summary of models used for prediction: In all cases, the subscripts refer to user j and item i . Rows 1-4 represent our benchmarks; here  X  is the logistic function, while in row 4, x refers to the fea-ture vector of review interval and outcome statistics described earlier in this section, and  X  is a vector of coefficients. In rows 5-14, d ij is the time elapsed since previous review of item i for user j , q ij denotes the position of item i in the Leitner system for user j and n ij is the number of past reviews of item i by user j .  X  represents a global item difficulty, while  X  i is an item-specific difficulty for item i . observations: 1. Positive impact of delay term : Incorporating a delay term improves the performance of the memory model. In Fig. 2, the solid lines (with delay term) and dashed lines (with-out delay term) of same color encode comparable models with and without the delay term (model 5 vs. 7, 8 vs. 9, 10 vs. 12, 13 vs. 14). 2. Use of item-specific difficulties : Item-specific difficulties  X  i outperform global item difficulty  X  for lower decks ( q ij  X  2) and higher decks ( q ij &gt; 5), but the global dif-ficulty performs better for intermediate decks (model 5 vs. 10, 8 vs. 13); in Fig. 2, compare the solid cool colors (models with  X  ) to solid warm colors (models with  X  i ). 3. Leitner position vs. number of reviews : Setting the mem-ory strength s to be equal to the Leitner deck position q ij performs better than setting it to be proportional to the number of past reviews n ij , which in turn is better than using a constant s ; see Fig. 3 (model 8 vs. 5-6, and 13 vs. 10-11). 4. Performance w.r.t. benchmark models : Exponential for-getting models that include the delay term (models 5, 8, 10, and 13) perform comparably to 1PL-IRT (model 3), which is the best-performing benchmark model; in Fig. 2, compare the solid black line (model 3) to the other solid lines (models 5, 8, 10, and 13).

Based on these observations, our model of the Leitner sys-tem uses the following exponential forgetting curve: Figure 2: To evaluate the memory models X  ability to predict outcomes in the Leitner system, validation AUC is computed for separate bins of data that con-trol for an item X  X  position q ij in the Leitner system. The error bars show the standard error of validation AUC across the ten folds of cross-validation. Each curve corresponds to a row in Table 2. We have in-cluded only the best-performing benchmark model, 1PL-IRT (model 3), to reduce clutter.
 Figure 3: To compare the three memory strength models s = n ij , s = 1 , and s = q ij , we compute AUCs for the full data set (instead of separate bins of data, as in Fig. 2). The box-plots show the spread of vali-dation AUC across the ten folds of cross-validation, and the orange circles show AUC on the test set. where for item i , d i is the time since last reviewed, q current deck in the Leitner system, and  X  is the global diffi-culty. The choice of the former two parameters follows from observations 3 and 4. The choice between using  X  i or  X  is less clear from the data, and we settle on the latter due to considerations of practicality (  X  i may be unknown and/or difficult to estimate) and mathematical tractability. We dis-cuss extensions of our model to using  X  i in later sections.
Based on the memory model developed in the previous section (as summarized in Eqn. 2), we now present a stochas-tic model for a spaced repetition system, and outline how we can use it to design good review scheduling policies. We note again that all existing schemes for assigning review fre-quencies to decks in the Leitner system, and in fact, in all other spaced repetition systems, are based on heuristics with no formal optimality guarantees. One of our main contri-butions is to provide a principled method for determining appropriate schedules for spaced repetition systems.
We focus on a regime where the learner wants to memorize a very large set of items  X  in particular, the number of avail-able items is much larger than the potential amount of time spent by the learner in memorizing them. A canonical exam-ple of such a setting is learning words in a foreign language. From a technical point of view, this translates to assuming that new items are always available for introduction into the system, similar to an open queueing system (i.e., one with a potentially infinite stream of arrivals). Moreover, this al-lows us to use the steady-state performance of the queue as a measure of performance of the scheduler as an appropri-ate metric in this setting. We refer to this as the long-term learning regime.

As mentioned before, our model is based on the Leitner system [ 13 ], one of the simplest and oldest spaced repetition systems. It comprises of a series of n decks of flashcards, indexed as { 1 , 2 ,...,n } , where new items enter the system at deck 1, and items upon being reviewed either move up a deck if recalled correctly or down if forgotten. In prin-ciple, the deck numbers can extend in both directions; in practice however, they are bounded both below and above  X  we follow this convention and assume that items in deck 1 are reflected (i.e., they remain in deck 1 if they are incor-rectly reviewed), and all items which are recalled at deck n (which in experiments we take as n = 5), are declared to be  X  X astered X  and removed from the system. For simplicity of exposition, we also assume that the difficulty parameter  X  is the same for all items (i.e., model 8 in Table 2), but we will discuss later how to allow for item-specific difficulties (i.e., model 13 in Table 2).
We model the dynamics of flashcards in an n -deck Leitner system using a network of n queues, as depicted in Fig. 4. Formally, at time t , we associate with each deck k the vector S ( t ) = ( Q k ( t ) , { T k, 1 ( t ) ,T k, 2 ( t ) ,...,T the number of items in the deck at time t , and T k,j &lt; t is the time at which the j th item in deck k first entered the system (note that the times are sorted). A new item is introduced into the system at a time determined by the scheduler  X  it is first shown to the user (who we assume has not seen it before), and then inserted into deck 1.

We assume that the learner has a review frequency budget (e.g., the maximum rate at which the user can review items) of U , which is to be divided between reviewing the decks as well as viewing new items. Formally, we assume that review instances are created following a Poisson process at rate U . Our aim is to design a scheduler which at each review instant chooses an item to review. When a deck is chosen for review, we assume that items are chosen from it following a FIFO Figure 4: The Leitner Queue Network: Each queue represents a deck in the Leitner system. New items enter the network at deck 1. Green arrows indicate transitions that occur when an item is correctly re-called during review, and red arrows indicate tran-sitions for incorrectly recalled items. Queue k is served (i.e., chosen for review) at a rate  X  k , and se-lects items for review in a FIFO manner. discipline. When an item comes up for review, its transition to the next state depends on the recall probability, which depends on the deck number and delay (i.e., time elapsed since the last review of that item). In particular, at time t , for any deck k , let D k = t  X  T k, 1 denote the delay (i.e., the time elapsed since that item was last reviewed) of the head-of-the-line (HOL) item in deck k . Then, using the memory model from Eqn. 2, we have that upon reviewing the HOL item from deck k (for k  X  X  1 , 2 , 3 ,...,n  X  1 } ), its transition follows: Note that items in deck 1 return to the same deck upon incorrect recall. Finally, items coming up for review from deck n exit the system with probability exp (  X   X   X  D n /n ) (i.e., upon correct recall), else transition to deck n  X  1. We define the learning rate  X  out to be the long-term rate of mastered items exiting from deck n , i.e.: The aim of a scheduling policy is to maximize  X  out .
Given any scheduling policy that depends only on the that S ( t ) forms a Markov chain. The most general scheduler-design problem is to choose a dynamic state-dependent sched-ule , wherein review instances are created following a Poisson process at rate U , and at each review instant, the scheduler defines a map from the state S ( t ) to a control decision which involves choosing either to introduce a new card, or a deck from which to review an item. Analyzing such a dynamic schedule is difficult as the state space of the system is very high dimensional (in fact, it is infinite dimensional unless we impose some restriction on the maximum queue size). How-ever, we can simplify this by restricting ourselves to static scheduling policies : we assume that new items are injected into deck 1 following a Poisson process with rate  X  ext (hence-forth referred to as the arrival rate ), and for each deck k , we choose a service rate  X  k , which represents the rate at which items from that deck come up for review. We need to enforce that the arrival rate  X  ext and deck service rates to-gether satisfy the user X  X  review frequency budget constraint, i.e.,  X  ext + P k  X  k  X  U 2 .

Restricting to static schedulers greatly reduces the prob-lem dimensionality  X  the aim now is to choose  X  ext , {  X  so as to maximize the learning rate  X  out . We henceforth re-fer to this system as the Leitner Queue Network . The use of such static policies is a common practice in stochastic control literature, and moreover, such schedules are com-monly used in designing real Leitner systems (although the review rates are chosen in a heuristic manner). However, although the above model is potentially amenable to simu-lation optimization techniques, a hurdle in obtaining a more quantitative understanding is that the Markov chain over S ( t ) is time-inhomogeneous , as the transition probabilities change with t . In the next section, we propose a heuristic approximation that lets us obtain a tractable program for optimizing the review schedule.
The stochastic model in Section 3.1 captures all the im-portant details of the Leitner system  X  however, its time-inhomogenous nature means that it does not admit a closed-form program for optimizing the review schedule. In this section, we propose an approximation technique for the Leit-ner Queue Network, under which the problem of choosing an optimal review schedule reduces to a low-dimensional deter-ministic optimization problem . Simulation results in Section 3.3 (see Fig. 6) suggest that the two models match closely for small arrival rates. We note however that this approxi-mation is essentially a heuristic, and obtaining more rigor-ous approximations for the proposed Leitner Queue Network model is an important topic for future work.

The main idea behind converting the model in Section 3.1 to a time-homogeneous model is that for small values of  X  , for which the system appears stable (i.e., the total number of packets in the system does not blow up), then each Leitner deck k behaves similarly to an M/M/ 1 queue with service rate  X  k (chosen by the scheduler), and some appropriate input rate  X  k . Recall that for an M/M/ 1 queue with input rate  X  and service rate  X  , the total sojourn time for any packet is distributed as Exponential (  X   X   X  ) (see [11 ]). Based on this, we assume that for an item from deck k coming under review, the recall likelihood is given by : The above expression follows from the moment generating function of the exponential distribution. We henceforth refer to this as the mean-recall approximation .

Formally, we define the mean-recall approximation as fol-lows: Suppose we choose a static schedule  X  ext , {  X  (with  X  ext &lt;  X  1 ), and in addition choose input rates  X  at each deck. Moreover, suppose the probability P k that an item from deck k is recalled correctly upon review is given by Eqn. 3 3 . Finally, we assume the arrival rates {  X  k } satisfy
In practice, this corresponds to the following: for each re-view instance, with probability  X  k  X  oldest item in deck k ; else, we introduce a new item.
One way to view this is that for each item in deck k coming up for review, we ignore the true delay D k and independently the following flow-balance equations :  X  1 =  X  ext + (1  X  P 1 )  X  1 + (1  X  P 2 )  X  2  X   X 
Under the above assumptions, the Leitner Queue Network is a Jackson network of M/M/ 1 queues Q k [11, 12 ], with arrival rate  X  k and service times {  X  k } , and from Jackson X  X  theorem, we have that all queues are ergodic, and in steady-state, for each deck k , the sojourn time D k is indeed dis-tributed as Exponential (  X  k  X   X  k ). Moreover, ergodicity also gives that the learning rate  X  out is the same as the external injection rate  X  ext . Putting everything together, we get the following static planning problem : Maximize Subject to U  X   X  ext + Thus, as desired, the mean-recall approximation helps con-vert the stochastic control problem of designing an opti-mal review schedule to a low ( O ( n )) dimensional, deter-ministic optimization problem. Now, we can use a nonlin-ear solver (e.g., IP-OPT) to solve the static planning prob-lem. Note that our problem is unusual compared to typ-ical network control problems, as the routing probabilities depend on the service rates  X  k . Also, note that ergodic-ity of the system is critically dependent on the conditions  X  k &lt;  X  k ,  X  k  X  { 1 , 2 ,...,n }  X  if, however, one or more of these do not hold, then the resulting queue length(s) (i.e., deck sizes), and thus, the delays between reviews for items in that deck, grow unbounded for the decks for which the condition is violated. Moreover, since items move to lower decks upon being incorrectly recalled, choosing a high in-jection rate should result in items building up in the lowest deck. We verify these qualitative observations through ex-periments in Section 4.
We now explore the properties of the optimal review sched-ule for the Leitner Queue Network under the mean-recall approximation. The main qualitative prediction from our model is the existence of a phase transition in learning out-comes: Given a schedule {  X  k } , there is a threshold  X  for all  X  ext &gt;  X  t , there are no feasible solutions {  X  isfying Eqn. 4. Moreover, if  X  ext &gt;  X  t , then the lowest Leitner deck (i.e., Q 1 ) experiences packet accumulation and delay blow-up, and thus the learning rate  X  out goes to 0. In Fig. 5, we simulate a review session with 500 reviews and 50 unique items for different values of  X  ext . We observe that a sharp phase transition indeed occurs as the arrival rate is in-generate b D k  X  Exponential (  X  k  X   X  k ), which is then used to determine the recall probability P k . Figure 5: Phase transition in learning: Average learning rate  X  out vs. arrival rate  X  ext in the Leit-ner Queue Network with clocked delays, for a ses-sion of 500 reviews over 50 items. We set number of decks n = 5 , review frequency budget U = 0 . 1902 , and global item difficulty  X  = 0 . 0077 . The dashed verti-cal line is the predicted phase transition threshold under the mean-recall approximation. creased: throughput initially increases linearly with arrival rate, then sharply decreases.

The simulation in Fig. 5 is for the Leitner Queue Network with actual (or clocked ) delays, i.e., item routing is based on actual times between reviews. The dotted line indicates the phase transition threshold obtained under our mean-recall approximation (Eqn. 4), which appears to be a lower bound (i.e., a conservative estimate) for the true phase transition point for review sessions of moderate length. Fig. 6 verifies our intuition that the mean-recall approximation performs well for small values of  X  ext . Obtaining more rigorous guar-antees on the approximation remains an open question.
The above simulations suggest that the mean-recall ap-proximation gives a good heuristic for optimizing the learn-ing rate. Moreover, the tractability of the resulting opti-mization program (Eqn. 4) lets us investigate structural aspects of the optimal schedule under the mean-recall as-sumption. In Fig. 7, we see that the optimal schedule spends more time on lower decks than on higher decks (i.e.,  X  k  X   X  k +1  X  k ). This is partly a result of the network topol-ogy, where items enter the system through deck 1 and exit the system through deck n . However, in Fig. 8 we ob-serve that the Leitner Queue Network also increases the ex-pected delay between subsequent reviews as an item moves up through the system. Note that longer review intervals does not follow from decreasing  X  k , as the (steady-state) deck sizes can be different, as is indeed the case (see Fig. 9). We note here that there is empirical support in the literature for expanding intervals between repetitions [5 ].

Finally, Fig. 10 and 11 show how the maximum achievable learning rate depends on the general difficulty of items, and the user X  X  review frequency budget U . The convexity of the latter plot is encouraging, as it suggests that there are increasing returns (for lower U ) as the user increases their budget.
The assumption that all items have the same difficulty  X  Figure 6: The mean-recall approximation: Average learning rate  X  out vs. arrival rate  X  ext , for 500 re-views over 50 items. We set number of decks n = 5 , review frequency budget U = 0 . 1902 , and global item difficulty  X  = 0 . 0077 . The green curve is generated using clocked delays, while the blue curve uses the mean-recall approximation. The  X  out =  X  ext line (red dashed curve) is the steady-state  X  out under the mean-recall approximation. can be relaxed by discretizing difficulties into a fixed num-ber of bins b , and creating b parallel copies of the network. We now have b parallel Leitner Queue Networks, coupled via the budget constraint which applies to the sum of ser-vice rates across the networks for each  X  . We can assume that the  X  i are known a priori (e.g., from log data or expert annotations). To understand the effect of different  X  compare the optimal schedule for different  X  i (but using the same budget U ) in Fig. 12. The result is interesting, because to the best of our knowledge, there is little understanding of how the user should adjust deck review frequencies when the general difficulty of items changes. Fig. 12 suggests that when items are generally easy, the user should spend a roughly uniform amount of time on each deck; however, when items are of higher general difficulty, the user should spend more time on lower decks than higher decks.
To empirically test the fidelity of the Leitner Queue Net-work as a model for spaced repetition, we perform an exper-iment on Amazon Mechanical Turk (MTurk) involving par-ticipants memorizing words from a foreign language. Our study is designed to experimentally verify the existence of the phase transition (shown in Fig. 5), the primary qualita-tive prediction made by our model.
A total of 331 users ( X  X urkers X ) on the MTurk platform were solicited to participate in a vocabulary learning task. At the beginning of the task, vocabulary used in the task was selected randomly from one of two categories: Japanese (words) and American Sign Language (animated gestures). Items for the experiment were sampled from the list of com-mon words in both languages 4 . Each task was timed to last https://en.wiktionary.org/wiki/Appendix:1000 Japanese basic words for Japanese and http://www.lifeprint.com/ Figure 7: Optimal review schedule {  X  k } k for n = 20 , U = 1 ,  X  = 0 . 01 Figure 8: Expected delays 1 / (  X  k  X   X  k ) under optimal schedule for n = 20 , U = 1 ,  X  = 0 . 01 . Figure 9: Expected queue size  X  k / (  X  k  X   X  k ) under optimal schedule for n = 20 , U = 1 ,  X  = 0 . 01 . The kinks at the boundaries, in this and the previous plot, arise from having a bounded number of decks. Figure 10: Variation in maximum learning rate  X   X  ext with item difficulty  X  , for n = 20 ,U = 1 . Figure 11: Variation in learning rate  X   X  ext with re-view frequency budget U for n = 5 , X  = 0 . 01 . Note the convexity (hence, increasing returns) for low U . Figure 12: Optimal review schedule {  X  k } k for n = 20 , U = 1 and varying item difficulties  X  . Figure 13: Screenshot of our Mechanical Turk inter-face : The user sees a word in Japanese (not shown) and enters a guess. The card is then flipped to re-veal the word X  X  meaning in English (shown above), and the user then assesses herself. 15 minutes, and turkers were compensated $1.00 for com-pleting the task regardless of their performance. The task used the interface depicted in Fig. 13 : a flashcard initially displaying the item in the foreign language (either word or gesture), and a pair of YES/NO buttons to collect input from the user in response to the question,  X  X o you know this word? X  . If the user selected YES , she was then asked to type the translation of the word in English. Once the word was entered, the flashcard was  X  X lipped X , revealing the correct English word. The user was then asked to self-assess their correctness on a scale of 1 (completely wrong) to 4 (perfect). Following the submission of the rating, the next card was sampled from the deck. In all our experiments, we consider a self-assessment score of 3 (almost perfect) or 4 (perfect) as a  X  X ass X , and all other scores as a  X  X ail X .
At the beginning of each task, each turker was assigned to one of the 11 conditions corresponding to the arrival rate (  X  ext ) of new items: [0.002, 0.004, 0.010, 0.015, 0.020, 0.023, 0.029, 0.050, 0.076, 0.095, 0.11, 0.19] (items per second). The resulting data set consists of a total of 77 , 034 logs, 331 unique users, 446 unique items, an overall recall rate of 0 . 663, a fixed session duration of 15 minutes, and an average session length of 171 logs, where each log is a tuple (turk-erID, itemID, score, timestamp). We set deck review rates to  X  k  X  1 / mal allocation in Fig. 7. We note that choosing an optimal scheduler is not essential for our purpose of observing the phase transition  X  moreover, we cannot optimize the review rates  X  k ex ante as we do not know the item difficulty  X  or the review budget U . During the experiments, we set the number of decks in the system to n =  X  , so items never exit the system during a review session. Items incorrectly recalled at deck 1 are  X  X eflected X  and stay in deck 1. In our post-hoc analysis of the data, we consider an item to be  X  X astered X  if its final position is in deck 6 or greater.
We estimate the empirical review budget U as (average number of logs in a session) / (session duration), and the empirical item difficulty  X  using maximum-likelihood esti-mation. We measure throughput  X  out as (average number of items mastered in a session) / (session duration). asl101/gifs-animated/ for American Sign Language Figure 14: The exit rate  X  out vs. arrival rate  X  ext , where number of decks n = 5 , review frequency bud-get U = 0 . 1902 , and global item difficulty  X  = 0 . 0077 . Figure 15: The number of items that finish in each deck vs. arrival rate  X  ext , where number of decks n = 5 , review frequency budget U = 0 . 1902 , and global item difficulty  X  = 0 . 0077 . Figure 16: The fraction of items seen during a ses-sion that finish in each deck for different arrival rates  X  ext , where number of decks n = 5 , review fre-quency budget U = 0 . 1902 , and global item difficulty  X  = 0 . 0077 . Deck 6 refers to the pile of mastered items. Fig. 14 overlays the empirical learning rate from the MTurk data for each arrival rate condition on the learning rate curve for the simulated Leitner Queue Network (same as Fig. 5) using the parameter values for  X  and U measured from the MTurk data (see caption of Fig. 5 for details). The simulated and empirical curves are in close agreement; in particular, the MTurk data shows the phase transition in learning rate predicted by our theoretical model.

In addition to computing the observed throughput for the various arrival rates in the MTurk data, we compute the av-erage distribution of items across the five decks and the pile of mastered items at the end of a session. This gives insight into where items accumulate in unstable regimes. Fig. 15 illustrates the same phase transition observed earlier: as the arrival rate increases, we first see an increase in the number of mastered items. However, as the arrival rate increases past the optimum, relatively fewer items are mastered and relatively more items get  X  X tuck X  in deck 1. Intuitively, the user gets overwhelmed by incoming items so that fewer and fewer items get reviewed often enough to achieve mastery. Fig. 15 and 16 match the behavior suggested by our queue-ing model: for injection rates higher than the threshold, the number of items in deck 1 blows up while the other decks remain stable.
Our work develops the first formal mathematical model for reasoning about spaced repetition systems that is validated by empirical data and provides a principled, computation-ally tractable algorithm for flashcard review scheduling. Our formalization of the Leitner system suggests the maximum speed of learning as a natural design metric for spaced rep-etition software; using techniques from queueing theory, we derive a tractable program for calibrating the Leitner system to optimize the speed of learning. Our queueing framework opens doors to leveraging an extensive body of work in this area to develop more sophisticated extensions. To inspire and facilitate future work in this direction, we release (1) all model and evaluation code, (2) framework code for carrying out user studies, and (3) the data collected in our Mechanical Turk study. The data and code for replicating our experi-ments are available online at http://siddharth.io/leitnerq . Our work suggests several directions for further research. The primary follow-up is to obtain a better understanding of the Leitner Queue Network; in particular, better approx-imations with rigorous performance guarantees. Doing so will allow us to design better control policies, which ideally could maximize the learning rate in the transient regime. The latter is critical for designing policies for cramming [16 ], a complementary problem to long-term learning where the number of items to be learnt is of the same order as the number of reviews. Next, our queueing model should be modified to incorporate more sophisticated memory models that more accurately predict the effect of a particular re-view schedule on retention. Finally, there is a need for more extensive experimentation to understand how closely these models of spaced repetition apply to real-world settings.
We thank Peter Bienstman and the Mnemosyne project for making their data set publicly available. This research was funded in part through NSF Awards IIS-1247637, IIS-1217686, IIS-1513692, the Cornell Presidential Research Schol-ars Program, and a grant from the John Templeton Foun-dation provided through the Metaknowledge Network. [1] Amazon mechanical turk. https://www.mturk.com , [2] The mnemosyne project. http://mnemosyne-proj.org , [3] Duolingo. https://www.duolingo.com, 2011. [4] Spaced repetition. [5] N. J. Cepeda, H. Pashler, E. Vul, J. T. Wixted, and [6] X. Chao, M. Pinedo, and M. Miyazawa. Queueing [7] A. T. Corbett and J. R. Anderson. Knowledge tracing: [8] F. N. Dempster. Spacing effects and their implications [9] H. Ebbinghaus. Memory: A contribution to [10] D. Elmes. Anki. http://ankisrs.net , 2015. [11] F. P. Kelly. Reversibility and stochastic networks . [12] D. G. Kendall. Stochastic processes occurring in the [13] S. Leitner. So lernt man lernen . Herder, 1974. [14] W. Linden and R. K. Hambleton. Handbook of [15] R. V. Lindsey, J. D. Shroyer, H. Pashler, and M. C. [16] T. P. Novikoff, J. M. Kleinberg, and S. H. Strogatz. [17] H. Pashler, N. Cepeda, R. V. Lindsey, E. Vul, and [18] P. Pimsleur. A memory schedule. Modern Language [19] G. Rasch. Probabilistic models for some intelligence [20] P. Wozniak and E. J. Gorzelanczyk. Optimization of
