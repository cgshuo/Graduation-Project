 Principal component analysis (PCA) has been extensively applied in data mining, pattern recognition and information retrieval for unsupervised dimensionality reduction. When labels of data are available, e.g., in a classification or regres-sion task, PCA is however not able to use this information. The problem is more interesting if only part of the input data are labeled, i.e., in a semi-supervised setting. In this paper we propose a supervised PCA model called SPPCA and a semi-supervised PCA model called S 2 PPCA, both of which are extensions of a probabilistic PCA model. The pro-posed models are able to incorporate the label information into the projection phase, and can naturally handle multi-ple outputs (i.e., in multi-task learning problems). We de-rive an efficient EM learning algorithm for both models, and also provide theoretical justifications of the model behaviors. SPPCA and S 2 PPCA are compared with other supervised projection methods on various learning tasks, and show not only promising performance but also good scalability. H.3 [ Information Storage and Retrieval ]: Content Anal-ysis and Indexing X  Indexing methods Algorithms, Theory, Measurement, Performance Dimensionality reduction, Principal component analysis, Su-pervised projection, Semi-supervised projection
Data mining problems often suffer from the high dimen-sionality of the data, for the reason of learnability or com-putational efficiency. Therefore dimensionality reduction, Copyright 2006 ACM 1-59593-339-5/06/0008 ... $ 5.00. which is also called feature transformation or document in-dexing , is of great importance and has been extensively stud-ied (see, e.g., [8, 2]). The most popular method is probably the principal component analysis (PCA), which performs a singular value decomposition (SVD) to the data matrix and obtains the sub-eigenspace with large singular values [10].
Traditional dimensionality reduction methods are unsu-pervised , i.e., they only focus on observations or input data. However, in discriminant analysis where the prediction value or output is available, it would be more helpful to incor-porate this information into the mapping and derive a su-pervised projection for input data. Since this projection is designed for the specific prediction problem, it could be sub-stantially different from unsupervised projection. A more in-teresting setting is semi-supervised projection wherewehave only part of input data labeled, along with a large number of unlabeled data. This is often true in real world prob-lems because labeling is expensive, or unlabeled data are very easy to obtain. An ideal projection method should be able to take into account both the observed labeling infor-mation and the unlabeled inputs. There exist many super-vised projection algorithms in the literature such as linear discriminative analysis (LDA), partial least squares (PLS) and many others (see, e.g., [8] for an overview). However, these methods cannot incorporate the unlabeled data into the mapping, which will cause problems when we have only very few labeled points.
 In this paper we propose a supervised PCA model called SPPCA, which extends the probabilistic PCA model [17] to incorporate label information into the projection. SPPCA takes into account not only the inter-covariance between inputs and outputs, but also the intra-covariance of both. More interestingly, the model can be further extended to model unlabeled data as well, which we call semi-supervised PCA or S 2 PPCA. This model allows us to elegantly use all the available information to define the mapping. We derive an efficient EM learning algorithm for both models, and pro-vide some theoretical justifications for the model behavior. Experimental results on various learning tasks show promis-ing performance for both SPPCA and S 2 PPCA models.
This paper is organized as follows. After reviewing pre-vious work in Section 2, we formally introduce SPPCA and S
PPCA models in Section 3 and derive an EM learning algorithm in Section 4. We then presents some theoretical justifications in Section 5 with further discussions. Finally Section 6 illustrates experimental results and Section 7 con-cludes the paper.

In this section we review some previous work on unsu-pervised and supervised projections. In what follows we consider a set of N objects (e.g., images), and each object n is described by an M -dimensional feature vector x n  X  X X  R M . For dimensionality reduction we aim to derive a mapping  X  : X  X  X  which maps the input features into a K -dimensional space ( K&lt;M ).
Probably the most popular unsupervised projection is prin-cipal component analysis (PCA). Let X =[ x 1 ,..., x N ] denote the input matrix after centralization, i.e., we sub-tract the sample mean from each input. In PCA we want to find the principal components which illustrate the direc-tions with maximal variances of the data. Let X = VDU be the singular value decomposition (SVD) of X , where V and U are N  X  N and M  X  M column orthogonal matrices, respectively, and D is N  X  M diagonal matrix with singular values sorted in descending order along the diagonal. Then it is known that the first K columns of U , which we denote U
K , defines the mapping  X . The projections of X onto the principal component space are given as V K D K , where V K contains the first K columns of V , and D K is the top left K  X  K sub matrix of D .

Unlike PCA which is maximizing the global covariance of the data, there also exist  X  X ocal X  projection algorithms such as locally linear embedding [15], which tries to preserve the local structure of the data after projecting into a low dimensional space.
When each data point n is associated with not only low level features x n but also some outputs y n  X  X  X  R L (i.e., classification or regression targets), unsupervised pro-jection such as PCA may be not able to project the data into useful directions (see Figure 2). Therefore many supervised projection methods are introduced to make use of the output information. Linear discriminant analysis (LDA) focuses on multi-class classification and finds projection directions that separate the data best (see [4]). The number of projection dimensions is however limited by L  X  1. Partial least squares (PLS) [18] originates from regression analysis and finds the directions of maximal covariance between inputs and out-puts sequentially. It however ignores the intra covariance of either inputs or outputs, and its generalization performance on new dimensions of outputs is restricted (see discussions in [6]). Other related works include [9, 12, 7, 1, 19, 20] which consider this problem from different perspectives.
In the situations where we have few labeled points and a large amount of unlabeled data, all these supervised pro-jection methods are however not able to use the unlabeled data. This is often the case in computer vision, information retrieval and bioinformatics, where labeling is expensive and unlabeled data are sufficient and cheap to obtain. We call this setting the semi-supervised projection , and in the next section we will propose a model which can deal with semi-supervised projection naturally. In this section we first review a probabilistic model for PCA in Section 3.1, and then present our supervised models.
While PCA originates from the analysis of data variances, in statistics community there exists a probabilistic explana-tion for PCA, which is called probabilistic PCA or PPCA in the literature [17, 14]. PPCA is a latent variable model and defines a generative process for each object x as (see Figure 1(a) for an illustration) where z  X  R K are called the latent variables , and W x is a M  X  K matrix called factor loadings . In this probabilis-tic model, latent variables z are conventionally assumed as a Gaussian distribution with zero mean and unit variance, i.e., z  X  X  ( 0 , I ), and x defines a noise process which also takes an isotropic Gaussian form as x  X  X  ( 0 , X  2 x I ), with  X  the noise level . Additionally, we have parameters  X  x  X  R M which allow non-zero means for the data.
 It is shown that PPCA has strong connections to PCA. In particular when  X  2 x  X  0, the projections of data x onto the K -dimensional principal subspace in PCA are identical to the latent variables z up to a rotation and scaling fac-tor [17]. We summarize the related results in the following proposition without proof, since this is simply a corollary of Theorem 2 in Section 5.

Proposition 1. Let S x = 1 N N n =1 ( x n  X   X  x )( x n  X   X  be the sample covariance matrix for data { x n } N n =1 ,and  X  ...  X   X  M be its eigenvalues with eigenvectors u 1 ,..., u then if the latent space in PPCA model is K -dimensional, (i) The maximum likelihood estimate of W x is given as (ii) The mean projections z  X  for new input x  X  is given as
As a probabilistic framework, PPCA provides additional benefits over PCA such as a fast EM learning procedure, a principled way of handling missing entries, and a possibil-ity of considering mixture of PCA models. PPCA is also closely related to factor analysis models, but the modeling perspectives are different (see [17] for more discussions).
The key point of PPCA model is that all the M dimen-sions of x are conditionally independent given the latent vari-ables z , due to the isotropic property of the noise process. This indicates that the principal components in PPCA are the K latent variables which best explain the data covariance .
When supervised information is available, each object x is associated with an output value y  X  X  ,e.g., y  X  R for regres-sion task and y  X  X  +1 ,  X  1 } for classification task. In general we believe there are covariances between input space X and output space Y (since otherwise the supervised learning task is not learnable), and it is reasonable to extend PPCA to model this covariance as well. Furthermore, when there are more than one learning tasks (i.e., in a multi-task learning setting [5]), the covariances between different tasks can also be modeled by latent variables.
 Figure 1: Illustrations of the three models PPCA, SPPCA and S input and output matrices, where each row is one data point. f f ,...,f L y are the L outputs. On the top f 1 z ,...,f K z
We now formally describe our proposed model family which we call the supervised probabilistic principal component anal-ysis (SPPCA). Let the number of outputs be L , and each ob-ject x be associated with an output vector y =[ y 1 ,...,y Y X  R L . In SPPCA the observed data ( x , y ) is generated from a latent variable model as ues of L deterministic functions f 1 ,...,f L with parameters  X  = {  X  1 ,..., X  L } . Here z  X  X  ( 0 , I ) are the latent variables shared by both inputs x and outputs y , and the two noise models are independent to each other and both defined as isotropic Gaussians: x  X  X  ( 0 , X  2 x I ) , y  X  X  ( 0 , X  2 y use two noise levels  X  2 x and  X  2 y for inputs and outputs, re-spectively, and it is also straightforward to define different noise levels for different outputs if desired. See Figure 1(b) for an illustration of the model.

In SPPCA model we keep the nice property of condi-tional independence , i.e., all the input and output dimen-sions are conditionally independent to each other given the latent variables. If we integrate out the latent variables z , the likelihood of observation ( x , y ) is obtained as
P ( x , y )= P ( x , y | z ) P ( z ) d z = P ( x | z ) P ( y where z  X  X  ( 0 , I ), and from the latent variable model, x | z  X  X  ( W x z +  X  x , X  2 x I ) , y | z  X  X  ( f ( z ,  X  ) , X  After observing N pairs, the likelihood of all the observa-P (
In the following we consider the simplest model in this family, i.e., we assume each function f , =1 ,...,L ,is linear in z : where the parameters  X  = { w y , X  y } include the linear co-efficients and intercept. Then we can group all the f  X  X  and write a similar form as the generative model for x where W y = [ w y ,..., w L y ] and  X  y =[  X  1 y ,..., X  L y ] . The reason why we choose this form for f is that the EM learning is simple (see the next section), and we have closed form solution (see Section 5). We will discuss other forms of f in Section 5.3 which may need special approximation techniques.
 Let us denote W = W x then based on the model assumption, it is easily seen that ( x , y ) are jointly Gaussian distributed, with mean  X  and covariance  X  + WW . All the parameters for the SPPCA model are  X  := { W x , W y ,  X  x ,  X  y , X  2 x , X  2 y } .
In SPPCA model, we assume we observe both the in-puts x and outputs y for every data point. In many real world problems, however, we may only observe the outputs for a small portion of data, and have many unlabeled data in which only inputs x are known. This may be because some measurements are unobservable, the labeling cost is too high, or simply we have a large amount of unlabeled data available. Learning in this situation is in general called semi-supervised learning . For learning a projection, an ideal model would incorporate both the unlabeled inputs and the partially labeled outputs to define the mapping.

This can be easily done under the SPPCA framework. Let the number of labeled and unlabeled data points be N 1 and N , respectively, with N = N 1 + N 2 . The whole observation is now D = D 1 D 2 = { ( x n , y n ) } N 1 n =1 { x n } N likelihood, with the independence assumption of all the data points, is calculated as P ( D )= P ( D 1 ) P ( D 2 )= Figure 2: Projection directions for a toy data. They are fully labeled on the left, and only partially la-beled on the right. where P ( x n , y n ) is calculated as in SPPCA model, and P ( x n )= P ( x n | z n ) P ( z n ) d z n . Due to its applicabil-ity to semi-supervised projection, we call it semi-supervised PPCA or S 2 PPCA in this paper. Figure 1(c) illustrates this model.

Under the additional assumptions that all the f  X  X  are linear, it can be easily checked that all the likelihood terms in this product are Gaussians. This makes the model easy to learn. Other forms of f will be discussed in Section 5.3.
When N 2 =0,S 2 PPCA degrades to SPPCA which is purely supervised. This means one can view SPPCA as a special case of S 2 PPCA model with no unlabeled data. From the perspective of probabilistic modeling, S 2 PPCA can also be viewed as an SPPCA model where all the y  X  X  for the N 2 unlabeled points are missing. Due to this close relationship, in the following we use SPPCA to denote both models unless clearly specified.
Analogous to the PPCA model, in SPPCA models the projection of data point x is directly given in the latent variables z . If we know all the parameters  X  , calculating this projection is simply an inference problem. To do this we can apply Bayes X  rule and calculate the a posteriori distribution of z . Therefore we can obtain not only the mean projection vector, but also the uncertainty of the projection.
When both inputs x and outputs y are observed, we can calculate the a posteriori distribution of z given ( x , y )as Since all the three terms on the right hand side are Gaus-sians, this distribution is also a Gaussian N (  X  z ,  X  z  X  where A is a K  X  K matrix defined as This means that the projection is  X  z with uncertainty  X  z
For a test data x  X  that has no output information, what are the most likely latent variables z  X  ? This can also be done using Bayes X  rule This turns out again to be a Gaussian N (  X  z | x ,  X  z | x This result looks similar as that in PPCA model, but the projection is now supervised because the learning of W x is influenced by those observed outputs. This is clarified in the next section and will be theoretically justified in Section 5.
Learning in probabilistic models reduces to maximizing the data (log) likelihood with respect to all the model pa-rameters. In case of SPPCA model, the log likelihood of the whole observation D is For SPPCA analytical solution exists, and we summarize it later in Theorem 2. For S 2 PPCA model, however, there is no analytical solution since all the outputs for the unla-beled data are missing. Fortunately we can derive an EM algorithm [3] which is applicable to both models.
The EM algorithm iterates the two steps expectation (E-step) and maximization (M-step) until convergence, and it is guaranteed to find a local minima of the data likelihood. In the E-step, we fix the model parameters (  X  for SPPCA models) and calculate the expected distributions of latent variables (all the z n  X  X  for SPPCA models), and in the M-step we fix this distribution and maximize the complete data likelihood with respect to the model parameters. As will be discussed later, EM learning for SPPCA models is important because it can deal with very large data sets, and it has, in particular for SPPCA model with no unlabeled points, no local minima problem up to a rotation factor (see Section 5). For simplicity we only outline the update equations in the following and omit details (see [17] for a similar derivation).
We first consider the SPPCA model without unlabeled data. In the E-step, for each data point n we estimate the distribution of z n given observation ( x n , y n ). This is done using (2), and we calculate the sufficient statistics as where  X  denotes the expectation with respect to the pos-terior distribution P ( z n | x n , y n ) given in (2).
In the M-step, we maximize the complete log-likelihood  X  L = with respect to the model parameters, holding P ( z n | x fixed from the E-step. This can be done by setting the partial derivatives with respect to each parameter to be zero. Algorithm 1 Learning in SPPCA Model -Primal Form Require: N data points { ( x n , y n ) } N n =1 with inputs x 1: Calculate the sample means (7) and center the data via 2: Initialize model parameters  X  randomly. 3: repeat 4: { E-step } 5: for n =1to N do 6: Calculate sufficient statistics (5) and (6); 7: end for 8: { M-step } 9: Update W x and W y via (8); 10: Update  X  2 x and  X  2 y via (9) and (10); 11: until the change of  X  is smaller than a threshold. Output: Parameters  X  and projection vectors { z n } N n =1 For means of x and y we have which are just the sample means. Since they are always the same in all EM iterations, we can center the data by subtracting these means in the beginning and ignore these parameters in the learning process. So for simplicity we change the notations x n and y n to be the centered vectors in the following.
 The mapping matrices W x and W y are updated as where for clarity we use matrix notations X =[ x 1 ,..., x Y =[ y 1 ,..., y N ] and Z =[ z 1 ,..., z N ] . Matrix C is defined to be the sum of all second-order sufficient statistics of the data, i.e., C = N n =1 z n z n . Finally the noise levels are updated as where  X  denotes vector 2-norm, and tr(  X  ) denotes matrix trace. The whole algorithm is summarized in Algorithm 1.
The log likelihood of the observations in S 2 PPCA model is a sum of two parts: L 1 =log P ( D 1 ) which contains all the labeled points, and L 2 =log P ( D 2 ) which includes all unlabeled points. Therefore in E-step we need to deal with them differently. For a labeled points ( x n , y n )  X  X  1 latent variables z n are estimated via (5) and (6), the same as in SPPCA model. For an unlabeled point x n  X  X  2 ,the distribution of z n is only conditioned on input x n ,which can be calculated via (4), with sufficient statistics (the data are assumed centered already): Algorithm 2 Learning in S 2 PPCA Model -Primal Form Require: N 1 labeled data points { ( x n , y n ) } N 1 n =1 1: Calculate the sample means (7) and center the data via 2: Initialize model parameters  X  randomly. 3: repeat 4: { E-step } 5: for n =1to N 1 do 6: Calculate (5) and (6) for labeled data n ; 7: end for 8: for n = N 1 +1 to N do 9: Calculate (11) and (12) for unlabeled data n ; 10: end for 11: { M-step } 12: Update W x and W y via (13) and (14); 13: Update  X  2 x and  X  2 y via (15) and (16); 14: until the change of  X  is smaller than a threshold. Output: Parameters  X  and projection vectors { z n } N n =1 where here  X  denotes the expectation with respect to the posterior distribution P ( z n | x n ) given in (4).
The M-step is similarly obtained by setting the partial derivatives of the complete log likelihood with respect to each parameter to zero. For the two mapping matrices, we have the updates where X 1 , Z 1 , C 1 are defined for labeled data, i.e., X [ x and X 2 , Z 2 , C 2 are similarly defined for unlabeled data. It is seen that the update for W x depends on both labeled data and unlabeled data, while W y only depends on the labeled data. Updates for the noise levels are similar to those in SPPCA model, except that for  X  2 x we need to consider both labeled data and unlabeled data: The whole algorithm is summarized in Algorithm 2. When N 2 = 0, i.e., we have no unlabeled data, the learning algo-rithm reduces to SPPCA learning.
It is known that when the number of data points is less than the number of features, i.e., N&lt;M , it is more efficient to consider the dual solution for PCA in which we perform SVD to the Gram matrix K = XX . The canonical PCA is sometimes called the primal solution. For SPPCA we have a similar dual solution, and it can be directly derived from the Algorithm 3 Learning in S 2 PPCA Model -Dual Form Require: N 1 labeled data points { ( x n , y n ) } N 1 n =1 1: Calculate Gram matrix K with K ij = x i x j and center 2: Initialize Z , C and model parameters  X  randomly. 3: repeat { The EM-step } 4: Calculate Z 1 and C 1 using (21) and (22); 5: Calculate Z 2 and C 2 using (23) and (24); 6: Update  X  2 x and  X  2 y via (25) and (26); 7: until the change of  X  is smaller than a threshold. Output: Parameters  X  and projection vectors { z n } N n =1 EM learning in previous subsections. To avoid the tedious mathematics in the main text, we put the derivation details into Appendix and summarize the algorithm in Algorithm 3. Since SPPCA can be viewed as a special case of S 2 PPCA, here we only give the algorithm for S 2 PPCA model.
One important observation in the dual solution is that all the calculation involving input data X can be done via inner-product, e.g., in the Gram matrix K we have K ij = x i x j This motivates us to consider non-linear PCA where we first map the data into a new feature space (via, e.g., basis func-tions), and then perform PCA in that space with a proper definition of inner-product. This is the idea behind kernel PCA [16], and we put detailed discussion into Appendix.
In the primal form (i.e., Algorithm 1 and 2), the time complexity for both algorithms is O m ( M + L ) NK ,with m the number of iterations. 1 It is linear in the number of data points N and the input dimension M . The space complexity is O ( M + L ) N , which is also linear in both N and M . The projection for a test data point is just a linear operation and costs O ( MK )time.
 In the dual form, the time complexity is O ( mN 2 K )plus O ( N 2 M ) which is the one-time calculation of Gram matrix, and the space complexity is O N 2 . Both of them are now quadratic in the number of data points N . The time for projecting a test data point is now O ( NM ). Similar to the case for PCA, in situations where M&gt;N , i.e., we have more features than the number of data points, the dual form is more efficient than the primal form. In this section we provide some theoretical analysis for SPPCA model and show how the supervised information influences the projection. The proofs are given in Appendix.
Recall that matrix  X  is a ( M + L )  X  ( M + L ) diago-nal matrix with all the noise levels in diagonal, i.e.,  X  = the following analytical solutions for mapping matrix W x
Note that we only need to calculate the diagonal entries for matrix trace in the updates for noise levels. and W y . This makes it easier to compare SPPCA with related models such as PCA.

Theorem 2. Let S denote the normalized sample covari-ance matrix for centered observations { ( x n , y n ) } N S = 1 and  X  1  X  ...  X   X  ( M + L ) be its eigenvalues with eigenvectors u ,..., u ( M + L ) , then if the latent space in SPPCA model is K -dimensional, the following results hold: (i) The maximum likelihood estimates of W x and W y are (ii) Projection z  X  for centered new input x  X  is given as In the special case that L = 0, the model is unsupervised and which recovers the PPCA solution. U x is seen to be column orthogonal in this case, and the mapping z  X  of x  X  is (scaled) standard PCA mapping when  X  2 x  X  0 and R = I . This proves Proposition 1 which is a corollary of this theorem.
When L&gt; 0, SPPCA solutions explain not only the sam-ple covariance of inputs S x , but also the intra-covariance of outputs S y (if L&gt; 1) and the inter-correlations between inputs and outputs, S xy and S yx . Therefore, one column of W x is the direction that best explains the whole system from the perspective of inputs, and thus are biased by the outputs. Unlike the case of PCA, the learned W x in SP-PCA needs not to be column orthogonal. This means we are only learning an affine mapping for x . If necessary, it is straightforward to find the orthogonal basis by performing SVD to matrix W x .

In both SPPCA and PPCA the learned W x has an arbi-trary rotation factor R . This means the mapping is invari-ant under a rotation of latent space, as can be seen from the equation for z  X  . Therefore the SPPCA model can only find the latent principal subspace , which has been mentioned in [17] for PPCA. Thus the EM algorithm in Section 4 can find different mappings with different initializations, but they de-fine the same subspace and do not change the structure of projected data. If necessary, this ambiguity can be removed by eigen-decomposing and uncovering the rotation factor R .

A final comment is that Theorem 2 may be not applicable to large-scale problems since we have to form a big square matrix of size M + L . This is however not necessary for the EM algorithm. In the dual form, we do not obtain the mapping matrix W x , but the projected vectors directly. The following theo-rem gives the analytical solution in the dual form.
Theorem 3. Let K = 1  X  2 x K + 1  X  2 y YY ,and  X  1  X  ...  X   X 
N be its eigenvalues with eigenvectors v 1 ,..., v N ,thenif the latent space in SPPCA model is K -dimensional, the fol-lowing results hold: 2 (i) The projection vectors of training data, which are en-(ii) Projection z  X  for new input x  X  is given as It is seen from this theorem that when there is no output in SPPCA, i.e., K = 1  X  2 PCA as desired. This theorem directly applies for non-linear mappings if the inner-product is defined in a reproducing kernel Hilbert space (RKHS) [16], and leads to the kernel PCA solution when L =0.

Theorem 3 presents a nice explanation for SPPCA model: we just use the outputs to modify the Gram matrix of input data, and control the trade-off via the ratio of noise levels. The model complexity remains the same (i.e., quadratic in N ) no matter how many output dimensions we have. Our previous work [20] shares this same property and derives the supervised projection via an eigenvalue problem. But it cannot be elegantly extended to semi-supervised projec-tions, and has problems to deal with large-scale data sets. Previous two subsections give some theoretical results for SPPCA model. There exists however no such a closed-form solution for S 2 PPCA. One can only empirically analyze the behavior of this model.

In the EM learning algorithm we are learning the maxi-mum likelihood (ML) estimates for the two mapping matri-ces W x and W y . In the probabilistic framework we can also assign a prior to them to reduce overfitting. For instance, we can assign an isotropic Gaussian prior for each column of W x , and if we consider the maximum a posteriori (MAP) estimate this prior corresponds to a smooth term in the up-date equations. For simplicity we do not consider this prior here.
In this section we empirically investigate the performance of SPPCA models. The supervised tasks here are multi-class classification and multi-label classification. Our basic setting is that we train a supervised projection model using the input features and label information, and then test the classification performance for test data using the projected features. Since the test data are assumed known in the training phase, for S 2 PPCA we will be able to use these unlabeled data to train the mapping.
We use the same notation for eigenvalues as in Theorem 2 because it can be proved that they are identical up to a scaling factor of N .
 Table 1: Statistics of the multi-class data sets (top) and multi-label data sets (bottom)
We test the proposed model on 9 multi-class and 2 multi-label classification problems. These problems include face recognition, gene classification and text categorization. Some statistics of these data sets are shown in Table 1.
For face recognition we use four data sets Yale, ORL, PIE and YaleB (the extended Yale Face Database B). 3 The Yale data set contains 165 gray-scale images in GIF format of 15 individuals. There are 11 images per subject, one per dif-ferent facial expression or configuration such as center-light, left-light, happy or surprised. The ORL database contains 10 different images of each of 40 distinct subjects. For some subjects, the images were taken at different times with vary-ing lighting and facial details. The PIE databases we use contains 170 images for each of 68 people. These images are the five near frontal poses under different illuminations and expressions. For YaleB we have 38 individuals and around 64 near frontal images under different illuminations per in-dividual. All the face images are manually aligned, cropped and resized to 32  X  32 pixels. We then normalize each image to have Euclidean distance 1.

We consider three gene expression data sets 11 Tumors, 14 Tumors and Lung Cancer for gene classification. 4 The 11 Tumors describes 11 various human tumor types, and 14 Tumors describes 14 tumor types with 12 normal tissue types. For Lung Cancer we need to classify 4 lung cancer types and normal tissues. The characteristic of these data is that the number of data points is small, but the input dimensionality is very high.

The two textual data sets we use are taken from 20News-group and TDT2. 20Newsgroup contains 20,000 news arti-cles posted in 20 news groups. We remove the words that occur less than 5 times, and obtain 19,928 documents with 25,284 words. The TDT2 corpus we use consists of the doc-uments collected during the first half of 1998 and taken from 6 sources, including 2 newswires (APW, NYT), 2 radio pro-grams (VOA, PRI) and 2 television programs (CNN, ABC). It consists of 11,021 documents which are classified into 96 semantic categories. In our experiments, we keep the largest 20 categories and remove those documents that are assigned to more than one categories. This leaves us 8,692 documents with totally 35,452 words. For both of these data sets we
See http://www.ews.uiuc.edu/  X  dengcai2/Data/data.html . They are available at http://www.gems-system.org . use TF-IDF features and normalize each document to have Euclidean distance 1.
 For multi-label classification we use Yeast and RCV1. The Yeast data set is formed by micro-array expression data and phylogenetic profiles with 2,417 genes in total and 103 input dimensions. There are 14 groups and each gene can belong to multiple groups. The other data is a subset of the RCV1-v2 text data set, provided by Reuters and corrected by Lewis et al. [11]. We use the training set provided by Lewis, which contains 103 labels, 23,149 documents with 15,500 words after we remove words that occur less than 5 times. We also extract TF-IDF features and normalize each document to have Euclidean distance 1.
For the multi-class classification tasks, we randomly pick up a small number of labeled data points for training (2 for those data sets with less than 500 data points, and 5 for the others), and test the classification error rate on the unlabeled data. We will in general compare the following six algorithms if applicable: For all the projection methods, we project the data into a space of 5, 10 and 20 dimensions, and train a nearest-neighbor classifier for the test points using new features with Euclidean distance. For Full we directly train the nearest-neighbor classifier using original features. For PLS, SPPCA and S 2 PPCA, we translate the one column output to the  X  X ne of C X  setting, i.e., each class has one column with binary labels.

For multi-label classification, we pick up 5 positive exam-ples from each label to obtain the training data. For all projection methods we project to 5, 10 and 20 dimensions, and then train a linear SVM classifier for each label. The comparison metrics are F1-Macro, F1-Micro and AUC (Area Under ROC Curve) score. The candidate algorithms are al-most the same as multi-class setting, except LDA which is not applicable to this task. The C in SVM is fixed as 100, and from our experience it is not sensible for all algorithms.
In all these comparisons, the iteration number for SPPCA and S 2 PPCA is set to 1000. Both the noise levels  X  2 x and  X  are set to 10  X  5 initially. It turns out that PLS gets memory problems when applied to large dimensions. We repeat each experiments 50 times independently, 5 and the results are illustrated in .
The first observation is that in most cases the supervised
For the four face recognition tasks we use the split versions available from the web site.
 PCA model is better than unsupervised PCA model. This means by using the output information, we are able to de-rive a more meaningful projection for the supervised tasks. When the dimensionality is larger (e.g., 20), SPPCA and S PPCA obtain the best results for most of the tasks.
When we compare SPPCA model with other supervised projection methods, SPPCA is consistently better than PLS, but in some tasks worse than LDA (e.g., for YaleB). The rea-sons may be that SPPCA models are still based on the PCA assumptions for input features, so the mapping is strongly biased by PCA. When PCA projection directions are almost useless for classification, like for YaleB dataset, the SPPCA projections are also not informative enough. In this case discriminative methods like LDA can often do a good job. In other situations where PCA does help, SPPCA can in general be better than pure discriminative methods. When we compare SPPCA and S 2 PPCA, in most cases S
PPCA gets better results. For some tasks the difference is very big (e.g., for TDT2). This indicates that by incor-porating the unlabeled data we can learn a better mapping. But S 2 PPCA is in general slower than SPPCA because it has to consider all the test data in the training phase. In this case 1000 iterations may be not enough to get the algorithm converge. This may also be part of the reason why S 2 PPCA is inferior to other methods for some tasks like PIE.
Most of the supervised projection methods can get a bet-ter performance than Full even if they only project the data into a very low dimensional space. This is important because we can not only speed up the system, but also im-prove the performance. PCA in our experiments uses the input features of both labeled and unlabeled data, thus it sometimes can get better results than Full method (e.g., for Yale and Lung Cancer).

The results for multi-label classification show that S 2 PPCA is consistently better than other methods. S 2 PPCA also shows very good scalability in our experiments, since for 20Newsgroup and RCV1 it need to handle 20,000 docu-ments with more than 15,000 features. Most of the other algorithms fail on these large data sets.
We proposed a supervised and a semi-supervised PCA in this paper, and derived an efficient EM algorithm for model learning. Empirical results show that the proposed model obtains good performance and scales well for large data sets.
In this paper we mainly focus on the Gaussian noise model for the outputs y . One can define other likelihood models for specific tasks, e.g., the probit likelihood for classification, but then we lose the nice closed-form solutions as described in Theorem 2 and 3. This is because in E-step of the EM learning the a posteriori distribution of z is no longer a Gaussian (see (2)). To solve this problem we can apply the expectation-propagation (EP) [13] algorithm to sequentially approximate each likelihood term P ( y | z ) as a Gaussian for z . Then the approximated a posteriori distribution of z is still a Gaussian, and the EM algorithm can still be applied to find the optimal projection matrices. Empirically com-paring this algorithm with the basic ones would be part of the future work. [1] E. Bair, T. Hastie, D. Paul, and R. Tibshirani. [2] S. C. Deerwester, S. T. Dumais, T. K. Landauer, [3] A. P. Dempster, N. M. Laird, and D. B. Rubin. [4] R. O. Duda, P. E. Hart, and D. G. Stork. Pattern [5] T. Evgeniou and M. Pontil. Regularized multi-task [6] K. Fukumizu, F. R. Bach, and M. I. Jordan.
 [7] T. Hastie and R. Tibshirani. Discriminant analysis by [8] T. Hastie, R. Tibshirani, and J. Friedman. The [9] H. Hotelling. Relations between two sets of variables. [10] I. T. Jolliffe. Principal Component Analysis . Springer [11] D. D. Lewis, Y. Yang, T. Rose, and F. Li. RCV1: A [12] R. G. Miller. Beyond Anova: Basics of Applied [13] T. P. Minka. A family of algorithms for approximate [14] S. Roweis and Z. Ghahramani. A unifying review of [15] S. Roweis and L. Saul. Nonlinear dimensionality [16] B. Sch  X  olkopf and A. J. Smola. Learning with Kernels . [17] M. E. Tipping and C. M. Bishop. Probabilistic [18] H. Wold. Soft modeling by latent variables; the [19] J. Ye, R. Janardan, Q. Li, and H. Park. Feature [20] K. Yu, S. Yu, and T. Volker. Multi-label informed
We only focus on S 2 PPCA model here. Let C = C 1 + C 2 , and X = X 1 then (13) can be written as W x = X ZC  X  1 . This leads to
W x W x = C  X  1 Z KZC  X  1 , W x x = C  X  1 Z k ( X , x ) , (20) which are the building blocks for the dual form. The matrix K = XX has each entry the inner-product of data points of corresponding row and column, K ij = x i x j ,and k ( X , x )= Xx is a N -dimensional column vector with the i -th entry x x .
 In the E-step, we first rewrite A as
A = 1 Applying (20) in sufficient statistics (5), we get by collecting z n in columns and transposing it. Sufficient statistics (6) can be written in terms of C 1 : Similarly, we obtain the following two updates for unlabeled data:
In M-step, we only need to update variances  X  2 x and  X  2 which can be easily verified from (9) and (10).

Therefore, it is seen that all interesting terms in the EM algorithm take input data into account only via the inner-product. This nice property allows us to extend the linear SPPCA model to non-linear mappings by first mapping the input data into a new feature space (via, e.g., basis func-tions) and then performing SPPCA in that space. This can also be done via kernel trick for which we only need to define a kernel function  X  (  X  ,  X  ) for each pair of input data [16].
Since we are now working on centered data in the feature space, we can achieve this by modifying K as where 1 denotes the all one column vector of length N [16]. For kernel vector k ( X , x  X  ), it can also be centered by
We give a sketch here. The mapping matrices are obtained by finding a fixed point in the EM algorithm in Section 4. For this proof we use notation W := ( 1  X  x W x , 1  X  y W and (3) can be rewritten as A = W W + I . Plugging this and (5), (6) into (8) yields an update equation only related to W : W = SW W SW + W W + I  X  1 W W + I .
 At the fixed point, this simplifies to SW = WW W + W . Let W = UDV be the SVD of W . Then each column u of U satisfies d Su =( d + d 3 ) u ,with d the corresponding singular value. Therefore solving an eigenvalue problem for S gives the mapping matrix W , and plugging them into (4) gives the mapping z  X  for x  X  .

We give a sketch here. We define B = ZC  X  1 and rewrite (21) and (22) using only B . This leads to N B I + B KB = KB .Tosolve B we denote the SVD of B KB as QDQ , then we can obtain B B = 1 N QD ( I + D )  X  1 Q after some mathematics. Then define U := BQ we have U U = I and U KU = N ( I + D ). This clearly defines a SVD for K , so by definition we have  X  = N ( I + D ). Then we can solve for B from U and  X  , which yields B =
N U I and the update equation for new test data can be easily ob-tained.

