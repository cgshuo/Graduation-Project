 1. Introduction
Prediction of oil well production is important in estimating economic benefit of a well. However, this prediction task is difficult because of the complex subsurface conditions of wells.
Even two wells, located side by side in the same reservoir, may not have the same production ( Mattar and Anderson, 2003 ). In addition, core analysis data obtained from oil fields are limited and tend to be biased. It is also difficult to adequately model the core analysis variables, which are significant factors in oil production. These variables have some dependencies or correla-tion among each other, however, there is no equation to describe inter-relationships. The traditional approach of modeling the variables is to use the curve-fitting approach, which is complex and time consuming. The current amount of petroleum data collected in databases today has far exceeded our ability to reduce and analyze data without the use of automated analysis techniques. In this paper, we apply a data modeling approach called the neural-decision tree (NDT) model that is distinctive in that it considers the dependencies or correlations among the attributes or variables.

In recent years, artificial intelligence, in its many integrated flavors, has made solid steps towards becoming more accepted in the mainstream of the oil and gas industry ( Mohaghegh et al., 2005 ). Artificial neural network (ANN) models have become a popular choice among the nonlinear petroleum prediction methods ( Nguyen and Chan, 2005 ). As an accurate predictive model, the ANN technique has, however, suffers from the weakness that the ANN models generated are  X  X  X lack boxes X  X , which do not help users understand the precise relationships among the variables modeled. The arbitrary nature of the internal representation means that there may be dramatic variations between networks of identical architecture trained on the same data.

The objective of this paper is to present the NDT model that can provide explicit information on the processing involved in generating estimates of petroleum production. The model is derived from an integrated approach that combines artificial neural network and decision tree learning algorithms, where the artificial neural network is used to discover the attributes X  dependence and the decision tree learning algorithm is applied to predict the petroleum production. 2. Background literature 2.1. Artificial neural network in petroleum prediction
Artificial neural network (ANN) was first introduced by the psychologist Frank Rosenblatt in 1958 ( Minsky, 1969 ). After that, the approach has been utilized for predicting oil production based on geological parameters such as porosity, permeability and fluid saturation from conventional well log and core analysis ( Moha-ghegh et al., 2005 ). Since the inter-relationships among the parameters are complicated, and the prediction process using the conventional methods can be time consuming and expensive in terms of labor and computational resources, demand for effective models to predict production increases rapidly. On the other hand, compared to the conventional methods, the ANN approach has been shown to generate more accurate and repeatable results (Mohaghegh et al., 1995 ; Chan and Nguyen, 2003 ). Some recent efforts at applying ANN methods in petroleum engineering include the following. Nguyen et al. (2004) used a multiple neural network model to make both short-and long-term time series predictions of petroleum production. Mohaghegh et al. (1994) applied ANN to predict the permeability of the formations using the data provided by geophysical well logs with good accuracy.
Wong et al. (1998) used ANN to predict permeability with an application to the Ravva oil and gas field, offshore India. Nikravesh et al. (1996) used ANN for the prediction of formation damage during fluid injection into fractured, low permeability reservoirs. 2.2. Decision tree learning for petroleum engineering
A decision tree is an idea generation tool that generally refers to a graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and utility. In data mining, a decision tree is a predictive model; it is a mapping of observations about an item to conclusions about the item X  X  target value (JiaWei and Micheline, 2001).

One of the advantages of decision trees is that they are easy to be interpreted and used by petroleum engineer. For example, the best potential oil production among the wells can be easily identified by the set of terminal nodes in the tree that have the highest percentage of production, and then the user can focus on the specific wells described by those nodes. In comparison with other methods, a decision tree can be constructed relatively easily and quickly.

Some research works on application of decision tree learning for petroleum engineering are discussed as follows. Perez et al. (2005) used decision trees to classify the data for permeability predictions based on the well logs. Jensen (1998) applied decision tree analysis to estimate the range of uncertainty in the reservoir production prognosis. Agbon et al. (2003) compared the decision tree model with the fuzzy model for the ranking of reservoirs based on the amount of natural gas production in Venezuela. The research emphasis on decision tree learning in the existing literature used implementations that support univariate attribute testing at each node, which is an adequately expressive repre-sentation if the training data are assumed to exhibit attribute independence. But in petroleum engineering, the available data sets typically contain attributes that are interdependent. Hence, it is necessary to take the issue of possible dependencies among attributes into consideration when designing decision tree learning models. Since there is often no prior knowledge of whether the data samples under study exhibit attribute depen-dencies, or what type of dependencies exist between which attributes, a mechanism for exploring these factors must be incorporated into the learning process. These issues are consid-ered in the NDT model we adopted. 3. The neural-decision tree model neural networks and decision tree algorithms, details of NDT model can be found in ( Li and Chan, 2007 ). The primary strength of this model is that it can capture dependencies among attributes, and therefore, it is likely to provide an improved or more accurate prediction (Lee and Yen, 2002). The architecture of the NDT model for a mixed-type data set, with squared boxes showing the main processing components of the neural network and decision tree is shown in Fig. 1 . The NDT algorithm models a single pass process initialized by the acceptance of training data as input to the neural network model. The generated output is then passed on for decision tree construction, and the resulting rules will be the net output of the NDT model. The arrows show the direction of data flow from the input to the output, with the left-hand-side downward arrows show the processing stages of nominal attributes, and the right-hand-side arrows indicating the corresponding process for numeric-type data. As illustrated in Fig. 1, the rule extraction steps in this NDT model include the following: 1. Divide the numerical-categorical-mixed dataset into the two parts of numerical subset and nominal subset. For a pure-type data set, no division of the data set is necessary. 2. For the numerical subset, train a feed-forward back-propaga-tion neural network and collect weights between the input layer and the first hidden layer. Then, change each attribute value according to the weights generated by the neural network model. 3. For the categorical subset, train a back-propagation neural network and classify categorical attributes according to the weights generated by the neural network model. 4. Combine the new numerical subset and new categorical subset into a new numerical-categorical-mixed dataset. 5. The new dataset is fed as input to the C4.5 system to generate the decision tree and rules. 6. Some evaluation of the results is conducted to obtain a reliable estimate of the accuracy of the classifier or predictor model. 4. Application problem domain 4.1. Prediction of petroleum production
The objective is to use the NDT model for identifying the relationships among the core variables responsible for oil production prediction. The performance of the NDT model is assessed using data sets obtained from pools of wells in
Saskatchewan, Canada. 4.2. Study area
The Weyburn Field is one of the largest reservoirs located in the north of the Williston Basin in southeastern Saskatchewan,
Canada. Petroleum production of this reservoir is from Mississip-pian age carbonates at a depth of more than 1300m. The well was discovered in 1954 and oil production occurred until February 1963 when water flooding was implemented. The maximum production appeared in 1965 at 46,000barrels/day.

The Saskatchewan Industry and Resources supplied the dataset on the Weyburn Field. The dataset consists of data records on production rate, core analysis and pressure data from the
Weyburn Midale field in Saskatchewan, Canada spanning 50 years, from the 1960s to 2006. The core and Practical Drillstem
Test (DST) analysis data provide information about the geoscience parameters, such as permeability, porosity and first shut-in pressure.

Since the modeling process requires accurate identification of input parameters, all the relevant parameters related to petroleum prediction should be considered. However, due to limitations in the data, the five most significant parameters of permeability, porosity, first shut-in pressure, residual oil and saturation of water are selected for modeling. In our investigation on modeling production data, four different models were developed based on different combinations of parameters and data. The first model predicted total production using the three geosciences parameters of permeability, porosity and first shut-in pressure as input variables. Then, two different models with different input parameters were developed to predict production in the post-water flooding stage only: (1) one model includes only the three geosciences parameters of permeability, porosity and saturation water, and (2) another model extends the first model by using the four geosciences parameters of permeability, porosity, water saturation and residual oil. The fourth model was built based on an assumption that the production data exhibit a harmonic trend in the particular area of study. Therefore, instead of directly estimating the wells X  production, the last model predicted the behaviors or the harmonic trends of the wells X  production data based on permeability and porosity. The model predicted the production trend of oil in the pre-water flooding stage. In the model, the geoscience data were selected and grouped into specific rock formations by a petroleum engineer. Details of the variations in these models will be discussed in the following subsections. 4.3. Data preprocessing
The original data set used for modeling suffered from the commonplace inadequacies of being incomplete (lacking attribute values or certain attributes of interest, or containing only aggregate data), noisy (containing errors, or outlier values that deviate from the expected), and inconsistent (containing dis-crepancies in the tag names used to label attributes). In other words, there are reported errors, unusual values, and inconsis-tencies in the data recorded for some transactions. Due to these inadequacies in the dataset as well as the fact that a large amount of redundant data can slow down the analysis process, data preprocessing was conducted so as to improve the efficiency of the analysis process. Since the geoscience values of permeability, porosity, water saturation, and residual oil are measured in different depth ranges at each well in the core analysis, we calculated the weighted averaged value and fed them as the corresponding input values of each geoscience parameter for each well. 4.4. Experiments and results
This section will present the experimental results and analysis of the four models built by the NDT structures. These four models can be classified into three different types: overall oil production model, post-water flooding model and trend predicting model. Details of each model are presented below. 4.4.1. Overall oil production model
First, the entire oil production data set was used, so the model was called an  X  X  X verall oil production model X  X . The model includes the production rates and the three geoscience parameters of permeability, porosity and first shut-in pressure as input variables for the prediction task. In this study, we attempt to build the classification model by using the data discretization technique to divide the numeric production data into ranges of values. The entropy-based discretization technique ( JiaWei and Micheline, 2001 ) was used here to discretize the numeric class attribute into differe nt specific sub-ranges. This approach is a commonly used splitting technique that explores distribution information in its determination of split-points, which are data values for partition-ing an attribute range. For example, to discretize the numeric class attribute, A, the method selects the value of A that has the minimum entropy as a split-point, and recursively partitions the resulting intervals to arrive at a hierarchical discretization. The reason we adopted this approach was that the entropy-based discretization technique uses class information to reduce size of the data set, which makes it more likely that the interval boundaries, or split-points are defined to occur in places that may help improve classification accuracy. This method generated six interval ranges from the data set, which are listed below from low to high:
Class A: [2,000 X 97,767], Class B: [97,767 X 199,633], Class C: [199,633 X 269,082], Class D: [269,082 X 373,839], Class E: [373,839 X 469,633], Class F: [469,633 X 620,000].

Fig. 2 shows the data distribution of each class. As seen from the graph, most of the data fall into Classes A and B. This is because in reality, most of the oil wells in fact have low production rates, and only a few of them have high production capacities.

And the training result of the model is shown in Fig. 3 . From the result, we obtained the link weights between the input layer and the hidden layer. Then, the original numeric data set was trained using Eqs. (1) X (3) shown below into a new dataset, which has equivalent values as the inputs to the hidden layer of the trained neural network, and the NDT model was applied to the new dataset to generate decision rules.

H  X  0 : 37  X  4 : 24 Permeability  X  4 : 2 Porosity  X  X  2 : 63  X  Pressure  X  1  X 
H
H  X  0 : 82  X  1 : 6 Permeability  X  1 : 31 Porosity  X  X  2 : 12  X  Pressure  X  3  X 
The unpruned and pruned tree versions of the NDT model generated 24 rules and 17 rules, respectively; the entire trees are not shown due to their large sizes. The topmost splitting attribute is permeability, which means that the variable of permeability has the maximum correlation with the predicted production. The attribute at the lower level is porosity, which appears in the sub-branches frequently. The first shut-in pressure is the less important attribute and appears at or near the leaf nodes in the trees.

As shown in Table 1 , it can be seen that in comparing the results generated by the C4.5 decision tree learning algorithm with the NDT model, the NDT model reduces the tree size and number of rules by half with only 5% decrease in classification accuracy. A decrease in the number of rules is an improvement because domain experts such as petroleum engineers can more easily validate them. Hence, the NDT model applied in this study provides better explanation capability since it generates a comparative smaller rule set with an acceptable level of classification accuracy. In other words, with the sacrifice of a little classification accuracy, the NDT model is able to provide some explicit heuristics for classification that support predicting oil production from a new well. Some sample rules generated by the original dataset using the C4.5 decision tree model and the rules generated with the new dataset using the NDT model are shown in Figs. 4 and 5 , respectively. And Figs. 6 and 7 show the sample tree for these two models. 4.4.2. Zooming-in: post-water flooding model
Water flooding is often used to enhance oil recovery. After water is injected into the well, the mechanism of the well is changed and oil well production is significantly increased. In order to better model the oil production of the post-water flooding stage, two models were built: one with the three geoscience parameters of permeability, porosity and saturation water only, and the other contained the four geoscience parameters of permeability, porosity, saturation water and residual oil. Only 121 wells in total are available, of which 81 wells were used for training and 40 for testing. The two post-water flooding models are discussed as follows: 4.4.2.1. Post-water flooding model with three parameters. This model was set up for the stage of post-water flooding prediction with the three most significant geoscience parameters of perme-ability, porosity and saturation water. The saturation water in-stead of first shut-in pressure was adopted as an input geoscience parameter because first shut-in pressure was measured during the stage of pre-water flooding and hence not applicable during the stage of post-water flooding.
 method described above are [18001.85 X 36400.2], Class F: [65434.95 X 83956.2].
 and output variables was built as well. The model adopts the popular three-layer feed-forward ANN topology, the sigmoid activation function, and the classical back-propagation training method of ANN. The Weka [ Weka tool kit, 2007 ] software tool kit was used for implementation and the performance of the model is summarized in Table 2 .
 similar to those of the ANN model; both models have almost the same misclassification rate, the NDT model X  X  RMSE is only 0.056% higher than that of the ANN, the NDT model X  X  mean absolute error is 0.0145 lower than that of the ANN, the relative absolute error is 6.1% lower and the root relative squared error is 16.45% higher.
However, both NDT and ANN have a high misclassification rate of over 71% during the stage of post-water flooding production. This suggests that the model is inadequate; hence, we attempted to process the input data more efficiently and some new attributes were added to improve the prediction accuracy of the models. 0 100 200 300 4.4.2.2. Post-water flooding model with four parameters. In order to improve the effectiveness of the predictive model, it was extended by adding another geoscience parameters: residual oil. The same configuration of the model was built and it generated the results as shown in Table 3 .

As shown in Table 3 , both the NDT and ANN models have even higher error compared with the previous one. This means the parameter of residual oil has little influence on oil production and more attributes cannot lead to a better performance. Interestingly, in the nodes of the NDT model corresponding to higher production, instead of permeability, porosity begins to appear at the top layer of the generated NDT model tree. This means that this attribute of porosity became the most important one for predicting the post-water flooding production. The physical explanation of this fact is that the oil flow in the rock rapidly increases after water flooding, and with more void space within a rock, the oil can be more easily pushed onto the surface. 4.4.3. Trend predicting model
The error analysis of the post-water flooding model reported above led us to the conclusion that the mechanisms used so far were somewhat superficial, and these configurations may not allow the data-driven models to classify oil production into physically interpretable classes.

In order to improve the effectiveness of the classification model, we attempt to predict the trend of the oil well instead of directly estimating its production. We worked with petroleum engineers who preprocessed the geoscience data by filtering the data based on their expertise. After preprocessing the data, 31 oil wells, where the production values have a harmonic relationship over time, were chosen and used to build the model. The empirical
Arps decline equation, which represents the relationship between production rate and time for oil wells during the pseudosteady-state period, is shown as follows ( Arps, 1945 ): q  X  t  X  X  q i where q ( t ) is the oil production rate at time t , D i is the initial nominal decline rate and q i is the initial oil production rate. In addition, the values for the parameters of permeability and porosity will not be averaged from all depths, instead, the average values from one particular formation only will be taken. The production value will be calculated as the summation of productions from different formations of one well.

To build this model, we first calculated the q i and D i of each well. The Sigma Plot software package [ Sigma Plot, 2007 ]was used to calculate the values of q i and D i based on the production value of each well. Instead of directly predicting the production, we focused on predicting the q i and D i values in the harmonic equation which would give us a better understanding of the trend and behavior of an oil well. In this way, we can also capture characteristics of the reservoir and dataflow organization. In the model, we only used permeability as the input variable to predict the value of D i , and used porosity to predict the value of q wells were used for training and 3 for testing. The value range of
D is [0, 0.38] and the value range of q i is [23.798, 161.699]. The experimental results of NDT and ANN model are shown in Tables 4 and 5 , respectively.

It can be observed from the above table, the trend model demonstrated an improved performance in prediction of q i by both NDT and ANN models. In the experiment for D i , prediction, the Mean Absolute Error of the NDT model is 0.0086, while the
ANN model is 0.0395. Thus, the NDT model is better than ANN model in D i , prediction. In comparison to the value range of D 0.38), the Mean Absolute Error in the NDT model is about 10%, which is small. And in q i prediction, the Mean Absolute Error of the NDT model is 38.32, while the ANN model is 32.11. Since the value range of the q i value is from 23.798 to 161.699, the Mean
Absolute Error is also about 10%, which is still acceptable when comparing with the range of the q i . However, the performance of ANN model is better than NDT model in q i prediction.
The relative absolute error and the root relative squared error are just the total absolute error, with the same kind of normal-ization. In these two error measures, the errors are normalized by the error of the predictor that predicts average values ( Witten and
Frank., 2005 ). If values of these relative errors are high, it means the predicted values are scattered away from the average predicted value. If their values are low, then the predicted value tend to cluster close to the predicted average. Hence, the relative absolute error and the root relative squared error only reflect the basic predictability or unpredictability of the output variable, not the accuracy of the model. From Tables 4 and 5 , it shows that for testing, these relative errors of D i in ANN model are higher than
NDT model, which means the output value of the NDT model tends to lie fairly close to its average value, and therefore easier to predict compared with the ANN model. However, in q i prediction, these relative errors of both NDT and ANN are high, which demonstrates that predictability of the model is low. and D i , is inconclusive in that: the NDT is better in D according to the Mean Absolute Error, and the reverse is true for q prediction. 5. Conclusions the objective of predicting petroleum production using different machine intelligence techniques. The initial research goal is to perform prediction modeling for petroleum production, and the approach we used is the neural-decision tree (NDT) model. It is shown that the NDT model, being analogous to decision tree algorithms, have some advantages compared to artificial neural network. From the experimentation presented here involving different strategies and different parameters combinations, the following conclusions can be made: the three geoscience parameters of permeability, porosity and first shut-in pressure, the model has an average classification accuracy of 80.31%. Although this classification accuracy shows a 5% decrease compared with the regular C4.5 model, the NDT model reduces the tree size and number of rules by half, which makes it easier for petroleum engineers to analyze results from the rules it generated. In addition, permeability is shown to be the most important variable in predicting petroleum production. three geoscience parameters and four geoscience parameters. In spite of low classification accuracy in these models, the models demonstrate porosity is the most significant factor in prediction of petroleum production instead of permeability in the post-water flooding stage. This finding is consistent with the fact that the oil well had different characteristics after water flooding was applied.
Also, the reason of the low classification accuracy using just three attributes is likely because the input data have not been processed more efficiently, and lack of some domain knowledge of the post-water flooding conditions of the well.

Thirdly, a trend model was developed in order to improve effectiveness of the prediction model. In this model, the oil wells with harmonic relationships between the variables of production rate and time were selected for prediction of the parameters of q and D t using the empirical Arps decline equation. The model demonstrated an improved performance in prediction, with the
Mean Absolute Error of 38.32 in prediting q i , and 0.0086 in prediting D t respectively. By comparing these results with the value range of q i [0 X 0.38] and D i [23.798, 161.699], we found that the Mean Absolute Error of them is small.

In addition, we also found that the performance of NDT model is comparable to the artificial neural network. The advantages of the NDT model when compared to ANN model are
The generated tree-like structure are easy to understand for decision makers. It makes it possible for a petroleum engineers to have a good overview of the relationship between the geoscience attributes if we are able to validate the goodness of the rules.

The training process of the NDT model is much faster than ANN and always converges.

The knowledge inside a NDT tree may also help in parameters selection and assessing the interdependent relationships among attributes.

Lastly, we observed that although the general prediction performances of the NDT model are good, the prediction inaccuracies of some models are high. The reasons for this high inaccuracy may be due to data-related problems, which include
The limited availability of data in the model. For example, only 31 oil wells, with a harmonic relationship between production and time, can be identified for training the trend model after preprocessing the geoscience data.

The oil wells may contain different rock formations having different physical properties. However, this difference is ignored.

The weighted average data may be too rough to capture the oil well property. Although the pressure data use weighted average data of different formations instead of the entire weighted data for all formations, however, this is not a significant attribute in predicting production rate.

In order to validate the model or improve the prediction accuracy, the following recommendation could be given:
Instead of focus on generating perfect rules that are guaranteed to give the correct classification on all instances in the training set, we would rather generate  X  X  X ood X  X  rules that avoid overfitting the training set and thereby stand a better chance of performing well on new test instances. For example, we can split the training data into two sets: a growing set and a pruning set. The growing set is used to form a rule using the unpruned
NDT model. Then, a conditional is deleted from the rule, and the effect is evaluated by trying out the truncated rule on the pruning set and seeing whether its coverage would increase over the original rule. This pruning process repeats until the rule cannot be improved by deleting any further more conditionals in the rule. The whole procedure is repeated for each class, obtaining one best rule for each class of the decision variable. It is important to separate the growing and pruning sets because it would be misleading to evaluate a rule on the data used to form it, and would lead to serious errors if rules that overfit the data were preferred ( Witten and Frank, 2005 ).
Since relation between the geoscience parameters are highly nonlinear, the prediction would likely be improved by using more geoscience parameters as input attributes. In this way, more dependencies among attributes are considered and identified in the NDT model.
 In the situation when data-driven models are used (NDT or
ANN, etc.), some domain knowledge of petroleum engineering is needed to analyze and validate the rules and results that generated by these models. 6. Future work
It can be observed that the problem of predicting oil production is difficult. Although we have utilized different approaches on different aspects of the problem, such as data preprocessing by NDT model, different mechanisms of input parameters used, and different AI techniques, the prediction results are still not as accurate as desired. It seems that oil production depends on many factors, some of which have not been taken into account. Moreover, each factor such as perme-ability cannot be measured accurately because the values vary at different locations and in different rock formations.
The NDT model has been applied for petroleum prediction, which is a domain that involved primarily numeric data. For future work, the project can be extended to include more data, that belong to the categorical and mixed-types. Further research is needed to define formal processes of integrating attribute group-ing into the construction of a multivariate decision tree for categorical data modeling. Without a defined process, the multi-variate tree model generated is entirely dependent on the user X  X  interpretation of link weights, which are used to prune errors. A heuristic search based on link weights should also be considered for constructing a multivariate tree that favours low class entropy and supports meaningful attribute groupings. It is our belief that, if all the dependencies among input attributes can be captured, more improvement in data classification accuracy can be realized.
Some models with high reported errors need to be further investigated in different ways. It would also be of interest to apply the NDT model for prediction of gas and water in the oil wells, integrating other geoscience parameters from DST, well log, and core analysis data sources. It is necessary to collaborate with petroleum engineers who can help classify geoscience data into different rock formation groups and develop one model for each group. In that approach, permeability and porosity will not be averaged from all depths but instead will be averaged from values derived from one formation only. Also, the production will be calculated as the summation of productions from different formations of one well.

Furthermore, the NDT model implemented in this project can not deal with the problem of missing attribute values. This issue needs to be investigated so that an effective process for dealing with missing values can be defined. One possible way is to use the attribute mean to fill in the missing value or to use the attribute mean for all samples belonging to the same class as the given tuple. However, this method biases the data, and the filled-in value may not be correct. Another popular solution to this problem is to use the most probable value to fill in the missing value ( JiaWei and Micheline, 2001 ), which uses all the information from the present data set to predict the missing value. The judgment on  X  X  X he most probable value X  X  is made by the user. Acknowledgements The generous support of a grant from the Canada Research
Chairs Program for the first author is gratefully acknowledged. The authors would also like to thank Hahn H. Nguyen and Jon Hromek for their contributions to this work.
 References
