 During the past decade the effects of exact spike timing on the change of synaptic connectivity have been studied extensively. In vitro studies have shown that the induction of long-term potentiation for long-term depression (LTD) (see [1, 2, 3]). This phenomenon has been termed spike timing-dependent plasticity (STDP) and emphasizes the importance of a causal order in neuronal signaling. Thereby it extends pure Hebbian learning, which requires only the coincidence of pre-and postsy-naptic activity. Consequently, experiments have shown an asymmetric exponential dependence on the timing of spike pairs and a molecular mechanism mostly dependent on the influx of Ca 2+ (see [4, 5] for reviews). Further, when induced with more complex spike trains, synaptic modification shows nonlinearities ([6, 7, 8]) indicating the influence of short-term plasticity.
 Theoretical approaches to STDP cover studies using the asymmetric pair-based STDP window as a lookup table, more biophysical models based on synaptic and neuronal variables, and sophisti-cated kinetic models (for a review see [9]). Recently, the experimentally observed influence of the postsynaptic membrane potential (e.g. [10]) has also been taken into account ([11]).
 Our approach is based on differential Hebbian learning ([12, 13]), which generates asymmetric timing windows similar to STDP ([14]) depending on the shape of the back-propagating action potential ([15]). We extend it with a mechanism for activating learning by an increase in postsynaptic activity, because both the induction of LTP and LTD require [Ca 2+ ] to exceed a threshold ([16]). Moreover, we include a mechanism for adaptive suppression on both synaptic sides, similar to the model in [7]. Finally, we for simplicity assume that both the presynaptic and the postsynaptic side function as low-pass filters; a spike leaves a fast increasing and exponentially decaying trace. Together, we propose a set of differential equations, which captures the contribution dynamics (CD) of pre-and postsynaptic activities to STDP, thereby describing synaptic plasticity as a filter. Our framework reproduces experimental findings from two recent in vitro studies in the visual cor-tex and the hippocampus in most details. Furthermore, it proves to be particularly suitable for the analysis of the susceptibility of STDP to pre-and postsynaptic rate modulations. This is demon-strated by an analysis of synaptic changes depending on oscillatory modulations of baseline firing rates. We use a variant of the classical differential Hebbian learning assuming a change of synaptic con-nectivity w , which is dependent on the presynaptic activity trace y pre and the temporal derivative of the postsynaptic activity trace y post : c w denotes a constant learning rate. An illustration of this learning rule for pairs of spikes is given in Figure 1B. For simplicity, we assume these activity traces to be abstract low-pass filtered versions of neuronal activity x in the presynaptic and postsynaptic cells, e.g. the concentration of Ca 2+ or the amount of bound glutamate: The dynamics of the y  X  X  are characterized by their respective time constants  X  pre and  X  post . The contribution of each spike is regulated by a suppressing attenuation factor u pre-and postsynapti-cally. On the postsynaptical side an additional activation factor z  X  X nables X  the synapse to learn. The dynamics of u and z are discussed below. x represents neuronal activity which can be either a time-continuous firing rate or spike trains given by series of  X  pulses which allows analytical investigations of the properties of our model. Note that formally x ( t ) has then to be taken as x ( t + 0) . An illustrating overview over the different parts of the model with sample trajectories is shown in Figure 1A.
 We define the relative change of synaptic connectivity after after a period T from Equation (1) as The dependence on the initial synaptic strength w ( t 0 ) as observed in [3, 8] shall not be discussed here, but can easily be achieved by making the learning rate c w in Equation (1) w -dependent. Here, w ( t 0 ) is chosen to be 1.
 Ignoring attenuation and activation, a single pair of spikes at temporal distance  X  t analytically yields the typical STDP window (see Figure 2A and 3A): Figure 1: Schematic illustration of differential Hebbian learning with contribution dynamics. A : Pre-and postsynaptic activity ( x , second column) is modulated (attenuated with u , activated with z , first column) and filtered ( y , third column) before it contributes to differential Hebbian learning ( w , fourth column). B : Spike pair example for differential Hebbian learning. Left: a presynaptic spike trace ( y pre ) preceding a postsynaptic spike trace ( y post , dotted line) yields a synaptic strengthening due to the initially positive postsynaptic contribution (  X  y post , solid line), which is always stronger than the following negative part. Right: for the reverse timing the positive presynaptic contribution is only multiplied with the negative postsynaptic trace (right). Areas contributing to learning are shaded.
 The importance of adaptive suppressing mechanisms for synaptic plasticity has experimentally been shown by Froemke and colleagues ([7, 6]). Therefore, we down-regulate the contribution of the spikes to the activity traces y in Equation (2) and (3) with an attenuation factor u on both pre-and postsynaptic sides: This should be understood as an abstract representation of for instance the depletion of transmitters in the presynaptic bouton ([17]) or the frequency-dependent spike attenuation in dendritic spines ([18]), respectively. These recover with their time constants  X  rec and are bound between u 0 and 1. For the presynaptic side we assume in the following u pre 0 = 0 , so we abbreviate u 0 = u post 0 . The constants c pre, post  X  [0 , 1] denote the impact a spike has on the relaxed synapse.
 modification ([10, 8]). Therefore, we introduce a spike-induced postsynaptic activation factor z which enhances the contribution of a postsynaptic spike to the postsynaptic trace, e.g. by the removal of the Mg 2+ block from postsynaptic NMDA receptors ([19, 5]). The nonlinear positive feedback is introduced to describe strong enhancing effects as for instance autocatalytic mechanisms, which z decays hyperbolically to a lower bound z 0 and the contribution of a spike is weighted with the constant c act . In order to evaluate our model we implemented experimental stimulation protocols from in vitro studies on synapses of the visual cortex ([7]) and the hippocampus ([8]) of rats. In both studies, simple pairs of spikes and more complex spike trains were artificially elicited in the presynaptic and the postsynaptic cell and the induced change of synaptic connectivity was recorded.
 Froemke and colleagues ([7]) focused on the effects of spike bursts on synaptic modification in the visual cortex. In addition to the classical STDP pairing protocol  X  a presynaptic spike preceding or following a postsynaptic spike after a specific time  X  t  X  four other experimental protocols (see Figure 2B to E) were performed: (1) 5-5 bursts with five spikes of a certain frequency on both synaptic sides, where the postsynaptic side follows the presynaptic side, (2) presynaptic 100 Hz bursts with n spikes following one postsynaptic spike (post-n -pre), (3) presynaptic 100 Hz bursts with different numbers of spikes followed by one postsynaptic spike ( n -pre-post) and (4) a post-pre pair with varying number of following postsynaptic spikes (post-pre-n -post). Figure 2: Differential Hebbian learning with CD reproduces synaptic modification induced with STDP spike patterns in visual cortex. Data taken from [7], personal communication. A : experi-mental fit and model prediction with Equation (6) of pair-based STDP. B : dependence of synaptic modifications on the frequency of 5-5 bursts with presynaptic spikes following postsynaptic spikes by 6 ms. C, D and E : synaptic modification induced by post-n -pre, n -pre-post and post-pre-n -post 100 Hz spike trains. Figure 3: Differential Hebbian learning with CD reproduces synaptic modification induced with STDP spike patterns in hippocampus. Data taken from [8] as reported in [22]. A : experimental fit and model prediction with Equation (6) of pair-based STDP. B : quadruplet protocol. C and D : post-pre-post and pre-post-pre triplet protocol for different interspike intervals.
 Table 1: Parameters and evaluation results for the data sets from visual cortex ([7]) and hippocampus ([8]). E : normalized mean-square error, S : ratio of correctly predicted signs of synaptic modifica-tion. In the hippocampal study of Wang et al. ([8]) synaptic modification induced by triplets (pre-post-pre and post-pre-post) and quadruplets (pre-post-post-pre and post-pre-pre-post) of spikes was measured while the respective interspike intervals were varied. (see Figure 3B to D).
 As a first step we took the time constants from the experimentally measured pair-based STDP win-dows as our low-pass filter time constants (see Equation 6). They remained constant for each data (taken from [23] since not present in the study). Next, we chose the learning rate c w in Equation (6) to fit the synaptic change for the pairing protocol: (1) c w = 1 . 56 for the visual cortex data, (2) c w = 0 . 99 for the hippocampal data set. The remaining parameters were estimated manually within biologically plausible ranges and are shown in Table 1. The model was then applied to the more complex stimulation protocols by solving the differential equations semi-analytically, i.e. separately for every spike and the following interspike interval. As measure for the prediction error of our model we used the normalized mean-square error E where  X  w exp i and  X  w mod i are the experimentally measured and the predicted modifications of synap-tic strength in the i th experiment; N is the number of data points ( N = 18 for the visual cortex data set, N = 11 for the hippocampal data set).  X  i is the standard error of the mean of the experimental data. Additionally we counted the number of correctly predicted signs S of synaptic modification, i.e. induced depression or potentiation. The prediction error for both data sets is shown in Table 1. Figure 4: Synaptic change depending on frequency f and phase shift  X   X  of pre-and postsynaptic rate modulations for different baseline rates x 0 . The color codes are identical within each column and in arbitrary units. Note the strong suppression with increasing baseline rate for cortical synapses which is due to strong attenuation effects of pre-and postsynaptic contributions. It is weaker for hippocampal synapses because we found the postsynaptic attenuation to be bounded ( u 0 = 0 . 7 ). As shown in the previous section our model can reproduce the experimental findings of synaptic weight changes in response to spike sequences surprisingly well and yields better fits than former studies (e.g. [22]). The proposed framework, however, is not restricted to spike sequences but al-lows to investigate synaptic changes depending on arbitrary pre-and postsynaptic activities. For instance it could be used for investigations of the plasticity effects in simulations with inhomoge-neous Poisson processes. Taking x ( t ) to be firing rates of Poissonian spike trains our account of STDP represents a useful approximation for the expected changes of synaptic strength depending on the time courses of x pre and x post (compare e.g. [24]). Therefore our model can serve also as building block in rate based network models for investigation of the joint dynamics of neuronal activities and synaptic weights.
 Here, we demonstrate the benefit of our approach for determining the filter properties of STDP subject to CD, i.e. we use the equations together with the parameters from the experiments for determining the dependency of weight changes on frequency, relative phase  X   X  and baseline rates of modulated pre-and postsynaptic firing rates. While for substantial modulations of firing rates the nonlinearities are difficult to be treated analytically, for small periodical modulations around a baseline rate x 0 the corresponding synaptic changes can be calculated analytically. This is done by considering which for small  X  &lt; x 0 allows linearization of all equations from which one obtains  X  W =  X  w/ ( T X  pre  X  post ) , where T = 1 /f = 2  X / X  is the period of the respective oscillations. Neglect-ing transients this finally yields the expected weight changes per unit time. Though lengthy the calculations are straightforward and presented in the supplementary material. We here show only the exact result for the case of constant u = 1 and z = 1 :  X  W = The analytical results for the case with CD are shown graphically in Figure 4 using the parameters from cortex and hippocampus, respectively (see Tab. 1). These plots contain the main findings: (1) rate modulations in the theta frequency range ( ' 7 Hz) lead to strongest synaptic changes, (2) also for phase-zero synchronous rate modulations weight changes are positive, (3) in hippocampus maximal weight change magnitudes occur at baseline rates around 5 Hz, and (4) for high baseline rates weight changes become suppressed (  X  1 /x 0 for the hippocampus,  X  1 /x 2 0 for the visual cortex). Numerical simulations with finite rate modulations were found to confirm these analytical predictions surprisingly well. Also for the nonlinear regime and Poissionian spike trains deviations remained moderate. STDP has been proposed to represent a fundamental mechanism underlying learning and many models explored its computational role (examples are [25, 26, 27]). In contrast, research targeting the computational roles of dynamical phenomena inherent in STDP are in the beginning (see [9]). Here, we here formulated a minimal, yet biologically plausible model including the dynamics of how neuronal activity contributes to STDP. We found that our model reproduces the synaptic changes in response to spike sequences in experiments in cortex and hippocampus with high accuracy.
 Using the corresponding parameters our model predicts weight changes depending on temporal structures in the pre-and postsynaptic activities including spike sequences and varying firing rates. When applied to pre-and postsynaptic rate modulations our approach quantifies synaptic changes depending on frequency and phase shifts between pre-and postsynaptic activities. A rigorous per-turbation analysis of our model reveals that the dynamical filter properties of STDP make weight changes sensitively dependent on combinations of specific features of pre-and postsynaptic signals. In particular, our analysis indicates that both cortical as well as hippocampal STDP is most suscep-tible for modulations in the theta frequency range. It predicts the dependency of synaptic changes on pre-and postsynaptic phase relations of rate modulations. These results are in line with experi-mental results on the relation of theta rhythms and learning. For instance in hippocampus it is well established that theta oscillations are relevant for learning (for a recent paper see [28]). Furthermore, spike activities in hippocampus exhibit specific phase relations with the theta rhythm (for a review see [29]). Also, it has been found that during learning cortex and hippocampus tend to synchronize with particular phase relations that depend on the novelty of the item to be learned ([30]). The results presented here underline these findings and make testable predictions for the corresponding synaptic changes.
 Also, we find potentiation for zero phase differences and strong attenuation of weight changes at large baseline rates which is particularly strong for cortical synapses. This finding suggests a mech-anism for restricting weight changes with high activity levels and that STDP is de facto switched off when large firing rates are required for the execution of a function as opposed to learning phases; during the latter baseline rates should be rather low, which is particularly relevant in cortex. While for cortical synapses our analysis predicts that very low baseline activities are contributing most to weight changes, in hippocampus synaptic modifications peak at baseline firing rates x 0 around 5 Hz, which suggests that x 0 can control learning.
 Our study suggests that the filter properties of STDP originating from the dynamics of pre-and postsynaptic activity contributions are in fact exploited for learning in the brain. In particular, shifts in baseline rates, as well as the frequency and the respective phases of pre-and postsynaptic rate modulations induced by theta oscillations could be tuned to match the values that make STDP most susceptible for synaptic modifications. A fascinating possibility thereby is that these features could be used to control the learning rate which would represent a novel mechanism in addition to other control signals as e.g. neuromodulators. [1] W. Levy and O. Steward. Temporal contiguity requirements for long-term associative potenti-[2] H. Markram, J. Lubke, M. Frotscher, and B. Sakmann. Regulation of synaptic efficacy by [3] G. Q. Bi and M. M. Poo. Synaptic modifications in cultured hippocampal neurons: depen-[5] N. Caporale and Y. Dan. Spike timing X  X ependent plasticity: a Hebbian learning rule. Annual [6] R. C. Froemke and Y. Dan. Spike-timing-dependent synaptic modification induced by natural [7] R. C. Froemke, I. A. Tsay, M. Raad, J. D. Long, and Y. Dan. Contribution of individual spikes [8] H. X. Wang, R. C. Gerkin, D. W. Nauen, and G. Q. Bi. Coactivation and timing-dependent [9] A. Morrison, M. Diesmann, and W. Gerstner. Phenomenological models of synaptic plasticity [11] C. Clopath, L. B  X  using, E. Vasilaki, and W. Gerstner. Connectivity reflects coding: a model of [12] B. Kosco. Differential Hebbian learning. AIP Conference Proceedings 151 on Neural Networks [13] A. H. Klopf. A drive-reinforcement model of single neuron function: An alternative to the [14] P. D. Roberts. Computational consequences of temporally asymmetric learning rules: I. differ-[15] A. Saudargiene, B. Porr, and F. W  X  org  X  otter. How the shape of pre-and postsynaptic signals can [16] T. Nevian and B. Sakmann. Spine Ca2+ signaling in spike-timing-dependent plasticity. Journal [17] M. V. Tsodyks and H. Markram. The neural code between neocortical pyramidal neurons [18] E. Tanaka, H. Higashi, and S. Nishi. Membrane properties of guinea pig cingulate cortical [19] L. Nowak, P. Bregestovski, P. Ascher, A. Herbet, and A. Prochiantz. Magnesium gates [20] J. E. Lisman. A Mechanism for Memory Storage Insensitive to Molecular Turnover: A Bistable [21] U. S. Bhalla and R. Iyengar. Emergent Properties of Networks of Biological Signaling Path-[22] J. P. Pfister and W. Gerstner. Triplets of spikes in a model of spike timing-dependent plasticity. [23] G. Bi and M. Poo. Synaptic modification by correlated activity: Hebb X  X  postulate revisited. [24] M. Tsodyks, K. Pawelzik, and H. Markram. Neural networks with dynamic synapses. Neural [25] M. Lengyel, J. Kwag, O. Paulsen, and P. Dayan. Matching storage and recall: hippocam-[26] F. W  X  org  X  otter and B. Porr. Temporal sequence learning, prediction, and control: a review of [27] E. M. Izhikevich. Solving the distal reward problem through linkage of STDP and dopamine [28] U. Rutishauser, I. B. Ross, A. N. Mamelak, and E. M. Schuman. Human memory strength [29] Y. Yamaguchi, N. Sato, H. Wagatsuma, Z. Wu, C. Molter, and Y. Aota. A unified view of [30] A. Jeewajee, C. Lever, S. Burton, J. O X  X eefe, and N. Burgess. Environmental novelty is sig-
