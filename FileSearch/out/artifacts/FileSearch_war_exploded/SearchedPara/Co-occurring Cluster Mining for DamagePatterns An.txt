 The fuel cell is regarded as a highly effici ent, low-pollution power generation system that produces electricity by dir ect chemical reaction. However, a cru-cial issue in putting SOFCs into practical use is the establishment of a tech-nique for evaluating the deterioration of SOFCs in the operating environment. Since SOFCs operate in harsh environments (i.e., high temperature, oxidation and reduction), the reaction area is decr eased by fracture damage, and the cell performance is reduced as a result[1] . Two of the co-authors have succeeded in observing mechanical damage to SOFCs using the acoustic emission (AE) method[2]. Acoustic emission is an elastic wave (i.e., vibration, sound waves, in-cluding ultrasonic wave) produced by damage, such as cracks in the material, or by friction between materials. Depending on the  X  X racture mode X  (i.e., opening or shear), the type of material, the fracture energy, the shear rate, and other factors, distinct AE wave forms are produced[3,4].

Because AE data is enormous and high dimensional, data mining techniques have been applied for AE data in order to help SOFC experts discover the type and cause of damage. Fukui et al. used kernel self-organizing map (kernel SOM) to succeed in understanding the overview of damage process visually[5]. Also Kitagawa et al. used KeyGraph and density estimation combining with kernel SOM to identify the damage transition and rare essential events[6]. However, little knowledge about the mechanical correlation of damages has been obtained.
Hence, this paper aims to extract damage patterns which represent major me-chanical correlation among components in SOFC. For such purpose, this paper proposes a novel method of co-occurrence pattern extraction against numerical data such as AE events. The proposed method determines the area (or the com-ponents) of two co-occurring clusters cons idering co-occurrence between clusters and similarity within each clusters. The experiments show that we can acquire novel knowledge about damage mechanism of SOFC from damage pattern, even for the SOFC experts. 2.1 Problems of the Conventional Methods The task to extract co-occurring AE events is equivalent in some part to the well researched frequent pattern mining. Frequent pattern mining is to extract item sets appering frequently. An item is mainly symbolic data, however, there are also methods such as QLIQUE[8] and mining quantative frequent itemsets[9], which can handle numeric item. In [8] and [ 9], frequent item sets are extracted by searching frequent subspace clusters. However, the purpose is different from our work, because the above works do not s earch co-occurrence between clusters.
The straightforward approach to extract co-occurrence patterns from numeri-cal data is first to execute clustering, and then to extract patterns. For example, Honda and Konishi quantized by SOM the image data of clouds obtained from the satellite, and then extracted association rules about the climate change[10]. Also, Yairi et al. extracted association rules about ano maly detection after clus-tering from time series data transmitted by the satellite[11]. After clustering, the correlation pattern extraction method among clusters are used in these re-searches, namely, two steps pattern extraction method.

However, the above works do not consider the co-occurrence among clusters during clustering process. As a result, clusters may contain data points which are not related to the co-occurrence patterns. To the contrary, clusters may not contain data points which are related to the co-occurrence patterns. For example, in SOFC, a glass seal changes its state according to the temperature, and the feature of caused AE events also changes gradually. We aim to extract a part of AE events caused by the damage of the glass seal which co-occur with other components of SOFC. 2.2 The Requirements of a Co-occurrence Pattern In this section, we define the characteristics of data this work handles, then define the requirements of the co-occurrence pattern.
 Definition 1 ( numerical event sequence ). Suppose N numerical data x i = Definition 2 ( basket ). Suppose an event sequence with numerical value is di-The baskets are given by a minute, a day and so on, besides the length of baskets is not always regular. The details about SOFC data is described in section 3.2.
Here, extracted co-occurrence patterns must satisfy the following three re-quirements: Requirement 1 ( correlation ). As for two sets composed of events A, B  X  X  , E.g., Jaccard coefficient, confidence as in association rule, etc.
 Requirement 2 ( frequency ). The number of times of which A and B co-occurs E.g., support, etc.
 Requirement 3 ( similarity ). As for two event sets A and B ,eventsineach E.g., variance in a cluster, average distan ce between data points in a cluster, Requirements 1 and 2 are derived from the co-occurrence between event sets (cluster), and requirement 3 is from the clustering of the events.
 Definition 3 ( co-occurring cluster ). If event sets with numerical value A, B  X  Definition 4 ( co-occurrence pattern ). With co-occurring clusters A and B which We aim to extract the co-occurrence pette rns mentioned above. This paper pro-poses a novel method of co-occurrence pattern extraction called Co-occurring Cluster Mining . Note that we do not consider the order of occurrence of AE events in the same basket. The rea son is mentioned in section 3.2.

A conventional frequent pattern means an item set appearing frequently, whereas co-occurrence pattern means two sets composed of events that co-occur frequently. Therefore, the proposed method is regarded as a particular kind of clustering method considered the co-o ccurrence between clusters, rather than frequent pattern mining. 2.3 The Objective Function In this section, the objective function is defined to search co-occurrence pat-terns. In searching, the most complex problem is to make clusters which satisfy the correlation and similarity. We search the pairs of clusters A, B  X  X  which maximize the following objective function: where the function f ( A, B ) denotes the pattern correlation. The higher f ( A, B ) value is, the more correlative pattern. F or example, Jaccard coefficient and con-fidence as in association rule are used as f ( A, B ). Jaccard coefficient is used in case of analyzing the ratio of the co-occurrence of event A and B . While confi-dence is used to the co-occurrence of event B under the situation that event A occurred. Note that because requirement 1 denotes the correlation among many separated baskets, the correlation in the short and sequential period must be excluded. Therefore, even if events A and B co-occur several times in the same basket, this is considered only once.

On the other hand, the function g ( A, B ) denotes the pattern similarity. The higher g ( A, B ) value is, the more similar clusters. For example, the distance between clusters, or the variance within each cluster are used as g ( A, B ). Note that some definitions of the distance between clusters does not guarantee the monotonicity of cluster merge, e.g., centriod and median methods in hierarchical clustering. Therefore, we should avoid using those distances for g ( A, B ). If only the distance between objects can be ca lculated, the average distance between objects is used as the variance in a cluster.

Since the co-occurrence patterns must satisfy the requirements of correlation and similarity at the same time, the objective function is defined as the product of f ( A, B )and g ( A, B ). Generally speaking, the range of f ( A, B ) is different from that of g ( A, B ). Therefore, by normalizing as f ( A, B ) ,g ( A, B )  X  [0 , 1], both requirements of the correlation and similarity can be satisfied equally. The parameter  X   X  [0 , 1] determines whether the correlation or similarity should be considered strongly. If  X  is close to 1, the similarity is considered more strongly than the correlation, and if  X  is close to 0, and vice versa. By maximizing the objective function by eq. (1), the co-occu rrence patterns are obtained which sat-isfies the requirements of correlation and similarity. In addition, the requirement of frequency can be satisfied by extracting patterns which have higher support value than the pre-defined minimum support. 2.4 The Algorithm The proposed method searches the pairs of clusters maximizing L ( A, B ). The proposed method is based on an aggregative clustering, because of high com-putational complexity when using partition clustering like k-means. Partition clustering needs to be executed every time variables in the search are changed, in order to generate the candidate clusters of A and B . On the contrary, in aggregative clustering, once the merge process of clustering is obtained, co-occurrence patterns can be searched on the merge process. However, even in aggregative clustering, the pair of Seeds (starting point of clustering) is O ( N 2 ), and the expansion from each Seed will be O ( N ). Therefore, the total compu-tational complexity is O ( N 4 ). For the reduction of search space, we utilize a dendrogram from the result of hierarchical clustering and search co-occurrence patterns on the obtained dendrogram. By using the dendrogram, although the degree of freedom about the decision of cl uster shape decreases, the benefit is a great reduction of the search space to O (( N log N ) 2 ).

The algorithm of the proposed method is presented below. Here, assume a dendrogram by some hierarchical clustering has been obtained in advance. Here, Fig. 1 represents an example of the process of Expand Cluster (). Expand Cluster () moves the current merge state from a certain node to the upper parent node, all leaf nodes (objects) which are children of this node be-long to new cluster A . By the expansion of cluster A ,label A is given to objects 1and6.And A and B co-occur in baskets 1 and 3, namely, a co-occurrence pattern ( A, B ) appears twice. 3.1 Damage Evaluation Test of Fuel Cells A schematic diagram of the apparatus used to perform the SOFC damage test is shown in Fig. 2. The test section was initially heated up to 800  X  Cinorderto melt a soda glass ring and was then gra dually decreased to room temperature. Note that this damage evaluation test was to rupture the cells intentionally while lowering the temperature. Therefore, the knowledge obtained through this experiment is not directly available to actual running the SOFC. However, it is sufficient to demonstrate and confirm the reasonableness of the proposed method. The AE measurement was performed usin g a wide-band piezoelectric transducer. The AE transducer was attached to an outer Al 2 O 3 tube away from the heated section. The sampling rate is 1 MHz, and so the observable maximum frequency is 500 KHz. Running the SOFC for over 60 hours, 1,429 AE events were extracted using the burst extraction method[12,5].

Then, the same as the research by Fuk ui et al.[5], the AE events obtained from damage evaluation test are transformed into frequency spectrum data by Fast Fourier Transform (FFT). We obtained 1,429 frequency spectrum data each of which consists of 3,968 discrete points. 3.2 Division into Basket Assume that the potential stress in a composite material is released after a large-energy AE event occurs, i.e., intera ctions of internal forces are reset. In this research, the observed AE event sequence was divided into baskets followed by the research of Kitagawa et al.[6], assuming a sequence until a large-energy AE event occurs to be a chain of damage progression. These baskets are used in the proposed method. Note that because the damage process of SOFC is a com-plicated system, it is difficult to extract c o-occurrence patterns considering the order of occurrence or the time intervals between AE events exactly. Therefore, we do not consider the order of occurrence of AE events in the same basket, or the time intervals between AE events.

In this research, the energy threshold is 1 , 500mV 2 , which is also used in the research[6]. Then the AE event sequence is divided into 123 baskets. Fig. 3 shows an example of division into baskets.
 3.3 Calculation of Distance between AE Events This work utilizes the result of the research by Fukui et al.[5] obtained by the kernel SOM. We regard the objects used for hierarchical clustering as the code-book vector (prototype). The self-organizing map[13] is an unsupervised neural network and a visualization technique by mapping the high dimensional feature space into the lower dimensional space (mainly two dimension). Kernel SOM[14] is the extended method of conventional SOM by improving the ability to express distribution of data with kernel method, which extends linear analysis method to non-linear method by mapping higher dimension. According to the earlier re-search, because the major damage types are already known on the kernel SOM, we can visually understand damage types with this result. Furthermore, the number of data points N is replaced to the number of prototypes M ( N&gt;&gt;M ) by the quantization of the data space, the computational cost of searching co-occurring patterns is significantly reduced.

The distance between prototype vectors f or the requirement of similarity (re-quirement 3) can be culculated as follows. Let M neurons of the prototype vectors be { m 1 ,  X  X  X  , m M } ,where m j =( m j, 1 ,  X  X  X  ,m j,v ). In addition, let the position of M neurons in the topological layer be r j =(  X  j , X  j ): j =1 ,  X  X  X  ,M . The number of neurons and the layout of the topological layer must be pre-defined, and a regular or hexagonal grid is normally used. Also, let a function  X  :  X   X  X  maps an original data space  X  to a high dimensional feature space H . Then the prototype vector m i is calculated by: where  X  i =1 / n h c ( n ) ,i refers to the normalization factor. The neighborhood function h i,j is the Gaussian function: h i,j =exp(  X  r i  X  r j 2 / 2  X  2 ), where  X  refers to the radius which represents the influence range of neighborhood.
Although the mapping function  X  ( x n ) cannot be calculated directlyC a kernel function can be defined as K ( x i , x j )=  X  ( x i ) , X  ( x j ) ,where , refers to the scalar product.

In this research, we use Kullback-Leibler (KL) kernel which was validated against the waveform data by Ishigaki et al.[15] and Fukui et al.[5].
Finally, the distance between prototype vectors m i and m j is culculated by: d Since batch learning is used for kernel SOM, the neighborhood radius  X  gradually decreases as learning is iterated. In cu lculating the distance of the codebook vector from the map obtained after the learning, we cannot decide the value of  X  definitely. Therefore, the optimal neighborhood radius  X   X  used for extraction of co-occurrence patterns is supposed to maximize the variance of the distances between the prototype vectors:  X   X  =argmax  X  V ( d i,j ).  X   X  =0 . 1 was linearly searched at intervals of 0.01. We use this d i,j as the distance between individual events. 3.4 The Design of the Object Function This paper focuses on the co-occurrence relationship in certain damage period, namely about two sets of AE events A and B , we aim to extract damages co-occurring at the high probability. Therefore, we use Jaccard coefficient as f ( A, B ): where count ( A ) is the number of baskets where event A appears.

Moreover, we cannot obtain the centroid of clusters but can obtain the dis-tance between codebook vectors with d ave as the average distance among all pairs of codebook vectors in the cluster. Hence, g ( A, B )is: where d ave is normalized divided by d aveALL of the largest cluster so that g ( A, B )  X  [0 , 1]. To consider the corrrelation and similarity of patterns as equally as possible, the parameter  X  in eq. (1) is set to 0.5. 3.5 The Results of Extracted Damage Patterns The topology of kernel SOM is two dimensional square grid, and the number of neurons is 15  X  15.

First, Table 1 shows the average values of the objective function in different hierarchical clustering methods. The values are averaged by the extracted 100 patterns when the minimum support is 0.04. The complete linkage method shows the best result. The following all results are obtained by using the complete linkage method in the hierarchical clustering.

Next, the representative extracted damage patterns are explained. Two ex-perts of SOFC of the co-authors interpreted damage patterns. Table 2 shows the estimated interpretation of extracted damage patterns. As the parameters of pattern extraction, the minimum object function is 0.47, the minimum sup-port is 0.04, 29 patterns were extracted. The computational time when using 1429 individual objects was 888.7 (sec) with Intel Xeon CPU 2.66GHz and 6GB RAM. While, when using prototypes of the kernel SOM, the computational time in 225 objects was 25.6 (sec).

In addition, Fig. 4 shows an example of the result of extracted damage pat-tern on the result of kernel SOM. The correspondence of the regions on the map to damage types is shown in Table 3. This damage types and frequent pe-riod are already known by the research of Fukui et al.[5]. Each damage pattern is distinguished by using different colors, and the typical waveforms and spectra of the damage type are shown.
 Valid results based on the knowledge of SOFC experts: Damagepattern1 Novel results: According to Table 2, no damage patterns which include both In this paper, we proposed the novel extraction method of co-occurrence patterns against numerical data: Co-occurring Cluster Mining . The proposed method de-termines the area (or the components) of two co-occurring clusters considering co-occurrence between clusters and simul taneously similarity in each cluster. We applied the proposed method for AE events obtained from damage evaluation test of SOFC. As a result, damage patterns which demonstrate major mechanical correlations of SOFC were extracted, including unexpected but valuable damage patterns.

Furthermore, we will apply the proposed method for various numerical data such as earthquake wave or the track of point on dynamic image, and demon-strate the general-purpose of the proposed method.
 Acknowledgements. This work was supported in part by the Management Expenses Grants for National Universities Corporations from the Ministry of Education, Culture, Sports, Science and Technology of Japan (MEXT) and also KAKENHI (21700165).

