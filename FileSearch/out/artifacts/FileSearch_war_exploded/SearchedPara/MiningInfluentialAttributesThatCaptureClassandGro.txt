 Con trast data mining is a key tool for nding di erences be-tween sets of objects, or classes, and con trast patterns are a popular metho d for discrimination between two classes. However, suc h patterns can be limited in two primary ways: i) They do not readily allo w second order di eren tiation -i.e. disco vering con trasts of con trasts, ii) Mining con trast patterns often results in an overwhelming volume of out-put for the user. To address these limitations, this pap er prop oses a metho d whic h can iden tify con trast beha viour across both classes and also groups of classes. Furthermore, to increase interpretabilit y for the user, it presen ts a new technique for nding the attributes whic h represen t the key underlying factors behind the con trast beha viour. The as-sociated mining task is computationally challenging and we describ e an ecien t algorithm to handle it, based on binary decision diagrams. Exp erimen tal results demonstrate that our technique can ecien tly iden tify and explain con trast beha viour whic h would be dicult or imp ossible to isolate using standard techniques.
 H.2.8 [ Database Managemen t ]: Database Applications| Data mining ; I.5.2 [ Pattern Recognition ]: Design Metho d-ology| Featur e evaluation and sele ction Algorithms, Design Con trast patterns, Second-order con trast patterns, Group con trast, In uen tial attributes, Emerging Patterns
Con trast mining is a key tool for nding di erences be-tween sets of objects, or classes. For example, con trasting the class of people who are admitted to hospital versus the class of people who are not admitted to hospital, migh t re-veal that young children with diab etes are overrepresen ted in the rst class compared to the second. Mining of con trasts can be useful in man y situations, suc h as when comparing sets of objects between di eren t classes, comparing sets of objects from di eren t time perio ds, comparing sets of ob-jects from di eren t spatial locations, or comparing sets of objects before and after some medical treatmen t. A well kno wn type of con trast pattern (whic h we term rst-or der contr ast ) are the emerging patterns [2]. They represen t com-binations of attribute values that have a strong abilit y to discriminate between two classes. However, existing con-trast patterns are limited in two signi can t ways. Firstly , they cannot iden tify second-order prop erties, that require the mining of `con trasts of con trasts'. Suc h information is useful for disco vering how di eren tiating factors can vary across groups. Secondly , an overwhelming num ber of pat-terns is often output from mining. E.g. in the census data set [6], millions of ( rst-order) con trast patterns that di er-entiate males from females can be disco vered, based on only the rst ten attributes in the data set. What is needed is the abilit y to summarise the meaning of a set of ( rst or second order) con trast patterns in a highly compact way.
Motiv ated by these two limitations, we address the fol-lowing two challenges ' how do we disc over and mine second-order di er ences? ' and ' how do we identify to the user those attributes which have the most imp act with respect to a col-lection of second order-di er ences? ' We prop ose two solu-tions: i) A metho d that disco vers the second-order di er-ences between con trasts for one group of classes, compared to con trasts for some other group of classes. This problem di ers from standard con trast mining scenarios, since one needs to be able to compare across groups of classes, as well as between classes. ii) A technique for ranking attributes, based on their degree of in uence within a collection of sec-ond order di erences. Suc h a ranking is far easier to inter-pret by a user, compared to returning millions of patterns. It aims to iden tify the key underlying factors resp onsible for change across groups.

Second-order di erences are meaningful in a num ber of interesting situations. Tw o motiv ating examples are:
Example 1. In the census data set [6], one might wish to ask ' what are the di erences between males and females, whic h are characteristic for one race group, but less char-acteristic for another race group? ' Alternatively, consider the domain of plant physiolo gy [12]. Plant biolo gists would Figure 1: First order di erences within groups and second order di erences across groups like to disc over ' how does the resp onse to a given treatmen t di er between the tip and base of a leaf ? ' First-or der con-trast mining disc overs treatment contr asts, comp aring leaf samples which are given a treatment, against leaf samples which are not given the treatment. Second-or der di er enti-ation then comp ares treatment contr asts with respect to the tip of the leaf, against treatment contr asts with respect to the base of the leaf.

In answ ering the rst part of our researc h question, we introduce a class of second-order con trast patterns that we will call the Group Discriminativ e Con trast (GDC) patterns . They corresp ond to patterns of con trast that strongly di eren tiate the classes in one group, but whose discriminativ e power (i.e. abilit y to di eren tiate the classes) in the other group is weak er. To explain further, consider an example of a second-order con trast for the census data set [6]. When comparing the di erences between male and female across two race groups, i.e. ' White ' and ' Non-White ', some patterns are able to strongly discriminate males and females if the individual belongs to the 'white' race group, but not if the individual belongs to the other race group. Figure 1 pro vides a conceptual diagram explaining the rela-tionship between the rst-order and second-order con trasts.
Example 2. In the census dataset, 1.5% males and 0.4% females in the 'White' population satisfy the pattern ' older than 60 years and work ed in a durable man ufacturing in-dustry '. This shows that the rule consisting of age and the industry can signi c antly contr ast males from females in the 'white' race group, sinc e ther e are 4 times mor e males than females for which the rule is true. However, this pattern does not match any individual in the 'non-white' population and henc e it is not a contr ast for that group. We say this pattern is a Group Discriminative Contr ast pattern, sinc e it is a class contr ast (betwe en male and female) for one group (`White'), but it is not a class contr ast for the other group (`Non-white').

To answ er the second part of our researc h question, we prop ose a technique for nding attributes whic h represen t the underlying factors behind second-order con trast beha viour. In particular, we iden tify in uen tial attributes, whose values can be used to nd partitions of the original groups, suc h that these partitions sho w signi can t di erences in con trast beha viour across the groups. Our work is motiv ated by the work in [8] whic h sho ws that variation in values for certain attributes may increase/decrease the discriminativ e abilit y of some con trast patterns. How to assess the degree to whic h an attribute is resp onsible in the discriminativ e abilit y of con trast patterns has so far been an open question. The num ber of con trast patterns is usually exp onen tial in the num ber of attributes, whereas the num ber of in uen tial at-tributes is smaller than the num ber of attributes.
Example 3. Recall the previous example. Supp ose the `working industry' of the individual is not include d in the pattern. In the 'White' population group, 11.5% males and 15.2% females are 60 years old, or older, and in the 'Non-White' population group, 6% males and 10% females belong to that age group. This shows that considering the age by itself does not captur e a strong contr ast in either race group. Mor eover, the industry speci c ation attribute has some de-gree of group discriminative contr ast in uenc e, sinc e when combine d with age information, it helps the di er entiation betwe en males and females in the 'White' group, but does not help the di er entiation in the 'Non-White' group. Further-mor e, if the industry attribute had a similar e e ct when com-bine d with many di er ent patterns, we would rank it highly in terms of over all attribute in uenc e.
 Challenges: A ma jor challenge of our researc h is that it is not obvious how one can dev elop a concept of second or-der con trast that is simple, intuitiv e, and useful in practice. Addressing this question is a key aim of the pap er. On the mining side, since we are disco vering the patterns of second order con trast, as well as the in uence of eac h attribute in those patterns, our mining task conceptually requires a re-peated and poten tially exp ensiv e exploration of the pattern space for eac h possible attribute. It is thus imp ortan t to be able to push constrain ts deep into the mining pro cess. State of the art: Existing work in con trast mining [2, 15] has addressed the problem of nding di erences between two classes, but it has not addressed the problem of nding dif-ferences between di erences, i.e. the second-order con trasts. In regard to ranking how in uen tial an attribute is, exist-ing feature ranking techniques suc h as entrop y or statistical measures, purely focus on the abilit y of a single attribute to determine a class lab el. They do not rank an attribute based on consideration of its participation in multi-v ariate beha viour, or on its abilit y to nd sub categories that exhibit interesting con trast beha viour. This can be very limiting and may result in imp ortan t attributes being overlo oked. e.g. Work in [9] has sho wn that attributes whic h are rank ed low according to entrop y, may still be in uen tial with re-spect to a set of con trast patterns. Our technique can un-cover suc h attributes, since the in uence of an attribute is measured with resp ect to its beha viour and participation within com binations of con trast patterns.
 This pap er mak es the follo wing imp ortan t con tributions:
Assume we have a data set D de ned upon a set of k attributes. For every attribute A i , i 2 f 1 ; 2 ::k g , the domain of its values (or items) is denoted by dom ( A i ). Let I be the aggregate of the domains items across all the attributes, i.e. I = S k i =1 dom ( A i ). An itemset is a subset of I . Let p and q be two itemsets. We say p contains q if p is a sup erset of q , i.e. p q . We require that an itemset can con tain at most one item from the domain of any given attribute.

The data set D can be pro jected to a multi-dimensional space, where eac h attribute corresp onds to a dimension in this space, and an itemset corresp onds to a subspace. The projection of p on dimension A , denoted p A , is the item in itemset p whic h belongs to the domain of attribute A , i.e. p
A = p \ dom ( A ). If p A 6 = fg , then p is called an A -dep endent itemset , or p depends on the value of attribute A . Giv en an A -dep enden t itemset p , q is the A -gener alization of p if q con tains all items in p except the item whic h belongs to the domain of attribute A , i.e. q = p n p A .

Example 4. Let p 1 = f x 0 ; y 1 ; z 1 g be an itemset that de-pends on 3 attributes, wher e dom ( A 1 ) = f x 0 ; x 1 g , dom ( A = f y 0 ; y 1 g , and dom ( A 3 ) = f z 0 ; z 1 g . The projection of p dimension A 3 is f z 1 g , and its A 3 -gener alization is f x
A dataset is a collection of transactions, where eac h trans-action is an itemset. The supp ort of an itemset p in dataset D , i.e. suppor t ( p; D ), is the fraction of the transactions in D whic h con tain p (0 suppor t ( p; D ) 1). The supp ort function is monotonic, that is, for all itemset q suc h that p q , supp ort ( p; D ) supp ort ( q; D ) .

In the con text of rst-order con trast mining, a data set con tains a positiv e class, namely D p and a negativ e class namely D n . The growth rate of an itemset p , denoted gr( p ), is the ratio between its supp ort in D p and its supp ort in D and if supp ort ( p; D n ) = supp ort ( q; D n ), then gr ( p ) gr ( q ). Giv en and threshold values, where 0 1 and 0 1, an itemset p is an emerging pattern (EP) [2] if suppor t ( p; D p ) and suppor t ( p; D n ) .
In this section, we de ne the second-order con trast char-acteristics between two groups of classes in terms of group discriminativ e con trast patterns and group discrimi-nativ e con trast in uen tial attributes , whose de nitions generalise previous work on emerging patterns (EPs). Con-sidering the data in a multi-dimensional space, an EP be-tween the positiv e and the negativ e class in a particular group corresp onds to a subspace that con tains at least positiv e instances and no more than negativ e instances from that group. Suc h a subspace may have di eren t con-trasting abilit y between the classes in another group though. Hence, before introducing our second-order con trast de ni-tions, we rstly introduce a form ula for measuring the con-trast strength of a pattern in a particular group, using a function similar to one in [3] as follo ws.
 Definition 1. Let G 1 and G 2 be two groups of classes. Each group G , G 2 f G 1 ; G 2 g , contains a positive class and a negative class. Given an itemset p and a group G , we re-fer to the positive and the negative class in G , as D p and D n , respectively. Let supp ort G ( p; C ) be the supp ort of p in class C in group G , and gr G ( p ) be the growth rate of p in group G . The con trast intensit y of p in group G , de-note d CI G ( p; D p ; D n ) , is the discriminative power betwe en the positive instanc es and the negative instanc es from group G which are containe d in subsp ace p , and is de ne d as a function of the supp ort and growth rate of p :
Let p and q be two itemsets, suc h that p q . In a given group G , the follo wing monotonic prop erties hold between their con trast intensities:
In this sub-section, we will formally de ne Group Dis-criminativ e Con trast (GDC) Patterns , whic h corre-spond to subspaces that have strong con trast intensit y be-tween classes in one group, but they have relativ ely weak er con trast intensit y in the other group. Firstly though, we de ne the follo wing measuremen t for measuring how much stronger a subspace is for di eren tiating the positiv e and the negativ e class in one group than it is for di eren tiating the classes in the other group. We refer to the rst group as the primary group , and the latter as the secondary group .
Definition 2. Let G 1 and G 2 be two groups of classes, wher e G 1 is the primary group and G 2 is the secondary group. Let D p i and D n i be the positive and the negative class in group G i , respectively. The group-discriminating power of a pattern p , denote d gCIDi ( p; G 1 ; G 2 ) , is the di er ence betwe en the contr ast intensity of p in group G and its contr ast intensity in group G 2 . gCIDi ( p; G 1 ; G 2 ) = CI G 1 ( p; D p i ; D n i ) CI G Figure 2: Subspace q is the generalization of sub-space p in dimension A 3 , where p A 3 = z 1 . A triangle represen ts a positiv e instance, a circle represen ts a negativ e instance, in the speci c group
Example 5. Figur e 2 (a) shows a subsp ace q in the pri-mary group G 1 , which contains 6 positive instanc es and 5 negative instanc es. Supp ose the total numb er of positive and negative instanc es in each group, respectively, is 10. Henc e, shows the same subsp ace in the secondary group, G 2 , which contains 5 positive and 6 negative instanc es. CI G 2 ( q ) = 0 : 23 . The group discriminating power of q , i.e. gCIDi , is 0.10, which shows that the contr ast intensity of q betwe en the positive and the negative class in group G 1 is larger by 0.10 from its contr ast intensity in group G 2 .

An itemset with a positiv e group discriminating power corresp onds to a subspace in whic h the con trast between the positiv e and the negativ e class in the primary group is stronger than the class-con trast in the secondary group. If the di erence of its con trast strength exceeds a given thresh-old, then we call that itemset a Group Discriminativ e Con-trast pattern, formally de ned as follo ws.

Definition 3. Let p be a subsp ace that corresponds to an emer ging pattern in group G 1 . Given a positive mini-mum threshold, gdc , p is a group-discriminativ e con-trast (GDC) pattern with respect to the primary group G , if its group discriminating power is at least gdc , i.e. gCIDi ( p; G 1 ; G 2 ) gdc .
In this sub-section, we de ne a measuremen t, group dis-criminativ e con trast in uence , for measuring the re-sponsibilit y (or in uence) of an attribute in the set of group discriminativ e con trast (GDC) patterns. To give an anal-ogy , a subspace can be seen as a windo w whic h captures the con trast intensit y between the classes in eac h group based on the instances whic h are con tained in that subspace. The attributes whose values are speci ed in the pattern corre-spond to the dimensions of the frame of that windo w. As one dimension is remo ved from, or added to a windo w, i.e. the value of an attribute is generalized or speci ed, its con-trast intensit y may change due to the increase or decrease in the relativ e num ber of positiv e and negativ e instances in the new windo w. Suc h an increase of con trast intensit y can thus be used for measuring the resp onsibilit y (in uence) of an attribute in a particular pattern, whic h may vary be-tween di eren t patterns and di eren t groups. Moreo ver, an attribute has some in uence in a pattern only if one of its domain values is con tained in the pattern, i.e. the pattern dep ends on that attribute.

Hence, we form ulate the follo wing requiremen ts for de n-ing the scoring function that measures the group discrimina-tive con trast in uence of an attribute: i) aggregates the at-tribute's in uence across all GDC patterns. ii) for eac h pat-tern, measures the attribute's con trast in uence in the pri-mary group. iii) for eac h pattern, measures the attribute's di erence of con trast in uence between the groups. We refer to the in uence of an attribute in a GDC pattern as its local in uenc e , and the group-discriminativ e con trast in uence of an attribute, or the in uence of an attribute across all the GDC patterns, as its glob al in uenc e . In the remainder of this section, we use the general term pattern for referring to a GDC pattern, unless stated otherwise.

Definition 4. Given an attribute A , and a pattern p such that p is A -dep endent, the local in uence of A in p , denote d localIn uenc e( p; A; G 1 , G 2 ), measur es the attribute's group discriminative contr ast (GDC) in uenc e locally in sub-space p . Given the set of all A -dep endent GDC patterns, S the global in uence of A , glob alIn uenc e( S A ; A; G 1 aggr egates the GDC in uenc e of A across all patterns in S i.e. globalIn uence ( S A ; A; G 1 ; G 2 ) =
If localIn uenc e ( p; A; G 1 ; G 2 ) &lt; 0, we say that attribute A has a negativ e in uence in p , as it sho ws that the inclusion of attribute A weak ens the group discriminating power of p . If glob alIn uenc e ( S A ; A; G 1 ; G 2 ) &gt; 0, then A is a Group Dis-criminating Con trast In uen tial Attribute , or GDC In uen tial Attribute for short, whic h means that A -dep enden t patterns exist, and the inclusion of dimension A strength-ens the overall group discriminating power of those patterns. An attribute's local con trast in uence in a group : We now describ e the measuremen t of the local in uence of an attribute in a subspace, based on the follo wing de nition of contr ast in uenc e , that measures the gain in the con trast intensit y of the subspace, as a result of including that at-tribute in its dimensions.

Definition 5. Given group G . Let D p and D n be the positive and the negative class in G . Let A be an attribute, p be an A -dep endent pattern, and q be its A -gener alization. The local con trast in uence of A in p is the contr ast intensity gaine d from its A -gener alization.
 CIGain G ( p; A; D p ; D n ) = CI G ( p; D p ; D n ) CI G
In the given group, a positiv e (resp. negativ e) CIGain of attribute A in subspace p sho ws that specifying the value of attribute A in p strengthens (resp. weak ens) the class-discriminating abilit y of subspace p . This can be used for measuring the con trast in uence of an attribute in the pri-mary group (satisfying requiremen t 2 of the scoring func-tion). However, it is a group measuremen t, whic h does not tell us about the di erence in in uence of the attribute with resp ect to the secondary group (requiremen t 3 of the at-tribute's in uence scoring function).
 An attribute's local con trast in uence di erence be-tween groups : The follo wing form ula measures the relativ e local in uence of attribute A , in terms of how much group-discriminating power is gained as a result of specifying the value of attribute A in a pattern.

Definition 6. Let p be an A -dep endent pattern, and q be its A -gener alization. The group-discriminating in u-ence of attribute A locally in p , denote d gCIDi Gain , is the gain in the group discriminating power of p with respect to its A -gener alization. gCIDi Gain( p; A; G 1 ; G 2 ) =
Example 6. Recall the subsp ace examples in Fig. 2. In group G 1 , CI G 1 ( p; D p 1 ; D n 1 ) = 0 : 42 and CI G 0 : 33 . Thus, attribute A 3 has a positive contr ast in uenc e of 0.09 in p . In group G 2 , attribute A 3 has a negative con-trast in uenc e of -0.17. Thus, the group-discriminating in-uenc e of A 3 is 0.50, i.e. gCIDi Gain ( p; A 3 ; G 1 ; G 0 : 33 ( 0 : 17) = 0 : 50 , which shows that the inclusion of attribute A 3 in p incr eases the betwe en-gr oups di er ence of its ability to captur e contr ast betwe en the classes.
Furthermore, gCIDi Gain( p; A; G 1 ; G 2 ) also measures how much larger is the con trast in uence of attribute A in the primary group than its con trast in uence in the secondary group, locally in subspace p . Re-writing gCIDi Gain() in terms of the con trast intensities of the subspaces, we have gCIDi Gain ( p; A; G 1 ; G 2 ) Scoring function form ulation : Let A 1 and A 2 be two attributes. If A 1 has a larger (resp. smaller) group discrim-inating in uence than A 2 , locally in a given pattern, the con trast in uence of A 1 in the primary group is not neces-sarily larger (resp. smaller) than A 2 . Thus, to satisfy both requiremen t 2 and requiremen t 3 of the scoring function, we further de ne the group-discriminating in uence ratio , denoted gCIDi GainR, that measures the relativ e between-groups di erence of the in uence of attribute A with resp ect to its in uence in the primary group, locally in pattern p : gCIDi GainR( p; A; G 1 ; G 2 ) = j gCIDi Gain ( p; A; G 1
Note that the absolute value of the group discriminating in uence is used in gCIDi GainR() to preserv e the posi-tive/negativ e sign of the attribute's in uence in the primary group. Using this measuremen t, attribute A 1 is more in u-ential than attribute A 2 if the between-groups di erence of con trast in uence of A 1 is larger than A 2 , relativ e to their resp ectiv e con trast in uence in the primary group.
Finally , we can re-write the global group discriminativ e con trast (GDC) in uence, given an attribute A , and a set S
A whic h con tains A -dep enden t GDC patterns, as: globalIn uence( S A ; A; G 1 ; G 2 ) =
A positiv e global in uence indicates that an attribute has help ed strengthening the overall group discriminating power of the GDC patterns. Hence, suc h an attribute is a key fac-tor in the con trast beha viour of those patterns. To nd a ranking of GDC in uen tial attributes we sort the at-tributes so that the attribute with the largest score of global GDC in uence is the most-in uen tial attribute. Some of the GDC patterns used for measuring the global in uence may corresp ond to overlapping subspaces. Overlaps cannot be straigh tforw ardly eliminated, since all GDC patterns may poten tially a ect the con trast intensit y of the subspace, as well as the in uence of an attribute in that subspace. It is worth noting that overlaps are not necessarily problem-atic though, since classi ers based on emerging patterns al-low overlaps, but have still pro ven extremely successful (e.g. [3]). More sophisticated techniques for handling overlaps are beyond the scop e of this pap er.

Table 1 sho ws the characteristics of eac h measuremen t de ned in this section. The con trast intensit y and group discriminating power dep end on only a single pattern, the con trast in uence and the group discriminating in uence de-pend on a pattern and an attribute. In terms of the group-dep endency , the con trast intensit y and con trast in uence are within-group measuremen ts as they dep end on a single group, whilst the group discriminating power and the group discriminating in uence are between-groups measuremen ts.
This section introduces our algorithm, called mineGDC , whic h nds group-discriminativ e con trast (GDC) patterns and their in uen tial attributes. Before we describ e our al-gorithm in detail, let us consider a naiv e algorithm that con-sists of three steps: i) nd all the emerging patterns (EPs) in the primary group; ii) apply the GDC constrain t on those patterns, i.e. calculate their con trast intensities; iii) for eac h attribute, nd the dep enden t patterns and calculate the at-tribute's in uence in those patterns. This naiv e mining ap-proac h can su er from signi can t redundancy , because not all of the EPs satisfy the GDC constrain t, and man y pat-terns dep end on sev eral attributes. Our technique integrates those three steps and nds the GDC patterns while sim ul-taneously calculating the in uence of eac h attribute. Mining challenges: Our mining task is challenging due to three reasons: i) It explores both the pattern space (for nding the GDC patterns) and the feature space (for nd-ing the GDC in uen tial attributes). Since the feature space has O ( n ) searc h space, where n is the num ber of features, and the pattern space has O (2 n ) searc h space, performing the searc h in both spaces can be space and computationally exp ensiv e. None of the existing pattern mining or feature selection techniques deal with both searc h spaces sim ulta-neously , whic h is a notew orth y feature of our algorithm. ii) Mining patterns with a GDC constrain t is challenging be-cause it dep ends on relativ e measuremen ts of con trast inten-sity di erences and ratio across groups. Suc h a constrain t cannot be easily handled using the existing con trast pattern mining techniques, suc h as in [10], as they can only han-dle one positiv e and one negativ e class. iii) The in uence scoring function for an attribute dep ends on the con trast intensit y di erences between eac h pattern and its general-ization, and also the ratio of suc h di erences across groups, whic h increases the computational complexit y.

We address those challenges using a compact and ecien t database represen tation, called a Weigh ted Zero-suppressed Binary Decision Diagram (WZDD) [11], whic h is a directed acyclic graph (DAG) data structure and has previously been used for ecien t frequen t pattern mining. WZDDs are use-ful for mining the second-order con trast, since they allo w compact represen tation and ecien t manipulation of the multiple classes and their intermediate pro jections. Overview of mineGDC : To give a general overview, our mining framew ork follo ws a pre x gro wth mec hanism whic h is typically used in the classical mining framew ork for nd-ing frequen t patterns [11], and EPs [10]. It recursiv ely gro ws pre xes of the patterns and pro jects conditional databases whic h con tain subsets of the database whic h are relev ant to eac h pre x, allo wing ecien t supp ort calculation. The classical infr equent pre x pruning strategy for nding EPs prunes a pre x (and its supsersets) if its supp ort in the pos-itiv e class is less than the minim um threshold. The exist-ing framew ork cannot solv e our mining challenges, since the GDC constrain t dep ends on 4 databases (i.e. two classes from both groups). Our technique pro jects secondary databases for all of those four classes for eac h pre x. To ecien tly cal-culate the GDC in uence calculation for all attributes, the global in uence score is updated as soon as a GDC pattern is found, for eac h attribute whose values are con tained.
Based on the monotonicit y of con trast intensit y, if the supp ort of an itemset in the positiv e class is 0, then its con-trast intensit y and its sup ersets' are also 0. Therefore, when performing the conditional database pro jections, we order the classes so that the negativ e class (from eac h group) is pro jected only if the conditional positiv e class is not empt y.
A Weigh ted Zero-suppressed Binary Decision Diagram [11] (WZDD) is a DAG of lab eled nodes and weigh ted edges. It consists of one source node, multiple internal nodes, and two sink nodes, sink-0 and sink-1, resp ectiv ely. Eac h internal node has two child nodes, and it may have multiple paren t Figure 3: Examples of WZDD databases; D1 = ordering: a &lt; b &lt; c &lt; d &lt; e nodes. The nodes are ordered so that the lab el of a node's children must be of higher index than the paren t node. An internal node N with lab el x , denoted N = node ( x; N x enco des the set of itemsets S , s.t. S = ( x S x ) S S where N x enco des set S x , and N x enco des S x . The op-eration ( x S x ) denotes a set-m ultiplication between x and S . Sink-0 enco des the empt y set ( ; ); sink-1 enco des the set of empt y itemsets ( f;g ). Eac h path to sink-1 repre-sen ts an itemset in the database. The weigh t of N , denoted weight ( N ), refers to the weigh t of the edge incoming to N whic h represen ts the total supp ort of the itemsets in S .
WZDDs merge all iden tical nodes for ensuring that eac h node is unique (canonical), whic h is also enforced across mul-tiple WZDDs. The eciency of WZDD routines relies on its cac hing mec hanism whic h stores the result its intermediate computations, so that the computed result can be re-used if the computation is re-visited. Fig. 3(a) and (b) sho w two WZDDs whic h represen t two databases D1 and D2, that con tain itemsets (with their supp ort values): D1 = f abe:2, ace:1, ab:1 g , D2 = f abc:2, bce:1, be:1 g . The merged WZDDs (in Fig. 3(c)) share the bottom node e . Solid lines link eac h node N to N x , and the dotted lines to N x . Sink-0 nodes are omitted from the illustrations in this pap er.
We will describ e our mining algorithm as sho wn in Al-gorithm 1. The input databases corresp ond to the classes from both groups, represen ted as WZDDs. The positiv e class in the primary group serv es as the pattern gener ator , since pre xes of the patterns are pre xes of the itemsets in this class. Pre xes are recursiv ely gro wn using the item in the top node of the pattern generator. For eac h pre x, con-ditional database pro jections are performed for eac h input database, using the WZDD routines de ned in [11] (line 3). Once the curren t pre x item and its sup ersets have been pro cessed, the databases are reduced (line 4) to remo ve the curren t item. Let x be the top-item whic h belongs to the domain values of attribute A . Patterns whic h con tain x are found from the conditional databases (line 5-6), all of whic h are A -dep enden t. Thus, the in uence of attribute A can be incremen ted immediately after all patterns that con tain x have been found (line 7-8), allo wing the in uence of all the attributes to be found as the algorithm returns. Detailed ex-planation about the in uence calculation will be given later.
Once all patterns that con tain the top-item have been found, other pre xes are gro wn from the reduced databases (line 9-10). The recursion terminates when the longest pre-Algorithm 1 Mine GDC patterns and calculate the GDC in uence of eac h attribute 5: Gro w pre xes whic h con tain item x : 12: return resul t 13: Terminal cases: 16: Chec k GDC-constrain t on pref , using its supp ort* 17: in eac h class 18: if ( pref is a GDC pattern) then return sink-1 19: else return sink-0 20: end if x for a particular candidate pattern has been found (line 14), or when the pattern generator is empt y (line 21). For eac h fully gro wn candidate pattern, let it be pref , the GDC-constrain t is chec ked (line 16-17) based on its supp ort in eac h class whic h is represen ted as the weigh t of the WZDD node represen tation. To include pref in the nal output node, a sink-1 is returned (line 18), whic h incremen tally builds up the nal output WZDD. Finally , the output node con-tains the GDC patterns found from both the x -conditional databases and from the reduced databases (line 11). Up dating an attribute's in uence: The pro cedure sho wn in Algorithm 2 calculates the in uence of attribute A in a given set of A -dep enden t patterns, given all of those pat-terns con tain the particular item r whic h is an item from the domain of A . The inputs are four databases, the rst two corresp ond to the r -conditional databases for nding the con trast intensities of the patterns, the next two databases corresp ond to the reduced databases whic h exclude item r for nding the con trast intensities of the generalized pat-terns. The framew ork is similar to the pattern gro wth frame-work, whic h recursiv ely pro jects conditional databases for eac h class, but the pro jections are guided by pre xes of the given patterns (line 1-8). The in uence calculation is performed when it nds the database pro jections for the longest pre x of a particular pattern (line 11-21). Using the pro jected conditional databases represen ted as WZDDs, the con trast intensit y and the con trast in uence of the attribute can be easily computed using the pattern's supp ort values whic h corresp ond to the weigh t of the relev ant WZDDs.
The eciency of this pro cedure relies on the use of WZDD's cac hing mec hanism whic h allo ws intermediate computations, Algorithm 2 Calculate the GDC in uence of item r in P 9: return 10: Terminal cases: 11: Case 1: P con tains an empt y itemset 14: A -generalization of pref 15: Calc. gCIDi for pref : 19: A = the attribute whose domain con tains item r 20: Update the global GDC in uence of attribute A : 22: return 23: Case 2: P is empt y: return suc h as pro jecting secondary databases, to be shared across functions. So, the database pro jections performed in calcIn-uence() may re-use the cac hed results from the database pro jections performed in mineGDC(), and vice versa, whic h avoids redundan t computations.
In this section we evaluate our metho d and the perfor-mance of our algorithm for mining second-order con trasts. Our algorithms were implemen ted in C++, using the WZDD library routines dev elop ed in [11]. All exp erimen ts were con-ducted on two Intel Xeon 3 GHz CPUs, 4 GB RAM, running Solaris. We carried out exp erimen ts on two real UCI data sets [6]: census and satimage. The objectiv es of our exp er-imen ts include: i) to compare the volume of GDC patterns with emerging patterns (EPs), ii) to evaluate our prop osed GDC based attribute ranking by comparing it against other metho ds; iii) to sho w that meaningful con trast in uen tial attributes can be disco vered by our metho d; iv) evaluate the run time performance of our mining algorithm. In the census data set, we choose to nd the rst-order di erences between male (as positiv e class) and female, and the second-order di erences between two race groups: 'White', and the other races (com bination of all other races in the data set) whic h we lab el as 'Non-White'.
 Patterns volume comparison: Figure 4(a) sho ws the num ber of patterns in the census data set using the rst 20 attributes, with GDC-constrain t: = 1%, = 0 : 5%, and a varying gdc , i.e. the minim um group discriminating power. In the 'white' race group, there are 5 million EPs. When gdc is very small, almost every EP is a GDC pattern. As gdc increases to 0.05, the num ber of GDC patterns drops by roughly 10% from the EPs. We iden tify 17 GDC in uen-tial attributes in suc h a scenario (sho wn in Table 3a). The satimage dataset has similar trends for the pattern volume comparison (sho wn in Figure 4b). The num ber of GDC pat-terns can still be overwhelming, but our technique can nd the attributes whic h help explain the second-order con trast beha viour of those patterns, whic h we will discuss shortly . Ranking comparison: The census data set con tains sev-eral household attributes and income attributes describing census data from the year 1970. With threshold values = 1%, = 0 : 5%, and gdc = 0.05, we found 17 in uen-tial attributes for capturing group discriminativ e con trasts with the 'white' race group as primary group (Table 3a), out of 20 attributes whic h are included in our exp erimen t. To evaluate our attribute ranking, we compare it against other rankings whic h are based on entrop y measure [5], and the statistical Pearson's correlation measure.

The entrop y-based ranking is based on the information gain of an attribute, whic h measures its abilit y to impro ve class discrimination. The columns in Table 4 sho w the info gain of eac h attribute in eac h group, and the info-gain dif-ference across the groups, lab eled IGDi . Attributes group-quarter-typ e (i.e. the type of housing) and marital-status app ear in the top-5 attributes in our GDC based ranking as well as in this entrop y-based ranking. It sho ws our technique is able to iden tify suc h attributes whose male-vs-female dis-crimination abilit y is stronger in the 'white' group than their discrimination abilit y in the other group. Group quarter and farm attributes, whic h are highly rank ed by entrop y, how-ever, are not iden ti ed by our metho d. It suggests that patterns con taining those attributes have weak group dis-criminating con trast in uence. If we look closer at their info gain di erences, the values are actually very small, whic h means that there is no signi can t di erence of their class dis-crimination abilit y across the groups, explaining why they are not iden ti ed by our metho d. Our attribute ranking iden ti es other in uen tial attributes whic h have low ranks in the entrop y-based ranking, whic h sho ws the abilit y of the GDC based ranking to iden tify the interdep endency between multiple attributes, whereas an entrop y measure treats eac h attribute indep enden tly. Later in this section, we will sho w a more interesting result regarding those attributes whose entrop y-based ranks are lower than their GDC-based ranks.
The top-10 attributes found using a correlation measure are listed in Table 5. For eac h attribute, Corr ( g ) is the Pearson's correlation coecien t between the values of that attribute in the positiv e class and the values of that attribute in the negativ e class in group g . A large correlation value indicates that an attribute is a poor class-discriminator in g , because its values vary closely between the classes. The score of correlation di erence between groups, denoted Cor-rDi = Corr( G 2 ) -Corr( G 1 ), measures how much an at-tribute correlates with the classes in the secondary group, but does not correlate with the classes in the primary group. The most in uen tial attribute in our ranking(see Table 3a), i.e. group-quarter-typ e , has a negativ e correlation di erence score, meaning that it is a weak er class discriminator in the primary group compared to the secondary group. Lik e the entrop y measure, this result sho ws that a correlation mea-sure does not to iden tify the interdep endency between mul-tiple attributes, whic h can be iden ti ed by our metho d. A meaningful disco very: The attributes whic h are in u-ential for capturing GDC patterns when the 'white' race is chosen as primary group are sho wn in Table 3a. The GDC in uen tial attributes when the 'non-white' race is chosen as primary group are sho wn in Table 3b. Attributes that have positiv e global GDC in uence for one race group but have zero or negativ e in uence in the other group are mark ed by asterisks (*). Interestingly , the rst two attributes, group-quarter-typ e , (i.e. type of housing), and num-of-families-in-household , are the top-2 attributes in both groups, suggest-ing that they have an equally high imp ortance for nding group-discriminativ e male-vs-female con trast in eac h group.
Based on the GDC based ranking for eac h race group, at-tribute monthly-r ent app ears to be in uen tial only for the 'white' race and not for the other race group. Since it does not app ear in the top-5 attributes in the other rankings (i.e. entrop y-based and correlation-based), it sho ws that when considered individually , it does not di eren tiate the male and female di erences across groups. However, our ranking suggests that monthly-r ent can help capture the group dif-ferences when it is com bined with some other attribute(s) within GDC patterns. To give a speci c example, we found that specifying monthly rent in the follo wing rule: ' do not live with a spouse, and monthly rent &gt; $ 125, ' increases the between-groups di erence of this rule's male-vs-female discriminating abilit y. Based on this rule, some-one who does not live with a spouse and pays high mon thly ren t, is more likely to be a male in the 'white' race group, but without considering monthly rent , it is equally likely that the individual is a male or a female, in either race group. This example sho ws that a GDC in uen tial attribute can help iden tify imp ortan t sub-categories (corresp onding to GDC patterns) in the population, suc h as a category of people who do not live with a spouse and pay high mon thly ren t, in whic h there is a strong di eren tiation between male and female in the 'white' race group but there is not a strong dif-feren tiation between male and female in the other group 1 Time performance of mining algorithm: We measure the run time performance of our algorithms for mining the GDC patterns and their in uen tial attributes in the census and satimage data sets, with a varying minim um group dis-criminating power threshold, gdc . Table 2 sho ws the class sizes in eac h data set. We implemen ted 2 algorithms: i) naive : a two-phase algorithm whic h nds the GDC patterns, then for eac h attribute, calculates its in uence by pro ject-ing the relev ant patterns. ii) mineGDC : the algorithm de-scrib ed in Sec. 4.3 whic h sim ultaneously nds the in uen tial attributes in the pattern mining phase. Figures 5a and 5b sho w the run time for eac h algorithm from the two datasets. When gdc is high, there exist only a few patterns, for whic h both algorithms have similar run time. As gdc decreases, the mineGDC algorithm can achiev e up to 4 times speed up than the naive algorithm, since mineGDC visits patterns whic h
This rule corresp onds to our intuition since it is likely that there are much more white people who pay high ren t than non-white people, hence, the amoun t of ren t is more useful for discriminating male and female in the white population than it is for the non-white population.
Figure 4: Comparison between the num ber of GDC patterns and emerging patterns
Figure 5: Run time comparison between mineGDC algorithm and naiv e algorithm
Table 4: Attribute ranking by group information gain (IG) di erence; G1='white' race group, G2 = 'non-white' race group
Table 5: Attribute ranking by group correlation dif-ference; G1 = 'white' race group, G2 = 'non-white' race group are shared by numerous attributes only once. This sho ws that the attribute's in uence calculation can be performed ecien tly using our technique, as WZDD allo ws multiple re-use of intermediate database pro jections when nding the patterns and calculating the in uence of the attributes.
Our metho d for measuring an attribute's in uence is pat-tern based, whic h has not been addressed in previous work. Existing feature selection techniques have a common objec-tive of nding attributes whic h are most relev ant to the data classi cation. Entrop y [5] based techniques measure the class discriminating abilit y of an attribute indep enden tly of the other attributes. A recen t work [7] prop oses a correlation-based technique for nding a set of features whic h have high inter-correlation among themselv es, and low correlation with the other features. Their metho d for measuring the signif-icance of an attribute-set may be used for measuring the discriminating abilit y of an attribute in rst-order con trast as well as second-order con trast. The di erence, however, is that our mo del can iden tify subspaces, instead of the entire data space, in whic h second-order con trast occurs.
Group discriminativ e con trast patterns being iden ti ed in this pap er corresp ond to subspaces of high class-con trast in the primary group and low class-con trast in the secondary group. Mining interesting subspaces has been previously studied for solving other data mining problems, suc h as in [1] for nding outliers in high-dimensional data sets. However, there has not been any work whic h addresses the problem of second-order di eren tiation. Work [13] addresses the prob-lem of nding con trast sets, whic h are rst-order con trasts between multiple groups (i.e. classes) of data instances.
Work in [2, 15], prop osed techniques for nding ( rst-order) con trasts between classes. Moreo ver, work in [14] studies a technique for comparing frequen t patterns between classes, whic h may be extended to comparing con trast pat-terns between groups. However, their metho d cannot iden-tify the in uence of eac h attribute that causes the di er-ences, whic h is a novel asp ect of our technique. Previous work in [4] uses 2 -test to measure the signi cance of an item in the discriminating power of an emerging pattern. Suc h a measure may be used for measuring the attribute's local in uence in a pattern in a given group of classes, but unlik e our metho d, the 2 measure is indep enden t to whic h class is chosen as the positiv e (or negativ e) class.
To conclude, we have introduced a metho d for nding attributes whic h are in uen tial for capturing con trast be-tween classes in a group, as well as the (second-order) con-trast across groups, whic h we call group discriminativ e con-trast (GDC) in uen tial attributes. Our exp erimen ts sho wed that our metho d can overcome the limitation of classical at-tribute selection techniques, whic h do not tak e into accoun t the inter-dep endency between multiple attributes whic h may vary between patterns, and across groups. Using our metho d, moreo ver, an in uen tial attribute can help explaining the key underlying factors of the con trast beha viour that is found in certain data sub-categories, instead of considering the en-tire data as in other classical feature selection techniques. We prop osed a mining algorithm based on the use of a DAG data structure, namely the Weigh ted Zero-suppressed Bi-nary Decision Diagram, whic h explores both the pattern space and the feature space sim ultaneously , and allo ws com-pact represen tation and ecien t pro jections of multiple data-bases. For future work, variations for the attribute's in u-ence measuremen ts may be interesting to investigate,and ex-ploring the usefulness of the in uen tial attributes for solving multiple-class classi cation problems.

