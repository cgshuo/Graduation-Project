 In recent years, Social networks have become part of our life. When users join a new social network, their first impressions are very important to keep them active in this network. Thus how to predict future links for new users according to the current snapshot of the network is significant.
 simple topology features such as the number of common neighbors and the Weak ties and interaction activities can also be useful for inference [ 2 , 3 ]. Actually, nodes in a social network often have abundant attributes such as time and location [ 4 ]. In addition, geographic distance has been shown to play an and node attributes are used simultaneously to improve prediction performance. Many of the current studies mainly focus on a single social network. However, sometimes data in one network is not sufficient to train a good classifier. In particular, when users join a new network (target network), link prediction will encounter the cold start problem [ 8 ]. But if we can use data from another network (source network), the prediction performance should be better intuitively. In general, there are two ways to utilize the source network to help prediction, one is based on transfer learning through different feature spaces and the other is based on the factor graph. In the transfer learning method, items having both features in source space and target space are utilized [ 9 ]. The factor graph method uses the phenomenon that different social networks obey common rules such as triad social balance and triad status balance [ 10 , 11 ]. The works [ 9  X  11 ] focus on information transfer between two different types of networks . A widespread phenomenon is that some social networks are similar to each other except for some specific services. Users often have accounts in multiple social networks to enjoy distinctive services. Networks connected by accounts of same users are aligned networks. Link prediction for new users in aligned important fact that user-user relationships affect each other is ignored. In this paper, we study the link prediction problem for new users in target network from a new perspective. And the aligned source network is utilized to solve the cold start problem. Our method can get good prediction performance estimated by Area Under Curve ( Auc ) and Accuracy ( Acc ). The contributions can be summarized as follows: -Three categories of local features and one category of global features are selected, which describe the social networks accurately and reflect the edges interaction. These features play an important role in improving prediction performance. -An Aligned Factor Graph ( AFG ) model is proposed to solve the link pre-diction problem for new users in target network, making full use of a similar source network. It performs well when we encounter the cold start situation.
In addition, in order to control the scale of the factor graph and guarantee an efficient inference, Aligned Sturcture Algorithm is used in building model. -Experiments on two real social networks -Twitter and Foursquare are carried out and results show that AFG model improves prediction performance by utilizing source network data when compared with the Basic Factor Graph ( BFG ) model. And AFG model performs better than SCAN-PS model [ 12 ]. This paper is organized as follows: Section 2 gives basic definitions and related works in link prediction. Meanwhile, BFG model is introduced. Section 3 is our pre-diction method. Aligned Factor Graph ( AFG ) model is proposed and the Aligned Structure Algorithm is demonstrated. Besides, the parameter learning algorithm and feature selection are discussed. Section 4 includes some experimental results and analysis. Section 5 is the conclusion. Definition 1. (Aligned Heterogeneous Networks [ 12 ]): Let V same kind of nodes in network G k , V k =  X  i V k i is the set of different kinds of nodes. E k =  X  i E k i is the set of different kinds of edges. Let f be a one-to-one mapping between user u s i  X  U s  X  V s in the source network and user u in the target network, if  X  ( F =  X  i,j f ( u s i ,u t j )) = G t =( V t ,E t ) are called aligned heterogeneous networks. The link ( u called an anchor link and all these links form the set of anchor links E Definition 2. (Edge Descriptor): An edge e ij can be described as d where l ij is the edge label belonging to { 0 , 1 } , p ij this label. l ij =0 means the edge does not exist.
 Definition 3. (Triad Social Balance [ 14 ]): Undirected edges between three users form a triad. It is social balanced if three or one edge exists.
 Definition 4. (Triad Status Balance [ 15 ]): Directed edges between three users form a triad. It is status balanced if three edges are not in a directed cycle. target network. In [ 16 ], relationship prediction is studied under space feature transfer learning framework and inter-domain edges are enhanced by discover-ing new edges and strengthening existing ones. In [ 17 , 18 ], domain connection sparsity and data non-consistent problem are studied .
 between two different networks [ 10 ] and the BFG model [ 11 ] is used. Friend recommendation problem is solved by limiting friend candidates in two hops to keep factor graph in bearable scale [ 11 ]. And parameters of triad features are the same in source and target networks during training.
 and factor nodes. In the BFG model, the user-user relationship e u i and u j is mapped to a variable node v ij in the factor graph, while variable nodes connecting to the same factor node reflect the interactive influence between relationships X  formation. A simple explanation for BFG model is shown in Fig. 1 . We try to solve the link prediction problem for new users in target network by utilizing data of aligned heterogeneous source network. Firstly, we extend the BFG model to the Aligned Factor Graph ( AFG ) model. Besides, the Aligned Structure Algorithm is used for controlling factor graph scale when building the model. Secondly, the parameter inference framework is proposed. Thirdly, a detailed parameter learning algorithm is studied. Fourthly, new user links are inferred by maximizing an objective function. At last, both local and global features used in prediction are given. 3.1 The Aligned Factor Graph Model The AFG model is also a two layer model. The first layer is composed of two observations deriving from source network G s and target network G layer is a factor graph containing two aligned parts FG = intuitive description of AFG model is shown in Fig. 2 . The two networks in the first layer are fully aligned networks. Relationships between each pair of users are taken into consideration. Thus we can also find one-to-one mappings between variable nodes in FG s and FG t . Moreover, if variable node v is unknown in FG t , the structure of v t j must be the same with the structure of the corresponding variable node v s i in FG s . Local features belonging to variable nodes in the second layer can be got according to the corresponding edges X  attributes in the first layer. Global features belonging to factor nodes are drawn from the edge cycles in the first layer, determining the factor graph structure. Building AFG model efficiently is important for prediction. Firstly, the first layer observations can be got easily given G s and G t . Secondly, states of all variable nodes in the second layer are determined according to the observa-tions. state =1and state = 0 variable nodes are state-known variable nodes while state =? variable nodes belong to the state-unknown set. Thirdly, for combinations of state-known variable nodes satisfying global features defined in section 3.5 , we build a factor node and connect it with the variable nodes in this combination. Fourthly, take the state-unknown variable nodes into considera-tion. If we build a factor node for each combination of variable nodes, the factor graph scale will be too large and the complexity will be too high. However, if we build a factor node and connect it with variable nodes randomly, the prediction performance will decrease. In this paper, Algorithm 1 is used to determine the accurate structures of state-unknown variable nodes. 3.2 Parameters Inference Framework The first layer can be built given source network G s =( U network G t =( U t ,E t ,A t ), where U s ,U t are the sets of users, E to edges. According to the observations in the first layer, a factor graph FG = { where V s ,V t are the sets of variable nodes, F s ,F t are the sets of factor nodes and EF s ,EF t are the edge sets. In network G t (so does G associated with an attribute vector a t ij  X  A t and is mapped to a variable node v marginal probability. As all edge descriptors in G s are known while only part of edge descriptors in G t are known, the link prediction problem can be described as maximizing the following probability where G t is the target network, G s is the source network. D sets of edge descriptors in G t ,G s .
 Algorithm 1. Aligned Structure Algorithm Input: Source network G s , Target network G t Output: FG = { FG s  X  FG t } 1: for all Combinations of state-unknown variable nodes ( v 2: Find v t p ,v t q  X  X  one-to-one mapping variable nodes v 4: Build a factor node f t n and connect it with v t p ,v 5: end if 6: end for 7: for all Combinations of state-unknown variable nodes ( v 8: Find v t p ,v t q ,v t r  X  X  one-to-one mapping variable nodes v 10: Build a factor node f t n and connect it with v t p ,v 11: end if 12: end for The two kinds of features can be instantiated using the Markov Field or the Bayesian Theory . In this paper, the Hammersley-Clifford Theorem [ 20 ]isused and the two probabilities are defined as where Z 1 ,Z 2 are the normalization factors, k is the local attribute index, a represents the k th attribute in attribute vector a ij . G ( v c =3. r k is the k th local feature function. For example, it can be a function calculating common neighbor number. h d is the d th global feature function. For instance, if a triad is social balanced, h d =1.  X  k , X  d Then the joint probability defined by Eq. ( 1 ) can be written as where Z is normalization factor. Thus, the source and target networks union objective function is Algorithm 2. Learning Algorithm Input: Learning Rate  X  Output: Model Parameters  X  1: repeat 4: Calculate gradient according to Eqs. ( 6 ) and ( 7 ); 5: Update parameter set  X  with learning rate 7: until Converage 8: Output  X  where U t new is the set of new users, U t all is the set of all users in G We try to find parameter set  X  =(  X ,  X  ) that maximizing the objective function. 3.3 Learning Algorithm In order to solve the objective function, the gradient decent algorithm is used. As Z is the normalization factor, all variable nodes X  likelihoods in the factor graph need to be calculated including the state-unknown variable nodes. The gradients of parameters are calculated as follows where a st n is local attribute vector associating with variable node v model X  X  second layer and v st m is the m th variable node. D descriptors and D tl is the set of known descriptors. E p is the expectation of the local function given all known descriptors of edges, the factor graph has different topology, it is hard to directly calculate the second part. In this paper, we use Loopy Belief Propagation ( LBP )[ 21 ] to approximate the gradients. With LBP , the marginal probilities of different states of variable nodes can be calculated. After this, we sum over all nodes to obtain the gradient. The detailed algorithm is shown in Algorithm 2 . 3.4 New User Link Inference Model parameters  X  can be got through learning. Then new user link inference problem is defined as finding the descriptors that maximizing the probability where D tu is the set of unknown edge descriptors, D tl is the set of known edge descriptors. The LBP algorithm is used to compute the marginal probability of each variable node v st i in factor graph. And we choose the state l larger marginal probability p st i = max { p (0 |  X  ) ,p (1 descriptor correspinding to variable node v st i is d st i Time cost is also very important when applying the prediction framework. If n users exist in social network, building AFG costs O ( n the whole prediction algorithm can be finished in polynomial time. 3.5 Feature Selection Table 1 is a list of all local features. As the networks we study are heterogenous and contain different types of data, three categories of local features can be selected, namely topology feature, location feature and time feature. s stands for source user and t stands for target user of an edge. FI who follow user t and F t is the set of users whom user t follows. Loc vector of user t , each element is the user X  X  visited number of this location. Tim is time vector of user t with length 24, corresponding to the 24 hours of a day. Taking the interactive effects of edges into consideration, one category of global features is drawn. We find that more than 90% triads in our data set are triad social balanced and triad status balanced. According to this observation, we choose the global features in Table 2 .
 4.1 Experiment Settings and Results We use Twitter and Foursquare data sets and the same method as [ 12 ] to divide data for 5-cross-validation. Firstly, we randomly choose 1000 users to form two fully aligned networks. Secondly, 20% of users are chosen as new users. Thirdly, all existing friend relationship edges related to new users are put into an existing link set, equivalent number of non-existing friend relationship edges are put into non-existing link set. Fourthly, both the existing link set and the non-existing just keep balance when expanding the two link sets. The ratio of new users X  data used for training is defined as user novelty. Ratio 0 . 0 means brand-new users. All relationships related to new users are sampled according to the setting novelty. Prediction (TRAD) and Supervised Cross Aligned Networks Link Prediction with Personalized Sampling (SCAN-PS) proposed in [ 12 ] are used as baseline methods. SCAN-PS merges features extracted from the anchor link in source network to expand the feature vector of corresponding link in target network to train a classifier. Auc and Acc are the performance evaluation criteria. Detailed comparative models and main results are shown in Table 3 . 4.2 Performance Analysis Fig. 3 is the results of first group experiments. Twitter is the target network, Foursquare is the source network in this group experiments. -In Fig. 3 ( a ), BFG model performs worse than TRAD model in Auc because there are many state-unknown variable nodes in target network, the fac-tor graph structure can not be decided accurately. Inaccurate factor graph structure decreases BFG model performance, but it has no effect on TRAD model, which only makes use of the local features. As Twitter is follow-follow network, users having most fans play important role in network formation. That is the reason why we get high Auc and Acc when user novelty is 0 . 0. -In Fig. 3 ( b ), AFG model performs better than SCAN-PS model both in Auc and Acc . That is because source network information expands the train-ing set and Aligned Sturcture Algorithm determines accurate factor graph structure. -AFG model uses Foursquare to help new user link prediction in Twitter while BFG model only use Twitter data. Comparing AFG  X  performance in
Fig. 3 ( b )and BFG  X  X  performance in Fig. 3 ( a ), we find that AFG model can make full use of source network to improve the prediction performance. Though target network and source network are similar, they also have own characteristics. Foursquare provides location based service while Twitter pro-vides Tweet service. In order to prove that AFG model is suitable to solve new user link prediction problem in similar aligned networks regardless of their positions, we use Foursquare as target network and Twitter as source network in second group experiments. And the results of second group experiments are shown in Fig. 4 . -In Fig. 4 ( a ), BFG model performs worse than TRAD model, keeping the same trend with Fig. 3 ( a ) for the same reason.
 -In Fig. 4 ( b ), the AFG model performance increases gradually before user -In Fig. 4 ( c ), AFG model performs better than SCAN-PS model both in The link prediction problem for new users is studied in this paper. Recommenda-network. However, the cold start problem is often encountered. The AFG model is proposed to utilize data from a similar source network to help prediction in target network. Three categories of local features and one category of global fea-tures are put forward for training. The Aligned Structure Algorithm is brought up to reduce the scale of the factor graph and keep high prediction accuracy when building the model. Experiments on Twitter and Foursquare show that AFG model can make full use of source network data to improve prediction performance compared with BFG model, which can only use the target network data. And AFG model performs better than SCAN-PS model. Auc is increased by 10% and Acc is increased by 11% in average when Foursquare is source net-work and Twitter is target network. On the other hand, 7% Auc and 3% Acc improvements are achieved when swapping positions of the two networks.
