 Figure/ground assignment (further referred to as f/g), in which the visual image is divided into nearer (figural) and farther (ground) surfaces, is an essential step in visual processing. A number of fac-tors are known to affect f/g assignment, including region size [9], convexity [7, 16], and symmetry [1, 7, 11]. Figural assignment (often referred to as border ownership , under the assumption that the figural side  X  X wns X  the border) is usually studied globally, meaning that entire surfaces and their enclosing boundaries are assumed to receive a globally consistent figural status. But recent psy-chophysical findings [8] have suggested that border ownership can vary locally along a boundary, even leading to a globally inconsistent figure/ground assignment X  X roadly consistent with electro-physiological evidence showing local coding for border ownership in area V2 as early as 68 msec after image onset [20]. This suggests a spatially distributed and potentially competitive process of figural assignment [15], in which adjacent surfaces compete to own their common boundary, with figural status propagating across the image as this competition proceeds. But both the principles and computational mechanisms underlying this process are poorly understood. In this paper we consider how border ownership might propagate over both space and time X  X hat is, across the image as well as over the progression of computation. Following Weiss et al. [18] we adopt a Bayesian belief network architecture, with nodes along boundaries representing estimated border ownership, and connections arranged so that both neighboring nodes and nonlocal integrating nodes combine to influence local estimates of border ownership. Our model is novel in two particular respects: (a) we combine both local and global influences on border ownership in an integrated and principled way; and (b) we include as a nonlocal factor skeletal (medial axis) influences on f/g assignment. Skeletal structure has not been previously considered as a factor on border ownership, but its relevance follows from a model [4] in which shapes are conceived of as generated by or  X  X rown X  from an internal skeleton, with the consequence that their boundaries are perceptually  X  X wned X  by the skeletal side.
 We also briey present a psychophysical experiment in which we measured local border ownership along a contour, at several distances from a strong local f/g inducing cue, and at several time delays after the onset of the cue. The results show measurable spatial differences in judged border owner-ship, with judgments varying with distance from the inducer; but no temporal effect, with essentially asymptotic judgments even after very brief exposures. Both results are consistent with the behavior of the network, which converges quickly to an asymptotic but spatially nonuniform f/g assignment. The Network. For simplicity, we take an edge map as input for the model, assuming that edges and T-junctions have already been detected. From this edge map we then create a Bayesian belief network consisting of four hierarchical levels. At the input level the model receives evidence E from the image, consisting of local contour curvature and T-junctions. The nodes for this level are placed at equidistant locations along the contour. At the first level the model estimates local border ownership. The border ownership, or B -nodes at this level are at the same locations as the E -nodes, but are connected to their nearest neighbors, and are the parent of the E -node at their location. (As a simplifying assumption, such connections are broken at T-junctions in such a way that the occluded contour is disconnected from the occluder.) The highest level has skeletal nodes, S , whose positions are defined by the circumcenters of the Delaunay triangulation on all the E -nodes, creating a coarse medial axis skeleton [13]. Because of the structure of the Delaunay, each S -node is connected to exactly three E -nodes from which they receive information about the position and the local tangent of the contour. In the current state of the model the S -nodes are  X  X assive X , meaning their posteriors are computed before the model is initiated. Between the S nodes and the B nodes are the grouping nodes G . They have the same positions as the S -nodes and the same Delaunay connections, but to B -nodes that have the same image positions as the E -nodes. They will integrate information from distant B -nodes, applying an interiority cue that is influenced by the local strength of skeletal axes as computed by the S -nodes (Fig. 1). Although this is a multiply connected network, we have found that given reasonable parameters the model converges to intuitive posteriors for a variety of shapes (see below).
 Updating. Our goal is to compute the posterior p ( B i | I ) , where I is the whole image. B i is a binary variable coding for the local direction of border ownership, that is, the side that owns the border. In order for border ownership estimates to be influenced by image structure elsewhere in the image, information has to propagate throughout the network. To achieve this propagation, we use standard equations for node updating [14, 12]. However while to all other connections being directed, connections at the B -node level are undirected, causing each node to be child and parent node at the same time. Considering only the B -node level, a node B i is only separated from the rest of the network by its two neighbors. Hence the Markovian property applies, in that B i only needs to get iterative information from its neighbors to eventually compute p ( B i | I ) . So consid-ering the whole network, at each iteration t , B i receives information from both its child, E i and from its parents X  X hat is neigbouring nodes ( B i +1 and B i  X  1 ) X  X s well as all grouping nodes con-nected to it ( G j ,...,G m ). The latter encode for interiority versus exteriority, interiority meaning that the B-node X  X  estimated gural direction points towards the G-node in question, exteriority meaning that it points away. Integrating all this information creates a multidimensional likelihood function: p ( B i | B i  X  1 ,B i +1 ,G j ,...,G m ) . Because of its complexity we choose to approximate it (assuming all nodes are marginally independent of each other when conditioned on B i ) by Figure 1: Basic network structure of the model. Both skeletal ( S -nodes) and border-ownerhsip nodes ( B -nodes) get evidence from E -nodes, though different types. S -nodes receive mere positional in-formation, while B -nodes receive information about local curvature and the presence of T-junctions. Because of the structure of the Delaunay triangulation S -nodes and G -nodes (grouping nodes) al-ways get input from exactly three nodes, respectively E and B -nodes. The gray color depicts the fact that this part of the network is computed before the model is initiated and does not thereafter interact with the dynamics of the model. following computation: where conceptually  X  stands for bottom-up information,  X  for top down information and  X  and  X  for information received from within the same level. More formally, and analogously to equation 4 for  X  ( B i ) and  X  ( B i ) , which compute information coming from B i  X  1 the G -nodes: The posteriors of the S -nodes are used to compute the  X  ( G i ) . This posterior computes how well the S -node at each position explains the contour X  X hat is, how well it accounts for the cues flowing from the E -nodes it is connected to. Each Delaunay connection between S -and E -nodes can be seen as a rib that sprouts from the skeleton. More specifically each rib sprouts in a direction that is normal (perpendicular) to the tangent of the contour at the E -node plus a random error  X  i chosen independently for each rib from a von Mises distribution centered on zero, i.e.  X  i  X  V (0 , X  S ) with spread parameter  X  S [4]. The rib lengths are drawn from an exponential decreasing density function connected to via the probability that this S -node deserves to be a skeletal node or not, with S = true depicting that this S -node deserves to be a skeletal node. From this we then compute the prior  X  ( G i ) in such a way that good (high posterior) skeletal nodes induce a high interiority bias, hence a stronger tendency to induce figural status. Conversely, bad (low posterior) skeletal nodes create a prior close to indifferent (uniform) and thus have less (or no) influence on figural status. Likelihood functions Finally we need to express the likelihood function necessary for the updat-ing rules described above. The first two likelihood functions are part of p ( E i | B i ) , one for each of the local cues. The first one, reflecting local curvature, gives the probability of the orientations of the two vectors inherent to E i (  X  1 and  X  2 ) given both direction of figure (  X  ) encoded in B i as a von Mises density centered on  X  , i.e.  X  i  X  V (  X , X  EB ) . The second likelihood function, reflecting the presence of a T-junction, simply assumes a fixed likelihood when a T-junction is present X  X hat is p ( T-junction = true | B i ) =  X  T , where B i places the direction of figure in the direction of the oc-cluder. This likelihood function is only in effect when a T-junction is present, replacing the curvature cue at that node.
 The third likelihood function serves to keep consistency between nodes of the first level. This func-probability matrix with a single free parameter,  X  BB (the probability that figural direction at both B -nodes are the same). A fourth and final likelihood function p ( B i | G j ) serves to propagate infor-mation between level one and two. This likelihood function is 2x2 conditional probability matrix matrix with one free parameter,  X  BG . In this case  X  BG encodes the probability that the figural direc-tion of the B -node is in the direction of the exterior or interior preference of the G -node. In total this brings us to six free parameters in the model:  X  S ,  X  S ,  X  EB ,  X  T ,  X  BB , and  X  BG . To evaluate the performance of the model, we first tested it on several basic stimulus configurations in which the desired outcome is intuitively clear: a convex shape, a concave shape, a pair of over-lapping shapes, and a pair of non-overlapping shapes (Fig. 2,3). The convex shape is the simplest in that curvature never changes sign. The concave shape includes a region with oppositely signed curvature. (The shape is naturally described as predominantly positively curved with a region of neg-ative curvature, i.e. a concavity. But note that it can also be interpreted as predominantly negatively curved  X  X indow X  with a region of positive curvature, although this is not the intuitive interpretation.) The overlapping pair of shapes consists of two convex shapes with one partly occluding the other, creating a competition between the two shapes for the ownership of the common borderline. Finally the non-overlapping shapes comprise two simple convex shapes that do not touch X  X gain setting up a competition for ownership of the two inner boundaries (i.e. between each shape and the ground space between them). Fig. 2 shows the network structures for each of these four cases.
 Figure 2: Network structure for the four shape categories (left to right: convex, concave, overlap-ping, non-overlapping shapes). Blue depict the locations of the B -nodes (and also the E -nodes), the red connections are the connections between B -nodes, the green connections are connections between B -nodes and G -nodes, and the G -nodes (and also the S -nodes) go from orange to dark red. This colour code depicts low (orange) to high (dark red) probability that this is a skeletal node, and hence the strength of the interiority cue.
 Running our model with hand-estimated parameter values yields highly intuitive posteriors (Fig. 3), an essential  X  X anity check X  to ensure that the network approximates human judgments in simple cases. For the convex shape the model assigns figure to the interior just as one would expect even based solely on local curvature (Fig. 3A). In the concave figure (Fig. 3B), estimated border own-ership begins to reverse inside the deep concavity. This may seem surprising, but actually closely matches empirical results obtained when local border ownership is probed psychophysically inside a similarly deep concavity, i.e. a  X  X egative part X  in which f/g seems to partly reverse [8]. For the overlapping shapes posteriors were also intuitive, with the occluding shape interpreted as in front and owning the common border (Fig. 3C). Finally, for the two non-overlapping shapes the model computed border-ownership just as one would expect if each shape were run separately, with each shape treated as figural along its entire boundary (Fig. 3D). That is, even though there is skeletal structure in the ground-region between the two shapes (see Fig. 2D), its posterior is weak compared to the skeletal structure inside the shapes, which thus loses the competition to own the boundary between them.
 For all these configurations, the model not only converged to intuitive estimates but did so rapidly (Fig. 4), always in fewer cycles than would be expected by pure lateral propagation, n iterations &lt; N nodes [18] (with these parameters, typically about five times faster).
 Figure 3: Posteriors after convergence for the four shape categories (left to right: convex, concave, overlapping, non-overlapping). Arrows indicate estimated border ownership, with direction pointing to the perceived figural side, and length proportional to the magnitude of the posterior. All four simulations used the same parameters. Figure 4: Convergence of the model for the basic shape categories. The vertical lines represent the point of convergence for each of the three shape categories. The posterior change is calculated as P | p ( B i = 1 | I ) t  X  p ( B i = 1 | I ) t  X  1 | at each iteration. Beyond the simple cases reviewed above, we wished to submit our network to a more fine-grained comparison with human data. To this end we compared its performance to that of human subjects in an experiment we conducted (to be presented in more detail in a future paper). Briefly, our experiment involved finding evidence for propagation of f/g signals across the image. Subjects were first shown a stimulus in which the f/g configuration was globally and locally unambiguous and consistent: a smaller rectangle partly occluding a larger one (Fig. 5A), meaning that the smaller (front) one owns the common border. Then this configuration was perturbed by adding two bars, of which one induced a local f/g reversal X  X aking it now appear locally that the larger rectangle owned the border (Fig. 5B). (The other bar in the display does not alter f/g interpretation, but was included to control for the attentional affects of introducing a bar in the image.) The inducing bar creates T-junctions that serve as strong local f/g cues, in this case tending to reverse the prior global interpretation of the figure. We then measured subjective border ownership along the central contour at various distances from the inducing bar, and at different times after the onset of the bar ( 25 ms, 100 ms and 250 ms). We measured border ownership locally using a method introduced in [8] in which a local motion probe is introduced at a point on the boundary between two color regions of different colors, and the subject is asked which color appeared to move. Because the figural side  X  X wns X  the border, the response reflects perceived figural status.
 The goal of the experiment was to actually measure the progression of the influence of the inducing T-junction as it (hypothetically) propagated along the boundary. Briefly, we found no evidence of temporal differences, meaning that f/g judgments were essentially constant over time, suggesting rapid convergence of local f/g assignment. (This is consistent with the very rapid convergence of our network, which would suggest a lack of measurable temporal differences except at much shorter time scales than we measured.) But we did find a progressive reduction of f/g reversal with increasing distance from the inducer X  X hat is, the influence of the T-junction decayed with distance. Mean responses aggregated over subjects (shortest delay only) are shown in Fig. 6.
 In order to run our model on this stimulus (which has a much more complex structure than the simple figures tested above) we had to make some adjustments. We removed the bars from the edge map, leaving only the T-junctions as underlying cues. This was a necessary first step because our model is not yet able to cope with skeletons that are split up by occluders. (The larger rectangle X  X  skeleton has been split up by the lower bar.) In this way all contours except those created by the bars were used to create the network (Fig. 7). Given this network we ran the model using hand-picked parameters that Figure 5: Stimuli used in the experiment. A. Initial stimulus with locally and globally consistent and unambiguous f/g. B. Subsequently bars were added of which one (the top bar in this case) created a local reversal of f/g. C. Positions at which local f/g judgments of subjects were probed. Figure 6: Results from our experiment aggregated for all 7 subjects (shortest delay only) are shown in red. The x -axis shows distance from the inducing bar at which f/g judgment was probed. The y -axis shows the proportion of trials on which subjects judged the smaller rectangle to own the boundary. As can be seen, the further from the T-junction, the lower the f/g reversal. The fitted model (green curve) shows very similar pattern. Horizontal black line indicates chance performance (ambiguous f/g). gave us the best possible qualitative similarity to the human data. The parameters used never entailed total elimination of the influence of any likelihood function (  X  S = 16 ,  X  S = . 025 ,  X  EB = . 5 ,  X 
T = . 9 ,  X  BB = . 9 , and  X  BG = . 6 ). As can be seen in Fig. 6 the border-ownership estimates at the locations where we had data show compelling similarities to human judgments. Furthermore along the entire contour the model converged to intuitive border-ownership estimates (Fig. 7) very rapidly (within 36 iterations). The fact that our model yielded intuitive estimates for the current network in which not all contours were completed shows another strength of our model. Because our model included grouping nodes, it did not require contours to be amodally completed [6] in order for information to propagate. In this paper we proposed a model rooted in Bayesian belief networks to compute figure/ground. The model uses both local and global cues, combined in a principled way, to achieve a stable and apparently psychologically reasonable estimate of border ownership. Local cues included local curvature and T-junctions, both well-established cues to f/g. Global cues included skeletal structure, Figure 7: (left) Node structure for the experimental stimulus. (right) The model X  X  local border-ownership estimates after convergence. a novel cue motivated by the idea that strongly axial shapes tend to be figural and thus own their boundaries. We successfully tested this model on both simple displays, in which it gave intuitive results, and on a more complex experimental stimulus, in which it gave a close match to the pattern of f/g propagation found in our subjects. Specifically, the model, like the human subjects rapidly converged to a stable local f/g interpretation.
 Our model X  X  structure shows several interesting parallels to properties of neural coding of border ownership in visual cortex. Some cortical cells (end-stopped cells) appear to code for local curvature [3] and T-junctions [5]. The B -nodes in our model could be seen as corresponding to cells that code for border ownership [20]. Furthermore, some authors [2] have suggested that recurrent feedback loops between border ownership cells in V2 and cells in V4 (corresponding to G -nodes in our model) play a role in the rapid computation of border ownership. The very rapid convergence we observed in our model likewise appears to be due to the connections between B -nodes and G -nodes. Finally scale-invariant shape representations (such as, speculatively, those based on skeletons) are thought to be present in higher cortical regions such as IT [17], which project down to earlier areas in ways that are not yet understood.
 A number of parallels to past models of f/g should be mentioned. Weiss [18] pioneered the appli-cation of belief networks to the f/g problem, though their network only considered a more restricted set of local cues and no global ones, such that information only propagated along the contour. Fur-thermore it has not been systematically compared to human judgments. Kogo et al. [10] proposed an exponential decay of f/g signals as they spread throughout the image. Our model has a similar decay for information going through the G -nodes, though it is also influenced by an angular factor defined by the position of the skeletal node. Like the model by Li Zhaoping [19], our model includes horizontal propagation between B -nodes, analogous to border-ownership cells in her model. A neu-rophysiological model by Craft et al. [2] defines grouping cells coding for an interiority preference that decays with the size of the receptive fields of these grouping cells. Our model takes this a step further by including shape (skeletal) structure as a factor in interiority estimates, rather than simply size of receptive fields (which is similar to the rib lengths in our model).
 Currently, our use of skeletons as shape representations is still limited to medial axis skeletons and surfaces that are not split up by occluders. Our future goals including integrating skeletons in a more robust way following the probabilistic account suggested by Feldman and Singh [4]. Eventually, we hope to fully integrate skeleton computation with f/g computation so that the more general problem of shape and surface estimation can be approached in a coherent and unified fashion. [1] P. Bahnsen. Eine untersuchung uber symmetrie und assymmetrie bei visuellen [2] E. Craft, H. Sch  X  utze, E. Niebur, and R. von der Heydt. A neural model of figure-ground [3] A. Dobbins, S. W. Zucker, and M. S. Cyander. Endstopping and curvature. Vision Research , [4] J. Feldman and M. Singh. Bayesian estimation of the shape skeleton. Proceedings of the [5] B. Heider, V. Meskenaite, and E. Peterhans. Anatomy and physiology of a neural mechanism [6] G. Kanizsa. Organization inVision . New York: Praeger, 1979. [7] G. Kanizsa and W. Gerbino. Vision and Artifact , chapter Convexity and symmetry in figure-[8] S. Kim and J. Feldman. Globally inconsistent figure/ground relations induced by a negative [9] K. Koffka. Principles of Gestalt Psychology . Lund Humphries, London, 1935. [10] N. Kogo, C. Strecha, L. Van Gool, and J. Wagemans. Surface construction by a 2-d [11] B. Machielsen, M. Pauwels, and J. Wagemans. The role of vertical mirror-symmetry in visual [12] K. Murphy, Y. Weiss, and M.I. Jordan. Loopy belief propagation for approximate inference: [13] R. L. Ogniewicz and O. K  X  ubler. Hierarchic Voronoi skeletons. Pattern Recognition , 28:343 X  [14] J. Pearl. Probabilistic reasoning in intelligent systems: networks of plausible inference . Mor-[15] M. A. Peterson and E. Skow. Inhibitory competition between shape properties in figure-[16] K. A. Stevens and A. Brookes. The concave cusp as a determiner of figure-ground. Perception , [17] K. Tanaka, H. Saito, Y. Fukada, and M. Moriya. Coding visual images of object in the infer-[18] Y. Weiss. Interpreting images by propagating Bayesian beliefs. Adv. in Neural Information [19] L. Zhaoping. Border ownership from intracortical interactions in visual area V2. Neuron , [20] H. Zhou, H. S. Friedman, and R. von der Heydt. Coding of border ownerschip in monkey
