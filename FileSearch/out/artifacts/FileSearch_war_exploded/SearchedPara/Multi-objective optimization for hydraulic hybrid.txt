 1. Introduction
With the rising concern in a global scale environmental issue, energy saving in automobiles is a very important subject. The search for improving fuel economy, reducing emissions, and affordable vehicles, without sacrificing vehicle performance, safety, reliability, and other conventional vehicle attributes, has made the hybrid technology one of the challenges for the automotive industry ( Wei, 2006 ). As an important branch of hybrid technology, hydraulic hybrid vehicles have increasingly aroused the attention of the research institutions and automotive manufacturers all over the world ( Hewko and Weber, 1990; Paul and Jacek, 2003 ). Hydraulic hybrid vehicles employ hydrostatic transmission as against the traditional mechanical transmission, hence eliminating some mechanical connection between the engine and the driving wheels. After the introduction of hydraulic accumulator, the engine is decoupled from automobile load and operated in high efficiency region. Hydraulic accumulator has the advantage of higher power density and the ability to accept the high rates and high frequencies of charging and discharging, both duty trucks and heavy-duty trucks.

The initial estimates of the hydraulic accumulator and pump/ motor sizes are based on the critical vehicle performance requirements. However, an optimization process is needed to find the design parameters for maximum fuel economy while satisfying the vehicle performance constraints. An important characteristic of the optimization is the highly non-linear and non-continuous powertrain system, which may have a large number of local optimums. Thus, the gradient-based optimization methods may not converge to a global solution. Compared with the other optimization methods, genetic algorithm ( Sawaragi and global character for the non-linear problem of components optimization, but the primary problems of the GA are the slow convergence in the later phase. Simulated annealing algorithm (SA) in general is able to obtain improvements also into the late phase of the process, it does not converge as fast as the GA in In this study, the unified algorithm, called adaptive simulated annealing genetic algorithm (ASAGA), is designed to find design parameters for maximum fuel economy. The simulation results show that the ASAGA method is valid and effective, which takes the key components X  optimal parameters values, substantially improving the performance and fuel economy of HHV. 2. Configuration of HHV
The new configuration of hydraulic hybrid vehicles proposed in this paper is shown in Fig. 1 , which is configured with the aim of achieving better fuel economy and driving performance.
In the configuration, the engine does not drive the vehicle directly. Instead, it converts the mechanical power into the hydraulic energy using a pump to supply high pressure oil for the hydraulic pump/motors. After the introduction of hydraulic accumulator, the engine is decoupled from automobile load and operated in high efficiency region. The conventional driveline is completely removed and two pump/motors are connected to the front and rear wheel axles through the differentials. Because of the multi-motors configuration, hydraulic hybrid vehicles have the function of 4-wheel-drive (4wd). The front and rear units can be used independently or together to provide energy to the wheels efficiently. The clutches are fitted to front and rear differentials, respectively, which complete the automatic switches among front drive, rear drive and 4-wheel-drive modes. During the start/acceleration period under small load condition, the front hydraulic pump/motor independently propels the vehicle, which makes the hydraulic pump/motor work in high load operating region and enhances the overall efficiency of the vehicle.
Full throttle/hard acceleration is achieved by using both the front and rear hydraulic units together, the vehicle works in 4wd mode. The operation involves three propulsion devices, an engine and the front/rear hydraulic pump/motors that propel the bus simultaneously. During normal driving, the front pump/motor provides torque for the moderate acceleration and decelerations.
During deceleration, the front pump/motor decelerates the vehicle while operating as a pump to capture the energy normally vehicle brake is applied, the front hydraulic pump/motor uses the kinetic energy of the braking actions to charge the hydraulic fluid from a low pressure accumulator into a high pressure accumu-lator, increasing the pressure of the nitrogen gas in the high pressure accumulator. The high pressure hydraulic fluid is used by hydraulic pump/motor unit to generate torque during the next acceleration, which sends the fluid back to the low pressure accumulator. Hydraulic pump/motor is designed and sized to capture energy from normal, moderate braking events, if braking torques provided by hydraulics are not enough, it is supplemented by the frictional brake ( Paul and Jacek, 2003 ). 3. Design algorithm
Genetic algorithm has the advantages of robust character and global character for the non-linear problem of components optimization. But one of the problems of the genetic algorithm improves rapidly. But then it becomes very difficult to obtain further improvement. The majority of the runtime is spent in the later phase of the process in which only small improvements are obtained ( Myungryun and Mitsuo, 2007 ; Kirkpatrick et al., 1983 ).
While SA in general is able to obtain improvements also into the the initial phase. The unified algorithm, called ASAGA, is designed in such a way that the advantages of the GA as well as the SA are utilized, which overcomes the overcoming of pre-maturity in GA. 3.1. The simulated annealing algorithm
The usual outline of a simulated annealing (SA) algorithm is as follows: 1. Initialize the parameters of the annealing schedule; 2. Randomly generate an initial state as the current-state; 3. k :=1; 4. repeat 5. repeat 6. Call move generation strategy for generating the 7. D C :=cost of the next-state cost of the current-state; 8. P r =min{1, exp ( D C / T )}; 9. If P r 4 random[0 1) then the current-state:=the next-10. until system equilibrium at T k 11. T 12. until system has been frozen. 3.2. Adaptive simulated annealing genetic algorithm
During the optimization of HHV using the ASAGA method, the selection of fitness function and the design of genetic operators are the key factors for the successful optimization. The genetic operators in genetic algorithms consist of selection, crossover and mutation. If the genetic operators are unchanged with the generations, the optimization method is called SAGA. In this study, the adaptive selection mechanism is proposed to improve the search performance of GA which is called adaptive SAGA. 3.2.1. Adaptive selection operator
The individual selection rate adopts combination of weighing and selection mechanism of adaptive probability P f and concen-tration probability P d (Yuan et al., 2006 ):
P  X  a P f  X  X  1 a  X  P d 0 o a o 1  X  1  X 
Adaptive selection operator protects the individual with high fitness value and restrains the individual with large concentration probability, which maintains the individual variety and improves the pre-mature convergence. 3.2.2. Adaptive crossover and mutation operator
Large crossover probability has the effect of destroying the optimal solution in the late phase of GA, and small crossover probability also impacts the variety of individual in the initial phase of GA. In order to overcome the above shortcomings, adaptive annealing temperature crossover probability P c is introduced as follows:
P  X  0 : 9
P  X  0 : 9 where f max , f min are the highest fitness value and the average the crossover individual with highest fitness value; N the population size.

Similarly, adaptive annealing temperature mutation probabil-ity is as follows:
P  X  0 : 3
P  X  0 : 3 3.2.3. Adaptive selection optimal solution to simulate annealing
Array current solutions according to the fitness values, conserve the best individual and select { N P } individuals with large fitness values into the process of simulated annealing. P  X  Kf avg = f max 0 r K r 0 : 2  X  6  X 
If f max is large and f avg is small, then P is small; if f larger then f avg , then P is large. 3.2.4. Fitness dynamic stretch operate
The criterion of fitness dynamic stretch is as follows: f
When temperature is high (in the initial phase of GA), the individuals with similar fitness values almost have the same probability of offspring, so the temperature drop scope is obvious to avoid the majority of the runtime spent in this phase. Along with the drop of temperature, stretch effect is strengthened, which increases the difference between the individuals with similar fitness values. Therefore, the advantage of good indivi-duals is more obvious, which conduces to the search of the optimum solution. 3.3. The flow of adaptive simulated annealing genetic algorithm
The flow of ASAGA is as follows: 1. Initial parameters. i.e., population size, T 0 , a (0 o a o 1), 2. Put each chromosome into the mathematical model of HHV 3. Calculate the average cost of P 0 ; 4. Solution_vector:=current_point:=the lowest cost point in P 5. k :=0; 6. while system is not frozen do 7. no_of_point:=0; 8. while no_of_point r population size do 9. Generate next_point from current_point by the move 10. D C :=cost of the next-state cost of the current-state; 11. P r =min{1, exp ( D C / T )}; 12. If P r 4 random[0 1) then put next_point into P k +1 13. current_point:=next_point; 14. no_of_point:=no_of_point+1; 15. else pick another point from P k as current_point; 16. endwhile 17. Apply the genetic operators to create P k +1 ; 19. if it is the initial stage then determining the initial 20. T 1 =(the highest cost the lowest cost)/(population_size/2); 21. else T k +l := T k n a ; 22. current_point:=the lowest cost in P k +1 ; 23. k := k +1; 24. if frozen condition is signing then set system is frozen; 25. endwhile 26. Perform the local search procedure. 3.4. Objective function
To apply adaptive simulated annealing genetic algorithm to the optimization of HHV, a fitness function is required to evaluate the status of each solution. In this study, the fitness function is composed of four parts. (1) Braking energy regenerative ability of HHV is described as  X  where E acc_max is the largest recoverable energy of hydraulic accumulator, E where p 1 is the lowest work pressure of accumulator, V 1 volume at the lowest pressure, n the poly-index of the gas, m the vehicle mass and v avg the cruising velocity of HHV. (2) Driving performance of HHV is described as t one gear ratio, F f and F w are the frictional and aerodynamic resistance, respectively. (3) Fuel consumption of HHV is described as Q add  X  2 f  X  V 0  X  X  f  X  V P = M  X  X  m where f  X  V 0  X  X  0 : 0003 V 2 0  X  0 : 5099 V 0  X  11 : 6537, f  X  V p = m  X  X  0 : 0008 V 3 p = m  X  0 : 0853 V 2 p = m 0 : 5656 V f ( V hydraulic pump/motor, respectively. V 0 the volume of hydraulic accumulator. V P/M the displacement of hydraulic pump/motor. Q of acceleration, constant speed, deceleration and ideal. (4) The added price of HHV is described as price hhv  X  2 f p  X  V 0  X  X  f p  X  V P = M  X  X  12  X  accumulator and pump/motor, respectively.
 Some aspects of HHV are often in conflict with each other. For instance, the best braking energy regenerative ability does not necessarily result in the minimization of vehicle mass and maximization of drive performance, implying the need for a tradeoff solution. In this study, a multi-objective optimization method is implemented to achieve the optimization target. Multi-objective optimization, which is also called multi-criteria optimization or vector optimization, has been defined as finding a vector of decision variables satisfying constraints to give acceptable values to all objective functions. In this approach, all the targets are aggregated into a single objective function to be optimized. The objective function can be mathematically defined as
F  X  V  X  a 1 able to investigate the effect of different objectives on the optimization results, such as performance, energy regenerative ability, fuel economy, etc. E max and E min are the max and min smallest acceleration times. Q max and Q min are the max and the min fuel consumptions of HHV. P max and P min are the max and the min added prices of HHV. 3.5. Gene limitation
In order to apply ASAGA to design the powertrain, the maximum and minimum limit values of the genes must be calculated. As described in the previous section, the hydraulic pump/motor is assigned to play a primary role in driving the vehicle. Accordingly, the min displacement of hydraulic pump/ motor is determined by min  X  V p = m  X  X  0 : 377 r 60 Z where Z P/M is the transmission efficiency from the hydraulic pump/motor to the wheels, i 0 the final ratio of the vehicle, and i the transmission gear.

The max displacement of hydraulic pump/motor must reach the requirement of driving the vehicle at max velocity or climbing at one velocity, as expressed in below equations: V V
The maximum and minimum pressures of the constant pressure system are determined by min  X  p const  X  X  2 p  X  G cos a f  X  C d Av 2 = 21 : 15  X  V max  X  p const  X  X 
In order to provide auxiliary energy and absorb the excess energy in high rates and high frequencies, the minimum working pressure of hydraulic accumulator is slightly lower than the value of constant pressure network system. The maximum working pressure of hydraulic accumulator cannot exceed the maximum pressure that the hydraulic pump/motor allowed. 3.6. Model of important components
Due to the complexity of the hydraulic pump/motor and hydraulic accumulator, it is difficult and inaccurate to model the components model with analytic mathematic equations and that will slow the calculation speed and reduce the precision of a simplified model. In this study, the combination of theoretic model and numerical model method is introduced to build the components model. 3.6.1. Model of hydraulic pump/motor
In order to save the calculation time, the combination of theoretic model and numerical model method is introduced to build the hydraulic pump/motor model. The efficiency linear interpolation is used to calculate the output torque of hydraulic pump/motor. The hydraulic pump/motor efficiency curve is shown in Fig. 2 (Kim and Filipi, 2007 ). 3.6.2. Model of hydraulic accumulator
In order to more closely represent the p X  v  X  X  characteristics of the nitrogen gas, the Benedict X  X ebb X  X ubin equation is used (Paul and Jacek, 2003 ) p  X 
RT v  X  B 0 RT A 0  X  c 1  X  hi 1 where p , v , and T are the gas pressure, specific volume and temperature, respectively. All other values in this equation are empirical constants specific for nitrogen gas. By differentiating
Eq. (21) with respect to temperature, and following the procedure outlined in the Otis Time Constant theory, we arrive at ( Paul and
Jacek, 2003 ) dT dt  X 
This temperature is then put back into Eq. (22) to give the accumulator pressure history for a process cycle.

The maximum energy that can be recovered by the hydraulic accumulator is E  X 
Z 5 v 5  X  4. Optimization and analysis
The ASAGA described in the previous sections is used to optimize the sizes of key components in HHV. As shown in the flow of adaptive simulated annealing genetic algorithm, the hybrid powertrain configuration is employed to simulate. The basic parameters of HHV are as follows: Vehicle mass: 9700 kg.
 Rolling resistance coefficient: 0.009.
 Body aerodynamic drag coefficient: 0.335.
 Vehicle front area: 4 m 2 .
 Wheel radius: 0.48 m.

Gearbox: three speed manual gearbox with following gear ratios: 4.2, 2.2, 1.3. Efficiency of gearbox is assumed to be 95%. Final drive ratio: 5.286.
 Maximum speed: Z 90 km/h.
 Gradeability: Z 30%.

The six variables are coded in a chromosome using a binary coding scheme consisting of the following genes: The genes limitations are listed in Table 1 .

In the objective function of ASAGA, all the weighting factors can be set with different values according to different require-ments. For instance, when the main objective is the minimization of the vehicle fuel consumption (FC), the weighting factor of FC will be set to increase, other weighting factors will be set to decrease correspondingly. This case is called FC targeted optimi-zation problem. More versions of weights are also defined as
Tradeoff and driving targeted. The definition of weights for different versions is illustrated in Table 2 .

The optimal parameters obtained for the different weight coefficients and population sizes are summarized in Table 3 . Under the tradeoff optimization condition, the optimization process of objective function is illustrated in Fig. 3 .
As it can be seen from rows 1 X 3 in Table 3 , the optimal values of important parameters are almost identical, which indicates the on the optimal results of important parameters. So in the latter optimization course, the chromosome population is adopted as 50. As shown in the results among 4 X 6th rows, when the driving performance weight coefficient a 2 increases, the optimized results of system work pressure value p const and the hydraulic pump/ motor displacement V p/m increase, while the hydraulic accumu-lator volume V acc reduces, which is in accord with the target function setting up. Similarly, when the main objective is the minimization of the fuel consumption, the weight coefficient a set to 0.4 and the weight of driving performance weight is set to 0.2. The optimized value V acc increases, p const and V p/m the city vehicle should have better FC and braking energy regenerative rate, so the results of ASAGA are satisfied and effective.

As it can be seen in Fig. 3 , individuals appear to evolve with time for the HHV, and whenever the evolutions take place over 80 generations, the fitness value is almost the biggest, that is the objective value approaches to the minimum 1.

The optimal parameters obtained for tradeoff target based on three different average speeds are summarized in Table 4 .
The optimal values V acc and V p/m under higher average speed driving cycle are greater than the counterparts in lower speed driving cycle, which is in accord with the target function setting up. Based on the characteristics of city driving cycle, under the same optimization objective, the higher city driving cycle requires the vehicle has bigger displacement hydraulic pump/motor and higher capacity accumulator, so the results of ASAGA are exact and effective.

Furthermore, in order to study the behavior of the HHV fuel economy, driving performance and added mass with respect to the weights, the normalized values of HHV performance for the different optimization objective are compared in Fig. 4 . As it can be seen in this figure, the behavior of fuel economy is not consistent with added mass and gradeablity. The amount of fuel economy obtained for the FC optimization is greater than all other versions of weights. Other performances obtained for the FC optimization are less than all other versions of weights, which is in accord with the target function setting up.

In order to evaluate the optimized results based on ASAGA, the multi-objective optimization for the same HHV based on
Sequential Quadratic Programming (SQP) ( Zhu and Zhang, 2006 ) method is performed. a 1 to a 4 are set 0.3, 0.2, 0.25 and 0.25, respectively. The vehicle performances of optimized HHV are summarized in Table 5 .
 As it can be seen in this table, the optimal parameters by
ASAGA are more in accord with the target function setting up, which indicates that ASAGA strengthens the overall search ability and improves the efficiency of optimal solution.

After the optimization of important components, the driving performance and fuel economy of HHV remarkably exceeds the default HHV, and the vehicle mass, and price are reduced obviously. The UDDS cycle is used to compare the performance of tradeoff-targeted optimized HHV and default HHV, the results are shown in Figs. 5 and 6 .

It is shown that after the optimization, the engine works at better fuel economy region, the fuel consumption is lower, and the hydraulic pump/motor also works at large displacement and high load working condition in UDDS, the overall efficiency of the hydraulic hybrid vehicle is high. 5. Conclusions
In this paper, application of ASAGA is described for the optimization of key component sizes in HHV. The optimization problem is formulated for meeting the minimum fuel consumption while maintaining the vehicle performance requirements. In the objective function of the optimization, all the weighting factors can be set with different values according to different require-ments. The combinations of theoretical model and numerical model method are introduced to build the powertrain component models. Finally, the optimization is performed under different objective functions. The results show that the proposed method effectively distinguishes the key components X  optimal parameters position of HHV, enhances the performance and fuel consump-tion, which provides the practical feasible method for hydraulic hybrid vehicle.
 References
