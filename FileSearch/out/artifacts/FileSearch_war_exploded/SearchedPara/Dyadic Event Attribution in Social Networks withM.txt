 In many applications in social network analysis, it is important to model the interactions and infer the influence between pairs of actors, leading to the problem of dyadic event modeling which has attracted increasing interests recently. In this paper we focus on the problem of dyadic event attribution, an important missing data problem in dyadic event modeling where one needs to infer the missing actor-pairs of a subset of dyadic events based on their observed timestamps. Existing works either use fixed model pa-rameters and heuristic rules for event attribution, or assume the dyadic events across actor-pairs are independent. To address those shortcomings we propose a probabilistic model based on mixtures of Hawkes processes that simultaneously tackles event attribution and network parameter inference, taking into consideration the de-pendency among dyadic events that share at least one actor. We also investigate using additive models to incorporate regularization to avoid overfitting. Our experiments on both synthetic and real-world data sets on international armed conflicts suggest that the proposed new method is capable of significantly improve accuracy when compared with the state-of-the-art for dyadic event attribu-tion.
 I.2.6 [ Artificial Intelligence ]: Learning; J.4 [ Computer Applica-tions ]: Social and Behavioral Sciences Algorithms, Experimentation, Performance Dyadic event, missing data problem, Hawkes process, variational inference, international armed conflicts
Analyzing dyadic event data using temporal point processes has attracted much of recent research interests in the context of infor-mation diffusion and prediction for social networks [6, 17]. Dyadic Figure 1: Illustration of the Dyadic Event Attribution Problem events refer to the timestamped interactions involving pairs of ac-tors, e.g., one user sending an email message to another, one user retweeting a post of a particular celebrity, or the Taliban force at-tacking civilian. Dyadic event data arise in a wide range of social network applications, such as communication studies, social media, crime prevention, and health care. The analysis of dyadic events is generally much more complicated than the analysis of events with single actors [9]: particular consideration needs to be given to the interdependency among events and to the relationship among actor-pairs [10]. For instance, an attack on the Afghanistan army by the Taliban may incur counter-attacks from Afghanistan army X  X  allies, resulting in conflicts between U.S. army and Taliban or those be-tween British army and Taliban. Such interdependency resulting from the underlying reciprocity or mutuality makes dyadic event data modeling particularly useful and challenging.

The focus of this paper is an important missing data problem in dyadic event data modeling: Because of the difficulty and uncer-tainty in data collection, the dyadic data collected are usually in-complete, and it is generally the case that we have the timestamps of the events but we do not observe the actors of the events [16]. For example, we may observed an event with civilian casualty but we did not observe who carried out the act. Given a set of dyadic events with some of the events missing one or two actors, we call the in-ference problem of estimating the missing actors the dyadic event attribution problem (DEAP). In this paper, we will develop tempo-ral point process models to tackle DEAP and the key to its solution is the exploration of the clustering and self-and mutual-excitation properties of the events. The solution of DEAP will enhance our understanding of dyadic event dynamics and it is also useful for down-stream applications such as dyadic event classification and visualization.

Before we proceed to technical discussions, we use a real-world application, the Armed Conflict Location and Event Data (ACLED), to illustrate DEAP. ACLED is a very comprehensive public col-le ction of political violence data for developing countries [1, 15]. ACLED contains several data sets categorized by geographic re-gions, such as Africa and several Asian states. In the Afghanistan data set, for example, 36 . 3% of the events are without the actor-pair information which will be called unidentified events, while for the African dateset, unidentified events account for 16 . 9% . DEAP is then a problem of attributing the actor-pairs to those unidentified events (Figure 1), i.e., inferring the actor-pairs of those unidenti-fied events based on their timestamps as well as the timestamps and actor-pairs of those identified events. (b) Conflicts between Taliban &amp; Civilans, Taliban &amp; Police F orce, Taliban &amp; Afghan Government Figure 2: Sequence of dyadic events recoding conflicts dur-ing the period 2007-2011: Blue line denotes the conflicts be-tween Tibalan and civilians, and red line denotes other conflicts Tibalan involved in
Next we show that the clustering and self-and mutual-excitation properties of the events can play a key role for solving DEAP. Fig-ure 2(a) shows the sequence of 149 dyadic events of conflicts be-tween Taliban and civilians during the years 2007-2011. In this sequence, 70% conflicts happened within 5 days of the previous conflict, i.e., the sequence shows chain reactions where the occur-rence of one conflict tends to increase the probability of conflicts in the near future. For instance, Taliban X  X  attack against civilians can result in civilians X  protest against Taliban. We also find that one conflict not only will trigger future conflicts happen between the same actor-pair, but also future conflicts that share at least one actor. For instance, in a large-scale terrorist attack, Taliban may attack U.S army, Afghanistan army, and civilians in sequence. Tal-iban X  X  attack against civilians may cause Afghanistan army to re-venge. Figure 2(b) shows the sequence of conflicts happen between Taliban &amp; civilians, Taliban &amp; Afghan Government, Taliban &amp; Po-lice Force. We find that over 93% conflicts between Taliban and civilians happened within 5 days of the previous conflicts that Tal-iban involved in, i.e. any conflicts Taliban participated in probably caused conflicts between Taliban and civilians in the near future.
Our main contribution is to propose principled probabilistic mod-els based on mixtures of Hawkes processes that simultaneously addresses DEAP and network parameter inference underlying the probabilistic models. We model the interactions between each actor-pair using a Hawkes process. These Hawkes processes mutually affect each other as we consider the interdependency among the dyadic events shared by at least one actor. In addition, we discuss an additive model to incorporate regularization considerations on model parameters to avoid overfitting.

We conduct experiments on both synthetic and the ACLED data set to evaluate the performance of our proposed methods, and com-pare them with the state-of-the-art methods. We find that the pro-posed methods are capable of significantly improve accuracy in DEAP. Results on ACLED provide us a clear view of the trigger and influence of conflict events under different factors like time, regions, and actors.
Recent works usually modeled social networks that vary with time by self-exciting point processes. One important self-exciting process is the Hawkes process, which was first used to analyze earthquakes [13], and later applied to a wide range of tasks such as market modeling [5, 2], crime modeling [16], terrorist [14], con-flict [18], and viral videos on the Web [4]. An EM framework was proposed to estimate the maximum likelihood of Hawkes processes [11]. However, most existing works focused on modeling the be-haviors of a single user.
 Our research is inspired by a recent work on DEAP targeting Los Angeles gang network. Gang activities are successfully modeled using Hawkes processes [16, 8]. However, these existing works employed substantial approximation schemes and failed to opti-mize the data likelihood. Another recent work on DEAP proposed a spatial-temporal latent point process that independently modeled a number of distinct event-cascades [3], which ignored the influence among dyadic events that share at least one actor.
Before proposing our model for DEAP, we briefly describe a powerful statistical tool, Hawkes processes, for modeling and ana-lyzing event sequence data. A univariate Hawkes process { N defined by where  X  : R  X  R + is a deterministic base intensity (i.e. how likely an event will occur when no other event triggers it),  X  : R is a kernel function expressing the postive influence of past events on the current value of the intensity process [7]. The process is well known for its self-exciting property, which refers to a common social phenomenon that the occurrence of one event increases the probability of related events (events of the same type or share at least one actor) in the near future.

The multivariate Hawkes process { N m ( t ) | m = 1 , . . . , M } , a multi-dimensional extension to the univariate case, describes the occurrences of M coupling point series [7, 12]. The intensity func-tion  X   X  = [  X   X  1 , . . . ,  X   X  M ] &gt; is defined by where  X  m 0 m is a triggering kernel between a pair of dimensions m 0 and m . This process is also known as linear mutually exciting process since the occurrence of an event in one dimension increases the likelihood of future events in all dimensions. Hence the Hawkes process is suitable for DEAP as it ties unidentified events and iden-tified events together through multiple dependencies. Figure 3: Illustration of the dependency among dyadic event in our mixture model. Existing works only model the dependency
This section introduces a novel probabilistic model based on mixtures of Hawkes processes (MHP) that simultaneously addresses DEAP and network parameter inference. DEAP can be formu-lated as follows: our observation is a sequence of N dyadic events, t , n = 1 , . . . , N , where t n is the time-stamp of the n -th event. These N dyadic events belong to M actor-pairs, for each n , we as-sociate a M -dimensional binary vector Z n = [ Z n, 1 , . . . , Z and Z n,m = 1 if and only if the n -th event happens on actor-pair m . Here only part of actor-pair Z n  X  X  are observed, while other Z are unknown. Based on t n  X  X  and observed Z n  X  X , DEAP predicts un-known Z n  X  X , in order to maximize the likelihood on the complete data ( Z, t ) = { ( Z n , t n ) } N n =1 .

We predict unknown Z n  X  X  of dyadic events based on their inter-actions with related events that share at least one actor with them. And we take such interactions as exciting processes where each event will raise the probability of all the related events in the near future. We turn to the Hawkes process to model such interactions.
We model the interactions between the two actors in each actor-pair as a Hawkes process. That is to say, for each m , m = 1 , . . . , M , the intensity of the model on actor-pair m is defined as: where S m is the set of actor-pairs that share at least one actor with actor-pair m . The above definition illustrates that the probability of a dyadic event at timestamp t is influenced by all dyadic events that share at least one actor with it 1 . Figure 3 compares the dependency among dyadic events modeled in our work with that modeled in state-of-the-art methods.

In DEAP for conflict data, the baseline intensity  X  m ( t ) cap-tures how often actor-pair m starts a conflict spontaneously (i.e., not triggered by any other conflicts). For simplicity, we assume this cascade-birth process is a homogeneous Possion process with  X  m ( t ) =  X  m . Kernel  X  m 0 m ( t  X  t l ) captures the influence between sequential conflicts. We propose to decompose this pairwise trig-gering kernel into here for simplicity, we assume the degrees of influence from all historical events to the current event from actor-pair m are similar and enforce that  X  m 0 ,  X   X  m 0 m =  X  m . Thus  X  m models the degree of
F or each event that shares at least one actor with actor-pair m , obviously we have P m 0  X  S influence from any historical event to the current event from actor-pair m . And  X  ( t  X  t l ) 2 captures the time-decay effect only. Suppose we have observations ( Z, t ) = { ( Z n , t n ) } observation window [0 , T ] , the likelihood for the complete data is L ( Z, t ) =
In this section, we derive a mean-field variational Bayesian in-ference algorithm for our proposed MHP model.
 For the likelihood L ( Z, t ) discussed above, the latent variables Z  X  X  are inter-dependent, i.e., the actor assignment at current step Z n depends on all the past actor assignments { Z 1 , . . . , Z well as all the future ones { Z n +1 , . . . } . Marginalizing over such inter-connected series is intractable. We use mean-field variational inference by assuming a fully-factorizable variational distribution q for Z  X  X , which is parametrized by free variables  X   X  X  as With the help of q , we lower-bound the log-likelihood: where L ( Z, t ) = log( L ( Z, t )) , and E [ q ] denotes the Shannon en-tropy of Z  X  X  under q . L denotes the right-hand side of Eqn (1), known as the evidence lower-bound (ELBO), which is the alter-native of the true log-likelihood we are to optimize. We have where the second term reduces to where K ( t ) = R t 0  X  ( s ) ds .
 To break down the log-sum in E q [log(  X  m ( t n ))] , we again apply Jensen X  X  inequality where we introduce a set of branching variables {  X  ( m )  X  ( m ) is a N  X  N lower-triangular matrix with n -th row  X 
O ur paper uses the exponential kernel in experiments, i.e.,  X  ( X  t ) =  X e  X   X   X  t if  X  t  X  0 or 0 otherwise. However, the model development and inference is independent of kernel choice and extensions to other kernels such as power-law, Rayleigh, non-parametric kernels are straightforward. Figure 4: Graphical model representation of MHP and the v ariational distribution that approximates the likelihood [  X  1 ,n , . . . ,  X  lowing: Figure 4 concludes the graphical model representation of our MHP model and the variational distribution used to approximate the data likelihood.

Optimizing the Lagrangian of L 0 , we have the following infer-ence rule for  X   X  X :  X   X   X  Notice that the above inference rule only applies to those  X  whose corresponding Z n,m  X  X  are unknown. For those  X  nm  X  X  whose corresponding Z n,m  X  X  are already known, we just set  X  nm In a similar way, we obtain the following update rules for  X  : Next we derive maximum likelihood estimation of our proposed MHP model. This model involves two parameters, i.e., the self-instantaneous rate  X   X  R M + and the infectivity vector  X   X  R where R + denotes the nonnegative real domain. Setting the deriva-tive of L 0 with respect to  X  m and  X  m to zero, we can obtain:
Based on above discussions, we obtain a mean-field variation inference algorithm, named MHP, iteratively updates  X   X  X , and  X   X  X  to attribute unidenfied dyadic events, and updates  X   X  X , and  X   X  X  to infer the network diffusion. The computation complexity of MHP is O ( M  X   X  N 2 ) , where  X  N is the average number of events one actor involved in. Thus MHP is particularly efficient if all events happen between limited actor-pairs.
This section describes an additive model that regularizes model parameters  X  and  X  to avoid overfitting. Instead of modeling each actor-pair m with parameters  X  m and  X  m , we model each actor i with parameters  X  0 i and  X  0 i . These new parameters {  X  i = 1 ,  X  X  X  , I ( I is the number of actors) replace  X  m  X  X  and  X  through the following rules: where m 1 and m 2 are the two actors in the actor-pair m . Eqn (3) emphasizes that 1) each actor has his/her own behavior pattern (  X  ,  X  0 i ) in conflicts; 2) the behavior pattern of one actor-pair (  X   X  m ) depends on the behavior patterns of both actors. We named the new algorithm solving this additive model Additive Mixture Hawkes Process (AMHP) algorithm.
We conducted experiments on synthetic and real-world data sets, and compared the performance of our MHP/AMHP algorithm with state-of-the-art DEAP methods including: Parameter-Fixed Hawkes Process (PFHP) proposed in [16], Estimate &amp; Score Algorithm (ESA) proposed in [8] and Latent Point Process Model (LPPM) proposed in [3].
We also test our methods on Synthetic data and its varia-tions listed as bellow: Synthetic data : Under a setting ( n, N, I, M,  X   X ,  X   X  ) , the syn-Structured data : To test the effectiveness of AMHP, we sim-Event Noisy : We generate additional 10%  X  N dyadic events Intensity Noisy : Instead of using  X   X  ( t ) to simulate the dyadic
Our experiments also used two real-world data sets both com-ing from the ACLED data set [1]: Afghanistan Conflict , which contains N = 3 , 384 dyadic events and 68 actors. M = 1 , 010 actor-pairs are involved in these events; Africa Conflict , which contains N = 52 , 605 dyadic events and 3 , 537 actors. M = 1 , 007 actor-pairs are involved in these events. We randomly select 10% events from each data set as unidentified events, and make prediction using our proposed methods.
T his series of experiments is to test the accuracy of DEAP for unidentified dyadic events on synthetic data. Table 1 shows our test on a relatively small system with N = 120 , n = 8 , I = 4 , M = 6 ,  X   X  = 0 . 01 ,  X   X  = 0 . 5 , where simulations were run 10,000 times using the pre-generated parameters {  X  m } , {  X  m } . Table 2 shows results on a larger system with N = 10000 , n = 1000 , I = 50 , M = 200 ,  X   X  = 0 . 01 ,  X   X  = 0 . 5 , where simulations were run 20 times. The accuracy of DEAP is measured by the percentage of unknown events whose ground-truth actor-pairs ap-pear in the predicted top k most likely actor-pairs. Results in Ta-ble 1 and 2 show that LPPM, MHP and AMHP are much more accurate than PFHP and ESA in DEAP on both data sets, which demonstates the importance of using dynamic Hawkes parameters in modeling diffusion processes of dyadic events, and reasonably optimizing the data likelihood. Our proposed MHP and AMHP are more accurate than LPPM, which shows the importance of model-ing dependency between dyadic events from different actor-pairs. At last, AMHP performs better than MHP, which indicates that ap-propriate constraints on Hawkes paramters can benefit DEAP. On Structured data , the advantage of AMHP over other meth-ods becomes greater, which demonstrates the effectiveness of AMHP on dyadic data where the dependency network of actor-pairs has special structures like low-rank or sparsity. On both noisy data sets, the performance of all four compared methods become worse. However, the degradations of the performance of PFHP and ESA are greater than those of LPPM, MHP and AMHP, which shows the robustness of our proposed methods facing noise.
 Table 1: Overall Performance on Small-scale Synthetic Data
The following series of experiments study how parameter vari-a tion affects the accuracy of DEAP. In experiments, we varies the parameter chosen to test, with all other experiment settings fixed. Figure 5(a) shows how the precision of Top 1 inference varies with respect to the increase of the number of actor-pairs M . We can find that all compared methods experience significant decreases when the number of actor-pairs M increases. The degradations of MHP and AMHP are smaller than other methods, which shows that ap-propriately modeling the dependency among actor-pairs becomes more important as the number of actor-pairs increases. Figure 5(b) shows that the accuracy of Top 1 inference decreases wrt. the increase of standard variance  X  in Eqn (4). The degradations of LPPM, MHP, and AMHP are smaller than PFHP and ESA, which from another prospect demonstrates the robustness of our methods facing noise.
Next we apply the proposed model to two real-world data sets as shown in Table 3. On both real-world data sets, our proposed MHP and AMHP again perform better than LPPM, PFHP and ESA. We also find that AMHP outperforms MHP, which illustrates that the underlying dependency network of actor-pairs in real-world data has some special structures.
 Table 2: Overall Performance on Large-Scale Synthetic Data N = 10000 , n = 1000 , I = 50 , M = 200 ,  X   X  = 0 . 01 ,  X   X  = 0 . 5 . (a) Accuracy of Top 1 wrt. M Figure 6 shows a relational graph among actors in A fghanistan Conflict data based on learned  X  m  X  X . A large  X  m indicates that one conflict between actor-pair m is quite likely to be trig-gered by another conflict sharing at least one actor with m in the recent past. Most areas in the figure are blank, which illustrates that most sequential conflicts in Afghanistan happened between limited actor-pairs. Analyzing shades of color in each grid, we can find out unique behavior patterns of different actor-pairs. For exam-ple, comparing  X  m o f pair Taliban X  X .S. Army and that of pair Taliban X  X fghan Government , we can tell that one conflict event involving Taliban or U.S. army will quickly cause a chain reaction between the Taliban X  X .S. Army pair, while it takes much longer time for a conflict involving Taliban or Afghan government to trig-ger consequential conflicts. In other words, when suffering an at-tack or protest, Taliban X  X  favorite retaliation target is U.S. Army rather than Afghan government. Figure 6: Relational Graph among Actors in A fghanistan Conflict Based on Learned  X  m  X  X . Indice of important actors: F igure 7: How Well Our MHP Model Fits Conflict Data. Blue
Next we study how well our MHP model fits conflict data. On a certain actor-pair m in Afghanistan Conflict , Figure 7(a) compares the number of conflict events at each timestamp with the curve of  X  m ( t ) using learned  X  m and  X  m , while Figure 7(b) shows the Q-Q plot of the real conflict sequence versus the sample event sequence simulated by  X  m ( t ) . We can find that although the  X  and  X  m are inferred with part of Z n  X  X  unknown, they fit both iden-tified conflicts and unidentified conflicts very well.
This paper proposed a novel mixture Hawkes model for tack-ling DEAP and network inference simultaneously. This mixture Hawkes model captures the dependency among dyadic events from actor-pairs that share at least one actor. Our fast inference algo-rithm based on mean-field methods iteratively predicts actor-pairs and infers network diffusion. Experiments on both synthetic and real-world data sets on international armed conflicts demonstrated the effectiveness of the proposed methods.

In the future, we will look for alternative solutions that capture the dependency among dyadic events from different actor-pairs, and propose novel mixture Hawkes models. Instead of using a human-defined regularization for model parameters, we will ex-plore how to infer structures, such as low-rank or sparsity, from data. We will also study more efficient algorithms that optimize our proposed likelihood.
Part of this work was supported by NSF grant IIS-1116886, NIH 1R01GM108341, and a DARPA Xdata grant.
