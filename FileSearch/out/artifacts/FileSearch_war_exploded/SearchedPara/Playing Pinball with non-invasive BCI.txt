 Brain computer interfaces (BCI) have seen a rapid development towards faster and more user-friendly systems for thought-based control of devices such as video games, wheel chairs, robotic devices etc. While a full control of even complex trajectories has become possible for invasive BCIs [1, 2, 3], non-invasive EEG-based systems have been considered hardly able to provide such high information transfer rates between man and machine [4, 5].
 This paper will show evidence that real-time BCI control of a machine is possible with little subject training. The machine studied (a standard pinball machine, see Fig. 1 requires only two classes for control but a very fast and precise reaction; predictive behavior and learning are mandatory. We consider it a formidable platform for studying timing and dynamics of brain control in real-time in-teraction with a physical machine. Furthermore this paradigm is well suited for future investigations of mental states during complex real-time tasks and decision-making processes.
 Figure 1: Left: pinball machine used for the present study. Middle: Close look at the build-in gadgets of the play field. Right: Zoom into the modified parts of the play field (side walls and central bump).
 Compared to highly controlled and simplified lab settings, a pinball machine provides flow (accord-ing to the definition in [6]), a rich and complex feedback, acoustic and visual distractors, and a challenging behavioral task. These components are well-known ingredients for engaging and im-mersive game environments [7]. In case of the pinball machine model used in this study, this receives further evidence from the high sales figures that have made the Addams Family model the all-time popular pinball machine.
 Given the reaction-time critical pinball game and the intrinsic delays imposed on the subjects by the BCI technology, it is very interesting to observe that subjects can manage to control and maintain the necessary timing and dynamics. The prediction of upcoming game situations and behavioral adaptation to the machine and BCI constraints are necessary ingredients to master this difficult task. The following Sections Sec. 2 and Sec. 3 briefly introduce the used motor paradigm, spatial filter methods, the experimental paradigm, the decoding and machine learning techniques used, Sec. 4 provides the statistics and results, and finally a brief discussion is given in section Sec. 5. 2.1 Neurophysiology Macroscopic brain activity during resting wakefulness contains distinct rhythms located over various brain areas. Sensorimotor cortices show rhythmic macroscopic EEG oscillations (  X  -rhythm or sen-sorimotor rhythm, SMR), with spectral peak energies of about 8 X 14 Hz (  X  -band) and/or 16 X 28 Hz (  X  -band) localized in the motor and somatosensory cortex ([8]).
 A large class of EEG-based BCI systems relies on the fact that amplitude modulations of sensorimo-tor rhythms can be caused, e.g. by imagining movements. For example, the power of the  X  -rhythm decreases during imagined hand movements in the corresponding representation area which is lo-cated in the contralateral sensorimotor cortex. This phenomenon is called event-related desynchro-nization (ERD, [9, 10]), while the increase of band power is termed event-related synchronization (ERS). This may be observed, e.g., during motor imagery over flanking sensorimotor areas, possi-bly reflecting an  X  X urround inhibition X  enhancing focal cortical activation, see [11, 10]. The exact location and the exact frequency band of the sensorimotor rhythm is subject-specific. Hence indi-vidually optimized filters can increase the signal-to-noise ratio dramatically [12]. To this end, the CSP technique has proven to be useful. 2.2 Common Spatial Pattern (CSP) Analysis Common Spatial Pattern and its extensions (e.g. [13, 14, 15, 16, 12]) is a technique to analyze multi-channel data based on recordings from two classes (conditions). It is used e.g. in BCI systems based on the modulation of brain rhythms. CSP yields a data-driven supervised decomposition of the signal parameterized by a matrix W  X  IR C  X  C 0 ( C being the number of channels; C 0  X  C ) that surrogate sensor space, as follows: Each column vector of W represents a spatial filter. In particular CSP filters maximize the EEG sig-nal X  X  variance under one condition while simultaneously minimizing it for the other condition. Since variance of band-pass filtered signals is equal to band power, CSP analysis is applied to band-pass filtered signals in order to obtain an effective discrimination of mental states that are characterized by ERD/ERS effects (see above). In the example of left vs. right hand motor imagery, the CSP al-gorithm will find two groups of spatial filters. The first will show high band power during left hand motor imagery and low band power during right hand motor imagery, and the second vice versa. Let  X  i be the covariance matrix of the trial-concatenated matrix of dimension [ C  X  T ] (where C is the number of electrodes and T is the number of concatenated samples) belonging to the respective class i  X  X  1 , 2 } . The CSP analysis consists of calculating a matrix W  X  IR C  X  C and a diagonal matrix D with elements in [0 , 1] such that where I  X  IR C  X  C is the identity matrix. This can be solved as a generalized eigenvalue problem. The projection that is given by the i -th column of matrix W has a relative variance of d i ( i -th element of D ) for trials of class 1 and relative variance 1  X  d i for trials of class 2. If d i is near 1, the filter given by the i -th column of W (i.e., the i th spatial filter) maximizes the variance for class 1, and since 1  X  d i is near 0, it also minimizes the variance for class 2. Typically one would retain projections corresponding to two or three of the highest eigenvalues d i , i.e., CSP filters for class 1, and projections corresponding to the two or three lowest eigenvalues, i.e., CSP filters for class 2. For a detailed review of the CSP technique with respect to the application in BCI see [12]. 3.1 Paradigm Standard EEG lab experiments typically realize an environment that avoids distractions in order to have maximum control over all parameters of the experiment. Since the subjects respond to a small number of artificial stimuli, a stimulus-locked averaging reveals the average characteristics of their brain response. If we are interested in understanding broader behavioral brain responses in cognitively demanding natural environments then stimulus/response-locked averaging may no longer be easily possible. The complexity in interaction may be caused by (1) a large number of possibilities to respond, (2) a large spread in response times and quality due to a rich environment (e.g. real objects that have a variety of physical properties), (3) a changing environment where the underlying nonstationarity is caused by a large number of states, and possibly by even more, but unknown influencing factors.
 While the first steps towards complex paradigms use simulators that show an increased complexity but still allow complete introspection into the system state, it is evident that the interaction with real physical devices has an even higher complexity but also provides a rich multi-modal sensory experience for the user. However, gaining even only partial introspection into the system states of complex physical devices and into the interaction processes between the system and the mental processes of the user requires a huge effort.
 Here modern machine learning and signal processing methods (e.g. [17, 18, 19, 20]) are helpful, since they have been developed to analyze EEG on a single trial basis (e.g. [21, 22]). They can adapt to changing signal characteristics (e.g. [23, 24, 25]) and they can deal with missing and noisy data [26, 27]  X  even beyond the field of computational neuroscience and BCI [28]. 3.2 Setup In this study seven subjects played with the pinball machine. They were known for well-classifiable EEG signals in simple BCI applications. One subject played successfully and enjoyed it, but was excluded from further analysis as his/her games had not been video-taped. From the remaining six subjects, three managed to acquire good control, played very successfully and enjoyed this experi-ence. One subject managed to get limited control and reported to enjoy the games although some of his/her scores were close to chance. The performance of these four subjects was measured in a rigorous manner. The remaining two subjects could not establish reliable control and were also excluded from further analysis.
 An overview of the technical setup and the data processing steps involved is given by Fig. 2. The ex-periment was organized in several stages: the calibration of the BCI system (Sec. 3.3), the fine-tuning of parameters in a simple cursor feedback paradigm (Sec. 3.4), the application of the BCI control system during pinball games (Sec. 3.5), the pseudo-random control of pinball games (Sec. 3.6), and ball insertions without any paddle activity (Sec. 3.7).
 Figure 2: Schematic view of the BCI-controlled pinball machine. The user X  X  EEG signals upon motor imagery are amplified, digitized, filtered in the frequency domain and the spatial domain by CSP. Band power features are extracted and classified. The classifier output is translated by a low-level controller into paddle movements. 3.3 Calibration of the BCI system The BCI system was calibrated individually for each of the subjects ( VPMa , VPks , VPzq , VPlf ) to discriminate two classes of motor imagery (left hand and right hand). The calibration procedure followed a standard Berlin BCI (BBCI) paradigm based on spatial filters and oscillatory features that avoids and prevents the use of class-correlated EOG or EMG artefacts (see [29, 28] for details). Visualizing the spatial filters and the resulting patterns of activity showed that EOG or EMG com-ponents were disregarded for the calibration of the BCI system. For the calibration, 100 ( VPMa ) or 75 ( VPks , VPzq , VPlf ) trials of motor imagery were collected for each class. For every trial of 4 X 5s duration, the class of the motor imagery was indicated on a computer screen by visual cues. The calibration procedure included the determination of a subject-specific frequency band for the mu-rhythm (see Sec. 2.1), filtering the 64-channel EEG-data to this band, the determination of class-discriminant spatial filters with Common Spatial Pattern (CSP, see Sec. 2.2), and the training of a regularized linear classification method (LDA) based on the power features of the filtered data. All subjects showed a crossvalidation error below 10% on the calibration data. 3.4 Cursor feedback control by BCI The bias of the classifier, a gain factor and thresholds for an idle-class (for classifier outputs close to the decision plane) were adapted during a short control task running on a computer screen. The subject had to control a horizontally moving cursor to a target on the left or right side of the screen for approximately 2 minutes while fixating a cross in the center. During this procedure the above mentioned parameters were fine-tuned according to the test persons X  X  ratings. The goals were to determine parameter values that translate the classifier output to a suitable range for the final appli-cation and  X  for the test persons  X  to reach a subjective feeling of control. For an exhaustive study on the role of bias adaptation in BCI, especially in the context of changing from calibration to feedback, see [30, 24]. 3.5 Pinball control by BCI A real, physical pinball machine (in our study an Addams Family model) needs good control in terms of classification accuracy and timing (dynamics).
 The subject has to learn the physical properties of the machine to play well. The subject X  X  expecta-tion needs to be trained as bumpers, magnets like  X  X he Power X  and many other built-in sources of surprise (see middle image in Fig. 1) can cause the ball to go into rather unpredictable directions. This interaction with the pinball machine makes the game interesting and challenging. Fast brain dynamics that participate in the eye-hand coordination and visual memory play an essential role to cope with these difficulties. The task difficulty increases further, as with any game, there is a strong emotional engagement of the subject which gives rise to non-stationarities in the statistics. Moreover the physical machine is very noisy and distracting due to its various sources of visual and auditory stimulation, and only a small percentage of these stimulations is task relevant.
 Three modifications were implemented in order to reduce the frequency of manual ball launches (1 and 3) and to increase the frequency of balls passing the paddle areas (1 and 2). While the original character of the game was not changed, the modifications introduced slight simplification to conduct the experiment. The right image of Fig. 1 depicts the modifications: During the BCI-controlled gaming ( X  bci  X  control mode), the subject sat in front of the pinball ma-chine, hands resting on the arm rests except for short times when new balls had to be launched with the pulling lever. The EEG signals recorded in the previous 500ms were translated by the BCI system into a control signal. A simple low-level control mechanism was implemented in software that translated the continuous classifier output by thresholding into a three-class signal (left flipper, idle, right flipper) using the thresholds pre-determined during the cursor control (see Sec. 3.4). Fur-thermore it introduced a logic that translated a very long lasting control signal for the left or right class into a hold-and-shoot mechanism. This allowed the user to catch slow balls rolling sideways down towards a paddle. The user played several games of 10 to 12 balls each. Performance was observed in terms of the playing time per ball, the score per game and the number of high-quality shots. The latter were defined by the presence of one of the following two conditions, which have been evaluated in an offline video analysis of the game: (1) a precisely timed shot that hit the ball by the center of the paddle and drives it into one of the scoring zones of the lower half of the field and (2) a precisely timed shot that drives the ball directly into the upper half of the field. 3.6 Pseudo random control mode This  X  rand  X  control mode was incorporated into the experimental setup in order to deliver a fair performance baseline. Here, the BCI system was up and running with the same settings as in the BCI-controlled pinball game, but no player was present. Instead an EEG file previously recorded during the BCI-controlled pinball game was fed into the BCI system and generated the control signal for the pinball machine. These signals produced the same statistics of paddle movements as in the real feedback setting. But as the balls were launched at random time points, the paddle behavior was not synchronized with the ball positions. Therefore, the pseudo random control mode marks the chance level of the system. In this mode several games of 10-12 balls each were performed. The same performance measures were applied as for BCI-controlled gaming. 3.7 No control mode For performance comparisons, two performance ratings (time per ball and points per game) were also taken for a series of balls that were launched without any paddle movements ( X  none  X  control mode). As video recordings have been available for the four subjects, a detailed analysis of the game per-formances was possible. It is introduced for the example of the best subject VPMa in Fig. 3. The analysis compares three different scoring measures for BCI control ( bbci ), pseudo-random control ( rand ) and no control ( none ) and shows the histogram of high-quality shots per ball. The average Figure 3: Performance comparison for three control modes of the pinball machine and the normal-ized histograms of high-quality shots per ball for subject VPMa . ball duration (median) is significantly higher for the BCI-controlled gaming (average of 15s over 81 balls) than for the pseudo-random control (average of 8s over 112 balls). A confidence interval is reflected by the notches above and below the median values in the boxplot of Fig. 3. Boxes whose notches do not overlap indicate that the medians of the two groups differ at the 5% significance level. The increased average ball duration under BCI control is caused by the larger number of high-quality shots per ball. While in pseudo-random control only 7% of the balls scored more than one high-quality shot per ball, this rate raises drastically to 45% for the BCI control of subject VPMa . A comparison of the game scores for 10 games of BCI control and 10 games of pseudo-random control shows, that these differ even stronger due to the nonlinear characteristic of the score. The rightmost plot in Fig. 3 shows the normalized histograms of the high-quality shots.
 The pooled data of all four subjects in Fig. 4 reflects these performance differences to a large ex-tend. Again, BCI control is significantly superior to the pseudo random control. The difference in normalized histograms between BCI control and pseudo random control reveals, that even for the pooled data BCI-controlled games more often have a larger number of high-quality shots. Not surprisingly, the BCI-controlled games showed a number of paddle movements in moments, when no ball was in the vicinity of the paddles. These so-called false hits are indirectly reflected in the performance measures for the pseudo-random control. As pseudo-random control mode was able to gain significantly better results than no control at all (see e.g. modes rand and none in Fig. 3), these false hits can not be neglected. In order to study this issue, the pseudo-random control was based on an EEG file, which had been previously recorded during the BCI-controlled gaming, the dynamics of the paddle movements was identical during both of these control modes. Under these very similar conditions, the higher scores of the BCI control must be credited to the control ability of the BCI user, especially to the precise timing of a large number of paddle shots. A video of the gaming performance which provides an impression of the astonishing level of timing and dynamical control  X  much better than the figures can show  X  is available under http://www. bbci.de/supplementary/ . It should be added that for this experiment it was very easy to recruit highly motivated subjects, who enjoyed the session. Figure 4: Performance comparison for combined data of four subjects ( VPMa , VPks , VPzq , VPlf ). To date, BCI is mainly perceived as an opportunity for the disabled to regain interaction with their environment, say, through BCI actuated spelling or other forms of BCI control.
 The present study is relevant to rehabilitation since it explores the limits of BCI with respect to timing, dynamics and speed of interaction in a difficult real-time task. We would, however, like to re-iterate to consider machine learning methods developed in BCI also as novel powerful tools for the neurosciences  X  not only when operated invasively for harvesting on local field potentials (LFP) and on micro electrode array data [1, 2, 3] or for decoding functional MRI [31]  X  but also for non-invasive, low-risk EEG-BCI.
 An important novel aspect of our study was to analyze EEG recorded during predictive behavior, in other words we made use of the subject X  X  expectation and experience of the system delay. Learning curves and traces of adaptation on the subject side, the use of error potentials as well as emerging subject specific strategy differences and many other exciting question must remain untouched in this first study. Emotion, surprise and other mental states or cognitive processes that play an important role in such complex real-time paradigms still await their consideration in future studies. Acknowledgments We thank Brain Products GmbH for funding and for help with the preparation of the pinball ma-chine. Funding by the European Community under the PASCAL Network of Excellence (IST-2002-506778) and under the FP7 Programme (TOBI ICT-2007-224631), by the Bundesministerium f  X  ur Bildung und Forschung (BMBF) (FKZ 01IBE01A and FKZ 16SV2231) and by the Deutsche Forschungsgemeinschaft (DFG) (VitalBCI MU 987/3-1) is gratefully acknowledged. Last but not least, we would like to thank our reviewers for their valuable comments.

