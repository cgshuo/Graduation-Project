 Social recommendation, which aims to systematically leverage the social relationships between users as well as their past be-haviors for automatic recommendation, attract much attention recently. The belief is that users linked with each other in social networks tend to share certain common interests or have similar tastes ( homophily principle ); such similarity is expected to help improve the recommendation accuracy and quality. There have been a few studies on social recommendations; however, they almost completely ignored the heterogeneity and diversity of the social relationship.

In this paper, we develop a joint personal and social latent factor (PSLF) model for social recommendation. Speci fi cally, it combines the state-of-the-art collaborative fi ltering and the so-cial network modeling approaches for social recommendation. Especially, the PSLF extracts the social factor vectors for each user based on the state-of-the-art mixture membership stochas-tic blockmodel, which can explicitly express the varieties of the social relationship. To optimize the PSLF model, we develop a scalable expectation-maximization (EM) algorithm for fast ex-pectation computation. We compare our approach with the latest social recommendation approaches on two real datasets, Flixter and Douban. With similar training cost, our approach has shown a signi fi cant improvement in terms of prediction accuracy criteria over the existing approaches.
 H.3.3 [ Information Search and Retrieval ]: :Information Filter-ing; J.4 [ Computer Applications ]: :Social and Behavioral Sci-ences Social Recommender Systems, Personal + social Factor
Recommendation systems are playing increasingly important role for Etailers and service providers: providing each individual with the  X  X est X  options matching with their tastes and needs. By doing so, companies can foster customers X  satisfaction and loy-alty, and even boost the sale and attract more potential customers. In the meantime, users may view recommendation itself as an indispensable service as it can help them save time and effort in discovering what they like or need. In the past, recommenda-tion systems mainly focus on utilizing users X  historical behaviors, such as their preferences on the purchased products/services (of-ten represented in terms a user-item rating matrix R , illustrated in Figure 1(a)) for collaborative fi ltering [1, 10].

Thanks to the booming online social networking websites, users are explicitly linked and often (un)knowingly recommend prod-ucts/services to friends. Numerous websites [16] directly utilize the social networks to enable users to share opinions and recom-mends stuffs, such as books, movies, and/or musics, etc. to one another. More recently, there have been lots of interest in social recommendation , which aims to systematically leverage the so-cial relationships between users (Figure 1(b)) as well as their past behaviors for automatic recommendation. The belief here is that users linked with each other in social networks tend to share cer-tain common interests or have similar tastes ( homophily princi-ple [12]), which can help increase the recommendation accuracy. However, how to discover and utilize the common denominators hidden in the complex and massive social network is not a trivial problem.

There have been a few recent attempts at social recommenda-tions [5, 11, 18], which are all based on the assumption that any pair of friends in the social network shall have similar interests. The recent studies [11, 18] incor porate such a network-based similarity property between users into the state-of-the-art matrix factorization recommendation approaches [10]. The matrix fac-torization approaches map both users and products to a common latent factor space R k (each dimension encodes a latent factor). In movie recommendation, for instance, one latent factor (dimen-sion) may represent the degree of actions and/or violence and another one may encode the movie cost. Each user u i is charac-terized by a latent factor vector U i  X  R k , which represents her or his personal interests/tastes; and each item v j is also represented by a vector V j  X  R k , describing its key features and composi-tions. Given this, the inner product ( U T i V j ) of these two latent factor vectors ( U i and V j ) is used to predict the likely rating of user u i on item v j . The higher is the value ( U T i V j likely is a match (between user u i and item v j ). Mao et al. [11] propose a social-network based regulation on top of the latent factor model, which targets to constrain the difference between the latent vectors of user u i  X  X  friends and user u i , i.e., || U shall be small where u f is u i  X  X  friend. Yang et al. [18] take one two users u i and u f can directly help to recover whether u u j is linked in the social network. Basically, the higher is the (a) User-Item Rating Matrix R (b) User-Social Network G value U T i U f , the more similar they are and the more likely they are friends. Both approaches have shown reasonable improve-ment over the state-of-art recommendation approaches which do not utilize the social factors.

However, the basic underlying assumption about social rela-tionships used in the existing social recommendation approaches is too strict to be realistic: they almost completely ignored the heterogeneity and diversity of the social relationship. Users in an online social network, such as Facebook, are linked or become  X  X riends X  because of different reasons, including family, friends, classmates, or even business relationships, among many others. For different types of interactions, the common denominators (shared interests or preferences) might be quite different. From a user-centered viewpoint, each user u i may be characterized by a set of social tags (factors), such as  X  X ar dealer X ,  X  X kiing enthu-siast X ,  X  X ood-lover X , etc.; one of his neighbors u f in the social network might only share the common attribute  X  X ar dealer X , and another one u f with may be his ski-buddies who teaches in the nearby college. Thus, an interest on an adventure movie, may be propagated between u i and his  X  X kiing enthusiast" friend, but may not necessarily be shared with his  X  X ar dealer X  colleague. On the other hand, two users at different states with many similar interests may not know one another and never become friends.
Thus, the (dis)similarity measure of the latent factors, such as the difference || U i  X  U f || or the inner product U T i be an appropriate factor to determine the likelihood of existing social relationship. In the meantime, however, the social factors of an individual do directly affect her or his preferences towards an item. Given this, the key challenge is how to discover those la-tent social factors of individual user and how to effectively utilize them to boost the recommendation accuracy.
In this paper, we propose a joint personal and social latent fac-tor (PSLF) model for social recommendation, which utilize both users X  past behaviors and the social relationships. Similar to the matrix factorization approaches, each user u i (and each item v is represented by a personal (item) latent factor vector, U in a uni fi ed user-item factor space R k . However, instead of using the social relationship to constraint those personal factors, the new model explicitly represent each user u i with an additional social factor vector  X  i in another space S d , which can also be linearly transformed and mapped to the user-item factor space R k , denoted as M T  X  i ,where M is the linear transformation matrix. Given this, the model utilizes the joint predictions from both personal and social latent factors, U i V j + X  T i MV likely rating from u i on item v j . Clearly, the major challenge here is how to discover the right social latent factors which can complement and also reinforce the personal latent factors, which have been extensively studied [10].

In this work, we extract the social factor vectors for each user based on the mixture membership stochastic blockmodel [2], which can simultaneously factorize the social network and infer the la-tent social structure. Speci fi cally, in this blockmodel, the net-work is assumed to base on a number of social factors (attributes), and these social factors may interact with one another in certain probability (represented a s a social interaction/connection matrix B ). Furthermore, each user u i is represented as a mixture (social factor vector  X  i ) of social factors; and  X  T i B  X  f represents the likelihood whether user u i and u f are linked.

Even though both personal latent factor model and mixture membership blockmodel for social factors have been studied in-dependently before, to the best of our knowledge, this is the fi rst study which bridges them. Here, we combine the latent factor model and mixture membership blockmodel in a uni fi ed proba-bilistic model for social recommendation; and we study how to optimize the joint model and scale it on large social networks. Especially, we note that in the joint personal and social model-ing, the social latent factors should not only re fl ect the underlying social structures, but also directly contribute to improvise the ac-curacy of the ratings. In other words, users X  past behaviors are also served as the feedback for factorizing the social network. To sum, we make the following contributions in this work. We fi rst propose a novel joint personal and social latent factor model which can effectively utilize both users X  past behaviors and the social network. Our approach combines the collaborative fi ltering and the social network modeling approaches for social recommendation. We develop a fast expectation-maximization (EM) algorithm to optimize the joint factor model. We compare our approach with the latest social recommendation approaches on two real datasets, Flixster and Douban. In the experiments, our approach has shown a signi fi cant improvement in terms of prediction accuracy criteria over the existing approaches. Paper Organization: In Section 2, we formally describe the so-cial recommendation problem and discuss the basic latent factor modeling and its adoption for the problem. In Section 3, we present the joint personal and social latent factor (PSLF) mod-eling. In Section 4, we introduce the fast EM based parameter inference algorithm for the PSLF model. In Section 5, we report the detailed experiments results. Finally, we provide a short re-view of the related work in Section 6 and conclude the paper in Section 7.
The social recommendation problem considers two major data sources: 1) the user-item rating matrix R (recording users X  past behaviors), where R ij indicates the user u i  X  X  preference to item v ; 2) the social network G =( V, E ) ,where ( i, f )  X  E indicate users u i and u f are linked. Here, we consider the social rela-tionship is mutual and thus G is an undirected graph. Figure 1(a) illustrates the rating matrix R and Figure 1(b) shows the social network R . Given this, the social recommendation problem can be de fi ned as learning a model which can effectively predict the missing values in the user-item rating matrix R by employing both R and G .

In the following, we will introduce the basics of latent fac-tor modeling for collaborative fi ltering (Subsection 2.1). Then, in Subsection 2.2, we will given an overview on the latest stud-ies [11, 18] which incorporates the social networks with the latent factor modeling for social recommendation.
The latent factor modeling approach maps both users and items to a common latent factor space R k (each dimension encodes a latent factor). Each user u i is characterized by a latent factor vec-tor U i  X  R k , which represents her or his personal interests/tastes; and each item v j also represented by a vector V j  X  R k , describ-ing its key features and compositions. Given this, the inner prod-uct ( U T i V j ) of these two latent factor vectors ( U i to predict R ij , the rating of user u i on item v j .
Now, we follow the probabilistic matrix factorization (PMF) notation to formally describe the latent factor modeling approach. The rating R ij is modeled using the normal distribution N ( x |  X ,  X  with mean  X  and variance  X  2 : Furthermore, the user (item) latent factor vectors are also mod-eled using the normal distribution with zero mean:
Parameters U =( U i ) , V =( V j ) are estimated through maxi-mizing the log-posterior over user rating behaviors ( R ): where C is a parameter-independent constant. Speci fi cally, p ( U |  X  2 u )= where I ij is the indicator: I ij =1 if user u i rates item v I ij =0 , otherwise. Maximizing the log-posterior with respect to U and V is equivalent to minimize the sum-of-squared-errors objective function with quadratic regulation terms: min where  X  U =  X  2 / X  2 U and  X  V =  X  2 / X  2 V . Usually, an iterative method, such as gradient descent method, can be employed to fi nd the local optimum of U and V .

Recently, Koren in [9] make a major improvement over the ex-isting latent factor model by taking the similarity between items (users) into consideration. The neighborhood-based latent factor model naturally combines the neighborhood model with the la-tent factor model, yielding better performances over pure neigh-borhood and pure latent factor models. Specially, the basic neigh-borhood based latent factor model utilizes the sum: predict R ij ,where R ( i ) is the set of items user u i rated, B the baseline estimator of R ij 1 ,and ( W jj ) are the user-independent parameters for describing the similarity between item j and j .In [9], both the baseline estimator and similarity parameters ( W can be computed to minimize the estimation accuracy, and dif-ferent variants such as using R k ( j ; i ) , which is the set of top k similar items user i has rated, to replace R ( i ) are also discussed.
As we mentioned before, there have been a few studies [11, 18] on social recommendations recently. They all based on the assumption that any pair of friends in the social network shall have similar interests and try to incorporate such a network-based
B ij =  X  + B i + B j ,where  X  is the overall average rating and B i and B j are the observed deviations of user u i and item v respectively. similarity property between users into the latent factor model-ing. Mao et al. [11] introduces the social regulation , i.e., using the social relationship explicitly regulate the latent factor model. Speci fi cally, the individual-based regulation (the best approach in [11]) is modeled as follows: min where the last one is the social regulation term: it targets to min-imize the difference between the latent vectors of user u or his friend u f . Sim ( i, f ) is the similarity between users u u f and can be de fi ned in terms of either Vector Space Similarity (VSS) or Person Correction Coef fi cient (PCC) [11].

In [18], Yang et al. proposes the Friendship-Interest Propaga-tion (FIP) model, which utilizes the latent space vectors not only for predicting the rating ( U T i V j ), but also for link prediction. Ba-sically, the inner product ( U T i U f ) between two users u can directly help to recover whether u i and u j is linked in the social network. Note that Yang et al. [18] study slightly differ-ent contexts where both users and items have additional features (contents) and the rating is only binary (item recommendation). To facilitate the discussion, we adopt their approach to the typ-ical social recommendation. Thus, the basic FIP model can be described as follows: min where the second term is the error induced by using the user X  X  latent factor similarity to predict their social relationship. The function L ( x, y ) is a loss function for measuring the difference between a binary variable x and a continuous variable y [18]. For instance, the logistic regression log ( x, y )=log[1+ exp (  X  xy )] can be applied here.

As we argued earlier, even though linked users often share cer-tain common denominators (interests, tastes, etc.), ( homophily principle ), this is not equivalent to say that they shall be  X  X imi-lar X . In fact, the similarity on certain interests and tastes between two friends can often be outweighed by their difference on most other aspects. Clearly, the existing approaches have largely ig-nored the heterogeneity and diversity of the social relationship. Using the (dis)similarity measure of the latent factors, such as the difference || U i  X  U f || or the inner product U T i U f predict social relationship is clearly not fully re fl ect or exploit the underlying dimensionality of social networks. In this work, we utilize the social network modeling to help discover the latent social factors S i of an individual user and combine it with the (personal) latent factors ( U i ) to solve the social recommendation problems.
In the section, we present a joint personal and social latent factor (PSLF) model, which utilize both users X  past behaviors and the social relationships for social recommendation. For the personal latent factor, it is similar to the matrix factorization ap-proaches, where each user u i is represented by a personal la-tent factor vector, U i in a uni fi ed user-item factor space R k .For the social latent factor, it is based on the state-of-the-art mix-ture membership stochastic blockmodel [2], which can simulta-neously factorize the social network and infer the latent social structure. The social factor vector of each user u i is represented in terms of his or her mixture membership  X  i in the social net-work. Given this, the model utilizes the joint predictions from both personal and social latent factors, U i V j + X  T i MV likely rating from u i on item v j .
 Figure 2: Social-interest Factor model for recommendation
Figure 2 shows the graphical model of PSLF. The generative process of PSLF model is as follows: 1. For each user u i , 2. For each item v j , draw an item latent vector V j  X  X  k  X  3. For each pair of users ( u i , u f ), 4. For each user-item pair ( u i , v j ), draw the response R 5. For the item pair similarity measure S = V T L T LV ,draw We make the following notes of the joint personal and social la-tent factor (PSLF) model: 1) The generative steps (Steps 1.b and 3) forms the core of the mixture membership stochastic blockmodeling as described in [2]. Recall that in the typical block modeling, each user is con-sidered to be associated with only one group and a block struc-ture can represent at high level how likely one group may interact with another group. The stochastic blockmodel assumes there is an underlying block structure (describe in the matrix B d each user may belong to several groups (latent social factors), which are speci fi ed by  X  i . Thus, the social factor vector  X  help characterize each user X  X  unique underlying social interests and preferences. 2) Because the social latent factor vector  X  i is located in the different space S d as the uni fi ed user-item latent space R k ,an additional matrix M (Step 4) is utilized to linearly transform and map each social vector  X  i to the user-item space M T  X  i new vector M T  X  i can be viewed as the social latent factor in the user-item space R k which complements the personal latent vector U i . We note that the generative representation of matrix M is for penalizing the model complexity. 3) The last step (Step 5) is to incorporate the neighborhood item similarity constraint into the latent factor model, which was ini-tially proposed by Koren in [9]. However, since our approach is based on generative modeling, for the simplicity (and unifor-mity) of technical treatment , we utilize the neighborhood pre-serving regulation ( V T L T LV ) used in matrix factorization [6] and consider it as a response being generated through a normal distribution. We note that also for simplicity, Figure 2 does not explicitly re fl ect this constraint.

Now, let  X =( U, V,  X  ,M,B ) be the model parameter set in the PSLF model; let  X =(  X ,  X ,  X  s , X  u , X  v , X  M ) be the hyper-parameters. Given this, the posterior probability given the user-item rating matrix R and the social work G ( p ( X  ,  X  |R , G ) )is proportional to:
Thus, the social recommendation problem needs to fi nd the optimal model parameters  X  which can maximize the posterior probability given the user-item rating matrix R and the social work G : In the next section, we will discuss how to ef fi ciently infer the model parameters  X  .
In this section, we present an ef fi cient algorithm for parameter inference , which aims to maximize the posteriori distribution (MAP) of the PSLF model.

Since there are hidden variables Z (in the integral form) being included in the PSLF model, naturally the expectation-maximization (EM) method can be utilized: computing Z fi rst in the E-step given parameters  X  , and then update model parameters in the M-step. In general, the M-step can be solved by the gradient based optimization to update model parameters  X  when the hid-den variables Z is explicit estimated; for the E-step, the hidden parameters Z can be estimated by Gibbs sampling (or variational bayesian method), such as:
However, both Gibbs sampling and variational bayesian method which can be too computationally expensive for large networks. To address this problem, in this work, we propose a novel ap-proximate mean-fi eld approximation method for E-step. The new method can reduce the time complexity of E-step to O ( EK In the following two subsections, we elaborate M-step and scal-able E-step for model parameter inference.
The posterior distribution over social latent factors  X  i u can be written as where the dimension of latent social factors denotes K ,andlet Z i,  X  ) be a K dimensional vector, i.e., Z i,  X  =( Z i, 1 ,Z Here each element Z i,k indicates the count of the k th social at-tribute (factor) sampled by user u i , Z ( i,k ) = I is the indicator function. The posterior distribution over  X  the joint probability of modeling social networks and user rating behaviors.

Since the normal distribution and Dirichlet distribution are non-conjugate, we update  X  using the gradient-based approach to maximize posterior distribution over  X  .

Update  X  : where  X  is the pairwise product operator. Since  X  i is speci fi ed as the Dirichlet distribution, which places linear constraints on  X  i (Eqn 14). Thus, the active set method can be utilized to project gradient into feasible region [3]. Here we omit the details due to space limitation.

Similarly, by isolating U , V and M terms in posterior distri-bution of model, the parameters can be updated by moving in the direction of the gradient, yielding: Update U , V , M :( e ij = R ij  X  U T i V j  X   X  T i MV j )
N is the user number in social networks, K is the dimension of latent social factors
E is the number of connections in social networks
In the earlier discussion, we point out that the classical sta-tistical methods, such as Gibbs sampling and variational infer-ence, can be too costly to estimate Z ( O ( N 2 K 2 ) time com-plexity). Here, we introduced an scale EM method to reduce the time complexity to O ( EK 2 ) . The basic idea is to utilize an clustering based social network modeling method. Let C = ( C 1 ,C 2 , ...C T ) be a set of clusters for  X  , each  X  i has an mixture membership to the clusters C , illustrates the clustering based approximation. Given this, the distribution over z i  X  f and z f  X  i can be rewritten in Eqn. 18. Figure 3: clustering social factors to approximate social net-work modeling
Furthermore, a key observation is as follows: Based on Eqn 13, it is not necessary to infer hidden variables Z for any pair of tributes (factors), i.e. Z i,  X  =( Z i, 1 ,Z i, 2 , ..Z i,K further parameters updating process. Given this, let us introduce Z
Z + i,m,n : the count of m th and n th social attributes (factors) sampledbyuser u i with her/his connected users. According to Eqn. 18, the expectation of Z +
Z  X  i,m,n : the count of m th and n th social attributes (factors) sampled by user u i with her/his non-connected users.
 Given this, the expectation of Z i,m can be calculated based on Z Note that in this approach, the time complexity for estimating Z  X  is O ( TEK 2 ) (at each E-step), where T is the number of the clusters.

Update B : In addition, we can utilize this method to infer B in the M-step: where  X  is the sparsity parameter to capture non-interaction of the social network [2]. And  X  can be estimated by: Algorithm 1 EM-PSFL-Inference( R , G ,  X  ) 1: Random Initialize parameters  X =( U, V,  X  ,M,B ) . 2: repeat 3: Scalable E-Step: 4: Online K-Means Clustering on  X  . 6: M-Step: 7: Update parameters U, V, M using Eqn. 15, 16 and 17 8: Update  X  according Eqn. 13 and 14. 9: Update B using Eqn. 23 10: until Repeat the E-M steps until  X  convergence.

The parameters inference method for PSFL is outlined in Al-gorithm 1. The time complexity for the E-step and M-step are we use the online K-Means clustering algorithm to obtain C , which leads to O ( KTN ) time complexity. In practice, the num-berofclusters T has a relative small affect to our proposed PSFL model (we use 300 in this work). For the hyper-parameters  X  in PSFL model, they are determined by cross-validation. We will further elaborate it in the experiment section.
In this section, we use the real world user rating data and their corresponding social network to empirically validate the effec-tiveness of the proposed joint personal and social latent factor (PSLF) model for social recommendation. We compare it with the existing social recommendation methods and the state-of-the-art collaborative fi ltering approaches without considering the so-cial relationships. Speci fi cally, the following fi ve recommenda-tion models are compared:
SIM item-oriented neighborhood model(SIM) is the classical collaborative fi ltering method based on item similarity. SIM pre-dicts the rating score of the item according to the user historical ratings on the similar items. We implement the SIM as described in [15]. N is the dimension of latent interest factors
MMMF maximum-margin matrix factorization model(MMMF) places a latent factor vector on each user and item. In the training step, user-item latent factors are computed by user-rating matrix decomposition. For prediction, rating scores is calculated as the inner product between user latent factors and item latent factors. We implement MMMF as describe d in [14]. In addition, we also incorporate the item-neighborhood information based on [9]. In MMMF, there are three hyper-parameters, regularization terms  X  ,  X  v on factors U and V respectively and  X  s item similarity constraint terms. The three hyper-parameters are determined by cross-validation and the results reported in all experimental re-sults are based on the parameter con fi gurations which produce the best results.

FIP Friend-Interest Propagation(FIP) model [18] utilizes the latent factors of users not only for predicting the ratings, but also for link prediction. The inner product between two user latent factors can directly help whether they are linked in social net-work. Note that the original FIP model mainly targets for the item recommendation (rating is only binary). For comparison purpose, we extend their approach to the rating prediction, as in Eqn. 8. Four hyper-parameters in the model,  X  s ,  X  u ,  X  fi rst three are the same as the MMMF model), and  X  E are all determined by cross-validation.
 SR-LFM Social regularization based latent factor model (SR-LFM) [11] utilizes the social relationships explicitly to regu-late the latent facts of users. Speci fi cally, the individual-based regulation is modeled as in Eqn 7. For comparison purpose, we also add neighborhood item similarity constraint to the SR-LFM model. There are four parameters,  X  s ,  X  u ,  X  v (the fi rst three are the same as the MMMF model), and  X  E , are determined by cross-validation.

PSLF Joint Personal and Social latent Factor model(PSLF) proposed in the paper, utilizes both users X  past behaviors and so-cial relationships for social recommendation. In the PSLF model, there are six hyper-parameters:  X  s ,  X  u and  X  v are the same as MMMF model;  X  is a prior Dirichlet parameter (assigned as a fi xed value i.e. 1.0); and  X  M and  X  . All these parameters except  X  are determined by cross-validation.
 In the experimental study, we use the two popular metrics, Mean Absolute Error (MAE) and R oot Mean Square Error (RMSE) to measure the prediction qua lity of our proposed PSLF model in comparison with other collaborative fi ltering and social recom-mendation methods.
 MAE is de fi ned as: RMSE is de fi ned as: where R ij denotes the rating score user u i gave to movie v R ij denotes the predicted rating score user u i gave to movie v and T denotes the number of tested ratings. The smaller MAE or RMSE value means a better performance.
Flixster Dataset. Flixster is a social networking service in their friend list and create a social network. The social relations 5 The fl ixster dataset is public, and it can be download from http://www.sfu.ca/ sja25/datasets/ dataset t-Test MMMF FIP SR-LFM fl ixster PSLF(MAE) 7 . 47 e  X  4 1 . 06 e  X  3 3 . 09 e  X  4 in Flixster are undirected. It also contains ratings expressed by users in the period from November 2005 to November 2009.
Possible rating values in Flixster dataset are 10 discrete num-bers in the range [ 0 . 5 , 5 ] with step size 0 . 5 . There are totally 786 , 936 users, and 48 , 794 movies in this dataset. The over-all number of social relations and rating historical records are 7 , 058 , 819 and 8 , 196 , 077 , respectively.

Douban Dataset. Douban is a Chinese social website provid-ing user rating, review and recommendation services for movie, ing services that users can make friends with each other through the email communication. Douban dataset is crawled and shared with us by Ma Hao [11]. In the dataset, users can assign 5 in-teger ratings ( 1 to 5 ) to movies, books and musics. There are overall 129 , 490 unique users and 58 , 541 unique items. The number of social relations and rating records are 1 , 692 , 950 and 8 , 415 , 420 respectively. The basic statistics of the Flixster and Douban dataset are shown in Table 5.1.
In this subsection, we report the performance of different (so-cial) recommendation approaches. The users X  rating dataset is randomly divided into 2 folds. In the experiments, we use 70 percent of the rating data for training and the other 30 percent for testing. The random selection was carried out 5 times inde-pendently, and we report the average results. Note that except SIM, the other four models MMMF, FIP, SR-LFM and PSLF need select the dimension of the latent (personal) factors which is denoted by N . Thus, we show the performance of MMMF, FIP SR-LFM and PSLF models with different N , which are (4, 6, 8, 10, 20) respectively. For PSLF model, additional social factor dimension K is set to be K =50 . Later, we will further analyze the performance of PSLF when K varies.
 Rating Prediction Varying N (Number of Latent Factors): First, we evaluate the fi ve different methods by varying the num-ber of latent factors N . Both MAE and RMSE metrics are used to measure the prediction quality. As shown in Figure 4, the proposed PSLF model consistently outperforms the other four methods. The performance of SIM is generally the worst among all these methods in both Douban and fl ixster dataset. This is as expected because it does not utilize any latent factors (a straight line in these fi gures). The MMMF is better than SIM as it uti-lizes the latent factors and item neighborhood information. We observe the three recommendation approaches FIP, SR-LFM, and our PSLF are all consistently better than MMMF and SIM. This Table 3: Performance Comparison with MAE and RMSE on fl ixster dataset Table 4: Performance Comparison with MAE and RMSE on douban dataset provides a strong evidence that the social recommendation in-deed is useful and can be used to improve the recommendation accuracy. In these social recommendation approaches, SR-LFM is slightly better than FIP in Douban dataset, and comparable with FIP in fl ixster dataset; and our PSLF are always better than both of them.

From the Figure 4, we observe that a convergence effect of N : when we increase the latent factor dimension N to be around 10 , there seem to be little improvement for any large N . This sug-gests that a small number of latent factors (such as 10 ) is enough for all the models, including MMMF, FIP, SR-LFM, and PSLF. Detailed Performance Analysis for N =10 In Table 5.2 and 5.2, we provide a detailed comparison of these fi ve approaches (for the four latent factor based approaches, the number of latent factor N is set to be 10 .) We observe in terms of MAE in fl ixster dataset, PSLF model can improve the performance as high as 3 . 60% in contrast to SR-LFM model, 4 . 36% and 6 . 30% in con-trast to FIP and MMMF models, respectively. In terms of RMSE in fl ixster dataset, PSLF model improves the performance as high as 1 . 39% , 1 . 71% and 2 . 91% in contrast to SR-LFM,FIP, and MMMF, respectively. In Douban dataset, PSLF model improves the performance as high as 2 . 99% , 5 . 06% , 7 . 07% in terms of MAE, and 1 . 39% , 1 . 85% , 2 . 91% in terms of RMSE in contrast to the other three latent factor based approaches, such as SR-LFM, FIP, and MMMF, respectively.

Finally, to validate the statistical signi fi cance of our experi-ments, we perform the paired t-test (2-tail) over the MAE and RMSE of the experiential result. As shown in Table 5.1, all the t-test results are less than 0.01, which means the improvements of PSLF over other methods are statistically signi fi cant. Parameter Sensitivity Analysis: Here, we analyze the perfor-mance of PSLF model when varying the dimension of social f actors K . In the experiments, we compare the performance on MAE with different social factor dimensions, which are (20 , 50 , 80) . As shown in the Figure 5, we observe that the performance with K =50 and the performance with K =80 are comparable; they are both slighter better than K =20 . We note that in most of the cases, the performance with K =50 is even slightly better than the performance with K =80 . This indicates a large number of social factors (beyond 50 ) may not help much for performance improvement. Table 5: Comparison of Pearson coef fi cient with different sampling strategies Sampling Method fl ixster Douban Randomly Sample 0.0504  X  0.0025 0.2554  X  0.0027
Social-aware Sample 0.0561  X  0.0026 0.2654  X  0.0016
In this subsection, we perform a detailed statistical analysis to help analyze some underlying assumptions which form the basis of the existing social recommendation methods. Such an anal-ysis also provides an insights into their recommendation perfor-mance. First, we analyze the correlations between users X  rating behaviors and their social activities. As in the Figure 6, the correlation coef fi cient between users X  rating number and their friends number is relative small, i.e 0.045 in fl ixster dataset. This indicates that users who have a large number of friends may rate only a small number of items. In other words, the behaviors of user X  X  rating and making friends in social network seem to be independent. This also provides a statistical evidence for the proposed PSLF model as it treats the personal and social latent factors as being independent. Note that both FIP and SR-LFM models all try to use the same latent factors to represent both users X  rating behaviors and their social relationships.
Secondly, we further analyze whether friends share similar opinions (with similar rating to the same items). To achieve this, we utilize two sampling strategies: the fi rst one is to randomly sample 100,000 user pairs, from the overall 786 , 936 users in fl ixster and 129 , 490 users in Douban; the second sampling ap-proach is to randomly sample 100,000 user pairs, who are di-rectly linked in the sample, from 7,058,819 social relations in fl ixster and 1,692,950 social relations in Douban. Then, for each sample set, we compute the interest coef fi cient 7 between any two user in each sample. The higher interest coef fi cient is, the more similar interests users have.

In the Table 5.3, we report the comparison with average in-terest coef fi cient on the two sampling approaches. In fl ixster dataset, the average interest coef fi cient is 0 . 0524 basedonran-report the PCC between two users with no less than 5 common rated items dom sampling method (random pair), and 0 . 0561 based on sec-ond sampling method (random friends) with nearly 7 percent im-provement. In Douban dataset, the average interest coef fi cients are 0 . 2554 and 0 . 2654 based on random sampling method and friends sampling method, respectively. There is 4 percent im-provement for social-aware sampling method. Therefore, simply assuming users have similar interest with their friends in social networks may still be helpful when incorporating into recom-mender system, though the improvement maybe limited.

Finally, we compare the distribution of Pearson correlation co-ef fi cient(PCC) between the two sample sets generate by the two sampling approaches. First, PCC is sorted in ascending and de-scending order respectively. For each order, we get Top N per-centage of samples, and calculate the average PCC. In Figure 5.3, we show the comparison with Top(N) average PCC in as-cending order on random sampling set and friend sampling set. From the Figure 5.3, we can observe that the friend sampling method X  X  PCC curve is above random sampling method X  X  in both fl ixster and douban dataset. This indicates that friends in social network have less probability to have opposite interests. In Fig-ure 5.3, we report the comparison with Top(N) average PCC in descending order between the t wo sampling approaches. Here, we found that the friend sampling method X  X  PCC curve is be-low random sampling method X  X . It indicates that there are many users who have similar interests may not be friends with each other in social network. This again suggests that using the (per-sonal) latent factor to measure the likelihood of being friends is not accurate. Figure 7: Comparison with Top(N) PCC in descending order
Recently studies show users X  trust relationship can be employed to enhance traditional recommender systems[13]. A few trust-aware recommendation methods have been proposed [7][4]. How-Figure 8: Comparison with Top(N) PCC in ascending order ever, trust-based recommendation approaches are different from social recommendation in many aspects. Typically, on the web-site, when a user A likes a review by another user B, user A probably will add user B to his/her trust list [11]. This process of trust generation is a unilateral action that does not require user Atocon fi rm the relationship. However, the social relationship refers to the cooperative and mutual relationships that surround us, such as classmates, colleagues, or relatives, etc. In addition, trust-based recommender systems are based on the assumption that users have similar tastes with other users they trust. This hypothesis may not always be true in social recommendation sys-tems since the tastes among the user and her/his connected users mayvarysigni fi cantly. A more detailed analysis on the differ-ence between the trust-based recommendation approach and the social recommendation approach can be found in [11].

There have been a few attempts on social recommendations lately [5, 11, 18], which are all based on the assumption that any pair of friends in the social network shall have similar interests. The recent studies [11, 18] incor porate such a network-based similarity property between users into the state-of-the-art matrix factorization recommendation approaches [10]. However, they almost completely ignored the heterogeneity and diversity of the social relationship.

Social attribute (factor) extraction was fi rst proposed by Hol-land et al. [8] and Harrison et al.[17]. They are also referred to as the blockmodel, which can be used to describe the role or position of actors in the social network. In [8] and [17], users in social network have only one factor(position) being extracted, and the interaction of the positions is captured in the latent so-cial structures. Recently, more complicated blockmodel, mixed-membership blockmodel [2], proposed to relax the assumption of single position bloackmodel, allow users to have a more nat-ural, mixed-membership of social attributes. However, the exit-ing parameter inference method has scalability bottleneck, which requires O ( n 2 ) time complexity in each iteration, where n is the user number of social networks. In this work, we develop a scale EM approach with time complexity O ( E ) in each iteration, where E is the number of edges in the social network.
In this paper, we develop a joint personal and social latent fac-tor (PSLF) model which combines the collaborative fi ltering and social network modeling approaches for social recommendation. Our approach has shown to have better prediction accuracy over the existing social network approaches. In the future work, we plan to study the following aspects of social recommendations: 1) can we scale the social recommendation used the map-reduce (Hadoop) computation framework to handle tens or hundreds of millions of users? 2) how to deal with privacy issue? Can social commendation be done with minimal (or coarse) network infor-mation?
The authors appreciate the anonymous reviewers for their ex-tensive and informative comments to help improve the paper. We also thank Dr Hao Ma for sharing Douban Dataset. Ye-long Shen and Ruoming Jin X  X  work in this paper is partially sup-ported by National Science Foundation under CAREER Award IIS-0953950.
