 In this paper we address the problem of temporal link pre-diction, i.e., predicting the apparition of new links, in time-evolving networks. This problem appears in applications such as recommender systems, social network analysis or ci-tation analysis. Link prediction in time-evolving networks is usually based on the topological structure of the network only. We propose here a model which exploits multiple in-formation sources in the network in order to predict link occurrence probabilities as a function of time. The model integrates three types of information: the global network structure, the content of nodes in the network if any, and the local or proximity information of a given vertex. The pro-posed model is based on a matrix factorization formulation of the problem with graph regularization. We derive an effi-cient optimization method to learn the latent factors of this model. Extensive experiments on several real world datasets suggest that our unified framework outperforms state-of-the-art methods for temporal link prediction tasks.
 H.2.8 [ Database Management ]: Database applications X  Data Mining ;J.4[ Social and Behavioral Sciences ]: So-ciology Algorithms, Experimentation Temporal Link Prediction, Nonnegative Matrix Factoriza-tion, Graph Regularization
Link prediction [7] is a generic task for the analysis of net-worked data which appears in many applications, such as Viral Marketing [15], Recommender systems [8], and Online Social Network Analysis [2]. The problem has mainly been considered from a static network point of view: given ob-served links in a network, infer the missing links [6]. Most real networks are however time-evolving in nature so that new relations between entities or new entities may appear at different times. For instance, one may be interested to conjecture whether individuals in a network will be linked by some relation in the future, even when no relation has been observed between them in the past. In this paper, we focus on the problem of temporal link prediction in time-evolving networks: given snapshots of a network for T time periods, can we predict the future link structure at time T + 1 in the network? This task is illustrated in Figure 1. Note that temporal link prediction exploits the past history of link evolution provided by the state of the network at suc-cessive time slices. This is different from simply predicting future links (e.g. in a citation network predicting who will cite who) without considering the network evolution history, which could be considered as static link prediction.
Several approaches have been developed to predict future links in time-evolving networks. The mainstream develop-ments, for example the pioneer work [12], or later papers [9], [1], consider only network topological information. However, taking into account the link structure only may lead to poor performance when there is few observed data. For exam-ple, social networks are usually very sparse and one needs additional information sources to capture the complex time-evolving patterns of link structure. Some authors like in [13] or [14] view link prediction as a binary classification prob-lem and use both topological structure and node attributes as input into a classifier to decide whether two nodes will be linked in the future. Setting link prediction in a classifica-tion framework may cause severe overfitting problems due to the network sparsity and the imbalance between linked and unlinked pairs. To explicitly address these issues, we propose here a model based on a matrix factorization for-mulation, which exploits multiple information sources in the network in order to predict link occurrence probabilities as a function of time. The model may integrate three types of information: global network structure, content information of nodes if present and local proximity information. The multiple sources will provide additional information w.r.t. the link structure alone, and the regularized matrix factor-ization approach will be less prone to overfitting and less sensible to class imbalance than classification approaches.
Our contributions are the following: (1) we propose a framework for integrating the complementary information sources for the temporal link prediction problem. For this, Figure 1: Example of temporal link prediction prob-lem in time-evolving networks. Given time periods T 1 and T 2 , we try to predict the link structure at T 3 based on the network structure and node content information. we exploit a latent matrix factorization method and make use of an efficient alternating iterative algorithm for learning the latent factors of nodes in the network. (2) Extensive ex-periments are conducted on several real world co-authorship datasets, and the proposed model is shown to outperform state-of-the-art methods for temporal link prediction prob-lem on these datasets.

The paper is structured as follows. We first briefly in-troduce the problem definition and required background on latent matrix factorization model and graph regularization technique in Section 2. The proposed framework based on a graph regularized link matrix factorization and the train-ing procedure are presented in Section 3. We describe ex-periments on several datasets and comparisons with state-of-the-art methods in Section 4. In Section 5 we present conclusions.
The temporal link prediction problem is formally intro-duced as follows 1 : suppose we have a graph G =( V , E ), where V = { x i } N i =1 represents the set of nodes. Each node x has a set of associated content features denoted as C i = { C ij } M j =1 . Thus, the content matrix associated to the graph G is denoted as C  X  R N  X  M . We consider that the nodes and their content do not change over time and that only the relations between nodes may evolve. A temporal graph series {G 1 , ..., G T } can then be represented by a series of ad-jacency matrices { A t ,t =1 , ..., T } ,where A t  X  R N  X  N apairofnodes x i and x j ,let A t ( i, j ) = 1 when there is a link between x i and x j at time t ,and A t ( i, j )=0otherwise. Note that in this definition, A t may be either symmetric or asymmetric, which respectively corresponds to undirected or directed graph.

Givensuchaseriesof T adjacency matrices { A 1 , ..., A T } and a content matrix C , the temporal link prediction prob-lem is defined as the prediction of occurrence probabilities for links at time T + 1. We will denote Sc ,the N  X  N pre-dicted score matrix, whose element Sc ( i, j )representsthe
We follow the terminology of problem definition in [9] predicted score for link ( i, j ): where f represents the link prediction model.
The proposed model in this paper integrates different in-formation sources through. We build on the work of [17] which proposed a matrix factorization formalism by com-bining content and link information, and on the graph reg-ularization models which have been introduced for collab-orative filtering [8] in order to represent graph proximity. Our method combines the two ideas in a unique model. We first describe below these two ideas before introducing the proposed model in section 3.
Zhu et al. [17] proposed a supervised matrix factorization model for combining link and content information for classi-fication tasks. Both types of information are mapped onto a common low dimensional latent space. Let A and C respec-tively denote the link adjacency and content matrices for a given graph. The factorization problem can be formalized as follows: where  X  F denotes the Frobenius norm. In A  X  USU T 2 F , a tri-factorization is used in place of the classical bi-factor NMF [11]. The specific symmetric above form is utilized for approximating square matrices where rows and columns are indexed by the same element set (here the network nodes), whereas usual NMF method is used to approximate rect-angular matrices where the two sets of elements are differ-ent. Each row U i in the factor matrix U  X  R N  X  K + ,can be considered as a low dimensional latent representation of the corresponding node x i , which encodes the connectivity and content information of the individual node. The factor matrix S  X  R K  X  K + provides the degree of freedom to make the matrix tri-factorization accurate. The rows of the factor matrix V  X  R M  X  K + , represent the projection of C onto the latent space.
Graph regularization has been made popular for semi-supervised learning techniques exploiting data proximity in-formation, i.e. the cluster assumption [16] [18]. The under-lying idea is that in a metric space, similar points should have similar labels. This type of regularization has been used jointly with NMF for clustering in [4] and collaborative filtering in [8]. Let us denote u i a feature vector associated to node x i . For the Euclidean metric, the regularization constraint can be written as: where tr (  X  ) denotes the trace of a matrix, { u 1 , ..., of latent features, W is a similarity matrix between nodes. L = D  X  W is the graph Laplacian matrix with D being a diagonal matrix with diagonal elements D ii = j W ij [5].
Previous work on link prediction has made use of a unique information source, either topological features or node at-tributes. We propose here to integrate three network char-acteristics. To the best of our knowledge there is no similar prior work for temporal link prediction. We describe a con-densed representation of the temporal graph series in section 3.1, the model specification with learning and inference pro-cedures in section 3.2, and finally we provide a complexity analysis.
Given past snapshots of a network for T time periods, we need to capture the temporal dependencies of individual links and the global interlink dependencies. To do so, we will use here a simple weighted exponentially decaying model of adjacency matrices on a sliding window of T successive temporal slices. We build an aggregate weighted link matrix as follows: where the parameter  X   X  [0 , 1] is the smoothing weight. In as A for simplification from now on, will be used in the algo-rithm as a summarized information, describing the temporal evolution of the link structure.
The proposed model is based on a factor analysis frame-work for integrating the temporal link structure, content features and graph proximity information of nodes with the graph regularization technique. It combines the two ideas outlined in sections 2.2.1 and 2.2.2 into a joint latent model. The objective function is defined as: min = +  X tr ( U T LU ) s.t. U  X  0 , S  X  0 , V  X  0 where the factor matrices U  X  R N  X  K + , S  X  R K  X  K + ,and V  X  R M  X  K + , are nonnegative.  X  and  X  are parameters which can balance the influence of content information and graph proximity information in the joint model.

The first term A  X  USU T 2 F corresponds to the temporal link matrix factorization. The matrix tri-factorization form is used here to represent the fact that the rows and columns of link matrix A correspond to the same set of nodes. The link matrix A might be symmetric or asymmetric for respec-tively undirected or directed graph, and the corresponding factor matrix S will accordingly be a symmetric or asymmet-ric matrix. The second term  X  C  X  UV T 2 F in Equation (2) is used to incorporate the content or semantic attributes of nodes, which play an important role in link prediction mod-els [10] [14].

The regularization term  X tr ( U T LU )isemployedtointe-grate the graph proximity information into the joint model, and acts as a constraint for the link matrix factorization. Different types of proximity information may be encoded into the weight matrix W ,suchas common neighbor and preferential attachment measures (see section 4.2). Experi-mental results show that these local topological characteris-tics are useful for link prediction. Without loss of generality, we will use the common neighbor similarity matrix here.
After obtaining the latent factors U , S and V , the prob-ability of a link existing between a pair of nodes can be obtained by an inner product of the latent factors U and S , which produces the score matrix for predicting future link occurrence probabilities in time-evolving networks as follows:
For learning the proposed model, we use the alternating multiplicative updating algorithm [11], which warrants the nonnegativity of latent factors U , S and V and provides an automatic step parameter selection. The objective func-tion J ( U, S, V ) in Equation (2) is not convex in U , S and V together. The alternating updating algorithm optimizes the objective function with respect to one set of parame-ters while fixing the others, and then exchanges the roles of the parameter sets alternatively. This procedure will be repeated for several iterations until convergence.
To learn the factor matrix U while fixing the factor matri-ces S and V , we will solve the following optimization prob-lem: The derivative of J ( U )withrespectto U is:  X  X  ( U )  X  U =2( USU
Using the Karush-Kuhn-Tucker complementary condition for the nonnegativity of U and  X  X  ( U )  X  U = 0, we can get the following updating rule for U ij :
The latent factor matrices S and V can be learned in a way similar to the latent factor U . The updating rules for learning S and V are respectively: Based on the above updating rules for latent factor U in Equation (5), S in Equation (6) and V in Equation (7), we can prove that the learning algorithm is convergent. Theorem 1. Using the updating rules in Equation (5), Equation (6) and Equation (7), the objective function in Equation (2) will monotonically decrease, thus the learning algorithm converges.
 The proof is omitted here due to space limitation. 2
Since the alternating iterative updating algorithm is em-ployed to learn the latent factors U , S and V , we can ob-serve that in each iteration, the computational complexity for learning U is O ( NK 2 ), where N is the number of nodes in the network, K is the latent factorization dimensionality. The computational complexity required for learning S and V is O ( NK 2 )and O ( NK ) respectively. Typically, due to K N , the overall complexity of the learning algorithm is O (
N ), which provides the possibility for handling large scale networks.
In the experiments, we examine how our proposed model behaves on real-world time-varying networks. We consider here four co-authorship networks extracted from arXiv archive for the years 1992 to 2002 [12]. These different networks come from different sections of arXiv: Condensed Matter (Cond-mat), General relativity and quantum cosmology (Gr-qc), High energy physics phenomenology (Hep-ph) and High energy physics theory (Hep-th). They will be exploited sep-arately in the experiments.
We will introduce several baselines which are used for com-parison with the proposed joint model:
Dependent Prediction method: which is a naive method that uses the most recent link graph A t 0 + T as the score ma-
Weighted Dependent Prediction method: which is also a naive method that uses the weighted temporal link A
Common Neighbor method: which simply evaluates the number of common neighbors in the temporal link graph A |
 X ( i )  X   X ( j ) | ,where X ( i ) is the set of neighbors of node
Preferential Attachment method [3]: which uses the product of node degrees in the link graph A ( t 0 +1)  X  ( t the score in the score matrix, i.e., Sc T +1 = |  X ( i ) | X |
Katz method: which consists in summing over all paths nentially damped by length to give short paths higher weights, of paths of length l between nodes i and j .

NMF method [11]: which is directly applied on the tem-using only the network structure information.
See the supplementary information at the authors X  website for the detailed proof.

GNMF method [4]: which combines the link structure with graph proximity information of nodes.

GRJMF method: this is our method. GRJMF holds here for Graph Regularized Joint Matrix Factorization.
The sliding window size for training the temporal model is set to T =3 3 . Since we start at Year 1992, we then evaluate all models on years from 1995 to 2002. To evaluate theperformance,weusetheAUC(scoreAreaUnderthe receiver operating characteristic Curve), which is a robust measure for networked dataset [1], as the evaluation metric. For the experiments we evaluate the methods by repeating the process five times and report the average results.
We compare the performance of different temporal link prediction models on the four co-authorship datasets. The parameters of the different methods have been manually tuned and we report here the best results obtained based on the optimal combination of many parameter settings. The dimensionality of the low dimensional factor representations, i.e. K , is also determined by the experiments. The results presented here have been obtained by using K = 60,  X  =1,  X  =0 . 4and  X  = 1, and for the matrix factorization based methods the number of iterations has been set at 100. The influence of different parameter settings is studied in the next section.

The experimental results are shown in Table 1 for the tem-poral link prediction task. It can be observed that the best performing method among all the models is our proposed GRJMF model, which indicates that it can efficiently inte-grate the temporal link matrix, content information of nodes and graph proximity information to extract meaningful la-tent factors. Table 2 gives the detailed performance on every test year using different link prediction methods on Cond-mat dataset with the sliding time window of T=3 as an ex-ample. Among graph proximity information based models (i.e., CN, PA, Katz methods) the Katz method has the high-est performance and is most often slightly better than the nonnegative matrix factorization based models (i.e., NMF and GNMF), which shows that the graph proximity infor-mation can provide useful topological features for temporal link prediction.

We also want to evaluate the contribution of multiple in-formation sources (i.e., common neighborhood based graph proximity information and content information of nodes), in our model. Figure 2 gives the performances of variants of our proposed model on the different datasets: here GRJMF-L denotes the link matrix tri-factorization model which is the first term in GRJMF (i.e.  X  =0and  X  =0). GRJMF-L+C denotes the model using link structure and content infor-mation (i.e.  X  = 0), GRJMF-L+R denotes the link matrix factorization model using graph regularization while without content information (i.e.  X  = 0), GRJMF-L+C+R denotes the graph regularized joint model with both link and content information. From the results, GRJMF-L is slightly lower than the other models, which is natural. GRJMF-L+C or GRJMF-L+R bring similar improvements w.r.t. GRJMF-L, while the integration of all the information sources in GRJMF-L+C+R contributes to an additional increase w.r.t. the last two models. The different sources thus bring com-
Varying the value of sliding window size T leads to dif-ferent prediction performances. T = 3 provided the best performance on the different test datasets. are in bold and second best in italic.
 Figure 2: Average AUC performances on different datasets with variations of our proposed GRJMF model. plementary information and GRJMF-L+C+R model allows their integration in an efficient manner.
We now study the influence of different parameter set-tings. We have conducted experiments with different values of the parameters: latent factorization dimensionality K exponential smoothing weight  X  , content factorization pa-rameter  X  and graph regularization parameter  X  .

Impact of K : Figure 3 shows the performance evolution of the matrix factorization based models when K varies from 10 to 100. In this range, the higher the dimensionality of the low-dimensional representation, the better the performance is. In order to achieve a compromise between complexity and performance we fixed K to 60 in the experiments.
Impact of  X  : We use here the Gr-qc dataset as an ex-ample to check the impact of various values on  X  in Figure 4. The results on the other three datasets are similar. We can observe that increasing the value of  X  tends to improve Figure 3: Average AUC performances on differ-ent datasets using three latent matrix factorization based methods when varying K values. the prediction performance slightly by all the methods ex-cept for the Dependent Prediction method until  X  =0 . 4, and that higher values of  X  may decrease the performances.
Impact of  X  : We vary the value of  X  in the range [0 , 2] to examine the impact of content information on the Gr-qc dataset as in Figure 5(a). When we set  X  = 0, the proposed model reduces to the GNMF model (i.e. no content). It can be seen that content of nodes is indeed an important addi-tional information source since the performance sharply in-creases as soon as this information is introduced and reaches best performance at around  X  = 1. Based on the result in the experiments, we choose the optimal value  X  =1.
Impact of  X  : We vary values of  X  on { 0 . 01 , 0 . 1 , 1 to check the performance of the matrix factorization based Figure 4: Average AUC performances on different values of  X  using three matrix factorization based models on Gr-qc dataset. models on the Gr-qc dataset when  X  = 1. We omit this anal-ysis for other datasets which exhibit a similar trend. Figure 5(b) demonstrates that  X  slightly influences the prediction performance, confirming the relevance of the graph proxim-ity information source. However, the effects are different on GNMF and GRJMF model. The performance of the former increases for the experiment range while the latter reaches a maximum and then slightly decreases. This could be ex-plained by the need for a compromise between content and proximity information in the GRJMF model.
In this paper we have focused on the problem of temporal link prediction in time-evolving networks, and have proposed a novel unified model which integrates three types of infor-mation: the global network structure, the content of nodes and the graph proximity information to capture the time-evolving patterns of links in the networks. The joint model is based on latent matrix factorization method and graph regularization technique. We also presented an efficient opti-mization procedure with the alternating iterative algorithm to learn the latent factors. The experimental analysis on several real world datasets suggest that our joint model can efficiently incorporate multiple information sources and pro-vide a promising future for temporal link prediction task.
The authors would like to thank the anonymous reviewers for their helpful feedback. This work was partially supported by the French National Agency of Research (the Fragrances-Project, ANR-08-CORD-008-01). [1] E.Acar,D.M.Dunlavy,andT.G.Kolda.Link [2] A. Adamic and E. Adar. Friends and neighbors on the [3] A. L. Barabasi and R. Albert. Emergence of scaling in [4] D. Cai, X. He, X. Wu, and J. Han. Non-negative Figure 5: Average AUC performances on Gr-qc dataset using three matrix factorization based mod-els when varying the values of  X  and  X  . [5] F. Chung. Spectral graph theory. American [6] A. Clauset, C. Moore, and M. Newman. Hierarchical [7] L. Getoor and C. P. Diehl. Link mining: a survey. [8] Q. Gu, J. Zhou, and C. Ding. Collaborative filtering: [9] Z. Huang and D. K. J. Lin. The time-series link [10] H. Kashima, T. Kato, Y. Yamanishi, M. Sugiyama, [11] D. D. Lee and H. S. Seung. Algorithms for [12] D. Liben-Nowell and J. Kleinberg. The link prediction [13] J. O X  X adadhain, J. Hutchins, and P. Smyth.
 [14] C. Wang, V. Satuluri, and S. Parthasarathy. Local [15] S. Wasserman and K. Faust. Social Netwok Analysis: [16] D. Zhou, O. Bousquet, T. N. Lal, J. Weston, and [17] S. Zhu, K. Yu, Y. Chi, and Y. Gong. Combining [18] X. Zhu, Z. Ghahramani, and J. Lafferty.

