 ' 1. Introduction those based on fossil fuels are still the most popular in the world.
In Mexico for example, 68% of the electric power generation is based on fossil fuel ( CFE, 2010 ). Some corporations also generate power using fuel oil like Pemex (Mexican Petroleum Company) and other petrochemical industries. Fuel oil is burned in boilers in order to produce steam that moves turbines connected to electric generators. The burners in the boiler require fuel to have speci characteristics so it can be burned properly. Viscosity is one of fuel ' s main characteristics that needs to be observed, because fuel is atomized mixing fuel oil with steam and it is burned combined with air in the combustion chamber. Fuel oil viscosity must be measured and controlled due to the atomization effect in the oil drop size required for a complete oil combustion process.
There are several approaches for viscosity measurement. A short survey is carried out in Davis et al. (1975) . However, none of them guaranties a reliable measurement in fuel oil applications. Even more, in a closed control loop application, conventional viscosity meters do not have a successful application as it is recognized in
Gary (2003) . The same paper recommends the capillary method, with the restriction that this type of viscosity meters need to operate at a steady temperature and fl ow to perform an adequate measurement. Other studies as Barrufet and Agustinus (2003) propose capillary devices based on the Hagen  X  Poiseville equation.
However, the application of this equation requires many condi-tions. For example, the measurement must take place in a diverted constant fl ow and temperature, and the length of the capillary tube and taps must be of a non-intrusive type, among other conditions that complicate the implementation of such devices.
The key question is: What procedure do power plants follow to achieve an acceptable fuel oil viscosity? There are two main options: (1) measure and control with a hardware viscosity meter, or (2) control fuel temperature by using human criteria (manual control) according to the current fuel viscosity evaluated in the power plant
Hardware viscosity meters for fuel oil are expensive and dif operate and they need periodical maintenance. The instruments have to be calibrated and cleansed on a regular basis. Experts of the
Mexican Power Utility (CFE) report that almost none of their plants have used hardware viscosity meters for more than a year. The second option to measure viscosity is by means of chemical analysis in laboratory. This is carried out every time a new supply of fuel is used in a power plant. However, this procedure is off line and takes more than 1 h. Besides, the new fuel is unavoidably mixed with the previous fuelinthedailyuseofthestoragetank,andthemixtureresultsina different kind of fuel from the original. A common practice in the viscosity control of power plants is to take samples and fi current fuel oil viscosity value in laboratory, and the temperature corresponding to the desirable viscosity at which the fuel oil must be controlled for a high quality combustion should be reported later on to the operator.

The central idea in this research project is to estimate the fuel oil viscosity with accuracy so it can be modi fi ed for a proper fuel atomization, and consequently, an adequate combustion. Each boiler manufacturer de fi nes the optimal viscosity for its burners.
The approach presented in this paper is regarding the devel-opment of a virtual sensor. A virtual sensor, soft sensor or inferential model, is a computer program that estimates the value of a speci fi c variable, given a model of the process involved and the measures of related variables.

The basic idea for virtual sensors is to create a model of the process using information provided by the accessible variables. Then, different approaches for virtual sensors exist according to the model generated. One approach used in traditional chemical processes is analytical. This includes the development of complex differential equations that relate the virtual variable with other easier to read parameters ( Dorsey and Lee, 2003 ). Computational intelligence methods have also been used in this estimation. For example, neural networks, fuzzy logic and genetic algorithms are used in the estimation of one variable after a training phase. Sometimes, a combination of these methods is utilized in speci environments ( Hanai et al., 2003 ).

This paper describes the development of a viscosity virtual sensor that works on-line in a power plant. The virtual sensor estimates the value of viscosity given related measurements using a probabilistic model. This development provides two sorts of contributions: technological challenges and practical contributions in combustion control of conventional power plants. The techno-logical contributions include the construction of the probabilistic model using automatic learning algorithms. The project is based on the hypothesis which proposes that there are a number of variables which are probabilistically related with viscosity that can be used to estimate it. The practical contribution involves the capacity to estimate fuel viscosity in order to control fuel oil temperature to obtain an optimal atomization of the fuel, and hence, an optimal combustion. Once the fi rst virtual sensor is completely installed, it can be replicated in other power plants boilers.

Fig. 1 shows a general view of the viscosity virtual sensor. First, an off-line procedure is conducted that includes the acquisition of historical data, including the readings of a viscosity meter. With this information, a probabilistic model is constructed. This model relates all the selected combustion variables, with the viscosity measurements.

The viscosity virtual sensor is installed in the power plant to operate on-line. The virtual sensor receives the continuous values of the related variables, and uses the probabilistic model to estimate the current value of the viscosity.

The National Council of Science and Technology (Conacyt) and the Mexican Power Utility(CFE) are supporting this project in order to install a fi rst prototype in the Tuxpan Power Plant, and later on, replicate this sensor in other power plants in Mexico.
This paper is displayed as follows: Section 2 explains the details of the combustion problem in power plants. Section 3 describes the process of data acquisition and conditioning for model con-struction. Section 4 introduces the probabilistic models and explains how they are used in this application. The algorithms and the tools utilized in the learning process are explained in
Section 5 . Section 6 describes the sets of experiments carried out in order to fi nd the best possible probabilistic model, and Section 7 shows the results of these experiments and discusses the conclu-sions of the learning process. Finally, Section 8 explains the installation of the virtual sensor in the power plant and shows the preliminary results in the site acceptance tests (sat). Section 9 is the conclusion and directs future work in the construction of virtual sensors. 2. Combustion in fossil fuel power plants
A thermo-electrical power plant basically consists of a steam generator (boiler) that receives liquid water (feedwater) and produces steam by means of burning fuel, a turbine that produces shaft work through steam expansion, an electric generator that uses the turbine shaft work to generate electric power, and a steam condenser (main condenser) that recycles steam as feed-water to the boiler.

Burners in the boiler are designed to receive fuel oil with a certain fi xed viscosity. Steam is added in the burners to atomize the fuel oil. Atomization is necessary to spread the liquid fuel into small drops of a speci fi c size that guarantees total fuel combustion with air. If the drop size is too large, only a portion of the fuel can be burned and the rest is adhered as soot on the heaters '
Furthermore, some fuel will be expelled to the atmosphere as pollution, and this leads to a reduction in combustion ef the drop is too small, side combustion reactions may take place and the fuel ' s combustion heat may be degraded; consequently, combustion ef fi ciency is reduced. Before the fuel is introduced to the boiler there are two heaters, the suction and the main heater that warm up the fuel to obtain the appropriate viscosity for the fuel entering the furnace. A key issue in the plant ' s operation is the temperature needed to heat the fuel.
 in their viscosity. However, fuel oil is greatly affected by tempera-ture changes. Experimental data may be correlated with the
Guzman-Andrade equation ( Perry, 1963 ) as follows:  X   X  Ae B = T  X  1  X  where  X  represents viscosity, T is temperature, and A and B are constants depending on the type of fuel oil. In fact, the combustion experts in our institute have analyzed 458 viscosity  X  temperature relations in our chemical laboratory, during several years. Fig. 2 shows the set of the 134 selected most representative graphs from the fuel oil analyzed. These curves help to easily extrapolate the different chemical characteristics of fuel oil.
 Fig. 2 in a semi-logarithmic axis.
 using the lines in Fig. 3 , it is possible to calculate the optimal heating temperature that this speci fi c fuel oil needs in order to reach the set point of the optimal viscosity.

The hypothesis in this research project proposes that the viscosity value can be estimated utilizing the values of related variables in the combustion process, and a probabilistic model. The idea is to observe the relation among viscosity, temperature and other related variables during different operational conditions. Our goal is to detect if a different fuel oil has been fed when the combustion conditions change, or to identify its effects in the combustion, once we are aware that the fuel oil has changed.
Therefore, we need to obtain historical information including the measurements with a viscosity meter. We selected the Tuxpan power plant which comprises 6 units and is located north of the state of Veracruz, in the Gulf of Mexico ' s littoral. This power plant was chosen since it has viscosity meters installed in units 1 and 2.
These instruments are needed to obtain historical data including viscosity, in order to fi nd the relationship between viscosity and other related variables. The selection of variables was de through multiple interviews with combustion experts. Some selected variables are generated before combustion, like fuel to the burners or fuel temperature. Other variables are generated during combustion such as internal boiler temperature, and some others are generated after combustion like generated power.
In a fi rst attempt, 32 variables were selected to construct the probabilistic model. However, examining the behavior of each signal in regard to viscosity, we conclude that only 11 variables remain in the data set. In addition to the variables extracted from the power plant ' s data base, some others were calculated. The one was thermal rating (Rt), which represents the ratio of generated energy (electricity) with respect to the energy intro-duced to the plant as fuel combustion heat. The other variable calculated was the air  X  fuel ratio (Rac) which represents the current air  X  fuel ratio introduced in the furnace. These variables were calculated as follows:
Rt  X  Mw 10
Rac  X  F air F where Mw represents the generated power, F fuel is the total mass heat, and F c 1 and F c 2 are units conversion factors to obtain W/kg.
F air is the total air fl ow to the furnace. Table 1 presents the ID and the description of the fi nal set of selected variables. The delayed variables are those affected by the fl uid ' s velocity and by the distance of the meter ' s location after combustion. For example, t the amount of oxygen in the combustion gases implies combustion quality in the chimney, that is, about 20 s after combustion. Table 1 de fi nes the ID and the description of the fi nal set of variables selected. Viscosity Viscosity
An important activity in this project was obtaining information from all the variables in Table 1 , including viscosity ( A 1000) during the widest possible operational conditions ' range of the power plant. The following section describes this process. 3. Data acquisition and conditioning
The virtual sensor ' s design begins by selecting and obtaining historical data of the related signals from the plant. In the Tuxpan Power Plant there is a hardware viscosity meter that is used to the probabilistic relation between the process signals and the measured viscosity. Thus, a huge historical data set is acquired with measurements every 5 s during several days under different operational conditions. The speci fi c dates were selected because a change in the type of fuel was reported, thus measurements were carried out two days before, two days after, and the day fuel was changed. A data set to train the probabilistic model was selected using the information described above.

There are two basic types of fuel oil in Tuxpan. A high viscosity fuel oil provided by Pemex and an imported fuel oil with lower viscosity. In many cases, these types of fuel are alternated, causing unexpected mixtures in the tanks.

The data come from sensors which could work improperly, either for a few moments or permanently. Thus, all data registers have to be checked and re fi ned. This process is referred to as detecting outliers, i.e., data that are not in the expected range of values of this variable ( Fortuna et al., 2007 ). It is assumed that the values of each variable follow a normal distribution. The 3 rule detection procedure is applied. This consists of calculating a distance d i of each sample from the estimated mean i with the following equation: d  X  x i
Of course, different criteria can be used to detect outliers if the application requires it. For example, 2 s is recommended if the application calls for high con fi dentiality of the data, even if several data instances are discarded.

Normalization is applied after depurating the data set. Normal-ization in this context means that all variable values lie between 0 and 1 (or other values). This is because we only need to compare the behavior among all the signals, and especially between all the signals and the measured viscosity. The min  X  max normalization was utilized as presented in Fortuna et al. (2007) x  X   X  x max x  X  min x  X  max x  X  where x is the unscaled variable, x  X  is the scaled variable, min the minimum value of the unscaled variable; max x is the max-imum value of the unscaled variable; min x  X  is the minimum value of the scaled variable; max x  X  is the maximum value of the scaled variable.

Finally, discretization is required since the probabilistic model is formed by a Bayesian network with discrete signals. Discretiza-tion refers to the division of the complete range of values in a number of intervals. After normalization, discretization is simple because it only needs the number of intervals in which every variable will be discretized. For example, if 20 intervals are used, then each interval consists in 0.05 of the normalized value.
An important issue in this project was the identi fi cation of the ideal number of intervals for each variable. Fig. 4 shows a view of the histograms of all variables already normalized ( Hall et al., 2009 ). Notice that this view additionally shows the minimum and maximum values that each variable has taken, as well as their distribution. After several trials, all the variables were discretized in 20 intervals, except for U2JDP635 (atomization steam pressure).
Clearly this variable only needs four intervals. 4. Probabilistic model
At this point a fair question may arise. Why are intelligent techniques necessary? How does AI contribute to an adequate viscosity estimation? The answer is in the ef fi cient algorithms that are now available to build models based on historical data. Tuxpan power plant has provided data from values of the selected variables in Table 1 , and the viscosity measurement with the on-line viscosity meter. Thus, a probabilistic model can be learned in the form of a Bayesian network.
 application, and the arcs represent the probabilistic relation between the variables. The variable destine of the arc is probabil-istically dependent on the variable at the source of the arc. This follows the Bayes theorem that allows calculating the probability of a hypothesis H given certain evidence E : P  X  H j E  X  X  P  X  E j H  X  P  X  H  X  P  X  E  X   X  6  X  viscosity hypothesis, P  X  H j E  X  given that we observe sulfur in a chemical analysis as evidence, we could easily calculate the times that we observe sulfur, since we know the viscosity value P  X  E j H  X  in many fuel oil analysis. In other words, we need to calculate (DAG) representing the joint probability distribution of all vari-ables in the domain ( Pearl, 1988 ). The topology of the network provides direct information about the dependency relationship between the variables involved. Particularly, it represents which variables are conditionally independent given another variable. A knowledge base represented as a Bayesian network can be used to consider the consequences of speci fi c input data by what is called probabilistic reasoning . When some evidence appears, i.e., an assignation of a value to the input variables, their effect is propagated through the network to update the probability of the hypothesis ' variables. Updating the certainty measures is consis-tent with the probability theory, based on the application of
Bayesian calculus and the dependencies represented in the network.
 are three ways to obtain the knowledge required: (1) Participation of experts in the fi eld who can explain the dependencies and independencies between the variables and may also calculate the conditional probabilities. (2) A great variety of automatic learning algorithms which utilize historical data to provide the structure and the conditional probabilities corresponding to the process where data were obtained. (3) A combination of (1) and (2), i.e., using an automatic learning algorithm which allows the expert to de fi ne the structure. 5. Algorithms and tools for learning probabilistic models the structure of Bayesian networks and calculate the numerical parameters. The selection of the correct algorithm depends on several criteria. For example, the participation of experts is required in the de fi nition of obvious probabilistic dependencies.
The construction of models with relatively low interconnection is necessary because the virtual sensor works on-line, i.e., the viscosity inference must be made fast enough.
 probabilistic model.
 the variables. For example, it is known that a change in fuel temperature causes a change in fuel viscosity (see Fig. 2 ). It also restricts the number of parents that any node may have. Tree augmented Na X ve Bayes ( TAN ) algorithm , based in Chow and
Liu (1968) . This algorithm is useful to construct classi networks where a speci fi c node is the hypothesis to estimate, like the viscosity in this application.

Greedy Search-and Score ( Spirtes et al., 2000 ). This algorithm utilizes a score function to evaluate and select the best possible structure of the network, given an application data set. It restricts the number of parents that any node may have. This algorithm is available in the Hugin software package ( Andersen et al., 1989 ).

With a fi rst set of historical data from the power plant, several experiments were carried out in order to discover the ideal characteristics of the models. The experiments helped to address issues like: the variables more directly related to viscosity, the causal order of variables in the learning algorithm, the consideration of a delay in some variables that produces better estimations, normalization of values for the analysis, the number of convenient intervals in the discretization.
Consequently, the learning process in this project consisted of a set of experiments that evaluated the different models learned, in order to deal with the above mentioned issues.

In some cases, basic tools like Cross-validation ( Kohavi, 1995 ) were used. Some other basic techniques include R OC curves ( Provost and Fawcett, 1997 ) that depict the performance of a classi the number of positives against the number of negatives. These techniques were used to estimate th eperformanceoftheaccuracyof the viscosity estimation, as explained below.

The evaluation conducted in the experiments was rated using the following tools: Bayesian information criterion or BIC score, con fl ict analysis and an error measure between the estimated and the measured viscosity. 5.1. Bayesian information criterion or BIC score
Considering the models are constructed using real time data from the plant and since there is a possibility of fi nding different causality considerations for the learning algorithm, a measure-ment of how well the resulting model represents the data is necessary. A common measure is the Bayesian information criter-ion, or BIC score ( Cooper and Herskovitz, 1992 ). The mathematical de fi nition of the BIC score is
BIC  X  n ln  X  s 2 e  X  X  k ln  X  n  X  X  8  X  where n is the number of data registers in the learning data set, k is the number of free parameters to estimate and s 2 e is the error variance de fi ned as  X  1 n  X  n where x i is the i th value of variable x and x is the mean value of variable x . Thus, obtaining different models with different criteria, the model with the highest BIC value is the one preferred. Notice that BIC score for discrete variables is always negative. Therefore, the lowest negative value (the highest BIC value) is the model preferred.
 5.2. Data con fl ict analysis
Some con fl icts arise in the testing phase due to the fact that the models are constructed using real time data from the plant and that not all the operative state area is examined. The data con analysis detects when rare or invalid evidence is received. Given a set of observations or evidence e  X f e 1 ; e 2 ; ... ; e n de fi ned as ( Jensen et al., 1991 ) conf  X  e  X  X  log
The con fl ict can be calculated after data from the variables are loaded in the model and a new viscosity estimation is obtained. In other words, new evidence is loaded. Thus, if con fl ict conf ( e )is positive, then there is a negative correlation between the related variables ' values and a con fl ict is detected. On the contrary, if conf  X  e  X  o 0, then the evidence is presumably consistent with the model. Some experiments were conducted and some con fl icts were detected. 5.3. Error measure
The evaluation parameter for some experiments was the error found between the estimated viscosity ( V est ) and the measured viscosity ( V read ) using the viscosity meter. The error is de Error  X   X  V read
This measure represents the model ' s performance for the estimation of viscosity comparing two values. However, instru-ment engineers calculated errors differently. The error is com-pared with the whole span of values that the instrument may have ( Manoilo and Lekhter, 1987 ). Thus, the error was de fi ned as Error  X   X  V read where V max and V min represent the span of values where the viscosity meter was calibrated. In the Tuxpan case, V max and V min  X  13 cp. 6. Learning experiments
A plant emulator that reads a testing data set and sends it to the virtual sensor software was developed. The data set includes the measured viscosity. The virtual sensor software reads the data from the emulator, loads the evidence in the Bayesian network, runs the inference and obtains a posterior probability distribution of viscosity. Fig. 5 shows an example of a posterior probabilistic distribution of the viscosity node, given all the evidence from the rest of the variables.

In this example, after probabilistic propagation, the result shows a 69.3% probability that viscosity is in the third interval, i. e., between 0.1 and 0.15 of the normalized value. In addition, there is a 23.6% probability for values between 0.5 and 1, or 6.1% for values between 0 and 0.5. The rest of the value intervals have negligible values.

The estimated value of viscosity ( V est )isde fi ned with the the interval i , and P i is the corresponding probability of this interval. V est  X  15 : 2 : 33 cp in the example in Fig. 5 .
Another methodology used to de fi ne the value of the estimated viscosity after the probabilistic propagation is the central value of the interval with the highest probability. In the example of Fig. 5 , V est normalized would be 0.175. 6.1. Experimental performance validation
The experiments are conducted as described below: given a set of data, a learning algorithm is applied and a Bayesian network is obtained. The network is introduced in the software along with the testing data set and a comparison is made of the viscosity estimation based on probabilistic propagation, and the viscosity from the hardware meter. An error is calculated and reported in the experiment. However, several combinations of characteristics of the experiments are possible. For example, inserting delays or not, discretizing with 10 or 20 intervals, normalizing or not.
Several experiments were conducted to discover the optimal characteristics that produce the best probabilistic model.
The fi rst set of experiments were planned to de fi ne aspects of the learning process like order in the variables, normalization, discretization and delays. Information corresponding to one day was used for the tests, and the rest of the values to train the models. The variables ' values were registered every 5 s, thus obtaining more than 17,000 registers per day.

In the fi rst experiment, a 5.78% error was obtained discretizing with 10 intervals. In the second, a delay was inserted in some variables and the error decreased to 5.64%. The third experiment changed to 20 intervals in the discretization and the error decreased to 2.63%. This is expected since discretizing a contin-uous value variable necessarily inserts an error in the processing.
Of course, there is always a compromise between computational cost and expressivity of the models. Notice that these experiments were evaluated with the error in relation to the viscosity measured with the viscosity meter, i.e., the fi rst equation of Section 5.3 . The delay is important since the viscosity is measured at the boiler inlet and the thermal rating is evaluated by means of the generated power measured at the electric generator. This means that if fuel has de fi cient viscosity, combustion will also be de after some seconds. A delay of 20 s provides a good setting in the viscosity validation. Table 2 describes these experiments.
The second set of experiments was planned to evaluate the current de fi ned model with new real data received from the plant.
These data were used to carry out the tests. The error regarding the span of values of the hardware viscosity meter was also used, i.e., the second equation of Section 5.3 . In these experiments an 0 10 20 30 40 50 60 70 Probabilities in % error of about 4.5% was obtained. In one experiment a variable that presented a high positive con fl ict when evidence was loaded in it was excluded for the estimation process (see Section 5.2 ). Table 3 describes these experiments.
 models concerning the BIC score explained above. The complete data set obtained from the plant was used to train the model and calculate the BIC score. In addition, experiments were conducted to check the error average.
 in the corresponding variables were compared. A better BIC score was obtained when delays were considered. In other experiments a causal order of variables was used for the K2 algorithm, as recommended by the experts. The BIC scores of the models were compared utilizing exactly the opposite order of variables with a random order of variables. As expected, the experts causal orders obtained  X  1,461,010, while the random case obtained  X  2,908,010 BIC scores. Table 4 describes these experiments.

The experiments using the Tree augmented Na X ve Bayes (TAN) algorithm resulted in a higher error in two of the them. Fig. 6 shows the structure obtained using Viscosity as the hypothesis variable. This model was discarded.
 6.2. Revising Markov blankets
Besides the scores obtained in the models ' design, the de tion of the set of variables that allows estimating viscosity on-line is most interesting. According to combustion experts, this is the main contribution of this project. Fig. 7 shows the variables that belong to the Markov blanket (MB) of the viscosity node in every model obtained in the experiments.

A Markov blanket (MB) is de fi ned as the set of variables that makes a variable independent from the others. In a Bayesian network, the following three sets of neighbors are suf fi bind a MB of a node: the set of direct predecessors, direct successors, and the direct predecessors of the successors (i.e. parents, children, and spouses) ( Pearl, 1988 ).

Notice that power generation and air/fuel ratio (variables W01 and Rac) are never part of the MB of viscosity (variable A1000). Also notice that variable Z635 was eliminated from the models. Summarizing, the variable set that is related to viscosity consists of the following set: T590 ; F592 ; P600 ; F457 ; P635 ; T462 and Rt
The de fi nition of this set of variables is important since these will be sampled when creating the probabilistic model of a replicated plant. This is because there is no hardware viscosity meter in other plants. 6.3. De fi ned best model to estimate the viscosity
After conducting all the experiments a de fi nite model is selected. Fig. 8 shows this model.

As a conclusion from the experiments, the following considera-tions are needed for the generation of the best model: 1. normalization of the data set, 2. application of delay in the corresponding variables, 3. discretization using 20 intervals in most of the variables.
This structure was discussed with experts and approved by them to implement the fi rst tests. Notice the direct relationship between viscosity and fuel oil temperature. The next closest relation with viscosity is with the air fl ow and pressure of fuel oil to burners, the boiler temperature and the pressure of steam atomization.
 A complete explanation of the learning process is described in
Ibarg X engoytia et al. (2011) . 7. Results of learning experiments
This section shows the results of representative experiments conducted off-line, with real data from the plant, and on-line in the Tuxpan power plant.

Fig. 9 shows a general view of the viscosity read (red line) by the viscosity meter and the estimated value (blue line). The graph corresponds to a period of 1.8 days or 32,000 samples. The time series are represented in the horizontal axis in all fi gures. The vertical axis corresponds to the viscosity in cp. At the beginning of the period, viscosity is around 35 cp, while in the rest of the samples, viscosity is around 20 cp. This drastic difference is explained due to samples from different days. Viscosity is not expected to change at this speed. This fi gure is included to illustrate the performance of the virtual sensor. It shows how the estimated value follows the real value in different conditions. The following fi gures display the graphs with more detail.
Figs. 10 and 11 show a closer comparison between read (red line) and estimated viscosity (blue line) and the calculated error graph. The horizontal axis represents time and the vertical axis represents viscosity ' s normalized value. This means that viscosity is around 60% of the viscosity range, about 35 cp in Fig. 10 , and 15% of the viscosity range, about 20 cp in Fig. 11 . The error is also graphed between 0 and 1 (green line) where most of the values are below 10% of the instrument scale.
 The error shown in the graphs is calculated using Eq. (12) .
Finally, Fig. 12 shows a normalized comparison between the estimated and read viscosities and the fuel oil temperature and fl ow. Notice that the viscosity (purple and green lines) changes inversely to the fuel temperature (blue line) as expected. When temperature decreases, viscosity increases. And, when the decreases (red line), temperature increases, given that the heater capacity is applied to a lower quantity of fuel. 8. Virtual sensor installation and acceptance tests models learned off-line as described above. This software reads real  X  time data and leads to the corresponding inferences in order to estimate viscosity.
  X  OPC  X  stands for  X  OLE for Process Control  X  .  X  OLE  X  stands for
Linking and Embedding  X  , which is Microsoft ' s technology devel-oped to share and link data from different applications. Thus, OPC is a protocol developed to share control data between different control applications. In Tuxpan, the distributed control system is a
Siemens, which includes an OPC server. The virtual sensor soft-ware is provided with an OPC client that extracts the required variables every second. This software is a program written in C# running in real time. It includes the following modules: OPC client, probabilistic module and user interface.

In this section there is a description of the tests conducted in the power plant in order to obtain the operation manager ' approval of the virtual sensor. The main goal in this stage of the project is to obtain a recommendation of the fuel oil ' s optimal temperature according to the optimal viscosity recommended by the boiler manufacturer. This viscosity is 23.71 cp. The virtual sensor software calculates the optimal temperature using the Normalized values estimated value of viscosity, the current value of the fuel oil temperature and the tables of fuels ' characteristics like the one shown in Fig. 3 . The procedure is as follows: fi rst, the estimated viscosity and the temperature measured are utilized to identify the closest curve that coincides in the coordinates. If no curve exists, a proper curve is calculated using interpolation. Next, the selected curve is utilized to calculate the optimal temperature, given the fi xed optimal viscosity. Fig. 13 shows a small part of the experi-ments. Notice that the viscosity of the fuel oil (red and blue lines) is a very stable variable. It only changes when a different kind of fuel is provided. Hence, the oil temperature (green and purple lines) is also a stable value variable.

It is clear that the plant operator has maintained a certain temperature based on his experience. However, using this virtual sensor allows an average energy saving of about 4 1 C. It seems a small saving, but multiplied by 24 h, 365 days, it represents a considerable energy reduction, and consequently, a considerable cost reduction too.

In Fig. 13 , the current fuel oil temperature established by the operator is around 125 1 C, and the recommended temperature is around 120 1 C. Future registers will test the increment of the central performance and the decrement of the contaminant emissions. 9. Conclusions and future work
This paper has presented the creation of a viscosity virtual sensor that provides support to the control of a thermoelectric power plant. Several associated challenges were faced during the execution of this project. The fi rst challenge was the selection of the set of variables that might be combined to estimate fuel oil viscosity. This set of variables was selected among the traditional, measured variables in the control system of a power plant. The second challenge was the creation of the probabilistic model that made up the virtual sensor. This model is a Bayesian network generated with an automatic learning algorithm and experts advice. Other tools were utilized to re fi ne, normalize and discre-tize the obtained data set. The third challenge was the design of the viscosity virtual sensor that works on-line in the control room of the power plant. This virtual sensor is a computer program that utilizes the model used to infer viscosity, given the evidence from the other variables.

The viscosity virtual sensor was installed in the Tuxpan thermoelectric power plant in Mexico. The sensor shows the operator which is the optimal fuel oil temperature in order to maintain the optimal fuel viscosity, and therefore, obtain an optimal combustion.

Two speci fi c conclusions are generated in this work; one is academic and the other practical. The academic conclusion is that automatic learning algorithms from the arti fi cial intelligence area can be successfully utilized in the construction of virtual sensors.
The practical conclusion is that a viscosity virtual sensor can be used to implement a control loop that maintains the optimal fuel oil temperature at the burners.

Future work includes performance surveillance of the virtual sensor in the plant and the implementation of an adaptation module that may adjust the model for all the possible operational Normalized values Normalized values 20 40 60 80 100 120 140 Temperature in  X C Viscosity in cP conditions. Work is also underway currently regarding the use of dynamic probabilistic models that consider time in the design of virtual sensors for this and other industrial processes. the viscosity virtual sensor in other power plants. The main challenge regarding this replication is transferring the knowledge ( Luis et al., 2010 ) needed in order to use the models constructed in
Tuxpan, but adapted to other power plants ' conditions. The fuel oil is the same. The plants are different.
 Acknowledgments CFE, Miguel V X zquez, Jos X  Alfredo S X nchez and Luis Enrique
Serrano from IIE and Alicia Balderrama. This research work is supported by the Grant 89104 from CONACYT-CFE Sectorial Found, and Project 13665 from IIE.
 References
