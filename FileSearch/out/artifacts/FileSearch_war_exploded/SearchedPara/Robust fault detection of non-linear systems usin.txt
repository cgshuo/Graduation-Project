 1. Introduction scheme consists of the comparison of system output measure-ments with the corresponding analytically computed values, obtained from measurements of other variables and/or from non-zero when a fault is present. However, modelling errors, disturbances and noises in complex engineering systems are model-reality differences ( Chen and Patton, 1999 ). unknown input observers ( Chen et al., 1996 ), eigenstructure ( Basseville and Nikiforov, 1993 ).

However, such approaches present several drawbacks. First, time varying and therefore should be estimated. Moreover, the uncertainty will be missed (missed alarms).
 Maksarov and Norton (1996) . However, in this approach only city property holds.

The paper is organized as follows: In Section 2 ,theproblemof 7 summarizes the main conclusions of the paper.
 2. Set-membership state estimation applied to fault detection 2.1. System model
Consider the following discrete-time non-linear dynamical model describing the behaviour of the system to be monitored: x k  X  1  X  g  X  x k , u k , y k , w k  X  ,  X  1a  X  y  X  h  X  x k , u k , y k  X  X  v k ,  X  1b  X  where: system inputs and y A R p is the vector of system outputs. w k A R n and v k A R p are process and measurement noises, which are considered unknown but bounded, i.e., v k A V and w k A W , where V and W are the interval boxes V  X f v A R p 9 v r v r v g ,  X  2  X 
W  X f w A R n 9 w r w r w g :  X  3  X  ment non-linear functions, respectively.
 X 0 describes the set of initial states as
X 0  X f x A R n 9 x 0 r x r x 0 g :  X  4  X  bounded by a compact set y k A Y of box type Y  X f y A R q 9 y r y r y g :  X  5  X 
Parameter uncertainty comes from physical modelling or from the set-membership parameter estimation algorithms applied in knowledge about parameter variance, the following additional equation can be added to the system description (1a) X (1b): y  X  y k  X  p k ,  X  6  X  with p k A P , where P is an interval box P  X f p A R q 9 p r p r p g :  X  7  X 
Here, two different cases can be considered: time-invariant case, what implies p k  X  0, and time-varying case, what implies p k A P .
 variation is specifically bounded by the interval box P .
The first case might represent situations where an initial variance comes from component specifications that are known only with a mean and variance in the beginning of the fault 2.2. Fault detection using set-membership estimation i.e., f u j g k j  X  0 and f y j g k j  X  0 . Also, ~ w k , ~ v of unknown but bounded (inside their respective sets) process and measurement noises, parameter uncertainty and parameter variations, that is, f w j g k j  X  0 , f v j g k j  X  0 , f y time-invariant systems are considered, then ~ p k  X f 0 g . tem described by (1a) X (1b), an initial compact set X 0 and a membership approach is expressed as
X  X f x k 9 ( ~ w k , ~ v k , ~ y k , ~ p k , x 0 A X 0 ,  X  x  X  y  X  h  X  x j , u j , y j  X  X  v j  X  k j  X  0 ,  X  y ~ y and ~ p k which satisfy the nominal system (1a) with initial condition X 0 and noise, disturbances and parameters that belongs to V , W , Y and P , respectively.

According to Definition 2.2 , a fault can be detected using a set-membership estimator when the set of estimated states in Definition 2.1 is the empty, i.e., X k  X  | .
 3. Constraints satisfaction background detection problem. 3.1. Constraints satisfaction problem ( Jaulin et al., 2001b ), where A solution point of H is an n -tuple  X  ~ z 1 , ... , ~ z n variable z i A Z is consistent in H if and only if 8 ~ z i A (  X  ~ z 1 A D 1 , ... , ~ z i 1 A D i 1 , ~ z i  X  1 A D i  X  1 such as  X  ~ z 1 , ... , ~ z n  X  A S  X  H  X  .
 in Jaulin et al. (2001b) .
 approximating the variable domains by means of intervals and finding the solution through solving an Interval Constraints constraint satisfaction algorithms have polynomial-time worst case complexity since they implement local reasoning on ( Jaulin et al., 2001b ). 3.2. Real paver by research team of Professor Granvilliers ( Granvilliers and operations: domain contraction and propagation , which can be combined with an additional operation known as bisection , if necessary. The solution provides refined interval domains consistent with the set of ICSP constraints. 3.2.1. Contraction if it satisfies 8 X  z A D : operators is therefore known as contraction . 3.2.2. Propagation
When several constraints are involved, the contractions are propagation method converges to a box which contains all which the method converges does not depend on the order to is called forward X  X ackward propagation . 3.2.3. Bisection
The combined use of contraction and propagation leads only to tion independently. To escape from local consistency, every split by its mid point. Then, contractors and propagation are applied on the new resultant sub-boxes. This process, called to a pre-established amount is achieved. 4. Fault detection using set-membership state estimation based on constraint satisfaction 4.1. Fault detection using CSP: the general case
The fault detection procedure described in Definition 2.2 requires the computation of the set of estimated states X naturally to a CSP on sets by introducing the following definitions: Z  X f ~ x k , ~ w k , ~ v k , ~ y k , ~ p k g ,
D  X f ~ X k , ~ W k , ~ V k , ~ Y k , ~ P k g , where ~ X k domain of all the variables, and C  X  C 1 [ C 2 [ C 3 , where
Algorithm 1 allows to solve the set-membership state estimate above, the process/measurement noise bounds, the set of para-meters and the initial state uncertainty.
 Algorithm 1. Fault detection using CSP. 1: X 0 ( X 2: Y 0 ( Y 3: for k  X  0to N do 4: obtain f u k , y k g 6: W k ( W 7: V k ( V 9: P k ( P 10: Z 11: D k (f X 0 , ... , X k , W 0 , ... , W k , V 0 , ... , V 12: C k (f X  x j  X  1  X  g  X  x j , u j , y j , w j  X  X  k j  X  0 13: H k  X  X  Z k , D k , C k  X  14: S k  X  solve  X  H k  X  15: if S k  X  | then 16: fault detected 17: else 18: no fault detected 19: end if 20: end for computational complexity. This complexity comes from the fact decomposed using subpavings (union of boxes) and to use set growing of the computation times ( Jaulin et al., 2001a ).
A possible relaxation in order to reduce computational Then, this approximation leads to a CSP over intervals, named ICSP ( Jaulin et al., 2001a ) and the new set of domains for H k  X  X  V k , D k , C k  X  is expressed as follows 2 : D k  X f &amp; X 0 ;; ... , &amp; X k , &amp; V 0 , ... , &amp; V &amp; W 0 , ... , &amp; W k , &amp; Y 0 , ... , &amp; Y k
Moreover, this relaxation allows the use of interval methods, determination of the sets which define the variable domains neously but demands a high computational burden because
X is an empty set as well and the fault is detected. Otherwise, nothing can be stated since &amp; X a | does not imply X  X 
Another drawback of Algorithm 1 is the increase of computa-restriction is added. So, the amount of computation burden increases with time, being impossible to operate over a large window of length L ( Puig et al., 2004 ). 4.2. Fault detection using CSP: the time-varying case
Summarizing, Algorithm 1 can be approximated as presented in Algorithm 2 under the following considerations: a CSP over sets will be relaxed to a CSP over intervals, local consistency is used instead of global consistency, and domains of variables are computed iteratively from previously computed domains.
 robust fault detection algorithm proposed in Rinner and Weiss approximation is proposed in Ocampo-Martnez et al. (2006) .
Algorithm 2. Fault detection using CSP on intervals (ICSP). 1: &amp; X 0 ( &amp; X 2: for k  X  1to N do 3: obtain f u k , y k g 4: &amp; X k ( &amp; X 5: &amp; W k 1 ( &amp; W 6: &amp; V k 1 ( &amp; V 7: &amp; Y k 1 ( &amp; Y 9: D (f &amp; X k , &amp; X k 1 , &amp; W k 1 , &amp; V k 1 10: C 1 (f x k  X  g  X  x k 1 , u k 1 , y k 1 , w k 1  X g 11: C 2 (f y k  X  h  X  x k , u k , y k  X  X  v k g 12: C (f C 1 , C 2 g 13: H k  X  X  Z , D , C  X  14: &amp; S  X  solve  X  H k  X  15: end for 16: if &amp; S  X  | then 17: fault detected 18: else 19: no fault detected 20: end if 5. Application Example 1: quadruple-tank process system proposed in Johansson (2000) is used. This is a multi-variable laboratory process proposed as a control benchmark. 5.1. System description components of the system are tanks T 1 , T 2 , T 3 and T 4 .
 time as in (1). From the continuous-time non-linear equations a sampling time of 1s: y j k  X  x j k for j A f 1 , 2 g ,  X  9e  X  where: 5.2. Fault scenarios From the continuous-time non-linear equations presented in are reduced to the 80% of their nominal value.
 the tanks (such that the outflow is lost).
 5.3. Results
The results corresponding to three of the previous fault scenarios are presented: a faultless scenario and two faulty situations. In all of them, results are obtained by using the
Algorithm 2 . As discussed in the background section, several approaches can be used to solve the ICSP enunciated in approach only ensures locally consistent solutions while the 5.3.1. Scenario 1 (faultless)
This scenario is used to test the set-membership state estimator in faultless situation. Results, obtained by using show the lower and upper state estimate bounds for h 3 and h measured levels y 1 and y 2 with each lower and upper state
T due to the measurement noise. On the other hand, h 3 and h estimated by using the model that is affected by parameter measurements h 1 and h 2 . 5.3.2. Scenario 2 (fault f P 1 )
In this scenario, a fault in pump P 1 is introduced at time ments. This is a post-fault strategy that avoids the use of 0 5 10 15 20 0 2 4 6 h (cm) h (cm) 0 5 10 15 20 0 5 10 15 20 time (min) 0 5 10 15 20 0 2 4 6 h (cm) 0 5 10 15 20 0 5 10 15 20 h (cm) h (cm) 10 15 20 h (cm) time (min) 0 2 4 6 h (cm) 0 5 10 15 20 h (cm) time (min) ments still remain outside them. 5.3.3. Scenario 3 (fault f T 3 )
Now, a leak in tank T 3 is introduced at time 10 min. Fig. 4 is not measured. However, since it is estimated using the
Notice that, compared with the previous fault scenario, the inconsistency between the model output and the corresponding can be used for fault isolation. 5.3.4. Scenario 4 (fault f y 1 )
Finally, a fault in the sensor that measures the level h 1 introduced at time 10 min. Fig. 5 shows the state estimation estimation algorithm continues without correcting the estate estimation by using the measurements. In this scenario, the measurements remain outside the envelopes just for some time once a fault appears it remains present. 6. Application Example 2: sewer network
The second application example used to show the effective-based on the sewer network of Barcelona. 6.1. System description
The portion of sewer network of Barcelona considered in this and two virtual tanks, which represent two network catchments time (min) x (m ) 0 2000 4000 6000 time (min) obtained by using the conservation of mass in tanks, assuming x 2 k  X  1  X  x 2 k  X  T  X  b 1 x 1 k b 2 ffiffiffiffiffiffiffi x 3 k  X  1  X  x 3 k  X  T  X  b 2 ffiffiffiffiffiffiffi x 2 k p y k  X  b 2 ffiffiffiffiffiffiffi x 2 k p  X  v k , where: , , , 6.2. Results
The presented results are obtained from data recorded by the telemetry system of Barcelona sewer network in a real rain scenario occurred on September 14, 1999. Algorithm 2 has been applied in faultless and faulty scenarios. 6.2.1. Scenario 1 (faultless) non-measured states x 1 and x 3 .Middlegraphsshowthetemporal can be noticed that the state estimation algorithm is working 6.2.2. Scenario 2 (sensor fault) measurements. 7. Conclusions time (min) 2000 4000 6000 x (m ) time (min) tion may be an useful tool applied on fault detection.
Finally, two application examples have been used to show the effectiveness of the proposed approach: the well-known quad-ruple-tanks benchmark and a representative piece of Barcelona sewer network. The fault detection results obtained using the proposed approach show good performance in the considered in a fault diagnosis system.
 Acknowledgments
This work has been supported by the CICYT WATMAN (Ref. DPI2009-13744) and CICYT HYFA (Ref. DPI2008-01996) of the support received from CLABSA in the second application presented in this paper.
 References
