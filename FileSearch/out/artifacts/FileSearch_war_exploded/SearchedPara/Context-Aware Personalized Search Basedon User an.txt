 With the explosion of collaborative tagging data nowadays in various Web 2.0 communities such as web page bookmark collection (Del.icio.us 1 ), movie recom-mendation (Movielens 2 ) and image sharing (Flickr 3 ), there is an urgent demand in assisting users to search interested resources quickly and effectively. Such a requirement entails much research on utilization of tag-based user and resource profiles so as to provide a personalized search in folksonomies [3,13,16,21]. How-ever, these methods have a shortage of neglecting user query intention, and let us look at the following example as shown in Fig.1.
 Example 1. Suppose that user Alice annotated two different recipes by two tags  X  X cecream X  and  X  X picy X  . If we adopt the tag-based profiling methods (suppose we use term frequency to construct user profile), the user profile of Alice can be constructed as j and k whose profiles are described below. When Alice tries to search some recipes and input keywords  X  X eef X  and  X  X raise X , the above three recipes will all be returned even though recipe k is not relevant to her query at all. This is because the resource profile of recipe k matches the tag  X  X cecream X  in the user profile of Alice. The problem is due to that  X  X cecream X  in Alice X  X  profile is not relevant to her issued query. In other words, tags in her profile such as  X  X cecream X  should have different degrees of relevance to different queries context. In this particular example, in the search context of finding recipes about  X  X raised beef X , the tag  X  X cecream X  should not be counted at all.
Therefore, we consider that it is unrea sonable to use a static relevance for all tags in user profile for each issued queries. To address this problem, in this paper, we propose a search context model to capture and understand user inten-tion. Since queries may have different se arch contexts, and they can be utilized to measure how relevant each tag in user profile to the current query is. The contributions of this paper include the following: (i) We propose an explicit nested context model in order to capture and understand user intention; (ii) By utilizing the nested context model, we devise a context-aware personalized search approach to adjust the relevance of tags in a user profile dynamically, so as to rank resources based on user preferences and the search contexts; (iii) Experiments are conducted on real-life data set by comparing the performance of our proposed approach and baseline methods. The experimental results are consistent with our observations.

The rest of this paper is organized as follows. In Section 2, we review some re-lated works in collaborative tagging systems, context modeling and personalized search. In Section 3, our model for constructing user and resource profiles, and the nested search context modeling, are described. We present a context-aware personalized search approach to adjust the relevance of tags in user profile dy-namically in Section 4. Experiments on a real life data set are conducted, and the results are analyzed in Section 5. Finally, we summarize our work and discuss some future research directions in Section 6. In this section, we review some related works in collaborative tagging systems, context modeling and personalized search.
 Collaborative Tagging Systems. Literature on collaborative tagging can be generally classified into two categories. One is about the investigation and anal-ysis of the characteristics of user generated tags. In [6], Golder and Huberman studied tag usage patterns and user behavior in tagging.In an attempt to figure out valuable tags for search, Bischoff et al. [2] conducted a survey on some real tagging data sets. Manish et al. [7] also carried out a comprehensive survey on various features about social tagging data and techniques. The other is to dis-cover features like link structure and semantic similarities in the folksonomies for various applications. The two novel algorithms proposed by Bao et al. [1], consisting of SocialSimRank (SSR) and SocialPageRank (SPR), incorporated benefits from social annotations so as to assist web search. [12] examined three (naive, co-occurrence and adaptive) approaches to construct the tag-based pro-file and their comparison.
 Context in IR. In IR research community, context modeling has attracted much attention, and been utilized to understand user search intentions. Hassan et al. [8] theorized context that can be us ed in information ret rieval. Besides, the context-sensitive search models derived from user search log were developed by Shen et al. [14,15]. In [18], the pre-query session activity was also regarded as the context in order to predict user short-term interests. Based on the con-text model from cognitive science by [11], White et al. [17] compared various contextual sources, and found that thei r hybrid was the most effective in terms of predicting user behavior. Sheng et al. [20] specified the context as four kinds of relationships: reformulation, specialization, generalization, and general asso-ciation between previous queries and current one to facilitate Web search result ranking. Furthermore, the context can be adopted in some other applications such as query classification [5], query prediction [9] and Web page recommenda-tion [17].
 Personalization in Folksonomies. There are several relative research efforts on the utilization of resource profile and user profile for the facilitation of person-alized search in folksonomies. The term frequency (TF) profiles proposed by Noll and Meinel [13] aims to discover related tags for users and res ources, hence per-sonalized ranking is provided. The term f requency-inverse document frequency (TF-IDF), Best Matching 25 (BM25) [21] and their hybrid [16] paradigms are followed by later works. Taken into account of the two kinds of sources, TF-IDF is combined with the user and resource profiles along with positions of tags in [4]. To further improve the previous tag-based methods, a normalized term frequency (NTF) was devised to model user and resource profiles in our earlier work [3]. However, these methods utilize user profiles in a static way, so that the search contexts are ignored for different queries. 3.1 Tag-Based User and Resource Profiling In a Web 2.0 collaborative tagging community, a user tag on a particular resource signifies two things. On the one hand, th e tag can reflect this user X  X  preference in some sense. On the other hand, the tag can be used to describe the resource X  X  feature to certain extent. Based on these two observations and existing forms of tag-based profile in folksonomies, we define user and resource profiles as follows. Definition 1. A user profile of user a , represented by form of tag:value pairs, i.e., where t a,x is a tag used to annotate some resources by user a , n is the total number of all tags used by the user, v a,x indicates the degree of preference for user a on tag t a,x . According to our earlier wor k [3], NTF (Normalized Tag Frequency) paradigm is the most suitable in calculating the degree of preference 4 , namely: where N a,x is the frequency of the use of tag x to annotate resources by user a ,and N a is the amount of resources tagged by user i . The higher the value of v a,x , the greater preference to tag x by user a .
 Definition 2. A resource profile of resource i , represented by in the form of tag:value pairs: where t i,x is a tag having been used by some users to describe resource i , n denotes the total number of tags annotating resource i , w i,x is a relevant degree of t i,x to resource i . Similarly, it can be calculated by NTF as follows: where M i,x is the number of users using tag x to annotate resource i ,and M i is the total amount of users having annotated resource i . The higher the value of w i,x , the more salient or relevant tag x for resource i . 3.2 Nested Context Modeling The purpose of the user profiling in personalized search is to predict what poten-tial tags users may prefer. However, as discussed in Example 1 , tags in a user profile should not be static to different queries issued by the user. To tackle this problem, we identify the context for the current issued query, and then use it to measure the relevance of each tag in user profile to current query. In this sub-section, based on context model in [10,1 1], our proposed nested context model is introduced. As shown in Fig. 2, there are three different levels of contexts in the nested model: Elemental Context (Term/Tag Level). Essentially, the elemental context for a query term/tag is a set of tags relevant to the query term. In a collaborative tagging system, if two different tags are used to annotate the same resource by some users, we assume that these two tags are relevant. According to this assumption, to obtain the elemental c ontext for the query term, we consider that tags co-occurs with the query term in a resource profile should be relevant, and let us revisit Example 1 to see what are elemental contexts for each query terms. As illustrated in Fig. 3, the elemental context for query term  X  X eef X  is the set of the co-occurred tags which include { spicy, lettuce, braise } . Similarly, the elemental context for query term  X  X raised X  is { spicy, beef } .Wecanseethat the tag  X  X cecream X  in the user profile does not appear in these two elemental contexts. If we adopt these two elemental contexts to measure relevance for all tags, the tag  X  X cecream X  should be irrelevant so that recipe k will not be regarded as relevant resource to current query. Form ally, the elemental context for a query term/tag is defined as follows. Definition 3. An elemental context for a query term/tag t i q , denoted by E i , is a set of tags/terms which co-occur in the same resource: resource profile.
 Local Context (Query Level). The local context is at the query level, and considers all terms/tags in a query. We define the local context for a query as follows.
 Definition 4. A local context for a query Q j , denoted by L j ,isaunionset of all elemental contexts for each term in the query: where t x is a tag in the elemental context for a particular query term, t i q is a query term in the query Q j . For example, the local context for the query in Example 1 is the union set { spicy, lettuce, braise, beef } of elemental context for  X  X eef X  { spicy, lettuce, braise } and  X  X raised X  { spicy, beef } . Global Context (Task Level). The global context is at the task level, and a task is defined by all queries issued by a user within the current session. We demarcate the session by the 30-minute threshold as in other Web log analysis [19]. Accordingly, we define the global context for a task as follows. Definition 5. A global context for a task T , denoted by G k ,isaunionsetof all local contexts for each query in the task: where T is the task for the current query, t x isatagoccurredinanyofthe queries X  local context. The global context is to identify how valuable a tag in a user profile to the current query is, thereby facilitating the personalized search. After the identification of the global context, the next major step is to achieve the personalized search for the query issuer . This process can be further divided into two sub-processes. The first one is to measure how relevant or valuable all tags in a user profile under the current global context is, so as to adjust the relevant degree of these tags for the query 5 . The second process is to rank resources by considering resource profiles, the cont extualized user profile and the query. 4.1 Contextualization Contextualization is the pr ocess of measuring how relevant (or valuable) a tag in a user profile to current context is. To achieve this goal, we need to mea-sure the relevance between the tag and t he elemental context firstly. Based on our observation in co-occurred tags in resource profiles, we make the following assumption.
 Assumption 1. For two tags x and y and query term q ,iftag x has more frequent co-occurrence with query term q in the resource profiles than tag y ,then tag x should have greater relevance than tag y to the elemental context of query term q .

Accordingtotheaboveassumption,t he relevance between a tag and the elemental context of a query term ( elemental context relevance for short) is calculated as follows: where |{ R y | t x  X  R y ,t i  X  R y }| is the number of the set of resources which tag t x and query term t i q co-occur, N is the total number of resources in the collaborative tagging system. Then, the relevance between a tag and the local context of a query ( local context relevance for short) is obtained by the average of its all elemental context relevances, as follows: where N Q j is the number of query terms in query Q j . Finally, the relevance between a tag and the global context of a task ( global context relevance for short) is measured as follows: context relevance, Sim ( Q c ,Q j ) is the similarity between a query in the task and current query. Intuitively, the similarity can be calculated by the Jaccard Similarity between two queries as follows: However, this method has a shortage, as revealed by the following example. Example 2. Suppose that user Bob has issued two related queries food } and are given below:  X   X  If we use Jaccard Similarity to measure the relevance between these two queries, it will be zero. This method is unreasonable since the intentions behind these two queries are quite similar. The Jaccard similarity ignores the case where two queries are related but have no overlapping query term.In contrast, the local context L 1 for Q 1 is { icecream, cold, cake } and L 2 for Q 2 is { sweet, cold } ,so if we further take the local context together with query terms into consideration, these two queries will be similar to a cer tain extent, which is more reasonable. Based on the above analysis, we make the following assumption: Assumption 2. For any three queries Q i , Q j and Q c , if the local context of Q i is more relevant than Q j to the local context of Q c ,thenquery Q i should be more relevant (or similar) than Q j to query Q c .

Based on the above assumption, we propose a revised query similarity measurement between two queries as follows.
 To revisit Example 2 , we can calculate that similarity between two queries is 0.6 which are more reasonable than using Jaccard similarity. When the global context relevance is measured, we can ad just the existing weight values in the user profile, the result of which is named as contextualized user profile. Formally, we define a contextualized user profile as follows.
 Definition 6. A contextualized user profile under a query X  X  global context G k by user a , represented by where t a,x is a tag in the user profile, v k a,x is the contextualized weight value of tag x ,and v k a,x can be obtained as follows: where v a,x is the degree of preference for user a on tag t a,x according to Defi-nition 1 , Rel ( G k ,t x ) is the degree of relevance for tag t x under global context G k . A greater value of v k a,x means greater relevance to current query and greater preference by the user. 4.2 Resource Ranking In this section, we discuss how to rank resource based on resource profiles, the given contextualized user profile and query. This problem can be formally de-scribed by the following function: where U is the set of users, Q is the set of queries, and R is the set of resources. The result of  X  function is a relevant ranking score of a resource to a query issued by a user. The greater the score, the more relevant the resource to the query. In some earlier work [3,4], this problem is divided into query relevance  X  : Q  X  R  X  [0 , 1] and user interest relevance  X  : U  X  R  X  [0 , 1]. Intuitively, these two relevances can adopt the cosine similarity as follows. where cos function is the cosine similarity between two vectors. However, it has been proven less effective than the fuzzy function in our earlier work [3], namely: where s is the number of terms matching the query, m is the number of query terms, and The personalized ranking is bas ed on the relevance score of  X  function. In other words, the greater value of relevance sc ore, the higher ranking the resource in the search result list. 5.1 Data Set and Metrics Our data is collected from our implemented prototype: Folksonomy-based Multi-media Retrieval System (FMRS), which is specifically designed for personalized recipe search. This data set includes 500 recipes, 7889 tags and 203 users, each of whom tagged 16.7 recipes on average. The tags describe various aspects of the recipes and users X  perception on th em. To evaluate our proposed method, the data set is randomly split into two parts: 80% as training and 20% as test set. We use two metrics P @ N (Precision @N) [17] and MRR (Mean reciprocal rank). The P @ N indicates how accurate a particu lar personalized search strat-egy is, while MRR measures how fast this personalized strategy assists users to find the target resource. 5.2 Baselines As shown in Table 1, we have six different combinations of strategies to be com-pared in the experiments. The Context Type refers to the three kinds of contexts as defined in Definitions 3 to 5 . Moreover, there are two query similarity mea-surements proposed ( Equations 6 and 7 ). Furthermore, for ranking methods, there are cosine and fuzzy methods (ref. Equations 10 and 11 ). In addition, for each strategy combination, four paradigms are adopted as baseline methods, namely, TF-IDF, BM25 [21], HYBRID 6 [16] and NTF [3] for constructing tag-based user and resource profiles. Theref ore, as shown in Table 2, we have totally 24 methods for comparison.
 5.3 Experimental Results The experimental results in terms of metrics P @ N and MRR for the 24 methods are shown in Table 2. Generally, we can observe that those methods with context information outperform conventional methods (all N methods) which consider no context information. It means that co ntext user profiling is more precise and effective than conventional static way ( Example 1 ). Indeed, the more complete context used by the method, the better performance gains (G &gt; L &gt; E &gt; N 7 ) by all the four profile constructing paradigms. In other words, the context at a high level has more complete information, so can achieve better performance than those at lower levels (e.g., Global versus Local and Elemental). This result verifies the rationale of our proposed nested context model. Furthermore, G  X  &gt; G signifies that revised query similarity is more reasonable than Jaccard similarity ( Example 2 ). Besides, no matter what the strategy combination is used, the NTF always gain the best performance over all four paradigms. And G  X  &gt; G indicates that the fuzzy resource ranking method is more effective than the cosine one. These two findings are consistent with the conclusions in our previous work [3]. In this paper, we focus on tackling the problem caused by neglecting user search context (treating the rel evance degree of tags in user profile as static to each query) in conventional personalized methods in folksonomies. A nested context model is proposed to capture different levels of search contexts to solve this prob-lem. Besides, we have discussed how to contextualizing a user profile under a context. By conducting the experiment, we have shown that the context informa-tion and our proposed nested context model can be quite effective and valuable to personalized search in a collaborative tagging system. There are some future directions for our upcoming research. One is for us to incorporate additional in-formation such as user community, social relationships to explore more effective and powerful personalized search. Another possibility is to devise and try other user and resource profiling schemes such as multi-layered or graph-based ones. Acknowledgement. The research work presented in this paper has been sup-ported by a grant from the Research Grants Council of Hong Kong SAR [Project No. CityU 117608].
