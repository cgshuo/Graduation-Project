 Nonrigid structure from motion is the process of recovering the time varying 3D coordinates of points on a deforming object from their 2D locations in an image sequence. Factorization ap-proaches, first proposed for recovering rigid structure by Tomasi and Kanade in [1], were extended to handle nonrigidity in the seminal paper by Bregler et al. in [2]. The key idea in [2] is that ob-served shapes can be represented as a linear combination of a compact set of basis shapes. Each instantaneous structure, such as the mouth of a smiling actor shown in Figure 1(a), is expressed as a point in the linear space of shapes spanned by the shape basis. A number of approaches that develop the use of shape basis have subsequently been proposed, including [3, 4, 5]. Since the space of spatial deformations is highly object specific, the shape basis need to be estimated anew for each video sequence. The shape basis of a mouth smiling, for instance, cannot be recycled to compactly represent a person walking.
 In this paper, we posit that representing nonrigid structure as a combination of basis shapes is one of two ways of looking at the space-time structure induced by P points seen across F frames. In-stead of a shape space representation, we propose looking across time, representing the time-varying structure of a nonrigid object as a linear combination of a set of basis trajectories , as illustrated in Figure 1(b). The principal advantage of taking this  X  X ateral X  approach arises from the fact that com-pact representation in trajectory space is better motivated physically than compact representation in shape space. To see this, consider a deformable object being acted upon by a force. The extent of its deformation is limited by the force that can be applied. Hence, a tree swaying in the wind or a person walking cannot arbitrarily and randomly deform; the trajectories of their points are a function of the speed of the wind and the flexing of muscles respectively. Deformations are, there-Figure 1: 3D points on a smiling mouth: a comparison of shape and trajectory space. (a) In approaches that fore, constrained by the physical limits of actuation to remain incremental, not random, across time. Since this property is, to a large degree, ubiquitous, basis can be defined in trajectory that are object independent .
 We show that while the inherent representative power of both shape and trajectory projections of results from knowing the basis apriori allows us to handle much more nonrigidity of deformation than state of the art methods, like [4] and [5]. In fact, most previous results consider deformations which have a large rigid component, such as talking-head videos or the motion of a swimming shark. To the best of our knowledge, we are the first to show reasonable reconstructions of highly nonrigid motions from a single video sequence without making object specific assumptions. For all results, we use the same trajectory basis, the Discrete Cosine Transform (DCT) basis, underlining the generic nature of the trajectory space representation. A useful byproduct of this approach is that structure is automatically compressed for compact transmission without the need for post facto compression or the overhead transmission of object specific basis. If deformation of a 3D scene is unconstrained, the structure observed in each image would be in-dependent of those in other images. In this case, recovering structure from motion is ill-posed, equivalent to finding 3D structure from a single 2D image at each time instant. To make nonrigid structure recovery tractable, some consistency in the deformation of structure has to be imposed. One early measure of consistency that was applied assumes that the scene consists of multiple rigid objects which are moving independently [6, 7, 8]. However, the first general solution to the problem of nonrigid structure recovery was introduced by Bregler et al. in [2], approximating the structure at each time instant as a linear combination of basis shapes. They recovered the structure, the shape ba-sis and the camera rotations simultaneously, by exploiting orthonormality constraints of the rotation matrices. Xiao et al. [4] showed that these orthonormality constraints alone lead to ambiguity in the solution, and introduced additional constraints to remove ambiguity. In [9] Xiao et al. proposed a rank deficient basis. Other extensions of the work by Bregler et al. include [10] which improved the numerical stability of the estimation process and [3] which introduced a Gaussian prior on the shape coefficients. Common to all of these approaches is that results are shown on objects which have a significant number of points that move rigidly, such as faces. Some approaches, such as [11] make explicit use of this fact to initialize rotation matrices, while others favor such sequences for stability in estimation.
 In contrast to this entire corpus of work, which approximate structure by a shape basis, we propose a new representation of time varying structure, as a collection of trajectories. We not only demonstrate that a compact trajectory space can be defined, but also that the basis of this trajectory space can be pre-defined, removing a large number of unknowns from the estimation process altogether. The duality of spatial and temporal representations has been hinted at earlier in literature. Shashua [12] discusses the duality of the joint image space and the joint point space in the context of multiview geometry. Zelnik-Manor and Irani [13] have exploited a similar duality for an alternate approach to Figure 2: As described in Equation 3, each trajectory is represented as a linear combination of k predefined segmenting video sequences. Ours is the first paper to use this dual representation in the structure from motion problem, and to note that a generic basis can be defined in trajectory space which compactly represents most real trajectories. The structure at a time instant t can be represented by arranging the 3D locations of the P points in a matrix S ( t )  X  R 3  X  P , The complete time varying structure can be represented by concatenating these instantaneous struc-tures as S 3 F  X  P = [ S (1) T S (2) T  X  X  X  S ( F ) T ] T . In [2], each instantaneous shape matrix S ( t ) is approximated as a linear combination of basis shapes, where S j  X  R 3  X  P is a basis shape and c j ( t ) is the coefficient of that basis shape. If the set of observed structures can be compactly expressed in terms of k such basis shapes, S has a rank of at most 3 k . This rank constraint can be restated by rearrangement of S as the following rank k matrix, The row space of this matrix corresponds to the shape space. Since the row and column space of a matrix are of equal dimension, it follows that the columns of S  X  are also spanned by k vectors. We call the column space of this matrix the trajectory space and note that it enjoys a dual relationship with the shape space. Specifically, if the time varying shape of an object can be expressed by a minimum of k shape basis, then there exist exactly k trajectory basis vectors that can represent the same time varying shape.
 To represent the time varying structure in terms of trajectory basis, we consider the structure [ X of the i th trajectory. As illustrated in Figure 2, we describe each trajectory as a linear combination of basis trajectory, sponding to that basis vector. The time varying structure matrix can then be factorized into an inverse and Here  X  i represents a truncated basis for transformation from coefficient space to original space. The principal benefit of the trajectory space representation is that a basis can be pre-defined that can compactly approximate most real trajectories. A number of bases such as the Hadamard Transform basis, the Discrete Fourier Transform basis, and the Discrete Wavelet Transform basis can all com-pactly represent trajectories in an object independent way. In this paper, we use the Discrete Cosine Transform basis set to generate  X  (shown in Figure 2) for all reconstructions results shown. The efficacy of the DCT basis has been demonstrated for compressing motion capture data, [14], and has been effective in our experiments as well. The measured 2D trajectories are contained in a 2 F  X  P measurement matrix W , containing the location of P image points across F frames, This measurement matrix can be decomposed as W = R S where R is a 2 F  X  3 F matrix, and R t is a 2  X  3 orthographic projection matrix. In the previous section we showed that S =  X  A , as a result we can further factorize W as where  X  = R  X  . Since  X  is a 3 F  X  3 k matrix, the rank of matrix W will be at most 3 k . This is a dual property to the rank constraint defined by [2]. We can use SVD to factorize W as, In general, the matrix  X   X  and  X  A will not be equal to  X  and A respectively, because the above factor-ization is not unique. For any invertible 3 k  X  3 k matrix Q ,  X   X Q and Q  X  1 A are also valid factoriza-tions. Therefore, to recover metric structure we need to estimate the rectification matrix Q such that the following equations hold true, The problem of recovering the rotation and structure is reduced to estimating the rectification matrix Q . The elements of matrix  X  are, Instead of estimating the whole matrix Q , to rectify  X   X  and  X  A it is sufficient to estimate only three columns of Q . Let us define Q ||| to be the first, k +1 st and 2 k +1 st columns of the matrix Q . From Equation 6, if we just use Q ||| instead of Q , we get Figure 3: Effect of increasing camera motion on reconstruction stability. Reconstruction stability is measured in terms of condition number of matrix  X  T  X  with different values of k and different values of F . Synthetic rotations were generated by revolving the camera around the z -axis and camera motion was measured in terms of the angle the camera moved per frame.
 This equation shows that the unknowns in matrix Q ||| can be found by exploiting the fact that R i is a truncated rotation matrix (as was done in [1]). Specifically, if  X   X  2 i  X  1:2 i denotes the two rows of matrix  X   X  at positions 2 i  X  1 and 2 i , then we have where I 2  X  2 is an identity matrix, giving three indepedent constraints for each image i . Therefore for F frames, we have 3 F constraints and 9 k unknowns in Q ||| . Hence at least 3 k non-degenerate images are required to estimate Q ||| . Once Q ||| has been computed, using a nonlinear minimization routine (e.g. Levenberg Marquardt), we can estimate the rotation matrices, and therefore R , using Equation 7.
 Once R is known, it can be multiplied with the (known) DCT basis matrix  X  3 F  X  3 k to recover the matrix  X  2 F  X  3 k = R 2 F  X  3 F  X  3 F  X  3 k . The coefficients can then be estimated by solving the following overconstrained linear system of equations, The proposed algorithm has been validated quantitatively on motion capture data over different actions and qualitatively on video data. We have tested the approach extensively on highly nonrigid human motion like volleyball digs, handstands, karate moves and dancing. Figure 4 shows a few sample reconstructions of different actors. As mentioned earlier, we choose DCT as the basis for the trajectory space. In subsequent experiments, we compare our approach with [5] and [9] (we use code kindly provided by the respective authors). The results, data and the code used to produce the results are all shared at http://cvlab.lums.edu.pk/nrsfm .
 In nonrigid structure from motion, the key relationship that determines successful reconstruction is the one between the degree of deformation of the object, measured by the number of basis k required to approximate it and the degree of camera motion. To test the relationship between k , camera motion and reconstruction stability, we constructed  X  matrices using different values of k and synthetic rotations around the z -axis, at various magnitudes of motion per frame. In Figure 3, the reconstruction stability, measured by the condition number of  X  T  X  , is shown as k is varied between 2 and 6, for 200, 400, and 800 frames (at different angular velocities per frame). The plots confirm intuition: the smaller the degree of object deformation and the larger the camera motion, the more stable reconstruction tends to be.
 For quantitative evaluation of reconstruction accuracy we used the drink, pickup, yoga, stretch, and dance actions from the CMU Mocap database, and the shark dataset of [3]. Multiple rigid body data was generated by simulation of points on rigidly moving cubes. We generated synthetic camera rotations and projected 3D data using these rotations to get image observations. The camera rotation for the Mocap datasets was 5 degrees per frame and 2 degrees per frame for the multi-body Figure 5: The dance sequence from the CMU mocap database. The black dots are the ground truth points sequence. We did not rotate the camera for the dance and shark sequences, since the object itself was rotating in these sequences. In obtaining the results discussed below, k was chosen to provide the best reconstructions, the value varying between 2 and 13 depending on the length of the sequence and the nonrigidity of motion. We normalize the structure, so that the average standard deviation of the structure matrix S becomes equal to unity (to make comparison of error across datasets more meaningful).
 Table 1 shows a quantitative comparison of our method with the shape basis approach of Torresani et al. [5] and Xiao and Kanade [9]. This table shows both the camera rotation estimation error and structure reconstruction error. The estimated structure is valid up to a 3D rotation and translation and the estimated rotations also have a 3D rotation ambiguity. We therefore align them for error measurement. Procrustes analysis was used for aligning camera rotations and the 3D structure. The error measure for camera rotations was the average Frobenius norm difference between the original camera rotation and the estimated camera rotation. For structure evaluation we compute the per frame mean squared error between original 3D points and the estimated 3D points.
 Finally, to test the proposed approach on real data, we used a face sequence from the PIE dataset, a sequence from the movie  X  X he Matrix X , a sequence capturing two rigidly moving cubes and a sequence of a toy dinosaur moving nonrigidly. For the last three sequences, the image points were tracked in a semi-automatic manner, using the approach proposed in [15] with manual correction. We show the resulting reconstructions in Figure 6, and compare against the reconstructions obtained from Torresani et al. [5] and Xiao and Kanade [9].
 Table 1: The quantitative comparison of proposed algorithm with the techniques described in Xiao and Kanade We describe an algorithm to reconstruct nonrigid structure of an object from 2D trajectories of points across a video sequence. Unlike earlier approaches that require an object-specific shape basis to be estimated for each new video sequence, we demonstrate that a generic trajectory basis can be defined that can compactly represent the motion of a wide variety of real deformations. Results are shown using the DCT basis to recover structures of piece-wise rigid motion, facial expressions, actors dancing, walking, and doing yoga. Our experiments show that there is a relationship between camera motion, degree of object deformation, and reconstruction stability. We observe that as the motion of the camera increases with respect to the degree of deformation, the reconstruction stability increases. Future directions of research include experimenting with different unitary transform bases to verify that DCT basis are, in fact, the best generic basis to use, and developing a synergistic approach to use both shape and trajectory bases concurrently. This research was partially supported by a grant from the Higher Education Commission of Pakistan. The authors would like to acknowledge Fernando De La Torre for useful discussions. We further thank J. Xiao, L. Agapito, I. Matthews and L. Torresani for making their code or data available to us. The motion capture data used in this project was obtained from http://mocap.cs.cmu.edu . [1] C. Tomasi and T. Kanade. Shape and motion from image streams under orthography: A fac-[2] C. Bregler, A. Hertzmann, and H. Biermann. Recovering non-rigid 3D shape from image [3] L. Torresani, A. Hertzmann, and C. Bregler. Learning non-rigid 3D shape from 2D motion. [4] J. Xiao, J. Chai, and T. Kanade. A closed form solution to non-rigid shape and motion recovery. [5] L. Torresani, A. Hertzmann, and C. Bregler. Nonrigid structure-from motion: Estimating shape [6] J.P. Costeira and T. Kanade. A multibody factorization method for independently moving [7] M. Han and T. Kanade. Reconstruction of a scene with multiple linearly moving objects. IJCV , [8] A. Gruber and Y. Weiss. Multibody factorization with uncertainity and missing data using the [9] J. Xiao and T. Kanade. Non-rigid shape and motion recovery: Degenerate deformations. [10] M. Brand. Morphable 3D models from video. CVPR , 2:456, 2001. [11] A. Del Bue, F.Smeraldi, and L. Agapito. Non-rigid structure from motion using ranklet-based [12] Amnon Shashua. Trilinear tensor: The fundamental construct of multiple-view geometry and [13] Lihi Zelnik-Manor and Michal Irani. Temporal factorization vs. spatial factorization. ECCV , [14] O. Arikan. Compression of motion capture databases. ACM Trans. on Graphics , 2006. [15] A. Datta, Y. Sheikh, and T. Kanade. Linear motion estimation for systems of articulated planes.
