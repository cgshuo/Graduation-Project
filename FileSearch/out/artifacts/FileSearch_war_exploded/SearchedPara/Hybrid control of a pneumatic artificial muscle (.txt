 1. Introduction muscle (PAM), is becoming increasingly popular for used in precision robotic tasks as well as in human exoskeleton technol-ogies intendedto enhancestrength and mobility.PAMpossesses all the advantages of traditional pneumatic actuator (i.e., low cost and light weight) along with high power/weight and power/volume ratios ( Chou and Hannaford, 1994a ). This is an advantage for robotic and exoskeleton applications in which heavy actuators can add significantly to the payload ( Chou and Hannaford, 1994b;
Tsagarakis and Darwin, 2000; Caldwell et al., 1995; Cocatre-Zilgien et al., 1996; Pack et al., 1997; Ahn and Anh, 2006; Ahn and Thanh, 2006 ).
 actuators in general, is the problem of precise control. This problem occurs because pneumatic actuato rs are highly nonlinear and their properties vary with time. Since rubber tube and plastic sheath componentsarecontinuallyincontactwitheachotheranditsshapeis continually changing, the PAM X  X  temperature fluctuates and changes the properties of the actuator over time. Approaches to PAM control have included PID control, adaptive control ( Lilly, 2003 ), nonlinear optimal predictive control ( Reynolds et al., 2003 ), variable struc-ture control ( Repperger et al., 1998; Medrano-Cerda et al., 1995 ), gainscheduling( Reppergeretal.,1999 ),andvarioussoftcomputing approaches including neural network Kohonen training algorithm control ( Hesselroth et al., 1994 ), neural network+nonlinear PID controller ( Ahn and Thanh, 2005 ), and neuro-fuzzy/genetic control ( Chan et al., 2003; Chang and Lilly, 2003 ).
 meters, PAM robot arms present a challenging nonlinear model problem. Previous studies have used a number of approaches to model PAM actuators. Balasubramanian and Rattan (2003a) applied the fuzzy model to identify the dynamic characteristics of PAM and later applied the nonlinear fuzzy model to model and to control of the PAM system ( Balasubramanian and Rattan, 2003 b). Lilly (2003) presented a direct continuous-time adaptive control technique and applied it to control joint angle in a single-joint arm. Tsagarakis and
Darwin (2000) developed an improved model for PAM. The dis-advantage of these PAM manipulator models lies in their mathe-matical approaches, which are too complex to apply in practice.
Hesselrothet al. (1994) presented a neural networkthat controlled a five-link robot using back propagation to learn the correct control over a period of time. Repperger et al. (1999) applied a gain scheduling model-based controller to a single vertically hanging
PAM. Chan et al. (2003) and Chang and Lilly, (2003) introduced a fuzzy P+ID controller and an evolutionary fuzzy controller, respec-tively, for the PAM system. The novel feature is a new method of identifyingfuzzymodelsfromexperimental datausingevolutionary techniques. Unfortunately, these fuzzy models are clumsy and have only been tested insimulation studies. Previously, we ( Ahn and Anh, 2006 ) applied a modified genetic algorithm (MGA) for optimizing the parameters ofa linear ARX model ofthe PAM manipulator which can be modified online with an adaptive self-tuning control algo-rithm, and then ( Ahn and Anh, 2007 ) successfully applied recurrent neural networks (RNN) for optimizing the parameters of neural NARX model of the PAM robot arm. Recently, we ( Ahn and Anh, 2009 )successfullyappliedthemodifiedgeneticalgorithm(MGA)for optimizing the parameters of the NARX fuzzy model of the PAM robot arm.

The implementation of a simple but efficient model for the one-link PAM robot arm that can not only be utilized efficiently for modeling, identification and simulation but also can be applied efficiently to the control of highly nonlinear systems like the PAM robotarmremainsachallengingproblem.Conventionally,thefuzzy models based on expert human knowledge of the system were used for such problems and often involved heuristic trial and error approach. Recently, research has been conducted to tune fuzzy models using real data ( Nelles, 2000 ). Real data would make it possible todevelop a good fuzzymodel of a system while restricting the complexity of the model. For the purposes of nonlinear system control, a fuzzy model obtained from the experimental input X  output training data set is required for prediction, simulation, optimization and control of an unknown system plant.
 In this paper we describe the modeling and identification of a PAM robot arm actuated by a group of antagonistic PAM pairs. We suggestamodifiedgeneticalgorithm(MGA)forthegeneration ofan inverse NARX fuzzy model (INFM) based on the experimental input X  X utput data obtained from a PAM robot arm system. In this way, the proposed MGA algorithm optimally generates appropriate fuzzy if-then rules to characterize the dynamic features of the PAM robot arm. Theproposed INFM model identification approach based on the MGA method is successfully applied to control not only the PAM robot arm system but also other dynamic nonlinear processes.
Theuniquecontributionsofthispa per include the fact that for the first time, the modeling and ident ification of the proposed inverse NARXfuzzymodelofthePAMrobotarmarerealized;theoptimization of the inverse NARX fuzzy model X  X  parameters of the PAM robot arm is completed using an MGA; an efficient inverse NARX fuzzy model is formulated in both first order NARX11 and second order NARX22 structures and shown to be suitable for the control of highly nonlinear PAM robot arm; and finally the good performance of the MGA-based inverseNARX fuzzymodelintheproposedhybridinverseNARXfuzzy-PID position control of the PAM robot arm is demonstrated.
The paper is arranged as follows. Section 1 is a literature review highlighting studies addressing the modeling and identification of PAM robot arms, and presents novel features of MGA-based identification using the inverse NARX fuzzy model investigated in this paper. Section 2 introduces the proposed modified genetic algorithm (MGA) used for PAM robot arm modeling and identifica-tion. Section 3 presents the INFM model. Section 4 presents the hardware configuration of the PAM robot arm and introduces the proposed hybrid inverse NARX fuzzy-PID control of the PAM robot arm. Section 5 presents and analyzes the results of MGA-based modeling and identification of the inverse NARX fuzzy model and assesses its performance in the proposed hybrid inverse NARX fuzzy-PID control scheme. Section 6 concludes the paper. 2. Modifiedgenetic algorithm(MGA)foridentifying theinverse NARX fuzzy model
Classic genetic algorithm (GA) involves three basic operations: reproduction, crossover and mutation. To derive a solution to a near optimal problem, GA creates sequences of populations that correspond to the numerical values of a particular variable. Each individual, namely a chromosome, in a population represents a potentialsolutiontotheprobleminquestion.Selectionistheprocess by which chromosomes in a population that contain better fitness value have a greater probability of reproducing. In this paper, we used a roulette-wheel selection scheme. Through selection, chro-mosomes encoded with better fitness values are chosen for recom-bination to yield off-springs for successive generations. Then the natural evolution (including crossover and mutation) of the popula-tion willbecontinueduntil adesiredterminationorerrorcriterionis achieved. This results in a final generation containing highly fit chromosomes representing optimal solutions to the searching problems. Fig. 1 describes the procedure of GA optimization. 2.1. Modifications to the conventional genetic algorithm In recent years, considerable research has focused on improving GA performance ( Chen and Chen, 2000; Potts et al., 1994; Back and Hoffmeister, 2001 ). Inappropriate choices of operators and para-meters used in the GA process make GAs susceptible to premature convergence. In this paper, an attempt is made to simultaneously applythe proposedimprovedstrategies toovercomesuch problems. 2.1.1. Extinction strategy
Because of the properties of global optimization and the fast convergence of the GA process, after a certain number of genera-tions, the searching process thus tends to stagnate and the final result may be trapped into a localoptimum. Theonly mechanism of the conventional GA that generates better chromosomes is muta-tion. Unfortunately, slow mutation rates must be chosen to yield a stable process. These slow rates lead to very small increases in fitness values especially for long chromosomes. This paper intro-duces a novel technique called the extinction strategy to overcome this problem. On the basis of this concept, if no further increases in the fitness value are detected; i.e., a variance equal to zero, the best q % of chromosomes survive every L e generation according to their better fitness values. The others are randomly generated to fill out the population. The surviving chromosomes are allowed to mate as usual to form the next generation. 2.1.2. Elitist strategy
When creating a new population by crossover and mutation,the best chromosomes may be lost. The elitist strategy guarantees the survival of the best individual in a generation. Thus, this strategy ensures the continuous increase of maximum fitness values from generation to generation. Practically, this strategy can be imple-mented by replacing the worst chromosome in the next generation with the best chromosome of the previous generation. Conse-quently, elitism can rapidly increase the performance of the GA. 2.1.3. G-bit strategy
A single bit mutation of a chromosome can be thought of as a local search in an area surrounding that chromosome within a multi-dimensional space. When the population converges prema-turely to a local optimum, a single bit mutation may be required to relocate to a new region. A high mutation rate proves helpful in this situation,but it may alsotend to transformthe geneticsearch intoa randomsearch. To solve this problem,thispaper will apply an extra operation, called the G-bit operation, to the GA process. Back and Hoffmeister (2001) introduced G-bit improvement as a simply change of a single bit value from 0 to 1 or vice versa if the fitness of this modified string is better than that of the original string. Otherwise the original string remains unchanged. This test is executed repeatedly from the first bit to the last bit of a string.
Furthermore, in order to save computing time, the G-bit improve-ment is only applied to the best individual in a generation. strategies. The elitist strategy and G-bit operation ensures a steady increase of the maximum fitness value. The extinction strategy prevents the searching process fro m being trapped in a local optimum.
Consequently, the overall efficiency and the searching process of the optimum solution are improved by these modifications. 2.2. Modified genetic algorithm (MGA) for optimizing inverse NARX fuzzy model X  X  parameters y  X  k  X  X  f  X  W , Y , U  X  X  1  X  where f () is a nonlinear function such that (1) is stable; W  X  [ w w 2 , y , w h ] is a set of h fixed parameters; Y  X  [ y ( k 1), set of n autoregressive output terms and U  X  [ u ( k 1), y a set of m past input values.

Eq. (1) can be estimated as ^ y  X  k  X  X  f  X  ^ W , Y , U  X  X  2  X  the estimated output.
 gene. All genes are cascaded to form a longer string ^ W called a chromosome. This MGA-based identification strategy is used to search for the best chromosome ^ W so that ^ y  X  k  X  -y  X  k  X  from the Yes Yes testing input X  X utput data range. Each generation will explore a collection of N chromosomes of estimated parameters.

Consider the fitness value F j associated with the j th chromo-some in a population that is defined as F  X  10 4 in which k is the discrete time index in the identification process; M is the window size through which errors will be accumulated and ^ y  X  k  X  isthe estimated k th outputthat belongs tothe j thchromosome of the estimated parameters. In each generation, the MGA will search for the maximum fitness value over the entire space of parameters. Experimentally, the larger the M value is when modified, the slower the execution of the MGA becomes. Unfortu-nately, a small M value tends to cause the estimation to oscillate. Consequently, a trade-off should be considered when choosing an available M value.

Before running the MGA algorithm, it needs to tune the following parameters: P c crossover rate used in the crossover operation P m mutation rate used in the mutation operation D number of chromosomes chosen for mating as parents N number of chromosomes in each generation L t number of generations tolerated for no improvement on L e number of generations tolerated for no improvement on r portion of the chosen parents permitted to survive into q percentage of chromosomes survived according to their
The steps of the MGA-based model identification procedure are summarized as follows:
Step 1: tune the parameters as described above. Encode the estimated parameters into genes and chromosomes as a string of binary digits. Considering that the parameters lie in several bounded regions Z k : 9 w k 9 r Z k for k  X  1 , ... , h :  X  4  X  The length of the chromosome needed to encode W k is based on and the desired accuracy d k . Set i  X  k  X  m  X  0.

Step 2: Randomly generate randomly the initial generation of N chromosomes. Set i  X  i +1.

Step 3:Decodethechromosomesthencalculatethefitnessvalue for every chromosome of the population in the generation. Con-sider F i max as the maximum fitness value in the i th generation.
Step 4: Apply the elitist strategies to guarantee the survival of the best chromosome in each generation. Then apply the G-bit strategy to this chromosome to improve the efficiency of the MGA in local search.

Step 5: Combine the basic sub-steps of the conventional GA optimization: (1) Reproduction : In this paper, reproduction is set as a linear (2) Crossover : Choose D chromosomes possessing maximum fit-(3) Mutation : Mutate a bit of the string (0 2 1) with the mutation m  X  0.

Step 7: If k  X  L e , then apply the extinction strategy and then set k  X  0.

Step 8: If m  X  L t , then terminate the MGA algorithm; otherwise go to Step 3 to run the ( i +1)th generation.

The flow chart of the proposed MGA-based optimization and identification process of the PAM manipulator fuzzy model is given in Fig. 2 .

The presentresearchhasmultiplegoals. Firstthe proposed MGA will be applied to identify the PAM robot arm inverse NARX fuzzy model. Second we will compare the performance results of the proposed MGA-based inverse NARX11 fuzzy model with the proposed MGA-based inverse NARX22 fuzzy models. Finally we evaluate the performance of the proposed MGA-based inverse NARX fuzzy model in a hybrid inverse NARX fuzzy-PID position control scheme applied to a highly nonlinear PAM robot arm. 3. Design and implementation of the MGA-based inverse NARX fuzzy model 3.1. Assumptions and constraints
As the PAM robot arm system is operated nearly symmetrically, it is assumed that the symmetrical membership functions about the y -axiswillprovideavalidfuzzymodel.Asymmetricalrule-base is also assumed. The following constraints are introduced to the design of the inverse NARX fuzzy Model (INFM). First, all universes of discourses are normalized to lie between 1 and 1 with scaling factors external to the INFM used to give appropriate values to the input and output variables. Second, it is assumed that the first and last membership functions have their apexes at 1 and 1, respectively, and that only triangular membership functions are to be used. Third, the number of fuzzy sets is constrained to be an odd integer greater thanunity. Finally,the base vertices of the member-ship functions are coincident with the apex of the adjacent membership functions. This ensures the value of any input variable is a member of at most two fuzzy sets. 3.2. Spacing parameter
The spacing parameter specifies how the centers are spaced out across the universe of discourse. This method of designing the membership functions is inspired by previous studies ( Park et al., 1995; Cheong and Lai, 2000 ). A value of one indicates even spacing, while a value smaller than unity indicates that the membership functions are more spaced out in the center of the range and closer together at the extremes as shown in Fig. 3 . The position of each center is calculated by taking the position where the center would be if the spacing were even and raising this to the power of the spacing parameter. Fig. 3 presents the triangle input membership function with MF X  X   X  7 and a spacing factor  X  2. 3.3. Designing the rule-base
As well as specifying the membership functions, the rule-base mustalsobe designed.Tospecifyarule-base,characteristicspacing parameters for each variable and a characteristic angle for each output variable are used.
 the rule-base are that extreme outputs usually occur when the inputs have extreme values while mid-range outputs are generated when the input values are mid-range and similar combinations of input linguistic values lead to similar output values. Using these assumptions the output space is partitioned into different regions corresponding to different output linguistic values. The space partitioning is determined by the characteristic spacing parameters and the characteristic angles. The angles determine the slope of line through the origin on which seed points are placed. The positioning Roulette wheel Reproduction Random Chosen Two Random value &gt; Crossover rate P C ? Random value &gt; Mutation rate P M ? No of the seed points is determined by a spacing method similar to the one used to determine the center of the membership function.
Grid points representing each possible combination of the input linguistic values are also placed in the output space. These are spaced in the manner described above. The rule-base is determined by calculating which seed-point is closest to each grid point. The output linguistic value representing the seed-point is set as the consequent of the antecedent represented by the grid point. This is shownin Fig.4 a,whichisagraphshowingseedpoints(bluecircles) and grid points (red circles). Fig. 4 b shows the derived rule-base. The lines on the graph delineate the different regions correspond-ing to different consequents. The parameters for this example are 0.9 for both input spacing parameters, 1 for the output spacing parameter, and 45 1 for the angle theta-parameter. 3.4. Fuzzy inference system (FIS) implementation for the inverse NARX fuzzy model
To automatically implement the fuzzy inference system (FIS) structure for the proposed MGA-based INFM model, a necessary program is written in M -function that utilizes the fuzzy logic toolbox (FLT) for MATLAB to create the FIS. It, respectively, creates the membership functions and the rule-base and then creates the FIS from both of them.

First, error checking is performed to ensure that the parameters chosen by the MGA are valid. Secondly, the input/output para-meters of the INFM model are called to create the membership functions of each of the input/output variables. Then creating a rule-matrix in the format required by the FLT creates a suitable rule-basefor each of the outputvariablesand puts them togetherin a suitable way to create the FIS. In this paper, only triangular membership functions (MF) are used. From two parameters, namely, the number of MF and the spacing parameters, the centers of each membership function are calculated. As the base vertices are at the same positions as the centers of the adjacent MFs, the calculating task of the full set of input X  X utput MF parameters is then completed.

The next step of the FIS implementation is to create the rule-base. This step returns a rule-base based on the parameters that are passed in. These parameters are composed of a number of MFs per variable, spacing parameters for each variable and characteristic angles for the seed lines. First,the coordinates of the seed pointsare calculated and then the grid-point coordinates are calculated. The consequents for each rule are then generated for each grid-point by measuring the distance to each seed-point and finding the shortest one. The antecedents and consequents are then returned in a matrix in the format required by the FLT.

With all of these, a full dynamic FIS can be generated using only a number of conformable parameters. This is ideal for applying the
MGA to find an optimal INFM as the MGA can work on these parameters and improve the performance of the INFM character-istics. How this is achieved is demonstrated in the next section. 3.5. Parameter encoding parameters need to be carefully decided. For this task the para-meters given in Table 1 are used with the shown ranges and precisions. Binary encoding is used as necessary to allow the MGA to more flexibly search for the solution space. The numbers of the membership functions are limited to the odd integers inclusive between 3 and 5 in the case MGA-based PAM robot arm INFM model design. Experimentally, this was considered a reasonable constraint. The advantage of using this constraint is that this parameter can be captured in just one bit per variable.
The first, within the range (0.1 X 1), determines the magnitude, and the second, which takes only the values 1 or 1, is the power by which the magnitude is raised. This determines whether the membership functions compress in the center or at the extremes. Consequently, each spacing parameter obtains the range (0.1 X 10).
The precision required for the magnitude is 0.01, meaning that eight total bits are used for each spacing parameter.
 range (0 X 100) while that of the output variable is given the range (0 X 1000). These values were identified after a few trials of the MGA used wider ranges, as the values returned were found to lie within these ranges. For this encoding scheme the total number of bits per chromosome are 105, 102 and up to 175 in the case of the MGA-based PAM robot arm inverse TS fuzzy model, the inverse
NARX11 fuzzy model, and the inverse NARX22 fuzzy model, res-pectively. This means that there are 2 102 or approximately 5 10 potential solutions, an unknown but likely very small fraction of which represents a desirable INFM model that would be discovered by the proposed MGA. Based on the experiment results, the proposed MGA succeeds in finding close to optimal solutions in large spaces despite having no prior knowledge. This demonstrates the power of proposed MGA. 3.6. Nonlinear inverse NARX fuzzy models for PAM robot arm. paper is improved by combining the extraordinary predictive and adaptivefeaturesoftheNARXmodelstructure.Theresultingmodel established a nonlinear relationship between the past inputs and outputs and the predicted output, where the system X  X  prediction output is a combination of the system output produced by real inputs and the system X  X  historical behaviors. It can be expressed as ^ y  X  k  X  X  f  X  y  X  k 1  X  , ::: , y  X  k n a  X  , u  X  k n d  X  , ::: , u  X  k n and input terms, respectively, n d is the discrete dead time, and f represents the mapping of the fuzzy model.
 fact that this NARX fuzzy model interpolates between local linear, time-invariant (LTI) ARX models as follows: ^ y  X  k  X  X  where the element of the z ( k ) X  X  scheduling vector  X  X  are usually a subset of the x ( k ) regressors that contain the variables relevant to the nonlinear behaviors of the system,
Z  X  k  X  A f y  X  k 1  X  , ::: , y  X  k n a  X  , u  X  k n d  X  , ::: , u  X  k n while the f j ( q ( k )) consequent function contains all the regressor q ( k )  X  [ X ( k ) 1], f j  X  q  X  k  X  X  X  (the singleton or the Sugeno fuzzy model which is not applied in this paper) is formulated by the simple rules consequents as ^ y  X  k  X  X  c j  X  9  X  where z ( k ) contains all inputs of the NARX model:
Z  X  k  X  X  X  X  k  X  X f y  X  k 1  X  , ::: , y  X  k n a  X  , u  X  k n fuzzy TS model method is that the output from the TS fuzzy model islinear andconstant, and the outputfrom NARXfuzzy modelisthe
NARX function. However they have the same fuzzy inference structure (FIS).
 between the MGA-based PAM robot arm inverse TS fuzzy model identification and the MGA-based PAM robot arm INFM design. improvement from the MGA-based PAM robot arm inverse
NARX11 fuzzy model identification to the MGA-based PAM robot arm inverse NARX22 fuzzy model identification. All such block diagrams will be studied thoroughly in this paper. 4. Control system and hardware configuration setup 4.1. Hybrid feed-forward inverse NARX fuzzy model-PID control scheme schemeisshownin Fig.6 .Sincethecombinationofthefeedforward control and the feedback PID control in a closed-oop system is an efficient technique and has been proven to be more stable, more robustandmoreaccuratethannon-hybridschemes( Boerlageetal., 2003 ), this hybrid scheme is used in this paper. In a feed-forward controller design, the proposed INFM of the PAM robot arm is designed offline to approximate as closely as possible the dynamic and nonlinear features of the PAM robot arm. This INFM is then incorporated in parallel with the closed-loop feedback PID con-troller to increase the accuracy and to ameliorate the performance of the joint position control of the PAM system. The block diagram of the proposed hybrid inverse NARX fuzzy-PID controller is shown in Fig. 6 .
 robot arm X  X  inverse characteristics and to use the INFM to generate the compensated control signal U FUZZY . The main equation of the proposed control algorithm is given by U  X  U PID  X  U FUZZY  X  11  X  where U is the required control voltage, U PID is the control voltage generated by the PID controller and U FUZZY is the control voltage generated by the INFM. The INFM obtains the dynamicinverse PAM manipulator model. The error e ( k ) creates the compensating value U PID through the PID controller while the proposed hybrid inverse NARX fuzzy-PID control is in operation. This occurs to compensate for modeling errors and unmodeled disturbances. Similarly, the parallel-connected conventional PID controller also contributes to a faster and more accurate tracking performance. 4.2. Experimental setup
The prototype PAM robot arm used in this paper has two axes, is closed loop activated with two antagonistic PAM pairs, and is pneumatically driven controlled through two proportional valves shown in Fig. 7 . Each of the two axes provides a different motion Inverse NARX22 Fuzzy Model PAM U(k) Y(k) U(k) and contributes one degree of freedom link of the PAM robot arm (see Fig. 8 ).
 proposed control algorithm is applied to control the joint angle position of the second joint of the PAM robot arm.
 proportional valve manufactured by FESTO Corporation. An angle encoder sensor is used to measure the output angle of the joint. The entire system is a closed loop system operated through a computer. pressure at P 0 (initial pressure) to render the joint initial status. By changing the input u ( t ) from the D / A converter, it could set the air pressures of the two artificial muscles at ( P 0 + D P ) and ( P respectively. As a result, the joint is forced to a certain angle and we can then measure the joint angle rotation through the rotary encoder and the counter.
 includes an IBM compatible PC (Pentium 1.7 GHz) that sends the control voltage signal u ( t ) to control the proportional valve (FESTO,
MPYE-5-1/8HF-710B) through a D / A board (ADVANTECH, PCI 1720 card) that changes the digital signal from the PC to analog voltage u ( t ). The torque is generated by the contraction and the dilation of the antagonistic artificial muscles. Consequently, the second joint of the PAM manipulator is rotated. The joint angle, y (deg), is detected by a rotary encoder (METRONIX, H40-8-3600ZO) with a resolution of 0.1 1 and fed back to the computer through a 32-bit counter board (COMPUTING MEASUREMENT, PCI QUAD-4 card), which changes digital pulse signals to a joint angle value y ( t ).
The external inertia load could be tested with two different loads (0.5 and 2 kg). The experiments are conducted under the pressure of 4[bar] and all control software is coded in MATLAB-SIMULINK with the C-mex S-function. 5. Experimental results 5.1. Results of the MGA-based INFM identification of the PAM robot arm essential procedure consists of four basic steps as shown in Fig. 2 .The first step obtains the experimental datathat describes the underlying intrinsic features of the PAM robot arm. Fig. 10 presents the testing input applied to the tested PAM robot arm and the responding joint angle output collected from it. This experimental input X  X utput data is used for training and validating the proposed INFM. and output from the corresponding PAM robot arm joint angle are used for estimating, while the PRBS input during the consecutive 40 s along with the output from the corresponding PAM robot arm joint angle will be used to validate the derived model ( Fig. 10 ). the proposed MGA-based PAM robot arm inverse NARX11 fuzzy model and the inverse NARX22 fuzzy model.
 input X  X utput data values measured from the PAM robot arm is shown in Fig. 5 . Table 1 contains the fuzzy model parameters used for encoding the optimized input values of the MGA-based optimi-zation algorithm. The range (3 X 5) corresponds to the number of membership functions permitting two different odd values that would be chosen by the MGA (3 and 5).
 lies in the exploitation of two input variables Y ( z ) and U ( z 1) instead of Y ( z ) and Ydot ( z ) which are used in the conventional TS
Fuzzy model. Similarly, the proposed inverse NARX22 fuzzy model is composed of four input variables Y ( z ) ,Y ( z 1), U ( z 1) and
U ( z 2). This novel structure combines the extraordinary approx-imating ability of the fuzzy system with the powerful predictive potentiality of the recurrent NARX structure realized in the inverse NARX11 and inverse NARX22 fuzzy models.
 MGA shown in Eq. (3) is shown in Fig. 11 in the case of the inverse NARX11 fuzzy model and in Fig. 13 in the case of the inverse
NARX22 fuzzy model (with population  X  20, P c  X  0.5, P M  X  0.1 and generation  X  100). Both figures show that the best fitness values obtained are 168,800 in the case of the inverse NARX11 fuzzy model and 186,042 in the case of the inverse NARX22 fuzzy model with high speed of convergence. The best fitness value is obtained at generation 92 with the inverse NARX11 fuzzy model and generation 68 with the inverse NARX22 fuzzy model. Furthermore, the powerful ability of MGA searching enhanced by the elitism strategy,extinctionstrategy,andG-bitmethod,leadstoaverygood fitness value ( 50,000 with the inverse NARX11 and 55,000 with the inverse NARX22 fuzzy model).
 Consequently, the resulting inverse NARX11 and inverse NARX22 fuzzy models cover most of nonlinear features of the PAM robot arm implied in the input signals U ( z 1) (v) and Y ( z ) (deg), and the output signal U ( z ) (v). The estimated results of the identified PAM robot arm inverse NARX11 and inverse NARX22 fuzzy models shown in Figs. 12 a, and 14 a, respectively, yield an excellent range of error ( o 7 0.3 V with the inverse NARX11 fuzzy model and o 7 0.15 V with the inverse NARX22 fuzzy model). Similarly, the validation results of the MGA-based identified PAM robot arm inverse NARX11 and inverse NARX22 fuzzy models shown in Figs. 12 b and 14 b, respectively, also show a good range of error ( o 7 0.3 V with the inverse NARX11 fuzzy model and o 7 0.15 V with the inverse NARX22 fuzzy model).
 These results assert the powerful potential of the proposed INFM not only for modeling and identification but also for control.
Figs. 12 c and 14 c show the shapes of the input and output membership functions and the rule-base surf-view of the proposed inverse NARX11 and inverse NARX22 fuzzy models, respectively. These two figures show that although the MGA-based NARX11 fuzzy model only requires a modest FIS structure with the MF of two inputs U ( z 1) (v) and Y ( z ) (deg) and the output U ( z ) (V) only equal to [5, 5, 5], the shape of the surf-viewer of the proposed inverse NARX11 fuzzy model (shown in Fig. 12 c) is sophisticated because the inverse NARX11 fuzzy model is capable of learning all of the dynamic features of the PAM robot arm. Similarly, Fig. 14 c shows that although the MGA-based inverse NARX22 fuzzy model requires only a simple FIS structure with a membership function surf-viewer of the MGA-based inverse NARX22 fuzzy model (shown in Fig. 14 d) is sophisticated and is implied on three principal surf-viewers among the total six, which confirms that it is possible for the proposed inverse NARX22 fuzzy model to learn all of the nonlinear features of the PAM robot arm contained in the input and output training signals.
 the nonlinear dynamic features of the PAM robot arm because the predictivecapabilityoftherecurrentfirstorderNARXstructureand of the recurrent second order NARX structure permit both to thorough learn all of the highly nonlinear and dynamic features of the PAM robot arm. Generation
Finally, the convergence of the principal parameters of the proposed PAM robot arm inverse NARX11 and inverse NARX22 fuzzy models (including the convergence of the number of input and output membership functions; the convergence of the theta-parameter of the rule-base; the convergence of the scaling gain of the input X  X utput variables; the convergence of the spacing parameter determiningthe shape of the input X  X utputmembership functions; and the convergence of the spacing parameter deter-mining the structure of the rule-base of the input-antecedents and output-consequent) identified and optimized by the MGA are shown in Figs. 12 d and 14 e, respectively. From the theta-angle parameter and the spacing parameter of the input X  X utput rule-base identified by the MGA, the derived resulting rule-base of the desired inverse NARX11 fuzzy model is shown in Table 2 .Itis composed of 25 rules from two input variables ( Y ( z ) (deg) and U ( z 1) (V)) that both possessed MF numbers of 5.

Section 5.2 will experimentally prove the good performance of the novel INFM not only in modeling and identification but also in control. The novel INFM will be applied in the proposed hybrid inverse NARX fuzzy-PID control scheme. 5.2. Experimental results of the PAM robot arm hybrid inverse NARX fuzzy-PID position control
The second joint of the PAM robot arm is considered as a case study to apply this control technique. The performance of the novel proposed hybrid inverse NARX fuzzy-PID controlscheme is verified on the position joint angle control of the second joint of the PAM robot arm. Fig. 8 describes the working diagram of this control scheme.

The proposed hybrid inverse NARX11 fuzzy-PID control algo-rithm runs in real-time windows target (RWT) platform of the MATLAB-SIMULINK environment with the inverse NARX11 fuzzy model being an MGA-based optimized fuzzy inference system (FIS) structure as described in Figs. 13 and 14 . The PID controller is implemented in parallel with the inverse NARX fuzzy to compen-sate and keep the PAM system stable during starting time. Three PID parameters are chosen by trial and error method and are determined as K P  X  0.09, K I  X  0.089, and K D  X  0.02.
The final purpose of the PAM robot arm is to be used as an elbow and wrist rehabilitation robot device. Thus, the experiments were carried out with respect to three different waveforms as reference inputs (triangular, trapezoidal and sinusoidal reference) with two different end-point payloads (load 0.5 kg and load 2 kg) to demon-strate the performance of the novel proposed hybrid inverse NARX fuzzy-PID controller. Furthermore, comparisons of the control performance were performed between the conventional PID and the two different methods of the proposed hybrid inverse NARX fuzzy-PID controller.

These two novel proposed methods were composed of the proposed hybrid inverse NARX11 fuzzy-PID and proposed hybrid inverse NARX22 fuzzy-PID. The first method possesses the non-linear first order NARX model in the MGA-based inverse NARX11 fuzzy model and the second method corresponds to the nonlinear second order NARX model implied in the MGA-based inverse NARX22 fuzzy model.

The initial value K and the PID controller parameters K p K were set to be K  X  0.6, K p  X  0.089, K i  X  0.09, and K d  X  0.02. These PID controller parameters were obtained by trial and error through experiment.

First, the experiments were carried out to verify the effective-ness of the proposed hybrid inverse NARX fuzzy-PID controller with the triangular reference input. Fig. 15 a compares the experi-mental results between the conventional PID controller and the proposed hybrid inverse NARX fuzzy-PID controller in the two cases of load 0.5 kg and load 2 kg, respectively.

This figure shows that due to the good dynamic approximation of the INFM which adapts well to the payload variation and nonlinear disturbances of the PAM system in its operation , the error between the desired reference y REF and the actual joint angle response y of the PAM manipulator were optimized. Consequently, the minimized error is obtained only in the range 7 0.8 1 the proposed hybrid inverse NARX11 fuzzy-PID and the hybrid inverse NARX22 fuzzy-PID in the case of load 0.5 kg. The same good result is obtained with both of the proposed control scheme in the case of load 2 kg. These results are very impressive in comparison withthebaderroroftheconventionalPIDcontroller( 7 2.5 1 inboth of case).

The comparison between the proposed hybrid inverse NARX11 fuzzy-PID and hybrid inverse NARX22 fuzzy-PID showed that both of the proposed control algorithms obtain the good robustness and accuracy as well and thus are considered to obtain the performance equivalent.

Fig. 15 b shows the resulted shape of the control voltage U applied to the joint of the PAM robot arm, which is generated by the proposed Hybrid Inverse NARX Fuzzy-PID controller to assure the performance and accuracy of the PAM robot arm response. This control voltage U is composed of U PID and U FUZZY . The control voltage U PID is used to compensate the variation of the reference signal and of the two different payloads while U FUZZY is used to ameliorate the response accuracy and to keep the PAM system operation stable.

Next, the experiments were carried out to verify the effective-ness of the proposed Hybrid Inverse NARX Fuzzy-PID controller with the trapezoidal reference input. Fig. 16 a shows the experi-mental results comparison between the conventional PID con-troller and the two proposed hybrid inverse NARX11 fuzzy-PID and hybrid inverse NARX22 fuzzy-PID controllers in the two cases of load 0.5 kg and load 2 kg, respectively.

These resultsshowthatdue tothegood dynamicapproximation of the INFM which adapts well to the different payloads and nonlinear disturbances of the PAM system in its operation , the error between the desired reference y REF and the actual joint angle response y of the PAM robot arm were optimized. Consequently, the minimized error is obtained only in the range 7 0.7 1 oftheproposed controlschemeinthecaseofload0.5 kgandonlyin the range 7 0.6 1 with both of proposed control scheme in case of load 2 kg. These results are very superior in comparison with the disappointing error of the conventional PID controller ( 7 case of load 0.5 kg and up to 7 2.2 1 for the case of load 2 kg).
Fig. 16 b shows the resulted shape of the control voltage U applied to the joint of the PAM manipulator, which is generated by the proposed Hybrid Inverse NARX Fuzzy-PID controller to assure the performance and accuracy of the PAM manipulator response. This control voltage U is composed of U PID and U FUZZY . The control voltage U PID is used to compensate the variation of the reference signal and the different payloads while U FUZZY is used to ameliorate the response accuracy and to keep the PAM system operation stable. Similarly, the proposed hybrid inverse NARX fuzzy-PID controller assures to robustly control with the refined control voltage as to keep the PAM robot arm response stable and accurate tracking.

Finally, the experiments were carried out to verify the effective-ness of the proposed Hybrid Inverse NARX fuzzy-PID controller with the sinusoidal reference 0.05 Hz. Fig. 17 compares the experimental results between the conventional PID controller and the two proposed control scheme in the two cases of load 0.5 kg and load 2 kg, respectively.

These results show that due to the good approximation and robustness of the INFM, which adapts well to the different payloads and the disturbance variation of the PAM system in its operation , the error between the desired reference y REF and the actual joint angle response y of the PAM robot arm is optimi zed. As a result, the error is well minimized in the range 7 2 1 inthecaseofload0.5kg,inthe JOINT ANGLE OUTPUT [deg]
ERROR [deg] [V] -0.1 0.1 0.2 0.3 0.4 [V] 5 5.2 5.4 5.6 range 7 1.8 1 with the proposed hybrid inverse NARX11 fuzzy-PID and 7 1.4 1 withtheproposedhybridinverseNARX22fuzzy-PIDinthe case of load 2 kg. These results are very superior in comparison with thepassive erroroftheconventionalPIDcontroller( 7 4 1 inthecase of load 0.5 kg and up to 7 3.4 1 in the case of load 2 kg). fuzzy-PID and hybrid inverse NARX22 fuzzy-PID shows that the proposed hybrid inverse NARX22 fuzzy-PID obtains both of excel-lent robustness and good accuracy slightly better in comparison with the proposed hybrid inverse NARX11 fuzzy-PID and thus the proposed hybrid inverse NARX22 fuzzy-PID controller is consid-ered to possess the best performance. However, the proposed hybrid inverse NARX11 fuzzy-PID controller proves to have the advantage due to its simple fuzzy FIS structure.

MGA-based PAM robot arm INFM identification. Based on the fitness convergence as well as the related important parameters shownin Figs.11 and 12 for thenovelproposed MGA-basedInverse
NARX11 Fuzzy model identification, and Figs. 13 and 14 with good results in the case of the novel proposed MGA-based inverse NARX22 fuzzy model identification, it can be concluded that the
MGA-based inverse fuzzy model identification algorithm, which very poorly obtains the training performance is quite inferior in comparison with the novel proposed MGA-based INFM identifica-tion algorithm not only in the speed of convergence but also in performance. Furthermore, it is also shown that the proposed method had a good control performance for the highly nonlinear system, such as the PAM robot arm. The controller had an adaptive control capability when the control parameters were offline optimized via the modified genetic algorithm (MGA). The con-troller designed by this method only needs a training procedure in advance, but it uses only the input and output training data from the plant for the adaptation of the proposed INFM. From the experiments of the position control of the PAM robot arm, it was verifiedthattheproposedcontrolalgorithmpresentedinthispaper was precisely and robustly controlled with a simple structure and obtained a better dynamic property, good robustness and it was suitable for the control of various plants, including the linear and nonlinear processes, compared to the conventional PID controller. 6. Conclusions model using traditional methods, this paper shows that it is capable even without using any knowledge of the system except the experiment input X  X utput training data. The novel proposed MGA can build an effective INFM model obtaining superb features both in convergence speed and in improving performance. This novel pro-posed technique may leads to an inc rease in the use of the proposed
NARX fuzzy model, as the previously time-consuming design proce-dure can be reduced spectacularly, not only in modeling, simulation and identification of the highly nonlinear systems, but also in the online adaptive and predictive c ontrol of the dynamic nonlinear systems in general and the PAM robot arm in particular. Furthermore, the performance of the proposed hybrid inverse NARX fuzzy-PID controller was found to be very good and robust in the presence of intrinsic and external disturbances. This facilitates testing under different input conditions and ensures future applications of the PAM robot arm as a rehabilitation device for stroke patients. It determines confidently that the proposed hybrid inverse NARX fuzzy-PID con-troller not only proves its good performance in control of the highly nonlinear PAM robot arm but also is very efficient in the control of other real-time industrial and human-friendly applications. References
