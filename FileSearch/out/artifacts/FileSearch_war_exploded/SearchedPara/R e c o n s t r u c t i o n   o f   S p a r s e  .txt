 Understanding information processing in neural circ uits requires systematic characterization of synaptic connectivity [1, 2]. The most direct wa y to measure synapses between a pair of neurons is to stimulate potentially pre-synaptic ne uron while recording intra-cellularly from the potentially post-synaptic neuron [3-8]. This me thod can be scaled to reconstruct multiple synaptic connections onto one neuron by combining i ntracellular recordings from the post-synaptic neuron with photo-activation of pre-synapt ic neurons using glutamate uncaging [9-13] or channelrhodopsin [14, 15], or with multi-ele ctrode arrays [16, 17]. Neurons are sequentially stimulated to fire action potentials b y scanning a laser beam (or electrode voltage) over a brain slice, while synaptic weights are measured by recording post-synaptic voltage. Although sequential excitation of single potentiall y pre-synaptic neurons could reveal connectivity, such a  X  X rute force X  approach is inef ficient because the connectivity among neurons is sparse. Even among nearby neurons in the cerebral cortex, the probability of connection is only about ten percent [3-8]. Connect ion probability decays rapidly with the distance between neurons and falls below one percen t on the scale of a cortical column [3, 8]. Thus, most single-neuron stimulation trials wou ld result in zero response making the brute force approach slow, especially for larger ci rcuits. Another drawback of the brute force approach is tha t single-neuron stimulation cannot be combined efficiently with methods allowing parallel recording of neural activity, such as calcium imaging [18-22], voltage-sensitive dyes [23 -25] or multi-electrode arrays [17, 26]. As these techniques do not reliably measure sub-thr eshold potential but report only spiking activity, they would reveal only the strongest conn ections that can drive a neuron to fire [27-30]. Therefore, such combination would reveal only a small fraction of the circuit. We propose to circumvent the above limitations of t he brute force approach by stimulating multiple potentially pre-synaptic neurons simultane ously and reconstructing individual connections by using a recently developed method ca lled compressive sensing (CS) [31-35]. neurons and measure post-synaptic activity. Althoug h each measurement yields only a combined response to stimulated neurons, if synapti c inputs sum linearly in a post-synaptic neuron, one can reconstruct the weights of individu al connections by using an optimization pre-synaptic neurons make synaptic connections onto a post-synaptic neuron, the required number of trials M ~ K log (N/K) , which is much less than N [31-35]. The proposed method can be used even if only spikin g activity is available. Because multiple neuron, they can induce one or more spikes in that neuron. As quantized spike counts carry less information than analog sub-threshold voltage recordings, reconstruction requires a larger number of trials. Yet, the method can be use d to reconstruct a complete feedforward circuit from spike recordings. Reconstructing neural circuit with multi-neuronal e xcitation may be compared with mapping retinal ganglion cell receptive fields. Typically, photoreceptors are stimulated by white-noise checkerboard stimulus and the receptive field is ob tained by Reverse Correlation (RC) in case of sub-threshold measurements or Spike-Trigger ed Average (STA) of the stimulus [36, 37]. Although CS may use the same stimulation proto col, for a limited number of trials, the reconstruction quality is superior to RC or STA. We start by formalizing the problem of mapping syna ptic connections from a population of synapsing onto a Purkinje cell (Figure 1a). Our exp erimental protocol can be illustrated using linear algebra formalism, Figure 1b. We repre sent synaptic weights as components of a column vector x , where zeros represent non-existing connections. E ach row in the equal to the number of trials M . The column vector y represents M measurements of membrane voltage obtained by an intra-cellular reco rding from the post-synaptic neuron: In order to recover individual synaptic weights, Eq . (1) must be solved for x . RC (or STA) the corresponding expression x = A T (AA T ) -1 y is a solution to the following problem: Given prior knowledge that the connectivity is spar se, we propose to recover x by solving instead: where [25-29], this solution can be obtained by minimizin g the l 1 -norm: programming [38] or by iterative greedy algorithms [39, 40]. In this paper, we used a particularly efficient Compressive Sampling Matchin g Pursuit (CoSaMP) algorithm [41, 42]. We simulate the proposed reconstruction method in silico by generating a neural network, simulating experimental measurements, and recoverin g synaptic weights. We draw unitless synaptic weights from a distribution derived from e lectrophysiological measurements [4, 5, 43, 44] containing a delta-function at zero and an exponential distribution with a unit mean entries in each row to one, and the rest to zero. W e compute the measurement vector y by multiplying A and x . Then, we use the CoSaMP algorithm to recover syna ptic weights, x r , from A and y . Figure 2b compares a typical result of such recon struction and a result of RC with originally generated non-zero synaptic weights x . Despite using fewer measurements than required in the brute force approach, CS achie ves perfect reconstruction while RC yields a worse result [45]. (a) (b) Figure 1: Mapping synapses onto one neuron. a) A po tentially post-synaptic neuron (red) receives synaptic connection (blue) from K neurons out of N potentially pre-synaptic neurons. b) Linear algebra representation of the ex perimental protocol. The column vector x contains synaptic weights from N potentially pre-synaptic neurons: K blue squares represent existing connections, white squares represent absen t connections. The matrix A represents the sequence of stimulation: black squares in each row represent stimulated neurons in each trial. The column vector y contains measured membrane voltage in the red neur on. Figure 2: Reconstruction of synaptic weights onto o ne neuron. a) Synaptic weights are drawn from the empirically motivated probability distribu tion. b) Reconstruction by CS (red) coincides perfectly with generated synaptic weights (blue), achieving 60% improvement in the number of trials over the brute force approach. RC result (green) is significantly worse. In order to understand intuitively why the number o f trials can be less than the number of potential synapses, note that the minimum number of trials, i.e. information or entropy, is given by the logarithm of the total number of possi ble connectivity patterns. If connections are binary, the number of different connectivity pa tterns onto a post-synaptic neuron from N neurons is 2 N , and hence the minimum number of trials is N . However, prior knowledge that only K connections are present reduces the number of poss ible connectivity patterns from 2 N to the binomial coefficient, C K N ~ (N/K) K . Thus, the number of trials dramatically reduces from N to K log (N/K) &lt;&lt; N for a sparse circuit. In this section we search computationally for the m inimum number of trials required for exact reconstruction as a function of the number of non-zero synaptic weights K out of N potentially pre-synaptic neurons. First, note that the number of trials depends on the number of stimulated neurons F . If F = 1 we revert to the brute force approach and the numb er of measurements is N , while for F = N , the measurements are redundant and no finite numb er suffices. As the minimum number of measurements is expected to scale as K log N , there must be an optimal F which makes each measurement most informative abou t x . To determine the optimal number of stimulated neuro ns F for given K and N , we search for the minimum number of trials M , which allows a perfect reconstruction of the syna ptic connectivity x . For each F , we generate 50 synaptic weight vectors and attemp t reconstruction from sequentially increasing numbers of trials. The value of M, at which all 50 recoveries are successful (up to computer round-off error), estimates the number of trial needed for reconstruction with probability higher t han 98%. By repeating this procedure 50 times for each F , we estimate the mean and standard deviation of M . We find that, for given neurons, F , has a shallow minimum. As K decreases, the minimum shifts towards larger F because more neurons should be stimulated simultane ously for sparser x . For the explored range of simulation parameters, the minimum is loca ted close to 0.1N . Next, we set F = 0.1 N and explore how the minimum number of measurement s required for described above are shown in Figure 3a. As expected , when x is sparse, M grows approximately linearly with K (Figure 3b), and logarithmically with N (Figure 3c). Figure 3: a) Minimum number of measurements M required for reconstruction as a function of the number of actual synapses, K , and the number of potential synapses, N . b) For given N , we find M ~ K . c) For given K , we find M ~ log N (note semi-logarithmic scale in c). To make our simulation more realistic we now take i nto account three possible sources of noise: 1) In reality, post-synaptic voltage on a gi ven synapse varies from trial to trial [4, 5, because each row of A is multiplied by a different instantiation of vect or x . 2) Stimulation of neurons may be imprecise exciting a slightly differ ent subset of neurons than intended noise detrimentally affects reconstructions because , in its presence, the actual measurement matrix A is different from the one used for recovery. 3) A synapse may fail to release neuro-transmitter with some probability. Naturally, in the presence of noise, reconstruction s cannot be exact. We quantify the reconstruction error by the normalized l 2  X  X rror approach ( M = N = 500 trials) as a function of noise, as well as CS and RC reconstruction errors ( M = 200, 600 trials), Figure 4. For each noise source, the reconstruction error of the brute force approach can be achieved with 60% fewer trials by CS method for the above pa rameters (Figure 4). For the same number of trials, RC method performs worse. Natural ly, the reconstruction error decreases with the number of trials. The reconstruction error is most sensitive to stimulation noise and least sensitive to synaptic noise. Recovery error due to trial-to-trial variation in s ynaptic weight. The response y is calculated using the synaptic connectivity x perturbed by an additive Gaussian noise. The noise level is given by the coefficient of variation of synaptic w eight. b) Recovery error due to stimulation noise. The matrix A used for recovery is obtained from the binary matr ix used to calculate the measurement vector y by shifting, in each row, a fraction of ones speci fied by the noise level to random positions. c) Recovery error due to synaptic failures. The detrimental effect of the stimulation noise on the reconstruction can be eliminated by monitoring spiking activity of potentially pre-syna ptic neurons. By using calcium imaging [18-22], voltage-sensitive dyes [23] or multi-elect rode arrays [17, 26] one could record the actual stimulation matrix. Because most random matr ices satisfy the reconstruction requirements [31, 34, 35], the actual stimulation m atrix can be used for a successful recovery instead of the intended one. If neuronal activity can be monitored reliably, exp eriments can be done in a different mode altogether. Instead of stimulating designated neuro ns with high fidelity by using highly tuned to stimulate the optimal number of neurons pe r trial. Next, we explore the sensitivity of the proposed re construction method to the violation of simplifying assumptions. First, whereas our simulat ion assumes that the actual number of connections, K , is known, in reality, connectivity sparseness is known a priori only approximately. Will this affect reconstruction resu lts? In principle, CS does not require prior knowledge of K for reconstruction [31, 34, 35]. For the CoSaMP al gorithm, however, it is important to provide value K larger than the actual value (Figure 5a). Then, th e algorithm will find all the actual synaptic weights plus some extra non-zero weights, negligibly small when compared to actual ones. Thus, one can provide the algorithm with the value of K safely larger than the actual one and then threshol d the reconstruction result according to the synaptic noise level. Second, whereas we assumed a linear summation of in puts [53], synaptic integration may be linearly summed synaptic inputs. Results of simulat ions (Figure 5b) show that although non-linearity can significantly degrade CS reconstructi on quality, it still performs better than RC. Figure 5: Sensitivity of reconstruction error to th e violation of simplifying assumptions for N = 500 , K = 30 , M = 200 , F = 50 . a) The quality of the reconstruction is not affec ted if the computed in 100 realizations for each value of the quadratic term relative to the linear term. Until now, we considered reconstruction of synaptic inputs onto one neuron using sub-threshold measurements of its membrane potential. I n this section, we apply CS to reconstructing synaptic connections onto a populati on of potentially post-synaptic neurons. Because in CS the choice of stimulated neurons is n on-adaptive, by recording from all potentially post-synaptic neurons in response to on e sequence of trials one can reconstruct a complete feedforward network (Figure 6). (a) (b) (c) Figure 6: Mapping of a complete feedforward network . a) Each post-synaptic neuron (red) receives synapses from a sparse subset of potential ly pre-synaptic neurons (blue). b) Linear algebra representation of the experimental protocol . c) Probability of firing as a function of synaptic current. d) Comparison of CS and STA recon struction error using spike trains for N = 500 , K = 30 and F = 50 . Although attractive, such parallelization raises se veral issues. First, patching a large number of neurons is unrealistic and, therefore, monitorin g membrane potential requires using different methods, such as calcium imaging [18-22], voltage sensitive dyes [23-25] or multi-measurement is not analog but discrete. Depending o n the strength of summed synaptic inputs compared to the firing threshold, the postsy naptic neuron may be silent, fire once or multiple times. As a result, the measured response y is quantized by the integer number of spikes. Such quantized measurements are less inform ative than analog measurements of the sub-threshold membrane potential. In the extreme ca se of only two quantization levels, spike or no spike, each measurement contains only 1 bit o f information. Therefore, to achieve reasonable reconstruction quality using quantized m easurements, a larger number of trials M&gt;&gt;N is required. We simulate circuit reconstruction from spike recor dings in silico as follows. First, we draw synaptic weights from an experimentally motivated d istribution. Second, we generate a random stimulation matrix and calculate the product Ax . Third, we linear half-wave rectify this product and use the result as the instantaneou s firing rate for the Poisson spike generator (Figure 6c). We used a rectifying threshold that re sults in 10% of spiking trials as typically observed in experiments. Fourth, we reconstruct syn aptic weights using STA and CS and compare the results with the generated weights. We calculated mean error over 100 realizations of the simulation protocol (Figure 6d) . Due to the non-linear spike generating procedure, x can be recovered only up to a scaling factor. We propose to calibrate x with a few brute-force measurements of synaptic we ights. Thus, in calculating the reconstruction error using l 2 norm, we normalize both the generated and recovered synaptic weights. Such definition is equivalent to the angular error, which is often used to evaluate the performance of STA in ma pping receptive field [37, 55]. trials, which typically constitute a majority, also carry information about connectivity. While STA discards these trials, CS takes them into accou nt. In particular, CoSaMP starts with the STA solution as zeroth iteration and improves on it by using the results of all trials and the sparseness prior. We have demonstrated that sparse feedforward networ ks can be reconstructed by stimulating multiple potentially pre-synaptic neurons simultane ously and monitoring either sub-threshold or spiking response of potentially post-s ynaptic neurons. When sub-threshold approach. Although our method is sensitive to noise (with stimulation noise worse than synapse noise), it is no less robust than the brute force approach or RC. The proposed reconstruction method can also recover inputs onto a neuron from spike counts, albeit with more trials than from sub-thres hold potential measurements. This is detected reliably, for example, when mapping synapt ic inputs onto multiple neurons in parallel. For a given number of trials, our method yields smaller error than STA. The proposed reconstruction method assumes linear s ummation of synaptic inputs (both excitatory and inhibitory) and is sensitive to non-linearity of synaptic integration. Therefore, integration under realistic conditions. instead? We see two major drawbacks of such approac h. First, activity of non-monitored pre-synaptic neurons may significantly distort reconstr uction results. Thus, successful reconstruction would require monitoring all active pre-synaptic neurons, which is rather challenging. Second, reliable reconstruction is pos sible only when the activity of pre-synaptic neurons is uncorrelated. Yet, their activi ty may be correlated, for example, due to common input. We thank Ashok Veeraraghavan for introducing us to CS, Anthony Leonardo for making a retina manuscript and anonymous reviewers for helpful sugg estions.
 R e f e r e n c e s 
