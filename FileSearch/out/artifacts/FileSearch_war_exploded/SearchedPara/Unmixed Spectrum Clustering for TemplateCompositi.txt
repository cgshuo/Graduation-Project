 Real-world problems provide various spectral data. We often regard a given set of such spectra as a mixtu re of elementary spectra , which can be computed by some spectral unmixing method. In this paper, we apply independ component analysis (ICA) [5] to lung sound power spectra and approximate a set of tens of power spectra with a mixture of a s mall number of spectra which we call component spectra . Further, we filter out less e ffective component spectra by conducting clustering a large number of times on a set of component spectra obtained from various lung sounds. Component spectra belonging to the same cluster over all clustering results can be regarded as robustly similar with each other and may show an outstanding feature of a specific type of lung sounds. Therefore, we regard only such compone nt spectra as efficient ones and use them to make templates for lung sound classification.

The rest of the paper is organized as follows. Section 2 provide the results of previous researches. Section 3 descri bes details of our method. In Section 4, we show the settings and the results of our evaluation experiment. Section 5 concludes this paper along with our future works. We are experiencing a new wave of lung sound analysis due to the import of various machine learning techniques in recent years [1]. However, there seem no researches applying ICA not to lung sounds but to their power spectra obtained by FFT. G  X  uler et al. [3] reduce the feature space dimension to two and provide a visual classification of lung sounds drawn in two-dimensional space. Pelletier [9] regards each power spectrum as a histogram and provides a reduction of the number of bins with principal component analysis. In contrast, we do not reduce the dimention of power spectra. We assume that the number of compo-nent spectra, which are mixed to produc e a given set of power spectra, is small and obtain a set of such component spectra by applying a spectral unmixing. Other research fields provide this type of approaches. In the field of remote sens-ing, we obtain a compact representation of a hyperspectral image by extracting component spectra, called endmember spectra [8]. Our research follows this line. First of all, we obtain power spectra from a given lung sound by using FFT with Hanning window. In other sets of experiments, whose results are not included in this paper, we confirm that Hamming window also gives similar results, but that flattop window is not effective. We make any two consecutive windows share the half of their lengths. Let each window include 2 T data points. When the sampling frequency is f Hz, each window corresponds to an interval of length 2 T/f sec. In this paper, we set T = 2048. Two key modules are described below.
Spectral Unmixing. We call a set of N consecutive windows frame .Since two consective windows overlap by one-half the window length, each frame is of length ( N +1) T/f sec. In this paper, we set N = 32. We make two consecutive frames share 3 N/ 4 windows. N power spectra obtained from each frame are approximated by a linear mixture of M ( M N ) spectra, called component spectra .Weuse fastICA algorithm [5] to obtain component spectra. The update formula proposed in [4] is employed to achieve stable convergence. Since this paper is intended to reveal basic characteristics of our method, we choose the most simple set up for M . That is, we set M = 2. We call a pair of component spectra extracted from each frame component pair .

Component Spectra Clustering. In our setting, we can obtain many com-ponent pairs from a lung sound. We put component spectra taken from various lung sounds into a single set and conduct clustering over this set a large number of times. In this paper, we conduct k -means 100 times. We use no information about which two of component spectra come from the same component pair. If two component spectra from the same component pair belong to the same cluster in many of the 100 clustering results, we can conclude that the unmixing method we adopt is not effective, because a large number of executions of cluster-ing provide a robust estimation of simila rities between component spectra. We write q  X  q when two component spectra q and q belong to the same cluster over all clustering resul ts.Wecallthisrelation coupling .Let( q 1 , q 2 )and( q 1 , q 2 ) be two component pairs obtained from different frames. q 1  X  q 2 and q 1  X  q 2 are undesirable, because component spectra from the same component pair are obtained by ICA and thus are expected to be dissimilar. We call this type of cou-plings malicious . When we use NMF algorithm in [6] in place of fastICA, a large number of couplings turn out to be malicious. This result shows the low quality of this version of NMF unmixing. By excluding malicious couplings, we have the following cases of similarity between component pairs ( q 1 , q 2 )and( q 1 , q 2 ): 1. Both q 1  X  q 1 and q 2  X  q 2 hold, or both q 1  X  q 2 and q 2  X  q 1 hold. 2. Either q 1  X  q 1 or q 2  X  q 2 holds, or either q 1  X  q 2 or q 2  X  q 1 holds. For Case 1, we say that both couplings are perfect . The couplings in Case 2 are called imperfect . Perfect couplings tell a strong similarity between the two frames corresponding to the two component pairs ( q 1 , q 2 )and( q 1 , q 2 ). Settings. We use lung sounds recorded in the CD accompanying a textbook for nurses [2]. After identifying different sound data corresponding to lung sounds of the same type, we have lung sounds splitted into 39 categories shown in Table 1. When we use each power spectrum in their full range, many malicious couplings are obtained. High-frequency part seems to have an undesirable effect to our method. Therefore, we eliminate high-frequency part and test the following set-tings for the range of spectra: 1  X 256, 1  X 512, 257  X 512, and 257  X 1024. Recall that T = 2048. As for the last two cases, we also eliminate low-frequency part. How-ever, the third setting results in a few malicious couplings. This shows that the range 513  X 1024 has some importance when we discard the range 1  X 256.
At the initialization of k -means, we set the number of clusters to 100. In the course of the execution of a clustering, some clusters eventually get empty. For example, we obtain from 59 to 79 clusters and 69.7 clusters in average for 100 executions of k -means when we use 1st to 512th entries of power spectra.
Results. Table 1 includes the results when we use 1st to 512th entries of power spectra. Column A presents the number of frames obtained from the lung sounds of each category. The total number of frames is 3,357. Since ICA provides two component spectra for each frame, we obt ain a set of 6,714 component spectra. The results of 100 executions of k -means induce perfect and imperfect couplings. Column B shows the number of frames giv ing imperfect or perfect couplings. Column C shows the number of frames giving perfect couplings. When the value in Column B is small, we have some trouble in processing the lung sounds of the corresponding category, because we can ex pect that component spectra from the lung sounds of the same category form at least imperfect couplings. For example, the category of ID 35 has a small value in Column B. This may be due to the fact that the sound is in small volume. It is, however, beyond our scope to propose preprocessing methods appropriate for our method.

Column D (resp. Column E) gives the number of imperfect (resp. perfect) couplings which include at least one component spectra from the corresponding category. All numbers in Column E are even, because every perfect coupling comes with another perfect coupling. Wh en a coupling includes two component spectra from the same category, we call such a coupling correct .Otherwise,a coupling is called incorrect . For the category of ID 10, all of 10812 perfect cou-plings turn out to be correct. That is, ea ch of these perfect couplings consists of two component spectra taken from the lung sounds of this category. We can conclude that this category exhibits a strong self-similarity. In contrast, cate-gories of ID 12, 16, 30 and 35 provide no perfect couplings. Among these four categories, the sounds of categories 12 and 35 are in small volume. Further, the lung sounds of category 16 have an irregularly long respiration cycle. These cate-gories require appropriate preprocessing methods, which is our important future work. The lung sounds of category 30 seem to show rapid changes in the same respiration cycle. We may need to try other settings for T or for the overlapping widths of windows. The category of ID 17 provides interesting results. While all 444 perfect couplings are correct, the number of imperfect couplings is 3,029, far larger than 444. Moreover, 2,330 among these 3,029 imperfect couplings are correct. We may explain these results by the fact that the lung sounds of this category show poor periodicity. Stable cha racteristics is reflected by one half of each component pair, and changeable cha racteristics is re flected by another.
Evaluation of Results. We can make equivalence classes by regarding per-fect coupling as an equivalence relation. These equivalence classes are, in a sense,  X  X eta-clusters X  construct ed based on multiple clustering results. Each equiva-lence class can provide a powerful clue to f orm templates useful in classification of unknown lung sounds. It is an important future work to devise a procedure of template composition for the categories giving no perfect couplings, e.g. cat-egories of ID 12, 16, 30 and 35, because we can have no meta-clusters for these categories. Table 2 presents an evaluation of this meta-clustering. The number of categories which give at least two perfect couplings is shown in the column marked by  X   X   X  for each setting. The number in the column marked by  X   X   X  refers to the number of component spectra which are taken from the corresponding category and, at the same time, are incl uded in at least one perfect couplings. Table 2 also presents an evaluation of meta-clustering. We use 39 categories presented in Table 1 as the ground truth. The evaluation measures are microav-eraged/macroaveraged precision, microaveraged/macroaveraged recall and their harmonic mean. These measures are often used in the evaluation of clustering and are defined as follows. The dominating category of a cluster is the category providing the largest number of component spectra to that cluster. The precision of a cluster is equal to the number of co mponent spectra from the dominating category divided by the cluster size, i.e., the number of component spectra in-cluded in the cluster. The recal l of a cluster is the number of component spectra from the dominating category divided by the number of all component spec-tra from that category. We can summeri ze the precisions and the recalls of all obtained clusters by microaveraging or by macroaveraging. Microaveraged preci-sion is equal to the sum of the numerators of all precisions divided by the sum of the denominators of all precisions. We can obtain microaveraged recall in the same manner. Macroaveraged precision (resp. macroaveraged recall ) is computed simply as an arithmetic mean of all precisions (resp. all recalls).

In all settings, we have high precisions and low recalls, because the numbers of clusters, shown in the last column, are far larger than the number of categories. However, our method is designed for template composition in classification task. Therefore, each category can have severa l templates. The number of dominating categories is shown in the column  X   X  X  X   X . When this number is smaller than that presented in the column  X   X   X , there exist categories which can dominate no clus-ters. We have no meta-clusters also for such categories. Only when we use 1st to 512th entries of power spectra, every category dominates at least one cluster. We also have the best precision, i.e., 0.9711, for this setting. In this paper, we propose a method for d etecting robust similarities between short intervals taken from various lung sounds. The results of evaluation show that we can obtain equivalence classes o f component spectra with high precision. However, some types of lung sounds do not provide meaningful similarities. We need to propose preprocessing methods for such lung sounds. Further, in the near future, we will provide the procedures for composing templates and will devise a method for comparing unknown lung sounds with the templates.
