 V is ual input to the retina cons is ts of comple x light intens ity patterns . The interpretation of thes e patterns cons titutes a challenging problem: for computational tas ks lik e object recognition, it is not clear what information about the image s hould be e xtracted and in which form at it s hould be repre-s ented. S imilarly , it is dif ficult to as s es s what information is con v e yed by the multitude of neurons in the vis ual pathw ay . Right from the firs t s ynaps e, the information of an indi vidual photoreceptor is s ignaled to man y dif ferent cells with dif ferent temporal filtering properties , each of which is only a s mall unit within a comple x neural netw ork [ 20] . Ev en if we lea v e the dif ficulties impos ed by nonlinearities and feedback as ide, it is hard to judge what the contrib ution of an y particular neuron is to the information trans mitted. The pre v alent tool for characterizing the beha vior of s ens ory neurons , the s pik e trigger ed a v erage, is bas ed on a quas i-linear model of neural res pons es [ 1 5 ] . F or the s ak e of clarity , we cons ider an idealized model of the s ignaling channel where y = ( y 1 , . . . , y N ) T denotes the v ector of neural res pons es , x the s timulus parameters , W = ( w 1 , . . . , w N ) T the filter matrix with ro w  X  k  X  containing the recepti v e field w k of neuron k , and  X  is the nois e. The s pik e-triggered a v erage only allo ws des cription of the s timulus -res pons e function (i. e. the w k ) of one s ingle neuron at a time. In order to unders tand the collecti v e beha vior of a neuronal population, we rather ha v e to unders tand the beha vior of the matrix W , and the s tructure of the nois e correlations  X   X  : B oth of them influence the feature s electi vity of the population. Can we find a compact des cription of the features that a neural ens emble is mos t s ens iti v e to? In the cas e of a s ingle cell, the recepti v e field pro vides s uch a des cription: It can be interpreted as the  X  X  a v orite s timulus  X  of the neuron, in the s ens e that the more s imilar an input is to the recepti v e field, the higher is the s piking probability , and thus the firing rate of the neuron. In addition, the recepti v e field can eas ily be es timated us ing a s pik e-triggered a v erage, which, under certain as s umptions , yields the optimal es timate of the recepti v e field in a linear -nonlinear cas cade model [ 1 1 ] . If we are cons idering an ens emble of neurons rather than a s ingle neuron, it is not ob vious what to trigger on: This requires as s umptions about what patterns of s pik es or modulations in firing rates acros s the population carry information about the s timulus . Rather than addres s ing the ques tion  X  what features of the s timulus are correlated with the occurence of s pik es  X , the ques tion no w is :  X  What s timulus features are correlated with what patterns of s piking acti vity?  X  [ 1 4] . Phras ed in the language of information theory , we are s earching for the s ubs pace that contains mos t of the mu-tual information between s ens ory i nputs and neuronal res pons es . B y this dimens ionality reduction technique, we can find a compact des cription of the proces s ing of the population.
 As an ef ficient implementation of this s trate gy , we pres ent an e xtens ion of re v ers e-correlation meth-ods bas ed on canonical correlation analys is . The res ulting population recepti v e fields (PRFs ) are not bound to be triggered on indi vidual s pik es b ut are link ed to res pons e patterns that are s imultaneous ly determined by the algorithm.
 W e calculate the PRF for a population cons is ting of uniformly s paced cells with center -s urround recepti v e fields and nois e correlations , and es timate the PRF of a population of rabbit retinal g anglion cells from multi-electrode recordings . In addition, we s ho w ho w our method can be e xtended to e xplore dif ferent h ypothes es about the neural code, s uch as s pik e latencies or interv al coding, which require nonlinear read out mechanis ms . W e re g ard the s timulus at time t as a random v ariable X t  X  R n , and the neural res pons e as Y t  X  R m . F or s implicity , we as s ume that the s timulus cons is ts of Gaus s ian white nois e, i. e. E ( X ) = 0 and C ov ( X ) = I .
 The s pik e-triggered a v erage a of a neuron can be moti v ated by the f act that it is the direction in s timulus -s pace maximizing the correlation-coef ficient between the filtered s timulus a T X and a uni v ariate neural res pons e Y 1 . In the cas e of a neural population, we are not only looking for the s timulus feature a , b ut als o need to determine what pattern of s piking acti vity b it is coupled with. The natural e xtens ion is to s earch for thos e v ectors a 1 and b 1 that maximize W e interpret a 1 as the s timulus filter whos e output is maximally correlated with the output of the  X  X es pons e fil ter X  b 1 . Thus , we are s imultaneous ly s earching for features of the s timulus that the of this feature. W e refer to the v ector a 1 as the (firs t) population r eceptive field of the population, and b 1 is the r esponse featur e corres ponding to a 1 . If a h ypothetical neuron recei v es input from the population, and w ants to decode the pres ence of the s timulus a 1 , the weights of the optimal linear readout [ 1 6] could be deri v ed from b 1 .
 Canonical Correlation Analys is (CCA) [ 9] is an algorithm that finds the v ectors a 1 and b 1 that maximize (3 ): W e denote the co v ariances of X and Y by  X  x ,  X  y , the cros s -co v ariance by  X  x y , and the whitened cros s -co v ariance by Let C = U D V T denote the s ingular v alue decompos ition of C , where the entries of the diagonal matrix D are non-ne g ati v e and decreas i n g along the diagonal. Then, the k -th pair of ca no ni cal v ectors of U and V , res pecti v ely . Furthermore, the k -th s i ngular v alue of C , i. e. the k -th diagonal entry of D is the correlation-coef ficient  X  k of a T k X and b T k Y . The random v ariables a T i X and a T j X are uncorrelated for i  X  = j .
 Importantly , the s olution for the optimization problem in CCA is unique and can be computed ef-ficiently via a s ingle eigen v alue problem. The population recepti v e fields and the characteris tic patterns are found by a joint optimization in s timulus and res pons e s pace. Therefore, one does not need to kno w X  X r as s ume X  X  priori what features the population is s ens iti v e to, or what s pik e patterns con v e y the information.
 The firs t K PRFs form a bas is for the s ubs pace of s timuli that the neural population is mos t s ens i ti v e to, and the indi vidual bas is v ectors a k are s orted according to their  X  X nformati v enes s  X  [ 1 3 , 1 7] . The mutual information between tw o one-dimens ional Gaus s ian V ariables with correlation  X  is gi v en by MI G a u s s =  X  1 2 l o g ( 1  X   X  2 ) , s o maximizing correlation coef ficients is equi v alent to maximizing mutual information [ 3 ] . As s uming the neural res pons e Y to be Gaus s ian, the s ubs pace s panned by the firs t K v ectors B K = ( b 1 , . . . , b K ) is als o the K -s ubs pace of s timuli that contains the maximal amount of mutual information between s timuli and neural res pons e. That is Thus , in terms of dimens ionality reduction, CCA optimizes the s ame objecti v e as oriented PCA [ 5 ] . In contras t to oriented PCA, ho we v er , CCA does not require one to kno w e xplicitly ho w the res pons e co v ari ance  X  y =  X  s +  X   X  s plits into s ignal  X  s and nois e  X   X  co v ariance. Ins tead, it us es the cros s -co v ariance  X  x y which is directly a v ailable from re v ers e correlation e xperiments . In addition, CCA not only r eturns the mos t predictable res pons e features b 1 , . . . b K b ut als o the mos t predicti v e s timulus components A K = ( a 1 , . . . a K ) .
 F or general Y and for s timuli X with elliptically contoured dis trib ution, MI G a u s s  X  J ( A T X ) pro-vides a lo wer bound to the mutual information between A T X and B T Y , where is the Ne gentrop y of A T X , and h ( A T X ) its dif ferential entrop y . S ince for elliptically contoured dis trib utions J ( A T X ) does not depend on A, the PRFs can be s een as the s olution of a v ariational approach, maximizing a lo wer bound to the mutual information. Maximizing mutual information directly is hard, requires e xtens i v e amounts of data, and us ually multiple repetitions of the s ame s timulus s equence. 3.1 The effect of tuning functions and noise corr elations T o illus trate the relations hip between the tuning-functions of indi vidual neurons and the PRFs [ 22] , we calculate the firs t PRF of a s imple one-dimens ional population model cons is ting of center -s urround neurons . Each tuning function is modeled by a  X  X if ference of Gaus s ians  X  (DOG) whos e centers c are uniformly dis trib uted o v er the real axis . The width  X  of the ne g ati v e Gaus s ian is s et to be twice as lar ge as the width  X  of the pos iti v e Gaus s ian. If the area of both Gaus s ians is the s ame ( A = 1 ) , the DC component of the DOG-fillter is zero, i. e. the neuron is not s ens iti v e to the mean luminance of the s timulus . If the ratio between both areas becomes s ubs tantial ly unbalanced, the DC component will become the lar ges t s ignal ( A  X  0 ) .
 In addition to the parameter A , we will s tudy the length s cale of nois e correl ations  X  [ 1 8 ] . S pecifi-cally , we as s ume e xponentially decaying nois e correlation with  X   X  ( s ) = e x p (  X  | s | / X  ) . As t his model is in v ariant under s patial s hifts , the firs t PRF can be calculated by finding the s patial frequenc y at which the S NR is maximal. That is , the firs t PRF can be us ed to es timate the pas s band of the population trans fer function. The S NR is gi v en by The pas s band of the firs t population filter mo v es as a function of both param eters A and  X  . It equals the DC component for s mall A (i. e. lar ge imbalance) and s mall  X  (i. e. s hort correlation length). In this cas e, the mean intens ity is the s timulus property that is mos t f aithfully s ignaled by the ens emble. Figure 1 : S patial frequenc y of the firs t PRF for the model des cribed abo v e.  X  is the length-s cale of the nois e correlations , A is the weight of the ne g ati v e Gaus s ian in the DOG-model. The re gion in the bottom left corner (bounded by the white line) is the part of the parameter -s pace in which the PRF equals the DC component. 3.2 The r ecepti v e field of an ensemble of r etinal ganglion cells W e mapped the population recepti v e fields of rabbit retinal g anglion cells recorded with a whole-mount preparation. W e are not primarily interes t ed in prediction performance [ 1 2] , b ut rather in dimens ionality reduction: W e w ant to characterize the filtering properties of the population. The neurons were s timulated with a 1 6  X  1 6 check erboard cons is ting of binary white nois e which w as updated e v ery 20ms . The e xperimental procedures are des cribed in detail in [ 21 ] . After s pik e-s orting, s pik e trains from 3 2 neurons were binned at 2 0 ms res olution, and the res pons e of a neuron to a s timulus at time t w as defined to cons is t of the the s pik e-counts in the 1 0 bins between 40ms and 240ms after t . Thus , each population res pons e Y t is a 3 20 dimens ional v ector .
 Figure 3 . 2 A) dis plays the firs t 6 PRFs , the corres ponding patterns of neural acti vity (B ) and their correlation coef ficients  X  k (which were calculated us ing a cros s -v alidation procedure). It can be s een that the P RFs look v ery dif ferent to the us ual center -s urrond s t ructure of retinal g anglion. Ho we v er , one s hould k eep in mind that it is really the s pace s panned by the PRFs that is rele v ant, and thus be careful when interpreting the actual filter s hapes [ 1 5 ] .
 F or comparis on, we als o plotted the s ingle-cell recepti v e fields in Figure 3 . 2 C), and their projections into the s paced s panned by the firs t 6 PRFs . Thes e plots s ugges t that a s mall number of PRFs might be s uf ficient to approximate each of the recepti v e fields . T o determine the dimens ionality of the rele v ant s ubs pace, we analyzed the correlation-coef ficients  X  k . The Gaus s ian Mutual Informat ion s panned by the firs t K PRFs . B as ed on this meas ure, a 1 2 dimens ional s ubs pace accounts for 90% of the total information.
 In order to link the empirically es timated PRFs with the theoretical analys is in s ection 3 . 1 , we calculated the s pectral properties of the firs t PRF . Our analys is re v ealed that mos t of the po wer is in the lo w frequencies , s ugges ting that the population is in the param eter -re gime where the s ingle-cell recepti v e fields ha v e po wer in the DC-component and the nois e-correlations ha v e s hort range, which is certainly reas onable for retinal g anglion cells [ 4] .
 A) B ) C) Figure 2: The population recepti v e fields of a group of 3 2 retinal g anglion cells : A) the firs t 6 PRFs , as s orted by the correlation coef ficient  X  k B ) the res pons e features b k coupled with the PRFs . Each ro w of each image corres ponds to one neuron, and each column to one time-bi n. B lue color denotes enhanced acti vity , red s uppres s ed. It can be s een that only a s ubs et of neurons contrib uted to the firs t 6 PRFs . C) The s ingle-cell recepti v e fields of 2 4 neurons from our population, and their projections into the s pace s panned by the 6 PRFs . A) Figure 3 : A) Correlation coef ficients  X  k for the PRFs . Es timates and error -bars are calculated us ing a cros s -v alidation procedure. B ) Gaus s ian-MI of the s ubs pace s panned by the firs t K PRFs . Thus f ar , our model is completely linear: W e as s ume that the s timulus is linearly related to the neural res pons es , and we als o as s ume a linear readout of the res pons e. In this s ection, we will e xplore generalizations of the CCA model us ing K ernel CCA : B y embedding the s timulus -s pace nonlinearly in a feature s pace, nonlinear codes can be des cribed.
 K ernel methods pro vide a frame w ork for e xtending linear algorithms to the nonlinear cas e [ 8 ] . After projecting the data into a feature s pace via a feature maps  X  and  X  , a s olution i s found us ing linear methods in the feature s pace. In the cas e of K ernel CCA [ 1 , 1 0, 2, 7] one s eeks to find a linear relations hip between the random v ariables  X  X =  X  ( X ) and  X  Y =  X  ( Y ) , rather than between X and Y . If an algorithm is purely defined in terms of dot-products , and if the dot-product in feature s pace k ( s, t ) =  X   X  ( s ) ,  X  ( t )  X  can be computed ef ficientl y , then the algorithm does not require e xplicit calculation of the feature maps  X  and  X  . This  X  X  ernel-trick X  mak es it pos s ible to w ork in high-(or i n fi nite)-dimens ional feature s paces . It is w orth mentioning that the s pace of patterns Y its elf does not ha v e to be a v ector s pace. Gi v en a data-s et x 1 . . . x n , it s uf fices to kno w the dot-products between an y pair of training points , K i j : =  X   X  ( y i ) ,  X  ( y j )  X  .
 The k ernel function k ( s, t ) can be s een as a s imiliarity meas ure. It incorporates our as s umptions about which s pik e-patterns s hould be re g arded as s imilar  X  X es s ages  X . Therefore, the choice of the k ernel-function is clos ely related to s pecifing what the s earch-s pace of potential neural codes is . A number of dis tance-and k ernel-functions [ 6, 1 9] ha v e been propos ed to compute dis tances between s pik e-trains . The y can be des igned to tak e into account precis ely timed pattern of s pik es , or to be in v ariant to certain trans formations s uch as temporal jitter .
 W e illus trate the concept on s imulated data: W e wi ll us e a s imilarity meas ure bas ed on the metric D interv al [ 1 9] to es timate the recepti v e field of a neuron which does not us e its firing rate, b ut rather the occurrence of s pecific inters pik e interv als to con v e y information about the s timulus . The metric D interv al between tw o s pik e-trains is es s entially the cos t of matching their interv als by s hifting, adding or deleting s pik es . (W e s et k ( s, t ) = e x p (  X  D ( s, t ) . In theory , this function is not guaranteed to be pos iti v e definite, which could lead to numerical problems , b ut we did not encounter an y in our s imulation. ) If we cons ider coding-s chemes that are bas ed on patterns of s pik es , the methods des cribed here become us eful e v en for the analys is of s ingle neurons . W e will here concentrate on a s ingle neuron, b ut the analys is can be e xtended to patterns dis trib uted acros s s e v eral neurons . Our h ypothetical neuron encodes information in a pattern cons is ting of three s pik es : The relati v e timing of the s econd s pik e is informati v e about the s timulus : The bigger the correlation between to the s timulus , the interv al is long. While the timing of the s pik es rel ati v e to each other is precis e, there is jitter in the timing of the pattern relat i v e to the s timulus . Figure 4 A) is a ras ter plot of s imulated s pik e-trains from this model, ordered by  X  r , s t  X  . W e als o included nois e s pik es at random times . Figure 4: Coding by s pik e patterns : A) Recepti v e field of neuron des cribed in S ection 4. B ) A s ubs et of the s imulated s pik e-trains , s orted with res pect to the s imilarity between the s ho wn s timulus and the recepti v e field of the model. The interv al between the firs t tw o informati v e s pik es in each trial is highlighted in red. C) Recepti v e field reco v ered by K ernel CCA, the correlation coef ficient between real and es timated recepti v e field is 0. 93 . D) Recepti v e field deri v ed us ing linear decoding, correlation coef ficient is 0 . 0 2 .
 Us ing thes e s pik e-trains , we tried t o reco v er the recepti v e field r without telling the algorithm what the indicating pattern w as . Each s timulus w as s ho wn only once, and therefore, that e v ery s pik e-pattern occurred only once. W e s imulated 5 0 0 0 s timulus pres entations for this model, and applied K ernel CCA with a linear k ernel on the s timuli, and the alignment-s core on the s pik e-trains . B y us ing incomplete Choles k y decompos itions [ 2] , one can compute K ernel CCA without ha ving to calculate the full k ernel matrix. As man y k ernels on s pik e trains are computationally e xpens i v e, this trick can res ult in s ubs tantial s peed-ups of the computation. The re cepti v e field w as reco v ered (s ee Figure 4), des pite the highly nonlinear encoding mechanis m of the neuron. F or comparis on, we als o s ho w what recepti v e field w ould be obtained us ing linear decoding on the indicated bins . Although this neuron model may s eem s lightly contri v ed, it is a good proof of concept that, in principle, recepti v e fields can be es timated e v en if the firing rate gi v es no information at all about the s timulus , and the encoding is highly nonlinear . Our algorithm does not only look at patterns that occur more often than e xpected by chance, b ut als o tak es into account to what e xtent their occurrence is correlated to the s ens ory input. W e s et out to find a us eful des cription of the s timulus -res pons e relations hip of an ens emble of neurons akin to t he concept of recepti v e field for s ingle neurons . The population recepti v e fields are found by a joint optimization o v er s timuli and s pik e-patterns , and are thus not bound to be triggered by s ingle s pik es .
 W e es timated the PRFs of a group of retinal g anglion cells , and found that the firs t PRF had mos t s pectral po wer in the lo w-frequenc y bands , cons is tent with our theoretical analys is . The s timulus we us ed w as a white-nois e s equence X  X t will be interes ting to s ee ho w the informati v e s ubs pace and its s pectral properties change for dif ferent s timuli s uch as colored nois e. The g anglion cell layer of the retina is a s ys tem that is relati v ely well unders tood at the le v el of s ingle neurons . Therefore, our res ults can readily be compared and connected to thos e obtained us ing con v entional analys is techniques . Ho we v er , our approach has the potential to be es pecially us eful in s ys tems in which the functional s ignificance of s ingle cell recepti v e fields is dif ficult to interpret. W e us ually as s umed that each dimens ion of the res pons e v ector Y repres ents an electrode-recording from a s ingle neuron. Ho we v er , the v ector Y could als o repres ent an y other multi-dimens ional mea-s urement of brain acti vity: F or e xample, imaging modalities s uch as v oltage-s ens iti v e dye imaging yield meas urements at multiple pix els s imultaneous ly . Data from electro-ph ys iological data, e. g. lo-cal field potentials , are often analyzed in frequenc y s pace, i. e. by looking at the ener gy of the s ignal in dif ferent frequenc y bands . This als o res ults in a multi-dimens ional repres entation of the s ignal. Us ing CCA, recepti v e fields can readily be es timated from thes e kinds of repres entations without limiting attention to s ingle channels or e xtracting neural e v ents .
 Ackno wledgments
