 Unsupervised grammar induction has been an ac-tive area of research in computational linguistics for over twenty years (Lari and Young, 1990; Pereira and Schabes, 1992; Charniak, 1993). Recent work (Headden III et al., 2009; Cohen and Smith, 2009; H  X  anig, 2010; Spitkovsky et al., 2010) has largely built on the dependency model with valence of Klein and Manning (2004), and is characterized by its re-liance on gold-standard part-of-speech (POS) anno-tations: the models are trained on and evaluated us-ing sequences of POS tags rather than raw tokens. This is also true for models which are not successors of Klein and Manning (Bod, 2006; H  X  anig, 2010).
An exception which learns from raw text and makes no use of POS tags is the common cover links parser (CCL, Seginer 2007). CCL established state-of-the-art results for unsupervised constituency pars-ing from raw text, and it is also incremental and ex-tremely fast for both learning and parsing. Unfortu-nately, CCL is a non-probabilistic algorithm based on a complex set of inter-relating heuristics and a non-standard (though interesting) representation of constituent trees. This makes it hard to extend. Note that although Reichart and Rappoport (2010) improve on Seginer X  X  results, they do so by select-ing training sets to best match the particular test sentences X  X CL itself is used without modification.
Ponvert et al. (2010) explore an alternative strat-egy of unsupervised partial parsing : directly pre-dicting low-level constituents based solely on word co-occurrence frequencies. Essentially, this means segmenting raw text into multiword constituents. In that paper, we show X  X omewhat surprisingly X  X hat CCL X  X  performance is mostly dependent on its ef-fectiveness at identifying low-level constituents. In fact, simply extracting non-hierarchical multiword constituents from CCL X  X  output and putting a right-branching structure over them actually works better than CCL X  X  own higher level predictions. This result suggests that improvements to low-level constituent prediction will ultimately lead to further gains in overall constituent parsing.

Here, we present such an improvement by using probabilistic finite-state models for phrasal segmen-tation from raw text. The task for these models is chunking, so we evaluate performance on identifica-tion of multiword chunks of all constituent types as well as only noun phrases. Our unsupervised chun-kers extend straightforwardly to a cascade that pre-dicts higher levels of constituent structure, similar to the supervised approach of Brants (1999). This forms an overall unsupervised parsing system that outperforms CCL by a wide margin. We use the standard data sets for unsupervised con-stituency parsing research: for English , the Wall Street Journal subset of the Penn Treebank-3 (WSJ, Marcus et al. 1999); for German , the Negra corpus v2 (Krenn et al., 1998); for Chinese , the Penn Chi-nese Treebank v5.0 (CTB, Palmer et al., 2006). We lower-case text but otherwise do not alter the raw text of the corpus. Sentence segmentation and tok-enization from the treebank is used. As in previous work, punctuation is not used for evaluation.
In much unsupervised parsing work the test sen-tences are included in the training material. Like Co-hen and Smith, Headden III et al., Spitkovsky et al., we depart from this experimental setup and keep the evaluation sets blind to the models during training. For English (WSJ) we use sections 00-22 for train-ing, section 23 for test and we develop using section 24; for German (Negra) we use the first 18602 sen-tences for training, the last 1000 sentences for de-velopment and the penultimate 1000 sentences for testing; for Chinese (CTB) we adopt the data-split of Duan et al. (2007). Evaluation. By unsupervised partial parsing , or simply unsupervised chunking , we mean the seg-mentation of raw text into (non-overlapping) multi-word constituents. The models are intended to cap-ture local constituent structure  X  the lower branches of a constituent tree. For this reason we evaluate WSJ Negra CTB using what we call constituent chunks , the subset of gold standard constituents which are i) branch-ing (multiword) but ii) non-hierarchical (do not con-tain subconstituents). We also evaluate our models based on their performance at identifying base noun phrases, NPs that do not contain nested NPs.
Examples of constituent chunks extracted from treebank constituent trees are in Fig. 1. In English newspaper text, constituent chunks largely corre-spond with base NPs, but this is less the case with Chinese and German. Moreover, the relationship be-tween NPs and constituent chunks is not a subset re-lation: some base NPs do have internal constituent structure. The numbers of constituent chunks and NPs for the training datasets are in Table 1. The per-centage of constituents in these datasets which fall under these definitions, and the percentage of words under these constituents, are in Table 2.

For parsing, the standard unsupervised parsing metric is unlabeled PARSEVAL. It measures preci-sion and recall on constituents produced by a parser as compared to gold standard constituents.
 CCL benchmark. We use Seginer X  X  CCL as a benchmark for several reasons. First, there is a free/open-source implementation facilitating exper-imental replication and comparison. 1 More im-portantly, until recently it was the only unsuper-vised raw text constituent parser to produce re-sults competitive with systems which use gold POS tags (Klein and Manning, 2002; Klein and Man-ning, 2004; Bod, 2006)  X  and the recent improved raw-text parsing results of Reichart and Rappoport (2010) make direct use of CCL without modifica-tion. There are other raw-text parsing systems of note, EMILE (Adriaans et al., 2000), ABL (van Za-anen, 2000) and ADIOS (Solan et al., 2005); how-ever, there is little consistent treebank-based evalu-ation of these models. One study by Cramer (2007) found that none of the three performs particularly well under treebank evaluation. Finally, CCL out-performs most published POS-based models when those models are trained on unsupervised word classes rather than gold POS tags. The only excep-tion we are aware of is H  X  anig X  X  (2010) unsuParse+, which outperforms CCL on Negra, though this is shown only for sentences with ten or fewer words. Phrasal punctuation. Though punctuation is usu-ally entirely ignored in unsupervised parsing re-search, Seginer (2007) departs from this in one key aspect: the use of phrasal punctuation  X  punctuation symbols that often mark phrasal boundaries within a sentence. These are used in two ways: i) they im-pose a hard constraint on constituent spans, in that no constituent (other than sentence root) may extend over a punctuation symbol, and ii) they contribute to the model, specifically in terms of the statistics of words seen adjacent to a phrasal boundary. We fol-low this convention and use the following set: The last two are ideographic full-stop and comma. 2 We learn partial parsers as constrained sequence models over tags encoding local constituent struc-ture (Ramshaw and Marcus, 1995). A simple tagset is unlabeled BIO, which is familiar from supervised chunking and named-entity recognition: the tag B denotes the beginning of a chunk, I denotes mem-bership in a chunk and O denotes exclusion from any chunk. In addition we use the tag STOP for sentence boundaries and phrasal punctuation.
 HMMs and PRLGs. The models we use for un-supervised partial parsing are hidden Markov mod-els, and a generalization we refer to as probabilis-tic right linear grammars (PRLGs). An HMM mod-els a sequence of observed states (words) x = { x 1 ,x 2 ,...,x N } and a corresponding set of hid-den states y = { y 1 ,y 2 ,...,y N } . HMMs may be thought of as a special case of probabilistic context-free grammars, where the non-terminal symbols are the hidden state space, terminals are the observed states and rules are of the form NONTERM  X  and given). So, the emission and transition emanat-ing from y n would be characterized as a PCFG rule y n  X  x n y n +1 . HMMs factor rule probabilities into emission and transition probabilities: However, without making this independence as-sumption, we can model right linear rules directly: So, when we condition emission probabilities on both the current state y n and the next state y n +1 , we have an exact model. This direct modeling of the right linear grammar rule y n  X  x n y n +1 is what we call a probabilistic right-linear grammar. To be clear, a PRLG is just an HMM without the indepen-dence of emissions and transitions. See Smith and Johnson (2007) for a discussion, where they refer to PRLGs as Mealy HMMs.

We use expectation maximization to estimate model parameters. For the E step, the forward-backward algorithm (Rabiner, 1989) works identi-cally for the HMM and PRLG. For the M step, we use maximum likelihood estimation with additive smoothing on the emissions probabilities. So, for the HMM and PRLG models respectively, for words w and tags s,t : where C are the soft counts of emissions C ( t,w ) , rules C ( t,w,s )= C ( t  X  ws ) , tags C ( t ) and tran-sitions C ( t,s ) calculated during the E step; V is the number of terms w , and  X  is a smoothing parameter. We fix  X  = . 1 for all experiments; more sophisti-cated smoothing could avoid dependence on  X  .
We do not smooth transition probabilities (so  X  P ( s | t )= C ( t,s ) /C ( t ) ) for two reasons. First, with four tags, there is no data-sparsity concern with re-spect to transitions. Second, the nature of the task imposes certain constraints on transition probabili-ties: because we are only interested in multiword chunks, we expressly do not want to generate a B following a B  X  in other words P ( B | B )=0 .
These constraints boil down to the observation that the B and I states will only be seen in BII  X  se-quences. This may be expressed via the state transi-tion diagram in Fig. 2. The constraints of also dic-tate the initial model input to the EM process. We use uniform probability distributions subject to the constraints of Fig. 2. So, initial model transition probabilities are given in Fig. 3. In EM, if a parame-ter is equal to zero, subsequent iterations of the EM process will not  X  X nset X  this parameter; thus, this form of initialization is a simple way of encoding constraints on model parameters. We also experi-mented with random initial models (subject to the constraints in Fig. 2). Uniform initialization usu-ally works slightly better; also, uniform initializa-tion does not require multiple runs of each experi-ment, as random initialization does.
 Motivating the HMM and PRLG. This approach  X  encoding a chunking problem as a tagging prob-lem and learning to tag with HMMs  X  goes back to Ramshaw and Marcus (1995). For unsupervised learning, the expectation is that the model will learn to generalize on phrasal boundaries. That is, the models will learn to associate terms like the and a , which often occur at the beginnings of sentences and rarely at the end, with the tag B , which cannot occur at the end of a sentence. Likewise common nouns like company or asset , which frequently occur at the ends of sentences, but rarely at the beginning, will come to be associated with the I tag, which cannot occur at the beginning.

The basic motivation for the PRLG is the assump-tion that information is lost due to the independence assumption characteristic of the HMM. With so few states, it is feasible to experiment with the more fine-grained PRLG model.
 Evaluation. Using the low-level predictions of CCL as as benchmark, we evaluate the HMM and PRLG chunkers on the tasks of constituent chunk and base NP identification. Models were initialized uniformly as illustrated in Fig. 3. Sequence models learn via EM. We report accuracy only after conver-gence, that is after the change in full dataset per-plexity (log inverse probability) is less than %.01 between iterations. Precision, recall and F -score are reported for full constituent identification  X  brack-ets which do not match the gold standard exactly are false positives.

Model performance results on held-out test datasets are reported in Table 3.  X  X CL X  refers to the lowest-level constituents extracted from full CCL output, as a benchmark chunker. The sequence mod-els outperform the CCL benchmark at both tasks and on all three datasets. In most cases, the PRLG se-quence model performs better than the HMM; the exception is CTB, where the PRLG model is behind the HMM in evaluation, as well as behind CCL.
As the lowest-level constituents of CCL were not specifically designed to describe chunks, we also checked the recall of all brackets generated by CCL against gold-standard constituent chunks. The re-sults are given in Table 4. Even compared to this, the sequence models X  recall is almost always higher.
The sequence models, as well as the CCL bench-mark, show relatively low precision on the Negra corpus. One possible reason for this lies in the design decision of Negra to use relatively flat tree structures. As a result, many structures that in other treebanks would be prepositional phrases with embedded noun phrases  X  and thus non-local con-stituents  X  are flat prepositional phrases here. Exam-ples include  X  X uf die Wiesbadener Staatsanwaelte X  (on Wiesbaden X  X  district attorneys) and  X  X n Han-novers Nachbarstadt X  (in Hannover X  X  neighbor city).
In fact, in Negra, the sequence model chunkers often find NPs embedded in PPs, which are not an-notated as such. For instance, in the PP  X  X inter den Kulissen X  (behind the scenes), both the PRLG and HMM chunkers identify the internal NP, though this is not identified in Negra and thus considered a false positive. The fact that the HMM and PRLG have higher recall on NP identification on Negra than pre-cision is further evidence towards this.
 Comparing the HMM and PRLG. To outline some of the factors differentiating the HMM and PRLG, we focus on NP identification in WSJ.
The PRLG has higher precision than the HMM, while the two models are closer in recall. Com-paring the predictions directly, the two models of-ten have the same correct predictions and often miss the same gold standard constituents. The improved results of the PRLG are based mostly on the fewer overall brackets predicted, and thus fewer false pos-itives: for WSJ the PRLG incorrectly predicts 2241 NP constituents compared to 6949 for the HMM. Table 5 illustrates the top 5 POS sequences of the false positives predicted by the HMM. 3 (Recall that we use gold standard POS only for post-experiment results analysis X  X he model itself does not have ac-cess to them.) By contrast, the sequence represent-ing the largest class of errors of the PRLG is DT NN, with 165 errors  X  this sequence represents the largest class of predictions for both models.
 Two of the top classes of errors, MD VB and TO VB, represent verb phrase constituents, which are often predicted by the HMM chunker, but not by the PRLG. The class represented by NNP NNP corresponds with the tendency of the HMM chun-ker to split long proper names: for example, it sys-tematically splits new york stock exchange into two chunks, ( new york )( stock exchange ), whereas the PRLG chunker predicts a single four-word chunk.
The most interesting class is DT JJ, which rep-resents the difficulty the HMM chunker has at dis-tinguishing determiner-adjective from determiner-noun pairs. The PRLG chunker systematically gets DT JJ NN trigrams as chunks. The greater con-text provided by right branching rules allows the model to explicitly estimate separate probabilities for P ( I  X  recent I ) versus P ( I  X  recent O ) . That is, recent within a chunk versus ending a chunk. Bi-grams like the acquisition allow the model to learn rules P ( B  X  the I ) and P ( I  X  acquisition O ) . So, the PRLG is better able to correctly pick out the trigram chunk ( the recent acquisition ). We use cascades of chunkers for full constituent parsing, building hierarchical constituents bottom-up. After chunking is performed, all multiword con-stituents are collapsed and represented by a single pseudoword. We use an extremely simple, but effec-tive, way to create pseudoword for a chunk: pick the term in the chunk with the highest corpus frequency, and mark it as a pseudoword. The sentence is now a string of symbols (normal words and pseudowords), to which a subsequent unsupervised chunking model is applied. This process is illustrated in Fig. 4.
Each chunker in the cascade chunks the raw text, then regenerates the dataset replacing chunks with pseudowords; this process is iterated until no new chunks are found. The separate chunkers in the cas-Text : Mr. Vinken is chairman of Elsevier N.V. Level 1 : Level 2 : Level 3 :
Negra HMM cade are referred to as levels . In our experiments the cascade process took a minimum of 5 levels, and a maximum of 7. All chunkers in the cascade have the same settings in terms of smoothing, the tagset and initialization.
 Evaluation. Table 6 gives the unlabeled PARSE-VAL scores for CCL and the two finite-state models. PRLG achieves the highest F -score for all datasets, and does so by a wide margin for German and Chi-nese. CCL does achieve higher recall for English.
While the first level of constituent analysis has high precision and recall on NPs, the second level often does well finding prepositional phrases (PPs), especially in WSJ; see Table 7. This is illustrated in Fig. 5. This example also illustrates a PP attach-ment error, which are a common problem for these models.

We also evaluate using short  X  10-word or less  X  sentences. That said, we maintain the training/test split from before. Also, making use of the open source implementation by F. Luque, 4 we compare on WSJ and Negra to the constituent context model (CCM) of Klein and Manning (2002). CCM learns to predict a set of brackets over a string (in prac-tice, a string of POS tags) by jointly estimating con-stituent and distituent strings and contexts using an iterative EM-like procedure (though, as noted by Smith and Eisner (2004), CCM is deficient as a gen-erative model). Note that this comparison is method-ologically problematic in two respects. On the one hand, CCM is evaluated using gold standard POS sequences as input, so it receives a major source of supervision not available to the other models. On the other hand, the other models use punctuation as an indicator of constituent boundaries, but all punctu-ation is dropped from the input to CCM. Also, note that CCM performs better when trained on short sen-tences, so here CCM is trained only on the 10-word-or-less subsets of the training datasets. 5
The results from the cascaded PRLG chunker are near or better than the best performance by CCL or CCM in these experiments. These and the full-length parsing results suggest that the cascaded chunker strategy generalizes better to longer sen-tences than does CCL. CCM does very poorly on longer sentences, but does not have the benefit of us-ing punctuation, as do the raw text models; unfortu-nately, further exploration of this trade-off is beyond the scope of this paper. Finally, note that CCM has higher recall, and lower precision, generally, than the raw text models. This is due, in part, to the chart structure used by CCM in the calculation of con-stituent and distituent probabilities: as in CKY pars-ing, the chart structure entails the trees predicted will be binary-branching. CCL and the cascaded models can predict higher-branching constituent structures, so fewer constituents are predicted overall. Up to this point, the proposed models for chunking and parsing use phrasal punctuation as a phrasal sep-arator, like CCL. We now consider how well these models perform in absence of this constraint.
Table 9a provides comparison of the sequence models X  performance on the constituent chunking task without using phrasal punctuation in training and evaluation. The table shows absolute improve-ment ( + ) or decline (  X  ) in precision and recall when phrasal punctuation is removed from the data. The punctuation constraint seems to help the chun-kers some, but not very much; ignoring punctuation seems to improve chunker results for the HMM on Chinese. Overall, the effect of phrasal punctuation on the chunker models X  performance is not clear.
The results for cascaded parsing differ strongly from those for chunking, as Table 9b indicates. Us-ing phrasal punctuation to constrain bracket predic-tion has a larger impact on cascaded parsing re-sults almost across the board. This is not surpris-ing: while performing unsupervised partial parsing from raw text, the sequence models learn two gen-eral patterns: i) they learn to chunk rare sequences, such as named entities, and ii) they learn to chunk high-frequency function words next to lower fre-quency content words, which often correlate with NPs headed by determiners, PPs headed by prepo-sitions and VPs headed by auxiliaries. When these patterns are themselves replaced with pseudowords (see Fig. 4), the models have fewer natural cues to identify constituents. However, within the degrees of freedom allowed by punctuation constraints as described, the chunking models continue to find rel-atively good constituents.

While CCL makes use of phrasal punctuation in previously reported results, the open source imple-mentation allows it to be evaluated without this con-straint. We did so, and report results in Table 9b. CCL is, in fact, very sensitive to phrasal punctu-ation. Comparing CCL to the cascaded chunkers when none of them use punctuation constraints, the cascaded chunkers (both HMMs and PRLGs) out-perform CCL for each evaluation and dataset.
For the CTB dataset, best chunking performance and cascaded parsing performance flips from the HMM to the PRLG. More to the point, the PRLG is actually with worst performing model at the con-stituent chunking task, but the best performing cas-cade parser; also, this model has the most serious degrade in performance when phrasal punctuation is dropped from input. To investigate, we track the performance of the chunkers on the development dataset over iterations of EM. This is illustrated in Fig. 6 with the PRLG model. First of all, Fig. 6a re-veals the average length of the constituents predicted by the PRLG model increases over the course of EM. However, the average constituent chunk length is 2.22. So, the PRLG chunker is predicting con-stituents that are longer than the ones targeted in the constituent chunking task: regardless of whether they are legitimate constituents or not, often they will likely be counted as false positives in this evalu-ation. This is confirmed by observing the constituent chunking precision in Fig. 6b, which peaks when the average predicted constituent length is about the same the actual average length of those in the eval-uation. The question, then, is whether the longer chunks predicted correspond to actual constituents or not. Fig. 6c shows that the PRLG, when con-strained by phrasal punctuation, does continue to improve its constituent prediction accuracy over the course of EM. These correctly predicted constituents are not counted as such in the constituent chunking or base NP evaluations, but they factor directly into improved accuracy when this model is part of a cas-cade. Our task is the unsupervised analogue of chunking (Abney, 1991), popularized by the 1999 and 2000 Conference on Natural Language Learning shared tasks (Tjong et al., 2000). In fact, our models follow Ramshaw and Marcus (1995), treating structure pre-diction as sequence prediction using BIO tagging.
In addition to Seginer X  X  CCL model, the unsu-pervised parsing model of Gao and Suzuki (2003) and Gao et al. (2004) also operates on raw text. Like us, their model gives special treatment to lo-cal constituents, using a language model to char-acterize phrases which are linked via a dependency model. Their output is not evaluated directly using treebanks, but rather applied to several information retrieval problems.

In the supervised realm, Hollingshead et al. (2005) compare context-free parsers with finite-state partial parsing methods. They find that full parsing maintains a number of benefits, in spite of the greater training time required: they can train on less data more effectively than chunkers, and are more robust to shifts in textual domain.

Brants (1999) reports a supervised cascaded chunking strategy for parsing which is strikingly similar to the methods proposed here. In both, Markov models are used in a cascade to predict hi-erarchical constituent structure; and in both, the pa-rameters for the model at each level are estimated independently. There are major differences, though: the models here are learned from raw text with-out tree annotations, using EM to train parameters; Brants X  cascaded Markov models use supervised maximum likelihood estimation. Secondly, between the separate levels of the cascade, we collapse con-stituents into symbols which are treated as tokens in subsequent chunking levels; the Markov models in the higher cascade levels in Brants X  work actu-ally emit constituent structure. A related approach is that of Schuler et al. (2010), who report a su-pervised hierarchical hidden Markov model which uses a right-corner transform. This allows the model to predict more complicated trees with fewer levels than in Brants X  work or this paper. In this paper we have introduced a new subprob-lem of unsupervised parsing: unsupervised partial parsing, or unsupervised chunking. We have pro-posed a model for unsupervised chunking from raw text that is based on standard probabilistic finite-state methods. This model produces better local constituent predictions than the current best unsu-pervised parser, CCL, across datasets in English, German, and Chinese. By extending these proba-bilistic finite-state methods in a cascade, we obtain a general unsupervised parsing model. This model outperforms CCL in PARSEVAL evaluation on En-glish, German, and Chinese.

Like CCL, our models operate from raw (albeit segmented) text, and like it our models decode very quickly; however, unlike CCL, our models are based on standard and well-understood computational lin-guistics technologies (hidden Markov models and related formalisms), and may benefit from new re-search into these core technologies. For instance, our models may be improved by the application of (unsupervised) discriminative learning techniques with features (Berg-Kirkpatrick et al., 2010); or by incorporating topic models and document informa-tion (Griffiths et al., 2005; Moon et al., 2010).
UPPARSE, the software used for the experiments in this paper, is available under an open-source li-cense to facilitate replication and extensions. 6 Acknowledgments. This material is based upon work supported in part by the U. S. Army Research Laboratory and the U. S. Army Research Office un-der grant number W911NF-10-1-0533. Support for the first author was also provided by Mike Hogg En-dowment Fellowship, the Office of Graduate Studies at The University of Texas at Austin.

This paper benefited from discussion in the Natu-ral Language Learning reading group at UT Austin, especially from Collin Bannard, David Beaver, Matthew Lease, Taesun Moon and Ray Mooney. We also thank the three anonymous reviewers for in-sightful questions and helpful comments.
