 The work presented in this paper is aimed at lever-aging a manually created document ontology to model the content of an underlying document col-lection. While the primary usage of ontologies is as a means of organizing and navigating document collections, they can also help in inferring a signif-icant amount of information about the documents attached to them, including path-level, statistical, representations of content, and fine-grained views on the level of specificity of the language used in those documents. Our study focuses on the ontology underlying DMOZ 1 , a popular Web directory. We propose two methods for crystalizing a hierarchical topic model against its hierarchy and show that the resulting models outperform a flat unigram model in its predictive power over held-out data.
To construct our hierarchical topic models, we adopt the mixed membership formalism (Hofmann, 1999; Blei et al., 2010), where a document is rep-resented as a mixture over a set of word multi-nomials. We consider the document hierarchy H (e.g. the DMOZ hierarchy) as a tree where internal nodes (category nodes) and leaf nodes (documents), as well as the edges connecting them, are known a priori . Each node N i in H is mapped to a multi-nomial word distribution Mult N to a leaf node D is associated with a mixture over the multinonials ( Mult C pearing along this path. The mixture components are combined using a mixing proportion vector (  X 
C 0 ... X  C k ) , so that the likelihood of string w be-ing produced by path c d is: where:
In the following, we propose two models that fit in this framework. We describe how they allow the derivation of both p ( w i | c d,j ) and  X  and present early experimental results showing that explicit hierarchi-cal information of content can indeed be used as a basis for content modeling purposes. While several efforts have focused on the DMOZ corpus, often as a reference for Web summarization tasks (Berger and Mittal, 2000; Delort et al., 2003) or Web clustering tasks (Ramage et al., 2009b), very little research has attempted to make use of its hier-archy as is. The work by Sun et al. (2005), where the DMOZ hierarchy is used as a basis for a hierar-chical lexicon, is closest to ours although their con-tribution is not a full-fledged content model, but a selection of highly salient vocabulary for every cat-egory of the hierarchy. The problem considered in this paper is connected to the area of Topic Modeling (Blei and Lafferty, 2009) where the goal is to reduce the surface complexity of text documents by mod-eling them as mixtures over a finite set of topics 2 . While the inferred models are usually flat, in that no explicit relationship exists among topics, more complex, non-parametric, representations have been proposed to elicit the hierarchical structure of vari-ous datasets (Hofmann, 1999; Blei et al., 2010; Li et al., 2007). Our purpose here is more specialized and similar to that of Labeled LDA (Ramage et al., 2009a) or Fixed hLDA (Reisinger and Pa  X sca, 2009) where the set of topics associated with a document is known a priori . In both cases, document labels are mapped to constraints on the set of topics on which the -otherwise unaltered -topic inference algorithm is to be applied. Lastly, while most recent develop-ments have been based on unsupervised data, it is also worth mentioning earlier approaches like Topic Signatures (Lin and Hovy, 2000) where words (or phrases) characteristic of a topic are identified using a statistical test of dependence. Our first model ex-tends this approach to the hierarchical setting, build-ing actual topic models based on the selected vocab-ulary. The assumption that topics are known a-priori al-lows us to extend the concept of Topic Signatures to a hierarchical setting. Lin and Hovy (2000) describe a Topic Signature as a list of words highly correlated with a target concept, and use a  X  2 estimator over labeled data to decide as to the allocation of a word to a topic. Here, the sub-categories of a node corre-spond to the topics. However, since the hierarchy is naturally organized in a generic-to-specific fashion, for each node we select words that have the least dis-criminative power between the node X  X  children. The rationale is that, if a word can discriminate well be-tween one child and all others, then it belongs in that child X  X  node. 3.1 Word Assignment The algorithm proceeds in two phases. In the first phase, the hierarchy tree is traversed in a bottom-up fashion to compile word frequency information un-der each node. In the second phase, the hierarchy is traversed top-down and, at each step, words get assigned to the current node based on whether they can discriminate between the current node X  X  chil-dren. Once a word has been assigned on a given path, it can no longer be assigned to any other node on this path. Thus, within a path, a word always takes on the meaning of the one topic to which it has been assigned.

The discriminative power of a term with respect to node N is formalized based on one of the follow-ing measures:
Entropy of the a posteriori children category dis-tribution for a given w .

Cross-Entropy between the a priori children cat-egory distribution and the a posteriori children cate-gories distribution conditioned on the appearance of w .
  X  2 score , similar to Lin and Hovy (2000) but ap-plied to classification tasks that can involve an ar-bitrary number of (sub-)categories. The number of degrees of freedom of the  X  2 distribution is a func-tion of the number of children.
To identify words exhibiting an unusually low dis-criminative power between the children categories, we assume a gaussian distribution of the score used and select those whose score is at least  X  = 2 stan-dard deviations away from the population mean 3 . Algorithm 1 Generative process for hLLDA 3.2 Topic Definition &amp; Mixing Proportions Based on the final word assignments, we estimate the probability of word w i in topic T k , as: with n C in documents under C k , and n C words in documents under C k .

Given the individual word assignments we eval-uate the mixing proportions using corpus-level esti-mates, which are computed by averaging the mixing proportions of all the training documents. The previous approach, while attractive in its sim-plicity, makes a strong claim that a word can be emitted by at most one node on any given path. A more interesting model might stem from allowing soft word-topic assignments, where any topic on the document X  X  path may emit any word in the vocabu-lary space.
 We consider a modified version of hierarchical LDA (Blei et al., 2010), where the underlying tree structure is known a priori and does not have to be inferred from data. The generative story for this model, which we designate as hierarchical Labeled-LDA (hLLDA), is shown in Algorithm 1. Just as with Fixed Structure LDA 4 (Reisinger and Pa  X sca, 2009), the topics used for inference are, for each document, those found on the path from the hierar-chy root to the document itself. Once the target path c d  X  H is known, the model reduces to LDA over the set of topics comprising c d . Given that the joint distribution p (  X ,z,w | c d ) is intractable (Blei et al., 2003), we use collapsed Gibbs-sampling (Griffiths and Steyvers, 2004) to obtain individual word-level assignments. The probability of assigning w i , the i th word in document d , to the j th topic on path c d , conditioned on all other word assignments, is given by: where n d  X  i,j is the frequency of words from docu-ment d assigned to topic j , n w i  X  i,j is the frequency of word w i in topic j ,  X  and  X  are Dirichlet con-centration parameters for the path-topic and topic-word multinomials respectively, and V is the vocab-ulary size. Equation 7 can be understood as defin-ing the unormalized posterior word-level assignment distribution as the product of the current level mix-ing proportion  X  i and of the current estimate of the word-topic conditional probability p ( w i | z i ) . By re-peatedly resampling from this distribution we ob-tain individual word assignments which in turn al-low us to estimate the topic multinomials and the per-document mixing proportions. Specifically, the topic multinomials are estimated as: while the per-document mixing proportions  X  d can be estimated as: Although we experimented with hyper-parameter learning (Dirichlet concentration parameter  X  ), do-ing so did not significantly impact the final model. The results we report are therefore based on stan-dard values for the hyper-parameters (  X  = 1 and  X  = 0 . 1 ). We compared the predictive power of our model to that of several language models. In every case, we compute the perplexity of the model over the held-out data W = { w 1 ... w n } given the model M and the observed (training) data, namely: 5.1 Data Preprocessing Our experiments focused on the English portion of the DMOZ dataset 5 (about 2.1 million entries). The raw dataset was randomized and divided according to a 98% training (31M words), 1% development (320k words), 1% testing (320k words) split. Gists were tokenized using simple tokenization rules, with no stemming, and were case-normalized. Akin to Berger and Mittal (2000) we mapped numerical to-kens to the NUM placeholder and selected the V = 65535 most frequent words as our vocabulary. Any token outside of this set was mapped to the OOV to-ken. We did not perform any stop-word filtering. 5.2 Reference Models Our reference models consists of several n -gram ( n  X  [1 , 3] ) language models, none of which makes use of the hierarchical information available from the corpus. Under these models, the probability of a given string is given by: We used the SRILM toolkit (Stolcke, 2002), en-abling Kneser-Ney smoothing with default param-eters.

Note that an interesting model to include here would have been one that jointly infers a hierarchy of topics as well as the topics that comprise it, much like the regular hierarchical LDA algorithm (Blei et al., 2010). While we did not perform this experiment as part of this work, this is definitely an avenue for future work. We are especially interested in seeing whether an automatically inferred hierarchy of top-ics would fundamentally differ from the manually-curated hierarchy used by DMOZ. 5.3 Experimental Results The perplexities obtained for the hierarchical and n-gram models are reported in Table 1.
When taken on the entire hierarchy ( all ), the per-formance of the Bayesian and entropy-based mod-els significantly exceeds that of the 1-gram model (significant under paired t-test, both with p-value &lt; 2 . 2  X  10  X  16 ) while remaining well below that of ei-ther the 2 or 3 gram models. This suggests that, al-though the hierarchy plays a key role in the appear-ance of content in DMOZ gists, word context is also a key factor that needs to be taken into account: the two families of models we propose are based on the bag-of-word assumption and, by design, assume that words are drawn i.i.d. from an underlying distribu-tion. While it is not clear how one could extend the information-theoretic models to include such con-text, we are currently investigating enhancements to the hLLDA model along the lines of the approach proposed in Wallach (2006).

A second area of analysis is to compare the per-formance of the various models on the entire hier-archy versus on the non-Regional portion of the tree ( reg ). We can see that the perplexity of the proposed models decreases while that of the flat n-grams mod-els increase. Since the non-Regional portion of the DMOZ hierarchy is organized more consistently in a semantic fashion 6 , we believe this reflects the abil-ity of the hierarchical models to take advantage of the corpus structure to represent the content of the summaries. On the other hand, the Regional por-tion of the dataset seems to contribute a significant amount of noise to the hierarchy, leading to a loss in performance for those models.

We can observe that while hLLDA outperforms all information-theoretical models when applied to the entire DMOZ corpus, it falls behind the entropy-based model when restricted to the non-regional section of the corpus. Also if the reduction in perplexity remains limited for the entropy,  X  2 and hLLDA models, the cross-entropy based model in-curs a more significant boost in performance when applied to the more semantically-organized portion of the corpus. The reason behind such disparity in behavior is not clear and we plan on investigating this issue as part of our future work.
 Further analyzing the impact of the respective DMOZ sub-sections, we show in Figure 1 re-sults for the hierarchical and 1-gram models when trained and tested over the 14 main sub-trees of the hierarchy. Our intuition is that differences in the organization of those sub-trees might af-fect the predictive power of the various mod-els. Looking at sub-trees we can see that the trend is the same for most of them, with the best level of perplexity being achieved by the hierar-chical Bayesian model, closely followed by the information-theoretical model using entropy as its selection criterion. In this paper we have demonstrated the creation of a topic-model of Web summaries using the hierarchy of a popular Web directory. This hierarchy provides a backbone around which we crystalize hierarchical topic models. Individual topics exhibit increasing specificity as one goes down a path in the tree. While we focused on Web summaries, this model can be readily adapted to any Web-related content that can be seen as a mixture of the component topics appear-ing along a paths in the hierarchy. Such model can become a key resource for the fine-grained distinc-tion between generic and specific elements of lan-guage in a large, heterogenous corpus.
 This material is based on research supported in part by the U.S. National Science Foundation (NSF) un-der IIS-05-34871. Any opinions, findings and con-clusions or recommendations expressed in this ma-terial are those of the authors and do not necessarily reflect the views of the NSF.
