 1. Introduction
The interest in cognitive radio networks has increased sharply in the last few years, not only because of their efficient spectrum usage and sharing, but also due to the variety of optimization problems related to the efficient exploitation of radio resources. One of such paradigms arises in multicarrier orthogonal fre-quency division multiplexing (OFDM) communications, which support high-rate data transmissions and enhanced robustness over frequency-selective fading channels. When utilized in a multiple-user scenario, OFDM multiple access (coined as OFDMA, Yin and Alamouti, 2006 ) allows a number of users to employ different subcarriers for transmission which, if properly configured, entails an increased efficiency of the available spec-trum and/or power resources. On this purpose, adaptive subcar-rier and power 1 allocation algorithms based on a certain optimization criteria must be derived and applied to this setup.
In this context, when K users transmit information to K distant receivers through an OFDMA downlink, maximizing the overall throughput of the system is solved by allocating each subcarrier to the user with the highest corresponding channel gain, followed by a power distribution based on the well-known water-filling algorithm ( Cheng and Verdu  X  , 1993 ). However, when imposing additional constraints such as maximum and/or minimum rates per user, the resulting optimization problem lacks of any analy-tical solution. As a workaround to solve this issue, most of the related literature has resorted to heuristic algorithms in order to obtain near-optimum but feasible solutions at an affordable computational effort. As such, intense research activity has been lately conducted towards the application of well-known evolu-tionary approaches (e.g. genetic algorithm, Chen and Wyglinski, 2009; Illanko et al., 2009; Teng et al., 2009; Tang et al., 2008 , particle swarm optimization, Ahmed and Majumder, 2008; Gheitanchi et al., 2007 and ant colony optimization, Ahmadi and
Chew, 2010 ) to the allocation of radio resources in OFDMA downlinks.

In this manuscript we take a step further by extending the above scenario  X  consisting of a K -user OFDMA downlink subject to per-user rate constraints  X  with a secondary OFDMA transmission to the K distant receivers. Coexistence of primary and secondary users is permitted at a given frequency subchannel. More stringent rate constraints are also imposed to the secondary transmitter in order to minimize the excess interference at the primary OFDMA downlink, since secondary users are in general granted less transmission bandwidth than their primary count erparts. The proper selection of these rate limits, jointly with the aforementioned spectral coexis-tence, lay the basis for a cognitive radio setup. To efficiently perform power and subcarrier allocation in this cognitive scheme, we propose an iterative algorithm based on hybridizing the harmony search (HS) and differential evolution (DE) heuristics, similarly to other recently reported hybrid approaches, see e.g. Yildiz (2009a,b) and Yildiz et al. (2007) . Our approach also incorporat es a greedy procedure to account for the feasibility of the generated solutions. At this point it is important to remark that, although a recent contribution ( Weyland, 2010 ) has shown that HS is a special case of the so-called evolu-tionary strategy with common mutation, recombination and selection operators, for the sake of conformity with the previous literature we will hereafter adopt the terminology HS for referring to part of the hybrid algorithm proposed herein. Computer simulations performed for the extended vehicular A ITU channel model show that the proposed method is capable of efficiently maximizing the overall throughput of both base stations while simultaneously satisfying the rate constraints. To the authors X  knowledge, this is the first contribu-tion dealing with the application of the aforementioned hybrid evolutionary techniques to this part icular rate-constrained cognitive radio OFDMA scenario.
 on the system model and poses the underlying resource allocation optimization problem. Section 3 details the proposed hybrid HS-DE algorithmic approach, along with the greedy repair method. Section 4 discusses the obtained simulation results, and finally, Section 5 ends the paper by drawing some concluding remarks. 2. System model depicted in Fig. 1 . A primary base station (PBS) transmits information from K users to K different destinations through a
OFDMA link with N equispaced subchannels, central frequency f , overall transmission bandwidth B and total transmit power P .

Only one user is allowed to occupy each subchannel at the PBS. In this scenario a secondary BS (SBS) sends data from another set of K users to the same K destinations by establishing a secondary
OFDMA downlink with identical bandwidth support [ f c B /2, f c + B /2], same number of subcarriers N and total transmit power
P U T . As assumed for the PBS, the SBS allocates only one user to each subcarrier, but simultaneous coexistence of a primary and a secondary user is permitted at a given spectrum subchannel.
Let h L , k n (respectively, h U , k n ) denote the channel gain experienced by the k -th primary (respectively, secondary) user in subcarrier n A f 1 , ... , N g . Note that we will hereafter utilize subindices L and U for those system parameters corresponding to the PBS and the SBS, respectively. Following this notation, let P L n (respectively, P be the power assigned to subcarrier n at the PBS (respectively,
SBS). By defining the user index to which the n -th subcarrier is allocated at the PBS as O n L A f 1 , ... , K g , and assuming Gaussian signalling at the SBS, the theoretical maximum rate delivered by the PBS to the k -th destination is given by Shannon (1948) R where D f 9 B = N , and N 0 represents the power spectral density of the additive white Gaussian noise assumed at each receiver frontend. Observe that as often assumed in most related works (e.g. see Wang and Vandendorpe, 2010 and references therein), the interference of the secondary base station is included in the above expression as an additive Gaussian noise in the correspond-ing subchannel. Also note that a similar expression can be obtained for the theoretical rate of SBS by simply substituting L for U in the above formula. Our rate-constrained optimization problem can be then formulated as follows: Maximize subject to
R  X  R
U , k , R max U , k ) represent lower and upper bounds on the maximum rate of user k in the PBS (respectively, SBS) OFDMA downlink. Therefore, we are interested in finding the optimum power and subcarrier allocation policies at both primary and secondary base stations such that the overall throughput of the setup is max-imized and the imposed rate constraints are fulfilled. Note that no control on the total transmission power P L T and P U T is considered, so base stations are assumed to operate always at maximum transmit power. Perfect channel state information (CSI) is assumed to be known for the allocation algorithm next described. 3. Proposed joint subcarrier and power allocation heuristic 3.1. Hybrid HS-DE procedure
To efficiently tackle the above optimization problem, we propose a novel hybrid heuristic technique inspired in the so-called harmony search (HS) algorithm. Since its derivation by Geem et al. (2001) , this algorithm and other related variants (e.g. Geem, 2008; Geem and Sim, 2010; Das et al., 2010 ) have been shown to outperform other combinatorial heuristics for a wide spectrum of optimization problems such as the design of water pipelines ( Geem, 2006 ), vehicle routing ( Geem et al., 2005 ) and scheduling of multiple dam systems ( Geem, 2007 ). Regarding its application to communication-related scenarios, very scarce references can be found. There can be found some contributions dealing with CDMA multiuser detection ( Zhang and Hanzo, 2009 ), multicast routing ( Forsati et al., 2008 ), distributed dynamic spectrum channel allocation in single-carrier networks ( Del Ser et al., 2010 ), or the so-called switch location problem (SLP, Gil-Lopez et al., 2010 ), in the majority of cases with similar promising performance with respect to other evolutionary alternatives.
As mentioned in the previous section, our proposed scheme seeks the optimum user-to-subcarrier mappings f X L , X U allocated power distributions { P L , P U } that maximize the overall throughput metric in expression (2). To this end, the algorithm iterates on a set of M candidate solutions f SOL  X  m  X g M X and evaluated in terms of both the aforementioned overall throughput and the fulfillment of the imposed per-user rate constraints. Note that the refinement of the user-to-subcarrier mappings X L  X  m  X  and X U  X  m  X  entails a discrete-variable optimiza-tion problem which can be tackled by means of the original HS algorithm, i.e. by means of two different operational processes: the harmony memory considering rate (HMCR), which is driven by the probabilistic parameter y A  X  0 , 1 , and the pitch adjusting rate (PAR), which is controlled by W A  X  0 , 1 . Such processes are defined as follows:
HMCR: the corresponding parameter y establishes the prob-ability that the new allocated user to a given subcarrier is uniformly drawn from the values of the same subcarrier allocation taken in all the other M 1 candidate solutions, e.g. y  X  Pr f O n L  X  m  X  X  o g , where o is a discrete random vari-able uniformly distributed in the set f O n L  X  1  X  , ... , O O n L  X  m  X  1  X  , ... , O n L  X  M  X g , with m A f 1 , ... , M g .
PAR: the real-valued parameter W sets the probability that the new value of a given subcarrier allocation O n L  X  m  X  is picked from its neighboring values in the alphabet {1, y , K } sorted in increasing order of the power of the corresponding downlink channel gain j h n L , k j 2 . The rationale behind sorting the alphabet as a function of the channel gain lies on the fact that, in the absence of interference and rate constraints, the subcarrier allocation that maximizes the throughput reduces to find the user with highest channel gain at every frequency subchannel. On the other hand, for the allocation of the overall power budget P
T and P U T along subcarriers (i.e. the refinement of P L P ( m ), the HMCR procedure works analogously to the subcarrier allocation case, i.e. the power allocated to a certain subcarrier evolves based on y and the values taken by such allocated power among the M candidates. However, a different strategy is adopted for the PAR process by utilizing a differential evolution (DE) approach ( Storn and Price, 1997 ). As such, every time the PAR process is to be applied on the power allocated to a certain subcarrier, say P L n ( m ), its new refined value, hereafter denoted by the hat superscript (e.g. ^ P n L  X  m  X  ), is computed as ^
P  X  m  X  X  where G A R  X  , and x is a realization of a continuous random variable X following an arbitrary probability density distribution f  X  x  X  with support  X 1 ,  X 1 X  (further details are provided in Section 4). Observe that in order to satisfy the power budget available at each base station, the entries of every newly gener-ated power allocation candidate ^ P L  X  m  X  9 f ^ P n L  X  m  X g tively, ^ P U  X  m  X  ) are normalized to sum P L T (respectively, P P size that, although the power budget in expression (3) is satisfied by this particular hybrid procedure, an additional greedy algo-rithm is required so as to account for the imposed rate con-straints, which is later explained in Section 3.2.
 The evaluation of the fitness for each generated candidate
SOL ( m ) is performed hierarchically in two separated steps. A first metric RC  X  X  for checking the rate compliancy of each generated candidate is built by computing its associated per-user rates R ( m ) and R U , k ( m ) based on expression (1), and by sequentially comparing the obtained rates with the corresponding rate con-RC  X  SOL  X  m  X  X  9 where m A f 1 , ... , M g and I  X  X  denotes an indicator function taking value 1 if its argument is true and 0 otherwise. Observe that this metric is upper bounded by 1, value corresponding to a fully rate-compliant proposed candidate. Once RC  X  X  is computed for all the newly generated M candidates, they are sorted in decreasing order of their metric value. Then, the evaluation of the overall throughput metric R T in expression (2) permits to sort  X  again in decreasing order  X  those candidates sharing the same value of
RC  X  X  . Based on this adopted strategy, the proposed algorithm grants priority to those candidates fulfilling as many rate con-straints as possible, whereas the maximization of the overall throughput R T is the criteria to sort candidates with identical rate compliancy. Note that for calculating the overall throughput metric R T , perfect channel state information (CSI) is assumed to be available for the proposed algorithm, which is next described in detail. 3.2. Greedy frequency reallocation procedure
Regarding the optimization problem posed in expres-sions (2) X (4), note that the iteratively generated candidate solu-tions must fulfill the imposed rate constraints f R min L , k , R max U , k g K k  X  1 . On this purpose, the proposed resource allocation scheme incorporates a greedy subcarrier reallocation procedure that attempts to iteratively repair the set of already built candidates f SOL  X  m  X g M m  X  1 . Despite the simplicity of this local search method, it turns out to be an effective repairing technique at a reduced computational cost for the optimization problem at hand.
 which are sequentially applied to each proposed solution SOL ( m ), with m A f 1 , ... , M g . The first two steps handle those candidate solutions that violate any of the imposed lower rate constraints for either the primary (step 1) or the secondary base station (step 2). In both steps the greedy algorithm works in a similar fashion: once the set of users violating their lower rate constraint has been identified, the algorithm reassigns subcarriers from the best user (i.e. the user with highest rate margin above its upper limit) to such under-rated users. On the other hand, steps 3 and 4 of the greedy procedure handles candidate solutions whose any of the associated rates per user is above its corresponding upper con-straint. In this case, subcarriers allotted to such over-rated users are reassigned to the user with lowest rate margin in the candidate solution at hand. These four steps are sequentially applied to the M candidate solutions f SOL  X  m  X g M m  X  1 imum of I g iterations.
 channels associated to user k A f 1 , ... , K g at the primary base station, i.e. n belongs to N k L if O n L  X  k . With this definition, the first step of the proposed greedy repair technique is described as: sponding channel gain j h n L , k j 2 , with n A N k L . This produces the sorted set ~ N k L .
 subchannel in ~ N k L to under-rated user k by setting the associated entry of X L to k . Once this is done, delete such first subchannel from the set ~ N k L . This is repeated until all under-rated users have been processed or the set ~ N k L has been emptied.
 secondary base station by replacing L with U in the above sequence of operations. As for the repair of over-rated candidate solutions (steps 3 and 4), the procedure works as follows: ing set N k L in decreasing order of the corresponding channel gain reallocated to the worst user k D by setting the associated entry of
X L to k D . This is repeated until all over-rated users have been processed.
 dures essentially hinge on a similar subcarrier exchanging policy based on the imposed minimum and maximum rate constraints.
Although this approach would intuitively be outperformed by a combined power and subcarrier reallocation technique, the pro-posed greedy method suffices for achieving a satisfactory statis-tical performance at a very reduced penalty in computational load, as the simulation results clearly shown in Section 4. resource allocation algorithm, the resulting operational thread  X  along with the parameters driving the behavior of the underlying heuristic hybrid search procedure  X  is described in Fig. 2 . 4. Simulation results
In order to assess the performance of the proposed algorithm, three sets of simulations have been carried out by considering: (1) a single-base-station scenario in the absence of rate constraints; (2) a single-base-station scenario with r ate constraints set beforehand; and (3) a cognitive two-base-stations OFDMA downlink scenario includ-ing per-user rate constraints. 2 Note that the optimum resource allocation is known for the first scenario (i.e. best-user subcarrier allocation followed by classical water-filling), thus it allows verifying the behavior of the algorithm in a well-known setup. All simulations have been executed on a Core 2 processor running at 2.66 GHz with 3.45 Gb of available RAM memory. The algorithm (with no particular optimization for speed or memory usage) has been implemented in Matlab s R2010a running under Windows s XP.

Let us first concentrate on the first simulated system, consist-ing of K  X  10 users utilizing N  X  30 subcarriers equispaced on a bandwidth of B  X  1.5 MHz around the central frequency f  X  2.1 GHz. The total power of the single base station is set to 1 W, whereas the OFDMA symbol time is fixed to 66 : 67 m s. The extended vehicular A ITU channel model ( ITU-R Recommendation
M.1225, 1997 ) has been selected, which specifies a Doppler frequency of 70 Hz (corresponding to a relative speed of 36 Km/h) and a r.m.s. delay spread of 357 ns. The noise spectral density N kept fixed to 30 dBm. As for the parameters of the proposed hybrid allocation algorithm, the size of the pool of iteratively refined candidate solutions and the maximum number of iterations are set to M  X  80 and I  X  150. As mentioned before, no rate constraint will be imposed, thus the greedy method in Section 3.2 will not be required in this first simulation set. A logarithmic progression is further established on the probabilistic parameters y and W controlling the HMCR and PAR refining processes. The reason for this is that we have found that this progression enhances both the convergence speed of the heuristic algorithm and the quality of the provided solution. If i denotes iteration index and subindices s and e stands for starting and ending values of the parameter at hand, such progression is given, for i A f 1 , ... , I g and the HMCR parameter, by y  X  i  X  X  y s 1 O  X  y s , y e  X  log  X  i 1  X  l  X  y convexity of y  X  t  X  in the range  X  y s , y e , O  X  y s , y e  X  9 sgn  X  y s y e  X  ,  X  8  X  l  X  y , y e , z  X  9 O  X  y s , y e  X  1 and sgn( x )  X  +1if x Z 0and 1 otherwise. Observe that once starting and ending values have been set, the convexity of the parameter at hand is exclusively controlled through the real-valued parameter z ,as exemplified in Fig. 3 a. Based on this definition and on a preliminary simulation-based study (not shown for the sake of brevity), the simulations presented heretofore utilize f y s , y allocation over subcarriers given in expression (5) is driven by G  X  1 and f distribution 3 with location and scale parameters equal to 0 and $ respectively. The reason behind selecting the Le  X  vy distribution for f  X  x  X  lies on the fact that the proposed algorithm for power allocation essentially hybridizes harmony search with a random walk procedure, for which escaping fr om local optima through the PAR randomization of each candidate P L n ( m ) (respectively, P critical. On this purpose, it is important to note that the Le  X  vy distribution has an infinite mean and infinite variance with a heavy tail, which may generate any differential step size. 4 throughput R T  X  averaged over 50 executions of the algorithm over a fixed realization of the extended vehicular A ITU channel model  X  as a function of the iteration index i and the candidate memory size M A f 2 , 5 , 10 , 20 , 40 , 80 , 100 g . The maximum achiev-able throughput is also included as an horizontal asymptote for comparison. The obtained average computation times per execution of the algorithm are 3.66 ( M  X  2), 8.77 ( M  X  5), 17.37 ( M  X  10), 36.99 ( M  X  20), 80.34 ( M  X  40), 194.69 ( M  X  80) and 265.41 s ( M  X  100). Observe that the higher M is, the better the algorithm behaves with respect to the aforementioned maximum throughput. However, for M  X  100 the improvement in perfor-mance with respect to M  X  80 is outgained by the associated increase in computational load. Based on this observation, M will be hereafter set to 80.

In order to address the second simulated scenario, rate con-straints are added to the above setup. Specifically, the first K /2 users will have a minimum rate constraint fixed to 5% of the maximum overall achievable throughput in the absence of rate constraints, whereas the rate associated to the other K /2 users will be lower bounded by 1% of the aforementioned overall throughput. On the other hand, the maximum rate per user is kept fixed to 10% for the first K /2 users and 2% for the last K /2 users. Notice that since no secondary base station is considered at this point, the rate-compliancy metric RC  X  X  reduces to RC  X  SOL  X  m  X  X  9
It is also important to note that in this case the fulfillment of the imposed rate constraints depends roughly on the available power and the set of channel gains derived from the realization of the ITU channel model. Therefore, it is not possible to guarantee that a feasible solution exists for a set of per-user rate constraints and a given channel realization. Neve rtheless, the proposed algorithm attempts to find such power and subcarrier allocation vectors with higher rate compliancy and, seconda rily, with higher overall through-put. To this end, the greedy repair method detailed in Section 3.2 is applied for I g  X  10 iterations. The rest of parameters defining the communication scenario and the proposed algorithm are kept the same as in the first simulated case.

The simulation results for this second study are summarized in Figs. 4 a and b. In the first plot, the evolution of RC ( SOL (1)) and the overall throughput R T defined in expression (2)  X  both averaged over 50 executions of the algorithm over a realization of the ITU channel model  X  is plotted as a function of the iteration index. Also are included dashed lines corresponding to the 95% confidence interval for the obtained results as a means to indicate the reliability oftheestimatefortheaverageperfor mance. This reliability is further guaranteed based on the results of a t-test with 49 degrees of freedom over the obtained results, which renders a p -value of 1 at all iterations. First observe that as opposed to the strict increasing behavior of the rate compliancy metric (upper plot), the overall throughput metric R T degrades in the first few iterations. The reason being that the criteria of the proposed algorithm is to prioritize the fulfillment of the imposed rate constraints over the maximization of the sum-rate metric. It is also interesting to observe that the value of the rate-compliancy metric RC  X  X  gets very close to its maximum value 1 in the first iteration, which evidences the good performance of the proposed greedy repair approach even if it is applied on candidate solutions generated at random. On the other hand, in Fig. 4 b observe that the obtained allocated rates per user R utilizing the proposed scheme (light gray bars) do meet all the imposed rate constraints, as opposed to the rate allocation based on maximum channel gain and water-filling (dark gray bars), which is optimum in the absence of constraints. As for the average computa-tion time per execution of the algorithm, its value increases up to 380.87 s (2.54 s per iteration on average), mainly due to the incor-poration of the greedy repair approach to the algorithm thread. scenario, which is composed of the dual-base-station scenario thor-oughly described in Section 2. Ou tputpowerissetto1Wforboth primary ( P L T ) and secondary ( P U T ) base stations, whereas rate con-straints  X  relative to the theoretical maximum sum-rate achievable at each OFDMA downlink in the abse nce of interferences and rate constraints  X  are defined in Table 1 . The values for all the operational parameters of the proposed allocat ion procedure are kept identical to those of the second simulation set, except for the maximum number of iterations I  X  300.Theratecompliancymetric RC  X  X  is now determined by expression (6). Analogous to the previously discussed results, Figs. 5 a and b summarize the obtained results by averaging over 50 executions of the algorithm over a realization of the extended vehicular A ITU vehicular channel model. In this case, the average computation time augmentates to 751.13 s (approximately 5 s per iteration) due to the greedy repair procedure operating twice on this dual base station setup. Similar conclusions hold for this third scenario; both the rate compliancy ( Fig. 5 a, top) and the overall throughput metric ( Fig. 5 a, bottom) are simultaneously maximized, whereas the average rates per user are kept within the imposed rate limitsatbothPBSandSBS( Fig. 5 b). 5. Concluding remarks allocation algorithm for cognitive OFDMA networks where both a primary and a secondary base st ations communicate with a set of K distant destinations subject to per-user rate constraints. The proposed heuristic hybridizes subcarrier assignment based on the harmony search algorithm with power allocation based on a differential evolution approach. Fulfillment of the imposed rate bounds per user is performed via a greedy subcarrier exchange technique. The performance of the scheme is asse ssed through extensive computer simulations performed over extended vehicular ITU channel models, based on which it is concluded that t he proposed heuristic allocates subcarriers and power under rate constraints in a cost-efficient fashion.
 Acknowledgments
Science and Innovation through the CONSOLIDER-INGENIO 2010 (CSD200800010) and the Torres-Quevedo (PTQ-09-01-00740,
PTQ-06-01-0159) funding programs, as well as by the Academy of Finland through the SMAS project (decision number 134624). Appendix A. Supplementary data
Supplementary data associated with this article can be found in the online version at doi: 10.1016/j.engappai.2011.02.005 . References
