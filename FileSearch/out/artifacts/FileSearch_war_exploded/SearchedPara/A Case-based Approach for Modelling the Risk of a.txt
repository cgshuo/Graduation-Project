 Fatigue driving has already become a leading factor contributing to traffic crashes around the world [47]. In China, fatigue driving caused 887 (9.26%) of all highway crashes in 2011, resulting in 520 (8.1%) deaths and over RMB 37 million (10.82%) property losses [42]. To decrease the occurrences of traffic crashes and promote road safety, studying drivers X  decision on driving under fatigue condition is urgent. Despite the substantial work in the domain of transportation science by both the industry and academia, there are few studies in applying case-based reasoning approach to modelling the risk of a driver being involved in a fatigue-related crash.
 science and artificial intelligence [30], it makes use of the most similar previous cases to solve new problems [30, 28, 25]. Since the early 1980s, CBR methodology has been successfully applied in various fields such as legal reasoning [39, 5, 6, 44], planning [26, 13, 23, 14, 32], E-commerce [38, 17], medical diagnosis [4, 18, 8, 37], and risk analysis [33, 22]. CBR is the best fit for modelling the risk of a driver being involved in a fatigue-related crash because of its ability to simultaneously process a large number of highly interrelated variables to arrive at a decision [19, 12]. Moreover, CBR models have sig-nificant merits as compared to statistical ones ( e.g. , the widely employed matched case-control logistic regression [2, 29]) regarding the comprehensibility of output [12]. drivers X  potential risky behaviours like fatigued driving based on past similar conditions considering not only personal but both vehicle and environmental characteristics. This research studies the risk of fatigued driving using a database of 16,459 traffic crashes reported from 21 cities in Guangdong province, China from 2006 to 2010. We will show that by using CBR, drivers X  risk of being involved in a fatigue-related crash are well predicted, and there are prospects of embedding a component of driver fatigue detection into the intelligent transportation systems based on our research. the literature. Section 3 describes the methodology. Section 4 presents the case study and empirical evaluation of our approach. Section 5 concludes the study. In recent years, there had been an increase in uptake of CBR concepts in the research area of traffic control and management. For instance, based on spatio-temporal flow data attributes, Jagannathan et al. [21] developed a CBR prediction system that is ca-pable of differentiating between the accident and non-accident cases. Mounce et al. [34] designed a CBR system to help intelligent selection of signal timing plans, with particular application in the city of York. Kofod-Petersen et al. [24] presented a pro-totype implementation of a CBR system that predicts traffic flow and calculates signal plans for urban intersections. A CBR method that supports modelling both the vehicle control behaviour and the skill proficiency of teen drivers by using data collected in a high-fidelity driving simulator was developed by Onta  X  n  X  on et al. [35]. To the best of our knowledge, this study first applies CBR in dealing with driver fatigue management. related to a combination of situational and individual factors. The increased risk may result from a mix of biological, personal, road and environmental related factors [27]. Previous studies on detecting driver X  X  state of fatigue have used various visual indicators ( e.g. , face images and eye state [11, 16, 9]), entropy-based features ( e.g. , EEG signals [45]) and driving behaviours ( e.g. , accelerate, brake, shift and steer [20]). However, few of them considered driver X  X  personal and environmental features that are fundamental towards drivers X  intention to drive under fatigue condition. By employing CBR in this research, the risk of a new driver being involved in a fatigue-related crash is modelled based on past similar circumstances considering not only personal but both vehicle and environmental characteristics. To model the risk of fatigued driving, in a spirit of [25, 31], we propose a case-based system that consists of three main components: representation module, retrieve module, and reuse module. Figure 1 shows a schematic overview of the system architecture. The proposed system receives traffic information, through the representation module , a target case C t and a case-base C are constructed based on such information. The retrieve module retrieves the most similar previous case from the case-base, and reuse module further manipulates the retrieved cases for the best outcome of the target case. 3.1 Case Representation A case in the system represents a previous traffic situation [31], and it is composed of a case number, a case description, and a case outcome. Formally, a case can be represented as follows:  X  Case C =  X  CN; CD; CO  X  , where, categories of attributes are needed to describe the case. The first category contains the demographic information of the driver. The second category describes the vehicle infor-mation. The third category consists of the attributes describing the traffic road situation. The fourth category contains some environmental factors such as the weather situation. Thus, we have:  X  Case description CD =  X  DD; V I; R; E  X  , where, 3.2 Case Retrieval and Reuse The crucial part of the retrieval module is the similarity measure, which calculates the similarity between the target case and the cases in the case-base [21]. For each target case, the similarity between the target case and the cases in the case-base is measured using the K-nearest neighbour (KNN) algorithm [10], where K refers to the number of neighbours. The KNN algorithm, widely used in classification problems to assign objects to classes, matches each attribute in the target case to its corresponding attribute in the retrieved case [21]. Given a case description of the target case CD t and that of a case in the case-base CD c , the similarity between both cases is measured by calculating the Euclidean distance between them, i.e. , where CD t;a is the normalised value of attribute a 2 DD; V I; R; E in the target case and CD c;a is the normalised value of attribute a in the case from the case base. tained by a majority vote of its K nearest neighbours, i.e. , the most common outcome of the retrieved cases are assigned to the target case. In this study, we use the traffic crash data for the period 2006-2010 in Guangdong Province, China. These data are extracted from the Traffic Management Sector-Specific Incident Case Data Report, the Road Traffic Accident Database of Chinas Public Se-curity Department. They are the only officially available source of traffic crash data in China. Data are recorded and reported by the traffic police on-scene who conducted assessments and provided feedback immediately to the headquarters of the Traffic Man-agement Department. These reports include characteristics of drivers, vehicle features, road conditions, the time of crashes, the environmental context for each crash and the cause of crashes such as traffic violations like driving under fatigue condition [46]. system in which each of the samples in our datasets was a case, whose structure is shown in Table 1. All the attributes are selected based on the work of Zhang et al. [47] in which the same database was used and the links between those attributes and fatigued driving were described. When a target case is given to the system, the system retrieves the most similar case(s) in the case base to the target case to have the best prediction. 4.1 Evaluation Settings To evaluate our proposed case-based prediction system of drivers X  risk of being involved in a fatigue-related crash, the data set was partitioned into a training set and a test set. To be aligned with the literature ( e.g. , [3]), we varied the percentage of the training and test data to study the possible variations of performance based on different partitions. In particular, ratios 10:90, 30:70, 50:50, 70:30 and 90:10 were used as the portions of training and test data. Each case in the test set was consecutively made the target case with the cases in the training set constituting the case-base. For each portion of training and test data, KNN algorithms with different numbers of K were run. Ties may occur in a binary classification problem if K &gt; 1 , to avoid ties, the most similar case ( K = 1 ), the three most similar cases ( K = 3 ), and the five most similar cases ( K = 5 ) were retrieved in the current study. In comparison, the widely employed logistic regression was also conducted for each partition. The dependent variable indicated the occurrence of driving under fatigue condition in a crash, while the independent variables under consideration were the same as the CBR setting. different ways. Typically, the models X  predictive performances are measured regard-ing overall accuracy , e.g. , the percentage of fatigued-driving and non-fatigued-driving classified accurately in the current research [15]. However, other measures like the true positive rate (TPR, also called recall or sensitivity) tends to be the key concern when infrequent events (as fatigued driving in the current study) are to be predicted [43]. Complementary to TPR that measures the proportion of positives that are correctly identified as such, another primary evaluator is the false positive rate (FPR, also known as fall-out or false alarm ratio) that calculates the ratio of negatives wrongly categorised as positive. Based on pairs of TPR and FPR, a receiver operating characteristic (ROC) curve could be obtained to compare the performance of different models. We calculate the area under the ROC curve based on the work of Cantor and Kattan [7]. 4.2 Results and Discussion The available data set contained 16,459 traffic crashes, of which 384 (2.33%) were fatigued-related. Among all the fatigued-related crashes, 99% of drivers were male, 88% of them had more than two years of driving experience, and 72.4% came from ur-ban areas. Drivers that were involved in fatigued-related crashes included self-employed workers (23.7%), migrant workers (18.5%), farmers (17%), clerks (8%), and employ-ees from other professions (32.8%). Concerning vehicle information, trucks and mo-torcycles constituted 56% and 16.7%, respectively. For road situation, 65.9% of these fatigued-related crashes occurred in separate lanes, and 38% occurred in express way. Considering environmental features, 51.8% of the fatigued-related crashes occurred from midnight to dawn (00:0006:59), 38% took place at daytime, and 22.6% occurred under adverse weather conditions. Seasonal distribution of the fatigue-related crashes: 32.3%, 26.3%, 24.7%, and 16.7% occurred in the summer, winter, spring, and fall, re-spectively.
 ulations. In overall, all simulations received very high accuracy in modelling fatigued driving, i.e. , more than 96 percent. For most simulations, the accuracy increased dra-matically when 70% of the data set was used for training, except that for simulation of K=5, the accuracy declined. Logistic regression (LR) had a better performance in comparison to the proposed CBR system no matter what the value of K for most train-ing/test partitions. But interestingly, we found that when 70% or above of the data set was used for training, the CBR system with K=3 had higher accuracy than LR.
 simulations. In all scenarios, we observed that the false positive rate is nearly zero, indicating that both LR and the proposed CBR system have excellent performance in correctly identifying non-fatigued-driving cases. However, LR received zero true pos-itive rate (TPR) for all the training/test partitions. Recall that TPR reflects the hits of fatigued driving reality. In such circumstances, although LR got very high accuracy and very low false positive rate, it is meaningless [43]. In contrast, the proposed CBR sys-tem with K=1 or K=3 had shown their merits by receiving non-zero sensitivity values in all the training/test partitions. It is worth noting that the simulation of K=1 obtained 26 percent TPR when 70% of the data set was used for training.
 of each simulation. In comparison to LR, the proposed CBR system no matter what the value of K had better performance in modelling the risk of a driver being involved in a crash. Simulation of K=1 outperformed the rest as the percentage ratio of the training and test data were varied.
 that with K=3 have their strengths in modelling fatigued driving. To further differentiate them, we calculated the precision values in various partitions of training and test data. Precision measures the probability that a driver with a positive screening test indeed is involved in a fatigued-related crash. As shown in Fig. 4, when 10% of the data set were used for training, the K=1 model had higher precision value, whereas the K=3 model had better performance when more than 10 percent were used for training. Further empirical validation is required to study the optimal value of K for modelling fatigued driving. 4.3 Further Implications Fatigue-related crashes are one of the major threats to road safety worldwide. The im-portant implication of our research is: if driving under fatigue condition could be re-duced or controlled successfully through the early detection, the occurrences of a crash would be reduced accordingly. When designing road traffic interventions to decrease incidences, it is well established that a change in the driver X  X  attitude is of utmost im-portance. The outcome of our proposed CBR system can help targeting the group of drivers that may have an intention to drive under fatigue condition. In particular, our proposed CBR system can highlight the important features of such group of drivers in the aspects of various personal, vehicle, road, and environmental conditions. Specific countermeasures by integrating these highlighted features into a driver fatigue detec-tion component of the intelligent transportation systems will be effective in improving traffic safety [36].
 China because the crash data in Guangdong Province and features considered are rather representative and comprehensive. The fact that Guangdong has a high percentage of residents migrating from other provinces, and is having one of the largest numbers of vehicles among all provinces in China reinforces the generalisability. Furthermore, the findings of this study can also contribute as a reference to future road safety research for other countries. A live case-based reasoning system has a  X 4 REs X  cycle ( i.e. , retrieve, reuse, revise, and retain) [1]. Since our proposed case-based prediction system is not operating on live data, there is no component designed for the standard revise and retain process. If our proposed prediction system is to be extended to deal with live data, a new part of revise and retain shall be added.
 demonstrated through comparing with logistic regression. In getting higher values of recall, precision and AUC, an important consideration is case attribute selection and weighting. The attributes we have chosen are based on previous work. However, it is likely that fatigued-related crashes also occur due to other conditions that have not yet been studied. Moreover, the contribution of each attribute to the similarity between the target case and the cases in case-base could differ as well.
 of differentiating between fatigued-driving and non-fatigued-driving cases to some ex-tent based on certain personal and environmental traffic characteristics. The evaluation of our proposed method is not exhaustive and could be expanded in several directions, for instance, to compare with other artificial intelligence techniques ( e.g. , neural net-work). It would also be worth evaluating whether or not our proposed approach could be fruitfully applied to other risky behaviours rather than the kind we have considered. This research was supported in part by the National Natural Science Foundation of China grant 71573286 and Ministry of Education Project for Humanities and Social Sciences Research (16JJDGAT006).

