 A significant trend has emerged in recent years whereby use of the Internet for Peer-to-Peer file sharing. The lead ing content shared in the P2P systems, such as audio and video files, tend to be large in size[1]. So, the wide use of the P2P application has lead has become an urgent requirement to discri minate the users of P2P file sharing appli-cation from other users. 
In this paper, we first propose some univeral features of file-sharing P2P traffic de-rived. Then, we present some analytic estimates of them to prove the value gained from our experiment of the proposed feature. Our methodology can discriminates the P2P users based on flow connection pattern s of P2P traffic, and without relying on packet payload. Finally, we will demonstrate the effectiveness of the proposed discrimination. The most P2P traffic researches have used the data collected from routers across some large ISP X  X  backbone and performs systematic characterization of P2P traffic, such as distribution and workload, often motivated by the dominance of that protocol in a particular provider X  X  infrastructure or during a specific time period [2] [3] [4] [5] [6]. And more importantly, the analysis using ag gregated data could cover some real spe-cialties of P2P traffic. For example,in [2] the authors find  X  X ewly initiating connec-tion rate  X  is totally different between P2P and traditional traffic .After analyzing many traffic of single host in CERNET including both P2P and tradition, we find this conclusion isn X  X  suitable for all kinds of P2P traffic because a P2P host can make several TCP connections with an other P2P peer and with the same destination port and different source port within a download process. From the discussions above, there is a strong requirement for a new discrimination technique based on some uni-versal features of the P2P traffic. We focus on the P2P traffic observed at a single host, and use tens of seconds as the time granularity of analysis, not an hour like in the relative work before. The nature of the P2P traffic lies in the fact every P2P host services as both server and client, con-ducing to the highly decentralized, self-organizing systems, and the large number of hosts involved and the transient peer membership. These hosts may differ in many aspects, especially the rate of random de parture decisions of end-users. Any changes of these aspects can make the connectivity of P2P networks very different at any moment [7]. To keep it X  X  download speed no t to decrease, a P2P host can continually initiate TCP connections with others which could be online in a very low probability due to the dynamics of P2P systems.P2P hosts should have a small success rate of initiating connections, and a common (not P2P) host would connect with all kinds of servers in the Internet at a much higher success rate. It is because all the servers must keep their service always acquirable in any client/server systems while peers in P2P system are personal computers: and not always operational and stable. We think the low success rate of TCP connections of peers is the common character of all P2P systems. Based on it, we propose some traffic features for P2P discrimination tech-nique. The main focuses of the proposed features are SYN and SYN/ACK packets, since these packets are used for the estab lishment of TCP connections of P2P applica-tion without exception. calculated every 30 seconds 
We proposes r c as the universal feature for discriminating P2P traffic from other P2P traffic between other traffic, which will be demonstrated in detail in the follow-ing sections. We focuse on two P2P protocols:BitTorrent and eMule which are used most popu-larly in CERNET(China Education and Research Netwrok). From the analysis of the protocols[10], we can get the conclusion the most used transfer layer protocol of con-nections established between P2P peers is TCP[11].We prepared two kinds of traffic without P2P communication, such as traffic of email/DNS server and common clients, firstly calculated the connection responsed success rate rc of one hour traffic. Figure 1 shows the distribution of rc of two kind of traffic. 
From Fig. 1,we can see that the tradition traffic has very high value in r c as our ex-pectation , and the P2P traffic has the value in the range [0.2,0.65] . There is a part of P2P traffic generated by eMule also has high value of r c , so we can see a little overlap. After analyzing the communicating process of eMule [9],we find that eMule peer would periodically send UDP messages which are used to find out whether it can start download the file. This mechanism leads to the high responsed rate of TCP connect-very low responsed rate which is even much smaller than P2P traffic because of its totally randomly behavior. We think the responsed connection rate of P2P traffic in a short time piece between two peers can X  X  be always high(=1), while it can be easy for normal tradition traffic. So, we next calculated the percentage of rc=1 every 30 sec-retransfer mechanism of many applications .Fig.2 shows the distinct difference be-tween the proportion of rc=1 of P2P and traditional traffic. The P2P plots are in area superscan still has very low value in this feature as we expected. 
From Fig.2,we can see although some P2P traffic which have a high value in total short time to keep a certain download speed. In tradition network behavior model, connecting with different hosts in high frequency is unnormal. Form Figs. 1 and 2, neither connection responsed rate of an hour nor the distribution of rc=1 can be used gether to get an accurate identification of P2P traffic. 
From Fig. 3 ,we can find all the traffic ar e plot out three parts clearly: normal tradi-tion,P2P and unnormal tradition traffic from top to bottom. As we described above, our proposed traffic features can be useful for accurate traffic discrimination. 
In the two following sections, We will prove the usability of our proposed features both from theoretical and experimental ways. In this section we present some analytic estimates of the universality of the values of our proposed features based on the distribution of user lifetime in real P2P systems. 5.1 Lifetime Model of Real P2P Systems In our model, each arriving user is assigned a random lifetime Li drawn from some distribution F ( x ), which reflects the behavior of the user and represents the duration of his/her services to the P2P community. It has been observed that the distribution of user lifetimes in real P2P systems is often heavy-tailed (i.e., Pareto)[8],[9], where most users spend minutes per day browsing the network while a handful of other represent heavy-tailed user lifetimes, where scale parameter  X  &gt; 0 .Note that the mean of this distribution(4) is finite only if  X  &gt; 1, which we assume holds in the rest of the paper. 
There have been a number of studies reporti ng on experimental data collected from currently deployed P2P systems. From them we find that it may appear that E [ Li ] = 1 hour(the mean online stay is 1 hour) is rather large for current P2P systems. If we set Pareto lifetimes with  X  = 3 and E [ Li ] = 1 hour, we can get  X  = 2 by (3)and then by (2) can calculate that 51% of the users depart within 30 minutes of their arrival which accords with the fact of BitTorrent-like system, but in eMule-like system users will stay more longer. 5.2 Reason for Considering Surviving Rate of Peers As mentioned above, the P2P traffic features we proposed are different from the tradi-tional traffic because the dynamics of P2P system: users voluntarily decide to leave announced its existence to you at some time before, you could still fail when you touch with it just after a short time. In the following, we will answer the question : X  X f we know some peers are online at time T1 in a real P2P system, how many peers are still online when passing a time t  X ,in other words, what is the surviving rate of these peers after certain time t? 
In BitTorrent system, during the download process the tracker periodically sends updated information about new download locations which are collected through the announcement of all clients. In the eMule network, a client connects to an eMule server for getting information about desired files and available clients [11].According to the statement above about the communication mechanism of centralized file-sharing P2P systems, the feature  X  X onnection responsed success rate  X  of one peer think they should be in some kind directly related if the systems are large enough and steady. Next, we will infer the expression of the surviving rate of P2P peers. 5.3 Derivation of Surviving Rate To keep the derivations tractable, we impose serveral restrictions on the system we study. We first assume that users join a network that has evolved sufficiently long so as to overcome any transient effects. This assumption is usually satisfied in practice since P2P systems continuously evolve for hundreds of days or weeks before being restarted (if ever) and the average lifetime E [ Li ] is negligible compared to the age of the whole system when any given peer joins it. Our second assumption requires certain stationar-ity of lifetime Li . This means that users joining the system at different times of the day or month have their lifetimes drawn from the same distribution F ( x ). Finally, we should note that these stationarity assumptions do not apply to the number of nodes n tion of the question we need to study. It includes three statements as below: Statement 1. In P2P systems, if N T1 is the number of online peers at moment T1 ,after time t, the surviving rate of these peers (defined as SR) is (4).
 Statement 2. When a user contacts with a group of peers whose locations got from trackers or index servers constantly, the intervals of these peers announce themselves to trackers and the time when the user gets the locations from servers are various according to the time successively. We assume the probability distrubiton of the sum of announcing peers is average at any moment and at one moment the probability of peers is also mean for various lifetimes. So, the connection responsed success rate could be simply represented as the mean value of all SR within some time T whose length is decided by the practical mechanism of the system as (5). Statement 3. If the system are large and steady enough ,the SR is only correlative with the length of passing time t. given by: 
The probability density function (PDF) f(x) serves to represent a probability distri-percentage of user who have existed in system for 10 minutes at any time could be represented by f(10). We must notice an important understanding that is at one mo-ment the peers alive in the system maybe have already survived for any potential Theorem 1. From time T1 to time T1+t, the SR t of peers for Patero lifetimes with F(x) = 1  X  (1 + x/  X  )  X   X  ,  X  &gt; 1 is given by: the system midway. According (6) and (7),re-write (8): 
Next setting  X  =3,  X  =2 and T=0.5/1/1.2 hour, we compute Rc 0.5 ,Rc 1 and Rc 1.2 .We choose these three time pieces as the intervals of time T, because the very busy track-ers in BitTorrent system always set the announcment interval of client as 1.2 hour or more longer while the general trackers choose 0.5 hour ,and 1 hour is the mean life-based on the assumption that the trackers or index servers always ensure all offline are consistent with what we obtained through our experimentations before. In this section we evaluate the accuracy of our methodology by using the SVM method to discriminate P2P traffic with our proposed traffic features. Indeed, to by some well-known ports. We took an SVM package LibSVM-2.82 using default parameters except the parameter g(gamma) must be set to bigger than 2.We choose determine a separating hyperplane. We gathered 10 traffic data sets of another P2P application named PPLive which is a famous P2P application [12], 5 traffic data sets generated by nmap , another popular scanning application , and 10 data sets of sev-eral common hosts when no P2P or scanning applications run on them. All these 25 train1,train2, train3: the first one only using the total responsed rate of one hour as the training attribute, the second one using the percentage of responsed rate which is equal to 1 counted every 30 seconds and the third one using both of them. The accu-racy values of the predictions of SVM using three training file respectively and a same testing data sets are compared in Table 1. 
Only using responsed rate as training attribute like in train1,the 8 sets of 10 traffic labeled as P2P traffic. Similarly, when percentage of responsed rate =1 used for train-ing attribute, all nmap data sets are consider ed as P2P traffic. From Table 1, the one feature case shows bad results compared to two features case, and the accuracy can get at 100% when two features combined. This paper firstly propose some universal features of file-sharing P2P traffic, and present some analytic and experimental estimates of our proposed feature. The char-acteristics of P2P traffic are distinct from other traffic which is confirmed both by the result of our theoretical analysis and the effective data mining of SVM. Future study will also be needed to adapt our algor ithm for active real-time monitoring of P2P traffic and to cover P2P applications other than eMule and BitTorrent. 3. Thomas Karagiannis, Andre Broido, Michalis Faloutsos, and Kc claffy: Transport Layer 
