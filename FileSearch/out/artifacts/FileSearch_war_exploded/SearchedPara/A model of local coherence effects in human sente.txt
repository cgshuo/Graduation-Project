 The task of human sentence processing, recovering a hierarchical structure from a serial input fraught with local ambiguities, is a complex and difficult problem. There is ample evidence that comprehen-ders understand sentences incrementally, construct-ing interpretations of partial structure and expecta-tions for future input (Tanenhaus et al., 1995; Alt-mann and Kamide, 1999). Many of the main behav-ioral findings in the study of human sentence pro-cessing have now been explained computationally. Using probabilistic models trained on large-scale corpora, effects such as global and incremental dis-ambiguation preferences have been shown to be a result of the rational use of syntactic probabilities (Jurafsky, 1996; Hale, 2001; Narayanan and Juraf-sky, 2001; Levy, 2008b; Levy et al., 2009). Simi-larly, a number of other effects in both comprehen-sion and production have been modeled as resulting from rational strategies of languages users that take into account all the probabilistic information present in the linguistic signal (Genzel and Charniak, 2002; Genzel and Charniak, 2003; Keller, 2004; Levy and Jaeger, 2007).

One class of results from the literature that has not yet been explained in terms of a rational com-prehender strategy is that of local coherence effects (Tabor et al., 2004; Gibson, 2006; Konieczny and M  X  uller, 2007), cases in which it appears that the parser is systematically ignoring contextual infor-mation about possible syntactic structures and pur-suing analyses that are probable only locally. These effects are problematic for rational models, because of the apparent failure to use all of the available in-formation. This paper describes a new model of lo-cal coherence effects under rational syntactic com-prehension, which proposes that they arise as a re-sult of updating prior beliefs about the structures that a given string of words is likely to have to pos-terior beliefs about the likelihoods of those struc-tures in context. The critical intuition embodied in the model is that larger updates in probability distri-butions should be more processing-intensive; hence, the farther the posterior is from the prior, the more radical the update required and the greater the pro-cessing load. Section 2 describes the problem of lo-cal coherences in detail and Section 3 describes ex-isting models of the phenomenon. Following that, Sections 4 X 5 describe our model and its computa-Figure 1: The difficulty of explaining local-coherence effects as traditional garden-pathing. tion from a probabilistic Earley parser. Section 6 presents the results of an experiment showing that our model makes the correct predictions for the lo-cal coherence effects seen in the original paper by Tabor et al. (2004). Finally, Section 7 concludes and discusses the insight our model gives into human performance. The first studies to report effects of local coherences are described in Tabor et al. (2004). In Experiment 1, they use a self-paced reading task and materials containing relative clauses (RCs) attached to nouns in non-subject position as in (1). (1) a. The coach smiled at the player tossed a Their experimental design crossed RC reduction with verb ambiguity. RCs are either reduced (1a,1c) or unreduced (1b,1d), and the RC verb is either lex-ically ambiguous between a past tense active and a past participle (1a X 1b), or is unambiguously a past participle (1c X 1d).

Tabor et al. point out that in one of these four conditions (1a) there is a locally coherent string the player tossed a frisbee . Out of context (e.g., if it were starting a sentence) this string would have a likely parse in which tossed is a past tense active verb, the player is its agent, and a frisbee is its theme (Figure 1, left). The preceding context within the sentence, however, should rule out this interpre-tation because the player appears within a PP and hence should not be able to be the subject of a new sentence (Figure 1, right). That is, given the preced-ing context, the player tossed a frisbee must begin a reduced RC, such that there is no local ambiguity. Thus, if comprehenders are making full use of the linguistic context, (1a) should be no more difficult than the other examples, except insofar as ambigu-ous verbs are harder than unambiguous verbs, and reduced RCs are harder than unreduced RCs, pre-dicting there would be only the two main effects of RC reduction and verb ambiguity on reading times for the tossed a frisbee region.

Tabor et al., however, predict an interaction such that (1a) will have added difficulty above and be-yond these two effects, because of the interference from the locally coherent parse of the player tossed a frisbee . Concordant with their predictions, they find an interaction in the tossed a frisbee region, such that (1a) is super-additively difficult. Because this result requires that an impossible parse influences a word X  X  difficulty, it is in direct opposition to the pre-dictions of theories of processing difficulty in which the probability of a word given context is the pri-mary source of parsing difficulty, and more gener-ally appears to be in opposition to any rational the-ory, in which comprehenders are making use of all the information in the linguistic context. With the results showing local coherence effects in mind, we can ask the question of what sorts of theories do predict these effects. This section briefly describes two recent examples of such the-ories. The first involves dynamical systems models to explain the effects and the second uses a mathe-matical model of the combination of bottom-up and top-down probabilistic information.

In Tabor and Hutchins X  X  (2004) SOPARSE (self-organized parse) model, reading a word activates a set of lexically anchored tree fragments. Through spreading activation between compatible fragments and inhibition between incompatible ones, these tree fragments then compete in a process which is sen-sitive only to the local environment, i.e., ignoring the global grammatical context. Eventually, the sys-tem stabilizes to the correct parse, and reading times for each word are modeled as the time the system takes to stabilize after reading a word. Stabilization takes longer for locally coherent regions because the locally coherent parse will be created and compete with the globally grammatical parse.

There are, however, unresolved issues with this model. The model has a number of free parameters, relating to the equations used for the competition, the method by which links between fragments are formed, as well as the question of precisely what tree fragments a given word will activate. While Ta-bor and Hutchins (2004) work out these questions in detail for the types of sentences they model, it is unclear how the model could be scaled up to make predictions for arbitrary types of sentences. That is, there is no principled system for setting the three types of parameters mentioned, and thus no clear in-terpretation of their values. The model put forward in this paper is an attempt to remedy this situation.
A recent proposal by Gibson (2006) can also ex-plain some of the local coherence results. Gibson X  X  proposal is that part-of-speech ambiguities have a special status in parsing; in effect, lexical part-of-speech ambiguities can be thought of as one-word local coherences. In this model, a probability func-tion  X  P is calculated over part-of-speech tags given a word. This probability for tag t i and a word w ,  X  P ( t probability of t i given the word w , P ( t i | w )  X  the bottom-up component  X  multiplied by a smoothed probability P s of the tag given the context  X  the top-down component: Difficulty is predicted to be high when the probabil-ity  X  P of the correct tag is low.

Because the top-down probabilities are smoothed to allow for all possible parts-of-speech, any word which is lexically ambiguous will be more difficult to process, regardless of whether it is ambiguous or not in its context. This can thus explain some of the difference between the ambiguous and unambiguous verbs in Tabor et al. (2004). It is not clear, however, under such a model why the super-additive interac-tion would obtain X  X hat is, why (1a) should be so much harder than (1b) starting at the word tossed . In addition, Gibson X  X  model is a bit underspecified: he does not discuss how the top-down probabilities are calculated, nor what the precise linking hypothe-sis is between the final  X  P and reading times. Finally, it is not at all clear why the top-down expectations should be smoothed, since the smoothing actually has negative consequences on the processor X  X  per-formance. The basic intuition behind the model presented here is that incrementally processing a sentence can be conceptualized as a process of updating one X  X  be-liefs. Such an analogy has been used to moti-vate surprisal-based theories of sentence processing (Hale, 2001; Levy, 2008a), where beliefs about the structure of a sentence after seeing the first i  X  words in the sentence, which we denote as w i  X  1 are updated upon encountering w i . In this case, the surprisal of a word (  X  log P ( w i | w i  X  1 lent to the Kullback-Leibler divergence of the beliefs after w i Our model focuses on another belief-update process in sentence processing: updating beliefs about the structures that a string of words is likely to have in-dependent of context to beliefs about what structures it is likely to have in context. A bit more formally, it views the process of integrating a string of words w up X  prior distribution of syntactic structures likely to span w j edge from the previous words in the sentence w i order to reach a posterior distribution conditioning on w j This belief update process can be viewed as a ratio-nal reconstruction of the Tabor and Hutchins (2004) model, where  X  instead of the system dynamics of competition between arbitrary tree fragments  X  dif-ferences between prior and posterior probability dis-tributions over syntactic structures determine pro-cessing difficulty.

More formally still, when integrating w j sentence, for each syntactic category X , we can de-fine the prior probability conditioned only on w j w an X exists which begins at index i and spans at least through j : It is important to note here that this prior probability is conditional only on the value of w j values of i or j ; that is, in the prior probability, i and j should be interpreted merely as a way to coindex the start and end points of the string of words being integrated with a category X potentially spanning them, and not as making reference to position in the full sentence string.

For each category X , this prior probability will be updated to the posterior probability of that category spanning w j In the equation for the posterior, of course, the in-dices i and j are positions in the sentence string, and not merely coindices.

Given these prior and posterior beliefs, we pre-dict difficulty to arise in cases where the prior re-quires substantial modification to reach the poste-rior, that is, cases in which the prior and poste-rior make substantially different predictions for cat-egories. A strong local coherence will have sharply different prior and posterior distributions, causing difficulty. We represent the prior and posterior be-liefs as vectors of the probabilities of each syntactic category spanning w j of modification required, as the summed K-L diver-gence of the prior from the posterior vector. That is, if
N is the set of nonterminals in the grammar, the size of the belief update is modeled as 1 In the remainder of the paper, we show how to com-pute M ij by using Bayesian inference on quanti-ties calculated in ordinary probabilistic incremen-tal Earley parsing with a stochastic context-free grammar (SCFG), and show that our model makes the correct predictions using an SCFG for English on the original local-coherences experiment of Ta-bor et al. (2004). For SCFGs, a probabilistic Earley parser (Earley, 1970; Stolcke, 1995) provides the basic quantities we need to compute the prior (2) and posterior (3) for each category X . Following Stolcke, we use capital Latin characters to denote non-terminal categories and use lowercase Greek characters to denote (possibly null) sequences of terminals and non-terminals. We write the probability that a non-terminal X can be recursively rewritten by SCFG rules as a certain series of symbols  X  by An edge built from the rule X  X   X  X  where  X  has been recognized as beginning at position i and end-ing at position j is denoted The forward probability of that edge at position j ,  X  , is defined to be the joint probability that the root node will generate all words recognized so far w j well as the edge With this terminology, we are now in a position to describe how we calculate the posterior and prior probability vectors for our model. 5.1 Calculating the posterior To calculate the posterior, we first use the definition of conditional probability to rewrite it as In a context-free grammar, given the syntactic cat-egory that dominates a string of words, the words X  probability is independent from everything outside the category. Thus, this is equivalent to 5.1.1 Posterior: the numerator X  X  first term
The first term in the numerator P ( S  X   X  w i can be computed from a parse of w i forward probabilities of the form 5.1.2 Posterior: the denominator
Similarly, the denominator P ( S  X   X  w j computed from a parse of w j probabilities of the form for all Y. This is because the forward probability of a state is conditioned on generating all the previous words. 5.1.3 Posterior: the numerator X  X  second term
The second term in the numerator P ( X  X   X  w j for an arbitrary category X cannot necessarily be calculated from a probabilistic Earley parse of the sentence, because the parser does not construct states that are not potentially useful in forming a sen-tence (i.e., states that would have a forward proba-bility of zero.) However, to calculate the probability of X generating words w j rately with a goal category of X . From this parse, we can extract the probability of w j from X in the same way as we extracted the proba-bility of w j forward probabilities at j (Eq. 5). 2 5.2 Calculating the prior To calculate the prior, we first use Bayes rule to rewrite it as Recall that at this point, i and j do not refer to in-dex positions in the actual string but rather serve to identify the substring w j denotes the probability that at an arbitrary point in Event Description E 0 : There are at least i 0 words | w | X  i 0 E 3 : There are at least j words | w | X  j an arbitrary sentence, the next j  X  i words will be w bitrary point in an arbitrary sentence will be the left edge of a category X that spans at least j  X  i words. None of the three terms in Eq. 6 can be directly ob-tained. However, we can obtain a very good approx-imation of Eq. 6 as follows. First, we marginalize over the position within a sentence with which the left edge i might be identified: In Eq. 7, i 0 is identified with the actual string position within the sentence.

Second, we rewrite the first term in this sum with event space notation, using the event space given in Table 1.
 P ( w j Applying the chain rule, we can further simplify. Switching back from event space notation and sub-stituting this term into Eq. 7, we now have P Thus, by conditioning all terms on E 0 , the presence bilities we need to calculate into these four terms, which are easier to calculate from the parser. We now consider how to calculate each of the terms. 5.2.1 Prior: the numerator X  X  first term
The first term in the numerator can be simplified because our grammar is context-free: This can be computed as described in Section 5.1.3. 5.2.2 Prior: the numerator X  X  second term
The second term in the numerator can be rewritten as follows: where  X  w i 0 the string  X  w i special word that can freely act as any preterminal. The denominator can then be calculated by summing the forward probabilities of the last word  X  w i Eq. 5, and the numerator by summing the forward probability of X , as in Eq. 4. 5.2.3 Prior: the denominator
The denominator in the calculation of the prior can be calculated in a way analogous to the numera-tor X  X  second term (Section 5.2.2): 5.2.4 Prior: starting position probability Finally, we must calculate the second term in Eq. 8, the probability of the starting position P ( i = i 0 ) . Given that all our terms are conditional on the existence of all words in the sentence up to i 0 ( E 0 ), the probability of a starting position P ( i ) is the probability of drawing i 0 randomly from the set of positions in sentences generated by the grammar such that all words up to that position exist. For most language grammars, this distribution can be easily approximated by a sample of sentences generated from the SCFG, since most of the probability mass is concentrated in small indices. We tested the predictions of an implemented ver-sion of our model on the materials from Ta-bor et al. (2004). To generate quantitative predic-tions, we created a small grammar of relevant syn-tactic rules, and estimated the rule probabilities from syntactically annotated text. We calculated summed K-L divergence of the prior from the posterior vector for each word in the Tabor et al. items, and predict this sum to be largest at the critical region when the sentence has an effect of local coherence. 6.1 Methods 6.1.1 Grammar
We defined a small SCFG for the problem, and es-timated its rule probabilities using the parsed Brown corpus. The resulting SCFG is identical to that used in Levy (2008b) and is given in Table 2. 6.1.2 Lexicon
Lexical rewrite probabilities for part-of-speech tags were also estimated using the entire parsed Brown corpus. 6.1.3 Materials The materials were taken from Experiment 1 of Tabor et al. (2004). We removed 8 of their 20 items for which our trained model either did not know the critical verb or did not know the syntactic structure of some part of the sentence. For the other 12 items, we replaced unknown nouns (9 instances) and un-known non-critical verbs (2 instances), changed one plural noun to singular, and dropped one sentence-initial prepositional phrase. Table 2: The SCFG used in Experiment 3. Rule weights given as negative log-probabilities in bits. Rule Weight ROOT  X  S 0 S  X  S-base CC S-base 7.3 S  X  S-base 0.01 S-base  X  NP-base VP 0 NP  X  NP-base RC 4.1 NP  X  NP-base 0.5 NP  X  NP-base PP 2.0 NP-base  X  DT NN NN 4.7 NP-base  X  DT NN 1.9 NP-base  X  DT JJ NN 3.8 NP-base  X  PRP 1.0 NP-base  X  NNP 3.1 VP/NP  X  VBD NP 4.0 VP/NP  X  VBD 0.1 VP  X  VBD PP 2.0 VP  X  VBD NP 0.7 VP  X  VBD 2.9 RC  X  WP S/NP 0.5 RC  X  VP-pass/NP 2.0 RC  X  WP FinCop VP-pass/NP 4.9 PP  X  IN NP 0 S/NP  X  VP 0.7 S/NP  X  NP-base VP/NP 1.3 VP-pass/NP  X  VBN NP 2.2
VP-pass/NP  X  VBN 0.4 6.2 Procedure For these 12 items, we ran our model on the four conditions in (1). For each word, we calculated the prior and posterior vectors for substrings of three lengths at w i . The summed K-L divergence is reported for a substring length of 1 word us-ing a prior of P ( X k  X  i summed divergence to be greater at critical words for the part-of-speech ambiguous conditions (1a,1b) than for unambiguous (1c,1d), because the part-of-speech unambiguous verbs cannot give rise to a prior that predicts for a sentence to begin. For a substring length of 3, we also predict that the divergence is superadditively greatest in the ambiguous reduced condition (1a), because of the possibility of starting Figure 2: Summed K-L divergence of the prior from the posterior vectors at each word: Substring length 1 Figure 3: Summed K-L divergence of the prior from the posterior vectors at each word: Substring length 2 a sentence with the player tossed . 6.3 Results The results of the experiment are shown in Figures 2 X 4. For all three substring lengths, the model pre-dicts difficulty to be greater in the ambiguous condi-tions at the critical words ( tossed/thrown a frisbee ). For 1-word substrings, the effect is localized on the critical verb ( tossed/thrown ), for 2-word substrings it is localized on the word directly following the critical verb ( tossed/thrown a ), and for 3-word sub-strings there are two effects: one on the critical verb ( the player tossed/thrown ) and one two words later ( tossed/thrown a frisbee ). Furthermore, for 3-word substrings, the effect is superadditively greatest for the player tossed . These results thus nicely confirm Figure 4: Summed K-L divergence of the prior from the posterior vectors at each word: Substring length 3 both of our predictions and demonstrate that a model in which large belief updates from a bottom-up prior to a posterior induce difficulty is capable of account-ing for effects of local coherences. This paper has described a model of local coherence effects in sentence processing, which views the pro-cess of integrating a string of words w j tence as a process of updating prior beliefs about the structures spanning those words to posterior be-liefs. These prior beliefs are simply the probabilities of those structures given only the words being inte-grated, and the posterior beliefs are the probabilities given the entire sentence processed thus far. Diffi-culty is predicted to result whenever this update is large  X  which we model in terms of a large summed K-L divergence of the prior from the posterior vec-tor. We demonstrated a method of normatively cal-culating these probabilities from probabilistic Ear-ley parses and used this implemented model to make predictions for the materials for the original experi-mental result of effects of local coherences (Tabor et al., 2004). Our results demonstrated that the model predicts difficulty to occur at the correct part of the sentence in the correct condition.
 We improve on existing models in two ways. First, we make predictions for where local coher-ences should obtain for an arbitrary SCFG, not just one particular class of sentences. This allows the model to scale up for use with a broad coverage grammar and to make predictions for arbitrary sen-tences, which was not possible with a model such as Tabor &amp; Hutchins (2004).

Second, our model gives a rational basis to an ef-fect which has typically been seen to result from ir-rationality of the human sentence processor. Specif-ically, the cost that our model describes of updating bottom-up prior beliefs to in-context posterior be-liefs can be viewed as resulting from a rational pro-cess in the case that the bottom-up prior is available to the human sentence processor more rapidly than the in-context posterior. Interestingly, the fact that the prior is actually more difficult to compute than the posterior suggests that the only way it would be available more rapidly is if it is precomputed. Thus, our model provides the insight that, to the extent that comprehenders are behaving rationally in pro-ducing effects of local coherences, this may indi-cate that they have precomputed the likely syntac-tic structures of short sequences of words. While it may be unlikely that they calculate these probabil-ities for sequences directly from their grammar as we do in this paper, there could be a number of ways to approximate this prior: for example, given a large enough corpus, these probabilities could be approx-imated for any string of words that appears suffi-ciently often by merely tracking the structures the string has each time it occurs. Such a hypothesis for how comprehenders approximate the prior could be tested by manipulating the frequency of the relevant substrings in sentences with local coherences. This work can be extended in a number of ways. As already mentioned, one logical step is using a broad-coverage grammar. Another possibility re-lates to the problem of correlations between the dif-ferent components of the prior and posterior vec-tors. For example, in our small grammar, whenever a ROOT category begins, so does an S, an S-base, and an NP-base. Dimensionality reduction techniques on our vectors may be able to remove such correlations. These steps and more exhaustive evaluation of a va-riety of datasets remain for the future.
 This research was supported by NIH Training Grant T32-DC000041 from the Center for Research in Language at UCSD to the first author.
