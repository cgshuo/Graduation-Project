 Group-buying ads seeking a minimum number of customers before the deal expiry are increasingly used by the daily-deal providers. Unlike the traditional web ads, the advertiser X  X  profits for group-buying ads depends on the time to expiry and additional customers needed to satisfy the minimum group size. Since both these quantities are time-dependent, optimal bid amounts to maximize profits change with every impression. Consequently, traditional static bidding strate-gies are far from optimal. Instead, bid values need to be optimized in real-time to maximize expected bidder prof-its. This online optimization of deal profits is made possible by the advent of ad exchanges offering real-time (spot) bid-ding. To this end, we propose a real-time bidding strategy for group-buying deals based on the online optimization of the bid values. We derive the expected bidder profit of deals as a function of the bid amounts, and dynamically vary bids to maximize profits. Further, to satisfy time constraints of the online bidding, we present methods of minimizing com-putation timings. We evaluate the proposed bidding on a multi-million click stream of 935 ads. The method shows significant profit improvement over the existing strategies. G.1.6 [ NUMERICAL ANALYSIS ]: Optimization X  Un-constrained optimization real-time bidding, group-buying, daily deals, display ads
Web based deals offering deep discounts to a group of on-line buyers on products and services is a fast growing mar- X  The work was done while the author was vising Yahoo! Labs, Bangalore as a summer intern.  X  The work was done while the author was working in Yahoo! Labs, Bangalore.
 ket. Group-buying deals attract new customers as well as guarantee customer traffic within a stipulated expiry date for local businesses like restaurants and tour operators [1]. Most of these group-buying deals are sold by intermediaries like Gropon, Groupbuy and many other daily deal providers. Though these intermediaries depended on email based mar-keting models in the past, banner ads in social networking and other sites are increasingly used to attract deal cus-tomers.

Unlike the traditional ads, group-buying intermediaries (advertisers) receive their payment only upon satisfying the minimum number of conversions before the deal expiry (i.e. if the deal tips). This implies that if the deal does not tip, advertiser loses the amount used to buy impressions, and receives no payment. If the advertiser fulfills or ex-ceeds the guarantee, he receives a payment equal to the product of number of conversions and pay per conversions X  similar to the traditional ads. This model is used by pop-ular group-buying advertisers like Groupon, and Groupbuy among many other deal providers. Though most of these deals tips for sites like Groupon in current email based mar-keting, tipping the deals will get harder with increasing com-petition to attract business owners and shift to the display-ad based marketing. The proposed strategy enables the deal advertisers to offer more aggressive tipping points, hence more volume of sales to merchants. Further, this model is easy scale to other forms of group-buying campaigns X  X ike penalties for not meeting tipping similar to the guaranteed display ads [ 3].

To maximize the profits while bidding for group-buy ads, bidders have to minimize cost by bidding low, but still have to win sufficient number of conversions to satisfy guarantees before the deal expiry. Bidding high increases the probabil-ity of winning impressions thereby improves the chance of the deal tipping. On the contrary, higher bids increase the payment to the exchange thereby reducing the profit. Hence bids need to be optimized considering these two conflicting pulls. This maximal profit bidding necessitates dynamic bid optimization based on the time to expiry and the number of received conversions. We address this problem of maxi-mizing deal bidder profits, by real-time optimization of bids to minimize the cost of impressions while satisfying the deal tipping guarantees.

For group-buying deals, the traditional static bidding strate-gies based on optimization of expected profits of a single impression is far from optimal. A significant difference from the traditional ads is that the optimal bid value depends on the time to expiry and number of more conversions required to satisfy the guarantees. For example, consider a deal re-quiring just a few more conversions to fulfill the guarantee. If the deal is about to expire the advertiser would have to bid higher amounts to increase the probability of winning more impressions. On the other hand, if the time to expiry is long for the same deal, he would better off bidding smaller amounts winning fewer fraction of impressions to minimize the payment to the exchange (since there would be higher number of user visits in larger time intervals). Evidently, the optimum bid amount is a function of the time dependent pa-rameters like the time to expiry and the additional number of conversions needed to satisfy the guarantees. Due to this time dependence of optimal bids, any static bidding strategy will be sub-optimal, necessitating real-time bidding. Fortu-nately, this dynamic bid optimization is made possible by the advent of ad exchanges offering real-time auctions (e.g. RealMedia, DoubleClick, AdECN).

Since the revenue is conditional upon tipping the deal, the bidding strategies are significantly harder than the tra-ditional non-guaranteed bidding. In addition to the dynamic quantities mentioned above, deal profit depends on a number of static quantities: pay per event, number and bid distri-butions of other bidders, conversion rates, and the auction mechanism [11 , 8]. Consequently, formulating and maximiz-ing expected profits X  X hich is a function of all these static and dynamic quantities X  X s significantly harder. Adding to the complexity, the optimization is online necessitating low computation timings.

Our method of optimizing profit for guaranteed deals has two steps: (i) Formulating the expected profit (ii) Maxi-mizing the profit against the bid. For the first step, we derive the expected profit as a function of the bid value, time to expiry, fulfilled conversions, amount spent to buy impressions, auction mechanism, click through rate and the number and distribution of the other bidders. Since many of these parameters are dynamic as described above, the objective function value changes as the bidding progresses. Among all these parameters, the only parameter the bidder can change is his own bid amount. Hence we optimize the expected profit against the bid amount in the second step. When the profits are optimum, the deal bids are in a sym-metric Bayesian Nash equilibrium similar to the traditional ads [ 11 , 8].

Considering the complexity of the optimization, a closed form solution is unlikely. Though the optimization is against a single variable (i.e. bid amount), our analysis shows that the objective function is neither convex nor quasi-convex (unimodal). Consequently, an optimization method guaran-teed to converge to optimal bids on every instance is unlikely. Further, the derivative of the objective function is harder to solve than the objective itself. Considering these factors, we resort to direct numerical optimization (without using gradients) starting from multiple points.

Since the optimization is online, computation time needs to be minimized. Therefore we explore running time opti-mization in multiple levels. These optimizations reduced the computation time to acceptable limits.

We evaluate the proposed methods and the extensions in a query log of size 9.3 million impressions of 935 ads. In our first set of experiments, we compare our profits of the proposed real time strategy with the optimal static and base adaptive baselines. The results show that the proposed strategy improves the profits over the baselines significantly.
Rest of the paper is organized as the following. The next section discusses related work, followed by the section on no-tations and the formal problem definition. Section 4 derives the expected profits and proposes the optimization method. Subsequently, we discuss running time minimizations. Sec-tion 6 present the experimental evaluations. We present our conclusions in Section 7.
Grabchak et al. [10] addressed the problem of optimal selection of guaranteed (group buying) ads . Our work is different, since we deal with optimal bidding, whereas Grabchak et al. does not consider the bidding and consider offline selection of deals. Different models of group-buying auctions and bidding mechanisms has been studied [2 , 5]. But our problem of bidding to sell deals online X  X ostly made popular after the emergence of dail-deal sites X  X as not been studied for any of the group-buying auction models.
There are a number of papers on optimal ranking of tex-tual ads in presence of budget limits. Mehta et al. [12 ] deal with the problem of optimal allocation of textual ads consid-ering budget limits of the advertisers. These papers consider ranking/allocation of textual ads than deals. Further these problems have an upper limit on number of impressions, rather than a lower limit as in our problem. Hence, unlike these problems, ours is not a generalized online bipartite matching.

Chen et al. [6] formulated the problem of supply side al-location of traditional ads with upper bounds on budgets as an online constrained optimization matching problem. Boutilier et al. [4 ] introduced an auction mechanism for real time bidding of display ads. To the best of our knowledge, the optimal bidding problem of group-buy deals and the ex-tensions have not been addressed.
Every group-buy deal g has a required minimum number of clicks m , an expiry time e , a cost per click (CPC)  X  , and a click through rate (CTR)  X  . Thus a deal may be represented as,
For the rest of the paper our discussions are based on guaranteed number of clicks for the ease of description. The discussions and results are equally applicable for guaranteed conversions (refer to Balakrishnan and Bhatt [3 ] for details) (by substituting conversion rates (CVR) for click through rates and click per action (CPA) for CPC) and guaranteed displays (by setting click through rate to one and substitut-ing Cost Per Impression (CPI) for CTR).

Let  X  t be a binary indicator variable, with  X  t = 1 if the advertiser X  X  bid is successful at time t  X  X .e. he wins the bid for impressions and pays the content owner X  X nd zero otherwise. Let c t be the number of clicks at time t . For our discussions, the time t denotes t user visits (impression opportunities) rather than wall clock time. For a deal g the profit P t at time t is, where h ( b ) is a mapping from bids to the payment whose closed form depends on the auction model, the number of other bidders and the bid distributions. For the commonly used first price auction for display ads h ( b j ) = b j . For other auctions like second price auction, closed forms can be de-rived based on order statistics [8]. After fulfilling guarantees (i.e. c t  X  m ) the expected profit function for the guaranteed deals are the same as that of the traditional non-guaranteed ads. Hence, the period of interest for our analysis and ex-periments is the time before guarantees are fulfilled.
To maximize the profit in Equation 1, the only parameter decided by the bidder is the bid amount. Hence we may state the profit maximization problem as,
Bidding Problem: Given a guaranteed ad g =  X  m,e, X , X   X  , and number of received conversions c t , find the bid amount b such that the expected profit from u t user visits is max-imal, where u t is the expected number of user visits before the ad expiry time e .

To explain the nature of the problem, we start by finding the optimal bid based on the expected values of parameters at t = 0. This is the best possible estimate at that point of time. As time progresses, we will get better estimates of parameters based on the actual values of number of con-versions, and user visits so far. Hence we keep updating the optimal bid b t based on the current state and expected numbers in the future. We assume that u t is known, as it can be generally estimated from the traffic statistics [10 ].
We derive the expected profits of group-buy deal cam-paigns based on the current state of the deal. Subsequently we analyze the nature of the the profit-function, and present a method to maximize the profits in real-time by bid adjust-ments. The click probability of a deal is, P ( click | impression ) is equal to the CTR of the deal X  X s a constant for static auctions considered. The second factor X  probability of winning impression P ( impression | bid ) X  X s an increasing function of the bid amount. This implies that the probability of satisfying click guarantees, and consequently the expected profit increases with the bid amount. On the contrary, the amount paid by the bidder to the publisher ( h ( b )) is an increasing function of the bid amount. Hence the profit tends to decrease with increasing bid amount. The bids need to be optimized considering these two conflicting effects on the profit.

For real-time bidding, different advertisers place bids for a given ad impression. Generally the highest bidder wins, and will display his ad. In general, bid values of a bidder varies, either due to the bidder X  X  private value distribution, or due to a deliberate randomization done by the bidder to avoid giving advantage to the competition [9 ]. Hence, the event of winning is probabilistic, with a binary outcome. Further, winning in consecutive bids can be assumed to be independent of each other. Hence bidding to win impressions are Bernoulli trials with success probability increasing with the bid amount.
 The users click with probabilities equal to the estimated CTR of the winning ad. This is again a Bernoulli trial with success probability equal to the CTR. Hence these two trials X  X idding and getting conversions X  X ay be combined as a single Bernoulli trial of bidding to win clicks. The prob-ability of success for this composite trial is equal to the prod-uct of CTR and probability of winning an impression.
For composite Bernoulli trial described above, the number of successes follows a binomial distribution. To facilitate representing such a binomial distribution, we introduce the following two functions,
 X ( r t ,u t ,b t , X  ) =
 X ( r t ,u t ,b t , X  ) = where  X  is the CTR of the ad, and r t is the additional num-ber of clicks required to satisfy the guarantees.

Function d ( b ) is a mapping from the bid value to the prob-ability of winning the impression. For a sealed bid auction in which the highest bid wins (e.g. first or second price auc-tions), this probability is d ( b ) = CDF ( b ) n  X  1 , where CDF is the cumulative probability distribution of the bids of other bidders, and n is the total number of bidders. We need to assume distribution of bids to get a closed form of d ( b ). For example, if the bids are uniformly distributed between l and u , d ( b ) = ( b  X  l ) / ( u  X  l ) n  X  1 .

At optimal profits, the bids are the best responses to com-petitors and hence are in a symmetric Bayesian-Nash equi-librium [8 , 11 ]. Consequently, we may limit our analysis to truthful bidding without the loss of generality as stated by the revelation principle [7]. Hence the assumptions on bid distributions above are equivalent to the same assumptions on private value distributions of bidders at the optimal profit outcomes.

Now the net expected profits is given by the objective function,
E ( P t ) = c t  X   X ( r t ,u t ,b t , X  ) + Please refer to Balakrishnan and Bhatt [3] for the derivation and an extended version of the paper.
The expected profit in Equation 4 has to be optimized with respect to the bid amount. An option is to differentiate the function with respect to b t and solve the derivative for zero. But this is hard since the derivative may have large number of terms, and solving the derivative will be harder than a direct approach. Hence a direct optimization of the objective function X  X s we do below X  X s faster.

We examined the variation of the profit function with the bid values [ 3], and two observations significant to the numer-ical optimization are (i) the optimization is non-convex. (ii) the function is not even quasi-convex (unimodal). These ob-servations imply that a bisection or gradient descent method may get trapped in a local optimum, and hence the conver-gence to the global optima is not guaranteed.

For the bidding process, the winning probability is one if the bid is greater than the maximum bid of the competitors bid distribution; and zero for bids less than the minimum bids. Hence the optimal values will always be between the maximum and the minimum even without imposing exter-nal constraints. This allows a simpler unconstrained op-timization. The optimizer restarts the search from multi-ple random points to avoid local minima traps. Further, since the optimization is online, fast-convergence is highly desirable. Considering these factors, we adapt Brent X  X  opti-mization method. Brent X  X  optimization combines parabolic interpolation with golden ratio search for faster convergence.
The optimization of the bids has to be performed online between the impression opportunities. Evaluating objective function in Equation 4 directly may involve computing hun-dreds of thousands of terms. We adopt several approxi-mations and computational methods for improved running time. These running time optimizations reduced the com-putation time to below 0.2ms for realistic ranges of required clicks [ 3].

Reducing the Number of Terms: Typically for deals the user visits needed to get the required number of clicks are very large compared to the clicks needed for tipping the deal. i.e. u t r t ; except for a last few user visits before deal expiry. Exploiting this, we reduce the computation time by rewriting the Equations 2 and 3 as,
 X ( r t ,u t ,b t , X  ) = 1  X  This may reduce computations from hundreds of thousands of terms to less than a few hundred.

Normal Approximation: In spite of replacing u t by r t , computing binomial CDFs in Equation 5 and 6 may involve summation of hundreds of combinatorial terms. The bino-mial CDF may be approximated by a single term normal CDF for large values of u t (central limit theorem). Exploit-ing this, we compute  X  and  X  based on a normal CDF. For large values of u t  X  X .e. if u t  X d ( b t )(1  X   X d ( b t normal approximation [ 3].

Setting the Starting Points: The optimal bid val-ues generally change only nominally for subsequent impres-sions. Hence the optimal bid for an impression is used as the starting point for optimization for the next impression to expedite convergence.

Multiple Starting Points: The non-convexity of the objective requires the optimal value search to start from mul-tiple points. We chose random starting points for optimiza-tion for the first twenty impressions. The bid corresponding to the maximum objective value among these searches is used as the optimal value.

Re-Computation Frequency: As the change in opti-mal bids are nominal for subsequent impression opportuni-ties, the previous bids can be reused. Hence we re-optimize bids only after a number of impression opportunities (every thirty two impression opportunities in our experiments).
We compared the profits by the proposed bidding strategy with the baseline strategies of (i) optimal static bidding (ii) a basic real time bidding.
 Data Set: From a click log of 330 million impressions, we randomly selected 935 ads (with 9.3 million impressions) having a minimum of 5 clicks and 1000 impressions. Click log contains impressions and whether the impression re-sulted in a click or not.
 Baseline Bidders: First baseline bidder is an optimal static bidder. The bidder derives optimal bids as a function of number of competitors and their bid distributions, and is optimal if there are no guarantees. The second baseline bid-der is a basic adaptive bidder, which bids as staticOptimal + r /u t  X  CTR . The strategy is intuitive, as it increases bid over the static optimal bid if the required click rate is greater than the CTR and decreases the bids otherwise.
The proposed real-time (RT) and baseline bidders com-pete with random bidders for every ad in the  X  X eplayed X  click log. For example, the RT bidder places its bid for the first impression of an ad, along with the competing random bidders. If the RT bidders X  bid is the highest, the bidder wins the impression. The deal wins a click if the click log indicates a click for that impression. Then the same process repeats for the second impression and so on. Similarly, other baseline bidders are made to compete with the same ran-dom bidders for the same set of ads, and the realized profits are compared. This replaying reproduces online experiment, since the user action in the consecutive impressions are most likely from different users, and hence independent.
Since the click logs are of traditional ads having no re-quired clicks or expiry, we set the expiry timings as the num-ber of impressions of the ad in the log. To compensate for using the traditional ads instead of deals, the required clicks are varied by a parameter sweep over the plausible range.
The competing bids are selected from different random distributions (bids are not registered in the click log), since the bidders generally randomize their bids to avoid the com-peting bidders guessing their bids [9]. Note that this ran-domization in bids may be achieved by randomly choosing different deals to bid for in different time slots even for the proposed optimal bidding strategy. Further, the maximum entropy (i.e. minimum assumptions) uniform random com-peting bid distribution is the hardest to predict and to op-timize against (hence we use this distribution for the exper-iments below). Any other distributions, including a fixed optimized competing bid is easier to optimize against and the realized profits will be higher.

Figures 1(a) and 1(b) show four sets of comparisons of profits realized by different bidders against required mini-mum clicks m . In the first set of Group (10) in Figure 1(a) , there are four bidders X  X he bidder evaluated and three other random bidders. Random bidders bid in a uniform random distribution in the interval of [0 , 0 . 04]. Pay per click (  X  ) is set to $10 for this group. The remaining groups of experi-ments in Figures 1(a) and 1(b) are designed to analyze the effects of changes in parameters.

Analyzing common trends in all these groups, the profit of the real time bidder exceeds that of the baseline bid-ders for every m in all the experiments. As expected, the profits reduces with m . The increase in profit is as large as 70-150% (e.g. at m = 150 for Group (10) increase is (13 . 74  X  4 . 86) / 4 . 86 = 1 . 45 . As an exception, the profits of real time bidder is the same as the static optimal bidder at m = 0. This is an implication of the fact that the current static optimal bidding of non-guaranteed ads are a special case of the proposed RT bidding. As m increases from left to right, the absolute and percentage of difference between has two bidders instead of four in group (10). static and RT profit increases. The baseline adaptive bid-der performs worse than static bidder for most parameter combinations, since the bidding considers only a subset of parameters. This is a manifestation of the fact that a sim-pler intuitive adaptive strategy is not likely to perform well, especially since optimal bid depends on a large number of parameters. The baseline adaptive bidder, at m = 0 perform very similar to (but not the same) as the static optimal bid-der for uniform competitor bids as typical CTR values are very small compared to the optimal bids. Details of experi-ments and results analyzing effect of variation of parameters, robustness of the proposed method, and bidding times may be found in Balakrishnan and Bhatt [3].
An emerging category of the online ads are the group-buy deals requiring minimum number of purchases. For an ad-vertiser or intermediary selling these deals, optimizing bids is necessary for maximal profits. Existing bidding strate-gies are sub-optimal for these deals, as they do not consider minimum group-size guarantees and expiry timings. To this end, we propose a real time bidding strategy for guaranteed deals. We derive the expected profits as a function of the dynamic and static parameters of the deals. These expected profits are shown to be non-convex, and numerically opti-mized against the bid values. To satisfy the stringent time constraints of online bidding, we use several approximations and running time optimizations. Our empirical comparisons with base adaptive and the existing static strategies on a multi-million click log show significant profit improvements. [1] Daily deals rescue local-ad market, Wall Street [2] K. Anand and R. Aron. Group buying on the web: A [3] R. Balakrishnan and R. Bhatt. Real-time bid [4] C. Boutilier, D. Parkes, T. Sandholm, and W. Walsh. [5] J. Chen, X. Chen, and X. Song. Bidder X  X  strategy [6] Y. Chen, P. Berkhin, B. Anderson, and N. Devanur. [7] P. Dasgupta, P. Hammond, and E. Maskin. The [8] D. Easley and J. Kleinberg. Networks, crowds, and [9] A. Ghosh, P. McAfee, K. Papineni, and [10] M. Grabchak, N. Bhamidipati, R. Bhatt, and D. Garg. [11] V. Krishna. Auction theory . Academic press, 2009. [12] A. Mehta, A. Saberi, U. Vazirani, and V. Vazirani.
