 Dynamic routing circuit models are among the most prominent neural models for invariant recogni-tion [1] (also see [2] for review). These models implement sh ift invariance by dynamically changing spatial connectivity to transform an object to a standard po sition or orientation. The connectivity between the raw input and invariant output layers is control led by routing units, which turn certain subsets of connections on or off (Figure 1A). An important fe ature of this model is the explicit rep-resentation of what and where information in the main network and the routing units, respe ctively; the routing units use the where information to create invariant representations.
 Traditional solutions for shift invariance are neurobiolo gically implausible for at least two reasons. First, there are too many synaptic connections: for N input neurons, N output neurons and N possible input-output mappings, the network requires O( N 2 ) connections in the routing layer X  between each of the N routing units and each set of N connections that that routing unit gates (Figure 1A). Second, these connections must be extremely precise: e ach routing unit must activate an input-output mapping ( N individual connections) corresponding to the desired shif t (as highlighted in Figure 1A). Other approaches that have been proposed, inclu ding invariant feature networks [3,4], also suffer from significant drawbacks, such as the inabilit y to explicitly represent where information [2]. It remains an open question how biology could achieve sh ift invariance without profligate and precise connections.
 In this article, we propose a simple solution for shift invar iance for quantities that are circular or periodic in nature X  X ircular-shift invariance (CSI) X  X rient ation invariance in vision and key invari-ance in music. The visual system may create orientation-inv ariant representations to aid recognition under conditions of object rotation or head-tilt [5,6]; a si milar mechanism could be employed by the auditory system to create key-invariant representatio ns under conditions where the same melody Figure 1: Dynamic routing. A In traditional dynamic routing, connections from the (raw) input layer to the (invariant) output layer are gated by routing units. F or instance, the mapping from A to 5, B to 6, . . . , F to 4 is achieved by turning on the highlighted routin g unit. B In time-division multiplexing (TDM), the encoder samples input channels periodically (us ing a rotating switch) while the decoder sends each sample to the appropriate output channel (based o n its time bin). TDM can be extended to achieve a circular-shift transformation by altering the an gle between encoder and decoder switches (  X  ), thereby creating a rotated mapping between input and outp ut channels (adapted from [7]). is played in different keys. Similar to orientation, which i s a periodic quantity, musical notes one octave apart sound alike, a phenomenon known as octave equiv alence [8]. Thus, the problems of key invariance and orientation invariance admit similar so lutions.
 Deriving inspiration from time-division multiplexing (TD M), we propose a neural network for CSI that uses phase to encode and decode information. We modulat e the temporal window of commu-nication between (raw) input and (invariant) output neuron s to achieve the appropriate input X  X utput mapping. Extending TDM, any particular circular-shift tra nsformation can be accomplished by changing the relative angle,  X  , between the rotating switches of the encoder (that encodes the raw input in time) and decoder (that decodes the invariant outpu t in time) (Figure 1B). This obviates the need to hardwire routing control units that specifically mod ulate the strength of each possible input-output connection, thereby significantly reducing the comp lexity inherent in the traditional dynamic routing solution. Similarly, a remapping between the input and output neurons can be achieved by introducing a relative phase-shift in their background osc illations. To modulate the temporal window of communication, the model uses a ring of neurons (the oscilla-tion ring) to select the pool of neurons (in the projection ring) that encode or decode information at a particular time (Figure 2A). Each projection pool encodes a specific value of the feature (for exam-ple, one of twelve musical notes). Upon activation by extern al input, each pool is active only when background inhibition generated by the oscillation ring (o uter ring of neurons) is at a minimum. In addition to exciting 12 inhibitory interneurons in the proj ection ring, each oscillation ring neuron excites its nearest 18 neighbors in the clockwise direction around the oscillation ring. As a result, a wave of inhibition travels around the projection ring that a llows only one pool to be excitable at any point in time. These neurons become excitable at roughly the same time (numbered sectors, inner ring) by virtue of recurrent excitatory intra-pool connect ions.
 Decoding is accomplished by a second tier of rings (Figure 2B ). The projection ring of the first (in-put) tier connects all-to-all to the projection ring of the s econd (output) tier. The two oscillation rings create a window of excitability for the pools of neurons in th eir respective projection rings. Hence, the most effective communication occurs between input and o utput pools that become excitable at the same time (i.e. are oscillating in phase with one another [9]).
 The CSI problem is solved by introducing a phase-shift betwe en the input and output tiers. If they are exactly in phase, then an input pool is simply mapped to th e output pool directly above it. If their Figure 2: Double-Ring Network for Encoding and Decoding. A The projection (inner) ring is divided into (numbered) pools. The oscillation (outer) rin g modulates sub-threshold activity (wave-forms) of the projection ring by exciting (black distributi on) inhibitory neurons that inhibit neigh-boring projection neurons. A wave of activity travels aroun d the oscillation ring due to asymmetric excitatory connections, creating a corresponding wave of i nhibitory activity in the projection ring, such that only one pool of projection neurons is excitable (s pikes) at a given time. B Two instances of the double-ring structure from A. The input projection ri ng connects all-to-all to the output pro-jection ring (dashed lines). Because each input pool will sp ike only during a distinct time bin, and each output pool is excitable only in a certain time bin, comm unication occurs between input and output pools that are oscillating in phase with each other. A ppropriate phase offset between input and output oscillation rings realizes the desired circular shift (input pool H to output pool 1, solid arrow). C Interactions among pools highlighted in B. phases are different, the input is dynamically routed to an a ppropriate circularly shifted position in the output tier. Such changes in phase are analogous to adjus ting the angle of the rotating switch at either the encoder or the decoder in TDM (see Figure 1B). Th ere is some evidence that neural systems could employ phase relationships of subthreshold o scillations to selectively target neural populations [9-11]. We implemented this solution to CSI on a neuromorphic silico n chip [12]. The neuromorphic chip has neurons whose properties resemble that of biological ne urons; these neurons even have intrin-sic differences, thereby mimicking heterogeneity in real n eurobiological systems. The chip uses a conductance-based spiking model for both inhibitory and ex citatory neurons. Inhibitory neurons project to nearby excitatory and inhibitory neurons via a di ffusor network that determines the spread of inhibition. A lookup table of excitatory synaptic connec tivity is stored in a separate random-access memory (RAM) chip. Spikes occurring on-chip are conv erted to a neuron address, mapped to synapses (if any) via the lookup table, and routed to the ta rgeted on-chip synapse. A universal serial bus (USB) interface chip communicates spikes to and f rom a computer, for external input and Figure 3: Traveling-wave activity in the oscillation ring. A Population activity (5ms bins) of a pool of eighteen (adjacent) oscillation neurons. B Increasing the strength of feedforward excitation led to increasing frequencies of periodic firing in the  X  and  X  range (1-10 Hz). Strength of excitation is the amplitude change in post-synaptic conductance due to a single pre-synaptic spike (measured relative to minimum amplitude used). data analysis, respectively. Simulations on the chip occur in real-time, making it an attractive option for implementing the model.
 We configured the following parameters: We were able to create a stable traveling wave of background a ctivity within the oscillation ring. We transiently stimulated a small subset of the neurons, whi ch initiated a wave of activity that propagated in a stable manner around the ring after the trans ient external stimulation had ceased (Figure 3A). The network frequency determined from a Fourie r transform of the network activity smoothed with a non-causal Gaussian kernel (FDHM = 80ms) was 7.4Hz. The frequency varied with the strength of the neurons X  excitatory connections (F igure 3B), measured as the amplitude of the step increase in membrane conductivity due to the arriva l of a pre-synaptic spike. Over much of the range of the synaptic strengths tested, we observed st able oscillations in the  X  and  X  bands (1-10Hz); the frequency appeared to increase logarithmica lly with synaptic strength. In order to assess the best-case performance of the model, th e background activity in the input and output projection rings was derived from the input oscillat ion ring. Their spikes were delivered to the appropriately circularly-shifted output oscillation neurons. The asymmetric feedforward con-nections were disabled in the output oscillation ring. For i nstance, in order to achieve a circular shift by k pools (i.e. mapping input projection pool 1 to output projec tion pool k + 1 , input pool 2 to output pool k + 2 , and so on), activity from the input oscillation neurons clo sest to input pool 1 was fed into the output oscillation neurons closest to output po ol k . By providing the appropriate phase difference between input and output oscillation, we were ab le to assess the performance of the model under ideal conditions. In the Discussion section, we discu ss a biologically plausible mechanism to control the relative phases. Figure 4: Phase-based encoding. Rasters indicating activi ty of projection pools in 1ms bins, and mean phase of firing (  X   X  X ) for each pool (relative to arbitrary zero time). The absc issa shows firing time normalized by the period of oscillation (which may be co nverted to firing phase by multiplica-tion by 2  X  ). Under constant input to the input projection ring, the inp ut pools fire approximately in sequence. Two cycles of pool activity normalized by maximum firing rate for each pool are shown in left inset (for clarity, pools 1-6 are shown in the top pane l and pools 7-12 are shown separately in the bottom panel); phase of background inhibition of pool 4 is shown (below) for reference. Phase-aligned average 1 of activity (right inset) showed that the firing times were re latively tight and uniform across pools: a standard deviation of 0.0945 period s, or equivalently, a spread of 1.135 pools at any instant of time.
 We verified that the input projection pools fired in a phase-sh ifted fashion relative to one another, a property critical for accurate encoding (see Figure 2). We stimulated all pools in the input pro-jection ring simultaneously while the input oscillation ri ng provided a periodic wave of background inhibition. The mean phase of firing for each pool (relative t o arbitrary zero time) increased nearly linearly with pool number, thereby providing evidence for a ccurate, phase-based encoding (Figure 4). The firing times of all pools are shown for two cycles of bac kground oscillatory activity (Figure 4 left inset ). A phase-aligned average 1 showed that the timing was relatively tight (standard devia tion 1.135 pools) and uniform across pools of neurons (Figure 4 right inset ).
 We then characterized the system X  X  ability to correctly dec ode this encoding under a given circular shift. The shift was set to seven pools, mapping input pool 1 t o output pool 8, and so on. Each input pool was stimulated in turn. We expected to see only the appro priately shifted output pool become highly active. In fact, not only was this pool active, but oth er pools around it were also active, though to a lesser extent (Figure 5A). Thus, the phase-encod ed input was decoded successfully, and circularly shifted, except that the output units were broad ly tuned.
 To quantify the overall precision of encoding and decoding, we constructed an input-locked aver-age of the tuning curves (Figure 5B): the curves were circularly shifted to the left by an amount corresponding to the stimulated input pool number, and the r aw pool firing rates were averaged. If the phase-based encoding and decoding were perfect, the pea k should occur at a shift of 7 pools. Figure 5: Decoding phase-encoded input. A In order to assess decoding performance under a given circular shift (here 7 pools) each input pool was stimulated in turn and activity in each output pool was recorded and averaged over 500ms. The pool X  X  response, n ormalized by its maximum firing rate, is plotted for each stimulated input pool (arrows poin ting to curves, color code as in Figure 4). Each input pool stimulation trial consistently resulted in peak activity in the appropriate output pool; however, adjacent pools were also active, but to a lesser ext ent, resulting in a broad tuning curve. B The best-fit Gaussian (dot-dashed grey curve,  X  = 2.30 pools) to the input-locked average of the raw pool firing rates (see text for details) revealed a maximum be tween a shift of 7 and 8 pools (inverted grey triangle; expected peak at a shift of 7 pools).
 Indeed, the highest (average) firing rate corresponded to a s hift of 7 pools. However, the activity corresponding to a shift of 8 pools was nearly equal to that of 7 pools, and the best fitting Gaus-sian curve to the activity histogram (grey dot-dashed line) peaked at a point between pools 7 and 8 (inverted grey triangle). The standard deviation (  X  ) was 2.30 pools, versus the expected ideal  X  of 1.60, which corresponds to the encoding distribution (  X  = 1.135 pools) convolved with itself. We have demonstrated a biologically plausible mechanism fo r the dynamic routing of information in time that obviates the need for precise gating of connecti ons. This mechanism requires that a wave of activity propagate around pools of neurons arranged in a ring. While previous work has described traveling waves in a ring of neurons [13], and a dou ble ring architecture (for determining head-direction) [14], our work combines these two features (twin rings with phase-shifted traveling waves) to achieve dynamic routing. These features of the mod el are found in the cortex: Bonhoeffer and Grinwald [15] describe iso-orientation columns in the c at visual cortex that are arranged in ring-like pinwheel patterns, with orientation tuning chan ging gradually around the pinwheel center. Moreover, Rubino et al. [16] have shown that coherent oscill ations can propagate as waves across the cortical surface in the motor cortex of awake, behaving m onkeys performing a delayed reaching task.
 Our solution for CSI is also applicable to music perception. In the Western twelve-tone, equal-temperament tuning system (12-tone scale), each octave is d ivided into twelve logarithmically-spaced notes. Human observers are known to construct mental representations for raw notes that are invariant of the (perceived) key of the music: a note of C h eard in the key of C-Major is percep-tually equivalent to the note C# heard in the key of C#-Major [ 8,17]. In previous dynamic routing models of key invariance, the tonic X  X he first note of the key (e .g., C is the tonic of C-Major) X  supplies the equivalent where information used by routing units that gate precise connect ions to map the raw note into a key-invariant output representation [17].
 To achieve key invariance in our model, the bottom tier encod es raw note information while the top tier decodes key-invariant notes (Figure 6). The middle tie r receives the tonic information and aligns the phase of the first output pool (whose invariant represent ation corresponds to the tonic) with the appropriate input pool (whose raw note representation corr esponds to the tonic of the perceived key). Figure 6: Phase-based dynamic routing to achieve key-invar iance. The input (bottom) tier encodes raw note information, and the output (top) tier decodes key-invariant information. The routing (middle) tier sets the phase of the background wave activity in the input and output oscillation rings (dashed arrows) such that the first output pool is in phase wit h the input pool representing the note corresponding to the tonic. On the left, where G is the tonic, input pool G, output pool 1, and the routing tier are in phase with one another (black clocks), wh ile input pool C and output pool 6 are in phase with one another (grey clocks). Thus, the raw note inpu t, G, activates the invariant output 1, which corresponds to the perceived tonic invariant represe ntation (heavy solid arrows). On the right, the same raw input note, G, is active, but the key is different and A is now the active tonic; thus the raw input, G, is now mapped to output pool 11.
 The tonic information is supplied to a specific pool in the rou ting ring according to the perceived key. This pool projects directly down to the input pool corre sponding to the tonic. This ensures that the current tonic X  X  input pool is excitable in the same t ime bin as the first output pool. Each of the remaining raw input notes of the octave is mapped by tim e binning to the corresponding key-invariant representation in the output tier, as the pha ses of input pools are all shifted by the same amount. Supporting evidence for phase-based encoding of note information comes from MEG recordings in humans: the phase of the MEG signal (predomina ntly over right hemispheric sensor locations) tracks the note of the heard note sequence with su rprising accuracy [18].
 The input and output tiers X  periods must be kept in lock-step , which can be accomplished through more plausible means than employed in the current implement ation of this model. Here, we main-tained a fixed phase shift between the input and output oscill ation rings by feeding activity from the input oscillation ring to the appropriately shifted pool in the output oscillation ring. This approach allowed us to avoid difficulties achieving coherent oscilla tions at identical frequencies in the input and output oscillation rings. Alternatively, entrainment could be achieved even when the frequencies are not identical X  X  more biologically plausible scenario X  X f the routing ring resets the phase of the input and output rings on a cycle-by-cycle basis. Lakatos et al. [19] have shown that somatosen-sory inputs can reset the phase of ongoing neuronal oscillat ions in the primary auditory cortex (A1), which helps in the generation of a unified auditory-tactile p ercept (the so-called  X  X earing-Hands Effect X ).
 A simple extension to our model can reduce the number of conne ctions below the requirements of traditional dynamic routing models. Instead of having all-to-all connections between the input and output layers, a relay layer of very few ( M  X  N ) neurons could be used to transmit the spikes form the input neurons to the output neurons (analogous to th e single wire connecting encoder and decoder in Figure 1B). A small number of (or ideally even one) relay neurons suffices because encoding and decoding occur in time . Hence, the connections between each input pool and the relay neurons require O( M N )  X  O( N ) connections (as long as M does not scale with N ) and those between the relay neurons and each output pool require O( M N )  X  O( N ) connections as well. Thus, by removing all-to-all connectivity between the inpu t and output units (a standard feature in traditional dynamic routing models), the number of require d connections is reduced from O( N 2 ) to O( N ). Further, by replacing the strict pool boundaries with nea rest neighbor connectivity in the projection rings, the proposed model can accommodate a cont inuum of rotation angles.
 In summary, we propose that the mechanism of dynamic routing through neuronal coherence could be a general mechanism that could be used by multiple sensory and motor modalities in the neo-cortex: it is particularly suitable for placing raw informa tion in an appropriate context (defined by the routing tier).
 Acknowledgments References
