 Appearance-based image indexing can be roughly divided into two approaches: global method and local method. Local appearance describes the characteris-tics of small area around some specific points. This approach has advantage of robustness to partial occlusions and background changes. Furthermore, this technique is appropriate to multiple object search and pose recognition because it matches corresponding features in images and is consequently able to recover the structure of images.
 mation is concentrated: such points are called interest points. After the extrac-tion of interest points, the characteristics of local area around each extracted interest point is described by a local descriptors vector. Finally, the interest points are matched according to the similarity of local descriptors. At every step of these processes, a lot of studies for improvement have been proposed and evaluated.
 ods are a corner detector based on Harris function [4] and a blob detector based on Laplacian. Both of them use the respon ses of Gaussian derivative filters for implementation and a problem is that Gaussian derivatives are dependent on image scale. Scale-space theory intro duced by Lindeberg [6] normalize these derivatives and generalizes interest points. Based on his scale normalized dif-ferentiation, many type of scale invariant interest point detectors are derived in the past few years [7,8,9].
 of the responses of Gaussian derivative filters which describes the neighborhood of a point. Unfortunately, it again poses a problem that Gaussian derivatives are dependent on image orientation and scale. To avoid the rotation dependency, rotation invariant vectors based on local jet components are devised [11,13,15]. Another approach to obtain rotation invariance is to normalize local jets to dom-inant direction [1,9]. This normalization is implemented by applying steerable filter [3] to the gradient direction of that point. Scale invariance is realized by describing local descriptor of interest points at multiple-scales [2,13] or by using characteristic scale to determine a radius of neighbor region [1,9]. Alternative approaches also exist, such as: SIFT descriptors proposed by Lowe [7,8] and complex filters proposed by Schaffalitzky and Zisserman [12]. Mikolajczyk and Schmid [10] reported that SIFT shows the best performance among of them, and the steerable filter follows it.
 monly used as a similarity measure of two local descriptors. This distance mea-sure has an advantage of simplicity in computation, however, it also has some disadvantages. One such is that it uses a single covariance matrix to all the points  X  this hypothesis is inadequate for some cases. Another problem is that they hypothesize error distribution as Gaussian normal without verification. observing synthetic images with controlled displacements such as small trans-lations, small stretches, and random n oises. According to the observation, we design a new distance measure for the rotation invariant local descriptors. The distance definition improves the precision of point matching.
 teristic scale ratio information. Experimental result shows effectiveness of our methods. In this paper we use local jets both in interest point detection and in description of its local neighborhoods. The following is brief introduction to local jets and its normalization to scale. Local jets are the responses of Gaussian derivative filters, and are written as where I ( x ) is image intensity, G ( x , X  ) is Gaussian distribution function, and subscripts represent partial differentiation. These L i 1 ...i n are dependent on image resolution and Gaussian parameter  X  . They are, therefore, inconvenient to use for image indexing with different scale.
 teristic scale are often used [6,9]. The normalized Gaussian derivatives of m -th order is written as To prove that D i 1 ...i m is normalized for scale, consider two images of different scale, I and I , which are connected with I ( x )= I ( x ), where x = t x . Applying Gaussian derivatives to this equation, we obtain so that we have This equation indicates that the values of D are independent of the scale of image, if  X  is properly chosen. In practice, since the scale ratio between two images is unknown, it is not clear how to choose appropriate  X  . It should satisfy  X  = t X  .
 obtained by examining some kind of function of normalized Gaussian derivatives, e.g. squared gradient, Laplacian, Harris function, and so force. The function should be chosen depending on the purpose. The characteristic scale is defined as the scale  X  where a function of normalized Gaussian derivatives takes a peak value as shown in Fig. 1. The characteristic scale is proportional to image scales, therefore we can make local jet invariant to scale by substituting characteristic scale for  X  in (2). The bottom row of Fig. 1 represents the Harris function value plotted over  X  at the points displayed center of circles in the images in the top row. Characteristic scale is represented as dashed line in the bottom row, and also represented as the radius of the circle in the top row. It indicates that the ratio between two  X  at corresponding point of each image gives the scale ratio between two images. In this section, we describe how to extract scale invariant interest points. Several methods are proposed to extract interest points. Among of them, the method of Harris and Stephens [4] is reported to show good repeatability [14]. In the followings, Harris method extended to scale space is introduced.
 represents the Gaussian parameter. For implementation, all coordinates should be represented in discrete domain. x and y are the location of a pixel, and  X  is the scale sampled at exponential intervals,  X  n = k n  X  0 . In this 3D grid space, we calculate the 2  X  2matrix: where #  X  must be proportional to  X  . In this study, we set #  X  =  X  . where k is a constant. In this study, we set k =0 . 06, which is commonly used value. This R is invariant to rotation and scale. Scale invariant interest point is defined as coordinates ( x, y,  X  ) where the function gives local extrema of R . In practice, certain threshold value t is set to avoid the clutters. Summarizing In this paper, we set threshold value t = 4000. As a result, the average number of extracted point per image is about 50 to 200.
 and scales. Figure 2 is an example. This figure shows interest points of two images with different scale and rotation. Interest points are represented as white dot in the figure. Each point has 3D coordinates, x, y,  X  -coordinates. If they are compared in each same row respectively, they do not correspond at all. However, they do correspond if taken as point group in 3D space. In this section, we consider how to describe the characteristics of the region around each interest point. It is desirable that this descriptor is robust to illu-mination change, camera position, camera noise, etc.
 scale to  X  in (2), it obtains invariance to scale. There are several candidates for function to determine the characteristic scale as described before. In this study, we already calculated Harris function to extract interest points, so we use this again. In this case, characteristic scale is the same as  X  -coordinate of interest point. This local jets are invariant to scale but not to rotation. To obtain the invariance to rotation, combine the components as: where  X  xy =  X   X  yx =1,  X  xx =  X  yy = 0. This vector  X  is invariant to rota-tion [11,13].
 to D i 1 ...i m /D . By this substitution (so we don X  X  use  X  [0]), the vector becomes invariant to linear illumination change. We use this 8-dimensional vector  X  as the interest point descriptor. atives may provide more accurate descriptor and may improve the precision of point matching, however, higher order term is likely to make descriptors more sensitive to noise, and have disadvantage that increase computational cost. For this reason, we use terms up to third order derivatives. 5.1 Test for Normality of Error Distribution Owing to the local descriptor derived in the last section, interest point matching based on their local features is now available. Matching candidates are deter-mined by measuring similarity between descriptors, i.e. the point whose descrip-tor gives the smallest distance from the descriptor of query point in the feature space is considered as a matching candidate. To implement this process, the distance measure between two descriptors must be defined. In existing method, Maharanobis distance (where  X   X  1 is inverse of covariance matrix) is used frequently [13,9]. This method has advantage that it can be calculated easily, but it also has disadvantage or incompleteness. One incompleteness is caused by the fact that it ideally requires covariance matrix for each and every cluster, where in this case cluster means the set of interest points that should be regarded to correspond. In the real situation, since there exist infinite variety of interest point, it is impossible to know all covariance matrices in advance. Ordinary implementation uses only one global covariance matrix as a substitute for such covariance matrices. Another incompleteness is that it is based on the assumption that the error of descrip-tors should follow normal distribution, but this assumption is verified neither theoretically nor experimentally.
 as follows. We define the error as the difference between true value and ob-served value for each local descriptor of the interest point. Observed value is the summation of true value and observation noise.
 process. To simulate these two noise artificially, we employ the function which gives ellipse image (Fig. 3). We modify this image by slight translation (less than one pixel), and slight scale change, and adding 10% white noise, i.e. where a represents stretch ratio, u represents small translation, and w repre-sents white noise. Numerous I are made, and the statistics of local descriptors observed in whole these images are considered as the error distribution of local descriptors under noise. Figure 4 is the result of D x . This distribution is sym-metric, has a single peak, forms a bell curve, looks like a normal distribution. To verify the normality of distributions, we also apply the Kolmogorov-Smirnov test for normality. Table 1 represents the result. The result indicates that it is adequate to regard the distribution of original local jets have normality, but it is not adequate to regard the distribution of rotation invariant descriptors constructed by combination of local jets have normality.
 following discussion. The observation error of rotation invariant descriptors e is expressed as: where  X  represents true value, #  X  represents observed value, and  X  [ i ]represents the i -th element of vector  X  . On the other hand, the error of local jet  X   X  is defined as As mentioned above, it is adequate to hypothesize that  X   X  follows normal dis-tribution. If we hypothesize that, the error distribution for the combination of some D  X  is obtained by calculation. For example, the error of -D x -D x is calculated as: This equation indicates that errors expand proportional to the values of D x .It derives the non-normality of  X  , corresponding to our observation. 5.2 The Arranged Definition of Distance Measure Since we have found that the error of  X  does not follow normal distribution, we should rearrange distance measure according to this speculation.
 evaluated as equation is evaluated as 4  X  2 ( D 2 x + D 2 y ). Therefore, if we divide this equation by 4( D 2 x + D 2 y ), the variance of error is normalized to constant value,  X  2 .(In practice, since the true value of D x ,D y is unknown, the maximum likelihood estimate -D x , -D x is used instead). Same calculation is made to the rest element of  X  ,andweobtain e [2]  X  2  X  x ( D xx D x + D xy D y )+2  X  y ( D yy D y + D x D xy ) (16) e [3]  X   X  xx +  X  yy , These equations lead us to normalization of error variance for each coordinate of  X  .
 two local descriptor vector d (  X  i ,  X  j ) is defined as  X  [1] = 4( D 2 x + D 2 y ) , and so force (omitted  X  [3 .. 8] are easily derived from (16)).  X  i is calculated by the derivatives correspond to  X  i ,and  X  j is calculated by the derivatives correspond to  X  j . 5.3 Experimental Verification of Arranged Distance Measure We also made a experiment to verify the effect of our new definition of distance measure. First, we extract 1306 interest points from 21 test images, and then calculate distance for all combinations (1306  X  1305/2=852165 pairs), and sort it in increasing order. In following experiment, this sorted distance table is re-ferred to evaluate how small the distance is. On the other hand, we calculate distance between each pair of corresponding point of synthetic images. In this time synthetic modification are made by where R represents rotation matrix. The descriptor  X  is ideally robust to such modifications. At last, we evaluate how small the distances of two  X  with dif-ferent modification is, by use of ranked distance table obtained above. In the evaluation, we use the largest distance (worst) and average distance (mean). Same experiment are executed in four cases, that is, the dimensions of vector  X  is set either 8-dimension (it means up to third order derivatives are used) or 4-dimension (up to second order derivatives are used), and ordinary Maha-lanobis distance and our arranged distance is applied respectively. In ordinary Mahalanobis distance case,  X  is covariance matrix of all 1306 descriptors. we use the Mahalanobis distance measure of 4-dimension, corresponding point stand at rank 22561 of 852165, it means that the correct matching stand inner of about 2.6%. On the other hand, if we use our arranged distance measure of 4-dimension, the correct match stand at rank 3641 of 852165, it means that stand inner of 0.43%. Furthermore, if we u se arranged measure of 8-dimension, the result is improved moreover. These result represents the advantage of our method.
 dominant direction by steerable filter. However, this type of descriptor needs highly precise dominant direction estimation. We found it difficult to obtain suf-ficient repeatability and distinctiveness if the dimension of descriptor is relatively low as this experiment. Since the characteristic scale is proportional to image resolution, the proportion of characteristic scale of corresponding point in two image should be constant. By using this properties, we can roughly guess the scale proportion between two images. It leads to elimination of false matching. In this section, according to this consideration, we propose a new modification to image indexing method. tance for all interest points in the database. For each point in query, the nearest neighbor point (the point which gives minimum distance) in the each image of database is set as first candidate for corresponding point (top of Fig. 5). This estimate is obtained by voting method based on the first candidates for corresponding point obtained in the last step. Table 3 is the example. As plotting candidate of corresponding point on the table, we may find the diagonal area where much votes concentrates if two image is corresponding (as top of Table 3 ). In the case of this example, we can find diagonal line one block upper from main diagonal line acquires much votes. This is the good estimate of scale proportion of two images. In practice, we accumulate the number per scale ratio (as bottom of Table 3 ), and the proportion with maximum vote is taken as estimate for scale proportion. In this example, the proportion 1:1.2 acquires the maximum vote, therefore we can estimate the scale proportion of two images as 1:1.2. inate false positive matching candidates. It is, if the candidate combination is off the line of Table 3, it is likely to false matching. It should be discarded and new candidate should be taken among the on-line combination. That is to say, we choose a first candidate of corresponding point as the nearest neighbor point in the whole points in the database at first, and after the estimation of scale be-tween two images, the candidate point is re-chosen as the nearest neighbor point in the limited points which has estimated proportion of characteristic scale to the query point. By this operation, we can eliminate the false positive matches, and able to improve the accuracy of point matching (bottom of Fig. 5). metric coherence check or RANSAC. However test of such type has problem that the calculation cost explode as number of interest points increases. In contrast to it, the cost of elimination method proposed in this section is linear to the number of interest points. Furthermore, we may also apply geometric elimina-tion method after proposed elimination method with far lower computational cost. The reduction of the number of candidate points is experimentally verified in the next section. In order to verify the effect of our method for indexing, we made an image retrieval experiment for an image database consists of 852 images. The database contains scanned picture postcards published in our city in the last hundred years. Parts of them are shown in Fig. 6.
 same scene but with different scale and camera angle. For each pair, one image is used as the query image, and the other is included in the database. Among these pairs, 9 pairs are taken from publicly available database provided by Miko-lajczyk X  X  website [16], and 10 pairs are photoshots taken near our laboratory with different camera angle, and the rest 12 pairs are a scanned picture image and its transformed one. Applied transformations are 20 degree rotation and scale changes. Parts of them are shown in Fig. 7.
 0. Extract interest points and calculate local descriptors for all images in the 1. In the same way, extract interest points and calculate local descriptors for 2. Calculate distance for each pair of interest points between query image and 3. According to first candidate, estimate image scale ratio by voting method. 4. Re-choose the candidate point as its characteristic scale correspond to that 5. If the distance between query point and final candidate point is under certain 6. The image which marks highest matching score is chosen as indexed image. In ence check is processed after above process, but its computational cost explode as number of candidate matching increases. The reduction of the number of can-didate points significantly save the computational cost of geometric coherence check. From this viewpoint, we display the result without geometric refinement. Table 4 is the result. In the table, the recognition rate and average matching score of correct image and incorrect image is represented.
 Our indexing method without elimination choose true image in 56.3% cases, it is higher that of Mahalanobis method, 21.9%. It shows the effect of our dis-tance measure arrangement. Furthermore, by use of our false match elimination method, the recognition rate of our method grows above 80%. Remark that this refinement cost is proportional to the number of corresponding point, in contrast to cost of geometric refinement method explode as the number increases. Although the matching score of correct image decline only 24%, the matching score of incorrect image decline 61%. It leads to save the computational cost of geometric coherence check, if applied. In this paper, we proposed two ideas which improve image indexing based on local descriptors. The first idea is a new distance measure for local descriptors which improves the accuracy of point-to-point matching. The other idea reduces the number of matching candidates by voting characteristic scale ratio. The experimental result has proved the effectiveness of our method.
 dimensional local descriptors, or to add the constraints of semi-local coherence. In case of these arranged implementation, the advantage of our method still exist as the reduction of computational cost, because of its contribution to the reduction of candidate point.

