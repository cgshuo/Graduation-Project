 With the rapid development of wireless communication technologies and mobile devices, the mobile peer to peer (MP2P) network has been emerged. Since the existing MP2P architectures have high management cost, in this paper, we propose a hierarchical MP2P architecture using clustering mobile peers. The proposed method clusters the mob ile peers by considering three aspects like the maximum conn ection time, the minimum hop count and the number of the c onnected peers. The connection times between the connected peers can be determined by the location, velocity vector and co mmunication range of the mobile peers . Since the maximum connection ti me of the connected peers are considered, the network topology is relatively stable. Therefore, the management cost of the network is decreased and the success rate of contents search is increased. Experiments have shown that our proposed method outperforms the existing schemes. C.2.1 [ Network Architecture and Design ]: Distributed networks Algorithms, Performance. Mobile P2P, Ad-hoc network, Hierarchical architecture, Clustering. Recently, the MP2P over ad-hoc networks have received much attraction since the contents sh aring among PDA, smart phone and pocket PC have emerged over ad hoc networks[1-4] . In such networks, the contents search is based on multi-hop wireless communication via IEEE 802.11, Bluetooth, UWB among mobile peers. Since the mobile peers can frequently change their physical locations and establish connections with other neighbor peers, the maintenance of the network topology and searches through these networks have high expensive overheads and low success rate. A typical mobile P2P technique based on two mobile routing protocols DSR [5] and AODV [6] is called the optimized routing independent overlay network (ORION) [1]. Since it needs to broadcast a query in the whole network for searching contents, this method is not competent for large networks. To efficiently search contents in large networks, the distributed hash table (DHT) based mobile P2P methods were proposed such as M-Chord [7], M-Can [8] and Virtual Ring Routing [9]. In DHT based methods, content is associated with a unique key by hashing, and each peer is responsible for storing certain ranges of keys. Such methods can significantly decrease the search costs in a large network. However, due to the characteristics of mobile environment, the maintenance of the overlay network is high expensive. Recently, some hierarchical methods were proposed to reduce the management cost of mobile peers in dynamic network environments. These methods classi fy the peers into super peer and sub peer. Each super peer maintains the contents and routing of its sub peers. Therefore, the content search is only traversed through super peers. In [10], D. T. Ahmed, et al. proposed a multi-level hashing for peer to peer system in wireless ad hoc environment. However, this method did not consider the movement of the peers at the first level. In general environment, all of the peers are mobile peers. The super peer based method [11] and group P2P [12] are proposed in the completely mobile environment. But the connections between each connected peers will break and establish frequently, which results in high update overhead. Especially, when the mobile peers have high speed or different direction the update overhead is horrendous. In this paper, we propose a hierarchical MP2P architecture that clusters the mobile peers accord ing to the network connectivity and the mobility of peers. The proposed scheme organizes MP2P network based on three criteria, the maximum connection time of connected peers, the hop count with super peer, and the number of connected peers of the super peer. A new join peer selects the super peer which can connect fo r a longer time to register. The connection time between each connected peers can be determined by the location, velocity vector and communication range of each peer. Therefore, in this network, the frequent update overheads are avoided and the success rate of content search is promoted. The remainder of the paper is or ganized as follows. Section 2 introduces the related works. Secti on 3 presents the details of the proposed method. Section 4 contains experimental evaluation that demonstrates the superiority of our proposed method. Finally, Section 5 concludes this paper. There has been a large amount of work on the MP2P network. The existing MP2P systems can be classified into two main types: the structured systems and unstructured systems. In structured MP2P systems, in or der to form an overlay network, the participating peers are organized into a specified structure (e.g. the virtual ring or tree). For these systems, the distributed hash table (DHT) is the most effective method. The content is associated with a unique key by a specified hashing function, and each peer is responsible for storing certain range of keys. Each participating peer stores a content item with a hash value that is close to its key range. The content search request is forwarded to the intermediated peers whose hash value is close. M-Chord [7], M-Can [8] and Virtual Ring Routing [9] are typical DHT based methods. Such methods can efficien tly decrease search cost in a large network. However, the main tenance of the overlay network over mobile environments is high expensive. The unstructured MP2P systems need not to maintain the overlay network, but they have no kn owledge of the location of the contents. There are some wireless routing protocols that can be used for unstructured MP2P syst ems, such as DSR [5] and AODV [6]. The optimized routing independent overlay network (ORION) [1] is a typical MP2P technique based on these protocols. Each peer has the information of its neighbor peers, and the search message is flooded in the system until the required content is found or the specified maximum hop count is reached. If the network is large, a great number of bandwidth is needed. In [10], D. T. Ahmed, et al proposes a multi-level hashing for peer to peer system in wireless ad hoc environments. It considers that the participating peers either as mobile peers or stationary peers. The stationary peer represents a home region of the entire regions and provides useful information to its local mobile peers . However, in this paper we assume that all of the participated peers are mobile peers. To reduce the maintenance cost a nd the requirement of bandwidth, some hierarchical methods have been proposed, such as super peer based method [11] and group P2P [12]. In this network, the peers are classified into super peers and sub peers. Each super peer maintains the information of its sub peers and the contents search is only traversed through super peers. However, both super peer based method [11] and group P2P [12] have a high update overhead to maintain the network. This is because the connections between each paired peers can be broken and must be reestablished frequently when the mobile peers have high-speed or opposite direction. Therefore, in this paper, we propose a maximum connection time based MP2P network. In this section, we present an overview of our proposed MP2P architecture. The proposed archite cture is composed of peers through multiple hops. The mobile peers in this network are divided into normal peers and super peers. We divide these mobile peers into clusters according to the following three criteria:  X  The maximum connection time with the super peer  X  The maximum hop count with the super peer  X  The total number of th e connected peers of each super peer Since establishing and disconnecting connections of the mobile peers is a significant reason that causes the update overhead of the network, we construct the MP2P network by considering the maximum connection time between the normal peers and its super peers. The mobile peers with similar velocity vector and near physical location are put into the same cluster. By doing this, the frequency of disconnecting and re-e stablishing connections can be reduced. The hop count between normal peer and its super peer significantly impacts the efficiency of contents search and the cost of the network management. Therefore, when the maximum connection time is similar, the minimum hop count between normal peer and its super peer is selected. In order to balance the load of super peers, the total number of the connected peers of each super peer is limited within a predefined threshold value. The super peer communicates with the other super peers via the connected boundary peers. The normal peer communicates with its super peer via intermediated p eers. Without loss of generality, we assume that the capability of the super peer is the same as the normal peer and each normal peer can become a super peer.
 In this network, each peer has its own information &lt; Pid , Cid , denotes the cluster id it belongs to, Ptype is used to distinguish whether the peer is a normal peer, super peer or boundary peer, Connectivity is the number of connected peers, and ( x,y ) and ( v denotes the location and velocity vector of the peer. The velocity and direction of each peer is represented by velocity vector. The normal peers contain the contents and routing information of its neighbor peers and super peers. The super peers have all of the routing and contents information of the connected normal peers. Figure. 1 shows the proposed MP2P architecture, where the values between the connected peers represent the connection times. The connection time of tw o peers can be obtained by solving the equations (1), (2), and (3) detailed in 3.2. Now we describe how a new peer joins a cluster in the MP2P network. At first, a new coming peer broadcasts a hello message new peer becomes a super peer and a new cluster is created. Otherwise, the new peer uses the re sponse peer as an entry peer to join its cluster. However, if the new peer receives the multiple responses from different clusters, it selects the optimal one to join. In order to make the network relatively stable, the super peer which has a maximum connection ti me is selected. Since a normal peer communicates with its super peer via multiple hops, the hop count will directly affect the efficiency. Then, the maximum hop count of a normal peer with its super peer is limited within a predefined threshold range value. To balance the load of each super peer, the reasonable number of connected peers of each super peer is considerable. And then, the new peer becomes a boundary peer. The other peers use the same method to participate in a cluster. The connection time of paired peers can be computed according to their velocity and location information. For example, at time  X  , there are a mobile peer p at position ( x,y ) with velocity vector ( v x ,v y ) and another mobile peer q at position ( x X ,y X  ) moving with ( v x X  ,v y X  ). pos  X  at time t i , and the communication radius is r . The communication time t can be obtained by solving the below equations (1), (2), and (3). pos  X  pos  X   X  X  X  X   X   X   X   X  X os  X  A simple example of a new peer join is illustrated in Figure 2. The connection times between each paired peers are computed respectively. The connect ion time (CT) between e and a is 13, f connection time with peer f is 15 and peer g is 10, therefore, both the connection times of the new peer n with super peer a and h is 10. Since the hop count to a is 3 and h is 2, the new peer n selects cluster 2 to join. Due to battery or other reasons , peers may leave the network. There are two kinds of cases to be considered, the leaving peer sending a leaving message to its c onnected peers before leave or without sending a leave message before leave. For the first case, if the leaving peer is a normal peer and do not affect the routing of the other peers, it only send a l eaving message to its connected peers and super peer to update their routing and contents tables. However, if the leaving peer is a super peer or an intermediate peer, the remaining peers connected with it need to be re-organized. The remaining peers who receive the leaving message broadcast each other to select the ot her clusters to join. If not exist the appropriate cluster to join, the new super peer is elected. The peer with a higher expectation value is selected as the new super peer. The expectation value e takes the connection time ( CT ), the maximum maintenanc e time, minimum hop count, and maximum degree is preferable. The expectation value can be obtained by solving the equations (4). factor that adjusts the priority, w  X  [0, 1] and  X   X   X  X  large value  X   X  gives more weight to the peer X  X  connection time than its hop count and degree, where  X   X  and  X   X  are as same as  X  maximum maintenanc e time, maximum hop count and maximum degree of peer i and its neighbor peers. For the second case, in order to prevent the leave of the peers without sending leaving message, the peers send confirming messages periodically to detect the status of their connected peers. When the peer finds the disconn ection with its super peer or connected peers, it broa dcasts to find a new super peer to join or become a new super peer. The processing is similar to the join of the peer. In this section, we compare the proposed scheme with group P2P [12] in terms of the update overhead and the success rate of search. The results of super peer based method [11] are omitted as it is similar to [12]. All of the experiments were coded in Java. The mobile objects are generated by the network-based generator [13] and the arrival and departur e occurs randomly. The contents are randomly assigned with each participated peers. Table 1 summarizes the parameters for this performance evaluation. The update overhead is measured as how many times the network topologies update during the period of simulation time. The high update frequency of the networ k topology will cause high bandwidth and battery cost. The search success rate is measured as the ratio of the search success times and the total search times. The search success means that a p eer can connect to the peer that has the searched contents. In the first experiment, we evaluate the update overhead and success rate according to the variation of communication range. The deve lopment area is set to 100*100m and the maximum speed of each peer is 3m/s. Figure 3 shows that the update overhead and success rate increase with the increase of communication range. This is because when the communication range increases the mobile peers can communicate with more peers. But when the communication range reaches to 30m, the success rate is almost saturated. In the second experiment, we co mpare the effect of the hop count. The development area is set to 100*100m 2 , the maximum speed of each peer is 3m/s and th e communication range is 30m. As shown in Figure 4, with the increase of the hop count, the update overhead and content search rate increase. This is because the connected peers of a super peer will increase which increase the amount of contents in a cluster but decrease the connection time of the network. We obtain the ba lance value at the hop count 3. Figure 5 compare the group P2P and the proposed method according to the max speed of the mobile peers. The results show that the group P2P is not suitable for high-speed movement of the mobile peers. The experiments are performed in the area of 500x500m 2 . From the results we can see that the update cost increases fast with the increase of the max speed of the mobile peers. This is because the faster the movement of the mobile peers, the higher the frequency of the network re-organizing. The group P2P uses RSSI to form the network which may interrupt soon by the high-speed or the opposite direct ion of the mobile peers. Since the proposed method adopts the maximum connection time to form the network, the performance of update overhead is better than the group P2P. The success rates of content search in different areas are shown in Figure 6. In this experiment, the speed of mobile peers is set to 3m/s and the 10000 queries are issued from the participant mobile peers randomly. The experiment is executed in 100*100m 500*500m 2 . From the results, we can see that the search success rate of our proposed method is similar to group P2P in 100*100m 2 . However, our proposed method is 3 times higher than the group P2P in 500*500m 2 . This is because, in a wider area, the stable connection can improve the success rate of search. The ideal method that uses a central server is efficient but is not suitable for a large network. In this paper, we proposed a clus ter based MP2P architecture over mobile networks. The proposed method utilizes the location and velocity vector of each mobile peer to determine the maximum connection time. The network is constructed based on the proposed three criteria. Since the network is relatively stable, the update overhead is reduced and the success rate of content search is increased. The experimental results have shown that the proposed method is more efficient than the existing methods. This work was supported by the Mi nistry of Education, Science and Technology Grant funded by the Korea Government (The Regional Research Universities Program/Chungbuk BIT Research-Oriented University Consortium) and the Basic Science Research Program through the National Research Foundation of Korea(NRF) grant funded by the Korea government(MEST)(No. 2009-0080279). [1] Klemm, A. Lindemann, C. a nd WaldhorstK, O. P. 2003. A [2] Wu, H. Cheng, C. and Zhong, Z. 2010. A RESOURCE [3] Li, B. Wang, K. and Hsieh, Y. 2010. A Hierarchical Social [4] Dutta, N. 2010. A Peer to Peer based Information Sharing [5] Johnson, D. Maltz, D. and Broc h, J. 2001. DSR: The Dynamic [6] Perkins, C. and Royer, E. 1999. Ad -hoc On-Demand Distance [7] Lin, M. Chen, E. Sheu, P. C. 2006. M-Chord: A Chord-based [8] Peng, G. Li, S. Jim, H. Ma, T. 2004. M-CAN: a Lookup [9] Caesar, M. Castro,M. Nightingale,E. B. O X  X hea, G. and [10] Ahmed, D. T. and Shirmohammadi, S. 2007. Multi-level [11] Han, S. Lee, J. Song, W. a nd Yang, B. 2008. Mobile Peer-to-[12] Haw, R. Hong, C. and Kim, D. 2009. Group P2P Network [13] Thomas B. 2002. A Framework for Generating Network-
Figure 6. The success rates according to different areas. 
