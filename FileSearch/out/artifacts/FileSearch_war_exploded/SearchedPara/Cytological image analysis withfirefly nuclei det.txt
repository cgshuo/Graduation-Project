 1. Introduction Breast cancer is the most common cancer among women.
 According to the International Agency for Research on Cancer, in 2008 there were 1,384,155 diagnosed cases of breast cancer worldwide, where over 33% of them resulted in death ( Ferlay et al., 2010 ; Bray et al., 2012 ). The timely detection of the disease is crucial for the effectiveness of treatment. In practice, an often used diagnostic method is the so-called triple-test. The test consists of three medical examinations: self-examination (palpation), mammography or ultrasonography imaging, and fi ne needle biopsy (FNB) ( Underwood, 1987 ). In FNB, the material is collected directly from the tumor and then examined under a microscope. The cytological examination requires experience and extensive knowledge of the cytologist. A computer-aided diagnosis system can assist specialists and provide objective diagnostic information.
This paper shows the continuations of authors' work on early breast cancer detection ( Filipczuk et al., 2011a , b , 2013 ; Krawczyk et al., 2012 ). For the presented task of fi ne needle biopsy image classi fi cation we use the mentioned one-class decomposition strategy. We additionally extend it by delegating to each of the classes not a single predictor, but an ensemble. In our previous works we have shown that increasing the number of one-class classi fi ers responsible for learning the target concept leads to a signi fi cant boost in the accuracy ( Krawczyk and Wo  X  niak, 2012a ).
Designing one-class ensembles still awaits proper attention, with only few works dedicated to theoretical advances in this fi ( Krawczyk and Wo  X  niak, 2012b , in press ; Li and Zhang, 2008 ; Yeh et al., 2009 ). Recently it was suggested that ensemble pruning may further improve the performance of one-class ensembles ( Cheplygina and Tax, 2011 ), while we introduced novel diversity measures dedicated to classi fi er selection for this task ( Krawczyk, 2012 ). Now we would like to extend this by proposing a hybrid ensemble pruning procedure dedicated to one-class ensembles. It combines two criteria for evaluating one-class predictors with a memetic algorithm for an ef fi cient search over the possible combinations of classi fi ers. Exhaustive computational tests prove that our ensemble outperforms canonical classi fi er committees and binary decomposition methods.

The proposed ensemble is used to classify independently all nine images representing the examined patient (see Section 4 ).
Then a fi nal decision about the state of the patient is made on the basis of these individual ones. Using one-class classi fi for a multi-class decomposition allows us to capture ef fi unique characteristics of examined classes and in consequence to accurately discriminate between them. The results presented in this paper demonstrate that a computerized medical diagnosis system based on our method would be effective and can provide valuable and accurate diagnostic information.
 introduction into breast cancer diagnosis. Section 3 describes the acquisition process of the medical images used for testing. A framework for the one-class classi fi er medical decision support system is introduced in Section 4 . Segmentation and feature extraction are described in Section 5 , while Section 6 presents the classi fi cation algorithm. Section 7 shows the experimental results obtained by the proposed method. The paper ends with our conclusions. 2. Background has been conducted in areas such as image processing, pattern recognition and machine learning. Several computer-aided diag-nosis frameworks have been proposed ( Plissiti et al., 2011 ;
 X  mieta  X  ski et al., 2010 ). However, for breast cancer diagnosis based on cytological examination, there is still little fully auto-matic complete solutions that include entire processing from data acquisition to obtaining the diagnosis. Jele  X  et al. (2010) presented an approach based on the level sets segmentation method with results reaching 82.6%. Niwas et al. (2010) reported 93.33% classi fi cation accuracy using a wavelet transform and the analysis of nuclei texture. Another approach was presented by Malek et al. (2009) . Using active contours and fuzzy c-means algorithm they achieved 95% accuracy. These works concern the problem of distinguishing two classes: benign and malignant. In our research we have introduced the third class: fi broadenoma. This is not cancerous, but might have features similar to malignant neoplasm and confuse the system. With this in mind, we decided to use a hybrid one-class classi fi cation decomposition.
 machine learning approach. Instead of learning how to distinguish between a given set of classes, OCC focuses on learning the properties of a single class. It can be used to differentiate a particular concept from a wider set of classes (e.g., birds from animals or malicious attacks from all types of on-line activities). At the classi fi er training stage we have access to objects from only one class, known as the target concept and denoted as  X  T
Duin, 2005 ). It is assumed that during the exploitation of such a classi fi er new, unseen objects may appear. They may originate from a single or many distributions and we do not have any a priori information about their properties. Such objects are called outliers and denoted as  X  O . Without any insight into the nature of their presence ( Manevitz and Yousef, 2007 ). OCC aims at deriving a classi fi cation boundary that may separate the known target objects from possible outliers. The term single-class classi originates from Koch et al. (1995) , but also outlier detection or novelty detection ( Bishop, 1994 ) are used to name this fi of study.

OCC fi nds its use in the real world applications where positive examples are abundant and easy to gather but at the same time counterexamples are expensive or even impossible to gather ( Cohen et al., 2008 ). For illustration purposes let us consider an engine. It is trivial to collect data about its normal work mode, but gathering observations about its unwanted behavior is expensive and sometimes even impossible, because one would have to spoil the engine.

Here we would like to note that there is also a second approach to the OCC task. One may use it for a multi-class dataset as a tool for class decomposition. Usually it could be easy to decompose the problem into simpler ones. It is rooted in human behavior, as we usually learn the complex concept (e.g., character recognition) step by step. For multi-class classi fi cation creating a classi shows good discriminative properties for all classes is often a very hard task. That is why we can split (decompose) this process into several binary problems ( Duan et al., 2003 ). By delegating a classi fi er to a simpli fi ed problem we reduce the complexity of the decision area. Therefore classi fi ers may achieve local speciali-zation and better capture the properties of the binary problem.
There are two popular strategies for such a decomposition versus-all (OVA) and one-versus-one (OVO) ( Galar et al., 2011 ).
Finally a key problem in this approach is reconstructing the original multi-class task from several binary ones via a dedicated fusion method ( Burduk, 2013 ). Here the best known approaches are Error-Correcting Output Codes ( Dietterich and Bakiri, 1995 ) and Decision Templates ( Kuncheva et al., 2001 ). Instead of binary classi fi ers one may apply OCC, therefore getting N one-class classi fi ers for a N class problem. The main difference lies in the idea behind the decomposition  X  in binary we hope to gain simpli fi ed decision problems that can be easily separated, while in one-class we hope to learn distinct properties of each of the classes. The difference between these methods is depicted in Fig. 1 . In this work we use a dedicated one-class model, named Support Vector Data Description (SVDD) ( Tax and Duin, 2004 ).
This classi fi er estimates a closed boundary around the data in a form of a hypersphere, which can be fully described by only two parameters  X  a center a and radius R . In its basic form, the hypersphere is grown from the center a , until all objects from the training set TS are enclosed in its volume. Yet this approach often leads to a poor performance due to too big enclosing volume and leads to a high outlier acceptance rate. Therefore, identical as in the canonical Support Vector Machine one may introduce slack variables  X  ( Burges, 1998 ) to include the possibility of outliers in TS . SVDD is a very popular one-class classi fi er and has proven itself in many real-life problems such as monitoring of a chemical solid state fermentation of crops ( Jiang et al., 2012 ) or veri of radio-transmitted data ( Gong et al., 2011 ). 3. Acquisition of medical images
All methods presented in this work were tested on the real medical data. For this purpose, 675 images were collected from 75 patients (25 benign, 25 malignant and 25 fi broadenoma). Each patient is represented by 9 images selected by a pathologist arbitrarily. The number of images was recommended by the specialists from the hospital and allows for correct diagnosis by them.

The cytological material was obtained by fi ne needle biopsy from patients of the Regional Hospital in Zielona G X ra, Poland. Biopsies without aspiration were performed under the control of ultrasonograph with a 0.5 mm diameter needle. Smears from the material were fi xed in spray fi xative (Cell fi x by Shandon) and dyed with hematoxylin and eosin (H&amp;E). The time between preparation of smears and their preservation in fi xative never exceeded 3 s. All cancers were histologically con fi rmed and all patients with benign disease were either biopsied or followed for a year.

The images were recorded by a Sony CCD Iris color video camera mounted atop an Axiophot microscope. The slides were projected into the camera with 160 objective and 2.5 ocular giving together an enlargement of 400 . Images are BMP fi 704 578 pixels, 8 bit/channel RGB. 4. Framework for patient classi fi cation
In the described breast cancer diagnostic procedure each patient corresponds to the nine separate cytological images, which are parts of the biopsy smear. The physician examines all of these images and on the basis of her/his experience gives a fi nal diagnosis. One should note that these images are not correlated with each other, because they are chosen arbitrarily by the pathologist i.e., the fi rst image from the i -th patient may describe a completely different area of the biopsy sample than the image from the j -th patient.

To create a decision support system that will be easy to use for physicians we decided to preserve this diagnostic structure.
We train the classi fi er on all images from the training set and then use it to produce nine independent decisions about the individual images belonging to a tested patient. Then an aggregation proce-dure fuses these outputs and thus returns a fi nal diagnosis about the state of the patient under examination. The proposed frame-work is presented in Fig. 2 .
 Let us present the advantages of the proposed approach: The fi nal decision is made on the basis of more than one image.
This prevents from making a decision on the basis of an unrepresentative part of the biopsy sample, as cancerous cells may be distributed differently along the sample. Such a situa-tion may be especially dangerous for patient health and life if cancerous cells get overlooked. For this we propose decision rule for fusing the results from individual images (see Section 6.3 for details).

The proposed classi fi er ensemble is being trained on the data from all the available images. This improves the overall com-petence of the pattern recognition system. Cancerous cells have similar properties, so even of the tested image came from a completely different part of the biopsy sample the general-ization properties of the system will allow for a precise classi fi cation.

By using a fusion procedure on the individual outputs for nine images we improve the robustness of the decision support system. This leads to the reduction of the number of wrong diagnosis for the patients even if some of the individual images were misclassi fi ed.

For classi fi cation we propose to use a class decomposition approach realized through an effective hybrid ensemble of one-class classi fi ers. By using OCC combined with memetic pruning we are able to capture the properties of the examined classes and recognize them with an excellent accuracy. Addi-tionally the OCC ensemble can cope with dif fi culties in data distribution such as rare examples or data chunks, which can cause problems for canonical binary classi fi ers. 5. Nuclei segmentation and feature extraction
Before features can be extracted, cell nuclei need to be isolated from the background and red blood cells. Due to the complex nature of cytological images, nuclei segmentation is a challenging task. In this work, we propose a segmentation procedure involving the marker-controlled watershed preceded by the nuclei detection based on the modi fi ed fi re fl y algorithm. With the presented method, we achieved signi fi cantly better results than with fuzzy c-means and Gaussian mixture model based approaches (see Section 7 ).
 watershed algorithm ( Beucher and Lantu X joul, 1979 ; Meyer, 1994 ) tends to produce over-segmentation. This is particularly visible for images with relatively strong local irregularities. To deal with this problem we use a well-known extension of the original idea; marker-controlled watershed (MCW) algorithm ( Yang et al., 2006 ).
 objects to be segmented. For this purpose we use a nuclei detection procedure introduced in our previous work ( Filipczuk et al., 2012a ).
The procedure is based on the fi re fl y algorithm (FA). FA is an optimization technique inspired by the fl ashing behavior of ( Yang, 2010a ). The idea lays to use a swarm of simple agents which coordinate their activities to solve a complex problem. Since nuclei are the darkest objects in the image our problem boils down to local minima of luminance in the image space. Further in this section we describe the nuclei detection in detail, as well as MCW segmenta-tion and feature extraction. 5.1. Nuclei detection based on the fi re fl y algorithm arrangement of the nuclei in the image. For this purpose we have proposed a procedure based on the combination of adaptive thresh-olding in grayscale and pixel clustering in color space. First, the RGB image is converted to grayscale and adaptive thresholding is employed to remove the background. In order to separate the nuclei from red blood cells the k-means clustering in RGB space is used. The result is a mask where 1s denote pixels representing the nuclei and 0s denote pixels representing other objects. This step is described in detail in our previous works ( Filipczuk et al., 2011a , 2012b ). the nuclei are the darkest objects on the image we assume that the lightness is a negation of values of pixels represented by a (the darker pixels the brighter fi re fl y). The negative of the image is multiplied by the mask obtained in the pre-segmentation step.
This operation removes the background and red blood cells from consideration. The next step is to divide the image into square blocks of a certain size. For each block containing at least one nonzero pixel (the background is 0) a single fi re fl y is determined. The position of the fi re fl y is the centroid computed for the block.
The lightness is the mean value of pixels. Fig. 3 summarizes the initialization procedure.

In FA each fi re fl y interacts with each other with some strength so each fi re fl y is attracted by its neighbor that glows brighter. The light intensity I ( r ) varies according to the inverse square law:
I  X  r  X  X  I s r 2 ;  X  1  X  where I s is the intensity at the source and r is the distance between two fi re fl ies. Light is absorbed in the media with an absorbtion coef fi cient  X  . The combination of the inverse square law and the absorbtion can be approximated using the below equation to avoid singularity at r  X  0in I s = r 2 :
I  X  r  X  X  I 0 e  X  r 2 ;  X  2  X  where I 0 is the original light intensity. As the fi re fl proportional to the brightness seen by its neighbor, the attractiveness function is determined by  X  r  X  X   X  0 e  X  r 2 ;  X  3  X  where  X  0 is the attractiveness at r  X  0. To determine the distance affecting the attractiveness between any two fi re fl ies i and j at positions x i and x j Euclidean measure is used.

In each iteration less attractive fi re fl ies move to the brighter ones. The movement of the fi re fl y i at location x i to location x j is expressed by x  X  t  X  1  X  X  x i  X  t  X  X   X  0 e  X  r 2  X  x j x i  X  :  X  4  X 
Iterations are performed until reaching the maximum number of iterations or meeting the stop condition; the maximum movement is smaller than given  X  . The results are groups of fi re in centers of nuclei. Finally, fi re fl ies that lay closer to each other than  X  are merged to achieve the fi nal markers.

In the considered approach we used the following parameters: block size  X  6,  X   X  0 : 015,  X  0  X  1, maximum number of iterations  X  25,  X  1 : 4, and  X   X  1 : 4. The parameters were chosen experimentally. In
Filipczuk et al. (2012a) we showed that these parameters give the best performance for the presented images. A sample result of the nuclei detection using FA is presented in Fig. 4 . negative of nuclei with removed background 5.2. Nuclei segmentation
In MCW we use the Euclidean distance transform of the binary mask obtained in the pre-segmentation step of the nuclei detec-tion. Next, the surface is modi fi ed accordingly to the markers using morphological reconstruction. The algorithm imposes the minima of the intensity image at the locations speci fi ed by the markers. Finally, the watershed transform is applied and the nuclei are segmented. Fig. 5 presents sample segmentation results. 5.3. Feature extraction
After nuclei segmentation, for each nucleus the following 18 features are extracted: Area  X  the actual number of pixels of the nucleus.

Perimeter  X  the distance between each adjoining pair of pixels around the border of the nucleus.

Shape factor  X  also known as circularity, the function of area and perimeter:
SF  X  P
Convex de fi ciency  X  the difference between the area of the nucleus and the area of its convex hull.

Bending energy  X  the squared sum of the curvature values, where the curvature is the rate of change in orientation of consecutive points in the contour of the nucleus.

Eccentricity  X  the ratio of the distance between the foci of the ellipse that has the same second-moments as the segmented nucleus and its major axis length.

Major axis length  X  the length of the major axis of the ellipse that has the same normalized second central moments as the nucleus.
Minor axis length  X  the length of the minor axis of the ellipse that has the same normalized second central moments as the nucleus.
Mean value in the red, green, blue and luminance channel  X  value of pixels of the nucleus in channels R, G, B and luminance.
Variance of the red, green, blue and luminance channel  X  the variance of pixel values of the nucleus in channels R, G, B and luminance.
Distance to centroid of all nuclei (D2C)  X  the distance between the geometric center of the nucleus and centroid of all nuclei.
Distance to n-nearest nuclei (D2NNN)  X  sum of distances between the geometric center of the nucleus and geometric centers of n -nearest nuclei; after conducting experiments with different values of n , we decided to set this parameter to 1.
Then, for each image, the mean and variance of these nuclei features are calculated to obtain 36 image features (2 statistics 18 nuclei features). The image features are used in the classi fi cation procedure. 6. Classi fi cation
In this section the proposed one-class classi fi cation approach, employed as a part of the presented medical decision support system, is presented in detail.
 6.1. Ensemble of one-class classi fi ers awaits for proper attention. There are some papers dealing with the proposals on how to combine one-class classi fi ers ( Wilk and
Wo  X  niak, 2012 ), but most of them are oriented on the practical application ( Giacinto et al., 2008 ; Cyganek, 2012 ), not on theore-tical advances.

 X   X   X f  X  1 where M stands for the number of classes in the problem under consideration, i m stands for i -th classi fi er trained on a m -th class approach ( Ho, 1998 ). This algorithm can be seen as an extension of the popular Random Forest classi fi er, generalized for working with any type of a base model. A pool of classi fi ers is build on the basis of a subsample of the original feature space, chosen randomly and without replacement. This reduces the dimension-ality of each base classi fi er input and ensures an initial diversity among the used predictors. In this work we assume that the pool is homogeneous i.e., consists of classi fi ers built on the basis of the same model.
 distance between the object x and the description (decision boundary) that encloses the target class  X  T . To apply fusion methods we require the support function of object x for a given class.
 b
F  X  x ;  X  T  X  X  1 c which models a Gaussian distribution around the classi fi d  X  x j  X  T  X  is an Euclidean distance metric between the considered object and a decision boundary, c 1 is the normalization constant and c 2 is the scale parameter. Parameters c 1 and c 2 should be to the target class distribution. 6.2. Hybrid ensemble pruning affected by its random character. From the statistical point of view when creating a signi fi cant number of subspaces we will cover most of the valuable combinations of features, at the same time assuring initial diversity. On the other hand not all classi pool will display a satisfactory accuracy. Therefore one may improve the performance of this method by carefully discarding irrelevant classi fi ers.
 ensemble design. There are two main criteria that should be considered while choosing models for the committee: classi fi er selection for multi-class cases. Yet for the speci of OCC there is little work so far on how to evaluate the pool of classi fi ers and their usefulness to a committee ( Krawczyk and
Wo  X  niak, in press ).

We propose to use the following criteria for one-class classi selection:
In OCC we cannot use the standard accuracy measure as we assume that only objects from  X  T are available during the training step. Therefore we propose to use an unsupervised consistency measure. It indicates how consistent a pool of classi fi ers is in rejecting fraction f of the target data ( Tax and
Duin, 2004 ). One may compute it by comparing the rejected fraction f with an estimate of the error on the target class
Cons  X   X  l  X  X j b  X  t f j ;  X  8  X  where  X  l is the tested pool of classi fi ers. One should notice that this is a highly suitable measure for OCC  X  we need only the estimation of error on the target class. At the same time no information about outliers is required.

An energy approach is a measure of fuzziness, successfully implemented in many practical applications such as ECG analysis ( Czogala and Leski, 1998 ). In our previous work ( Krawczyk, 2012 ) we have presented that it can be used as a highly effective measure for diversity among one-class ensem-bles.

Let us assume that there are K classi fi ers in the pool, out of which S classi fi ers can correctly classify a given training object x j A X to  X  T . Additionally a threshold  X  A  X  0 ; 1 is introduced. Its role is to fi lter insigni fi cant degrees of membership that may otherwise contribute to decreasing the stability of the proposed measure. The energy measure is described as follows: EN oc  X   X  l  X  X  where f  X   X  x  X  X  f  X  x  X  3 and  X  n  X  x  X  denotes a classi fi er correctly classifying the object x and f  X  x  X  :  X  0 ; 1 -R  X  is an increasing function in interval [0,1] for f  X  0  X  X  0.

In this paper we propose to select OCC classi fi ers to the committee according to both of these criteria. Relying on only one of them may lead to unwanted situations  X  highly diverse classi fi ers may display poor classi fi cation properties and very accurate classi fi ers may cover identical areas of competence. To take both of these criteria into account we propose to use a multi-objective optimization, conducted with the usage of a memetic algorithm (MA) ( Harman and McMinn, 2010 ).

MAs are hybrid solution that blends concepts from different metaheuristics in hope to combine their strong points while overcoming their limitations. The central philosophy of MAs resolves around the individual improvement plus population cooperation. Unlike traditional Evolutionary Algorithms (EAs),
MAs are a less random and more directed search method. This is due exploiting all available knowledge about the considered problem. The formulation of the so-called No-Free-Lunch theorem for optimization ( Wolpert and Macready, 1997 ) have proven that the quality of the search algorithm is strictly connected with the amount and quality of the knowledge about the considered problem that is available. MA uses the advantages of highly ef fi cient EA approach, but further improves it with a guided search for exploring local neighborhoods. MAs start to attract the atten-tion of machine learning researchers who are in need of ef and stable search methods ( Liu et al., 2011 ).
 In this paper we use a MA that is a hybrid approach using both EA and tabu search to exclude re-visiting previously checked points in solution space. Additionally to allow for searching simultaneously for classi fi ers with high accuracy and diversity we use a multi-objective MA ( Knowles and Corne, 2004 ), aiming at maximizing both of these criteria.

Let us formulate the multi-objective optimization criterion as maximize g  X   X  l  X  X  X  Cons  X   X  l  X  X  EN oc  X   X  l  X  X  ;  X  11  X  where  X  l is the given pool of classi fi ers, Cons  X   X  l  X  and EN two criteria used as the target function.

An individual in the MA population represents a classi fi ensemble Ch  X  [C], where component C represents K classi fi our disposal in the pool: C  X  X  C 11 ; C 12 ; ... ; C 1 k  X  C 21 ; C 22 ; ... ; C 2 k and is a binary vector with 1s indicating the chosen individual classi fi ers for each of the M classes (i.e., if we have a 3 class problem with 9 classi fi ers then [001][110][101] would indicate that ensemble consists of classi fi er 3 for the fi rst class, classi 1 and 2 for the second class and classi fi ers 1 and 3 for the third class).

For this MA standard operators for EAs such as individual selection, mutation, cross-over, etc. apply. Additionally a tabu search is applied at the end of each iteration to additionally tune the available individuals. As each of the components of the chromosome stands for different target concepts therefore we assure that exchange of information can occur only for compo-nents of chromosomes representing the same target class. The control parameters of the MA algorithm are as follows: N c  X  the upper limit of algorithm cycles,
N p  X  the population quantity,  X   X  the mutation probability,  X   X  the crossover probability,
V  X  the upper limit of algorithm iterations without quality improvement, T  X  the size of the tabu list,
N T  X  the number of cycles for improvement of individuals via the tabu search. 6.2.1. Details of the memetic algorithm
Initialization : Initialization involves setting the parameters for the algorithm and randomly creating the fi rst generation of chromosomes. Each of the chromosomes in a generation is evaluated according to its fi tness function value to determine the elite chromosome.

Selection and reproduction : This step generates a set of mem-bers preserving all the constraints and implications resulting from the logic of the model and the values of the input parameters. Chromosomes for the next generation are selected using the roulette wheel selection scheme. Elitism has been implemented, i.e., the highest scoring chromosome of the current generation is placed into the descendant population, without allowing any changes to its structure.

Mutation : The mutation operator alters the member being processed by adding some random changes to its chromosome according to
P c  X  t  X  X   X  t N where t is the iteration index of the algorithm. Mutation involves a change of random numbers of values in the chromo-some (1s become 0s and opposite).

Crossover : All the chromosomes (with the exception of the elite chromosome) are paired up, and with probability  X  , crossed over according to the two-point rule.

Selection of the new population : In this process, a selection of individuals from population formed by merging descendant population and a set of individuals created by mutation and crossover. The probability of selection P s of a particular indivi-dual is proportional to the value of its fi tness.

Tabu search : After establishing a new population we would like to exploit its neighborhood in search for better solutions. For this a tabu search algorithm with a fi xed number of iterations is run. It gives the whole search procedure a more directed approach, by improving locally the chromosomes. 6.3. Final decision rule
An important part of the proposed decision support system is how to combine the individual decisions made separately for the images into a fi nal prediction for the patient. In order to provide a high quality output we tried to mimic the behavior of experienced physicians. After observations and discussions with medical experts we have formulated the following approach. Patient is classi fi ed to the malignant class if at least one decision made on the individual images points to it. In the case of no outputs pointing out to the malignant case the dichotomization between benign and fi broadenoma classes is carried out via a majority procedure. This approach is based on the opinions of physicians who state that even a single observation of cancerous cells should be treated as a malignant case for early prevention. 7. Experimental results
The aim of the experiment was to examine the usefulness of the proposed hybrid segmentation methods and ensemble with the trained combination method for the cytological image analysis. The main goals of the investigations are listed below:
To examine the usefulness of the proposed fi re fl y nuclei detection method for the process of feature extraction from biopsy images.

To check the discriminative abilities of the features extracted from proposed segmentations and to compare them with the ones from our previous works.

To check the quality of the proposed hybrid one-class decom-position and see if it can outperform binary approaches.
To validate the usefulness of the introduced memetic algorithm-based one-class classi fi er selection.
 For the experiment a Support Vector Data Description ( Tax and
Duin, 2004 ) with a polynomial kernel is used as a base classi
This particular model was selected due to its good performance in the one-class classi fi cation domain (as it requires a lower number of training samples than density estimation-based methods and is more robust to outliers in the training set in comparison to neural network approaches) and lower computational cost in comparison to other kernel-based one-class classi fi ers (such as One-Class
Support Vector Machine). The pool of classi fi ers was homoge-neous, i.e., consisted of classi fi ers of the same type.
The pool of classi fi ers consisted of 10 models dedicated to each of the classes  X  so there were 30 predictors in total. The Error-Correcting Output Codes (ECOCs) ( Dietterich and Bakiri, 1995 ) framework was used as a classi fi er fusion block due to its proven ef fi ciency in reconstructing a multi-class task from a set of binary classi fi ers ( Windeatt and Ghaderi, 2003 ). ECOC can be easily used for OCCs ensemble, as we can map the target class as  X  1 and the unknown, outlier class by 1( Wilk and Wo  X  niak, 2011 ).
 set to 0.1 and a hyperbolic tangent was selected as the f ( x ) function.
 algorithm, the employed parameters may have a crucial impact on its quality. Therefore, to establish the values of optimisation parameters we ran a grid search procedure over the following intervals of parameters values: by our previous experience with evolutionary-based ensembles ( Wo  X  niak and Krawczyk, 2012 ).
 classi fi er selection, were as follows: N c  X  300, N p  X  50,  X   X  0 : 3,  X  multi-class algorithm Random Forest (build with 120 trees).
Additionally we show performances of decomposition algorithms  X  as a base classi fi er for them we use the Support Vector Machine with polynomial kernel and trained with the SMO procedure. We apply two binary schemes OVO and OVA, binary ensemble schemes build with a boosting algorithm. We check how well behaves the canonical one-class decomposition, where a single one-class classi fi er is dedicated to each class. Additionally, to show the usefulness of the proposed fi re fl y nuclei detection combined with the marker-controlled watershed algorithm, we compare it with two other popular methods based on adaptive thresholding and clustering using Fuzzy c-means ( Filipczuk et al., 2011b ) and Gaussian Mixture Models ( Kowal et al., 2011 ).

Team, 2008 ), with classi fi cation algorithms taken from the dedicated packages, thus ensuring that the results achieved the best possible ef fi ciency and that the performance was not decreased by a bad implementation. All tests were done by a 10CV F -test ( Alpaydin, 2010 ). Additionally the Friedman ranking test ( Dem  X  ar, 2006 )was done for comparison over multiple segmentation datasets. numbers under the accuracies stand for the indices of models from which the examined one was statistically better according to the 10CV F -test. At the bottom of the table we present the average rank from the Friedman ranking test. RandF stands for Random
Forest, boostOVA and boostOVO for decomposition scheme with the boosting ensemble, OCE with decomposition via delegating a single one-class classi fi er to each of the classes and POCE for the proposed hybrid approach.
 proposed image analysis framework. We achieved an excellent recognition accuracy, outperforming popular segmentation and classi fi cation methods.
 fi re fl y-watershed segmentation. We have compared it with two other methods (based on adaptive thresholding combined with fuzzy c-means and Gaussian mixture) that we used in our previous works. Although the proposed approach requires more computa-tional time, it allows for better distinction between different cells.
This is especially important in the case of overlapping nuclei previous methods could not differentiate between them with a satisfactory rate. Combination of the fi re fl y algorithm and the marker-controlled watershed segmentation produced high quality features with good discriminating properties. One should note that the fi nal accuracy was higher for the introduced approach regard-less of the classi fi er type used. This means that extracted features are not correlated with the type of classi fi er used and generally improve the recognition quality.

As for the classi fi cation step several interesting conclusions may be drawn. Unexpectedly the Random Forest algorithm returned the worst accuracy. This classi fi er is often considered as one of the best off-the-shelf solutions for multi-class problems, but was not suitable for the considered task. This is most probably due to the introduction of the third class  X  fi broadenoma. It displays similar properties to malignant cases and even experi-enced physicians sometimes have dif fi culties with assigning a proper diagnosis. Decomposition algorithms simpli fi ed the deci-sion problem and therefore could better capture the differences between the classes. For binary decomposition we used four different approaches  X  OVA/OVO (where to each binary problem a single classi fi er was assigned) and boosted OVA/OVO (where to each binary problem an ensemble of classi fi ers was assigned). We preserved this approach for one-class decomposition  X  in OCE a single one-class classi fi er was delegated to each class, while in the proposed POCE we used a hybrid pruning for choosing ensembles dedicated to target concepts.
 As suspected (due to reports in the literature, Galar et al., 2011 )
OVO outperformed OVA both for single-classi fi er and boosted approaches. This is due to the fact that in OVA we deal with imbalanced classi fi cation (counterexamples come from more than one class) while OVA deals with fairly balanced problems. As suspected using boosted ensembles instead of single binary classi fi ers leads to further improvement in the recognition accu-racy. One-class decomposition with a single classi fi er (OCE) was inferior to the binary OVO, but when using the proposed hybrid pruning ensembles it outperformed all other methods. This comes in contrast to results reported in the literature ( Hempstalk and
Frank, 2008 ), which stated that when objects from all classes are available one should always use binary, not one-class decomposi-tion. The excellent performance of the proposed method can be explained by its robustness to dif fi culties embedded in the class distribution (e.g., data chunks or rare objects) and the ability to learn the individual properties of each of the classes (especially important for fi broadenoma).
 8. Conclusions
In this paper, we presented a new approach to computer diagnosis of breast cancer. The approach is based on nuclei detection using the fi re fl y algorithm, marker-controlled watershed segmentation and one-class decomposition strategy . Presented solution was tested on a set of cytological images obtained during routine hospital work.
Obtained results proved that the proposed nuclei detection procedure combined with the well-known watershed algorithm can provide robust nuclei segmentation. Applying a hybrid one-class classi fi cation decomposition as the pattern recognition module leads to statistically and clinically signi fi cant improvement over popularly used methods. The proposed framework lowers for an excellent rate of cancer detection and may be used as a valuable decision support system for everyday clinical practice.

Our future works will concentrate on applying semi-supervised principles to our one-class ensemble. As we have objects from all of the classes available we may use a small number of outliers to affect the shape of the decision boundary of one-class classi fi hope to further boost the robustness of the pattern recognition system, while preserving its ability to learn properties of individual classes. Acknowledgments The authors wish to thank Dr. Roman Monczak from the Regional Hospital in Zielona G X ra, Poland for his great help and interesting discussions.

Bartosz Krawczyk was supported by the fellowship co-fi nanced by European Union within European Social Fund.
 Pawe  X  Filipczuk is a scholar within Sub-measure 8.2.2 Regional Innovation Strategies, Measure 8.2 Transfer of knowledge, Priority VIII Regional human resources for the economy Human Capital Operational Programme co-fi nanced by European Social Fund and state budget.
 References
