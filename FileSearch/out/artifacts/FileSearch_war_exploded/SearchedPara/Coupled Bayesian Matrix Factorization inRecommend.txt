 A fundamental but often challenging task in e-commerce is recommending ap-propriate products to customers[1]. Typically in a recommender systems prob-{ V user X  X  gender, age and item X  X  price. Based on these data which contains ratings that some users gave to some items, recommender systems X  task is to predict the rating for any user U i on any non-rated item V j , and then recommend some items to given users according to ratings.
 lem, which refers to the approaches that decompose original data to explore the hidden structure[5]. Among different kinds of MF methods, the Bayesian MF enjoys the ability to automatically control the model complexity according to data characteristics[6]. Thus, Bayesian MF achieves the state-of-the-art perfor-mance in recommender systems and draws lots of attentions from researchers. However, the current MF method, including Bayesian MF, mainly focus on the IID assumption, i.e. the users and items are independent. Therefore, little effort has been done to consider the coupling relationships within or between users and items. Here coupling is an abstract concept about dependence, which refers to any kinds of interactions within or between attributes[9]. But in real-world be-haviours, people X  X  preference for items are affected by social structure and their own attributes. For example, one user X  X  preference may be more similar with people who share the same hobbies, than those who living closely or working together. As a result, lacking coupling relationships has been a critical reason for bad recommendations[1].
 coupling relationships within or between users and items, and then incorporat-ing it into our proposed Coupled Bayesian Matrix Factorization (CBMF) model. With available attributes of users and items in database, we first calculate simi-larity between users and items, based on their attributes. Then we cluster users and items into some different classes. In our CBMF model, each user and item X  X  hyper-parameter is determined by the class it belongs to. Considering attributes information incorporated in CBMF model, CBMF model greatly improved the accrucy of recommendation. And our experiments in Movielens 1M demonstrate the effectiveness of our CBMF model.
  X  We propose a method to mine coupling relationships, by taking advantage  X  By selecting users and items X  hyper-parameter according to their classes, we  X  We apply our model in databse, and compare our results with other methods. work. And Section 3 demonstrates our proposed CBMF model and corresponding Gibbs sampling algorithm. Experimental results and analysis are presented in Section 4. In Section 5, we show the conclusion and our intending future work. In this section we review previous research on recommendation and coupling relationships. 2.1 Recommendation Research According to information incorporated in recommender systems, researches on recommendation could be divided into four generations [1]: Rating-based recommendation research. Rating-based recommendation research was the first generation, which mainly focused on modeling and esti-mating the unknown rating according to existing rating matrix[5]. MF was a typical method in the first generation, where the recommendation model only used rating information and ignored other extremely important information, such as user X  X  social structure, item X  X  price and the coupling relationships within or between users and items.
 User/item-based recommendation research. The second generation was user/item-based recommendation research. They mainly focused on giving user-based and item-based recommendations. Specifically, they established content-based models by incorporating the specific user or item attributes, including user X  X  name, age, place of residence, and item X  X  price, quality and so on. Typical methods were to group users or items based on the k-nearest neighbor collabo-rative filtering[7] and arrange different weight to different user/item X  X  influence. These methods considered the relationships between users or items, and incor-porated these information into models by selecting different weight[8], therefore these methods outperformed rating-based recommendation.
 Cross-user/item recommendation research. Cross-user/item recommen-dation research was the third generation, which modeled ratings and made user/item recommendations by involving the specific interaction information between users and items, such as user comments on products, tags labelled for items by users and associations between user preferences and specific product types or characteristics[4]. For example, tag information was exploited to capture semantic correlation and then incorporated these correlation into item recom-mendation[3].
 Non-IID recommendation research. The fourth generation mainly focuses on mining the implicit/explicit and subjective/objective non-IIDness within and between users, items and between users and items[1]. In previous research, peo-ple mainly made use of users X  attributes, items X  attributes and rating matrix, and incorporated these information into their models. All of these methods lied in an assumption that users X  attributes and items X  attributes are independent and identically distributed. As a consequence, recommendation results obtained by these methods could not be accurate enough. While in the non-IID recommen-dation research, models must figure out the coupling relationships within and between users X  attributes and items X  attributes, then recommendation results are obtained according to users X  and items X  attributes. 2.2 Coupling Relationships In recommendation problems, coupling represents implicit or explicit connections between users, between items, and between users and items. Hence, there are three types coupling relationships[2]: User-user couplings. These refer to couplings within and between users, in-cluding (1) intra-user attribute couplings, which show the relationships between the values of a user X  X  attribute, such as couplings between user preferences or behaviours; (2) inter-user attribute couplings, which describe the connections between user attributes, such as couplings between users X  age, nation and social relationships;and (3) user couplings between users or between user groups. Item-item couplings. Similar to user-user couplings, item-item couplings in-clude (1) intra-item property couplings; (2) inter-item property couplings; and (3) item couplings between items, and between item categories.
 User-item couplings. These refer to the couplings within and between user-item connections, including (1) explicit user-item couplings, such as a users rat-ing on an item, and an item X  X  tag labelled by a user, and (2) implicit user-item his/her rated item X  X  attributes. In this section, we introduce the CBMF model. CBMF model is a hierarchical Bayesian model, where the prior distribution of rating matrix is parameterized on user vector and item vector, and the distribution of user vector and item vector is based on some hyper-parameters. In order to incorporate attribute informa-tion and mine coupling relationships, CBMF model use nonparametric Bayesian method to cluster users and items. In each class, all users or all items share the same hyper-parameters. Therefore, we first apply CRP to divide users and items into some classes, and then generate hyper-parameters for each class. After ob-taining these hyper-parameters, we get the posterior distribution of each user vector and item vector, according to the known rating data. To illustrate CBMF model more clearly, this paper first introduce the graphical model of CBMF, and then show the prior distribution. Finally we give the posterior distribution and sampling algorithm. 3.1 Graphical Model The graphical model representing of CBMF is shown in Figure 1, from where we easily know that CBMF is a hierarchical Bayesian model. In Figure 1, R ij represents the rating of user i for item j , U  X  R D  X  N U and V  X  R D  X  N V are latent user and item feature matrices, with D represents the number of latent factors and N U , N V represent the total number of users and items, respectively. Moreover, column vectors U i and V j represent user-specific and item-specific la-tent feature vectors, respectively. Here, we assume that the observed ratings R are drawn from a Gaussian distribution given U i and V j . In order to control the model complexity, we consider a full Bayesian model and draw the parameters, i.e. U i and V j , from a prior distribution with hyper-parameters. For the conve-nience of computing, we consider the Gaussian-Wishart distribution, which is the prior conjugate of Gaussian distribution, with hyper-parameters  X  0 ,W 0 . In order to incorporate other useful information to recommender systems, we use cluster users and items respectively. In each class, all users and all items share the same parameter for their distribution, because being in the same class means they are similar to each other.
 cess to divide users or items into several classes. Let X U i be similarity vector for U . According Chinese Restaurant Process, we obtain  X  U , which is the multi-nomial distribution parameter for each possible class. With the observed data, including rating matrix and similarity vector, we obtain U i and V j  X  X  posterior distribution, which can be used to predict unknown rating. 3.2 Prior In this part we show the prior distribution for CBMF model. The conditional distribution over the observed rating matrix R is The prior distributions over U  X  R D  X  N U and V  X  R D  X  N V are given by: We further place Gaussian-Wishart priors on the user and item hyper-parameters where  X  0 = {  X  0 , X  0 , X  0 ,W 0 } . And W is the Wishart distribution with  X  0 degrees of freedom and a D  X  D scale matrix W 0 : where C is the normalizing constant.
 to Chinese Restaurant Process: where n l denotes the number of users in class l . So the prior distributions over Z i  X  N are defined as: Likewise, we obtain: The prior distributions over Z V j  X  N can be defined as: given by: Then we place Gaussian-Wishart priors on X U i  X  X  hyper-parameters {  X  U g , X  U g } : The formulations for item are similar.
 3.3 Posterior and Gibbs Sampling Given observed data R,X U ,X V , which are used in likelihood function, and the prior distribution, we obtain their U i and V j  X  X  posterior distribution: where Then we obtained Z U i  X  X  posterior distribution: And the posterior distributions over the Z V j and the item hyper-parameters have exactly the same form. Using Gibbs sampling method can get { Z U i ,i = in the same class.
 in the CBMF model, the posterior distribution over the user hyper-parameters conditioned on the user feature matrix U is given by the Gaussian-Wishart distribution: where Then the posterior distribution over the user feature vector U i , conditioned on the movie features V , observed user rating matrix R , and the values of the hyper-parameters is: where Applying Algorithm 1 and Algorithm 2, we obtain user feature matrix U . The posterior distributions over the movie feature { V j ,j = 1 ,  X  X  X  ,N V } and the movie hyper-parameters {  X  V , X  V } have exactly the same form. So we obtain item feature matrix V using similar algorithm.
 Algorithm 1 Gibbs Sampling for Clustering In this section, we evaluate our proposed model and compare it with the existing approaches using Movielens 1M data sets. 4.1 Experimental Settings Movielens 1M is a stable benchmark database, which contains 1 million ratings from 6000 users on 4000 movies and also provides testing data. Here we post Algorithm 2 Gibbs Sampling for User Feature the root mean squared error (RMSE) and Mean Absolute Error (MAE) on the testing set, which are defined below: where R test is the set of all pairs ( i,j ) in the testing set. We set  X  0 = 0 , X  0 = D, X  0 = 2, and W 0 to the identity matrix in our proposed CBMF model, for both user and movie hyper-parameters. And the observation noise precision  X  is fixed at 2, the concentration parameter  X  of Dirichlet Process varies from 1 to 1,000. To evaluate the performance of our proposed CBMF model, We have carried out a variety of experiments and compare our recommendation results with existing methods. 4.2 Experimental Results and Discussions In this part, we analyse the effectiveness of our CBMF model in comparison with the above mentioned approaches.
 Superiority over other Methods. We evaluate the effectiveness of our CBMF model in comparison with the above mentioned approaches on Movielens 1M data sets, and the results are showed in table 1. The results in table 1 indicate that CBMF model reduce the error by 0.12% regarding RMSE and by 0.15% in terms of MAE, compared with BPMF model. The improvements obtained by CBMF model therefore demonstrate the importance of coupling relationships and effectiveness of our way to mine the information behind the attributes. Validity of recommendation. Here, we demonstrate the validity of recom-mendation of CBMF model by comparing movies we recommend with those a user truly watched and rated. For a user in Movielens 1M, whose user ID is 2579, CBMF model calculate the top 5 movies he/she may like, and com-pare those recommendation results with real-world data in Movielens 1M. The movies are followed the format: MovieID :: Title :: Genres , as shown in ta-ble 2. In the whole of 5 recommended movies, there is only one movie, called Twelfth Night (1996), that does not belong to user X  X  most liked movies. In addition, for the sake of finding the user 2579 X  X  preference for movie genre, we analyse all the movies the user watched. As shown in table 3, the user is fond of drama, and is more likely to give higher ratings to drama. In the recommenda-tion results, we recommend 3 drama movies, which demonstrate the validity of our method in another perspective.
 Effectiveness on cold start problem. In order to test their effectiveness on cold start problem, we delete some users data in training set as the  X  X old start sets X  and compare the change of recommendation for both two methods, and the results are recorded in table 4. No matter in original Movielens 1M, or in cold start sets, the CBMF model achieve better performance. And considering the recommendation accuracy change between two data sets, these in CBMF (0.05% for RMSE and 0.07% for MAE) are much smaller than changes in BPMF (0.13% for RMSE and 0.10% for MAE).
 Impact of the number of clusters. In CBMF model, we mine the couping relationships mainly by clustering users and items, based on their attributes. Due to the use of DP, parameter  X  (often called concentration parameter ) plays a key role in clustering. As shown in table 5, with the increase of  X  , the number of movie and user clusters keep growth, and the error (in the metric of RMSE) is almost always declining. This result demonstrate that the more attributes information we incorporate in our model, the more accurate recommendation we get. Prior work has applied MF method in recomender systems and incorporated rating information into their models. But in previous research, few method is able to make good use of attributes information, which greatly confine the ac-curacy of recommendation. By contrast, we exploit these attributes information to compute similarity between users and items, and then cluster users and items based on similarity. Finally, we apply our proposed method in Movielens 1M. We find that in virtually all cases (the value of parameter  X  varies) the recommen-dation error obtained in this paper outperform other MF method, to the best of my knowledge. These results demonstrate the importance of users X  and items X  attributes, confirming that incorporating more coupling relationships tends to produce more accurate recommendation. However, the attributes in users and pling relationships completely. Therefore, our future work will include research more methods about mining coupling relationships, such as cluster attributes and learn joint and conditional distribution on attributes.

