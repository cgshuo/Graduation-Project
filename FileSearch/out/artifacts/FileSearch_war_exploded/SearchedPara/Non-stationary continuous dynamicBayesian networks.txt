 There has recently been considerable interest in structure learning of Bayesian networks. Exam-ples from the topical field of systems biology are the reconst ruction of transcriptional regulatory networks from gene expression data [1], the inference of sig nal transduction pathways from pro-songbirds [3]. In particular, dynamic Bayesian networks (D BNs) have been applied, as they allow about edge directions common to static Bayesian networks. T he standard assumption underpinning DBNs is that of stationarity: time-series data are assumed t o have been generated from a homoge-neous Markov process. However, regulatory interactions an d signal transduction processes in the cell are usually adaptive and change in response to external stimuli. Likewise, neural information flow slowly adapts via Hebbian learning to make the processin g of sensory information more ef-ficient. The assumption of stationarity is therefore too res trictive in many circumstances, and can potentially lead to erroneous conclusions.
 In the recent past, various research efforts have addressed this issue and proposed models that relax the stationarity assumption. Talih and Hengartner [4] prop osed a time-varying Gaussian graphical model (GGM), in which the time-varying variance structure o f the data was inferred with reversible jump (RJ) Markov chain Monte Carlo (MCMC). A limitation of th is approach is that changes of the network structure between different segments are restrict ed to changing at most a single edge, and the total number of segments is assumed known a priori. Xuan a nd Murphy [5] developed a related non-stationary GGM based on a product partition model. The m ethod allows for separate structures Score Marginal Marginal Marginal Marginal BIC
Change-node whole node whole node points specific network specific network specific
Structure Yes No No Yes Yes constant Data format Continuous Discrete Continuous Continuous Continuous
Latent Change-point Change-point Change-point Free Free variables process process process allocation allocation
Table 1: Overview of how our model compares with various rela ted, recently published models. algorithm iterates between a convex optimization for deter mining the graph structure and a dynamic programming algorithm for calculating the segmentation. T he latter aspect imposes restrictions on the graph structure (decomposability), though. Moreover, both the models of [4] and [5] are based this shortcoming, Robinson and Hartemink [6] and L  X  ebre [7] proposed a non-stationary dynamic Bayesian network. Both methods allow for different network structures in different segments of the time series, where the location of the change-points and the total number of segments are inferred from the data with RJMCMC. The essential difference between the two methods is that the model discretized. The method proposed in [7] is based on the Bayes ian linear regression model of [9], which avoids the need for data discretization.
 Allowing the network structure to change between segments l eads to a highly flexible model. How-ever, this approach faces a conceptual and a practical probl em. The practical problem is potential model over-flexibility 1 . Owing to the high costs of postgenomic high-throughput exp eriments, time series in systems biology are typically rather short. Model ling short time series segments with sep-arate network structures will almost inevitably lead to infl ated inference uncertainty, which calls for some information sharing between the segments. The conceptual problem is related to the very premise of a flexible network structure. This assumption is r easonable for some scenarios, like mor-phogenesis, where the different segments are e.g. associat ed with the embryonic, larval, pupal, and is not the road system (the network structure) that changes b etween off-peak and rush hours, but the (the interaction structure), but the extent to which this ha ppens (the interaction strength). The objective of the present work is to propose and assess a no n-stationary continuous-valued DBN Our model is non-stationary with respect to the parameters, while the network structure is kept fixed among segments. Our model complements the one proposed in [6 ] in two other aspects: the score is a non-stationary generalization of the BGe [10] rather th an the BDe score, thus avoiding the need mixture of BGe models. We replace the free allocation model o f [11] by a change-point process to incorporate our prior notion that adjacent time points in a time series are likely to be governed by similar distributions. We borrow from [12] the concept of node-specific change-points to enable greater model flexibility. However, as opposed to [12], we do not approximate the scoring function by BIC [14], but compute the proper marginal likelihood. The objective of inference is to infer the location and the node-specific number of change-points from the posterior distribution. An overview of how our method is related to various recently published re lated models is provided in Table 1. 2.1 The dynamic BGe network DBNs are flexible models for representing probabilistic rel ationships between interacting variables (nodes) X realization of X of is the set of all nodes from which an edge points to node X and D represents time, DBNs are based on the following homogeneou s Markov chain expansion: where  X  is the total parameter vector, composed of node-specific sub vectors  X  the local conditional distributions in the factorization. From Eq. (1) and under the assumption of parameter independence, P (  X  |G ) = Q and parent set  X  Eq. (24) in [10]. The resulting expression is called the BGe s core 3 . 2.2 The non-stationary dynamic change-point BGe model (cpB Ge) To obtain a non-stationary DBN, we generalize Eq. (1) with a n ode-specific mixture model: where  X  that the realization of node X mixture with K into several disjoined subsets, each of which can be regarde d as pertaining to a separate BGe model with parameters  X  k distributions P ( X of data points to mixture components from a free allocation t o a change-point process. This effec-time series, adjacent time points are likely to be assigned t o the same component. From Eq. (4), the marginal likelihood conditional on the latent variables V is given by  X ( D  X  n n [ k, V n ] , G )= segment). The joint probability distribution of the propos ed cpBGe model is given by: In the absence of genuine prior knowledge about the regulato ry network structure, we assume for ability distributions on the node-specific numbers of mixtu re components K truncated Poisson distributions with shape parameter  X  = 1 , restricted to 1  X K (we set K identify K For notational convenience we introduce the pseudo change-points b node X if numbered order statistics of L := 2( K distributed on the interval [2 , m ] . The motivation for this prior, instead of taking K discourage mixture components (i.e. segments) that contai n only a few observations. The even-numbered order statistics prior on the change-point locati ons b node-specific allocation vectors V MCMC scheme we discuss in the next section does not sample V modifications of V ceptance probabilities of these moves are P ( V 2.3 MCMC inference We now describe an MCMC algorithm to obtain a sample {G i , V i , K i } rithm 4 [17, 18] with the change-point model used in [15], and draw on the fact that conditional on the allocation vectors V , the model parameters can be integrated out to obtain the mar ginal like-lihood terms  X ( D  X  n approach is equivalent to the idea underlying the allocatio n sampler proposed in [13]. The resulting algorithm is effectively an RJMCMC scheme [15] in the discre te space of network structures and ted. With probability p leave the latent variable matrix and the numbers of mixture c omponents unchanged, symbolically: V i +1 = V i and K i +1 = K i . A new candidate graph G i +1 is randomly drawn out of the set of The proposed graph G i +1 is accepted with probability: Figure 1: Networks from which synthetic data were generated. Panels (a-c) show elementary network motifs [20]. Panel (d) shows a protein signal transd uction network studied in [2], with an added feedback loop on the root node. graph is left unchanged, symbolically G i +1 := G i , if the move is not accepted.
 With the complementary probability 1  X  p on ( V i , K i ) , where V i randomly select a node X birth or death move, or its latent variable vector V i change-point birth (death) move increases (decreases) K i The change-point reallocation move leaves K i fairly mild regularity conditions (ergodicity), the MCMC s ampling scheme converges to the desired posterior distribution if the acceptance probabilities fo r the three change-point moves ( K i where A = P ( V i +1 inverse proposal probability ratio. The exact form of these factors depends on the move type and is provided in the supplementary material. We note that the i mplementation of the dynamic pro-gramming scheme proposed in [19] has the prospect to improve the convergence and mixing of the Markov chain, which we will investigate in our future work. To assess the performance of the proposed model, we applied i t to a set of synthetic data generated elementary network motifs, as studied e.g. in [20]. The netw ork in Figure 1d was extracted from We added an extra feedback loop on the root node to allow the ge neration of a Markov chain with non-zero autocorrelation; note that this modification is no t biologically implausible [21]. We generated data with a mixture of piece-wise linear proces ses and sinusoidal transfer functions. The advantage of the first approach is the exact knowledge of t he true process change-points; the second approach is more realistic (smooth function) with a s tronger mismatch between model and data-generation mechanism. For example, the network in Fig ure 1c was modelled as where the  X  tocorrelation in W . For each parameter configuration, 25 time series with 41 tim e points where independently generated. For the other networks, data were generated in a similar way. Owing to space restrictions, the complete model specifications ha ve to be relegated to the supplementary material. Figure 2: Comparison of AUC scores on the synthetic data. The panels (a-d) correspond to those of Figure 1. The horizontal axis in each panel represents the proposed cpBGe model. The vertical axis represents the following competing models: BDe (  X  ), BGe (  X  ), the method of Ko et al. [12] (ACT). Each symbol shows a comparison of two average AUC scor es, averaged over 25 (panels a-c) or 5 (panel d) time series independently generated for a gi ven SNR/ACT setting. The diagonal line indicates equal performance; symbols below this lines indicate that the proposed cpBGe model outperforms the competing model. The table in the bottom sho ws an overview of the corresponding the cpBGe model outperforms the competing model at the stand ard 5% significance level. To each data set, we applied the proposed cpBGe model as descr ibed in Section 2. We compared its performance with four alternative schemes. We chose the cla ssical stationary DBNs based on BDe [8] and BGe [10]. Note that for these models the parameters ca n be integrated out analytically, and only the network structure has to be learned. The latter was s ampled from the posterior distribution with structure MCMC [17, 18]. Note that the BDe model require s discretized data, which we ef-fected with the information bottleneck algorithm [22]. Our comparative evaluation also included two non-linear/non-stationary models with a clearly defined ne twork structure (for the sake of compara-bility with our approach). We chose the method of Ko et al. [12 ] for its flexibility and comparative ease of implementation. The inference scheme is based on the application of the EM algorithm [23] to a node-specific mixture model subject to a BIC penalty term [14]. We implemented this algorithm according to the authors X  specification in MATLAB c , using the software package NETLAB [24]. We also compared our model with the approach proposed by Grze gorczyk et al. [11]. We applied the software available from the authors X  website. We replaced t he authors X  free allocation model by the change-point process used for our model. This was motivated by the fact that for a fair comparison, the same prior knowledge about the data structure (time seri es) should be used. In all other aspects we applied the method as described in [11]. All MCMC simulati ons were divided into a burn-in and a sampling phase, where the length of the burn-in phase was ch osen such that standard convergence criteria based on potential scale reduction factors [25] we re met. The software implementations of all methods used in our study are available upon request. For lack of space, further details have to be relegated to the supplementary material.
 To assess the network reconstruction accuracy, various cri teria have been proposed in the litera-ture. In the present study, we chose receiver-operator-cha racteristic (ROC) curves computed from the marginal posterior probabilities of the edges (and the r anking thereby induced). Owing to the large number of simulations  X  for each network and parameter setting the simulations were repeated on 25 (Figures 2a-c) or 5 (Figures 2d) independently generat ed time series  X  we summarized the performance by the area under the curve (AUC), ranging betwe en 0.5 (expected random predictor) to 1.0 (perfect predictor). The results are shown in Figure 2 and suggest that the proposed cpBGe model tends to significantly outperform the competing model s. A more detailed analysis with an Figure 3: Results on the Arabidopsis gene expression time series. Top panels: Average posterior time (horizontal axis) for two selected circadian genes (le ft: LHY, centre: TOC1) and averaged over all 9 genes (right). The vertical dotted lines indicate the b oundaries of the time series segments, els: Co-allocation matrices for the two selected genes LHY and TO C1. The axes represent time. The grey shading indicates the posterior probability of two time points being assigned to the same mixture component, ranging from 0 (black) to 1 (white). Bottom right panel: Predicted regulatory network of nine circadian genes in Arabidopsis thaliana . Empty circles represent morning genes. Shaded circles represent evening genes. Edges indicate pre dicted interactions with a marginal pos-terior probability greater than 0.5. performance of the methods has to be relegated to the supplem entary material for lack of space. We have applied our method to microarray gene expression tim e series related to the study of cir-cadian regulation in plants. Arabidopsis thaliana seedlings, grown under artificially controlled T hour-light/ T  X  -hour intervals. From these seedlings, RNA was extracted an d assayed on Affymetrix GeneChip oligonucleotide arrays. The data were background-correct ed and normalized according to standard procedures 5 , using the GeneSpring c software (Agilent Technologies). We combined four time se-T e  X  X  10 h, 12 h, 14 h } mental protocols, can be obtained from [27], [11], and [28]. We focused our analysis on 9 circadian set. The objective was to test whether the proposed cpBGe mod el would detect the different experi-no relation with the expression values at the last time point of the preceding segment, the corre-sponding boundary time points were appropriately removed f rom the data 7 . This ensures that for all pairs of consecutive time points a proper conditional depen dence relation determined by the nature of the regulatory cellular processes is given. The top panel of Figure 3 shows the marginal posterior probability of a change-point for two selected genes (LHY an d TOC1), and averaged over all genes. the heights of the posterior probability peaks for LHY and TO C1. This behaviour is also captured by are effected by the changing experimental conditions (entr ainment, time interval) in different ways and thus provides a useful tool for further exploratory anal ysis. The bottom right panel of Figure 3 shows the gene interaction network that is predicted when ke eping all edges with marginal posterior probability above 0.5. There are two groups of genes. Empty c ircles in the figure represent morning genes (i.e. genes whose expression peaks in the morning), sh aded circles represent evening genes (i.e. genes whose expression peaks in the evening). There ar e several directed edges pointing from the group of morning genes to the evening genes, mostly origi nating from gene CCA1. This result is consistent with the findings in [29], where the morning gen es were found to activate the evening genes, with CCA1 being a central regulator. Our reconstruct ed network also contains edges pointing into the opposite direction, from the evening genes back to t he morning genes. This finding is also consistent with [29], where the evening genes were found to i nhibit the morning genes via a negative feedback loop. In the reconstructed network, the connectiv ity within the group of evening genes is ing the light-dark cycle entrainment, the experiments were carried out in constant-light condition, resulting in a higher activity of the morning genes overall. Within the group of evening genes, the reconstructed network contains an edge between GI and TOC1. This interaction has been confirmed in [30]. Hence while a proper evaluation of the reconstructi on accuracy is currently unfeasible  X  like [6] and many related studies, we lack a gold-standard ow ing to the unknown nature of the true interaction network  X  our study suggests that the essential features of the reconstructed network are biologically plausible and consistent with the literature . We have proposed a continuous-valued non-stationary dynam ic Bayesian network, which constitutes non-stationary BDe model was proposed. We have argued that a flexible network structure can and [7], presumably because their overall network structur e is not properly defined. Our findings suggest that the proposed non-stationary BGe model achieve s a clear performance improvement models of [12] and [11]. The application of our model to gene e xpression time series from circadian reconstructed network shows features that are consistent w ith the biological literature. The proposed model is based on a multiple change-point proce ss. This scheme provides the ap-proximation of a non-linear regulation process by a piecewi se linear process under the assumption that the temporal processes are sufficiently smooth. A strai ghtforward modification would be the replacement of the change-point process by the allocation m odel of [13] and [11]. This modification would result in a fully-flexible mixture model, which is pref erable if the smoothness assumption for the temporal processes is violated. It would also provide a n on-linear Bayesian network for static rather than time series data. While the algorithmic implemen tation is straightforward, the increased complexity of the latent variable configuration space would introduce additional challenges for the mixing and convergence properties of the MCMC sampler. The d evelopment of more effective pro-posal moves, as well as a comparison with alternative non-li near Bayesian network models, like [31], is a promising subject for future research.
 Marco Grzegorczyk is supported by the Graduate School  X  X tat istische Modellbildung X  of the De-partment of Statistics, University of Dortmund. Dirk Husme ier is supported by the Scottish Govern-ment Rural and Environment Research and Analysis Directora te (RERAD).
