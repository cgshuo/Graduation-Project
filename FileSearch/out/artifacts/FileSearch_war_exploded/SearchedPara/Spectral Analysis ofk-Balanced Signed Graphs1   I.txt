
Leting Wu 1 ,XiaoweiYing 1 ,XintaoWu 1 ,AidongLu 1 , and Zhi-Hua Zhou 2 Signed networks were originally used in anthropology and sociology to model friendship and enmity [2, 4]. The motivation for signed networks arose from the fact that psychologists use -1, 0, and 1 to represent disliking, indifference, and liking, respectively. Graph topology of signed networks can then be expressed as an adjacency matrix wh ere the entry is 1 (or  X  1) if the relationship is positive (or negative) and 0 if the relationship is absent.

Spectral analysis that considers 0-1 mat rices associated with a given network has been well developed. As a significant extension, in this paper we investigate the impacts of introducing negative edges in the graph topology and examine community patterns in the spectral space of its signed adjacency matrix. We start from k -balanced signed graphs which have been extensively examined in social psychology, especially from the stability of sentiments perspective [5]. Our theoretical results show that communities in a k -balanced signed graph are dis-tinguishable in the spectral space of it s signed adjacency ma trix even if connec-tions between communities are dense. This is very different from recent findings on unsigned graphs [12, 9], where communities tend to mix together when con-nections between communiti es increase. We give a theo retical explanation by treating the k -balanced signed graph as a perturbed one from a disconnected k -block network. We further conduct theoretical studies based on graph pertur-bation to examine spectral patterns of g eneral unbalanced signed graphs. We illustrate our theoretical findings with various empirical evaluations. A signed graph G can be represented as the s ymmetric adjacency matrix A n  X  n with a ij = 1 if there is a positive edge between node i and j , a ij =  X  1if there is a negative edge between node i and j ,and a ij =0otherwise. A has n real eigenvalues. Let  X  i be the i -th largest eigenvalue of A with eigenvector x ,  X  1  X   X  2  X  X  X  X  X  X   X  n .Let x ij denote the j -th entry of x i . The spectral decomposition of A is A = i  X  i x i x T i .
Formula (1) illustrates our notions. The eigenvector x i is represented as a column vector. There usually exist k leading eigenvalues that are significantly greater than the rest ones for networks with k well separated communities. We call row vector  X  u =( x 1 u ,x 2 u ,  X  X  X  ,x ku ) the spectral coordinate of node flects most topological information of the original graph. The eigenvectors x i ( i =1 ,...,k ) naturally form the canonical basis of the subspace denoted by  X  =(0 ,..., 0 , 1 , 0 ..., 0), where the i -th entry of  X  i is 1.

Let E be a symmetric perturbation matrix, and B be the adjacency matrix after perturbation, B = A + E . Similarly, let  X  i be the i -th largest eigenvalue of B with eigenvector y i ,and y ij is the j -th entry of y i . Row vector  X  u = ( y 1 u ,...,y ku ) is the spectral coordinate of node u after perturbation. The k -balanced graph is one ty pe of signed graphs that have received extensive examinations in social psychology. It was shown that the stability of sentiments is equivalent to k -balanced (clusterable). A necessa ry and sufficient condition for a signed graph to be k -balanced is that the signed graph does not contain the cyclewithexactlyonenegativeedge[2].
 Definition 1 Graph G is a k -balanced graph if the node set V can be divided into k non-trivial disjoint subsets such that V 1 ,...,V k , edges connecting any two nodes from the same subset are all positive, and edges connecting any two nodes from different subsets are all negative.
 The k node sets, V 1 ,...,V k , naturally form k communities denoted by C 1 ,...,C k of community C i . After re-numbering the nodes properly, the adjacency matrix B of a k -balanced graph is: and E represents the negative edges acro ss communities. M ore generally, e uv = 1(  X  1) if a positive(negative) edge is added between node u and v ,and e otherwise. 3.1 Non-negative Block-Wise Diagonal Matrix For a graph with k disconnected communiti es, its adjacency matrix A is shown in (2). Let  X  i be the largest eigenvalue of A i with eigenvector z i of dimension n  X  1. Without loss of generality, we assume  X  A i are all non-negative, with Perron-Frobenius theorem [10],  X  i is positive and all the entries of its eigenvector z i are non-negative. When the k communities are comparable in size,  X  i is the i -th largest eigenvalues of A (i.e.,  X  i =  X  i ), and the eigenvectors of A i can be naturally extended to the eigenvalues of A as follows: Now, consider node u in community C i . Note that all the entries in x i are non-negative, and the spectral coordinate of node u is just the u -th row of the matrix in (3). Then, we have where x iu &gt; 0 is the only non-zero entries of  X  u . In other words, for a graph with k disconnected comparable communities, spectral c oordinates of all nodes locate on k positive half-axes of  X  1 ,  X  X  X  , X  k and nodes from the same community locate on the same half axis. 3.2 A General Perturbation Result Let  X  i u ( i =1 ,...,k )bethesetofnodesin C i that are newly connected to node u by perturbation E :  X  i u = { v : v  X  C i ,e uv =  X  1 } .In[11],wederivedseveral theoretical results on general graph perturbation. We include the approximation of spectral coordinates below as a basis for our spectral analysis of signed graphs. Please refer to [11] for proof details. Theorem 1. Let A be a block-wise diagonal matrix as shown in (2) ,and E be a symmetric perturbation matrix satisfying E 2  X  k .Let  X  ij = x T i E x j .For a graph with the adjacency matrix B = A + E , the spectral coordinate of an arbitrary node u  X  C i can be approximated as where scalar x iu is the only non-zero entry in its original spectral coordinate shown in (4) ,and r i is the i -th row of matrix R in (6) : 3.3 Moderate Inter-community Edges Proposition 1. Let B = A + E where A has k disconnected communities and
E 2  X  k and E is non-positive. We have the following properties: 1. If node u  X  C i is not connected to any C j ( j = i ),  X  u lies on the half-line 2. If node u  X  C i is connected to node v  X  C j ( j = i ),  X  u deviate from r i . To illustrate Proposition 1, we now consider a 2-balanced graph. Suppose that a graph has two communities and we add some sparse edges between two com-munities. For node u  X  C 1 and v  X  C 2 , with (5), the spectral coordinates can be approximated as
The Item 1 of Proposition 1 is apparent from (7) and (8). For those nodes with no inter-community edges, the second parts of the right hand side (RHS) of (7) and (8) are 0 since all e uv are 0, and hence they lie on the two half-lines r 1 (nodes in C 1 )and r 2 (nodes in C 2 ). Note that r 1 and r 2 are orthogonal since r
Next, we explain Item 2 of Proposition 1. Consider the inner product If node u  X  C 1 has some negative links to C 2 ( e uv =  X  1),  X  u , r 2 is thus negative. In other words,  X  u lies outside the two half-lines r 1 and r 2 . Another interesting pattern is the direction of rotation of the two half lines. For the 2-balanced graph, r 1 and r 2 rotate counter-clockwise from the axis  X  1 and  X  2 . Notice that all the added edges are negative ( e uv =  X  1), and hence  X  which implies that r 1 and r 2 have an counter-clockwise rotation from the basis. Comparison with adding positives edges. When the added edges are all positive ( e uv = 1), we can deduct the following two properties in a similar manner: 1. Nodes with no inter-community edges lie on the k half-lines. (When k =2, 2. For node u  X  C i that connects to node v  X  C j ,  X  u and r j form an acute Figure 1 shows the scatter plot of the spectral coordinates for a synthetic graph, Synth -2. Synth -2 is a 2-balanced graph with 600 and 400 nodes in each commu-nity. We generate Synth -2 and modify its inter-community edges via the same method as Synthetic data set Synth -3 in Section 5.1. As we can see in Figure 1(a), when the two communities are disconnected, the nodes from C 1 and C 2 lie on the positive part of axis  X  1 and  X  2 respectively. We then add a small number of edges connecting the two communities ( p =0 . 05). When the added edges are all negative, as shown in Figure 1(b), the spectral coordinates of the nodes from the two communities form two half-lines respectively. The two quasi-orthogonal half-lines rotate counter-clockwise from the axes. Those nodes having negative inter-community edges lie outside the two half-lines. On the contrary, if we add positive inter-community edges, as shown in Figure 1(c), the nodes from two communities display two half-lines with a clockwise rotation from the axes, and nodes with inter-community edges lie between the two half-lines. 3.4 Increase the Magnitude of Inter-community Edges Theorem 1 stands when the magnitude of perturbation is moderate. When deal-ing with perturbation of large magnitude, we can divide the perturbation ma-trix into several perturbation matrices of small magnitude and approximate the eigenvectors step by step. More general, the perturbed spect ral coordinate of a node u can be approximated as where  X  =diag(  X  1 ,..., X  k ).

One property implied by (9) is that, after adding negative inter-community edges, nodes from different communities are still separable in the spectral space. Note that R is close to an orthogonal matrix, and hence the first part of RHS of (9) specifies an orthogonal transformation. The second part of RHS of (9) specifies a deviation away from the position after the transformation. Note that when the inter-community edges are all negative ( e uv =  X  1), the deviation of  X  u is just towards the negative direction of  X  v (each dimension is weighted with  X   X  1 i ). Therefore, after perturbation, node u and v are further separable from each other in the spectral space. The c onsequence of this repellency caused by adding negative edges is that nodes from different communities stay away from each other in the spectral space. As the magnitude of the noise increases, more nodes deviate from the half-lines r i , and the line pattern eventually dis-appears. Positive large perturbation. When the added edges are positive, we can sim-ilarly conclude the opposite phenomenon: more nodes from the two communities are  X  X ulled X  closer to each other by the positive inter-community edges and are finally mixed together, indicating that th e well separable communities merge into one community.

Figure 2 shows the spectral coordinate of Synth -2 when we increase the mag-nitude of inter-community edges ( p =0 . 1 , 0 . 3 and 1). For the first row (Figure 2(a) to 2(c)), we add negative inter-community edges in Synth -2, and for the second row (Figure 2(d) to 2(f)), we add positive inter-community edges. As we add more and more inter-community edges, no matter positive or negative, more and more nodes deviate from the two half-lines, and finally the line pattern diminishes in Figure 2(c) or 2(f). When adding positive inter-community edges, the nodes deviate from the lines and hence finally mix together as show in Fig-ure 2(f), indicating that two communities merge into one community. Different from adding positive edges, which mixes the two communities in the spectral space, adding negative inter-community edges  X  X ushes X  the two communities away from each other. This is because nodes with negative inter-community edges lie outside the two half-lines as shown in Figure 2(a) and 2(b). Even when p = 1, as shown in Figure 2(c), two communiti es are still clearly separable in the spectral space. Signed networks in general are unbalanced and their topologies can be consid-ered as perturbations on balanced graphs with some negative connections within communities and some positive connections across communities. Therefore, we can divide an unbalanced signed graph into three parts where A is a non-negative block-wise diagonal matrix as shown in (2), E in rep-resents the negative edges within communities, and E out represents the both negative and positive inter-community edges.
 Add negative inner-community edges. For the block-wise diagonal ma-trix A , we first discuss the case where a small number of negative edges are added within the communities. E in is also a block-wise diagonal. Hence  X  ij = x i E in x j =0forall i = j ,andmatrix R caused by E in in (6) is reduced to the identity matrix I .
 Consider that we add one negative inner-community edge between node u, v  X  C .Since R = I ,only  X  i and x i are involved in approximating  X  u and  X  v : Without loss of generality, assume x iu &gt;x iv , and we have the following proper-ties when adding e uv =  X  1: 1. Both node u and v move towards the negative part of axis  X  i after pertur-The two preceding properties imply that , for those nodes close to the origin, adding negative edges would  X  X ush X  them towards the negative part of axis  X  i , and a small number of nodes can thus lie on the negative part of axis  X  i , i.e., y iu &lt; 0).
 Add inter-community edges. The spectral perturb ation caused by adding E out on to matrix A + E in can be complicated. Notice that ( A + E in ) is still a block-wise matrix, and we can still apply Thereom 1 and conclude that, when E out is moderate, the major nodes from k communities form k lines in the spectral space and nodes with inter-co mmunity edges deviate from the lines.
It is difficult to give the explicit form of the lines and the deviations, because x iu and the inter-community edges can be either positive and negative. However, we expect that the effect of adding negative edges on positive nodes is still dominant in determining the spectral pattern, because most nodes lie along the positive part of the axes and the majority of inter-community edges are negative. Communities are still distinguishable in the spectral space. The majority of nodes in one community lie on the positive part of the line, while a small number of nodes may lie on the negative part due to negative connections within the community.

We make graph Synth -2 unbalanced by flipping the signs a small proportion q of the edges. When the two communities are disconnected, as shown in Figure 3(a), after flipping q =0 . 1 inner-community edges, a small number of nodes lie on the negative parts of the two axes. Figure 3(b) shows the spectral coordinates of the unbalanced graph generated from balanced graph Synth -2 ( p =0 . 1 ,q = 0 . 1). Since the magnitude of the inter-community edges is small, we can still observe two orthogonal lines in the scatter plots. The negative edges within the communities cause a small number of nodes lie on the negative parts of the two lines. Nodes with inter-community edges deviate from the two lines. For Figure 3(c), we flip more edge signs ( p =0 . 1 ,q =0 . 2). We can observe that more nodes lie on the negative parts of the lines, since more inner-community edges are changed to negative. The rotation angles of the two lines are smaller than that in Figure 3(b). This is because the positive inter-community edges  X  X ull X  the rotation clockwise a little, and the rotation we observe depends on the effects from both positive and negative inter-community edges. 5.1 Synthetic Balanced Graph Data set Synth -3 is a synthetic 3-balanced grap h generated from the power law degree distribution with parameter 2 . 5. The 3 communities of Synth -3 contain 600, 500, 400 nodes, and 4131, 3179, 2037 edges respectively. All the 13027 inter-community edges are set to be negative. We delete the inter-community edges randomly until a proportion p of them remain in the graph. The parameter p is the ratio of the magnitude of inter-community edges to that of the inner-community edges. If p = 0 there are no inter-community edges. If p = 1, inner-and inter-community edges have the same magnitude.

Figure 4 shows the change of spectral coordinates of Synth -3, as we increase the magnitude of inter-community edges. When there are no any negative links ( p = 0), the scatter plot of the spectral coordinates is shown in Figure 4(a). The disconnected communities display 3 orthogonal half-lines. Figure 4(b) shows the spectral coordinates when the magnitude of inter-community edges is moderate ( p =0 . 1). We can see the nodes form three half-lines that rotate a certain angle, and some of the nodes deviate from the lines. Figures 4(c) and 4(d) show the spectral coordinates when we increase the magnitude of inter-community edges ( p =0 . 3 , 1). We can observe that, as more inter-community edges are added, more and more nodes deviate from the lines. However, nodes from different communities are still separable fro m each other in the spectral space.
We also add positive inter-community edges on Synth -3 for comparison, and the spectral coordinates are shown in Figures 4(e) and 4(f). We can observe that, different from adding negative edges, as the magnitude of inter-community edges ( p ) increases, nodes from the three co mmunities get closer to each other, and completely mix in one community in Figure 4(f). 5.2 Synthetic Unbalanced Graph To generate an unbalanced graph, we randomly flip the signs of a small proportion q of the inner-and inter-community edges of a balanced graph, i.e., the parameter q is the proportion of unbalanced edges given the partition. We first flip edge signs on the graph with small magnitude inter-community edges. Figure 5(a) and 5(b) show the spectral coordinates after we flip q = 10% and q = 20% edge signs on Synth -3 with p =0 . 1. We can observe that, even the graph is unbalanced, nodes from the three communities exhibit three lines starting from the origin, and some nodes deviate from the lines due to the inter-community edges.

We then flip edge signs on the graph with large magnitude inter-community edges. Figure 5(c) shows the spectral coordinates after we flip q = 20% edge signs on Synth -3 with p = 1. We can observe that the line pattern diminishes because of the large number of inter-community edges. However, the nodes from 3 communities are separable in the spect ral space, indicating that the unbalanced edges do not greatly change the patterns in the spectral space. 5.3 Comparison with Laplacian Spectrum The signed Laplacian matrix is defined as L =  X  D  X  A where  X  D n  X  n is a diagonal degree matrix with  X  D ii = n j =1 | A ij | [7]. Note that the unsigned Laplacian matrix is defined as L = D  X  A where D n  X  n is a diagonal degree matrix with D of Laplacian matrix also reflect the community structure of a signed graph: the k communities form k clusters in the Laplacian spectral space. However, eigenvectors associated with the smallest eigenvalues are generally instable to noise according to the matrix perturba tion theory [10]. Hence, when it comes to real-world networks, the communities may no longer form distinguishable clusters in the Laplacian spectral space.

Figure 6(a) shows the Laplacian spectrum of a balanced graph, Synth -3 with p =0 . 1. We can see that the nodes from the three communities form 3 clusters in the spectral space. However, the Laplacian spectrum is less stable to the noise. Fig-ure 6(b) and 6(c) plot the Laplacian spectra of the unbalanced graphs generated from Synth -3. We can observe that C 1 and C 2 are mixed together in Figure 6(b) and all the three communities are not separable from each other in Figure 6(c). For comparison, the adjacency spectra of the corresponding graphs were shown in Figure 5(b) and Figure 5(c) respectiv ely where we can observe that the three communities are well separable in the adjacency spectral space. There are several studies on community pa rtition in social networks with neg-ative (or negatively weighted) edges [1, 3]. In [1], Bansal et al. introduced cor-relation clustering and showed that it is an NP problem to make a partition to a complete signed graph. In [3], Demaine and Immorlica gave an approxima-tion algorithm and showed that the problem is APX-hard. Kruegis et al. in [6] presented a case study on the signed Slashdot Zoo corpus and analyzed various measures (including signed clustering co efficient and signed centrality measures). Leskovic et al. in [8] studied several signed online social networks and developed a theory of status to explain the observed edge signs. Laplacian graph kernels that apply to signed graphs were described in [7]. However, the authors only focused on 2-balanced signed graphs and many results (such as signed graphs X  definiteness property) do not hold for general k -balanced graphs. We conducted theoretical studies based on graph perturbation to examine spec-tral patterns of signed graphs. Our results showed that communities in a k -balanced signed graph are distinguishable in the spectral space of its signed adjacency matrix even if connections between comm unities are dense. To our best knowledge, these are the first reported findings on showing separability of communities in the spectral space of the s igned adjacency matrix. In our future work, we will evaluate our findings using various real signed social networks. We will also develop community partition algorithms exploiting our theoretical findings and compare with other clustering methods for signed networks. This work was supported in part by U.S. National Science Foundation (CCF-1047621, CNS-0831204) for L. Wu, X. Wu, and A. Lu and by the Jiangsu Sci-ence Foundation (B K2008018) and the Nati onal Science Foundation of China (61073097) for Z.-H. Zhou.

