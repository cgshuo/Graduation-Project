 fi ers with Half&amp;Half method which increased accuracy up to 81.60%. 1. Introduction
Baltic amber gemstones are still mined in present time and used as decorative component for jeweler, souvenirs, or art paintings. The smallest pieces of amber, combining their color tones, transparency, variegation, shape, size and other interface features is mostly used by art crafters. At this time sorting of amber pieces according to the color and the similarity to geo-metric shapes is complicated and time consuming process, manly performed by  X  the eye of human being  X  . The presorted gemstones may be further used for automated craft making. The best solution for amber classi fi cation by color and similarity to geometric shapes is the implementation of fully automated industrial sorting line based on machine vision.

Other researchers acquired good results by extracting visual features and used them for classi fi cation and sorting task into small number of categories. For the surface visual evaluation the fi rst and second order statistical features were used ( Rozman et al., 2006 ). Such sorters usually are used in food industry ( Pearson et al., 2012 ) by grading fruits, garbage recycling ( Shahrani et al., 2010 ), etc. Many of them are based on optical properties of object surface but uses different kind of sensors like CCD cameras, spectroscopy ( O  X  Farrell et al., 2005 ), stereo vision, infrared light, and so on. Optical sensors are able acquire color, shape, texture, and other optical features and in many cases it is a multiclass ( Aly, 2005; Ramanan et al., 2011 ) identi fi cation problem. Optical properties depends on lighting condition, so isolating objects from environment and implementing arti fi cial lighting source may be one of most important key point of the system to work properly. Such systems usually have strict requirements for their performance.
The classi fi cation of color images plays an important role ensur-ing quality of automation and high-speed processing in industry. Employing histogram thresholding techniques, pixels counting, different types of lighting, excluding edges or color tones of searched objects it is possible to obtain good classi fi cation accuracy ( Pearson et al., 2008; Chitade and Katiyar, 2010 ). However it is obvious that classi fi cation of one type objects is more complicated task than identi fi cation of similar objects in the same image.

To best of our knowledge the RGB color features that are available do not work out to solve the general multiclass amber identi fi cation and classi fi cation problem due to nonlinearity of RGB color space. Therefore in this study the HSV color space and multiple concentric regions of interest (ROI) are used for amber gemstone color classi fi cation. The fi nal decision of the identi fi ed class is made my majority voting rule over all ROI's as well as we have applied multiple classi fi es for overall classi fi cation perfor-mance improvement.
 The use of committees ( Lipnickas, 2009; Marton et al., 2012; Ciresan et al., 2011 ) is the one of ways to improve amber color identi fi cation accuracy; unfortunately it is achieved by increased computational burden.

Many researchers have been published promising results on shape classi fi cation: a shape descriptor based on inner-distance is robust to articulation and capture part structure ( Ling and Jacobs, 2007 ); the authors in McNeill and Vijayakumar (2005 ) used correspondence-based technique on the MPEG7 CE-Shape-1 data-base for ef fi cient shape classi fi cation and retrieval, outperforming the popular contour Fourier method ( Zhang and Lu, 2002 ); a framework ( Lillo et al., 2010 ) was developed to recognize objects in images based on their silhouettes; a contour-based shape descriptor presented in Rongxiang et al. (2012 ) avoids the time-consuming pairwise matching encountered in most of the pre-viously used shape recognition algorithms; an image retrieval method proposed in Xiang et al. (2013 ) has better performance than the classical methods based on interest points; an interesting image analysis technique ( Okarma and Mazurek, 2011 ) that allows a rapid classi fi cation of the types of vehicles observed from the side view is the shape analysis.

However although many methods for shape representation have been proposed ( Mingqiang et al., 2008 ), little work has been reported on classi fi cation to geometric shapes and how closely these measures match human perceptions of geometric similarity ( Clark et al., 2006 ). Although there are attempts to classify shapes to geometric shapes ( Huang et al., 2010; Wang and Boyer, 2012; Spasojevic et al., 2012; Mihu et al., 2004; Yildizer et al., 2012; Portela et al., 2014 ), but most of those methods have limits in sense of choosing to which geometric shapes to classify, sensitivity to minor dissimilarities, and time-consuming pairwise matching. Our proposed approach overcomes mentioned limits and is able to classify objects to selected geometric shapes even if most shapes are irregular and very similar to each other. Although an expert knowledge should be involved.

Some of the amber color identi fi cation research was published earlier ( Sinkevicius et al., 2013 ) and this paper takes one step further by proposing a method for amber shapes identi fi cation to one of fi ve basic geometric shapes with many subclasses. Also, results of color identi fi cation experiments were updated because of changed database. The database was slightly improved by removing partially visible samples as their shape is obscured, by forming classes with more uniform size, and making segmentation more robust.

The paper contains four main sections. In the Section 2 , information about used datasets is presented and theoretical background is overviewed. Section 3 presents the experimental results. Finally, conclusions are given in Section 4 . Table 1 sum-marizes all the acronyms and notations used in this paper. 2. Material and methods
The presented system consists of image acquisition, preproces-sing, segmentation, feature extraction, and identi fi cation. All system components should ensure fast computational perfor-mance and accurate identi fi cation. The experiments provided aims to fi nd the best con fi guration of proposed methods. 2.1. Experimental setup The main components of the presented system are presented in Fig. 1 a. Amber samples are dropped on the white conveyer bell from vibro bowl, the laser fork detects amber samples passing it and then image is acquired by digital camera (type FFMV-03MTC, mfg. Point Grey, Canada). Images are processed by the presented algorithm implemented using MatLab 7 software and computer (Intel i7@2.8 GHz CPU, 16G RAM, Win XP64).

The setup was designed to minimize software related image normalization: the parameters like brightness, exposure, shutter time for each acquired image are fi xed; the fast shuttering of camera helps in capturing  X  freezing  X  image of amber moving on the conveyer; proper illumination is ensured by ring LED light lamps which is a scattered light source.
 2.2. Preprocessing
As the scattered ambient lighting was implemented, no further image enhancements are necessary. The process of image normal-ization is shown in Fig. 2 . First step consist of image conversion from RGB color space to binary image ( Fig. 2 b). The threshold for conversion is selected using Otsu  X  s method ( Otsu, 1979 ).
Holes are fi lled and shadows around the object are removed with morphological dilation operation ( Fig. 2 c). If the shape is cut by camera view limits, such shape is removed from database. The scale is normalized by aligning image by its longest part to abscissa axis ( Fig. 2 d). If centroid of image is above the axis, then the image is rotated by 180 1 ( Fig. 2 e). In fi nal step, width of the binary image is resized to 256 pixels keeping aspect ratio to height. Finally the height padded to 256 pixels with zeros ( Fig. 2 f).
The color version of amber is acquired by removing background pixels and leaving only those pixels which the binary shape has after fi lling holes and dilating shadows. In classi fi cation experiments we use pixel values in different color spaces for features extraction. The preprocessed images are preceded for shape analysis.

The presented system relies on amber size which is between 3000 and 30,000 pixels with normal distribution. The peak is around 15,000 pixels. 2.3. Database Baltic amber varies by different physical and chemical properties.
It may have different level of transparency and unique combinations of colors and shades. The texture has different patterns because of little cracks, impurities or bubbles inside. The size and shape of small amber pieces varies too due to preparation procedures and looks very organic.

The craft makers sorted out amber pieces into two different datasets. Samples in the fi rst dataset are classi fi ed by visual appearance of amber surface e.g. color, transparency, texture. The second dataset contains same amber pieces but classi fi ed by its shape similarity to basic geometric shapes as close as possible. Shapes of amber pieces are organic and as a result the similarity to geometric shapes is very ambiguity. Therefore we assume that human error in de fi ning amber classes will be at least 10%.
The experts classi fi ed data varies by color (from yellow to dark reddish), by degree of transparency (from clear to cloudy), by brightness (from bight to dark), and texture (from spots to colorful areas). As a result 30 classes of samples were formed (see Fig. 3 ).
The expert distinguishes fi ve main categories (each category has from four to nine subcategories):
Clear and semi-clear (1  X  8 classes)  X  transparent with a yellow-ish shade or combination of clear and cloudy tones;
Bastard (9  X  17 classes)  X  cloudy (opaque) with small transparent areas;
Crystallized (18  X  22 classes)  X  mainly bastard with many bright color spots;
White (23  X  26 classes)  X  white with  X  colorful intrusions  X  (black, brawn, yellow);
Darkish (27  X  30 classes)  X  black or dark color with small light areas.

The shapes of amber pieces are classi fi ed to fi ve main cate-gories and each category has four subcategories (see Fig. 4 ). The categories of shapes are: Ellipse (1  X  4 classes)  X  from circle to long ellipse;
Oval (5  X  8 classes)  X  similar to ellipse but one axis is asymmetrical; Triangle (9  X  12 classes)  X  any type of triangle;
Regular quadrilateral (13  X  16 classes)  X  rectangle, rhombus, or parallelogram;
Irregular quadrilateral (17  X  20 classes)  X  has four corners but shape is irregular.

Subcategories in a category differ by elongation e.g. the biggest ellipse is a circle.

The formed database consists of 8479 samples, but classes are imbalanced, because some of them dominate and some of them have small amount of samples ( Fig. 5 ). This is important as only half part of database is used for training. 2.4. Identi fi cation by color
In this work the concentric rings (ROI) segmentation is intro-duced. Rings of the same number of pixels are formed starting from center of gemstone (see Fig. 6 ). The number of rings per sample depends on size of one ring and size of whole amber. As segments are of the same size, the remaining pixels (see Fig. 6 .) shown in gray color are not used. Certainly, there are other segmentation strategies like dividing to blocks of same size, but after experimentations we have found that the concentric ring ROIs gives the best accuracy among the other strategies.
By using segmentation it is possible to ensure certain level of quantization i.e. smaller segments have more statistical informa-tion about the sample than bigger segments. For example, if we use mean as feature with all pixels, we have only one value representing the sample but if we compute mean for several segments separately, we have few values representing the sample.
The size of segments cannot be too small because then they are too computational expensive.

After numerical experimentations with RGB, HSV and LAB we have selected HSV and grayscale color features descriptors due to fast performance and good identi fi cation accuracy.

From each segmented ROI's four statistical measures (mean, standard deviation, kurtosis, and skewness) are calculated for gray,
H , S and V values. Mean is calculated as follows:  X  1
M
Standard deviation (2) shows how much variation exists from the mean. If it is small then the intensities are close to the mean; if it is high then intensities are spread out over a large range of values.  X  1
M 1 Kurtosis (3) is a measure of how outlier-prone a distribution is.
For normal distribution it is 3, more outlier-prone than the normal distribution has kurtosis greater than 3; less outlier-prone have kurtosis less than 3. k  X  E v  X  4 =  X  4 :  X  3  X 
Skewness (4) is a measure of the asymmetry of intensities around mean. If skewness is negative, the intensities data are spread out more to the left of the mean than to the right. If skewness is positive, the data are spread out more to the right. The skewness of the normal distribution (or any perfectly symmetric distribution) is zero. s  X  E v  X  3 =  X  3 :  X  4  X 
For every ROI segment the features vector (5) of 16 measures is formed. The amber gemstone sample may have from one to few hundred segments, depending on size and therefore the ROI's descriptors are stored as a matrix.

X where G is the grayscale matrix of segment; HSV is the three dimensional matrix of segment. Feature type is calculated for each dimension separately, therefore the feature vector X color consist of 16 values.

In color identi fi cation experiments different types of classi fi ers were compared: Quadratic Discriminant Analysis (QDA), K Nearest Neighbors (KNN), Radial Basis Function (RBF), Decision Tree (DT), and Pruned Decision Tree (PDT). The most useful multiclass classi fi ers by accuracy and computational performance were Decision Tree (DT) ( Breiman et al., 1984 ) and Pruned Decision Tree (PDT). PDT differs from DT by tree depth (lea fi ness). By pruning a tree its leaves are merged if they are on the same tree branch. In the fi nal stage of the algorithm the voting is implemented. The voting is done by identifying and labeling to one of 30 class all segments in the sample by same classi fi er and then voting for the class which has the majority votes. Further we introduce a committee of many DT or PDT. Each member of committee votes for all segments separately and all results are summed. The class with most votes wins. 2-fold cross validation ( Arlot and Celisse, 2010 ) is used for identi fi cation validation.

Member's selection for committee was implemented by two methods: random selection; Half&amp;Half ( Breiman, 1998 ). The fi rst method trains DT committee by selecting random training subsets. H&amp;H method for fi rst DT uses all training set samples, but for the next one only half correctly identi fi ed by already trained commit-tee and half of not correctly identi fi ed samples. This ensures that new added DT member in the committee will be diverse as well as accurate and will rise the fi nal committee performance. 2.5. Identi fi cation by shape
For the second stage we proposed amber identi fi cation by the shape and label it as closest to one of basic geometric shapes like ellipse or triangle even if most shapes of ambers are irregular and very similar to each other. Although an expert knowledge should be involved. The method is invariant to translation, rotation, scaling, and re fl ection.

As a shape signature a Centroid Distance Function (CDF) was selected. It is a vector r expressed by the distance of the landmark points from the centroid g x ; g y of a shape ( Mingqiang et al., 2008 ): r where the coordinates of landmark points are calculated imple-menting the Moore  X  Neighbor tracing algorithm modi fi ed by Jacob  X  s stopping criteria ( Gonzalez et al., 2004 )  X  P j  X  x j ; y j j
A 1 ; N  X  , where N is the number of landmark points. The number of boundary points given by Moore  X  Neighbor tracing algorithm for every shape is different and should be normalized to selected constant N . This can be applied simply by uniformly selecting desired number of points by averaging points in between or adapting more sophisticated approximation technique. As a result, the number of landmarks for every shape is the same  X  N .
Each CDF value is divided by the sum of all distances in the CDF function to acquire the normalized version of it: r  X  r j  X  N Then the shape feature can be expressed as CDF points: X
Shape representation X shape is invariant to translation due to the subtraction of centroid from landmark coordinates. In order to compensate for orientation changes, CDF circularly shifting is required. If S denotes the number of different starting points for alignment uniformly chosen from landmark points then S circu-larly shifts are needed where each circular shift moves points of the vector to the right by N = S . All shifted versions of original shape features vector represent its rotation variations. Method will be invariant to re fl ections by fl ipping original shape features vector and then shifting the fl ipped vector like it is done with original shape features vector.

In shape identi fi cation experiments same classi fi ers were compared, except QDA which was unable to evaluate covariance matrix and was replaced by Naive Bayes (NB) classi fi er as alter-native. For classi fi cation a DT was created. The DT is trained using a features matrix where rows are the shape feature vectors. One observation has 2 S feature vectors because of CDF function variations: S shifted versions and S fl ipped-shifted versions. The constructed DT model is able to evaluate one CDF vector predict-ing its membership class.

In testing phase the identi fi cation itself for one sample is done by evaluating all 2 S CDF variations of sample using trained DT and then all 2 S variations votes by majority rule. The winner class is assigned to the sample. The validation is done by using 2-fold cross validation.

The experiments proofs that the proposed method of acquiring additional variations of CDF and voting greatly increases identi fi -cation accuracy. 2.6. Identi fi cation by color and shape
The color and shape classi fi ers can be used independent or combined to get a desired result. Although, combining is the aim of the system, but our real world technical setup is designed for only 30 classes as maximum. So, the methods may be more useful if used independently separating ambers by color and only then sorting selected color classes to shapes, or vice versa. In this case any variation of color and shape can be acquired. 3. Results
Firstly the identi fi cation method by color is investigated and its parameters optimized then same is done for shapes identi fi cation.
In the fi nal section we show some use cases of both classi fi ers usage by combining them. 3.1. Classi fi cation by color
Mean, standard deviation, skewness, and kurtosis statistical measures were used as feature types, but there are other statistical measure types like median, mode, percentiles, etc. By using
Sequential Feature Selection, it was possible to select optimal set of feature types, but only for startup. Later as experiments became more complex and data amount increases, this dimensionality reduction method becomes too slow.

We used grayscale and HSV color space for experiments. Each feature type is applied to grayscale, H, S, and V components of HSV separately. This gives 16 features in total per one segment. RGB and grayscale color spaces are much worse than HSV, so they are not very useful for measuring color distance.

DT and PDT classi fi ers were selected (see Table 2 ) for experi-ments because they are reasonably fast to train, accurate and fast to identify. Classi fi ers in Table 2 were compared with simplest segmentation and voting setup by using all pixels of the amber surface and a 2-fold cross validation method. As we introduce more segments and a committee later, computation amounts increases drastically. Most methods are not able to compete with
DT if setup is more complex, only QDA with normalized data gives about the same results, but it still is much slower than DT.
From our experience the proposed concentric rings segmenta-tion works best for amber gemstones. Other types of segmentation still give good results, but not as good as concentric rings. For example, segmentation might be implemented by cutting whole amber surface to stripes or dividing to blocks of same size. If using concentric rings it can be expected about 80% accuracy while size of segment is 400 pixels, the stripes gives about 74% and the blocks gives about 71%. The other advantages besides accuracy using concentric rings: only rings on the edges has pixels with shadows, so the shadows if left after preprocessing have less impact; almost all pixels are used for segmentation which increases the number of votes; all segments are of the same size which is important if statistics from pixels are computed; segments do not overlap and they do not stick out from the amber surface.

For each experiment all samples were divided into prede fi ned amount of segments: all pixels, 3200, 1600, 800, 400, or 200. By using all pixels, total amount of segments is same as samples, but for example if we use 200 pixels per one segment it gives about 0.8 million segments in total and it is computational expensive. Results are shown in Fig. 7 . As we can see, higher segmentation degree gives better accuracy results, but after size of 400 pixels, accuracy growth rate decreases. By using many segments a voting by a majority rule is used. All segments votes and the class having most votes is the winner.

Using very small segments not only increases amount of data, but it also decreases speed of training and computational perfor-mance. We assume what size of 400 pixels per segment is optimal. Smaller size gives better results, but gain is small. On the other hand by using even smaller segments than 400 pixels the training and computational performance drops a lot by having exponential form. It's why we stick to 400 pixels size of segments and assuming it is optimal and rest experiments are done using this size of segments.

Further a committee of different kind DT members is suggested which gives even better results (see Fig. 8 ). We train from one to 32 different classi fi ers and each classi fi er votes for all segments individually. This gives a matrix of votes in which one dimension is segments and another is classi fi ers. The cells of such matrix hold vote of each classi fi er for each segment. All votes are summed and fi nal decision is made by majority rule. The other voting strategies such as  X  one versus all  X  or  X  one versus one  X  are not suitable for this task, because they are far too slow then there are so much classes and segments. Each segment should be identi fi ed indivi-dually by all members of committee and it takes enormous time. Therefore proposed committee strategy is most suitable for real time application.

Although the best accuracy was acquired by 32 DT using random training data selection, we consider that 81.60% accu-racy acquired by 16 DT members in committee created using Half&amp;Half method while segments size is 400 pixels is better. The committee of 32 members is too slow for real time enough. Committee of DT memb ers trained using random training sets are competitive with Half&amp;Half method although the results sometimes are too random and no guarantee they will always be the best possible. PDT shows a bit better results than not pruned DT, but their accuracy drops if committee members amount increases. Keeping in mind that the pruning itself takes a lot of time and accuracy is about the same as using not pruned DT, the not prun ed DT were selected for our application. Using a committee the accuracy increases by about 2  X  3% and this it is still fast enough for our application.
Fig. 9 show how accurate is the fi nal committee for each class separately. Most inaccurate the classi fi er is for class of crystallized type ambers. It might be because used statistics is not able properly to describe bright spots as it is global spatial information.
Best accuracy showed the darkish classes  X  about 92%. 3.2. Classi fi cation by shape
Among many shape feature descriptors not many are suf fi -cient for amber gemstones database even if they perform well on known public databases. For example in our experience, global features, Fourier descriptors, Inner-distance were very inaccurate to identify geometric forms of ambers. It might be because the amber has no bold inner characteristics of shape, almost all of them are just are similar rounded polygons. In this case a similarity measurement with ability to evaluate the sequence of spatial information like landmark points is needed.
For this reason the CDF was selected. It holds all distances from centroid to points of landmark in a sequential order. To prepare a CDF is easy and fast.

Same classi fi ers were compared (see Table 3 ) like was done for color identi fi cation while fi xing landmarks parameter to 64 and starting points to 1. Increasing landmarks helps slightly improve accuracy, but reduces computational performance a lot. QDA was not able to evaluate covariance matrix, so the NB was tested as alternative. The best accuracy was acquired by KNN, but it becomes very slow and even not practical then voting is intro-duced at higher starting point's values. The fastest classi fi ers were
DT and PDT. The pruning was too slow and not used for further experiments.

Further the voting is introduced and the classi fi cation perfor-mance was tested using 2-fold cross validation (see Fig. 10 ). The training data are prepared by extracting CDF variations from each sample in training set. Variations acquired by shifting original CDF or even reversing if more variations are desired. The identi fi cation itself is just a voting by majority rule using all CDF functions extracted from the sample. As the starting points number increases, more CDF variations are created and the higher accuracy is acquired. By reversing CDF functions, accuracy can be slightly increased. The normalization has a minor impact. Best accuracy was 72.10% using DT while landmarks are 64 and starting points are 64. KNN method is better if starting point's value is low but after raising it up to 32 the DT totally outperforms KNN by accuracy and performance.
 Fig. 11 show how accurate the fi nal classi fi er is for each class. Most inaccurate the classi fi er is for regular quadrilateral shapes and it is clear tendency for many classes to misclassify the samples of similar elongation. Best accuracy showed the triangle classes  X  about 77%. 3.3. Classi fi cation by color and shape
We provide some use cases (see Fig. 12 ) as realistic examples of how two proposed classi fi ers can sort out different sets of ambers by main visual properties like color, transparency, texture, and shape.
In Fig. 13 is shown another example in which samples of third and fourth color classes are sorted by different geometrical shapes.
The proposed techniques are already successfully installed into two industrial conveyers and operating at full speed ( Fig. 1 aandb). Thesystemresponsetimeforcolorclassi fi cation is 0.1895 s and for shape classi fi cation it is 0.2048 s. 4. Conclusions
Amber gemstones identi fi cation by color and shape techniques has been proposed using our amber database formed by amber art craft makers. The techniques were tested using 2-fold cross validation and the results shows algorithms ability to identify samples in real time at high accuracy. The algorithms are simple and easy to implement, no complex preprocessing operations are needed.
The fi rst proposed classi fi er is able to identify amber sample and label it to one of 30 color classes. By using mean, standard deviation, kurtosis, and skewness feature types on all amber samples grayscale and HSV pixel intensities best accuracy is about 69% using DT or PDT classi fi er. Introducing concentric rings with voting by majority rule, accuracy increases about 10% and reaches about 79% of overall accuracy. Experiments showed that such narrowing is worth until size of ring reaches 400 pixels. And fi nal results show that a committee can increase accuracy by 2  X  3%. The fi nal result was 81.60% acquired by 16 DT members in committee created using Half&amp;Half method while segments size is 400 pixels.
The second proposed classi fi er labels the organic shape by similarity to one of 20 basic geometric shapes de fi ned by an expert even if organic shapes are very ambiguity for human perception. The proposed technique is based on DT model and no time consuming pairwise matching is needed. Results have shown that extracting CDF vector from a sample and then generating shifted and fl ipped versions of it improves classi fi cation by DT. The identi fi cation itself using voting by each CDF variation of the sample improves accuracy by 10% and the fi nal result was 72.10%. This technique can be used in real time application as it is based on DT model and performs fast.

The both proposed techniques can be used combining them or independently. Accuracy of both classi fi ers satis fi es amber craft makes, as the art maker do the fi nal decision which amber piece to use, but presorted ambers makes this a lot easier and faster.
The future modi fi cation of algorithm could be to fi nd more useful feature types for crystalized classes as they had lowest accuracy. Shapes classi fi er using CDF had some trouble with similar elongation samples as shapes with similar elongation have tendency to be assigned to wrong class. This shows a need to incorporate other type of feature for shapes.
 Acknowledgments
This research is funded by the European Social Fund under the project  X  Microsensors, microactuators and controllers for mechatronic systems (Go-Smart)  X  (Agreement no. VP1-3.1- X  MM-08-K-01-015). References
