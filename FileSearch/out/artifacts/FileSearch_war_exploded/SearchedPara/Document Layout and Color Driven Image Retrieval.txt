 This paper presents a contributi on to image indexing applied to the document creation task. The presented method ranks a set of photographs based on how well they aesthetically work within a predefined document. Color ha rmony, document visual balance and image quality are taken into consideration. A user study conducted on people with a range of expertise in document creation helped gather the right visual features to consider by the algorithm. This shows some benefits for the traditional document creation task, as well as for the case of ever-changing web page banner colors and layout. H.3.1. [ Information Storage and Retrieval ]: Content Analysis and Indexing -Indexing methods.
 Algorithms, Experimenta tion, Human Factors. Image analysis and indexing, doc ument balance, color harmony. When selecting an image to accompany a document, graphic artists/illustrators will us ually follow three basic steps: (a) select the image based on content (i.e., semantic relevance to the article); (b) image quality; (c) document X  X  layout [3], color scheme [5] and image composition [7]; (d) adjustments (e.g. color, crop) may be performed on the final image. In real life situations, graphic designers and journalists do not have all the time they need to find the photograph that would best aesthetically match a document (or perform those adjustments mentioned above); rather, they tend to make acceptable choices [3]. The work described below fo cuses on steps (b) and (c) above, where image quality, layout and color scheme are taken into consideration. Given a document (query), with a blank area to accommodate an image (i.e., the layout of the document is not altered), the goal of the presented algorithm is to rank a set of images based on their image quality and how well they visually balance the document X  X  layout and color harmonize with the document X  X  color scheme. A set of user studies were performed in order to learn what users value when aesthetically matching Color harmony image indexing ha s been proposed where certain attributes are derived of such harmony, and used in keyword search [9] or in query by drawing [2]. In [5] the author presented an image indexing technique ba sed on how well the image color harmonizes with the document co lor layout where it must be inserted; this is proportional to the color patch size ( patchSize ), it can be used in analogous harmony tuned to be very sensitive to color changes ( colorDist ), and it can be tuned to favor closer patches of analogous colors ( centroidDist ). See [5] for details. Visual balance is obtained by ba lancing the visual weight (i.e., left-right, F2) for all objects in the document. Objects are paragraphs, titles, banners, images, etc. For an image object, each of the regions within the image s hould be considered [4][6], since certain regions will have higher visu al weight than others [1]. In [6] the author showed that the image visual weight map can be approximated by an image appeal map that takes into consideration sharpness, contra st and chroma; this map is thresholded and the resulting region ( visualWeight_region ) is used to measure how well this image balances the rest of the objects in the document. The visual balance measure from [6] was improved by incorporating the difference in region sizes ( width_height_dist ) as presented in [8] (see [6] for details): The color harmony measure was found to be less relevant than the visual balance measure (F1). Also the fact that when one of the features is below a threshold, the overall result is considered unacceptable (F6), yielded the following measure between image i and the query document: This formula does not take care of the extreme cases (close to the axes) where one of the measures may be small and the other may be very large. Therefore, a ha rd-coded threshold (optimized from the gathered ground truth, see next section), was integrated in the algorithm, down-weighting the im ages whose coordinates would lie below the curve (Figure 2) (F6). In future work, a machine learning approach will be developed, in order to optimize these thresholds, based on a larger set of ground truth. A collection spanning 9 days was used (882 images overall), all images, good and bad were consid ered, and no image adjustments were performed. Two different documents (Figure 1), were printed with each photograph, and were tagged as ground truth by the same users as above, into three sets: works , maybe (weighted at 50% of works in the retrieval experiments), and doesn X  X _work. The proposed method was run on the collection set twice (once per query). For comparison purposes, the ranking based on color harmony only, and the ranking based on document balance only 
