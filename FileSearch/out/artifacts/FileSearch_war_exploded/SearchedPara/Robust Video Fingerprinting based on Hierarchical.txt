 The piracy of copyrighted digital content over the Internet infringes copyrights a nd damages the digital content industry. Accordingly, identifying and monitoring technology on the online content service like fingerprinting is getting valuable through the explosion of digital content shar ing. This paper proposes a robust video fingerprinting feature to identify a modified video clip from a large scale database. Hierarchical symmetric difference feature is proposed in order to offer efficient video fingerprinting. The feature is robust and pairwise independent against various video modifications such as compre ssion, resizing, or cropping. Moreover, videos undergoing a tran sformation such as flipping or mirroring can be identified by simply disordering the bit pattern of fingerprints. The performan ce of the proposed feature is extensively experimented on 6, 482 hours of database and the experimental results show that the proposed fingerprinting is efficient and robust agains t various modifications. H.3.3 [ Information Storage and Retrieval ]: Information Search and Retrieval Algorithms, Experimentation Video Fingerprinting, Video F iltering, Video Identification, Content-based Filtering In recent years, information on the Internet has been flooded by popularized digital devices and online media services such as smart phones, mp3 players, mob ile video players, video-on-demand, and music-on-demand. Thus, searching and managing technologies are required to handl e massive information. In the meantime, copyright violations such as file sharing without permission are becoming a social problem. The piracy of copyrighted content over the In ternet infringes copyrights and damages the digital content industry. There have been many researches on protecting illegal f ile sharing and managing massive amounts of digital content. Vide o fingerprinting provides a fast and reliable identification method of video content and is used to identify, monitor, and block copy right-violating digital video. The method uses perceptual features extracted from video content that have discriminating characteristics. Researches on video fingerprinting have been focused on the spatial, temporal, color, and tran sform domains of a video. Bhat and Nayar proposed an ordinal meas ure that divides a video frame into sub-blocks and orders the s ub-blocks by their mean value of pixel intensities [1]. Some other studies used an ordinal measure along with a resampled frame, tempor al trail of the ranking value, and motion direction and color hi stograms [2]-[4]. These methods have slightly different facets but commonly show a good performance for global modifications such as brightness changes, blurring and compression. Ho wever, its discriminating performance is not sufficient for locally modified video that has been cropped or undergone logo or caption insertion because sub-block ranking is mixed up by local intensity changes. Oostveen et al . proposes a binary video feature that employs the differential value between neighboring sub-blocks through a temporal FIR filter and abstracts its result [5]. The feature is simple and has compact size but, could lose its discriminating characteristic when the difference between neighboring sub-blocks is insufficiently small for reliable abstraction. Lee and Yoo use condensed edge distribution in divided sub-blocks , named centroids, of gradient orientation, which shows robust performance for global variations such as brightness, contrast, and color changes [6]. Iwamoto et al . also use edge information as a fingerprint, and their method is robust to caption superimposition [7]. Shivakumar proposes shot-based fingerprinting that detects the temporal locations of a shot change in a video and estimates the duration between shots [8]. However, this fingerprinting is not sufficient when used solitarily because shot detection is inaccurate in many cases. In this paper, we propose hier archical symmetric difference (HSD) video fingerprinting feature against the unintentional modification of video, including brightness, blurring, cropping, compression, frame-rate modifica tion, resolution modification, screen flipping and screen mirroring, to search and protect copyrighted digital video conten t, and an efficient matching method for large-scale databases. The proposed feature is compact, precise, and efficient as compared to centroids of gradients method and has been ve rified for a large-scale video database experimentally. Figure 1: 38 Hierarchical Symmetric Difference Video Fingerprinting Features Table 1: Probability of a false rejection ( perceptually different videos with BER=0.2 Mass storage is required when we build a video fingerprinting database even when the fingerprint has a small feature size because a video is composed of a large amount of frames. It is even worse for copyrighted video filtering when the database contains thousands of videos. T hus, the compactness and structure for rapid matching are mandatory in video fingerprinting. In this paper, a hierarchical symmetric difference, which represents the essential feature of frames with a compact feature size, is used for precise matching. To extract proposed feature, a video input is resampled in the temporal direction to reduce the number of frames to be processed, and then normalized into a fixed resolution of 320*240. A normalized frame is grayscaled then a frame is divided into m*n sub-blocks, and its p th local mean value of luminance ML(p) is calculated as described in (1) before extract HSD. Then, HSD of the p th block means DBM(p) is obtained by subtracting the symmetr ically distributed sub-blocks as in (2). We build 38 pairs of a symmetric structure from 8*8 sub-blocks. As shown in Figure 1, the former part of the symmetrical sub-block pair is occupy the wide area of a frame, and the organizing area is reduced by going back to the latter pair. In the figure, plane-red blocks represent Region A and striped-blue blocks are Region B . The order of HSD is hierarchically organized, so the former structure includes features from the latter structures. This organization of structure is useful when searching from a large scaled database. Former features could be used for fingerprint indexing to retrieve the database quickly by excluding dissimilar fingerprints, and latter features are used for calculating precise distance from the candidates. We compress the HSD through binarization in order to reduce fingerprint size as described in (3 ), and use 38 structural pairs to guarantee the performance. If the feature is extracted at a rate of 5 frames per second, the fingerprint size of one hour of video is 84kbytes. Also, it takes an advantage of computation because of its simplicity of calculation especially when a database is organized with a massive number of videos. Efficiency is the most important factor in identifying a video in a large-scaled database, especially for commercial applications. Usually, a linear search shows the best performance in data matching, but it is not applicable for a massive database due to the searching time. The proposed met hod uses former 8 features out of 38 in Figure 1 as an index to reduce the matching time. These former features occupy larger regions in the feature domain. We use hamming distance as in (4) to compare the query clip X  X  fingerprint based on the bit error rate (BER). For example, L*38 bit pairs are compared when a query is composed of L frames, and the BER is calculated in L-1 summation and L*XOR operations. The BER distribution of fingerprint pairs of a perceptually different clip and modified clip are experimentally obtained for 10 and 20 sec videos by the experime nts as shown as Figure 2(a) and (b). Modification1 is lossy compression (LC), Modification2 is brightness change (BR), Modification3 is resizing (SZ), Modification4 is frame rate change (FR) before lossy compression, and Modification5 is an aggregation of all modifications. We present a false rejection ratio for BER=0.2 in Table 1, and it is certain that the longer fingerprint length ( L ) reduces the error rate. The false alarm ratio for BER=0.2 is zero in both 10 and 20sec. To analyze fales alram probability, we use binomial distirution B(n,p) with p=0.5 because of Hamming distance is used for a distance measure in the proposed method, and the probability p is determined by experiments. A binom ial distribution is regarded as normal distribution N(np, npq) when n is large enough, so could be adjusted as in (5). However, each bit of a fingerprint is not identically independently distributed, and the variance of is supposed to increase in multiples of k as in (6) by Haitsma in [9]. 
Table 2: False alarm and false rejection ratio of the proposed method for 6,482hours of a video database fingerprint pairs with 20s ec (k=124) and 100sec (k=190) Figure 2(c) shows the empirical distribution of 7,611,579 different fingerprint pairs. The length n of HSD is 3,800 for a 20sec clip when the video is normalized as 5fps, and ( np , knpq ) becomes (1900, k *950). For a 100sec clips, n is 19,000 and ( np , knpq ) becomes (9500, 4750). Thus, the value of k for a 20sec clip is estimated as 124.1 compared to empirical distribution (1874.3, 117900), and k =190 for 100sec clips compared to the empirical value (9373.4, 904290). The probability of a false alarm for 20sec clips with BER=0.2 is 5.8664e-004 theoretically by (7), and it is not so far from the empirical value of 9.14e-004. If 100 sec length clips are used, a false alarm in the proposed method is approximately expected as 2.22e-009 for BER=0.2. The false alarm is estimated as 0.01 for 20sec clips and 5.515e-005 for 100sec clips, respectively, when BER=0.3. The performance of the proposed vi deo fingerprinting is evaluated using 230,160 pairs of video clips for robustness comparison, and 6,482 hours of videos are used for overall performance evaluation. Experiments were pe rformed on a Pentium dual core (2.8GHz CPU, 6MB cache, and 4GB RAM). HSD features of 38 dimensions are extracted from normalized video, 320*240 spatially and 5fps temporally. The performance of the proposed system is evaluated by its success ratio and searching time. In the success rate, we allow time line margin of error in original video within 1sec and use 0.1 of BER for the matching threshold. We compare the proposed fingerprint with the centroids of gradients [6] in a receiver operating characteristics (ROC) curve that plots the false rejection rate ( (
P ) in order to evaluate the performance of the features. Sixteen former features and 16 latter features of the proposed fingerprint are evaluated separately to have an equal feature vector dimension with the centroid of gradients. Hamming distance is employed to compare the coded fingerprints extracted from 10 sec video lengths at 10fps and 320*240 resolution. A total of 230,160 pairs of original and modified videos are experimented on to obtain a false rejection ratio, a nd 15,223,158 video clips that are perceptually different from a query clip are experimented on to obtain a false alarm ratio. ROC curves are displayed in Figure 3. For a fixed false alarm ratio, the 16 latter features have a smaller false rejection ratio in most of th e steps shown in Figure 3. This is induced by the difference of area in forming the feature, and this means that the former features are robust against severely modified video, and that the latter features are appropriate for finding an exactly matched clip. Thus, HSD features can be organized differently based on the goal of the identification system. The performance of centroids of gradients is in the middle of the 16 former and latter features , but it is slightly better than the two curves in the extremely low false alarm ratio. 41,000 video clips are experime nted on using 6,482 hours of database to evaluate the performance for a large-scale database. Three kinds of modifications are added to query video in the reflection of file sharing circumstances. 
ModificationA -Add Gaussian blur (GB) and increase the brightness (BR) 20% before re-c ompressing the query video. 
ModificationB -Insert a subtitle (ST), which possesses 12% of the frame area, and resize (SZ) to 320*240 before re-compression. 
ModificationC -Crop (CR) the frame 15% before re-compressing (LC) the clip by 500kbps. A total of 123,000 modified clips overall are queried to evaluate the robustness, and 95.49% of the clips are successfully identified, where the average search time is 1.53sec as shown in Table 2. In the result, the success rate for ModificationC is lower than ModificationA and ModificationB . The relatively low success rate of ModificationC is expected because changed HSD values by cropping the frame affect the success rate. However, this weakness is acceptable because the cropping is done around the outside of the frame and does not severely interrupt the center area in usual situations. We al so experimented on 31,600 unlisted video clips that are not included in the database to verify the pairwise independence, and its result is a 0% success rate as listed in Table 2. In this paper, a video fingerp rinting based on hierarchical symmetric difference is proposed. The proposed video fingerprint is superior in pairwise indepe ndence for a large-scale database and is robust against usual video modifications, in addition to its sufficiently high speed identification performance, which is required for commercial applicati ons. The variables that control the identification performance are theoretically estimated and experimentally verified. Further research will focus on the candidate search method such as scene duration detection to minimize the searching speed. Concisely selected features of HSD could be a solution for robust candidate searching by categorizing the database. This work was supported by the IT R&amp;D program of MSCT/KEIT. [10035229, Developmen t of content protection and distribution technology on DRM-free environments] [1] Dinkar N. Bhat and Shree K. Nayar. 1998. Ordinal Measures [2] A. Hampapur, K.H. Hyun, and R. Bolle. 2002. Comparison [3] X. Hua, X. Chen, and H. Zhang. 2004. Robust Video [4] C. Kim and B. Vasudev. 2005. Spatiotemporal Sequence [5] J. Oostveen, T. Kalker and J. Haitsma. 2002. Feature [6] S.I. Lee and C.D. Yoo. 2008. Robust Video Fingerprinting [7] K. Iwamoto, E. Kasutani and A. Yamada. 2006. Image [8] N. Shivakumar. 1999. Detecting Digital Copyright Violation [9] J. Haitsma and T. Kalker . 2002. A Highly Robust Audio 
