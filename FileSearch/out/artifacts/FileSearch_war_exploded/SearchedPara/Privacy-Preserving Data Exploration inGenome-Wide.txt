 Genome-wide association studies (GWAS) have become a popu-lar method for analyzing sets of DNA sequences in order to dis-cover the genetic basis of disease. Unfortunately, statistics pub-lished as the result of GWAS can be used to identify individuals participating in the study. To prevent privacy breaches, even previ-ously published results have been removed from public databases, impeding researchers X  access to the data and hindering collabora-tive research. Existing techniques for privacy-preserving GWAS focus on answering specific questions, such as correlations between a given pair of SNPs (DNA sequence variations). This does not fit the typical GWAS process, where the analyst may not know in ad-vance which SNPs to consider and which statistical tests to use, how many SNPs are significant for a given dataset, etc.

We present a set of practical, privacy-preserving data mining al-gorithms for GWAS datasets. Our framework supports exploratory data analysis, where the analyst does not know a priori how many and which SNPs to consider. We develop privacy-preserving algo-rithms for computing the number and location of SNPs that are sig-nificantly associated with the disease, the significance of any statis-tical test between a given SNP and the disease, any measure of cor-relation between SNPs, and the block structure of correlations. We evaluate our algorithms on real-world datasets and demonstrate that they produce significantly more accurate results than prior tech-niques while guaranteeing differential privacy.
 H.2.8 [ Database Management ]: Database Applications X  Data min-ing ; J.3 [ Life and Medical Sciences ]: Biology and genetics, health Algorithms, Security Differential privacy, genome-wide association studies  X  This research was primarily undertaken while the author was at The University of Texas at Austin.
Genome-Wide Association Studies (GWAS) have become a pop-ular method to investigate the genetic basis of disease. A typical study examines thousands of singe-nucleotide polymorphism loca-tions (SNPs) in a given population of patients for statistical links to a disease. Recent work has shown, however, that the large vol-ume of data collected from each patient exposes them to privacy breaches X  X ven if only the aggregate statistics are reported! Homer et al. showed that a patient X  X  disease status can be inferred from the p -values of the statistical tests associating each SNP with the disease [12]. Furthermore, Wang et al. showed how correlation statistics among SNPs can be used to reconstruct patients X  actual genomes [33]. As a consequence, NIH removed even aggregate GWAS results from public-access databases, hindering collabora-tive research on the genetic factors of disease [35].

To support such collaborative research, investigators must be able to perform typical data mining tasks involved in GWAS in a manner that preserves privacy of study participants. Differential privacy provides a mathematically rigorous framework for design-ing privacy-preserving algorithms, but standard differential privacy mechanisms [6, 22, 25] cannot be applied directly to GWAS. In a typical GWAS, the number of outputs (e.g., correlations between SNPs) is orders of magnitude greater than the number of patients in the study. The amount of random perturbation that must be ap-plied to mask the contribution of any single patient scales with the number of outputs and renders the perturbed results unusable.
Fortunately, the purpose of GWAS is to discover  X  X nteresting X  statistics that are most likely to indicate the genetic basis for a given disease. Privacy-preserving GWAS can be designed to produce a small number of outputs and thus achieve higher accuracy. Exist-ing techniques for doing this [2, 8] assume that the analyst knows beforehand which questions to ask: for example, top k most sig-nificant SNPs (the analyst must know k ) or a specific correlation measure between a certain pair of SNPs.

In a typical GWAS, however, the number of significant SNPs and the pairs of correlated SNPs are the output of the study, not the input! The analyst explores the dataset [24], choosing the most appropriate statistical tests, discovering the regions of the genome that look interesting, etc. Existing methods for privacy-preserving analysis of genetic data do not support this kind of exploration. Our contributions. We develop an algorithmic framework for ab initio exploration of case-control GWAS datasets that allows an an-alyst to obtain privacy-preserving answers to key GWAS queries without prior knowledge of the  X  X ight X  questions to ask. Specif-ically, we design and implement algorithms for accurate, differ-entially private computation of: (1) the number of SNPs that are significantly associated with the disease; (2) the location of the most significant SNPs; (3) p -values for any statistical test between a given SNP and the disease; (4) the block structure of correla-tions among SNPs; (5) any measure of correlation between a pair of SNPs. To achieve this, we develop a general distance-score mech-anism which may be of independent interest.

We analytically and experimentally evaluate our algorithms on real and simulated data, demonstrating their practical utility. In the few cases where a direct comparison with prior techniques is pos-sible, we show that our algorithms produce significantly more ac-curate results. We are able to query hundreds of thousands of SNPs and get the exact number of significant SNPs the majority of the time; discover SNPs with p -values whose magnitude is within 20% of the maximum possible value in cases where previous work pro-duced nearly 100% error; and also release the p -values themselves with an order of magnitude better accuracy for typical values than previous work. Finally, when patient populations are on the or-der of several thousand, we can release correlation blocks covering most of the interesting parts of the genome that are within 5% error 95% of the time.
A case-control GWAS examines a case population of patients with a given disease and a control population without the disease. The genomes of all patients are sequenced at a large number of SNP locations. GWAS aims to find association between the alleles at these locations and the disease status of the patient. Association between SNPs and the disease. The association be-tween the disease status and individual SNPs is typically measured using the p -value of a statistical test for independence. p -value indicates the probability that the observations are due to chance, assuming the SNP and disease are not actually correlated. GWAS aims to find SNPs whose p -values are low enough to be significant (i.e., the association of these SNPs with the disease is unlikely to be explained by pure chance) in order to further investigate the bio-logical function of the genes covering these locations and the causal relationship between these genes and the disease. SNPs with low significance are not targeted for further research.

Therefore, one of the goals of privacy-preserving GWAS is to publish X  X s accurately as possible, while preserving privacy X  X he significance levels for the SNPs that are most correlated with the disease. The number of such SNPs is much smaller than the total number of SNPs involved in the study.
 Correlation among SNPs. Many GWAS also report correlations among SNPs. SNPs that are significantly associated with the dis-ease but not correlated with each another may represent indepen-dent risk factors for the disease and indicate the existence of differ-ent biological mechanisms associated with the disease.

SNP correlations can be taken from publicly available data rather than the study-specific patient data (e.g., [5]). This is obviously safe from the privacy perspective. Using patient data is preferred, however, when correlations in the study population are expected to be different from those in the public data. This can happen if the study population consists of a different racial group than the public data, if the disease itself affects SNP correlations, or if the set of SNPs examined in the study are not available in a public dataset.
A study may report individual correlations between SNP pairs of interest [5, 27], or a  X  X eat map X  of the correlations among all SNPs in a region [5, 13, 27, 28, 34]. Heat maps are often imprecise, but SNP correlations tend to exhibit a structure that allows the genome to be segmented into correlation blocks so that correlations are high within a block and low across blocks [9]. Identifying these blocks and the small set of likely allele sequences ( haplotypes ) for each block is the goal of the International HapMap Project [14].
GWAS may also report high-level patient data, such as popula-tion demographics and relevant clinical information, and general data about the genetic sequencing, such as success rates. The challenges of differentially private GWAS. Direct applica-tion of standard differential privacy mechanisms to GWAS yields poor accuracy because the number of outputs is very large rela-tive to the number of patients in the study. For example, consider using the basic Laplace mechanism of Dwork et al. [6] to output the degree of independence between each SNP and the disease, that is, the p -value of an independence test. Suppose that there are m SNPs and n patients. The sensitivity of the p -value X  X he maximum amount by which it can change when a single patient is replaced X  X s O (1 /n ) because any value in [0 , 1] can be reached by replacing all n inputs. The Laplace mechanism then adds ran-dom noise with a standard deviation of O ( m/n ) . A typical GWAS analyzes on the order of m = 10 5 SNPs over a total patient pop-ulation on the order of n = 10 3 , thus O ( m/n ) noise will render the outputs useless. In general, assuming that the output for ev-ery SNP reveals independent information about each patient, one cannot hope that GWAS (1) produces an output for all SNPs, (2) preserves privacy, and (3) provides useful outputs.

One way to limit the amount of noise that must be added in order to guarantee privacy is to limit the number of outputs: for example, publish only the p -values and pairwise correlations of the signifi-cant SNPs. However, the analyst must determine beforehand which outputs to publish. For example, Fienberg et al. [8] assume that the analyst knows in advance the number of  X  X nteresting X  SNPs and the statistical tests to use. Similarly, to use the mechanism of Bhaskar et al. [2] to publish correlation blocks, the analyst must know in advance the number of blocks to publish, the correlation measure to use, and a scoring mechanism for choosing the blocks. This is a  X  X atch-22 X : in practice, the analyst X  X  choice of these parameters depends on the actual dataset, and direct application of generic dif-ferential privacy mechanisms to compute these parameters suffers from the poor accuracy we wanted to avoid in the first place.
Let each patient record in the database be I = { 0 , 1 } m +1 m is the number of SNPs examined. The first m bits indicate pos-session of at least one copy of the minor (i.e., less common) allele, the final bit indicates the disease status of the patient. databases is D = I n , where n is the total number of patients. We fix m and n to be constant over all input databases, and can thus publish them without privacy loss. Let D i denote the i th patient vector in database D . Two databases D,D 0  X  D are neighbors ( D  X  D 0 ) if they differ only in the data of a single patient.
Let O k` ij ( D ) = |{ h : D hk = i  X  D h` = j }| , where i,j  X  X  0 , 1 } , 1  X  k,`  X  m + 1 , be the number of patients with a value of i for the k th input bit and j for the ` th bit. Similarly, O k D hk = i }| . Let f k` ij ( D ) = O k` ij ( D ) /n be the fraction of patients with values i and j for bits k and ` , respectively, and f O ( D ) /n . Let p : N 4 0  X  [0 , 1] be a test of independence yielding a p -value, and let p i ( D ) be the p -value of the i th SNP as determined by p . Let c : N 4 0  X  [0 , 1] be a correlation metric, and let c be the correlation of the i th and j th SNPs as determined by c . In general, we drop the database, superscript, or subscript notation where it is clear from the context.
 Disease association. Statistical tests used to obtain p -values for independence between a SNP and the disease include  X  2 [5, 28,
This assumes a dominant model of the gene, used, for example, by Sladek et al. [28]. Our framework works similarly for recessive and additive models. 34], Fisher X  X  exact test [5], and logistic regression [13, 27, 34]. The outcome of an independence test is said to be significant, that is, sufficiently unlikely to have occurred by chance, when its p -value falls below a threshold  X  (we use  X  = . 05 ). When considering m simultaneous tests, an adjusted threshold of  X /m gives the same effective significance for all p -values that fall below the threshold.
Our framework is designed to work with any independence test that yields a p -value. By the nature of differential privacy, the lower the sensitivity of the test, the more accurate the results. We gener-ally use the G test [30] for p -values in our analysis because it has reasonably low sensitivity.
 Correlation blocks. Blocks of correlated SNPs can be defined us-ing the  X  X onfidence-interval method X  of Gabriel et al. [9] or the  X  X our-gamete rule X  of Wang et al. [32]. The popular HaploView software package [1] also implements its own  X  X olid spine X  method. All of these methods (1) choose some measure of correlation, (2) use it to define when a sequence of SNPs constitutes a valid block , and (3) compute a set of disjoint valid blocks.

Our algorithms for privacy-preserving computation of correla-tion blocks take the correlation measure as a parameter. Common measures include the normalized linkage disequilibrium D 28], and the correlation coefficient r 2 [5, 13, 34]. We use HaploView X  X  solid-spine definition of a valid block (Definition 1) because it is insensitive and simple. Its parameters are  X  M , a threshold for the minor-allele frequency (MAF) of a SNP, and  X  c , a threshold for the correlation between two SNPs (we use  X  M = 0 . 225 and  X  c Recall that f k 1 denotes the minor-allele frequency of SNP k .
D EFINITION 1. The segment from the k th to the ` th SNP, k  X  ` , is a valid block if all of the following hold: f k 1 &gt;  X  c
This definition uses a MAF threshold because correlation mea-sures are less reliable (and more sensitive) when the number of observations is small. Thus, a block is valid if the ends have a significant correlation and each interior SNP is not significantly un correlated with the ends.

To select a set of disjoint blocks, we greedily choose the longest valid block that does not overlap with previously chosen blocks. If the underlying correlation structure is truly a sequence of segments such that SNPs are correlated within segments and uncorrelated between segments, this algorithm produces the correct partition. Furthermore, it helps to maximize the number of SNP pairs that are revealed to be correlated. Haploview uses similar greedy methods. Differential privacy. Differential privacy [6] is a popular frame-work for designing privacy-preserving algorithms. If D is the space of possible input databases and R the range of possible outputs, a mechanism M : D  X  R is -differentially private if, for all D,D that differ only in a single input (i.e., D  X  D 0 ), Pr [ M ( D ) = r ]  X  Pr [ M ( D 0 ) = r ] e , where is the privacy parameter.

The amount of random noise that needs to be added to the output of a computation to achieve differential privacy depends on the sen-sitivity of the computation. For f : D  X  R k , sensitivity is defined
Differential privacy  X  X omposes X  [6]: if M 1 and M 2 are -differ-entially private, then M 2  X M 1 is 2 -differentially private.
In this section, we give an overview of GWAS queries supported by our framework. In the following, D  X  X  is the input database; S is a set of m SNPs; B is a set of blocks ( b 1 ,b 2 ) , 1  X  b i,j,k are integers in [1 ,m ] ; and &gt; 0 is the privacy parameter. For any differentially private query Q ( ,  X  ) , let Q 0 be the  X  X rue X  value, which the query would return if privacy had not been a concern. NumSig ( ,D,p,k ) returns the number of significant SNPs in D as determined by p , with a factor-2 approximation above k . Let s = |{ i : p i ( D )  X   X  | . Then NumSig 0 = s if s  X  k and NumSig 0 = max(2 b lg( s ) c ,k ) otherwise. Thus for any  X  &gt; k , if NumSig returns  X  , then there are at least  X  and fewer than 2  X  sig-nificant SNPs. The approximation above k allows the mechanism to lose accuracy on high values, where it matters less, in exchange for higher accuracy on low values.
 LocSig ( ,D,p,B,k ) returns the location of top k SNPs from B , ordered by increasing p -values as determined by p . B allows the querier to focus on the segments of most interest, for example by excluding regions correlated with SNPs already known to have significant p -values.
 LocBlock ( ,D,c,B,S ) returns the location of the longest cor-relation block, following the definition from Section 3 with c as the correlation measure, and with the additional constraint that the segment be wholly contained within some block in B and include some SNP in S . B can be used to, for example, exclude blocks that are already known. S allows the querier to find the correlation block containing a known SNP.
 SNPpval ( ,D,i,p ) returns the p -value of a given SNP, that is, SNPcorr ( ,D,i,j,c ) returns the correlation of two SNPs, Using queries for exploratory GWAS analysis. The above queries allow the analyst to progress from a rough idea about the number of significant SNPs to detailed information about their identities, p -values, and mutual independence. They also enable the analyst to select the statistical tests and correlation measures that are most appropriate to the study.

For example, the analyst may begin by using NumSig with pri-vacy parameter / 4 to obtain an upper bound k on the number of significant SNPs. Then, he can obtain their locations S by ex-ecuting LocSig with privacy parameter / 4 , assuming k is small enough for all of them to be accurately released. The analyst may then try to discover the correlation blocks containing the result-ing SNPs by iteratively executing LocBlock with privacy parameter / (4 k ) , SNP set S , and a block set B that excludes all previously released blocks. Finally, he can obtain the p -values for the spe-cific significant SNPs by using SNPpval on the SNPs in S , with privacy parameter / (4 k ) each time. The resulting outputs will be -differentially private.

This process illustrates the general strategy of using the data itself to focus on the most useful results while maintaining pri-vacy and accuracy . Other combinations of queries may be useful, too. For example, the analyst may want to obtain independent sig-nificant SNPs located in different blocks. To achieve this, he can alternate calls to LocSig and LocBlock , asking for only one SNP at a time and excluding those contained in previously released blocks.
Also, because all queries take the statistical measures as param-eters, the analyst can choose those most appropriate for the domain and change them as data exploration progresses. He may, for ex-ample, use one of the preceding procedures with the G test as the independence test p and the correlation coefficient r 2 as the cor-relation measure c . These have relatively low sensitivity, and thus they would provide accurate results for the set of significant SNPs and the correlation blocks that contain them. Then he could apply SNPpval with the  X  2 test as p and SNPcorr with linkage disequi-librium D 0 as the correlation measure c to obtain metrics that are more familiar to researchers in his field.
Many of the queries from Section 4 depend on every SNP in the input database and thus have high sensitivity, making it challeng-ing to produce accurate, yet differentially private answers. Further-more, some of these queries have complicated output spaces.
A standard tool for designing differentially private algorithms for complex spaces is the exponential mechanism [22]. To apply this mechanism, one must define a score function q : R  X D  X  R that assigns a value to each possible (output, input database) pair. The exponential mechanism E q,  X  has output distribution Pr [ E
In this paper, we define a general score function d called the dis-tance score that works for arbitrary output spaces. In addition, The-orem 9 shows that it is highly accurate because it approximates the  X  X est X  possible scores under the requirement that the correct output must have the highest score, where we consider a score function to be better on a specific input if it yields a higher probability for the correct output under the exponential mechanism.

Let f : D  X  R be the query. The score is computed as follows:
Intuitively, scores given by d are based on the distance from the input database to the  X  X dge X  of the set of databases for which a given output is the true output. Its sensitivity  X  moving to a neighboring database can only change the distance to the edge by 1 . We use the term distance-score mechanism for the exponential mechanism equipped with this score function and sen-
When the score d is not efficiently computable, we use a lower bound on the distance that also has sensitivity of at most 1 . To the extent that these lower bounds approximate the true distance, they also approximate the best scores possible.
In this section, we give privacy-preserving mechanisms for eval-uating the queries of Section 4. Proofs of privacy theorems appear in the full version of this paper. We note that these mechanisms can be implemented in polynomial time, although we omit the details. The worst-case sensitivity of NumSig 0 is m because there exists a database in which every SNP count is one patient away from cross-ing the significance threshold. Applying the Laplace mechanism thus requires Lap ( m/ ) noise, completely destroying the utility of NumSig 0 the true value of which ranges from 0 to m .

Instead, NumSig uses the distance-score mechanism of Section 5 with an approximate distance function. NumSig focuses on accu-racy where most important X  X here there are a small number of significant SNPs X  X y reducing the output space to a set of inter-vals such that, for a given interval, the largest contained value is within a factor of two of the smallest contained value. This pro-vides constant relative accuracy. In addition, values of k or less are output directly, without being given as a larger containing interval.
Instead of the actual distances, we use lower bounds that can be computed efficiently. We first compute, for each individual SNP i , the distance d p i to a database at which the significance of this SNP changes, where significance is determined by p . The sign of d dicates if the SNP gains significance (positive) or loses it (negative) We then consider each output of NumSig larger than NumSig j be the number of additional SNPs that must be significant for this value to be the true query answer. To lower-bound the distance to a database such that NumSig 0 takes this larger value, we order the non-significant SNPs by their distances d p i and use the j th smallest one. Lower bounds on distances for outputs smaller than the true answer are calculated similarly.

Formally, let d p i ( D ) be the minimum number of rows in D that must be modified to change whether or not the i th SNP is below the threshold; the sign of d p i indicates the significance of the i th SNP: d p i ( D ) =
Let  X  be the permutation that sends SNPs sorted by increasing distances d p i to their original position (that is,  X   X  1 d ( D ) &lt; d p j ( D ) ). Let R be the range of NumSig . Let  X  smallest output in R , that is,  X  i = i for 0  X  i  X  k and  X  for i  X  k . The following score function provides the desired lower bound on the distance score (Equation 1):
For 0 &lt; i &lt; | R | X  1 , q 1 (  X  i ,D ) = and q NumSig then uses the exponential mechanism and outputs E q
The sensitivity of the score function q 1 is, as with a true distance function, at most 1 . Differential privacy then follows directly from the exponential mechanism.

T HEOREM 1. NumSig satisfies -differential privacy. To allow accurate release of the identities of the significant SNPs, LocSig limits the number of revealed SNPs to a user-specified pa-rameter k (e.g. as obtained via NumSig ). The smaller k , the more accurate the output of LocSig . The LocSig mechanism is given in Algorithm 1. It uses the distance to significance as the score for a SNP and then iteratively applies the exponential mechanism on the Algorithm 1 LocSig mechanism 1: function L OC S IG ( ,D,p,B,k ) 2: q 2 ( i,D )  X  3: for j  X  1 ,k do 4: repeat 5: sig  X  X  /k q 6: until sig /  X  sigs 7: sigs [ j ]  X  sig 8: return sigs SNPs in B with the privacy budget of /k for each iteration, where the user specifies B to indicate which regions to search.
Privacy of LocSig follows from that of the exponential mecha-nism and the compositionality of differential privacy.

T HEOREM 2. LocSig satisfies -differential privacy.
There are 2 m  X  1 ways to fully partition a region with m SNPs into blocks. The huge size of this output space does not allow both privacy and accuracy when the size of the input n &lt;&lt; m .
LocBlock just outputs the longest block such that the output is within some block b  X  B and contains some SNP s  X  S . Thus the output range can be limited only to the areas of most interest, improving accuracy. LocBlock uses the distance-score mechanism but with an approximate distance function that uses efficiently-computable distance lower bounds. We build up these bounds through a series of intermediate bounds for functions re-lated to the longest block.
 Let d 1 k ( D ) be the minimum number of patients whose input to D must be changed to reduce the MAF of the k th SNP to below  X 
M . Let d 2 k` ( D,c ) be the minimum number of patients whose input must be changed to bring the MAF of SNPs k and ` above  X  and the correlation between the SNPs above  X  c . Let d 3 k` minimum number of patients whose input must be changed to bring the MAF of SNPs k and ` above  X  M and the correlation between the SNPs below  X  c . d 4 k` ( D,c ) is a lower bound on the distance from D to a database for which the ( k,` ) segment is a valid block. To obtain d observe that (i) the distance to a database satisfying a conjunction of conditions is at least the maximum of the distances to each of the conditions individually and (ii) the distance to a database sat-isfying a disjunction of conditions is at least the minimum of the distances. A lower bound on the distance to satisfying the first three conditions of Definition 1 is already given by d 2 k` lower bound on satisfying all four conditions can thus be given by d k` ( D,c ) = max d 2 k` ( D,c ) , max
We can similarly obtain a lower bound d 5 k` ( D,c ) on the distance to a database for which ( k,` ) violates some condition of Defini-tion 1 and thus is not a valid block: d 5 k` ( D,c ) = min d 1 k ( D ) ,d 1 ` ( D ) ,d 3 k` ( D,c ) , min d 6 k` ( D,c,B,S ) gives a lower bound on the distance to a database for which the ( k,` ) segment is the longest valid block among those within some b  X  B and containing some s  X  S . For ( k,` ) to be such a block, (i) it must be a valid block within some b  X  B and containing some s  X  S , and (ii) every longer block within some b  X  B and containing some s  X  S must not be valid. Let the set of blocks longer than ( k,` ) , within some b  X  B , and containing some s  X  S be L k` . A lower bound on the distance to becoming the longest valid block is d d 7 k` ( D,c,B,S ) gives a lower bound on the distance to a database for which the ( k,` ) segment is not the longest valid block among those contained within some b  X  B and containing some s  X  S . For this to be the case, either (i) ( k,` ) must not be a valid block within some b  X  B and containing some s  X  S , or (ii) there must exist a longer valid block within B and intersecting S . Thus, the following provides the desired lower bound: d
The mechanism LocBlock ( ,D,c,B,S ) has range R = { ( i,j ) : 1  X  i  X  j  X  m } . The following score function on R uses the dis-tance lower bounds as the distance score (Equation 1) would use the true distances: q 3 ( B,S ; ( i,j ) ,D ) =  X   X   X   X   X   X   X  The sensitivity of q 3 is, as with a true distance function, at most 1 . LocBlock simply applies the exponential mechanism E q 3 , 1
T HEOREM 3. LocBlock satisfies -differential privacy.
As explained in Section 2, the sensitivity of the p -value is at least 1 /n , while significant values themselves are at most the threshold value, which is less than 1 /m (where n &lt;&lt; m ). A direct appli-cation of the Laplace mechanism would add noise with a standard deviation of at least 1 /n , completely obscuring the values.
Instead, we use the Laplace mechanism to output the counts for each possible allele-population pair for the i th SNP. These counts have low sensitivity, and independence tests are generally robust to small changes in the counts, allowing the p -value to be computed with good accuracy. Let the noise random variables N jk , j,k  X  { 0 , 1 } , be independent and have distribution Lap (2 / ) . 2 We com-pute the privacy-preserving versions of these counts as  X  max( O i ( m +1) jk ( D ) + N jk , 0) . We then compute SNPpval as p (  X  O 00 ( D ) ,  X  O 01 ( D ) ,  X  O 10 ( D ) ,  X  O 11 ( D )) .
Privacy of SNPpval follows directly from that of the Laplace mechanism [6].

T HEOREM 4. SNPpval satisfies -differential privacy.
For similar reasons as in Section 6.4, we add noise to the counts of pairwise values for i and j rather than directly to the correlation measure. The privacy-preserving correlation measure is then com-puted from the noisy counts. Let the random variables N k` { 0 , 1 } , be independent and have distribution Lap (2 / ) . The noisy pairwise counts for SNPs i and j are  X  O k` ( D ) = max( O N k` , 0) . SNPcorr is then computed as c (  X  O 00 ( D ) ,  X  O 01 ( D ) ,  X  O 10 ( D ) ,  X  O 11 ( D )) . SNPcorr uses essentially the same mechanism as SNPpval .

T HEOREM 5. SNPcorr satisfies -differential privacy.
The distribution Lap ( b ) has density function f ( x ) = e
We evaluate the utility of our mechanisms using both theoretical and experimental analysis. For two query types (location and p -values of significant SNPs), we show that our mechanisms give significantly more accurate answers than prior state of the art [8]; for the other queries, this paper gives the first known construction. Finally, we prove that the distance-score mechanism provides good accuracy in general relative to other score functions. Proofs of the theorems and detailed experimental descriptions appear in the full version of the paper [15]. We evaluate NumSig on data from the GWAS on Irritable Bowel Syndrome (IBS) by Duerr et al. [5]. This study involves 1138 pa-tients, 567 of whom have the disease and 571 do not, and sequences a total of 308,332 SNPs. Among these, it finds several SNP associ-ations within a region of the genome that codes for a known gene and publishes the counts for all 42 studied SNPs in this region. We include the counts for these 42 SNPs into our input dataset. We extend these to m total counts by randomly selecting minor-allele frequencies and then counts based on those frequencies. These added counts simulate the SNPs not published in the IBS study because they are likely independent of the disease. The accuracy of privacy-preserving outputs is very dependent on the size of the database; thus we consider different population sizes n . For the sig-nificant SNPs taken from the IBS study, we increase n above 1138 by taking the observed allele frequencies in the case and control populations as probabilities and sampling n times.

We consider the accuracy of NumSig on m = 10 5 total SNPs, which is a typical magnitude for GWAS. We set the NumSig accu-racy threshold to k = 1 , and we use the significance threshold of  X  = . 05 / 10 5 . The G test is used to calculate p -values because it is simple yet has low sensitivity. The correct output in our experiment is NumSig 0 = 2 .

Figure 1 displays as a function of the patient population the prob-ability of the correct output and the upper limit of the output values in the 95th and 99th percentiles. It also shows the effect of chang-ing the privacy parameter by using the values  X  { 0 . 2 , 0 . 6 , 1 } . The figure shows that, for = 1 and at the IBS-study population size of n = 1138 , the probability of NumSig = 2 is greater than .5, and the probability that the output range extends beyond 128 is less than 5%. The accuracy of NumSig quickly improves with larger patient populations: when n = 3000 and = 1 , the probability of an incorrect output is less than 1%. The figure also shows that increasing by some factor provides about the same improvement in accuracy as if instead the population were increased by the same factor.

To understand the dependence of NumSig on n , consider in-creasing n by scaling each O ij by some constant  X  . Then the G test statistic also increases by a factor  X  . This is essentially what hap-pens to the significant SNPs as we increase n in our experiments (although with sampling error). The G test statistics of the other SNPs remain small, assuming they are truly independent. Thus the distances to changing the significance of a SNP increase lin-early with  X  , thus the probability of producing the correct output increases exponentially.
LocSig may publish k SNPs that are very different from the true top k , but the published SNPs are likely to have p -values that are nearly as small as those of the true top k SNPs. The usefulness of the published SNPs increases as their p -values decrease, thus the output of LocSig is likely to be as useful as the true top k .
It is straightforward from the definition of the exponential mech-anism that a given SNP is exponentially less likely to be output by LocSig the further its counts get from significance. To be able to make a statement about the p -values themselves, suppose that sig-nificance is determined via the G test. Let p 1  X  ...  X  p smallest p -values for the SNPs in the input . Let P min the smallest and largest p -values in the output of LocSig , respec-tively. Theorem 6 says that the exponents of the p -values of the released SNPs are exponentially likely to be near those of the true top k SNPs. Observe that the rate at which the probability increases is relative to k and has only a weak dependence on m .

Pr [ln(1 /P min ) &gt; ln(1 /p min )  X  ln(1 /P max ) &gt; ln(1 /p We evaluate LocSig , too, on the data from the IBS GWAS by Duerr et al. [5] extended with extra SNPs. This time, to obtain an even more realistic distribution of p -values, we extend the num-ber of SNP counts to m = 10 5 by taking the extra SNPs from the HapMap [14] data, specifically from a contiguous region that cov-ers the one published by the IBS study. We change the population size by independently sampling the SNP values for both case and control populations using their minor-allele frequencies as proba-bilities.
 The results of evaluating LocSig on this dataset are in Figure 2. We use the G test as our test of independence p . For comparison, we also show the results of the top-k SNP publication mechanism by Fienberg et al. [8]. It applies the Laplace mechanism to the  X  statistic of each SNP, then releases k SNPs with the highest per-turbed values. It relies on the assumption that case population is always restricted to n/ 2 , which makes the privacy guarantee much weaker; we show the performance with and without this assump-tion (denoted  X  X estricted X  and  X  X nrestricted X , respectively). The experiment uses = 1 and k = 2 .

To evaluate the output, we sum the p -value exponents  X  ln( p of the output SNPs, and we consider the difference between this sum and the same sum for the correct output. The figure shows the relative value of this difference, i.e., what fraction of the exponent sum is lost by the mechanism. Figure 2 shows that by n = 3000 LocSig has no error with probability greater than 0.5, and that by Figure 2: Relative error in top k significant SNPs: = 1 , m = 10 5 , k = 2 n = 5000 it has no error with probability greater than 0.99. On the other hand, the restricted Laplace-based mechanism has greater than 40% error with probability at least 0.5 even for populations as large as n = 5000 . The unrestricted Laplace mechanism is completely unusable, as for all population sizes it produces over 95% error with probability at least 0.99. We evaluate LocBlock over the SNP region published in the Duerr et al. GWAS [5]. That study published a correlation heat map of a region with m = 264 , in which three blocks are sufficient to cover over half the region. We use individual SNP sequences from HapMap starting from the beginning of that region and in-cluding m = 250 following SNPs. The HapMap data included n = 1011 patients, which we increase by resampling and decrease by subsampling. We use the correlation coefficient (i.e. c = r and set the privacy parameter = 1 .

To evaluate the  X  X uality X  of an output, we consider both the cor-relations within the released blocks and the number of SNPs cov-ered by these blocks. We compute the largest number of SNPs the output shares with some valid block and subtract the number of SNPs that are not shared, then take the sum of these values over all blocks. More precisely, let B  X  X  ( k,` ) : 1  X  k  X  `  X  m } be the set of valid, possibly overlapping, blocks (Definition 1). Given an output block ( k,` ) , we define its value v as v ( k,` ) = max
An output block that is different from the actual top block can still have a high value if it represents another valid block of similar total length. In addition, an output block with boundaries that differ by only a small amount from a valid block has only slightly lower value. This captures the utility of a set of blocks for finding SNP correlations.

Figure 3 illustrates the distribution of values obtained by sam-pling from the output distribution 1000 times, as a function of the patient population size. LocBlock is used three times with the pri-vacy parameter 1 / 3 , for the overall guarantee of = 1 . The values are shown relative to the maximum possible value v  X  for the given number of blocks k .

In general, outputs are accurate when the number of output blocks is small or the patient population is large. For example, the out-put is optimal over half the time for a typical population size of
Figure 3: Value percentiles of LocBlock : m = 250 , = 1 n = 1000 when we limit the number of blocks to one. With three blocks, the output reaches the optimal value over half the time when the number of patients n is increased to 5000. In addition, at only n = 2500 , with probability 0 . 99 the released blocks capture over half of the optimal value, indicating that they give a reasonable pic-ture of the correlation structure in that region.

The effect of increasing the population (ignoring sampling er-ror) is to increase all distances linearly and therefore to improve the probability of the blocks with the highest values exponentially. Consider increasing all pairwise counts O k` ij by some factor  X  . This increases the distance required to change the MAF of a SNP to any given value  X  times, and, because the value of r 2 is constant in  X  , it increases the distance to any given correlation value  X  times. Thus d 1  X  d 3 increase by a factor  X  . d 4  X  d 7 then also scale with  X  be-cause they are simply maxima and minima of d 1  X  d 3 and constants. Thus the score function q 3 becomes  X q 3 , and the probability of the highest-value outputs increases exponentially in  X  .
The accuracy of the disease-association p -values calculated from the noisy counts  X  O jk depends on the sensitivity of the statistical test with respect to these counts. We consider the p -values calculated according to the G test. Let  X  p be the noisy p -value.

The Laplace distribution of the noise has exponentially decreas-ing tail probabilities, and we combine this fact with bounds on the sensitivity of the G test statistic to give tail bounds for the magni-tude of  X  p . To understand the effect of population size, we consider counts that grow with the population size while keeping constant the count fractions, that is, O ij = nf ij .

Pr ln(  X  p )  X  ln( p ) &gt; (1 + o (1)) 16  X  ln f 00 Theorem 7 shows that the noisy answers are likely to give good estimates of the smallest (and thus most interesting) p -values.
Figure 4 shows an experimental evaluation of SNPpval , directly comparing our mechanism with Fienberg et al. [8]. The latter re-leases both private p -values and  X  2 statistics by directly adding Laplace noise. Because it uses Pearson X  X   X  2 statistic for both, we use it for all mechanisms in the experiments. As before, we give re-sults with and without the assumption that the numbers of case and control patients are both restricted to n/ 2 in all input datasets. The experiments were done over a range of inputs, each with n = 1000 and minor-allele frequency of 0.2, typical for GWAS. The privacy parameter was = 0 . 2 , and for each input we sampled from the output distribution 1000 times. We measure accuracy as the root mean squared error of the logarithm of the output p -values.
The figure shows our mechanism almost always gives more ac-curate results. In particular, for p -values of at least 10 the typical range for GWAS results, our mechanism is an order of magnitude more accurate . Furthermore, adding noise directly to the p -value or the  X  2 statistic without the restricted-row-count as-sumption produces unusable answers. With the prior mechanisms, added noise is often larger than the possible range of the true value. Figure 4: Root mean squared error of noisy p -values: n = 1000 , = 0 . 2 , MAF=0.2
To evaluate SNPcorr , we again use the correlation coefficient c = r 2 and let O ij = nf ij . Also, let  X  r 2 be the noisy correlation coefficient. The exponentially decreasing tail probabilities of the noise X  X  Laplace distribution combined with bounds on the sensitiv-ity of r 2 imply the following bound on the change in r 2 T HEOREM 8. Pr [ |  X  r 2  X  r 2 | &gt; 32  X /n ] &lt; 4 e  X   X / 2 Theorem 8 shows that the output of SNPcorr is exponentially close to the correct value and the width of the tail distribution is inversely proportional to n .
The distance-score mechanism is quite general, and we are able to show that it provides a kind of accuracy guarantee and there-fore could be useful more broadly. The intuition is that, under the requirement that the correct output r  X  always has the high-est output probability, distances measured by d (Equation 1) con-strain how much larger the score of r  X  can be than the score of any other output r . Maximizing the difference between the scores of r  X  and r maximizes their relative probabilities under the expo-nential mechanism. Theorem 9 shows that d approximately pro-vides the maximum difference between the scores of r  X  and r . Let Q = { q : R  X D  X  R | f ( D ) = r  X  q ( r,D )  X  q ( r 0 ,D ) } . Note that d  X  Q .

T HEOREM 9. For all q  X  Q , D  X  X  , and r  X  R ,
Without the requirement that the correct output always has the highest score, a single mechanism cannot yield competitive scores on all inputs. For example, a mechanism that keeps the scores con-stant can assign an arbitrarily high score to any one output. Simi-larly, normalizing by  X  q is necessary because scaling a score func-tion does not affect the output distribution of the exponential mech-anism.
Homer et al. [12], followed by Wang et al. [33], demonstrated the privacy risks of publishing GWAS results. The problems they identified received much attention from medical researchers [4], and NIH immediately removed public access to the data [35].
Sankararaman et al. [26] show how to limit the statistical power of Homer X  X  attack by restricting the amount of data published. Loukides et al. [18] suggest using well-known generalization and suppres-sion techniques [29], but this approach is known to have inherent flaws [17, 19].

Differential privacy [6] is a promising approach to privacy-preserving data publishing. It has been successfully applied to search logs [16], movie-viewing records [21], network traces [20], and social net-works [11]. General-purpose mechanisms for differentially private data release (e.g. [6, 22, 25]) cannot be directly applied to GWAS data, however, because both the set of possible inputs for each pa-tient and the number of outputs are very large, while most mecha-nisms rely on one of these being small in order to provide accurate outputs. We do observe that, similar to our distance-score mecha-nism, smooth sensitivity [23] does provide instance-dependent ac-curacy. However, computing the required smooth bound appears difficult in general, and our attempt to use this mechanism did not yield satisfactory accuracy [15].

Dwork and Lei [7] consider general methods for turning robust statistical estimators into differentially private estimators. Our use of the G test and r 2 correlation coefficient for their low sensitivity echo this work.

Our distance-score mechanism defines scores that are approxi-mately optimal; Ghosh et al. [10] and Brenner and Nissim [3] in-vestigate the problem of finding truly optimal mechanisms.
Applying differential privacy to GWAS while preserving utility requires domain-specific solutions. Fienberg et al. [8] consider how to publish minor-allele frequencies,  X  2 statistics, and p -values; they also adapt the method of Bhaskar et al. [2] to release k most sig-nificant SNPs. Their approach, however, makes several restrictive assumptions, including a fixed population size, considers only the  X  2 test, and, critically, assumes that the analyst knows in advance k , the number of SNPs to publish. Furthermore, as we show in Sec-tion 7, their mechanism often produces highly inaccurate outputs. Vu and Slavkovi  X  c [31] also consider applying differential privacy to medical research data, but focus on determining the population size needed to provide a given power to statistical tests when noise is added using standard mechanisms.
As a consequence of recent research on privacy risks in genome-wide association studies [12, 33], medical researchers now face ob-stacles to sharing their data and results. Differential privacy offers an approach to the problem that provides a rigorous privacy guar-antee without unrealistic assumptions about the adversary X  X  knowl-edge (in contrast to other approaches [18]).

Unfortunately, the massive amount of per-patient data involved in GWAS causes standard differential privacy mechanisms to pro-duce highly inaccurate results. Previously proposed adaptations of differential privacy to GWAS are limited in scope and flexibility. In particular, they require the data analyst to know or guess in advance features of the data, such as the number of genetic locations that are associated with the disease.

In this paper, we develop a toolkit of privacy-preserving queries for GWAS that enable data exploration without any background knowledge or assumptions. Our queries allow the analyst to learn the number, location, and p -values of SNPs that are significantly correlated with the disease, as well as the correlation-block struc-ture of the genome in the areas of most interest. The statistical tests and measures can be determined during data exploration itself rather than fixed beforehand. This helps analysts to quickly iden-tify and focus on the aspects of the genome that are most likely to yield clinically interesting results.

Analytical and empirical analysis shows that our mechanisms achieve much better accuracy than prior state of the art. We also develop a general distance-score technique for designing accurate, differentially private mechanisms on complex output spaces.
The accuracy of our outputs could be increased through compu-tational advances by improving the distance approximations used in several of our queries. In addition, incorporating biological con-straints into the possible inputs from a single patient is likely to result in more accurate mechanisms.

A question outside the scope of this paper is how accurate the outputs need to be in order to be useful to medical researchers. Like other applications of differential privacy, our results include non-trivial amounts of random noise, although inaccuracy can be reduced by increasing the number of patients in the study. Finding the right balance between accuracy, privacy, and study costs must be informed by the needs of medical researchers.
 Acknowledgments. This work was partially supported by the NSF grant CNS-0746888, the MURI program under AFOSR grant FA9550-08-1-0352, and grant R01 LM011028-01 from the National Library of Medicine, NIH. Support also provided by ONR.
 [1] J. Barrett et al. Haploview: Analysis and visualization of LD [2] R. Bhaskar et al. Discovering frequent patterns in sensitive [3] H. Brenner and K. Nissim. Impossibility of differentially pri-[4] G. Church et al. Public access to genome-wide data: Five [5] R. Duerr et al. A genome-wide association study identi-[6] C. Dwork et al. Calibrating noise to sensitivity in private data [7] C. Dwork and J. Lei. Differential privacy and robust statistics. [8] S. Fienberg, A. Slavkovi  X  c, and C. Uhler. Privacy preserving [9] S. Gabriel et al. The structure of haplotype blocks in the hu-[10] A. Ghosh, T. Roughgarden, and M. Sundararajan. Universally [11] M. Hay et al. Accurate estimation of the degree distribution [12] N. Homer et al. Resolving individuals contributing trace [13] D. Hunter et al. A genome-wide association study identi-[14] International HapMap Constortium. A second generation hu-[15] A. Johnson and V. Shmatikov. Privacy-preserving data explo-[16] A. Korolova et al. Releasing search queries and clicks pri-[17] N. Li and T. Li. t-closeness: Privacy beyond k-anonymity and [18] G. Loukides, A. Gkoulalas-Divanis, and B. Malin. [19] A. Machanavajjhala et al. l-diversity: Privacy beyond k-[20] F. McSherry and R. Mahajan. Differentially-private network [21] F. McSherry and I. Mironov. Differentially private recom-[22] F. McSherry and K. Talwar. Mechanism design via differen-[23] K. Nissim, S. Raskhodnikova, and A. Smith. Smooth sensi-[24] D. Reshef et al. Detecting novel associations in large data [25] A. Roth and T. Roughgarden. Interactive privacy via the me-[26] S. Sankararaman et al. Genomic privacy and limits of indi-[27] L. Scott et al. A genome-wide association study of type 2 [28] R. Sladek et al. A genome-wide association study identifies [29] L. Sweeney. Achieving k-anonymity privacy protection using [30] A. Tamhane and D. Dunlop. Statistics and Data Analysis: [31] D. Vu and A. Slavkovi  X  c. Differential privacy for clinical trial [32] N. Wang et al. Distribution of recombination crossovers and [33] R. Wang, Y. Li, et al. Learning your identity and disease from [34] M. Yeager et al. Genome-wide association study of prostate [35] E. Zerhouni and E. Nabel. Protecting aggregate genomic data.
