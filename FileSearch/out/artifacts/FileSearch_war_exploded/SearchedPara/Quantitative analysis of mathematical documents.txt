 S. Uchida 1 , A. Nomura 2 , M. Suzuki 2 Abstract. Mathematical documents are analyzed from several viewpoints for the development of practical OCR for mathematical and other scientific documents. Specif-ically, four viewpoints are quantified using a large-scale database of mathematical documents, contain-ing 690,000 manually ground-truthed characters: (i) the number of character categories, (ii) abnormal characters (e.g., touching characters), (iii) character size variation, and (iv) the complexity of the mathematical expressions. The result of these analyses clarifies the difficulties of recognizing mathematical documents and then suggests several promising directions to overcome them. Keywords: Mathematical document  X  Database  X  Mathematical expressions  X  OCR  X  Touching characters 1 Introduction Optical character recognition (OCR) for mathemat-ical and other scientific documents, hereafter called math-OCR , is a system for converting scanned page im-ages of such documents into a scientific document for-mat, such as XML, LaTeX, Mathematica, or braille [1]. The development of math-OCR is indispensable for both reducing the storage size of math documents and for ex-tending their usability. For example, various search ser-vices (e.g., keyword search, definition search, and the-orem search) across documents can be made possible by math-OCR. Other emerging applications, such as digital libraries [2, 3], will also require assistance from math-OCR.
 differ from those of nonmath documents. Therefore, math-OCR needs to be furnished with special functions. First, since math documents include many math sym-bols, font variations, and character size variations, a math-OCR needs a special recognizer that can cope with math expressions. Note that many inline math expres-sions are composed of a single character, such as  X  x  X  X n the sentence  X  X he variable x denotes ... . X  2 Outline of database 2.1 Data collection The documents contained in the database are 30 English articles on pure mathematics (published 1970  X  2000). A list of the articles is in Appendix 7. The numbers of pages, characters, and math expressions in the database are 466, 690,314, and 20,859, respectively. This database is larger than other databases used in past research on math-OCR (e.g., about 15,000 characters in [6], about 10,000 characters in [7], and 350 math expressions in [8]). Note that matrices, tables, and figures are excluded from the database.
 tomatically by the same commercial scanner (RICOH Imagio Neo 450). The quality of the resulting page im-ages varies with the quality of paper, etc. Several page images are noisy and include a lot of abnormal charac-ters, such as touching characters and broken characters. 2.2 Ground truth The ground truth for each character was attached man-ually by seven students belonging to a university math department. The ground truth of each character is com-posed of the following attributes: relation to the preceding character and was attached for describing the structure of a math expression (as a tree). There are six kinds of links: horizontal, right superscript, right subscript, left superscript, left subscript, upper, and lower. A math expression that includes one or more links other than a horizontal one has a two-dimensional (2D) structure. Figure 1 shows a math expression whose structure is represented by ten links including four non-horizontal links. Thus, this math expression has a 2D structure.
 scribes the depth of sub-/superscripts. For example, in the math expression in Fig. 1,  X  X , X   X -, X  and  X  X  X  are first-level subscripts, and  X 2 X  is a second-level subscript. Note that baselines are assumed on both the numerator and the denominator of a fraction. Thus, in the math expres-sion of Fig. 2,  X  and r are baseline characters,  X  D  X  X sa first-level subscript, and  X  i  X  is a third-level subscript. 3 Categories and their frequencies 3.1 Number of categories The contents of the database are summarized in Table 1, where it is shown that text, math, and whole regions in the database are composed of 211, 326, and 383 cate-gories, respectively. From this it is suggested that non-math documents are composed of about 200 (  X  211) cat-egories, that is, math documents are composed of about twice as many categories as nonmath documents. Thus, not only accurate but also efficient character recognition procedures are required in math-OCR. 3.2 Frequencies of type and category The importance of italic characters is quantified by Ta-ble 1, i.e., the frequency of italic characters is very high not only in the text region (11.96%) but also in the math 4 Abnormal characters 4.1 Distribution of abnormal characters In this section, abnormal characters are analyzed from several viewpoints. As shown in Fig. 5, there are five kinds of abnormal characters: touching, self-touching, broken, touching and broken, and overlaid characters. Overlaid are distinguished from touching characters be-cause they are caused by typographical errors. (1.69% of all characters) abnormal characters: 8,189 (1.19%) touching, 434 (0.06%) self-touching, 2,994 bro-ken (0.43%), 23 touching and broken ( &lt; 0.01%), and 2 overlaid characters ( &lt; 0.01%). Abnormal characters are found more frequently in the math region (2.21%) than in the text region (1.53%). In the math region, self-(a) (b) (c) (d) (e) detection and normalization procedures with respect to abnormal characters.
 touching and broken characters, respectively, in the math region. These tables also show the number of documents that include each abnormal character. Several abnormal characters, such as the touching character of parentheses, are common and can be found in many documents. Other abnormal characters are often document specific. The touching characters of  X   X   X  and  X  M , X  the broken char-acters of  X  N , X  and  X   X  are typical document-specific abnormal characters. As noted above, document-specific abnormal characters will be detected and normalized by some document-dependent procedure (like the postpro-cessing discussed in 3.2).
 math region is very challenging, but it is important for two reasons. First, abnormal characters in the math re-gion are hard to recognize without normalization. This is because there is no lexicon for math expressions, and thus abnormal characters cannot be recognized correctly by cooperation of linguistic a priori knowledge. Sec-ond, the performance of structural analysis of math ex-pressions will be degraded by abnormal characters. The structural analysis of a math expression might fail com-pletely due to only one abnormal character because the abnormal character will badly affect the estimation of font sizes and positions. Consequently, detection and normalization of abnormal characters in the math region is indispensable for practical math-OCRs. 4.2 Touching characters in math region In ordinary OCRs, touching characters are not fatal. This is because word lexicons, horizontal segmentation, and their combination (sometimes called segmentation-by-recognition strategy) will help separation and recog-nition. However, in math-OCR, touching characters are often fatal in the math region. As noted 4.1, there is 5.2 Size of sub-/superscripts The analysis of size variation is also important to clar-ify difficulties distinguishing between baseline charac-ters and sub-/superscripts using size information. The most naive approach to distinction is a thresholding op-eration on character size using a fixed threshold value. This approach, however, is not sufficient because the sub-/superscripts of a category in a document are often larger than the baseline characters of the category in another document. In fact, of all 201 categories used both as both baseline characters and first-level sub-/superscripts, 94 (46%) will have trouble being distinquished by this ap-proach.
 distinction of sub-/superscripts is adaptive threshold-ing, where a threshold is determined for each document according to the average character size of the docu-ment. Unfortunately, this approach is also insufficient. Figure 7a,b shows the ratio between the average size (height) of first-level sub-/superscripts and that of base-line characters for each document. To obtain the ratios in Fig. 7a, italic small letters with neither ascender nor used. To obtain the ratios in Fig. 7b, italic capital letters For documents with a ratio that exceeds 1 . 4  X  1 . 5, the sub-/superscripts can be distinguished rather easily by adaptive thresholding. For several documents, however, the ratio is close to 1, i.e., sub-/superscripts and baseline characters have almost the same size. In particular, the ratio of document 7 is 1 . 04 in Fig. 7b. The existence of such documents confirms that character size is not suffi-cient to distinguish sub-/superscripts, and other features such as relative position should be cooperatively utilized. difficulties involved in the development of a practical math-OCR. The main results of the analysis can be sum-marized as follows.  X  The math, text, and whole regions were composed  X  Italic characters were very frequent in not only the  X  The frequency of each category varied drastically; in- X  The math region included more abnormal characters  X  Abnormal characters were often document specific.  X  Larger size variations were observed in the math re- X  About 23% of touching characters in the math region  X  A document whose sub-/superscripts and baseline  X  Sometimes complex math expressions composed of  X  About 70% of the math expressions composed of two  X  Several third-level sub-/superscripts were found, As future work, the results here will be utilized in the development of a practical OCR, such as INFTY [17]. References Inst. Fourier, 20(1), 493 X 498, 1970.  X  ibid. , 49(2), 375 X  404, 1999.  X  Ann. Math., 91, 550 X 569, 1970.  X  Ann. Math. Studies, 66, 157 X 173, 1971.  X  Arkiv f  X  ur Matem-atik, 9(1), 141 X 163 1971.  X  ibid. , 35(1), 185 X 199, 1997.  X 
Bull. Amer. Math. Soc., 77(1), 157 X 159 1971.  X  ibid. , 77(1), 160 X 163 1971.  X  ibid. , 80(6), 1219 X 1222, 1974.  X  ibid. , 35(2), 123 X 143, 1998.  X  Bull. Soc. Math. France, 98, 165 X 192, 1970.  X  ibid. , 126, 245 X 271, 1998.  X  Invent. Math., 9, 121 X 134, 1970.  X  ibid. , 138, 163 X 181, 1999.  X  J. Math. Soc. Japan, 27(2), 281 X 288, 1975.  X  ibid. , 27(2), 289 X 293, 1975.  X  ibid. , 27(2), 497 X 506, 1975.  X  J. Math. Kyoto Univ., 11(1), 181 X 194, 1971.  X  ibid. , 11(1), 373 X  375, 1971.  X  ibid. , 11(2), 377 X 379, 1971.  X  Kyushu J. Math., 53, 17 X 36, 1999.  X  Math. Ann., 225(3), 275 X 292, 1977.  X  ibid. , 315, 175 X 196, 1999.  X  Tohoku Math. J., 25, 317 X 331, 1973.  X  ibid. , 25, 333 X 338, 1973.  X  ibid. , 42, 163 X 193, 1990.
 Appendix B: Detail of categories .1 Categories of  X  X ig symbol X  type The  X  X ig symbol X  type consists of the following 18 pre-defined categories: , , , , ,  X  X  X  , (fraction bar), and (continued fraction). .2 Categories of  X  X xtended Latin X  type The  X  X xtended Latin X  type consists of 364 predefined categories. Among them, of 110 rather common cate-gories are the following 55 and their italic versions: ` A,  X  466 extended Latin characters in the database, 451 come from the 110 categories noted above. The remaining 15 come from the other 254 predefined categories that are composed of 127 very rare categories and their italic ver-sions. The 15 characters are:  X  S (8 characters),  X  C (3), S  X   X  u (25), and  X  o (23). .3 Categories of  X  X perator X  type The  X  X perator X  type consists of 92 predefined categories, which are divided into 69 relational and 23 binary oper-ators. The relational operators are: &lt; ,=, &gt; ,  X  , ,  X  ,  X  , , ,  X  ,  X  , , , , ,  X  , , =,  X  ,  X  ,  X  , ,  X  ,  X  , ,  X  = ,  X  , ,  X  , ,  X  , , , , , , ,  X  ,  X  , , , , , , , , , | =, ,  X  ,  X  , , ,  X  ,  X  ,  X  ,  X  = , , , , , , , ,  X  ,  X  ,  X  ,  X  , and . The binary operators are: , ,  X  , and  X  .
