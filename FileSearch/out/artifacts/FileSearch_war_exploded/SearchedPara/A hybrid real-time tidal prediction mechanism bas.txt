 1. Introduction
Tidal prediction is an important issue in areas of coastal con-struction design, tidal energy ut ilization, ocean natural calamities operation schedule of navigating over shallow waters or through an overhead bridge. Harmonic analysis, where the tide is expressed as most commonly used tidal predict ion method and still the basis for celestial bodies and costal topography, tidal level is also in meteorological factors such as atmospheric pressure, wind, rainfall, ice etc. However, the harmonic analysis is made for average meteor-ological conditions by neglecting the real-time hydro-meteorological effects. Variation in sea level is a complex outcome of many factors may cause the prediction values diverge from the actual ones ( Ghorbani et al., 2010 ). These differences can be very large un-der extreme weather conditions such as storm surges or strong winds. Furthermore, meteorological factors  X  in fl uences on tide are complex and are hard to be accurately represented by strictly founded mathematical model, which presents challenges for accurate tidal prediction.
 ingly popular in areas of prediction attributes to its merits such as nonlinearity, adaptivity, arbitrary approximation capability and par-allel information processing mechanism ( Haykin, 1999 ). As a kind of data-driven technique, neural network can represent complex non-linear and non-periodic relationships based on the learning of data samples, which is superior to the h armonic method and suitable for tidal predictions.
 useful a priori information regarding the underlying data generat-ing mechanism into the modeling process ( Benhammadi et al., 2011; Chen et al., 2011 ). The topology of neural prediction model is of great importance for the predictive ef fi ciency ( G X nayd
Inclusion of more useful information which makes contribution to the system mapping is helpful to improve the model  X  s prediction accuracy. Therefore, a reliable prediction of the sea levels can be performed using more sophisticated models by incorporating relevant information. Various research works have been carried out to make best use of useful information. Rajasekaran et al. (2006) construct functional networks and sequential learning neural networks based on history tidal observations; Pashova and Popova (2011) utilized statistical parameters of tidal level for daily mean sea level prediction. Huang et al. (2003) proposed regional neural network for water level (RNN-WL) prediction method by taking use of tidal level data of stations distributed in regional scale; Lee (2004) employed tidal constituents for gener-ating long-term predictions; Chang and Lin (2006) incorporated the factors related to tide-generating forces in the neural network;
Lee and Jeng (2002) considered the residual fl uctuation in the network  X  s input layer for prediction purposes; Altunkaynak (2012) employed current wind speed and the previous signi fi cant wave height as inputs to give predictions of current signi fi cant wave height; Liang et al. (2008) incorporated wind information in the neural tidal prediction model, such as wind speed, wind direction, and day-averaged wind speed. Herman et al. (2007) utilized the principle components of tide, together with the wind components
Suf fi cient information is more crucial for predictions of abnormal tidal changes under violent meteorological conditions, such as strong winds and sudden changes in atmospheric pressure ( Lee, 2008 ). Tseng et al. (2007) used typhoon  X  s characteristics, local meteorological conditions and typhoon surges at a considered tidal station as inputs for typhoon surges forecast; Lee (2006, 2008) incorporated wind information and atmospheric pressure in the model for storm surge prediction.

All above-mentioned factors related to tide are time-varying and many of them (especially meteorological factors) vary rapidly with time. However, most of the neural networks employed for application are static with fi xed structure and parameters, which cannot represent the fast variation of tide dynamics. Therefore, there is a practical need to establish a variable neural network whose structure and parameters can both be adaptively tuned in real-time to represent the time-varying changes of tide dynamics caused by meteorological factors. Furthermore, the theory of neural network also indicates that excessive learning usually leads to the phenomenon of over-fi tting which will damage the general-ization capability of network. The expansion of network dimen-sion will also cause the  X  curse of dimension  X  and slower the computational speed consequently ( Haykin, 1999 ). Therefore, there should be a mechanism to adjust the dimension of network.
In this paper, a hybrid model is established to for real-time tidal prediction. The harmonic analysis method is employed to give harmonic tidal level predictions; the residual in fl uenced by meteorological factors is predicted by a variable neural network.
The fi nal prediction is the summation of prediction results of the two approaches. The ef fi ciency of hybrid model is veri fi prediction simulations which are conducted based on the actual measurement of tidal stations at the port of Tampa and other three tidal stations in America. 2. Hybrid tidal prediction mechanism 2.1. Harmonic analysis method
The most conventionally used method for tidal level prediction is harmonic analysis. The principal long period cyclicities of tide are related to the astronomical factors like relative positions of the sun, moon, and earth. In harmonic analysis, the astronomical component is expressed as superposition of many sinusoidal constituents with amplitudes and frequencies determined by a for certain time t can be represented by a time-dependent function: y  X  t  X  X  a 0  X  where a 0 is a long-term mean sea level; n is the number of (speed) and phase offset of the i th constituent, respectively. The residual r ( t ) is the unmodelled random fl uctuations representing the effects of meteorological factors, random noises and other unmodelled effects. 2.2. Variable RBF neural network
As the metrological factors (such as atmospheric pressure P , wind force F , wind direction  X  , water temperature T ) vary fast with time, their in fl uences should be represented by variable model whose structure and parameters can be both adjustable. As meteorological and other unmodelled factors  X  effects on tidal level, the residual term r ( t ) in Eq. (1) can be expressed as the functions of such factors: r  X  t
 X  X  f  X  P ; F ;  X  ; T ; r  X  X   X   X  t  X  X  2  X  where f ( ) is the mapping from meteorological factors to the residual, and  X  ( t ) is the noises. Static neural network with structure cannot represent time-varying dynamics ef fi ciently, so there is a practical need of variable network whose structure and parameters are both adjusted in real time.

Construction of variable-structure neural network by sequen-Sequential learning algorithm is a popular method for represent-ing time-varying system dynamics by variable neural network and tunes the network  X  s structure and parameters adaptively. By adjusting the network dimension, it can also avoid the phenom-enon of over-fi tting and under-fi tting, thus guarantee general-ization capability as well as accelerate processing speed. Among various types of network, radial basis function network (RBFN) is the most conventionally used network in sequential learning attributing its merits such as locally response character, simple topology, fast convergence speed and no phenomenon of local minima ( Haykin, 1999 ).

In this study, to represent the time-varying dynamics of tide caused by various meteorological factors, the f ( ) is modeled by a variable neural network constructed by a kind of sequential learning algorithm, which is described as follows.

In the algorithm, the adjustment of network structure includes network growing and network pruning. In the growing process, the newest sample is added to a new hidden neuron directly; in the pruning process, each neuron  X  s contribution is evaluated individually and neurons which consecutively contribute less to the output will be pruned from the network. Once the neurons are determined, the connecting weight between the hidden layer and output layer is adjusted accordingly.

In a sequential learning scheme, the samples are presented sequentially but, if algorithm only learns the latest received single sample at one step, the resulted network would rely too much on the particular sample and may result in instability of network; while if the algorithm processes all the received samples at one time, the resulted network could not re fl ect the current changes in system dynamics, and the computational burden would also be increased. To make a compromise, a sliding data window (SDW) is employed and algorithm learns samples in the window ( Yin et al., 2012 ). The SDW is a fi rst-in-fi rst-out (FIFO) sequence: W where N denotes the width of sliding window, x and y denote the input vector and output vector at the corresponding time ( t , t 1, ... , t N  X  1), respectively. That is, the window is a combination of [ y , ... , y t N  X  1 ] T A R m N , with n and m being the dimensions of input and output, respectively. Therefore, the window is updated in real-time and can be employed to represent current dynamics of time-varying system. In this study, single hidden layer is adopted in RBFN and its j th output can be expressed as: y  X 
 X  where  X  i is the active function of the k th hidden neuron which is selected as Gaussian function in this study; c k is the center of the k th hidden neuron; || || denotes the Euclidean distance operator; is the scale parameter of k th hidden neuron; j is the index of outputs; M is the current number of hidden neurons;  X  i is the connection weight between the k th hidden neuron and the j th output. The total input  X  output mapping of RBFN can be repre-sented in matrix form:
Y  X   X  X  :  X  5  X 
To evaluate the contribution of each hidden neuron to the output separately, the response matrix is orthogonalized using Gram  X  Schmidt method ( Chen et al., 1991 ):  X   X  WA  X  6
 X  where W is the orthogonalized response matrix whose individuals is orthogonal mutually; A is an upper triangle matrix. Then, the contribution of the k th hidden neuron to the output is evaluated according to its corresponding error reduction ratio (err):  X  err k  X 
 X  where w k is the k th vector of the orthogonalized response matrix
W . The value of err is the projection of each hidden neuron in the space spanned by W , which is used to evaluate the contribution of each hidden neurons to the output. The larger value of err implies larger contribution. For multi-in multi-output (MIMO) process ( Chen et al., 1992 ), the values of err are calculated by:  X 
 X  where j denotes the index of outputs.

However, it is noticed that the number of hidden neurons M usually is not the same as the width of sliding window N , thus the matrices of  X  A R N M and W A R N M are not square. Therefore, the sum of err tion of individual hidden neurons by means of err. To apply the index of err in the SDW-based sequential learning scheme, the index of normalized error reduction ratio (nerr) is employed in this study to measure the contribution of each hidden neuron to the output ( Yin et al., 2012 ):  X  nerr k  X  err k P M  X  It is known that used to evaluate the contribution of each hidden neuron directly.
At each step, the nerr of each hidden neuron is calculated and the neurons with small nerr are selected by ranking them in ascending order. The selection is terminated once the summation of nerr reaches the preset accuracy threshold  X  :
X
 X  where p is the number of selected hidden neurons. It is concluded that the summed contribution of the selected p neurons is less than  X  100% to overall output. If certain neurons are selected for l consecutive steps, they will be regarded as obsolete and pruned from the network. This procedure is taken to assure that only the consecutively inactive neurons are removed from network, thus the stability of RBFN can be maintained. At each step, after the hidden neurons are adjusted by adding and pruning, connecting weights  X  can be updated using the pseudo-inverse method:  X   X   X   X  Y  X  X   X  T  X   X  1  X  T Y  X  11  X  it is reasonable to set different scale parameters in basis functions for the related elements. The generalized multi-scale RBFN pro-vides more fl exible representation capability of system dynamics
In this application, variable RBFN is improved by adopting multi-scale RBFs in the network.
 have  X  i  X  exp where  X  i is the response of i th center, and  X  1 , ... , widths for each category of input, respectively.
 are divided into h categories. The implementation of multi-scale
RBFN improves its fi tness of input  X  output mapping hyperplane, thus reduces the dimension of hidden neurons in applications. by learning the data in real-time updated SDW. The resulted network can be consequently implemented for identi fi cation and prediction purposes. In our study, identi fi cation and prediction are accomplished in each step: structure and parameters are tuned upon the learning of SDW in the learning process, and prediction is conducted once the network is determined.
 characteristics needed to be modeled, so the algorithm needs only three parameters, which facilitates its practical applications. 2.3. Network structure of variable RBFN observations where the effects of meteorological factors have been averaged. Meteorological factors  X  diverge from the average condi-tion may consequently cause differences between the predicted and actual sea level. The fl uctuations resulted from meteorological factors are usually small but, fl uctuations may become obvious when they were in fl uenced by extreme weather conditions such as strong winds or severe atmospheric pressure fl uctuations. The water level responds to the changing atmospheric pressure and to raise sea level and high pressure tends to depress it. The effect of wind on tide is considerably variable and depends largely on the topography of the area in question. In general, it can be said that the wind will raise sea level in the direction towards which it is blowing. A strong wind blowing straight onshore will pile up the water and cause high waters to be higher than predicted, while winds blowing off the land will have the reverse effect ( Admiralty
Tide Tables, 2013 ). Ocean tidal change is also associated with water temperature; as water warms up, ocean volume increases and leads to the thermospheric sea level rise.
 spheric pressure, water temperatur e, wind speed and wind direction) contains much useful information concerning meteorological factors and other unmodeled factors, thus implemented in the prediction model realized by variable RBFN.

The history residual time series ( r ( t 1), r ( t 2), ... employed to support the prediction to r ( t ), with p is the time lag.
To decide the optimal value of p , correlation values of time series respect to r and the results are depicted in Fig. 1 .

Itcanbeseenin Fig. 1 that the correlation value decreases with the increase of enlargement of time lag p . It can also be noted that there is a sharp decline in the curve with regard to time lag of 25. lunar day is 24 h and 50 min, which means a whole period of tidal changes is included in the network input layer. The correlation value of meteorological time series (atmospheric pressure P ,windforce F , withtheenlargementofthetimelag.Hencethesamplesof meteorological time series at time of t 1( P ( t 1), F ( t 1), represented by the nonlinear autoregressive with exogenous input (NARX) prediction model ( Pisoni et al., 2009 ). For 1-step-ahead prediction, the identi fi cation model is: r  X  t  X  X  f  X  r  X  t 1  X  ; r  X  t 2  X  ; ... ; r  X  t p  X  ; P  X  t 1  X  ;
T  X  t 1  X  X  X   X   X  t  X  X  13  X 
Therefore, prediction of r ( t  X  1) can be achieved in prediction process by using the samples which is available currently: ^ r  X  t  X  1  X  X  f  X  r  X  t  X  ; r  X  t 1  X  ; ... ; r  X  t p  X  1  X  ; P  X  t
For q -step ahead prediction, the NARX model during identi tion is: r  X  t  X  X  f  X  r  X  t q  X  ; r  X  t q 1  X  ; ... ; r  X  t q p  X  1  X  ;
P  X  t q  X  ; F  X  t q  X  ;  X   X  t q  X  ; T  X  t q  X  X  X   X   X  t  X  X  15  X 
NARX model for q -step ahead prediction becomes: ^ r  X  t  X  q  X  X  f  X  r  X  t  X  ; r  X  t 1  X  ; ... ; r  X  t p  X  1  X  ; P  X  t
As a result, the topology structure of the variable RBF neural network model is I 29 H x O 1 , where I 29 denotes 29 input neurons, O denotes single output neuron of actual tidal level, and H the x hidden neurons, with the value of x being on-line deter-mined by the sequential learning algorithm. 2.4. Hybrid tidal prediction method
The hybrid modeling method in this study is the combination of harmonic analysis and ANN which aims at bringing different advan-model ( Oliveira, 2004 ). The harmonic analysis takes consideration of long-term average historical measurement and cannot represent the complex in fl uence of time-varying meteorological factors. On the contrary, the nonlinearity and adaptivity natures of neural network system dynamics. However, the representing capability of neural network depends on the learning of data, and cannot include any physical representation of object process directly ( vonStoschetal., 2012 ), thus will result in limitation in extrapolation performance.
It has also been discovered that the combination of fi rst principles knowledge and ANNs can better structure the process operation space ( Fiedler and Schuppert, 2008 ), thus generate better calibration properties, better extrapolation capabilities and enhanced statistical con fi dence of the model estimates comparing to pure ANNs or other data-driven techniques ( von Stosch et al., 2011;  X mer Faruk, 2010 ).

Therefore, in this study, a hybrid model is employed for real-time tidal predictions to enhance the prediction performance in respect of robustness and ef fi ciency. The in fl uences of astronom-ical and meteorological factors are represented by harmonic method and variable RBFN, respectively.

The learning process is processed in two steps. In the identi-fi cation process, the harmonic method is fi rstly implemented to represent the astronomical effects to tide, and the tidal level acquired by harmonic analysis is denoted as y H  X  t  X  . Identi residual r  X  t  X  , the differences between actual level y ( t ) and y then identi fi ed by the variable RBFN which is employed to represent the meteorological factors  X  effects to tidal levels. That is, the variable RBFN is tuned to represent the input  X  output mapping in Eq. (15) . The con fi guration of the learning process in the hybrid method is illustrated in Fig. 2 .

In the prediction process, the predictions of the harmonic method and the achieved RBFN, y H  X  t  X  q  X  and ^ r  X  t  X  according to Eqs. (1) and (15) , respectively. The overall output is then achieved by summing the prediction results of the two during prediction process is illustrated in Fig. 3 .

In the sequential processing mode, the prediction is conducted once the identi fi cation is completed and both are conducted at each step consecutively. 3. Tidal level prediction using the hybrid prediction method 3.1. Prediction model
Measurement data of the tidal level at Old Port Tampa is employed to validate the ef fi ciency of the hybrid prediction Harmonic Method
Mesure ment Device method. The Old Port Tampa tidal station is situated on the western end of the Interbay peninsula in southern America.
Geographic position of the tidal gauge is 27 1 51.4 0 N, 82 and its location is depicted in Fig. 4 .
 The experimental measurements belong to hourly value of the
Tampa tidal station over the duration of one year (from 1 July 00:00 GMT, 2012 to 30 June 23:00 GMT, 2013) with time resolu-tion of 1 h, totally 8760 pairs of samples with respect to the tidal level, atmospheric pressure, water temperature, wind force and wind direction, respectively. All the measurement data employed in this study is available from the web site of the American
National Oceanic and Atmospheric Administration (NOAA): http://co-ops.nos.noaa.gov/ .
 which are also presented on the web site of NOAA, are shown in Fig. 5 along with the actual measured ones.
 re fl ect the holistic changing law, which shows that the harmonic method is effective in representing the tidal changes caused by astronomical factors. However, it can also be noted that the predicted tidal levels differs from the measurements most of the time, and there exists a relatively large sustained deviation between the measured and predicted tidal levels with correlation coef fi cient (CC) of 0.8643, as shown in Fig. 6 .
 levels is shown in Fig. 7 . It can be noted in Fig. 7 that sustained deviation exists for certain period of time which is caused by environmental changes. It also can be noted that the range of prediction error may reach 0.7390 m at 1376-th hour (0700 Aug. 27, 2012) and 0.8610 m at 8183-th hour (2200 June 6, 2013), which
Harmonic Method
Mesurement Device may cause danger in practical marine operations based on these prediction results.

The harmonic prediction result  X  s deviation from actual measure-ment is mainly caused by time-varying environmental changes such as the atmospheric pressure and strong wind. The harmonic method variable RBFN can represent time-varying system dynamics. To take both considerations of astronomic al and meteorological factors, the proposed hybrid prediction method is implemented for real-time prediction of tidal level of Old Port Tampa, with the in fl astronomical and meteorological factors are represented by approaches of harmonic method and variable structure RBFN, respectively. The samples of the elements concerned in the predic-tion model are illustrated in Fig. 8 . 3.2. Performance of tidal level prediction
The effectiveness of the proposed hybrid prediction method is validated using the measured tidal level measurement of Old Port Tampa. All the simulations in this study were carried out in
MATLAB 7.4 environment running at 2.80 GHz (CPU) and 3.25 GB memory (RAM).

The identi fi cation and prediction performances of model are evaluated by indices of root mean square error (RMSE), with identi fi cation RMSE (RMSE Iden ) and prediction RMSE (RMSE respectively: RMSE RMSE values of tidal level at time t  X  q , respectively. These two indices are used for validating the model identi fi cation and prediction accuracies (  X mer Faruk, 2010 ).
 The parameters for constructing variable RBFN are selected as: N  X  72,  X   X  0.001, l  X  3. The width for the elements of residual, atmospheric pressure, wind force, wind direction, water tempera-ture are selected as 1.44, 1028.5, 15.4, 109 and 39.1, respectively. For harmonic prediction method, 37 constituents are selected and corresponding parameters (amplitude, phase, speed) for each constituent are also available at http://co-ops.nos.noaa.gov/ .
At each step, the model learns the samples in SDW and adjusts the structure and parameters of variable RBFN. Based on currently available tidal and metrological measurements, tidal prediction is made by combining the prediction s generated by Harmonic method and variable RBFN, respectively. The 1-h-ahead tidal level prediction results are depicted in Fig. 9 together with the actual measurements.
It is shown in Fig. 9 that the predicted results track the tendencies of tidal rise and fall well with RMSE Pre of 0.0262688 m, comparing to 0.1528718 m using conventional harmonic method. The abrupt changes of tidal levels at time of 1376-th and 8183-th hours are also detected and predicted accordingly with small errors, which is shown in Fig. 10 (a) and (b), respectively.

This shows that the hybrid model can incorporate the in fl ences of meteorological factors to tidal changes and possesses better prediction accuracy than custom harmonic method. The prediction error is depicted in Fig. 11 .

It can be noticed in Fig. 11 thattherearenolargesustained deviations between the predicted values and actual ones, and the predicted values locate around the measured ones uniformly, which can also be observed in Fig. 12 . The closeness between the measured tidal levels and the predicted ones can be further veri fi corresponding high CC of 0.9949, as shown in Fig. 12 .
The predictions are made based on the identi fi cation of data in the SDW. The RMSE Iden is 0.0146015 m, which is close to the RMSE Pre of 0.0262688 m.

The RBFN structure is variable with hidden neurons are added or pruned adaptively according their corresponding index nerr. The number of hidden neurons is a variable value ranged from 5 to 32, and the average hidden neurons number (HNN) during simulation is 16.6591. The evolution history of number of HNN is depicted in Fig. 13 . In this study, sequential learning RBFN in this study employs small number of hidden neurons, which also enable its fast processing speed of the hybrid prediction model. The overall consumed time for 8700 steps of processing is 144.260448 s, the average time for each step (including identi tion and prediction process) is 0.016582 s.

Differenttimespanofpredictionin fl uences the magnitude of prediction error. To validate the prediction accuracy for longer time scope, simulations are conducted based on the same measurement data. For 1-h-ahead and 2-h-ahead prediction, the parameters of model are selected as: N  X  72,  X   X  0.001, l  X  3. For 3 and more hours ahead prediction, the parameters are adjusted as N  X  24,  X   X  l  X  3. Same harmonic parameters are adopted as the harmonic prediction method. Simulation results are shown in Table 1 .
It is noticed in Table 1 that the RMSEs of prediction are 0.026269 and 0.037226 for 1-step-ahead and 2-steps-ahead pre-dictions, respectively; values of RMSE remain among ranges of 0.044520 and 0.046571 for 3 and more steps ahead predictions. This shows that the proposed hybrid prediction method can give stable predictions for short-term tidal predictions with satisfactory prediction accuracy. It can also infer from the results that the variable RBFN employs only a small number of hidden neurons for representing the time-varying in fl uences of meteorological factors, and the processing speed is rather fast consequently.

For the comparison of tidal prediction performance using other approach, conventional NARX method using least square algorithm is implemented under the same experimental conditions. The models The simulation results are shown in Table 2 .
 It is notice by comparing prediction results illustrated in
Tables 1 and 2 that, for 1-h-ahead prediction, the prediction accuracy using conventional NARX model is slightly higher than that with proposed modular prediction method. However, with the increase of prediction time span, the proposed method shows higher accuracy network is superior to linear least squares algorithm in approximat-ing nonlinear mapping. The propos ed method also possesses higher processing speed attributing to that it only needs to process the samples in SDW.
 differ in geographic conditions such as shelter and wave re are employed to evaluate the universality of the proposed predic-tion method. The stations are Monterey (36 1 36.3 0 N, 121 Honolulu (21 1 18.4 0 N, 157 1 52.0 0 W) and Chesapeake Bay Bridge Tunnel (36 1 58 0 N, 76 1 6.8 0 W).
 stations is 1 Jan. 00:00 GMT, 2013 to 31 Nov. 23:00 GMT, 2013. Same parameters are employed as above experiment. That is,
N  X  72,  X   X  0.001 and l  X  3 for 1-h-ahead prediction; N  X  24, and l  X  3 for 6-and 24-h-ahead prediction. Simulation results of tidal prediction are shown in Table 3 .

It is shown in Table 3 that the proposed method give stable and accurate tidal predictions for measurement data of three different tidal stations. And the tidal stations of Old Port Tampa, Monterey,
Chesapeake Bay Bridge Tunnel and Honolulu are located on the southern, western, eastern coast of America and the middle of northern Paci fi c, respectively, which shows the generality of the method. It is also noted that same parameters are employed for different tidal stations in this study. Further fi ne tuning of para-meters should improve the performance of the hybrid method. 4. Conclusion
A hybrid prediction model is proposed by taking both advan-tages of harmonic method and variable RBF neural network. The harmonic analysis and variable neural network represent the in fl uences of celestial bodies and meteorological factors, respec-tively. Simulation results of real-time tidal level prediction demon-strate that the proposed method generates accurate predictions with high processing speed, which demonstrate the feasibility and effectiveness of the hybrid tidal prediction method. To adapt to the diversities of the tidal changes and meteorological changes, the self-adaptation of system parameters will be one of our future research efforts.
 Acknowledgements
This work is supported by the National Natural Science Foundation of China (Grant no. 51061130548), the Applied Basic Research Fund of the Chinese Ministry of Transport (Grant no. 2014329225010), and the
Fundamental Research Funds for the Central Universities (Grant no. 3132014028) References
