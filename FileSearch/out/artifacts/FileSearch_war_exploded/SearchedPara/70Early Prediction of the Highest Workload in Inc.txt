 ELENA BARALIS, TANIA CERQUITELLI, SILVIA CHIUSANO, and VINCENZO D X  X LIA , Cardiopulmonary exercise testing is a noninvasive and objective method of evaluating both cardiac and pulmonary functions. Incremental tests are commonly used to progressively increase the mechanical demand that the individual cardiopulmonary system has to match until she/he can no longer maintain the current workload. The car-diopulmonary response to exercise, when skeletal muscles transform chemical energy into mechanical output, has been shown to depend on workload, and the individual performance to be largely dependent on aerobic power (i.e., the ability in supplying oxygen to and in removing carbon dioxide from working muscles).

To analyze individual body response to increasing strain, various physiological signals, mainly describing the respiratory function of the individual, are monitored during the incremental test. The highest workload (denoted as W peak ) achieved in the last stage of the test corresponds to the  X  X est X  cardiopulmonary adaptation for the monitored individual in terms of heart rate and ventilation, and it is an important indicator of aerobic power.

Incremental tests are commonly used in the clinical domain [Sill et al. 2009; Spruit and Wouters 2007] and in sport sciences [Pollock et al. 1998], and both treadmills and cycloergometers are usually exploited for testing. In the clinical domain, incre-mental tests support assessing heart functions in patients with chronic heart failure [Sill et al. 2009] or evaluating pulmonary function in patients with chronic obstructive pulmonary disease [Spruit and Wouters 2007]. In sport sciences, exercise physiologists use incremental tests for endurance sports testing [Pollock et al. 1998]. Both in the clinical domain and in sport sciences, the W peak reached by the individual in the incre-mental test is crucial to managing rehabilitation and training sessions, by planning and adjusting the assigned workload [Mezzani et al. 2009]. For example, in sport sci-ences, according to the American College Sport Medicine, trainers should set training intensities as fractions of the W peak values reached by the athlete in previous tests [Pollock et al. 1998]. In the clinical domain, exercise capacity has been shown to be the best predictor of survival among healthy men [Myers et al. 2002]. Unfortunately, incre-mental cardiopulmonary tests, the gold standard for assessing exercise capacity, are physically very demanding. Long test durations can significantly increase body stress and may cause cardiopulmonary overload on the monitored individuals. Hence, early prediction of the expected W peak value during the test execution would allow for prema-turely interrupting the test, thus lowering body stress. In addition, cardiopulmonary testing is time consuming, and reducing the time needed to perfom one test could allow cardiopulmonary testing to become a routine procedure, as suggested by experts [Franklin and McCullough 2009]. This issue is further discussed in Section 7.
Nomograms and other approaches predicting maximal exercise capacity based on factual data have been proposed since the origins of exercise physiology [Astrand and Ryhming 1954] for overcoming a series of limitations, including the cost of equipment for direct measurement of power output and energy consumption. However, these ap-proaches suffer from several limitations, for example, they do not allow measuring a subject X  X  improvement in performance because they cannot detect changes in individual performance in a time as short as a training program (usually weeks).

This article presents an innovative approach to predicting the W peak value that can be reached during an incremental test. By coupling factual data with the physiological signals monitored during test execution, our approach predicts W peak according to the actual response of the individual during the test. Hence, it allows for detecting changes in individual performance and adaptations to training. In both the clinical and sport domains, this information allows for effectively monitoring individual progression during a rehabilitation/training program. W peak is dynamically predicted during test execution whenever the assigned workload is increased, together with an estimate of its accuracy. When the estimated accuracy of the prediction becomes satisfactory, the test may be stopped, thus avoiding its entire execution. Hence, the proposed approach does not replace testing, but instead (i) provides an additional tool, while testing, to reduce physical effort and (ii) allows for saving test time, thus potentially making cardiopulmonary testing more affordable without missing crucial information. To our knowledge, this work is the first study addressing dynamic early prediction of W peak .
To characterize the performance of the tested individual and predict W peak , we intro-duce a new measure, the CardioPulmonary Efficiency Index (CPE), which summarizes both the cardiac and pulmonary responses of the individual to the incremental test. The information provided by the CPE index during the test is coupled with some anthropo-morphic data of the individual and exploited to train a classifier for the prediction of W peak . We considered two different classification techniques: an instance-based learn-ing approach based on the K-nearest neighbors (k-NN) algorithm [Tan et al. 2005], and artificial neural networks (ANN) [Tan et al. 2005]. The proposed approach has been evaluated on two sets of incremental tests collected at CSA, Sport Training Cen-ter (Italy) 1 , for diverse athletes. These tests use two protocols commoly adopted in endurance sport testing. Experimental results showed that W peak is predicted with a limited error from the first instants of the test.

The article is organized as follows. Section 2 describes the test protocol and the physiological signals monitored during the test, while Section 3 introduces, by means of an applicative example, the motivations driving our approach. Section 4 presents the CPE index, and Section 5 describes the k-NN and ANN classifiers for predicting W peak . Section 6 reports the experiments that evaluate the prediction accuracy whose results are discussed in Section 7. Related works are described in Section 8, and Section 9 presents future developments of the approach. This section describes the test protocol and the physiological signals collected during the test to characterize the test execution.

Test Protocol. In incremental tests, the workload is a step signal defined by two parameters: the increment of the workload at each step ( W step ) and the duration of each step ( t step ) in which the workload is kept constant. These two parameters define the test protocol, denoted W step  X  t step , meaning that every t step minutes, the workload is increased by W step Watt.

The protocol is set before the test starts and is kept constant during the test. The test ends when the individual cannot sustain the current workload. The workload at the test end is the highest workload achieved by the individual in the test, that is, W peak .
Data Collection. Each test is characterized by two kinds of information, factual and dynamic data. Factual data describe the individual performing the test. We considered individual age, body mass index (BMI), and body surface area (BSA). 2 These attributes are normalized by means of the z-score method, which is less sensitive to the skewed data distribution [Tan et al. 2005] characterizing factual data.

Dynamic data include the various physiological signals sampled during the test to analyze the individual body response under increasing strain. The individual is monitored by means of a set of sensors and a spirometer. Besides the cardiovascular parameters (e.g., the heart rate), the majority of signals describes the ventilatory function of the individual. Table I reports the subset of signals used in our framework. Since they differ both in scale and measurement unit, a min-max normalization has been performed. This normalization technique is typically exploited in time series [Kasetty et al. 2008], because it preserves the original data distribution. We show by means of a real application example how the proposed W peak prediction approach may support incremental test monitoring and early interruption. We selected two different individuals (test IDs 130 and 279 3 ) performing the incremental test with protocol 50 W  X  2 min. The factual data of both subjects, reported in Table II, are characterized by identical BMI and BSA and rather different age. Hence, traditional W peak prediction approaches based on factual data (e.g., nomograms) would typically predict a higher W peak for test ID 130, characterized by his lower age.

In Figure 1, the solid line plots the W peak prediction performed by our approach at each workload increment during the test until its end, while the two dashed lines show the estimation of the average prediction error (mean absolute error, MAE). After the initial steps, our approach correctly predicts the W peak value for both individuals. In addition to factual data, our prediction is based on the analysis of the actual individual response elicited during the test (i.e., the dynamic data). Hence, it may unveil more subtle differences between individual responses to exercise that can only be discovered by actually performing the test. Since the prediction error monotonically decreases and the prediction becomes rather stable after the initial steps of the test, it is not necessary to reach the natural end of the test (requiring at least ten min). The tests can be prema-turely stopped at 200 W (after six min), when the estimated MAE decreases below 30 W. The CardioPulmonary Efficiency Index (CPE) is a new measure that dynamically sum-marizes the overall cardiopulmonary response elicited by a given workload during an incremental test. Hence, it can be computed at time t during the test to evaluate the overall response up to time t . It is computed by taking into account the following two components: (i) the exercising individual power output (denoted  X  L ), which is computed from the nominal workload kept constant by the cycloergometer, and (ii) the overall car-diopulmonary response to exercise for the individual (denoted  X  T ), which is evaluated based on the various physiological signals monitored during the test.
 The CPE value is computed from terms (i) and (ii) as where both terms  X  T and  X  L are positive real values.

When cycling, human skeletal muscles always need an amount of metabolic energy higher than the produced mechanical output. Hence, the cardiopulmonary response of the individual (  X  T ) is larger than the forced power output (  X  L ), and the CPE index varies in the range [0 , 1).

The samples of every signal contributing to  X  L and  X  T are collected synchronously at each sampling time t i . Since ventilatory signals are collected breath by breath, the sampling rate is dependent on the respiratory rate. Hence, every cumulative measure computed by using the collected samples is normalized by dividing its value by the number of individual breaths from the beginning of the test. The nominal workload is represented as a discrete signal Load [ t ], where Load [ t i ]is the workload assigned during the test at the sampling time t i . The power output the individual is asked to produce is computed as the energy of signal Load [ t ], by definition of energy of a discrete signal [Moon and Stirling 2000], as where m is the number of samples collected for signal Load [ t ] during the test. The cardiopulmonary response to exercise  X  T is computed as the overall energy of all monitored physiological signals. This value is computed by means of the Singular Value Decomposition (SVD) method [Moon and Stirling 2000], which supports signal filtering to reduce the impact of signal noise and allows for considering the existing correlations among signals. SVD has been effectively used in physiological signal analysis [Hassanpour et al. 2004; Aysin et al. 2005], as well as in other domains (e.g., image [Bao and Ma 2005] and microarray data analysis [Wall et al. 2001]). It is suited to signals characterized by sudden changes [Aysin et al. 2005], typically occurring after a workload increase.

Each physiological signal is represented as a discrete signal v [ t ], v [ t i ] being the sample at time t i . Signal samples are stored in a matrix T  X  R m , n , where each column contains the samples of a different signal. n is the number of signals represented in T , and m is the number of samples for each signal. 4 Matrix T is factorized by means of SVD as where U T U = I m and V T V = I n . Matrices U  X  R m , m and V  X  R n , n represent the orthonormal basis for the column and row spaces of T , respectively. I m and I n are identity matrices of orders m and n . H = diag[ s 1 , s 2 ,..., s n ] includes the n singular values of T ,with s 1  X  s 2  X   X  X  X   X  s n &gt; 0 [Moon and Stirling 2000].

The overall energy of the signals in matrix T can be computed from the singular values of T [Moon and Stirling 2000] as
To reduce the effect of signal noise on  X  T , we computed a low rank approximation of matrix T by means of a truncated SVD [Moon and Stirling 2000]. The smaller singular values of T are disregarded. Hence, signals in T are filtered by projecting them on the most relevant components of matrix T , that is, a subset of the columns in matrix U . In particular, we considered only the first two largest singular values in T ,that is,  X  T = s 2 1 + s 2 2 . The experimental evaluation reported in Section 6.2 showed that the resulting  X  T represents accurately the cardiopulmonary response to the exercise and supports the prediction of W peak with a limited error. During the test, new samples of the monitored signals are periodically added to matrix T, and the CPE value is recomputed on the updated matrix. This sequence of CPE values summarizes in a single time series the diverse signals monitored in the test. We exploited this sequence, denoted as CPE [ t ], to characterize the test execution.
Sequence CPE [ t ] shows a nondecreasing trend during the test. Both terms  X  L and  X 
T are, by their definition, cumulative measures being computed by considering the signal contributions collected from the beginning of the test up to the current time. The individual power output  X  L is characterized by a sequence of sudden increases in correspondence to the workload increments. The cardiopulmonary response to exercise  X  T is characterized by a steady growth.

To analyze the individual response to the test, we computed the variation of the CPE value between consecutive sampling instants, given by CPE [ t ] shows a sequence of peaks taking place when the workload is increased. We have experimentally observed that this sequence of peaks is representative of the individual response to the test. Hence, this sequence, denoted as CPE peaks [ t ], is used in this work as a fingerprint of the individual performance. As a representative example, Figure 2 plots the workload and the CPE [ t ], CPE [ t ], and CPE peaks [ t ] sequences for a test with protocol 50 W  X  2minandW peak 450 W.

In the CPE peaks [ t ] sequence, peaks are higher in the very first steps of the test. Then, their value rapidly decreases. The sequence length is equal to the test duration and the sequence converges to a value, which is (potentially) different among tests. The trend of the CPE peaks [ t ] sequence can be explained by means of the concept of ventilatory reserve, that is, the difference between the maximal voluntary ventilation and the peak minute ventilation achieved in the test. The ventilatory reserve is high in the early instants and decreases until the conclusion of the test. Between two contiguous peaks, the CPE [ t ] sequence is characterized by a steady decrease. This trend can be interpreted as the progressive body adaptation to the current workload and the convergence to a steady state. The highest workload (W peak ) reachable in an ongoing test is periodically predicted during the test each time the assigned workload is increased. The prediction of the W peak value is based on the following information: (a) characteristics of the individual doing the test corresponding to the factual data for the individual, and (b) cardiopulmonary response of the individual to the test given by the sequence of peak values CPE peaks [ t ] until prediction time, which summarizes the dynamic data of the test.

Given the predicted value of W peak , a further step which allows augmenting the avail-able information on the individual performing the incremental test is the evaluation of her/his cardiopulmonary reserve. In particular, the information on W peak may be completed by computing the potential further workload, which we denote as W potential . At a given time t , W potential may be computed from W peak as where W peak [t] corresponds to the value of W peak predicted at time t and W step [ t ]tothe workload reached at time t .

In this article, we exploited two classification techniques in order to predict W peak : (i) a classifier based on artificial neural networks (ANN) [Tan et al. 2005], and (ii) an instance-based learning approach based on the K-nearest neighbors (k-NN) classifi-cation algorithm [Tan et al. 2005]. The prediction of the W peak value based on the two classification techniques is described in the following sections, while Section 6.4 discusses the advantages and disadvantages of both approaches. Artificial neural networks (ANN) simulate biological neural systems. An ANN is com-posed by a collection of nodes (artificial neurons) and directed links connecting them. For W peak prediction, we build a classifier based on a multilayer feed-forward neural network trained with backpropagation. The network consists of an input layer, n hid-den layers, and an output layer. Each layer is made up of nodes. Each node in a layer takes as input a weighted sum of the outputs of all the nodes in the previous layer. It applies a nonlinear activation function to the weighted input. Currently, the sigmoid function has been used as an activation function.

The prediction of W peak for a new (ongoing) test Q takes place at each time t in which the workload is increased. It is performed by an ANN classifier trained with a set of previous incremental tests (both factual and dynamic data), run with the same protocol of test Q , and characterized by W peak values at least equal to the workload of test Q at time t .
 The nodes in the input layer correspond to the factual data of the individual and the CPE peaks [ t ] sequence for the test. The nodes in the output layer represent the discrete (i.e., categorical) W peak values that can be reached in the test. The network is trained with backpropagation and learns by iteratively processing the set of training tests. For each training test, the network predicts the W peak value whenever the workload is increased and compares the predicted and the actual W peak . Then, weights in the network nodes are modified to minimize the mean squared prediction error. These modifications are made in the  X  X ackwards X  direction, that is, from the output layer through each hidden layer down to the first hidden layer. k-NN classification algorithms predict the expected value for a new data object by using a set of examples for which the target value is known, without explicitly building a classification model from them [Tan et al. 2005]. These algorithms exploit the whole training set for prediction by searching for the k training examples that are closest to the new data object.

To predict the W peak value for a new test Q , each time the workload is increased, the k-NN classifier analyzes a collection of previous tests and selects the k tests most similar to Q . Similarity evaluation considers (a) similar individual characteristics and (b) cardiopulmonary responses close to that observed in test Q . The classifier predicts the W peak value for test Q based on the W peak values in the k selected tests. More specifically, the prediction process entails the following steps.

Creation of the Reference Knowledge Base for Test Q. The reference knowledge base is a set of previous tests run with the same protocol used for test Q and characterized by W peak values at least equal to test Q workload at prediction time. Tests shorter than the current length of test Q are disregarded because they are useless for the prediction.
Selection of the k-Nearest Tests to Test Q. The similarity between test Q and each test in the knowledge base is evaluated and the k tests most similar to Q are selected. Similarity is computed by considering both the characteristics of the individuals per-forming tests (i.e., the factual data) and their response to exercise (i.e., the dynamic data). The approach for similarity evaluation is described in Section 5.2.1.
Prediction of W peak for Test Q. The W peak value for test Q ( W peak , Q ) is computed as the average W peak on the selected k-nearest tests as Since Equation (7) provides a real value, W peak , Q is approximated to the closest workload given by the protocol. This value is the highest workload expected to be achieved by the individual in the test. For example, if the three-nearest tests are characterized by W peak equal to 300 W, 350 W, and 350 W, the average value is 333.3 W. If the protocol is 50 W  X  2min,then W peak , Q is approximated to 350 W. The real value of W peak , Q provides an additional information that may support in estimating the distance of the individual from the closest workload. 5.2.1. Similarity Evaluation between Two Tests. The similarity between a new test Q and a test  X  in the knowledge base is measured by considering the similarity of their factual and dynamic data.

Similarity between Factual Data. It evaluates the similarity between individuals performing tests Q and  X  . It is computed as the Euclidean distance [Tan et al. 2005] between the factual data describing them.
Similarity between Dynamic Data. It represents the similarity between the body responses Q and  X  to the test strain. Dynamic data, that is, the physiological signals, are sampled during the test and summarized in the CPE peaks [ t ] sequence. We evaluated the similarity between the dynamic data of tests Q and  X  as the similarity between their CPE peaks [ t ] sequences.

The CPE peaks [ t ] sequence may have a different length in the two tests because tests in the knowledge base have durations longer than or equal to the current duration of test Q . For test  X  ,the CPE peaks , X  [ t ] sequence is computed with the samples gathered over the entire test. For test Q , still running, the CPE peaks , Q [ t ] sequence is given by the samples collected up to the current prediction time.

The similarity between sequences CPE peaks , X  [ t ]and CPE peaks , Q [ t ] is evaluated using the Dynamic Time Warping (DTW) technique [Berndt and Clifford 1994], a nonlinear time-alignment method for sequence comparison. DTW has been shown to be effective for univariate time series classification in different domains, including physiological signal analysis [Ratanamahatana and Keogh 2004]. DTW supports the comparison of sequences with different lengths by looking for their best alignment. The warping band is the maximum tolerated difference between sequences. Thus, this technique allows us to compare individual body responses that are similar but locally out of phase.
The two sequences are compared by means of DTW within a time window having approximately the duration of test Q .Whentest Q currently takes n minutes, the first n  X  warping band minutes of sequence CPE the two sequences show a similar trend within the time window, they might show an analogous trend also in the next steps. Thus, test Q may have the same duration as test  X  ,aswellasitssameW peak . The DTW algorithm finds the set of correspondences with the least total distance between the matched points between peaks in sequence CPE peaks , Q [ t ] and in subsequence CPE peaks , X  [ t ] within the time window. This distance measures the similarity between the two sequences, denoted as d dynamic ( Q , X  ). Between two matched points, as is usually done in the DTW technique [Berndt and Clifford 1994], the Euclidean distance is computed.

Similarity between Two Tests. The similarity between tests Q and  X  is computed by considering the similarity between both their factual ( d factual ( Q , X  )) and dynamic ( d where d ( Q , X  )  X  [0 , 1], since both d factual and d dynamic have been normalized in [0 , 1], and w  X  [0 , 1]. Lower values of d ( Q , X  ) denote a higher similarity between the two tests, and higher values of d ( Q , X  ) a lower similarity.

When increasing w , the k-nearest tests are mainly selected based on the charac-teristics of the individuals performing the tests. As a consequence, tests with body responses close to test Q , but done by individuals dissimilar from the individual of test Q , may be disregarded. On the other hand, when decreasing w , the test similarity is mainly evaluated by comparing the individual body responses to exercise. Increasing the relevance of this comparison could be misleading in the first steps of the test when sequence CPE peaks , Q [ t ] still contains few elements. An experimental evaluation [Baralis et al. 2011b] showed that the predicted W peak value well approximates the actual one when the two terms in Equation (9) have the same weight ( w = 0 . 5). The experiments performed to evaluate our approach address the following issues: (i) prediction error, (ii) impact of test duration on the prediction error, and (iii) perfor-mance comparison with two naive classifiers. The experimental results are reported in this section, while a further discussion is reported in Section 7.
 To perform the experiments, we collected two sets of incremental tests at CSA Sport Training Center (Italy), by using two common protocols in endurance sport testing. The datasets are described in Section 6.1 and are available upon request to the authors. The experiments have been run on a 2 GHz Intel Centrino Dual-Core PC with 1 GB of RAM and running Linux kernel 2.6.27. The proposed approach has been implemented in C and Python programming languages.

The framework configuration depends on different parameters, set as follows for the reported experiments. (a) The first two largest singular values in matrix T are considered to compute  X  T . (b) The ANN classifier exploits the neural net operator available in the RapidMiner tool [RapidMiner 2011]. To configure this operator, we set training cycles to 500, learning rate to 0.3, momentum to 0.2, and hidden layer to 1. (c) For the k-NN classifier, the following parameters have been set. (i) To compare two CPE peaks [ t ] sequences using DTW, the warping band is set to two min (i.e., one step for both test protocols). (ii) In evaluating test similarity, the contributions of factual and dynamic distance have the same weight ( w = 0 . 5). (iii) The five-nearest tests are selected for W peak prediction ( k = 5). The effect of varying the selected parameter values is discussed in Baralis et al. [2011b] and, specifically for the ANN parameters, in Baralis et al. [2011a]. To gather representative examples, the tests have been done with two protocols com-monly used in endurance sport testing to elicit the highest workload in both elite and intermediate athletes. The protocols are 50 W  X  2minand25 W  X  2min,andthe tests performed with these protocols have been collected in two datasets named D 50  X  2 and D 25  X  2 , respectively. Table III reports the main characteristics of both datasets, and Figure 3 shows the distribution of their W peak values. 5 The datasets include male athletes, both amateur and elite.

Protocol 50 W  X  2 min is more stressful for the athlete body because of the higher increment of workload applied at each step. For this reason, athletes in D 50  X  2 are typically younger and more trained than in D 25  X  2 , and they usually reach higher W peak values. Protocol D 25  X  2 is applicable to rather diverse athletes due to the lower increment of the applied workload. Athletes in D 25  X  2 are more heterogeneous with respect to age, BMI, and BSA values (especially when considering the joint distribution of these values). The prediction error measures the ability to correctly predict the W peak value for a new test. The prediction error is the difference between the predicted and the actual W peak value for the test. The absolute prediction error is the absolute value of this difference. During the test, W peak is periodically predicted each time an increment of workload occurs, and the corresponding error is evaluated.

The leave-one-out cross-validation method [Tan et al. 2005] is used for error eval-uation. At each workload increment, that is, at each prediction time t p , the subset of tests still running is selected from the dataset. In turn, a different test is picked out of this subset, while the remaining tests are used as the knowledge base to predict its final W peak . To perform the prediction, the chosen test is described by its CPE peaks [ t ] sequence until time t p , and the other tests by their CPE peaks [ t ] sequence up to the test end. The mean absolute error (MAE) [Tan et al. 2005] at time t p is the average of the absolute prediction errors computed for all tests in the subset.

In all charts, the origin of the time axis (time = 0 min) corresponds to the first step of the test, in which workload 50 W is assigned in dataset D 50  X  2 and 25 W in dataset D 25  X  2 . In the corresponding datasets, the average test lengths (average W peak values) are 13.32 min (333 W) and 20.96 min (262 W), respectively. The experimental results for the ANN and k-NN classifiers are denoted as ANN-based and k-NN-based , respectively.

Figures 4(a) and 5(a) report the mean absolute error (MAE) by varying the prediction time. In dataset D 50  X  2 (Figure 4(a)), the MAE value is below 40 W, except for the first step, in which it is sligthly above 40 W for the k-NN classifier. The ANN classifier always provides lower values of prediction error. In dataset D 25  X  2 (Figure 5(a)), the MAE value is always below 40 W for the k-NN classifier. For the ANN-classifier, it is below 50 W at the first step, almost 30 W after six min, and then it rapidly decreases after ten min. These errors correspond to over(under)estimating the test duration of less than one step (two min) when the protocol is 50 W  X  2 min and less than 1.6 steps (3.2 min) when the protocol is 25 W  X  2 min. For dataset D 50  X  2 , we observe that the prediction error of both classifiers is always lower than the actual increment of workload at each step.
In both datasets, the MAE value decreases when postponing the prediction time and progressively tends to zero. The error is higher in the early steps, when the running test is described by a short CPE peaks [ t ] sequence and the knowledge base used for prediction contains the majority of the dataset. Because of these two conditions, the prediction of W peak is initially affected by a larger error. Later, the prediction instead becomes more accurate because the running test is more precisely represented by a longer CPE peaks [ t ] sequence.

The MAE curves are more irregular and not strictly decreasing in dataset D 25  X  2 (Figure 5(a)), especially in the first steps. This trend is due to the lower increment of workload applied in protocol 25 W  X  2 min, which has less capability of differentiating the athlete body responses to exercise, especially in the first steps of the test. Conse-quently, tests reaching different W peak values may be initially characterized by similar CPE peaks [ t ] sequences. Furthermore, athletes in D 25  X  2 are more heterogeneous, being the protocol applicable to rather diverse athletes. To analyze the effect of the test length on the prediction error, we considered separately tests reaching the same W peak . Figures 4(b) X 4(f) and 5(b) X 5(f) plot the corresponding prediction errors for datasets D 50  X  2 and D 25  X  2 , respectively.

In both datasets and for both classifiers, longer tests are, in general, affected by a higher error in the very first instants. The knowledge base used for prediction ini-tially contains the entire dataset, while a limited subset of tests reaches high W peak values. Few long tests are usually available, because they are only sustainable by well-trained athletes. In addition, in the first steps, the running test is described by a short CPE peaks [ t ] sequence, while the final sequence is significantly longer. The pre-diction error is usually reduced after few steps, as soon as the increments of workload sufficiently characterize the CPE peaks [ t ] sequence describing the running test, thus significantly improving the prediction performance.
 For dataset D 50  X  2 (see Figures 4(b) X 4(f)), the experiments are only reported for W peak values characterizing at least ten tests, because for a smaller number of tests, the prediction error on a single test may significantly affect the average error. In general, the ANN classifier achieves a more accurate prediction than the K-NN classifier. For both classifiers, the MAE value is always lower than 50 W, except for tests with W peak 450 W. For these longer tests, the MAE value at the first step is close to 80 W for the k-NN classifier and to 60 W for the ANN classifier. The prediction error falls below 50 W at the next steps. The initial error is caused by the small fraction of tests achieving W peak 450 W (only 7.36%, while for the other W peak values, the test percentage is between 16.01% and 29.87%).

For dataset D 25  X  2 (see Figures 5(b) X 5(f)), to analyze the error on longer tests, only results for tests with W peak  X  275 W are reported. Results for W peak 400 W are omitted, because only a single test achieves this value. The MAE curves are more irregular for the ANN classifier and not strictly decreasing. The ANN classifier is more accurate on tests with W peak 300 W, while the k-NN is more accurate on tests with W peak 375 W. For tests with W peak 300 W, 325 W, and 350 W, the two classifiers achieve similar performance. As discussed in Section 6.2, protocol 25 W  X  2 min has less capability of differentiating the athlete body response to exercise, and athletes in this dataset are more heterogenous. In addition, a lower number of tests is available for each W peak value. Under these conditions, building an accurate  X  X lobal X  classification model, which summarizes the information available in the training set and provides the correct classification of new tests, is more difficult. The k-NN classifier, instead, extracts from the entire training set a  X  X ocal X  subset of instances which are exploited for prediction. Hence, in these cases, its prediction may be both more accurate and more stable. As shown in the previous sections, both the ANN and k-NN classifiers provide an effective W peak prediction. Since the two approaches are characterized by different features, each one may be more appropriate in a different working condition. In the following, we compare the features of the two approaches in the context of the maximum workload prediction.

Classification Accuracy. ANN classification algorithms are very effective in a wide range of applications and typically show high tolerance to noisy data. When the training set contains a sufficient number of tests, they provide a very accurate W peak predition, in general more accurate than the k-NN approach. When a low number of training tests is available (e.g., lower than 20 tests), building an accurate global classification model is more difficult. The k-NN classifier, instead, extracts from the training set a small subset of instances close to the test instance, which are exploited to provide a more accurate and stable local prediction. For example, in Figure 5(f), the ANN classifier shows lower accuracy and a more irregular MAE curve because only 14 tests were available for training.

Interpretability. Both in the clinical and sport domains, doctors and trainers may be interested in analyzing the reasons motivating a given prediction. While neural network models are intrinsically characterized by very poor interpretability, the k-NN classifier may provide some insight by pointing at the subset of k individuals whose factual data and cardiopulmonary response to the exercise are more similar to the individual performing the test.

Model Evolution. When new training objects are available, the ANN model cannot be incrementally updated and should be completely rebuilt. Since the k-NN algorithm analyzes the whole training set to perform each prediction, incremental update by adding new examples to the training set is straightforward.

Training and Classification Time. Neural networks require a long training time (i.e., several hours) to build the classification model. Furthermore, devising the appropriate parameter setting may be complex and time consuming [Baralis et al. 2011a]. Once the model is defined, classification is very efficient (i.e., few seconds). k-NN does not build a classification model at training time. Hence, classification typically requires a longer time (roughly 15 X 20 seconds), because the distance between each training instance and the test instance has to be computed at runtime. k-NN classification time grows with the size of the training set.
 To our knowledge, an approach for the early prediction of the W peak value in incre-mental tests has not been proposed yet. Thus, we compared our approach against two naive classifiers. Dataset D 50  X  2 is used as a reference example for comparison, being the dataset including more tests. The leave-one-out cross-validation method has been exploited for prediction error evaluation.

The naive ANN classifier is a multilayer feed-forward neural network trained with backpropagation that receives as input data (i) the factual data describing the athlete and (ii) all the physiological signals sampled during the test (instead of the CPE peaks [ t ] sequence summarizing them). The experimental results in Figure 6(a) show that the ANN naive classifier is less accurate than the ANN classifier based on the CPE peaks [ t ] sequence. Hence, the CPE peaks [ t ] sequence provides an effective summarization of ath-lete performance, which can be profitably used to predict the W peak value. The second naive classifier that we exploited works as follows. Consider a new test Q where the workload currently assigned in the test is W Q . The naive classifier selects all tests with W peak  X  W Q from the dataset with the same protocol as test Q . Then it computes the average W peak on the selected tests and predicts this value as the W peak for test Q . Experimental results in Figure 6(b) show that the k-NN classifier always performs better than the naive approach by providing lower MAE values. Thus, the selection of the k-nearest tests, based on the analysis of factual and dynamic data describing the test, properly support the prediction of the W peak value. The experimental evaluation has been run on two protocols commonly adopted in endurance sport testing. For both protocols, tests with different lengths can all be prematurely stopped even in their early steps, with a limited prediction error on the final W peak value. For example, a 200 W workload is usually tolerated by endurance athletes with average performance, while the athlete body stress may significantly increase for higher workloads. When the workload is 200 W (i.e., after 6 min for protocol 50 W  X  2 min and after 14 min for protocol 25 W  X  2 min), the mean absolute error (MAE) on the predicted W peak value is, at the worst case, below 40 W for both protocols 50 W  X  2minand25W  X  2 min. In dataset D 50  X  2 , this error does not affect the evaluation of the athlete performance because it is within the volitional exhaustion range, that is, the increment of workload assigned when the athlete decides to interrupt the test, and corresponding to 50 W. Also, the prediction error achieved in dataset D 25  X  2 is acceptable because of the characteristics of the protocol. Protocol 25, W 2 min requires a more gradual adaptation of the athlete body to the physical strain due to the lower increment of the applied workload. As a consequence, a prediction error below 40 W does not significantly affect the evaluation of the overall athlete response to the test. For a discussion about the impact of the adopted protocol on the subjects evaluation, see Revill et al. [2002].

In dataset D 50  X  2 , tests representing the average performance (W peak 333 W) end between 10 min (W peak 300 W) and 12 min (W peak 350 W). By interrupting these tests when the workload is 200 W (i.e., after six min), the test length is shortened by 40 X 50% with a significant reduction of the athlete body stress. For longer tests, for example, with W peak 450 W, the reduction of the test length is around 62%. In dataset D 25  X  2 ,the average W peak is 262 W, corresponding to a test duration between 18 min (W peak 250 W) and 20 min (W peak 275 W). By ending these tests when the workload is 200 W (i.e., after ten min), the test is shortened by 22 X 30%. The reduction for longer tests, for example, with W peak 375 W, is about 50%. In both datasets, the prediction error progressively decreases for workloads higher than 200 W. Trainers can thus decide when to stop the test based on the trade-off between test duration and closer approximation of the final workload. Incremental tests for measuring the maximal workload (exercise capacity) provide fundamental information for assessing an individual X  X  fitness, predict life expectancy, and better prescribe workout intensities to stimulate beneficial adaptations. Hence, the importance of this procedure has been recognized by the sport and medical communities, and cardiopulmonary tests are the gold standards to test both athletes and patients [Pollock et al. 1998]. Exercise capacity has been shown to be the best predictor of survival among healthy men [Myers et al. 2002]. Unfortunately, incremen-tal cardiopulmonary tests are not suitable for all, and early prediction could be very useful to avoid overstressing the subjects being tested. In addition, cardiopulmonary testing is time consuming, and reducing the time needed to perfom one test could make cardiopulmonary testing more affordable as a routine procedure [Franklin and McCullough 2009].

Ways of predicting maximal exercise capacity have been proposed since the origins of exercise physiology [Astrand and Ryhming 1954] for indirectly assessing the highest workload and the maximal aerobic capacity achieved in the test, thus avoiding the need for the equipment required to execute the test. Nomograms and short supramaximal protocols based on the linear relationship between heart rate, workload, and oxygen consumption have been proposed [Arts et al. 1993], as well as techniques for estimat-ing from other measures, and thus without a direct measurement [Luttikohlt et al. 2006], the peak workload elicited by the individual. A series of predicting regression equations based on factual data, such as age, gender, life styles, and habits (investi-gated through specifically designed questionnaires), has been proposed more recently to predict cardiovascular events in the general population according to exercise capac-ity [Myers et al. 1994; Nogueira and Pompeu 2006]. In Kim et al. [2007] presented a comparison between nomograms together with a discussion of their use as clinical tools. An evaluation of their accuracy is presented in Patton et al. [1982].
A major factor limiting the application of nomograms and other ways of predicting exercise capacity based on factual data is that they are not applicable for measuring a subject X  X  improvement in performance. In our approach, instead, an effectively trained subject will show adaptations to the early stages of testing, and W peak will be pre-dicted accordingly. Finally, factual parameters-based indices aim at providing different information (e.g., cardiovascular risk of events stratification) and cannot detect changes in performance in a time as short as a training program (usually weeks), hence neces-sitating the need for a more dynamic tool to avoid missing fundamental information about adaptations to training, be more accurate in prescribing exercise intensity, and monitor progression over the course of a training program. As stated in the recent American College Sport Medicine,  X  X he exercise prescription is best adjusted according to individual responses because of the individual variability X  [Garber et al. 2011].
To our knowledge, early prediction of the highest workload reached during incremen-tal tests has not been investigated. Differently from previous aproaches, our technique does not replace testing but instead provides an additional tool to reduce the physical ef-fort of the individual and reduce the duration of an ongoing test. Thus, our approach can make cardiopulmonary testing more affordable while preserving the relevant informa-tion that its execution provides. The idea of exploiting the cardiopulmonary efficiency index (CPE) to summarize both the cardiac and pulmonary response of the individual to exercise and to predict the W peak value reached by the individual in the incremental test was first introduced in Baralis et al. [2010]. This article significantly improves over the previous approach by (i) presenting a new approach for W peak prediction based on artificial neural networks (ANN) and (ii) analyzing a new set of incremental tests run by using a different test protocol (50 W  X  2 min).

In this article, the physiological signals monitored during the test are analyzed by means of data mining classification techniques based on an instance-based learning approach and an artificial neural network [Tan et al. 2005]. The k-NN-based classi-fier uses previously labeled data for W peak prediction without building a classification model from them. The ANN-based classifier, instead, exploits a multilayer feed-forward neural network trained with backpropagation. Given the high variability of individual characteristics and body responses, traditional prediction techniques (e.g., the ARIMA model) [Chatfield 2004] are not suitable for our analysis.

Data mining techniques have been widely used in the healthcare domain [Green et al. 2006; Chuang 2011; Lin et al. 2008] to analyze physiological signals and to support clinicians during the diagnosis. Time series classification techniques have been devised to deal with specific physiological signals and to predict the next signal value based on its previous values (e.g., EEG and ECG beat classification [Tomioka et al. 2007; Yu and Chou 2008]). Differently from these works, our approach does not analyze the monitored signals to estimate their next trend but instead to predict the maximum value of a different signal, that is, the workload. Several techniques have been proposed for the general task of multivariate time series classification [Yang and Shahabi 2004]. In incremental tests, the body response to the increments of workload is peculiar for each individual, and general techniques do not support well these domain-specific characteristics (e.g., the joint analysis of factual and dynamic information). The highest workload reached in incremental tests is crucial information for evaluating individual characteristics and planning training intensities. The proposed approach allows a reliable W peak prediction from the early steps of the test, thus allowing a reduction of its duration. As future developments of this work, we will address the following issues. (i) Support for Individual Comparison. Muscular efficiency has been defined as the (ii) Extension to Other Application Domains. Our approach may be applied on a wide (iii) Support for the Prediction of Additional Parameters. The proposed prediction ap-
