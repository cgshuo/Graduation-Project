 With the explosion of information on the Internet, recommender systems as an indispensable type of Information Filtering technique have attracted lots of attention in the past decades. Typically, recommender systems are based on Collaborative Filtering, which is a technique that automatically predicts the interests of an active user by collecting rating information from other similar users or items[1,4,14].

Recent years, the fast development of online social network has provided new opportunities to increase recommendation accuracy beyond the capabilities of purely rating-driven recommender syste ms. Some social network based recom-mender systems [4,7,9]have been proposed. Generally, social recommendation relies on the assumption that friends in the social network will always share similar tastes. However, the majority of these works neglect the phenomenon that people may declare similar interest with their friends in one domain, but different interest in another one. For example, Alice and Amy are friends, and they share similar interests in the asp ect of clothing, but they have different taste about food. Therefore, we cannot simply consider that Alice and Amy are similar regardless of other informatio n. Some recent works focus on this issue [6,8,11].

However, existing domain-specific social recommendation approaches obtain the friends subsets mainly by dividing f riendships depending on the item cat-egories, which may aggravate the social relationships sparsity problem. As we know that, the available friendships in online social network are extremely sparse [3] and the distribution of the number of social relations follow a power-law-like distribution [17]. A small portion of users have lots of social relations, while a large amount of users have a few relations. If we divide the friendships based on the item categories, the available friendships of users from each category will be-come even less. Actually, people are inte rested in 6.3 item categories on average [11] in the product review sites Epinions 1 , which indicates that in most of the item categories, social recommenda tion may have few contributions.

In order to solve the issue, in this paper, we propose a novel social recommen-dation model by incorporating the frie ndships from different clustering-based user groups and try to improve the a ccuracy of social recommendation con-cerning the heterogeneity and diversity of the social relationships. The main contributions of our work are summarized as follows:(1) We formalize the user-preference matrix which des cribes the preferences of users from multiple domains and obtain the user groups by using the PDSFCM (Partial Distance Strategy Fuzzy C-Means) algorithm, which is a more reasonable method to divide users based on the similarity of users X  prefer ences; (2) we define the clustering-specific friends subsets and design a clustering-based social regularization term to inte-grate these clustering-based friendships into the traditional Matrix Factorization model.

The remainder of this paper is organized as follows. In Section 2, we provide background information about recomme nder systems and review related social recommendation models. Section 3 gives the problem formulation and detailed our clustering-based social recommendati on model. The experiment results and analysis are presented in section 4. Finally, Section 5 concludes this study with future work. Recommender systems play an important role in helping online users find poten-tial items they like. Many techniques are used to build recommender systems, which can be generally classified into content-based methods[14], collaborative filtering(CF) based methods[2,5,16], and hybrid methods[1]. Although recom-mender systems have been comprehensiv ely analyzed in the past decades, the study of social-based recommender syste ms just started. Using social network information to recommend items has b ecome a hot topic in the area of rec-ommender systems. Traditional recomme nder systems [13,14] are based on the assumption that users are independent and identically distributed, and ignore the social relationships between users, which are not consistent with the real-ity that we usually turn to our friends for recommendations. Therefore, social recommendation is more reasonable.

Ma et al. [4] proposed a social recommendation model based on the matrix factorization model. Their method combines a basic matrix factorization ap-proach and a social network based approach, which naturally fuses the users tastes and their trusted friends favors together. Jamali et al. [7] introduce So-cialMF, which is one of the most popular social recommendation algorithms. The authors incorporate the mechanism of tr ust propagation into their probabilis-tic matrix factorization based model, which is a crucial phenomenon in social sciences and increases the rating accu racy to a large extent. An effective and efficient social regularization approach is proposed by Ma et al. [9] to constrain the taste between a user and his/her friends. The authors employed two type of regularization terms: (1) average-based regularization that targets to mini-mize the difference between a user X  X  lat ent factors and the average of that of his/her friends; (2) individual-based regularization that focuses on latent factor difference between a user and each of his/her friends.

Most of the above methods assume that users and their friends will share sim-ilar tastes. However, they ignore the phenomenon that friends may share similar preferences in a domain, and different pre ferences in another one. Recently, some works focusing on this issue have been proposed. As far as we know, Yang et al. [8] is the first to argue that a user may trust different subsets of friends regarding different domains. They divided the social network of all trust relationships into several sub-networks, each of which concerning a single category of items. Based on the SocialMF model, they proposed a circle-based recommendation model to make prediction in each inferred circle. Guo et al. [6] proposed the mTrustMF model. They considered that a user may trust different people in different do-mains. They connected user-category (wh ich can be derived from the categories of users interested items) and user-item rating matrix through a shared user latent feature space. A category-specific regularization term is proposed to make a user X  X  latent feature vector to be cl ose to the average of the latent feature vectors of his trusted friends in the same item categories.

However, these approaches divide frie ndships mainly depending on the item categories. Social recomme ndation can be done withi n certain category. Thus the social relationships can be used in each category are even less, which may aggravate the sparsity problem of social relationships and limit the contribution of social recommendation. Therefore, in our work, we divide the friendships by fuzzily partition the users with similar preferences from multiple domains and integrate these friendships into the traditional Matrix Factorization model to improve the prediction a ccuracy of recommendation. In this section, we discuss how to build our social recommendation model based on the fuzzy clustering of user preferen ces from multiple domains. We first de-fine some notations and formalize the problem studied in Section 3.1. Then the definition of user preference vectors is det ailed and the user-pr eference matrix is obtained in Section 3.2. By employing the PDSFCM algorithm, user groups are generated in Section 3.3 based on the fuzzily partitioning of the user-preference matrix produced in the previous section. Finally, we give the definition of the clustering-specific friends subsets and describe how to make social recommenda-tion with the clustering-based social regularization term in Section 3.4. 3.1 Preliminaries and the item category set by C = { C 1 ,C 2 ,...,C w } . m , n ,and w is the total number of users, items and categories, resp ectively. A rating provided by user u i to item v j is denoted by R i,j , and all the ratings V} constructs an m  X  n user-item rating matrix. Regarding the social network, we define a directed graph G =( U , E ),whereedgeset E represents the relations between users ( U ). The friends set of user u i is denoted by friends ( i )  X  X  .
Traditional recommender systems mainly consider the user-item rating matrix as shown in Figure 1(b) to make recommendation. In this paper, we also consider the item category information and social relationships of users as shown in Figure 1(a). The problems studied in this paper is to find the friends subsets with similar preferences from multiple domains in the social network and integrate these friendships into the traditional recommender systems to further improve the accuracy of social recommendation. 3.2 User Preference Matrix Construction Definition 1. (User Preference Vectors) Regarding each user, the preferences of user u i from multiple domains can be represented by a vector. We formulate the user preference vectors as follows: where r i C k ( k =1 , 2 ,...w ) represents the total number of ratings by user u i in category C k . | R i | represents the total number of ratings issued by user u i . equals to zero, that is to say, user u i has no ratings in all the categories, we assume that the preference of user u i for each category is the same and equals to
Thus an m  X  w user-preference matrix is gener ated as shown in Figure 1(c). For example, suppose C 1 , C 2 , C 3 and C 4 represent the Fashion, Beauty, Computers and Cameras, respectively, then the preferences of user u 1 for Fashion and Beauty is 0.7 and 0.3, and she/he has no interest in the Computers and Cameras. 3.3 PDSFCM-Based Fuzzily Partitioning Algorithm In this section, we cluster users with multiple similar preferences into different groups based on the partition of user-preference matrix generated in Section 3.2. Clustering algorithms partition users into different groups. Users in the same group are assumed to have similar preferences and those in different groups are assumed to have distinct preferences [10,12].

In real life, users often have diverse preferences. For example, one user may prefer both fashion and computers, or even more. Hence, it is more reasonable to allow a user to be assigned to more th an one group. Therefore, we need a soft clustering method to design a fuzzily partitioning approach.

As we know that the data sparsity is a serious problem in recommender sys-tems. One user may just issue a few ratings to a small amount of items. For most of the users, their preference v ectorsarefilledwithmorethanonezero elements as shown in Figure 1(c). Actua lly, the elements in the zero positions are the missing (or incomplete) data. If we simply regard them as zero, it may affect the results of clustering.

For these two reasons, we choose to use the PDSFCM algorithm[12] which is a useful tool for clustering incomplete data sets. The general formula for the number of groups, g c denotes the group center of group c ( c =1 , 2 ,...l ). g c,k is the k th element of g c .
 where  X  i,k = We define the objective function as follows: where P =[ p c,i ] l  X  m is the membership matrix and p c,i  X  [0 , 1] is the probability that user u i belongs to group c ; G = { g 1 ,g 2 ,...,g l } is the group center matrix;  X   X  [1 ,  X  ) is the fuzzification parameter and usually is set to 2 [10];
The goal of PDSFCM is to find the matrix P and G to minimize the objective function. We summarize the PDSFCM as follows: 1) select appropriate values for  X  , l and a small positive number  X  . Initialize the center matrix G randomly. Set step variable t =0. 2) calculate (at t = 0) or update (at t&gt; 0) the membership matrix P by 3) update the center matrix G by 4) repeat steps 2)-3) until G ( t +1)  X  G ( t ) &lt; X  .

After the fuzzily partitioning of users is performed, the membership matrix P which describes the group information of all the users is generated. For example: to group 1 , group 2 , group 3 and group 4 are 0.2,0.3,0.4, and 0.1, respectively. By taking appropriate threshold T ,foreachrowof P , the larger elements are re-mained and each row sums to one (normalized). Suppose the threshold T is set to be 0.25, then p 1 =(0 , 0 . 375 , 0 . 625 , 0). Thus the corresponding user groups are produced. 3.4 Clustering-Based Social Regularization Social recommender systems usually assume that users are similar with their friends, and always turn to their friends for recommendation. In order to get the friends groups which contain the users with similar preferences from multi-ple domains, we define the clustering-specific friends subsets based on the user groups generated in Section 3.3 as follows: Definition 2. (Clustering-specific Friends Subsets) Regarding each group c ,auser u f is in the friends subset of user u i , i.e., in the subset F c ( i ) , if and only if the following two conditions hold: (1) u f  X  friends ( i ) and (2) u f  X  group c , f=1,2...m and c=1,2...l.
Users with multiple similar preferences are clustered into one group. The sim-ilarity between users within a group is higher than the similarity between users belonging to different groups. More specifically, if user u i  X  X  outlink friends set in group c is F c + ( i ), then we could assume that u i  X  X  taste U i should be close to the average taste of all the friends in F c + ( i ), which is 1 | F c intuition, following the approach proposed in[15], a clustering-based social reg-ularization term is proposed in Equation 5 to constrain the user feature vectors in each group. where  X &gt; 0and  X  is a constant controlling the extent of social regularization. p c,i represents the probability user u i belongs to group c . Intuitively, if p c,i is large, say 0.75, it means user u i has more preferences in group c . Then the friendships of group c should contribute more in the whole model. F c ( i ) denotes the friends subset of user u i in group c . |F c ( i ) | is the number of friends in the set F c ( i ) . In some social networks, the rela tionship between users is directed. Therefore, we use notation F c + ( i ) to denote the outlink friends of u i , and use notation F c  X  ( i ) to represent the inlink friends of u i . Only when in undirected social networks, there exists F c + ( i )= F c  X  ( i ).

Hence, based on the matrix factoriz ation model, we propose our CLUSR (Clustering-based Social Recommendati on) model. The objective function can be formulated as: where U  X  X  f  X  m is a user-specific matrix, V  X  X  f  X  n is an item-specific matrix, f ( f min( m,n )) is the dimension of a latent fac tor vector which characterizes a user or an item[13]. Since in the real world, each user only rates a very small portion of items, the matrix R is usually extremely sparse. I ij is 1 if user u i to avoid overfitting, where || X || 2 F denotes the Frobenius norm. The parameter  X  (  X &gt; 0)controls the exten t of regularization.
 The objective function can be minimized by the gradient decent approach. More formally, the gradients of the objective function with respect to the feature vectors U i and V j are shown as Equation 7 and Equation 8 respectively. When model training is finished, the predicted rating  X  R ij of user u i to item v j can be generated by Equation 9, where  X  r is the global bias term which can be obtained by the average value of the observed training ratings. In this section, we conduct some experiments to evaluate the performance of the proposed method CLUSR using the Epinions data set. 4.1 Dataset Description Epinions is a well-known general consumer review site which consists of ratings and directed trust relations. We use the version of Epinions data set published in[11]. The data set consists of 22,164 users with 296,277 items from 27 different item categories. The total number of issued trust relations and ratings is 355,727 and 912,566, respectively. In this paper, we choose ten representative categories to verify the performance of our method. The statistical information of the cho-sen categories is shown in Table 1. In some categories, there are comparatively enough ratings and trust relations for studying social recommendation. How-ever, in the categories of Education, Musical Instruments and Gifts, the ratings and social relations are few. Actually, in the Epinions dataset, there exist many categories like these three categories. 4.2 Methodology and Metrics In our experiments, we perform 5-fold cross validation. In each fold, we use 80% of the data as the training set and the remaining 20% as the test set. Since the objective of our approach is to improve ra ting prediction accuracy, we use two standard metrics to measure the accura cy of various models: Mean Absolute Error(MAE): MAE = 1 N RMSE = 1 N is the real rating of an item and  X  R is the corresponding predicted rating.
In order to validate the superiority of our approach, we compare the recom-mendation results of the following methods: BaseMF: This method is the baseline matrix factorization approach proposed in [13], which does not take into account the social network.
 SoReg: This method is proposed in[9]. It improves the recommendation accu-racy of BaseMF by adding a social regularization term to control friends taste difference. It uses all the social links available in the dataset. mTrustMF: In this method, the author impose a category-based regularization term to constrain the user feature vector s. One user X  X  feature vector should be close to the average of the feature vectors of his friends in the same categories[6]. CLUSR: In this method, a clustering-based social regularization term is added to the BaseMF to constrain the user featu re vectors. One use r X  X  feature vector should be close to the average of the feature vectors of his friends in the same preferences groups. 4.3 Parameter Selection Parameter selection plays a crucial role to many algorithms. In our experiment, we set the dimension of matrix factorization to be f = 10 and the regular-ization constant to be  X  =0 . 01. The social regularization parameter  X  of SoReg, mTrustMF, CLUSR approaches is 0.01, 0.1 and 0.01 respectively. For our CLUSR, there are two main parameters:  X  and l .

Parameter  X  controls how much our method should incorporate the informa-tion of the social network. Figure 2 shows the influence of parameter  X  to the results of RMSE and MAE. We observe that both the RMSE and MAE get the best when  X  reaches around 0.01. Intuitively, if we employ a small value of  X  , the social information may have little use to the prediction results. When  X  continues increasing, the results of RMSE and MAE increase at the same time, which can be explained that if the value of  X  is too large, the social information may dominate the learning processes.
 Parameter l is the number of groups each user can belong to. The threshold T for retaining the elements of the membership matrix P is set to be 1 l .Figure 3 shows the influence of l to the results of RMSE and MAE. When l reaches around 15, both the RMSE and MAE get the best. When l is too small, i.e., around 5, or too large, i.e., around 25, the results get worse. In our consideration, small number of groups cannot clearly partition different user-preference groups. Therefore, the fuzzy weights are inaccu rate to capture the users X  preferences for different groups. As l increases, better groups are captured and the fuzzy weights become more meaningful. However, when l becomes too large, the results get worse, which can be explained that if too many groups are generated, the influence of fuzzy weight becomes too weak that cannot get better results. 4.4 Results Analysis Below we give a detailed breakdown of our experiment results. From Table 2, we can observe that our method CLUSR outperforms the other methods. BaseMF gets the worst result mainly because it was only based on the rating informa-tion and did not consider the social network information. The SoReg approach considered the social information, however, they regard all the friendships/trust relationships as the same. The mTrustMF method divided the trust relationships depending on the item categories. But the social information in some categories are extremely sparse as shown in Table 1, few trust relationships can be used to constrain users preferences in those cate gories, which limits the contribution of the social recommendation. From Table 2 we can see that mTrustMF performs worse than SoReg on the sampled data we use.

Our CLUSR method on the one hand considers both the rating information and social information; on the other hand, we let the feature vectors of user u i to be close to the average of the feature vectors of his/her friends who share similarly preferences from multiple domains with u i in each group and further improve the recomme ndation accuracy. In this paper, we proposed a novel cluste ring-based social recommendation model to improve the accuracy of recommendation. The clustering-specific friends sub-sets are obtained by partitioning users based on their similar preferences from multiple domains. A clustering-based social regularization term is designed to in-tegrate the friendships from each group into the traditional Matrix Factorization model. Real dataset based experiments demonstrate that our approach outper-forms the comparison approaches both in RMSE and MAE. In this work, the weights of friendships are ignored, in the future, we plan to estimate the friend-ships among users and incorporate the weighted friendships into our model. In addition, we will validate our model on some other data sets.
 Acknowledgment. This research is funded by the National Natural Science Foundation of China under grant No. 61272406 and the F undamental Research Funds for the Central Universities, HUST:2013TS101.
