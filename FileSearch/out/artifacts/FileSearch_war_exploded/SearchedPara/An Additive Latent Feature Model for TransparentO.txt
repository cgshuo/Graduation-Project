 Household scenes commonly contain transparent objects such as glasses and bottles made of vari-ous materials (like those in Fig. 6). Instance and category recognition of such objects is important for applications including domestic service robotics and image search. Despite the prevalence of transparent objects in human environments, the problem of transparent object recognition has re-ceived relatively little attention. We argue that current appearance-based methods for object and category recognition are not appropriate for transparent objects where the appearance can change dramatically depending on the background and illumination conditions. A full physically plausible generative model of transparent objects is currently impractical for recognition tasks. Instead we propose a new latent component representation that allows us to learn transparent visual words that capture locally discriminative visual features on transparent objects.
 Figure 1 shows an example of a transparent object observed in front of several different background patterns; the local edge energy histogram is shown around a fixed point on the object for each image. While the overall energy pattern is quite distinct, there is a common structure that can be observed across each observation. This structure can be estimated from training examples and detected reliably in test images: we form a local statistical model of transparent patch appearance by estimating a latent local factor model from training data which includes varying background imagery. The varying background provides examples of how the transparent objects refracts light, Figure 1: Left: Images of a transparent object in different environments. A point on the object is highlighted in each image, and the local orientation edge energy map is shown. While the back-ground dominates the local patch, there is a latent structure that is discriminative of the object. Right: Our model finds local transparent structure by applying a latent factor model (e.g., LDA) before a quantization step. In contrast to previous approaches that applied such models to a quantized vi-sual word model, we apply them directly to the SIFT representation, and then quantize the resulting model into descriptors according to the learned topic distribution. an idea has been used as a way of capturing the refractive properties of glass [34] but not, to our knowledge, as a way of training an object recognition system.
 Specifically, we adopt a hybrid generative-discriminative model in the spirit of [13] in which a gen-erative latent factor model discovers a vocabulary of locally transparent patterns, and a discriminant classifier is applied to the space of these activations to detect a category of interest. Our latent component representation decomposes patch appearance into sub-components based on an additive model of local patch formation; in particular we use the latent Dirichlet allocation (LDA) model in our experiments below. Transparent object recognition is achieved using a simple probabilis-tic model of likely local object features. A latent topic model is learned over the space of local patches in images of a given object observed with varying backgrounds; clustering in this space yields descriptors that can be used to infer transparent structures in an image at test time without any knowledge of the underlying background pattern or environmental illumination. Each image patch at test time is then labeled with one or more candidate quantized latent structures (topics), which define our transparent visual word identifiers.
 Currently, the study of transparent object recognition is extremely limited and we believe ours is the first to consider category recognition of transparent objects in natural settings, with varying pose and unconstrained illumination. The paper provides a first exploration of the problem, establishes a baseline, demonstrates feasibility and suggests problems for future work. Our results show that recognition of transparent objects is possible without explicit physically-based refraction and reflec-tion models, using a learning-based additive latent local feature appearance model. There is an extensive literature of local feature detection and description techniques; here we fo-cus on those related to our transparent object recognition formulation. Existing methods for object category and object instance recognition are generally designed for opaque objects, typically find-ing characteristic local patches using descriptors based on weighted histograms of local orientation energy [2, 18, 6], locally stable region characteristics [19], local self-similarity [29], etc. We explore a similar direction but extend this work to transparent objects. Specifically, we base our method on a novel combination of SIFT [18] and latent Dirichlet allocation (LDA) [4], two techniques used in many previous object recognition methods. The SIFT descriptor (see also the re-lated HOG [6] and neurally plausible HMAX models [27]) generally characterizes local appearance with a spatial grid of histograms, with each histogram aggregating a number of edges at a particular orientation in a grid cell.
 Approaches based on quantizing or matching local appearance from single observations can perform poorly on objects that are made of transparent material. The local appearance of a transparent object is governed, in general, by a complex rendering process including multi-layer refraction and specular reflections. The local appearance of a particular point on a transparent object may be dominated by environmental characteristics, i.e., the background pattern and illumination field. Models that search for nearest neighbor local appearance patterns from training instances may identify the environment (e.g. the background behind the object) rather than the object of interest. Methods that vector quantize individual observations of local appearance may learn a representation that partitions well the variation in the environment. Neither approach is likely to learn salient characteristics of local transparent appearance.
 Bag-of-words (c.f., [31, 5, 24], and many others), Pyramid-match [14, 17], and many generative methods [11, 32] exploit the  X  X isual word X  metaphor, establishing a vocabulary of quantized SIFT appearance. Typically a k-means clustering method (or a discriminative variant) is used to asso-ciate nearby appearances into a single cluster. Unfortunately when background energy dominates transparent foreground energy, averaging similar local appearances may simply find a cluster center corresponding to background structure, not foreground appearance.
 For transparent objects, we argue that there is local latent structure that can be used to recognize objects; we formulate the problem as learning this structure in a SIFT representation using a latent factor model. Early methods for probabilistic topic modeling (e.g. [16]) were developed in the domain of text analysis to factor word occurrence distributions of documents in to multiple latent topics in an unsupervised manner. Latent Dirichlet Allocation [4, 15] is an additive topic model, that allows for prior distributions on mixing proportions as well as the components.
 SIFT and LDA have been combined before, but the conventional application of LDA to SIFT is to form a topic representation over the quantized SIFT descriptors [30, 32, 10, 22]. As previous methods apply vector quantization before latent modeling, they are inappropriate for uncovering latent (and possibly subtle) transparent structures. To our knowledge, ours is the first work to infer a latent topic model from a SIFT representation before quantizing into a  X  X isual word X  representation. Related work on latent variable models includes [9], which reports a  X  X atentSVM X  model to solve for a HOG descriptor with enumerated local high resolution patches. The offset of the patches is regarded as a latent variable in the method, and is solved using a semi-convex optimization. Note that the latent variable here is distinct from a latent topic variable, and that there are no explicitly shared structures across the parts in their model. Quattoni et al. [26] report an object recognition model that uses latent or hidden variables which have CRF-like dependencies to observed image features, including a representation that is formed with local oriented structures. Neither method has an LDA component, but both of these methods have considerable representational flexibility and the ability to learn weight factors from large amounts of training data. Our method is similar in spirit to [13], which uses local oriented gradient strength in a HOG descriptor as a word in an LDA model. However, our method is based on local patches, while theirs is evaluated over a global descriptor; their model also did not include any explicit quantization into discrete (and overlapping) visual words. No results have been reported on transparent objects using these methods. In addition to the above work on generic (non-transparent) object recognition, there has been some limited work in the area of transparent object recognition. Most relevant is that of [25], which focuses on recognition from specular reflections. If the lighting conditions and pose of the object are known, then specularities on the glass surface can be highly discriminative of different object shapes. The initial work in [25] however assumes a highly simplified environment and has not been tested with unknown 3D shape, or with varying and unknown pose and complex illumination. By focusing on specularities they also ignore the potentially rich source of information about transparent object shape caused by the refraction of the background image structure. We take a different approach and do not explicitly model specular reflections or their relationship to 3D shape. Rather than focus on a few highlights we focus on how transparent objects appear against varied backgrounds. Our learning approach is designed to automatically uncover the most discriminative latent features in the data (which may include specular reflections). It is important to emphasize that we are approaching this problem as one of transparent object recognition. This is in contrast to previous work that has explored glass material recognition [20, 21]. This is analogous to the distinction between modeling  X  X hings X  and  X  X tuff X  [1]. There has been significant work on detecting and modeling surfaces that are specular or transparent [7, 12, 23, 28]. These methods, which focus on material recognition, may give important insight into the systematic deformations of the image statistics caused by transparent objects and may inform the design of features for object recognition. Note that a generic  X  X lass material X  detector would complement our approach in that it could focus attention on regions of a scene that are most likely to contain transparent objects. Thus, while material recognition and surface modeling are distinct from our problem, we consider them complimentary. Local transparent patch appearance can be understood as a combination of different processes that involve illuminants in the scene, overall 3D structure, as well as the geometry and material properties of the transparent object. Many of these phenomena can be approximated with an additive image formation model, subject to certain deformations. A full treatment of the refractive properties of different transparent materials and their geometry is beyond our scope and likely intractable for most contemporary object recognition tasks.
 Rather than analytically model interactions between scene illumination, material properties and ob-ject geometry, we take a machine learning perspective and assume that observed image patches fac-tor into latent components  X  some originating from the background, others reflecting the structure of the transparent object. To detect a transparent object it may be sufficient to detect characteristic patterns of deformation (e.g. in the stem of a wine glass) or features that are sometimes present in the image and sometimes not (like the rim of a thin glass).
 We assume a decomposition of an image I into a set of densely sampled image patches I P , each represented by a local set of edge responses in the style of [18, 6], which we further model with an additive process. From each I P we obtain local gradient estimates G P . We model local patch appearance as an additive combination of image structures originating from a background patch appearance A 0 as well as a one or more patterns A i that has been affected by e.g., refraction of the transparent object. An image patch is thus described by: where g P ( i, j, o ) is the edge count for a histogram bin at position ( i, j ) in patch I P at orientation index o ; M, N, T give the dimensions of the descriptor histogram and  X  ( i ) is the scalar weight associated with pattern A i . We further assume non-negative  X  ( i ) , reflecting the image formation process.
 Based on this model, we formulate a corresponding generative process for the local gradient statistics p (
G P ) for patch P . The model constitutes a decomposition of p ( G P ) into components p ( G | z = j ) and mixing proportions p ( z = j ) . Both the components as well as their mixing proportions are unknown to us wherefore we treat them as latent variables in our model. However, we may reasonably assume that each observed patch was only generated from a few components, so we employ a sparseness prior over the com-ponent weights. To estimate this mixture model we use methods for probabilistic topic modeling that allow us to place prior distributions on mixing proportions as well as the components. Based on a set of training patches, we learn a model over the patches which captures the salient struc-tures characterizing the object patch appearance as a set of latent topics. We have investigated both supervised and unsupervised latent topic formation strategies; as reported below both outperform Figure 2: Left: Graphical model representing our latent topic model of patch appearance and quan-tization into a potentially overlapping set of visual words. See text for details. Right: Local factors learned by latent topic model for example training data.
 Figure 3: Detected quantized transparent local features (transparent visual words) on an example image. Each image shows the detected locations for the transparent visual word corresponding to the latent topics depicted on the left. traditional quantized appearance techniques. Figure 2 illustrates examples of the latent topics  X  ( z ) learned by decomposing a local SIFT representation into underlying components. At test time, a patch is presented to the LDA model and topic activation weights are inferred given the fixed topic vectors.
 To obtain a discrete representation, we can quantize the space of topic vectors into  X  X ransparent visual words X . The essence of transparency is that more than one visual word may be present in a single local patch, so we have an overlapping set of clusters in the topic space. We quantize the of the topic space and associate a distinct visual word detection with each topic activation value that is above a threshold activation level .
 Figure 2 summarizes our transparent visual word model in a graphical model representation. Our method follows the standard LDA presentation, with the addition of a plate of variables correspond-ing to visual word detections. These boolean detection variables deterministically depend on the latent topic activation vector: word v i is set when  X  ( i )  X  . Figure 3 illustrates detected local features on an example image.
 Latent topics can be found using an unsupervised process, where topics are trained from a generic corpus of foreground and/or background imagery. More discriminative latent factors can be found by taking advantage of supervised patch labels. In this case we employ a supervised extension to the to train a discriminant representation. This revised model is displayed in the dashed box in Figure 2. The foreground/background label for each patch is provided at training time by the observed variable y ; the parameters  X  ( c ) for each class c =1 ,...,C are trained in order to fit to the observed label variables y by a linear classification model on the topic activations. We make use of these weights  X  by deriving a per topic thresholding according to learned importance for each topic:  X  ( i )  X  /  X  ( i ) . Figure 4: Example images from our training set of transparent objects in front of varying back-ground. We have evaluated the proposed method on a glass detection task in a domestic environment under different view-point and illumination conditions; we compared to two baseline methods, HOG and vector quantized SIFT.
 monitor with varying background (we used images from flickr.com under the search term  X  X reakfast table X ) in order to capture 200 training images of transparent objects. Figure 4 shows some example images of the training set.
 We extracted a dense grid of 15 by 37 patches of each of the 800 glass examples as well as 800 background crops. Each patch is represented as a 4 by 4 grid of 9 dimensional edge orientation histograms. Neighboring patches overlap by 75% . We explored training the LDA model either only on foreground (glass) patches, only on background (non-transparent) patches, or on both, as reported below. The prior parameters for the LDA model were set to be  X  =2 and  X  =0 . 01 and a total of 25 components were estimated. The components learnt from foreground patches are shown in Figure 2; patches from background or mixed data were qualitatively similar.
 We infer latent topic activations for each patch and set detections of transparent visual words ac-cording to the above-threshold topic dimensions. We set the threshold corresponding to an average activation of 2 latent components per patch on the training set. Based on these 15 by 37 grids of transparent visual word occurrences, we train a linear, binary SVM in order to classify glasses vs. background.
 For detection we follow the same procedure to infer the latent topic activations. Figure 3 shows example detections of transparent visual words on an example test image. We run a scanning window algorithm to detect likely object locations, examining all spatial location in the test image, and a range of scales from 0.5 to 1.5 with respect to the training size, in increments of 0.1. In each window latent topic activations are inferred for all descriptors and classification by the linear SVM is performed on the resulting grid of transparent visual word occurrences. For inference we use the implementation of [4], that results in an averaged computation time of 8 . 4 ms per descriptor on a single core of an Intel Core2 2.3 Ghz machine. This is substantial but not prohibitive, as we can reuse computation by choosing an appropriate stride of our scanning technique.
 We compare to 2 baseline methods: traditional visual words and the histogram of oriented gradients (HOG) detector [6]. Both baselines share the same detection approach -namely obtaining detections by applying a linear SVM classifier in sliding window approach -but are based on very different Figure 5: Performance evaluation of detector based on transparent visual words w.r.t. baseline. See text for details. representations. For the traditional visual words baseline we replace the transparent visual words by visual words formed in a conventional fashion: sampled patches are directly input to a vector quantization scheme. We tried different number of clusters from 100 to 1000 and found k = 100 to work slightly better than the other choices. The HOG baseline basically leaves out any feature quantization and operates directly on the gradient histograms. We use the code provided by the authors [6].
 To evaluate our approach, we recorded 14 test images of the above transparent objects in a home environment containing 49 glass instances in total; note that this test set is very different in nature from the training data. The training images were all collected with background illumination patterns obtained entirely from online image sources whereas the test data is under natural home illumination conditions. Further the training images were collected from a single viewpoint while viewpoint varies in the test data. In order to quantify our detection results we use the evaluation metric proposed in [8] with a matching threshold of 0 . 3 .
 Our methods based on transparent visual words outperform both baselines across all ranges of oper-ating points as shown in the precision-recall curve in Figure 5. We show results for the LDA model trained only on glass patches (LDA glass) as well as trained only on background patches (LDA bg). While neither of the methods achieve performance that would indicate glass detection is a solved problem, the results point in a promising direction. Example detections of our system on the test data are shown in Figure 6.
 We also evaluated the supervised LDA as described above on data with mixed foreground and back-ground patches, where the class label for each patch was provided to the training regime. The perfor-mance of sLDA is also displayed in Figure 5. In all of our experiments the transparent visual word models outperformed the conventional appearance baselines. Remarkably, latent topics learned on background data performed nearly as well as those trained on foreground data; those learned using a discriminative paradigm tended to outperform those trained in an unsupervised fashion, but the difference was not dramatic. Further investigation is needed to determine when discriminative mod-els may have significant value, and/or whether a single latent representation is sufficient for a broad range of category recognition tasks. We have shown how appearance descriptors defined with an additive local factor model can cap-ture local structure of transparent objects. Structures which are only weakly present in individual training instances can be revealed in a local factor model and inferred in test images. Learned latent topics define our  X  X ransparent visual words X ; multiple such words can be detected at a single loca-tion. Recognition is performed using a conventional discriminative method and we show results for detection of transparent glasses in a domestic environment. These results support our claim that an additive model of local patch appearance can be advantageous when modeling transparent objects, and that latent topic models such as LDA are appropriate for discovering locally transparent  X  X isual words X . This also demonstrates the advantage of estimating a latent appearance representation prior to a vector quantization step, in contrast to the conventional current approach of doing so in reverse. We see this work as a first step toward transparent object recognition in complex environments. Our evaluation establishes a first baseline for transparent object recognition. While limited in scope, the range of test objects, poses and environments considered are varied and natural (i.e. not a laboratory environment). More extensive evaluation of these methods is needed with a wider range of poses, with more objects, occlusion and more varied illumination conditions.
 There are several avenues of potential future work. We have not explicitly addressed specularity, which is often indicative of local shape, though specular features may be captured in our represen-tation. Dense sampling may be suboptimal and it would be valuable to explore invariant detection schemes in the context of this overall method. Finally, we assume no knowledge of background statistics at test time, which may be overly restrictive; inferred background statistics may be infor-mative in determining whether observed local appearance statistics are discriminative for a particular object category. Acknowledgements. This work was supported in part by Willow Garage, Google, NSF grants IIS-0905647 and IIS-0819984, and a Feodor Lynen Fellowship granted by the Alexander von Humboldt Foundation.

