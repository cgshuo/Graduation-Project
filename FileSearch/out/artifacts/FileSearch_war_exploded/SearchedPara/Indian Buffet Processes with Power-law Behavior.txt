 The Indian buffet process (IBP) is an infinitely exchangeable distribution over binary matrices with a finite number of rows and an unbounded number of columns [1, 2]. It has been proposed as a suitable prior for Bayesian nonparametric featural models, where each object (row) is modeled with a potentially unbounded number of features (columns). Applications of the IBP include Bayesian nonparametric models for ICA [3], choice modeling [4], similarity judgements modeling [5], dyadic data modeling [6] and causal inference [7].
 In this paper we propose a three-parameter generalization of the IBP with power-law behavior. Using the usual analogy of customers entering an Indian buffet restaurant and sequentially choosing dishes from an infinitely long buffet counter, our generalization with parameters  X  &gt; 0 , c &gt;  X   X  and  X   X  [0 , 1) is simply as follows: where m k is the number of previous customers who tried dish k . The dishes and the customers correspond to the columns and the rows of the binary matrix respectively, with an entry of the matrix being one if the corresponding customer tried the dish (and zero otherwise). The mass parameter  X  controls the total number of dishes tried by the customers, the concentration parameter c controls the number of customers that will try each dish, and the stability exponent  X  controls the power-law behavior of the process. When  X  = 0 the process does not exhibit power-law behavior and reduces to the usual two-parameter IBP [2].
 Many naturally occurring phenomena exhibit power-law behavior, and it has been argued that using models that can capture this behavior can improve learning [8]. Recent examples where this has led to significant improvements include unsupervised morphology learning [8], language modeling [9] and image segmentation [10]. These examples are all based on the Pitman-Yor process [11, 12, 13], a generalization of the Dirichlet process [14] with power-law properties. Our generalization of the IBP extends the ability to model power-law behavior to featural models, and we expect it to lead to a wealth of novel applications not previously well handled by the IBP.
 The approach we take in this paper is to first define the underlying de Finetti measure, then to derive the conditional distributions of Bernoulli process observations with the de Finetti measure integrated out. This automatically ensures that the resulting power-law IBP is infinitely exchangeable. We call the de Finetti measure of the power-law IBP the stable-beta process . It is a novel generalization of the beta process [15] (which is the de Finetti measure of the normal two-parameter IBP [16]) with characteristics reminiscent of the stable process [17, 11] (in turn related to the Pitman-Yor process). We will see that the stable-beta process has a number of properties similar to the Pitman-Yor process. In the following section we first give a brief description of completely random measures, a class of random measures which includes the stable-beta and the beta processes. In Section 3 we introduce the stable-beta process, a three parameter generalization of the beta process and derive the power-law IBP based on the stable-beta process. Based on the proposed model, in Section 4 we construct a model of word occurrences in a document corpus. We conclude with a discussion in Section 5. In this section we give a brief description of completely random measures [18]. Let  X  be a measure space with  X  its  X  -algebra. A random variable whose values are measures on ( X  ,  X ) is referred to as a random measure. A completely random measure (CRM)  X  over ( X  ,  X ) is a random mea-sure such that  X  ( A )  X  X  X   X  ( B ) for all disjoint measurable subsets A,B  X   X  . That is, the (random) masses assigned to disjoint subsets are independent. An important implication of this property is that the whole distribution over  X  is determined (with usually satisfied technical assumptions) once the distributions of  X  ( A ) are given for all A  X   X  .
 CRMs can always be decomposed into a sum of three independent parts: a (non-random) measure, an atomic measure with fixed atoms but random masses, and an atomic measure with random atoms and masses. CRMs in this paper will only contain the second and third components. In this case we can write  X  in the form, where u k ,v l &gt; 0 are the random masses,  X  k  X   X  are the fixed atoms,  X  l  X   X  are the random atoms, and N,M  X  N  X  X  X  X  . To describe  X  fully it is sufficient to specify N and {  X  k } , and to describe the from everything else and has some distribution F k . The random atoms and their weights { v l , X  l } are jointly drawn from a 2D Poisson process over (0 ,  X  ]  X   X  with some nonatomic rate measure  X  called the L  X  evy measure. The rate measure  X  has to satisfy a number of technical properties; see [18, 19] for details. If R  X  R (0 ,  X  ]  X ( du  X  d X  ) = M  X  &lt;  X  then the number of random atoms M in  X  is Poisson distributed with mean M  X  , otherwise there are an infinite number of random atoms. If  X  is described by  X  and {  X  k ,F k } N k =1 as above, we write, In this section we introduce a novel CRM called the stable-beta process (SBP). It has no fixed atoms while its L  X  evy measure is defined over (0 , 1)  X   X  : where the parameters are: a mass parameter  X  &gt; 0 , a concentration parameter c &gt;  X   X  , a stability exponent 0  X   X  &lt; 1 , and a smooth base distribution H . The mass parameter controls the overall mass of the process and the base distribution gives the distribution over the random atom locations. The mean of the SBP can be shown to be E [  X  ( A )] =  X H ( A ) for each A  X   X  , while var(  X  ( A )) =  X  1+ c H ( A ) . Thus the concentration parameter and the stability exponent both affect the variability of the SBP around its mean. The stability exponent also governs the power-law behavior of the SBP. When  X  = 0 the SBP does not have power-law behavior and reduces to a normal two-parameter beta process [15, 16]. When c = 1  X   X  the stable-beta process describes the random atoms with masses &lt; 1 in a stable process [17, 11]. The SBP is so named as it can be seen as a generalization of both the stable and the beta processes. Both the concentration parameter and the stability exponent can be generalized to functions over  X  though we will not deal with this generalization here. 3.1 Posterior Stable-beta Process Consider the following hierarchical model: BernoulliP(  X  ) is a Bernoulli process with mean  X  [16]. This is also a CRM: in a small neighborhood d X  around  X   X   X  it has a probability  X  ( d X  ) of having a unit mass atom in d X  ; otherwise it does not If  X  has a smooth component, say  X  0 , Z i will have random atoms drawn from a Poisson process with rate measure  X  0 . In typical applications to featural models the atoms in Z i give the features associated with data item i , while the weights of the atoms in  X  give the prior probabilities of the corresponding features occurring in a data item.
 We are interested in both the posterior of  X  given Z 1 ,...,Z n , as well as the conditional distribu-tion of Z n +1 | Z 1 ,...,Z n with  X  marginalized out. Let  X   X  1 ,..., X   X  K be the K unique atoms among Z ,...,Z n with atom  X   X  k occurring m k times. Theorem 3.3 of [20] shows that the posterior of  X  given Z 1 ,...,Z n is still a CRM, but now including fixed atoms given by  X   X  1 ,..., X   X  K . Its updated L  X  evy measure and the distribution of the mass at each fixed atom  X   X  k are, where Intuitively, the posterior is obtained as follows. Firstly, the posterior of  X  must be a CRM since both the prior of  X  and the likelihood of each Z i |  X  factorize over disjoint subsets of  X  . Secondly,  X  must have fixed atoms at each  X   X  k since otherwise the probability that there will be atoms among Z ,...,Z n at precisely  X   X  k is zero. The posterior mass at  X   X  k is obtained by multiplying a Bernoulli there are no other atoms among Z 1 ,...,Z n . We can think of this as n observations of 0 among n iid Bernoulli variables, so a  X  X ikelihood X  of (1  X  u ) n is multiplied into  X  0 (without normalization), giving the updated L  X  evy measure in (6a).
 Let us inspect the distributions (6) of the fixed and random atoms in the posterior  X  in turn. The random mass at  X   X  k has a distribution F nk which is simply a beta distribution with parameters ( m k  X   X ,n  X  m k + c +  X  ) . This differs from the usual beta process in the subtraction of  X  from m k and addition of  X  to n  X  m k + c . This is reminiscent of the Pitman-Yor generalization to the Dirichlet process [11, 12, 13], where a discount parameter is subtracted from the number of customers seated around each table, and added to the chance of sitting at a new table. On the other hand, the L  X  evy measure of the random atoms of  X  is still a L  X  evy measure corresponding to an SBP with updated parameters Note that the update depends only on n , not on Z 1 ,...,Z n . In summary, the posterior of  X  is simply an independent sum of an SBP with updated parameters and of fixed atoms with beta distributed masses. Observe that the posterior  X  is not itself a SBP. In other words, the SBP is not conjugate to Bernoulli process observations. This is different from the beta process and again reminiscent of Pitman-Yor processes, where the posterior is also a sum of a Pitman-Yor process with updated parameters and fixed atoms with random masses, but not a Pitman-Yor process [11]. Fortunately, the non-conjugacy of the SBP does not preclude efficient inference. In the next subsections we de-scribe an Indian buffet process and a stick-breaking construction corresponding to the SBP. Efficient inference techniques based on both representations for the beta process can be straightforwardly generalized to the SBP [1, 16, 21]. 3.2 The Stable-beta Indian Buffet Process We can derive an Indian buffet process (IBP) corresponding to the SBP by deriving, for each n , the distribution of Z n +1 conditioned on Z 1 ,...,Z n , with  X  marginalized out. This derivation is straightforward and follows closely that for the beta process [16]. For each of the atoms  X   X  k the posterior of  X  (  X   X  k ) given Z 1 ,...,Z n is beta distributed with mean m k  X   X  n + c . Thus Metaphorically speaking, customer n + 1 tries dish k with probability m k  X   X  n + c . Now for the random atoms. Let  X   X   X  \{  X   X  1 ,..., X   X  K } . In a small neighborhood d X  around  X  , we have: Z n +1 is simply a Poisson process with rate measure  X  H . In the IBP metaphor, this corresponds to customer n +1 trying new dishes, with each dish associ-ated with a new draw from H . The resulting Indian buffet process is as described in the introduction. It is automatically infinitely exchangeable since it was derived from the conditional distributions of the hierarchical model (4).
 Multiplying the conditional probabilities of each Z n given previous ones together, we get the joint probability of Z 1 ,...,Z n with  X  marginalized out: p ( Z 1 ,...,Z n ) = exp  X   X  where there are K atoms (dishes)  X   X  1 ,..., X   X  K among Z 1 ,...,Z n with atom k appearing m k times, and h is the density of H . (10) is to be contrasted with (4) in [1]. The K h ! terms in [1] are absent as we have to distinguish among these K h dishes in assigning each of them a distinct atom (this also contributes the h (  X   X  k ) terms). The fact that (10) is invariant to permuting the ordering among Z ,...,Z n also indicates the infinite exchangeability of the stable-beta IBP. 3.3 Stick-breaking constructions In this section we describe stick-breaking constructions for the SBP generalizing those for the beta process. The first is based on the size-biased ordering of atoms induced by the IBP [16], while the second is based on the inverse L  X  evy measure method [22], and produces a sequence of random atoms of strictly decreasing masses [21].
 The size-biased construction is straightforward: we use the IBP to generate the atoms (dishes) in the SBP; each time a dish is newly generated the atom is drawn from H and its mass from F nk . This leads to the following procedure: generates a sample, and transforms the sample back. This method is more involved for the SBP because the inverse transform has no analytically tractable form. The L  X  evy measure  X  0 of that we can generate a sample { v l , X  l }  X  l =1 of the random atoms of  X  and their masses by first sam-associating each v l with an iid draw  X  l  X  H [19]. Now consider the mapping T : (0 , 1)  X  (0 ,  X  ) given by T is bijective and monotonically decreasing. The Mapping Theorem for Poisson processes [19] Lebesgue measure on (0 ,  X  ) . A sample { t l }  X  l =1  X  PoissonP( L ) can be easily drawn by letting e  X  Exponential(1) and setting t l = P l i =1 e i for all l . Transforming back with v l = T  X  1 ( t l ) , v ,v 2 ,... is a decreasing sequence of masses. Deriving the density of v l given v l  X  1 , we get: There are two cases for which they do simplify. For c = 1 ,  X  = 0 , the density function reduces to [21]. In the stable process case when c = 1  X   X  and  X  6 = 0 , the density of v l simplifies to: Doing a change of values to y l = v  X   X  l , we get: of the parameters we do not have an analytic stick breaking form. However note that the weights generated using this method are still going to be strictly decreasing. 3.4 Power-law Properties The SBP has a number of appealing power-law properties. In this section we shall assume  X  &gt; 0 since the case  X  = 0 reduces the SBP to the usual beta process with less interesting power-law properties. Derivations are given in the appendix. Firstly, the total number of dishes tried by n customers is O ( n  X  ) . The left panel of Figure 1 shows this for varying  X  . Secondly, the number of customers trying each dish follows a Zipf X  X  law [23]. number of customers m trying each dish (that is, K m is the number of dishes k for which m k = m ). Asymptotically we can show that the proportion of dishes tried by m customers is O ( m  X  1  X   X  ) . Note that these power-laws are similar to those observed for Pitman-Yor processes. One aspect of the SBP which is not power-law is the number of dishes each customer tries. This is simply Poisson(  X  ) distributed. It seems difficult obtain power-law behavior in this aspect within a CRM framework, because of the fundamental role played by the Poisson process. In this section we use the SBP as a model for word occurrences in document corpora. Let n be the number of documents in a corpus. Let Z i ( {  X  } ) = 1 if word type  X  occurs in document i and 0 otherwise, and let  X  ( {  X  } ) be the occurrence probability of word type  X  among the documents in the corpus. We use the hierarchical model (4) with a SBP prior 1 on  X  and with each document modeled as a conditionally independent Bernoulli process draw. The joint distribution over the word occurrences Z 1 ,...,Z n , with  X  integrated out, is given by the IBP joint probability (10). We applied the word occurrence model to the 20newsgroups dataset. Following [16], we modeled the training documents in each of the 20 newsgroups as a separate corpus with a separate SBP. We use the popularity of each word type across all 20 newsgroups as the base distribution 2 : for each word type  X  let n  X  be the number of documents containing  X  and let H ( {  X  } )  X  n  X  . In the first experiment we compared the SBP to the beta process by fitting the parameters  X ,c and  X  of both models to each newsgroup by maximum likelihood (in beta process case  X  is fixed at 0 ) . We expect the SBP to perform better as it is better able to capture the power-law statistics of the document corpora (see Figure 2). The ML values of the parameters across classes did not vary the estimated values for c are significantly larger than for the SBP to allow the beta process to model the fact that many words occur in a small number of documents (a consequence of the power-law Figure 2: Power-law properties of the 20newsgroups dataset. The faint dashed lines are the distribu-tions of words in the documents in each class, the solid curve is the mean of these lines. The dashed lines are the means of the word distributions generated by the ML parameters for the beta process (pink) and the SBP (green).
 Table 1: Classification performance of SBP and beta process (BP). The j th column (denoted 1: j ) shows the cumulative rank j classification accuracy of the test documents. The three numbers after the models are the percentages of training, validation and test sets respectively. statistics of word occurrences; see Figure 2). We also plotted the characteristics of data simulated from the models using the estimated ML parameters. The SBP has a much better fit than the beta process to the power-law properties of the corpora.
 In the second experiment we tested the two models on categorizing test documents into one of the 20 newsgroups. Since this is a discriminative task, we optimized the parameters in both models to maximize the cumulative ranked classification performance. The rank j classification performance is defined to be the percentage of documents where the true label is among the top j predicted classes (as determined by the IBP conditional probabilities of the documents under each of the 20 newsgroup classes). As the cost function is not differentiable, we did a grid search over the parameter space, using 20 values of  X ,c and  X  each, and found the parameters maximizing the objective function on a validation set separate from the test set. To see the effect of sample size on model performance we tried splitting the documents in each newsgroup into 20% training, 20% validation and 60% test sets, and into 60% training, 20% validation and 20% test sets. We repeated the experiment five times with different random splits of the dataset. The ranked classification rates are shown in Table 1. Figure 3 shows that the SBP model has generally higher classification performances than the beta process. We have introduced a novel stochastic process called the stable-beta process. The stable-beta process is a generalization of the beta process, and can be used in nonparametric Bayesian featural models with an unbounded number of features. As opposed to the beta process, the stable-beta process has a number of appealing power-law properties. We developed both an Indian buffet process and a stick-breaking construction for the stable-beta process and applied it to modeling word occurrences in document corpora. We expect the stable-beta process to find uses modeling a range of natural phenomena with power-law properties. Figure 3: Differences between the classification rates of the SBP and the beta process. The perfor-mance of the SBP was consistently higher than that of the beta process for each of the five runs. would be interesting and illuminating to try to derive it as an infinite limit of finite models, however we were not able to do so in our initial attempts. A related question is whether there is a natural definition of the stable-beta process for non-smooth base distributions. Until this is resolved in the positive, we are not able to define hierarchical stable-beta processes generalizing the hierarchical beta processes [16].
 Another avenue of research we are currently pursuing is in deriving better stick-breaking construc-tions for the stable-beta process. The current construction requires inverting the integral (12), which is expensive as it requires an iterative method which evaluates the integral numerically within each iteration.
 Acknowledgement We thank the Gatsby Charitable Foundation for funding, Romain Thibaux, Peter Latham and Tom Griffiths for interesting discussions, and the anonymous reviewers for help and feedback. We will make large n and K assumptions here, and make use of Stirling X  X  approximation  X ( n +1)  X   X  2  X n ( n/e ) n , which is accurate in the larger n regime. The expected number of dishes is,
E [ K ] = =
O We are interested in the joint distribution of the statistics ( K 1 ,...,K n ) , where K m is the number of dishes tried by exactly m customers and where there are a total of n customers in the restaurant. ( K 1 ,...,K n ) , we have (ignoring constant terms and collecting terms in (10) with m k = m ), Conditioning on K = P n m =1 K m as well, we see that ( K 1 ,...,K n ) is multinomial with the prob-ability of a dish having m customers being proportional to the term in large parentheses. For large m (and even larger n ), this probability simplifies to, [1] T. L. Griffiths and Z. Ghahramani. Infinite latent feature models and the Indian buffet process. [2] Z. Ghahramani, T. L. Griffiths, and P. Sollich. Bayesian nonparametric latent feature models [3] D. Knowles and Z. Ghahramani. Infinite sparse factor analysis and infinite independent com-[5] D. J. Navarro and T. L. Griffiths. Latent features in similarity judgment: A nonparametric [6] E. Meeds, Z. Ghahramani, R. M. Neal, and S. T. Roweis. Modeling dyadic data with binary [7] F. Wood, T. L. Griffiths, and Z. Ghahramani. A non-parametric Bayesian method for inferring [8] S. Goldwater, T.L. Griffiths, and M. Johnson. Interpolating between types and tokens by es-[9] Y. W. Teh. A hierarchical Bayesian language model based on Pitman-Yor processes. In Pro-[10] E. Sudderth and M. I. Jordan. Shared segmentation of natural scenes using dependent Pitman-[11] M. Perman, J. Pitman, and M. Yor. Size-biased sampling of Poisson point processes and [12] J. Pitman and M. Yor. The two-parameter Poisson-Dirichlet distribution derived from a stable [13] H. Ishwaran and L. F. James. Gibbs sampling methods for stick-breaking priors. Journal of [14] T. S. Ferguson. A Bayesian analysis of some nonparametric problems. Annals of Statistics , [15] N. L. Hjort. Nonparametric Bayes estimators based on beta processes in models for life history [16] R. Thibaux and M. I. Jordan. Hierarchical beta processes and the Indian buffet process. In [17] M. Perman. Random Discrete Distributions Derived from Subordinators . PhD thesis, Depart-[18] J. F. C. Kingman. Completely random measures. Pacific Journal of Mathematics , 21(1):59 X 78, [19] J. F. C. Kingman. Poisson Processes . Oxford University Press, 1993. [20] Y. Kim. Nonparametric Bayesian estimators for counting processes. Annals of Statistics , [22] R. L. Wolpert and K. Ickstadt. Simulations of l  X  evy random fields. In Practical Nonparametric [23] G. Zipf. Selective Studies and the Principle of Relative Frequency in Language . Harvard
