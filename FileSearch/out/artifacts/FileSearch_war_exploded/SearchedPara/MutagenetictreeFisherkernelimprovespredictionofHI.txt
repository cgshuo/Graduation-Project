 Kernels pro vide a general frame work of statistical learning that allo ws for inte grating problem-specific background kno wledge via the geometry of a feature space. Owing to this unifying char -acteristic, kernel methods enjo y increasing popularity in man y application domains, particularly in computational biology [1]. Unfortunately , despite some basic results on the deri vation of novel ker-nels from existing kernels or from more general similarity measures (e.g. via the empirical kernel map [1]), the field suf fers from a lack of well-characterized design principles. As a consequence, most novel kernels are still developed in an ad hoc manner .
 One of the most promising developments in the recent search for a systematic kernel design method-ology is the generati ve-discriminati ve paradigm [2], also kno wn under the more general term of model-dependent feature extraction (MDFE) [3]. The central idea of MDFE is to deri ve kernels from generati ve probabilistic models of a given process or phenomenon. Starting with Jaakk ola and Haussler [2] and the seminal work of Amari [4] on the dif ferential geometric structure of probabilis-tic models, a number of studies have contrib uted to an emer ging theoretical foundation of MDFE. Ho we ver, the paradigm is also of immediate intuiti ve appeal, because mechanistic models of a pro-cess that are consistent with observ ed data and that pro vide falsifiable predictions often allo w for more profound insights than purely discriminati ve approaches. Moreo ver, entities that are similar according to a mechanistic model should be expected to exhibit similar beha vior in any related prop-erties. From this perspecti ve, MDFE pro vides a natural bridge between mathematical modeling and statistical learning.
 To date, a variety of generic MDFE procedures have been proposed, including the Fisher kernel [2] and, more generally , mar ginalized kernels [5], as well as the TOP [3], heat [6], and probability product kernels [7], along with a number of variations. Surprisingly , howe ver, instantiations of these procedures in bioinformatics have been confined to a very limited number of classical problems, namely protein fold recognition, DN A splice site prediction, exon detection, and phylogenetics. Furthermore, most approaches are based on standard graphical models, such as amino acid sequence profiles or hidden Mark ov models, that are not adapted in any specific way to the process at hand. For example, a first-order Mark ov chain along the primary structure of a protein is hardly related to the causal mechanisms underlying polypeptide evolution. Thus, the potential of combining biological modeling with kernelization in the frame work of MDFE remains vastly une xplored.
 This paper is moti vated by a regression problem from clinical bioinformatics that has recently at-tracted substantial attention due to its pivotal role in anti-HIV therap y: the prediction of phenotypic drug resistance from viral genotype (re vie wed in [8]). Drug resistant viruses present a major cause of treatment failure and their occurrence renders man y of the available drugs inef fecti ve. Therefore, kno wing the precise patterns of drug resistance is an important prerequisite for the choice of optimal drug combinations [9, 10].
 Drug resistance arises as a virus population evolv es under partially suppressi ve anti viral therap y. The extreme evolutionary dynamics of HIV quickly generate viral genetic variants that are selected for their ability to replicate in the presence of the applied drug cocktail. These adv antageous mu-tants eventually outgro w the wild type population and lead to therap y failure. Thus, the resistance phenotype is determined by the viral genotype. The genotype-phenotype prediction problem is of considerable clinical rele vance, because genotyping is much faster and cheaper , while treatment decisions are ultimately based on the viral phenotype (i.e. the level of resistance).
 From the perspecti ve of MDFE, the interesting feature of HIV drug resistance lies in the structure of the underlying generati ve process. The development of resistance involv es the stochastic accumu-lation of mutations in the viral genome along certain mutational pathw ays. Here, we demonstrate how to exploit this evolutionary structure in genotype-phenotype prediction by deri ving a Fisher kernel for mixtures of mutagenetic trees, a family of graphical models designed to represent such genetic accumulation processes. The remainder of this paper is organized as follo ws. In the next section, we briefly summarize the mutagenetic trees mixture (MT reeMix) model, originally intro-duced in [11]. The Fisher kernel is deri ved in Section 3. In Section 4, the kernel is applied to the genotype-phenotype prediction problem introduced abo ve. We conclude with some of the broader implications of our study , including directions for future work. Consider n genetic events f 1 ; : : : ; n g . With each event v , we associate the binary random variable X denote the mutations conferring resistance to a specific anti-HIV drug. Syntactically , a muta genetic tree for n genetic events is a connected branching T = ( V; E ) on the vertices V = f 0 ; 1 ; : : : ; n g and rooted at 0 , where E V V denotes the edge set of T . Semantically , the muta genetic tree model induced by T and the parameter vector = ( on T with constrained conditional probability tables of the form Thus, a mutagenetic tree model is the family of distrib utions of X = ( X Here, x the parent of verte x v in T . Figure 1 sho ws a mutagenetic tree for the development of resistance to the protease inhibitor nelfina vir . Figure 1: Mutagenetic tree for the development of resistance to the HIV protease inhibitor nelfina vir (NFV). Vertices of the tree are labeled with amino acid changes in the protease enzyme. Edges are labeled with conditional probabilities. The tree represents one component of the 6-trees mixture model estimated for this evolutionary process.
 The probability tables impose the constraint that a mutation can only be present if its predecessor in the topology is also present. This restriction sets mutagenetic trees apart from standard Bayesian netw orks in that it allo ws for an evolutionary interpretation of the tree topology . In particular , the model implies the existence of certain mutational pathw ays with distinct probabilities. Each path-way is required to respect the order of mutation accumulation that is encoded in the tree. Mutational patterns which do not respect these order constraints have probability zero in the model. We shall ex-clude these genotypes from the state space of the model. The state space then becomes the follo wing subset of f 0 ; 1 g n , and the factorization of the joint distrib ution simplifies to The mutational pathw ay metaphor , originating in the virological literature, is generally considered to be a reasonable approximation to HIV evolution under drug pressure. Ho we ver, sets of mutational patterns that support dif ferent tree topologies are commonly seen in clinical HIV databases. Thus, in order to allo w for increased flexibility in modeling evolutionary pathw ays and to account for noise in the observ ed data, we consider the lar ger model class of mixtures of mutagenetic trees. Intuiti vely , these mixture models correspond to the assumption that a variety of evolutionary forces contrib ute additi vely in shaping HIV genetic variability in vivo .
 Consider K mutagenetic trees T respecti vely , such that 0 ( The state space C of this model is the union of the state spaces of the single tree models induced by T (i.e., all mutational patterns have non-zero probability). The star accounts for the spontaneous and independent occurrence of genetic events. We now deri ve a Fisher kernel for the mutagenetic trees mixture models introduced in the pre vi-ous section. In this paper , our primary moti vation is to impro ve the prediction of drug resistance Table 1: Mutagenetic tree Fisher kernels for the three trees on the vertices f 0 ; 1 ; 2 g . The value of inde xed with genotypes that are not compatible with the tree. from viral genotype. Ho we ver, we defer application-specific details to Section 4, to emphasize the broader applicability of the kernel itself, for example in kernelized principal components analysis or multidimensional scaling.
 As Jaakk ola and Haussler [2] have suggested, the gradient of the log-lik elihood function induced by a generati ve probabilistic model pro vides a natural comparison between samples. This is because the partial deri vatives in the direction of the model parameters describe how each parameter contrib utes to the generation of that particular sample. Intuiti vely , two samples should be considered similar from this perspecti ve, if the y influence the lik elihood surf ace in a similar way. The natural inner product for the statistical manifold induced by the log-lik elihood gradient is given by the Fisher information matrix [4]. The computation of this matrix is straightforw ard, but for practical purposes, the Euclidean dot product h ; i pro vides a suitable substitute for the Fisher metric [2] . We first deri ve the Fisher kernel for the single mutagenetic tree model. The log-lik elihood of ob-serving a mutational pattern x 2 f 0 ; 1 g n under this model is Hence, the feature mapping of binary mutational patterns into Euclidean n -space, is given by the Fisher score consisting of the partial deri vatives Thus, we can define the muta genetic tree Fisher kernel as For example, the Fisher kernels for the three mutagenetic trees on n = 2 genetic events are displayed in Table 1.
 To better understand the operation of the novel kernel, we rewrite the kernel function K as follo ws: Figure 2: Non-zero entries of the matrix ( t ) that defines the mutagenetic tree Fisher kernel. The three graphs are inde xed in the same way as the matrix, namely by pairs (( x denoting the value of two genotypes x and x 0 at an edge (pa( v ) ; v ) of the mutagenetic tree. The graphs illustrate that the lar gest contrib utions stem from shared, unlik ely mutations (positi ve effect, solid and dashed line) and from dif fering, lik ely or unlik ely mutations (ne gative effect, dash-dot line). with defined as The matrix ( t ) is inde xed by pairs of pairs (( x are displayed in Figure 2 as functions of the parameter t . An edge contrib utes strongly to the kernel value, if the two genotypes agree on it, but the common event (occurrence or non-occurrence of the mutation) was unlik ely (Figure 2, solid and dashed line). If the two genotypes disagree, the edge contrib utes negatively , especially for extreme parameters line), which mak e one of the events very lik ely and the other very unlik ely . Thus, the application of the Fisher kernel idea to mutagenetic trees leads to a kernel that measures similarity of evolutionary escape in a way that corresponds well to virological intuition.
 Due to the linear mixing process, extending the Fisher kernel from a single mutagenetic tree to a mixture model is straightforw ard. Let ` and denote by the responsibility of tree component T respect to can be expressed in terms of the partials obtained for the single tree models, weighted by the responsibilities of the trees, Dif ferentiation with respect to yields We obtain the muta genetic trees mixtur e (MT reeMix) Fisher kernel In this section, we use the Fisher kernel deri ved from mutagenetic tree mixtures for predicting HIV drug resistance from viral genotype. Briefly , resistance is the ability of a virus to replicate in the presence of drug. The degree of resistance is usually communicated as a non-ne gative number . This number indicates the fold-change increase in drug concentration that is necessary to inhibit viral replication by 50%, as compared to a fully susceptible reference virus. Thus, higher fold-changes correspond to increasing levels of resistance. We consider all fold-change values on a log Information on phenotypic resistance strongly affects treatment decisions, but the experimental pro-cedures are too expensi ve and time-consuming for routine clinical diagnostics. Instead, at the time of therap y failure, the genotypic mak eup of the viral population is determined using standard se-quencing methods, lea ving the challenge of inferring the phenotypic implications from the observ ed genotypic alterations. It is also desirable to minimize the number of sequence positions required for reliable determination of drug resistance. With a small number of positions, sequencing could be replaced by the much cheaper line-probe assay (LiP A) technology [12], which focuses on the deter -mination of mutations at a limited number of pre-selected sites. This method could bring resistance testing to resource-poor settings in which DN A sequencing is not affordable.
 All approaches to this problem described to date are based on a direct correlation between genotype and phenotype, without any further modelling involv ed. Application of the Fisher kernel to this task is moti vated by the hypothesis that the traces of evolution present in the data and modelled by mu-tagenetic trees mixture models can pro vide additional information, leading to impro ved predicti ve performance. In a recent comparison of several statistical learning methods, support vector regres-sion attained the highest average predicti ve performance across all drugs [13 ]. Accordingly , we have chosen this best-performing method to compare to the novel kernel.
 Specifically , our experimental setup is as follo ws. For each drug, we start with a genotype-phenotype data set [14 ] of size 305 to 858 (Table 2, column 3). Based on a list of resistance mutations main-tained by the International AIDS Society [15 ], we extract the residues listed in column 2. The number indicates the position in the viral enzyme (re verse transcriptase for the first two groups of drugs, and protease for the third group), and the amino acids follo wing the number denote the muta-tions at the respecti ve site that are considered resistance-associated. For example, the feature vector for the drug zido vudine (ZD V) consists of six variables representing the reverse transcriptase mu-tations 41L, 67N, 70R, 210W , 215F or Y, and 219E or Q. In the nai ve indicator representation, a mutational pattern within these six mutations is transformed to a binary vector of length six, each entry encoding the presence or absence of the respecti ve mutation.
 The Fisher kernel requires a mutagenetic trees mixture model for each of the evaluated drugs. Us-ing the MT reeMix softw are package 1 , these models were estimated from an independent set of sequences deri ved from patients failing a therap y that contained the specific drug of interest. In 100 replicates of ten-fold cross-v alidation for each drug model, we then recorded the squared correlation coef ficient ( r 2 ) of indicator variable-based versus Fisher kernel-based support vector regression. Avoiding both costly double cross-v alidation with the limited amount of data and overfitting with single cross-v alidation, we fix ed standard parameters for both SVMs. As suggested by Jaakk ola and Haussler [2], the Fisher kernel may be combined with additional transformations. Thus, we evaluated the standard kernels for both setups. For the indicator representation, the linear kernel performed best, whereas the Fisher scores performed best when combined with a Gaussian RBF kernel. We used these two kernels in the final comparison reported in Table 2. The results displayed in columns 5 and 6 of Table 2 sho w the impro vements attained via the Fisher kernel method as estimated by the squared correlation coef ficient, r 2 . After correction for multiple comparisons, the null hypothesis of equal mean was rejected ( P &lt; 0 : 01 , Wilcoxon test) in 15 out of 17 cases, a ratio that is highly unlik ely to occur by chance ( P &lt; 0 : 0025 , binomial test). The most drastic impro vements were obtained for the drugs 3TC, NVP and NFV . Slight decreases were ob-serv ed for ddC and APV . Interestingly , when we combined both feature vectors, the cross-v alidated performance of the combined predictor was consistently at least as good as the best indi vidual pre-dictor (data not sho wn). We obtained similar results when evaluating performance by the mean squared error instead of the correlation coef ficient (data not sho wn).
 Table 2: Comparison of support vector regression performance for the MT reeMix Fisher kernel ( F ) versus a nai ve amino acid indicator ( I ) representation. The drugs (first column) are grouped into the three classes of nucleoside/nucleotide reverse transcriptase inhibitors (ro ws 1 X 7), nonnucleoside re-verse transcriptase inhibitors (ro ws 8 X 10), and protease inhibitors (ro ws 11 X 17). MT reeMix models were estimated based on the mutations listed in the second column. The third column indicates the number N of available genotype-phenotype pairs, and the number K of trees in the mixture model is sho wn in column 4. Columns 5 and 6 indicate the squared correlation coef ficients, averaged across 100 replicates of 10-fold cross-v alidation. P-v alues (last column) are obtained from Wilcoxon rank sum tests, correcting for multiple testing using the Benjamini-Hochber g method.
 The Fisher kernel deri ved in this paper allo ws for leveraging stochastic models of HIV evolution in man y kernel-based scenarios. To our kno wledge, this is the first study in which a probabilis-tic model tailored to a specific biological mechanism (namely , the evolution of drug resistance) is exploited in a discriminati ve conte xt. Using the example of inferring drug resistance from viral genotype, we sho wed that significant impro vements in predicti ve performance can be obtained for almost all currently available antiretro viral drugs. These results pro vide strong incenti ve for further exploitation of evolutionary models in clinical decision making. Moreo ver, the y also underline the potential benefits from inte grating several sources of data (genotype-phenotype, evolutionary). The high correlation that can be observ ed with a relati vely small number of mutations was une xpected and suggests that reliable resistance predictions can also be obtained on the basis of LiP A assays which are much cheaper than standard sequencing technologies. While our choice of mutations was based on a selection from the literature, an interesting problem would be to design dedicated LiP A assays containing a set of mutations that allo w for optimal prediction performance in this generati ve-discriminati ve setting. Finally , mixtures of mutagenetic trees have already been applied in other conte xts, for example to model progressi ve chromosomal alterations in cancer [16], and we expect kernel methods to play an important role in this conte xt, too.
 Ackno wledgments N.B. was supported by the Deutsche Forschungsgemeinschaft (BE 3217/1-1), and T.S. by the Ger -man Academic Exchange Service (D/06/41866). T.S. would lik e to thank Thomas Leng auer for his support and advice.

