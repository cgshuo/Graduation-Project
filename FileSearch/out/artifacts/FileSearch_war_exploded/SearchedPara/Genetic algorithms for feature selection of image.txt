  X  0.77). The developedmethod was then applied to a case study mine of iron 1. Introduction
The ore quality control is an important factor for the economic result of mining. An ore body and its immediate surroundings contain the factors given by nature which determine the ore quality. Even though all possible measures are taken to control the grade of ore, the final ore grade projected from a quality control system, as a whole, might not comply with the requirements. This might be because of the occasional presence of some inherent defects in the quality control system, which might go unnoticed by the quality control practitioners. As a result, the grade of ore may not achieve the desire quality. To overcome that unwanted situation, a suitable quality monitoring and control system must be adopted at the mine level.

The most important aspects of a successful ore quality monitoring in mining are the use of fast, reliabl e, and inexpensive online sensors. However, in most cases, it is not possible to measure all the quality monitoring parameters in very fast and cost effective manner. The ideaofdealingsuchsituationisbymeasuringthoseparameterswhich are easyto determineandare costeffective; andthen developa model which can estimate the desired quality parameters from the mea-sured parameters ( Corke et al., 1998; Kopardekar et al., 1993 ). The vision-based technique has great advantage to measure image features and predict the unknown qu ality parameters through proper model development ( Chatterjee et al., 2009; Singh and Rao, 2005 ).
The idea of implementing online grade monitoring schemes using image-based systems is beneficial for several reasons. The image-based systems have great success in quality monitoring for mineral industry ( Singh and Rao, 2005 ) as well as for other industries ( Malamas et al., 2003 ). The grade control of ore at the mining location is usually carried out by human experts. The human experts make judgments about the ore grade based on their visual observations. These examples illustrate that it is possible to determine ore quality visually, which leads us to draw an analogy with an image-based system.

Inthe past, Oestreich et al. (1995 ) demonstrated the use of an online sensor for mineral composition determination. Petruck and Lastra (1993 ) conducted a study for determination of mineral grade values on a microscopic scale. Shafarenko et al. (1997 ) applied an image-based technique to inspect the quality of a granite rock. Casali et al. (2000) developed a vision-based model for ore grindability analysis. Petersen et al. (1998) , Henley (1983 ), and ( Jones and Horton (1979 ) conducted different studies on an ore textural analysis using the image processing techniques. The center of attent ion of their studies was on the determination of average particle size and characteristic of various ore types in industrial plant. Lin et al. (1993) applied image analysis techniques to the development of an online particle size analyzer.
Chatterjee et al. (2009) applied vision based techniques for predicting ore grades in a limestone mine.
 requires extraction of large number of image features, since it is not known in advance which features have significant impacts on the quality parameters. Dealing with the extraction of such large numbers of parameters and modeling them can take huge compu-tational time. Moreover, the redundant features may sometime also mislead the model performance ( Steppe et al., 1996 ). Further, as the number of features grows, the number of training samples required for model development grows exponentially ( Duda and
Hart, 1973 ). Therefore, for developing a valid model, the dimen-sionalities of the image features are required to be reduced. Chatterjee et al. (2009) and Chatterjee et al. (2008 ) applied
Principal Component Analysis (PCA) on extracted features to reduce the dimensionality for quality parameters modeling. The main disadvantage of PCA based modeling is that it creates the new features by linear combination of the original features. Although model development time has been reduced by this approach, the imagefeatureextractiontimecouldnotbereduced.Thebranchand bound ( Narendra and Fukunaga, 1977 ) exhaustive search techni-que can be used for optimal feature selection but it requires huge computational time. The Genetic Algorithm (GA), a heuristic approach, has great advantage for efficient feature selection which provides close to optimum feature subset with a reasonable amount of time ( Hong and Cho, 2006 ).
 prediction of ore quality at the mine level. The GA combined with
Neural Networks (NNs) was applied for feature selection as well as vision-based model development. For developing the model, the rock samples were collected from different locations of the case study mine and images were taken in the controlled environment of a laboratory. Then, an attempt was made to find out the inherent relationship between the subset of image-extracted features and grades using neural networks technique.
 overview of the steps involved in the methodology. A case study of an iron ore deposit is presented in Section 3. Section 4 presents the ore grade monitoring at the mine level using the proposed method.
Section 5 draws conclusions and summarizes the results. 2. Methodology three processes, namely: image acquisition, processing or analysis, and recognition. The success of a machine vision application depends on the inter-dependent processes as mentioned above.
The problem that is tried to be solved in this paper is to extract information from images, which may not be easily seen with human eye, and use the information to quantitatively predict the grade of a mineral. Fig. 1 shows the basic processes in image analysis technique ( Rosenfeld, 2001 ). 2.1. Image acquisition wooden box, an illumination system, a digital camera and a personal computer. The box is made of wood with dimensions of 25 cm 30 cm 30 cm. The top of the box is bowl shaped with an approximate diameter of 40 cm. Since the lighting type, the location, and the color quality are crucial for clear images, uniform diffuse lighting was used. Four fluorescent tubes (150 mm diameter, 23 W circular tubes) are fitted at the four sides on the bowl with an angle of 45 1 to the horizontal so that it would produce minimumshadow.Theboxhasanopeningatthetopforplacingthe camera for capturing the images. A schematic diagram of the image acquisition set-up is presented in Fig. 2 . A digital camera with an aspect ratio of 4:3 was used to take the images. The images were transformed to the personal computer through the USB cable. 2.2. Image segmentation
The objective of the image segmentation procedure is to generate a binary image in which each discrete region represents an individual rock sample. Image segmentation procedures may operate either on the entire image, based on some global char-acteristic of the image (global operations), or on individual pixels, based on the characteristics of its neighbors (neighborhood opera-tions). An example of a global operation is the application of an intensity threshold to a grayscale image in order to produce a binary image. Global operations have the advantage that they are very rapid to execute, but they are intolerant of non-uniform lighting. The manual digitization technique is one of the easiest image segmentation techniques, but it is a time consuming. Several automatic and semiautomatic segmentation techniques are avail-able in the literature ( Bergo et al., 2007 ). However, Graham et al. (2005) suggested that no single image segmentation technique is perfect to segment the rock samples from their neighbors. In the present paper, a hybrid image segmentation technique has been developed.

Fig. 3 shows the steps involved in the hybrid segmentation technique applied in this paper for an image segmentation. In this technique, a neighborhoodoperation utilizes a bottom-hattransforma-tion to identify small and dark parts of an image. At the same time, the top-hat operation was also performed to identify the larger part of the image. The top-and bottom-hat operation were performed by combining the image opening and closing operation with the original image and neighborhood template Vincent (1993) .

After performing the bottom-hat transformation, the resulted image was added with the original gray image. The resulted image of the previous operation was then subtracted by top-hat trans-formed image. The operation used here is the morphological operation introduced by Meyer (1979 ). This is implemented as the difference between an image and its morphological grayscale closing ( Soille, 2003 ). The initial application of a median filter reduces the response of the top-and bottom-hat transformation to intra-rock noise. Image was then undergone complement opera-tion followed by extended minima operation ( Soille, 2003 ). The number of regional minima locations was created by top-and bottom-hat operation. All these minima are not that much relevant to segmentation problem. To eliminate these extraneous minima, the extended minima was used which computes the set of low spots in the image that are deeper (by a certain threshold) than their immediate surroundings ( Soille, 2003 ). The resultant image is a binary image whose foreground pixels mark the locations of the deep regional minima. But in most of the cases all the regional minima are not desired for segmentation problem. In these cases, minima imposition procedure was adopted ( Chatterjee, 2007 ). The minima imposition technique ( Soille, 2003 ) modifies the gray scale image so that the regional minima occur only in the marked locations. Other pixel values are pushed up as necessary to remove all other regional minima. Finally, watershed transformation technique was applied in modified image ( Vincent and Soille, 1991 ). 2.3. Feature extraction
After identifying image objects by image segmentation, image features were extracted from individual segmented images. The featuresare characterized intothreecategories:color, morphology, and texture. Depending upon the properties of rocks and the purpose of analysis, different image features have different levels of importance. Oestreich et al. (1995) shown that color features have great importance for mineral composition determination. Casali et al. (2000) and Chatterjee et al. (2008) presented that all image features, namely, color, textural, and morphological fea-tures, have equal importance for lithological classification of rocks. However, Singh and Rao (2005 ) demonstrated that the textural features are only influential factors for iron ore classification. Several studies also show that morphological features play an important role for rock properties classification ( Lopez et al., 2003; Starkey and Samantaray, 1993 ). Therefore, it is difficult to select which type of features, whether color, morphology, or texture, has more importance in this proposed study. Therefore, all types of image features (morphology, color, and texture) were extracted and an optimum number of features was selected using genetic algorithm as discussed in Section 2.4. 2.3.1. Morphological features
Morphological features are the physical features that describe the appearance of an object. There are a number of different morphological features which were presented in literature ( Kim, 2000; Saykol et al., 2005 ). The moment-based morphological features ( Kim, 2000 ) deal with both the interior and the boundary of the objects; thus they can be employed in a more general way for object identification purpose. In a recent work, histogram-based approach ( Saykol et al., 2005 ) is shown to be a more effective method for object identification than the other methods. However, it is difficult to identify which features will be most appropriate for the method proposed in this paper for quality parameter modeling.
Therefore, some commonly used features along with moment-based features were included in this study to capture morpholo-gical information. The commonly used morphological features are area, perimeter, length, and width (major and minor axis length) of the objects. Area of an object can be defined as the number of pixels contained within its region. Area is determined by counting the number of object pixels. Perimeter of an object is defined as its boundary length. Boundary length is the sum of distance between successive boundary pairs of pixels of an object. In this paper, boundary pixels were identified using 8-neighbor connectivity methods.The major axis is the length of an object that runs through itscentroidorcenterofmass.Theminoraxis isthe longestlengthof the object through the centroid that is perpendicular to the major axis. Convex hull or convex polygon was calculated from pixel centers. This is the smallest convex set containing the object. Some of the basic morphological features are shown in Fig. 4 . A total number of 28 morphological features like roundness, thickness ratio, connectivity, etc. is derived from above basis parameters ( Chatterjee, 2007 ). To know more about those derived features, readers are referred to ( Huang et al., 2008; Lefkaditis and Tsirigotis, 2009 ).

Apart from those basic and derived features, moments ( Kim, 2000 ), the statistical representation of objects, are also calculated from the segmented image. The moments of binary objects describe their shape. The moments of different orders are deter-mined as m  X  where p , q  X  0, 1, 2 y is the order of the moments; in binary images the gray level of the object X ( i , j ) is 1 for all pixels.
The central moments m pq that are invariant to translation (position of the object in a given image) and normalized central moments Z pq that are invariant to translation and size of the object are given by where g  X  (1/2)( p + q )+1, ( x c , y c ) centroid of an object. and orientation of the object in an image and are determined as ( Kim, 2000 ) this study. 2.3.2. Color features color of iron ore varies from light to dark depending upon the percentage of iron present in ore ( Webb et al., 2003 ). Therefore, if the color information of rocks can be extracted by means of some color features, the quality parameters of iron ore can be modeled.
The most widely used color model RGB depends on the imaging conditions such as viewing direction, object geometry, direction of the illumination, intensity, and color of the illumination. Hence, using RGB values for image retrieval may cause severe problems when the query and target images are recorded under different imageconditions. Although,images inthisstudywere takenwithin a fixed experimental set-up; however, it did not ensure that direction, intensity, and color of illumination are constant through-out the period of the experiment. Therefore, RGB is not suitable for object color modeling. The normalized color models (r, g, and b), which are calculated by dividing R, G, and B by their total sum, are used for color modeling. Since, the r, g, and b depend only on the ratio of R, G, and B (i.e. factoring luminance out); they have the important property that they are not sensitive to shading, surface orientation, illumination direction, and illumination intensity ( Vertan and Boujemaa, 2000 ). Moreover, human beings perceive color as three independent attributes namely Hue, Saturation, and Intensity (HSI) ( Alshamasin et al., 2009 ). Hue represents the dominant wavelength that is pure color; saturation refers to the amount of white light mixed with the pure light; and intensity isthebrightnessoftheachromaticlight( Taoetal.,1999 ).IntensityI depends on viewing direction, object geometry, direction of the illumination, intensity, and color of the illumination. Saturation S depends on highlights and a change in the color of the illumination.
Hue H depends only on the color of the illumination. The color features are characterized by the intensity levels of its components, namely r, g, b, H, S, I, and gray. From these 7 color components, 10 intensity features (mean, median, mode, absolute mean, variance, range, mean absolute deviation, inter-quartile range, skewness, and kurtosis of intensity value) were extracted.
 distribution of objects, are also an important parameter for object identification ( Demi, 2005 ). The same six moment invariant features as presented in Eq. (3) are used for feature extraction from gray level histogram. 2.3.3. Textural feature
Textural properties of an object can be defined as the spatial distribution of gray level intensities. They were used to quantify properties such as smoothness, coarseness, fineness, and granulation.
Many texture analysis methods we re developed over the past few decades applicable to varied field of specializations ( Chang and Kuo, 1993; Galloway, 1975; Haralick et al., 1973; Laine and Fan, 1993; Liu and Jernigan, 1990 ). However, statistical features ( McNitt-Gray et al., 1995 ), co-occurrence matrix features ( Haralick, 1979 ), and run length matrix features ( Galloway, 1975 ) have great success for image classification and regression modeli ng. In this paper, therefore, statis-tical, co-occurrence and run len gth features were extracted. The statistical approach of measuring texture is the simplest method and more powerful that structural approach which takes into con-sideration the moments of the gray l evel histograms. Four statistical features i.e. smoothness, uniformity, entropy, and maximum prob-ability ( McNitt-Gray et al., 1995 ) are considered as statistical features for our study. The development of co-occurrence matrix is the important step to extract the co-oc currence features. For this purpose the lag-distance in the co-occurrence matrix has to be optimally chosen. The optimal parameter lag distance ( d ) of a co-occurrence matrix depends on the resolution of the texture. Zucker and
Terzopoulos (1980 ) developed a method to determine this optimal distance. However, this optimum refe rs to a distinct texture. In the best case, it can be generalized to the entire texture class. In this iron ore deposit several rock types are involved. Hence, an optimal distance for all rock types cannot be determined. Consequently, the textures were studied according to several distances. The experiments were per-formed with d  X  1; 5; 10; 15; and 20. The energy, entropy, maximum probability, contrast, correlation, and homogeneity ( Haralick, 1979 ) were extracted from co-occurrence matrices developed in all 5 direc-tions. Therefore, total 30 co-occurrence features were extracted. In addition, features generated from run length matrix ( Galloway, 1975 ) play an important role for vision-based modeling ( Paliwal et al., 2003 ).
Therefore, the run length features were extracted from the gray scale image of the segmented rock. Nine features of run length statistics proposed by Galloway (1975 ) were extracted. Chu et al. (1990) proposed two new run length features to extract gray level information in the matrix. Dasarathy and Holder (1991 ) described another four features extraction functions following the idea of joint statistical measure of gray level and run length. A total number of 15 run length features were extracted in this study. Therefore, a total number of 49 textural features (4 statistical features, 30 co-occurrence features, and 15 run length features) were extracted for each and individual rock sample.

Thus, a total number of features extracted for this case study mine was 189 which included 112 color features, 28 morphological features, and 49 textural features. 2.4. Image feature selection
After extracting the large number of image features, it is always not desirable to use them for ore grade modeling. It not only increases the dimensionality of the problem which leads to computational complexity but also some features are irrelevant to the problemin hand. Themain advantage ofthe feature selection is that it helps to reduce the future data collection cost by discarding those redundant features. In this paper, the GA-based feature selection algorithm was adopted ( Huang and Wang, 2006 ).

In this algorithm, a population of n subsets is created, each containingarandomcombinationofvariables.Thecostfunctionfor each subset is then evaluated in turn. Then, using techniques loosely based on biological genetics and evolution, a new popula-tion is created.

First, each subset is considered as a string of m l X  X  and 0 X  X , where m is the total number of variables to choose from. The state of each variable is represented by a  X 1 X  (selected to be in the model) or a  X 0 X  (not selected). In genetic terms each variable is called a gene and a set of variables is called a chromosome. For example, in a variable selection problem starting from 8 variables, one possible chromo-some would be 00110101. This can be translated such that variables 3, 4, 6, and 8 are to be used in the modeling process and variables 1, 2, 5, and 7 are to be omitted.

A weighted random selection is applied to the original popula-tion where the probability of a particular subset (chromosome) being selected is a function of its cost function response. Thus, chromosomes with a good cost function response will have a greater chance of selection. Using this method two of the chromosomes are selected and  X  X ated X , swapping sections of their respective gene sequences. This process produces two new  X  X hild X  chromosomes inheriting characteristics of their  X  X arents X . These child chromosomes are then subjected to random mutation where the state of each gene may be changed from a  X 1 X  to a  X 0 X  or vise versa. The probability of this change is normally very small.

The process of selection followed by reproduction and mutation is then repeated until n new chromosomes are created ( Davis, 1991 ). The cost function is then evaluated for each of the chromo-somes and the whole process repeats itself.
 The algorithm continues until a stopping criterion is reached. For example, the stopping criterion may be that a given cost function response is met, or a certain number of generations has passed, or the chromosomes have converged to a similar configuration.

The five steps consisting of encoding into chromosomes, initial population selection, evaluation of the cost function, reproduction, and testing for the stopping criterion are the basic building blocks for all GAs ( Davis, 1991 ). 2.5. Neural networks for ore grade modeling
After generating the population of chromosome, the evaluation of the cost function was carried out. To calculate the cost of individual population, the mapping of the image features and the ore grade was carried out. For input X  X utput mapping, we have applied neural networks technique. Prediction model for the ore gradesisachievedbyfeedingthefeaturevectorasinputstoamodel that captures the relationship between ore grades and feature vector. The cost function used in this study is mean squared error of the ore grades in the validation data set.

Neural Networks (NNs) is a modeling tool having the ability to learn the complex inter-relationship between the input and the output variables of multi-dimensional data ( Jordan and Bishop, 1996 ). The three layered networks were used in this study. The input layer is connected to hidden layer and the hidden layer is connected to output layer. Each connection is associated with a connection weight. During the learning phase, the network is presentedwithafeaturevectorasaninputandoregradesas output values. The weights are modified iteratively, and after some iteration they become adjusted in such a way that when the input values are presented, the network produces outputs, which are close to their actual output values.

After iteration, the outputs are compared to the target values and any observed difference between these two corresponds to an error. The error value is a function of the weights and is minimum when the network outputs match the desired output. The weights are thus adjusted to reduce this measure of error. The error on a pattern is given by E  X  w  X  1 2 where t and z are the target and the network output vectors of length c , and w represents the weights in the network. The weights are initializedwithrandomvalues,andthentheyarechangedinadirection that will reduce the error, the method known as a back-propagation gradient decent with momentum ( Phansalkar and Sastry, 1994 )
D w  X  m  X  X  Z @ E  X  m  X  @ w  X  m D w  X  m 1  X  X  5  X  where Z is the learning rate and m is the momentum.

The iterative algorithm requires taking a weight vector at iteration m and updating it as w  X  m  X  1  X  X  w  X  m  X  X  D w  X  m  X  X  6  X 
From chain rule, it shows that the weight change is @ E @ w  X  @ E @ net where net j  X  f  X  P M i  X  1 x i w ij  X  w j 0  X  X  f  X  P M i  X  0 indicates units in the input layer (that is M number of input selected by genetic algorithm), j in the hidden layer, w ij input to hidden layer weights at the hidden unit j , and f is the activationforhidden j .Inthisstudy,logisticactivationfunctionwas used ( Mandic and Chambers, 2006 ) and presented by following: f !
The adjusted weights are then used to calculate the error term for the next iteration. The process is repeated in the same fashion and it will stop when the error will reach to a threshold value. After completionofthetraining,themodelcanbeusedforprediction purpose. 2.6. Model development
Theinitialpopulationselectedis50for thisstudy.Crossoverand mutation operations are performed for the selected chromosomes by the roulette wheel selection criteria ( Davis, 1991 ) based on the calculated cost function. The bad fit chromosomes are eliminated from the population to maintain the total gene population of 50 after each generation. When the algorithm reaches the stopping criterion, the neural networks model with minimum cost function from the final population is selected as the optimum model for the study. The corresponding input features are considered the opti-mum combination of features for the given problem.

The problem we have discussed so far will provide the optimum set of input features for the cases when the number of selected input parameters is known. However, it is not possible to know before hand the number of selected image features, from the set of extracted image features. To know the optimum number of selected image features, we have run the above discussed algo-rithm by varying the selected image features number from 1 to m ; where m is the total number of extracted features. Then the error of the validation data was compared to select the best neural net-works model with best combination of input image features. The schematic diagram of the proposed approach is presented in Fig. 3 .
The algorithm applied in this paper is also summarized here 1. Extract M number of image features from the images; perform chemical analysis to know the ore grades (output) of the individual samples whose features were extracted. 2. Divide available pattern (image features and corresponding output) into training, validation, and testing data sets. 10. k  X  k +1 and go to step 4. 11. if k  X  M , stop. 12. Compare validation error of M saved model; select the model 13. Test the model performance with testing data. 3. Case study 3.1. Data collection south-eastern part of India. This is a hilly deposit with highly undulating ground level. The mine has seven different lithologies namely, Steel Gray Hematite (SGH) Blue Hematite (BH), Laminated Hematite (LH), Laterite (L), Blue Dust (BD), Shale (SHL), and Banded
Hematite Quartzite (BHQ). Most of the high grade iron ore is associated with SGH, BH, and LH.
 point of the case study mine while maintaining the proper sampling strategy. The stratified random sampling method was adopted for this study. The whole domain was first divided lithology wise and then samples were randomly selected from eachlithology.Therocksamplesfromeachlithologywerecollected randomly. It was also decided to capture equal number of samples from each stratum. The blue dust litho unit is only consists of dust, which was not considered in the analysis. Therefore, only six lithologies were available for our study. Altogether 120 samples, 20 from each lithology, were collected from the study mine. The samples weighed approximately 5 kg. The image acquisition and analysis including the chemical analysis of the samples were carried out in-house using the experimental setup as discussed in Section 2.1. The image of the individual sample was taken in different orientations. The image from one such sample was taken in 10 randomly oriented positions so that images can capture the variability of color, shape, and texture at the different sides of the rocks. The reason behind the taking of images from the different sides of the same image is that if we take images of same sample from different sides and changing the orientation and feed the extracted features of all those image features against the same ore grade then the generalization capability of the developed model based on the image-extracted rock features will be improved. The total number of images for the study is 1200. Fig. 5 shows some images which were taken during the study. 3.2. Image segmentation remove the noise as much as possible. The image segmentation techniques were then applied to the filtered images. The image segmentation technique, as described in Section 2.2, was then applied to all images ( Chatterjee et al., 2008; Shafarenko et al., 1997 ). Fig. 6 presents the image outputs of the segmentation technique at various stages for a sample image.

The segmented images were then processed for identifying and labeling the individual rock objects present in the segmented parts using the region labeling algorithm ( Jae-Chang and Dorai, 1999 ).
The MATLAB software was used for this purpose. A total number of 4878 segmented rocks was generated from this process for all rock samples. It should be noted that, from blue dust, which is a fine grained sample, it was really impossible to extract segmented grains. So, this rock type was excluded from the study.
The features were then extracted from each of the individual rock objects. Altogether, 189 features were extracted as mentioned in Section 2.3. 3.3. Feature selection and ore grade prediction model
The ore grade prediction model for iron ore was constructed for prediction of the grade percentage of the attributes from their digital images. The features, which were extracted from the individual rock, were considered as the input for grade prediction purpose. The mathematical model was developed for establishing the relationship of iron percentage with the extracted features. Since, the analysis of the grades of the individual segmented rocks is a very time consuming process, we have determined the grades of the 120 iron ore samples by chemical analysis at the laboratory. However, the image features were extracted on the individual rock from the segmented rocks. Therefore, it was essential to get the feature information based on individual samples. From the dis-cussion it is clear that one sample will have more than one segmented rocks. To make the modeling problem simple, the assumption was made that the image features are additive for a single sample. This assumption makes the problem simple to calculate the sample-wise image features. Therefore, to obtain the image features of a single ore sample, averaging of all the segmented rocks in that particular image was performed for each individual features. Thus, weighted average of the feature was made from segmented rocks in an image ( Chatterjee et al., 2009 ). The averaging was performed for all the 189 features. A total number of 1200 input data was available for modeling purpose and atthe sametime1200outputirongrade values(10images havethe same value) were available for the modeling purpose.

Prior to using these feature data for modeling purpose, these image features were scaled between 0 and 1. The range and minimum values of individual features were used to scale the input feature vectors. The output parameter, i.e. the iron ore grade was also scaled between 0 and 1.

To improve the generalization capability of the developed model, the validation data were used to guide the training process.
For the modeling, 50% (600), 25% (300), and 25% (300) were randomly taken as the training, the validation, and the testing data, respectively. The testing data set were kept aside to check the performance of the developed model with unseen data. The F-test was carried out to check the statistical similarityof these three data sets and results revealed that they are statistically significant at 95% confidence level.

The three layered neural network model was used for super-vised learning from available input X  X utput patterns. The nodes in input layer were selected by feature selection algorithm applying genetic algorithms and the node in output layer was one (Fe). Since the problem addressed in this paper has large number of input features, the hidden node size chosen was considerably big (40).
Although, the large numbers of hidden node size creates the neural network model complex in nature, but with small number of hidden nodes the model may have the possibility to be trapped in local optimum point. However, the hidden node size has impact on the model performance, but that specific study was beyond the scope of the paper. The logistic activation functions were used in both hidden and output node layers. The gradient descent training algorithm was used to train the network ( Baldi, 1995 ). The early stop training algorithm was applied for neural network learning ( Lodwich et al., 2009 ) for improved model generalization. In the early stop training, the neural networks iteration stops when the mean squared error of the validation data starts increasing.
For input feature selection, genetic algorithms randomly gen-erate population of features from 189 available features. In this paper, we have started with single input feature and increased it after each complete run as discussed in Section 2.6. The mean squared error of the validation data set from neural network result is used as a fitness function for this GA experiment. The cross over rate, mutation rate, and the generation gap were kept at 0.9, 0.005, and 0.95, respectively. The one point cross over is applied in this paper. The evolution process is stopped when the best fitness remained unchanged for 50 generations. The best feature and corresponding error values were saved after complete run of combined neural network and genetic algorithm model. The same algorithm run was conducted by incrementally changing the number of selected features from 1 to 189. However, there was no improvement of mean squared error value after 50 features; therefore, we stopped our model run beyond that point to save computational time. Fig. 7 presents the mean squared error of the validation data set for different number of selected features from the set of available features. It is observed from the figure that the mean squared value of the validation data is decreased up to a certain number of selected image features. It is a quite obvious fact that with a few number of image features it is really difficult to model the complicated ore grades. After 25 selected features, the mean squared error values take a zigzag path and produces minimum error with 39 selected features. From the 39 selected features, it is observed that 21 color features, 5 morphological features, and 13 textural features were selected.
 performance of the model was tested with the testing data set. The error statistics and scatter plot of observed and predicted values are shown in Table 1 and Fig. 8, respectively. The result revealed that the model is a reasonably good fit for predicting the iron grades from its image features. The error histogram plot shows that the error follows close to the Gaussian distribution with mean zero ( Fig. 9 ). 4. Off-line quality monitoring at face level
To check the validity of the developed model, the second phase of sample collection was carried out from the same case study mine but from the different areas of the mine.

Off-line monitoring results using the neural regression meth-odology are presented for the iron ore case study mine. The model was used for pilot study to show the command of the approach for off-line monitoring, and for determining the ore grade concentra-tion at the face level. Off-line results are then presented to show its ability to predict concentration and distribution of grade at the different locations of the mine.

This validation study was carried out at three different locations in the mine for a period of seven days. The samples were collected in adaysessionat2 hintervalforallthethreelocations.Atotalnumber of 5 samples was collected from each location at everyday for trial monitoring of the quality. Thus, 35 samples for each location were available for this validation study. Same experimental set up was used for capturing the images of those samples.Insteadof extracting 189 image features, this time only 39 selected image features were extracted. The grades of the iron ore samples were predicted by the developed model. The predicted grades were then compared with the grade obtained from the chemical analysis of the same samples. Fig. 10 shows the run chart of image analysis and chemical analysis based on iron ore grades from all the three locations.

It is observed from the figure that the predicted grades from the images are in good agreement with the laboratory analysis. Fig. 11 presents the error plotting of Fe for the three benches.
It is also observed from the error plotting values that the bench 5 has the maximum prediction error with mean of error and variance of error of 1.55 and 41.76, respectively. It may be due to the presence of a number of the BHQ band along with the blue hematite, where the selected color features provide almost same value for both the type of the sample, which leads to wrong prediction of ore grade. It is seen from the error plot that the bench 8 produces less grade variation which is due to consistent lithology found in that bench. The geological study of those benches confirmed that these zones have single ore type (steel gray hematite) which restricts the error of prediction within a reason-able limit. The validation study revealed that the developed model can be applied for ore grade prediction at a regular basis at the mine. 5. Sensitivity of the model
It is observed from the study that the proposed feature selection method for ore grade prediction of iron ore using image analysis techniques has performed well. However, these results do not guarantee that the proposed method will perform equally well for other types of deposits. Therefore, to check the effectiveness of the proposed method, the algorithm was tested on a different data set.
The limestone data set ( Chatterjee et al., 2009 ) was used for this purpose. The same feature extraction and feature selection method as described in this paper was used to extract and select features. The calcium oxide (CaO) was used as the parameter for this study.
In this limestone data, it was observed that 34 numbers of selected features were optimum for CaO grade prediction. The performance of the developed model was tested by comparison of our results with the results of Chatterjee et al. (2009) with same testing data set. The results, as presented in Table 2 , revealed that the proposed approach not only performed significantly well but also out-performed the results of Chatterjee et al. (2009) . Therefore, it can be summarized that the proposed feature selection algorithm can significantly reduce the number of features, thus reduce the time and cost of feature selection and at the same time improve the performance of the ore grade prediction model. 6. Conclusion
In this paper, a vision-based quality monitoring model was proposed for day to day quality parameter measurement in a mineral industry. A vision-based mineral grade estimation technique will be a veryusefulinmineplanningduetoitscosteffectiveness.Inthispaper,a neural networks model was develo ped by supervised learning with genetic algorithms based feature selection algorithm. The images were captured in a controlled environment. Some well known image features were extracted from the segmented rock images. A total number of 39 features was selected from extracted 189 image feature by hybrid GA X  X N model.

The performance of the developed model was tested with a testing data set and results revealed that the model is a good predictor for iron ore grade with R 2 value of 0.8. The developed vision-based model was then applied in a real application at three different locations in the mine. The grade monitoring studies at three face locations showed that the model-based grades are in good agreement with the actual grades for most of the samples at all three locations except a few points with large deviations.
Thesensitivityoftheproposedmethodwastestedbyapplyingit on a limestone deposit. The results revealed that proposed method also performed equally well for the limestone deposit. The com-parative study also demonstrated that the proposed method has outperformed the already developed method. Prediction Error (%) Prediction error (%) thesinglesampleimagewerecalculatedbyaveragingofthefeature values from different segmented rocks. However, all the image features are not always additive in nature. Therefore, if the chemical analysis is performed for individual segmented rock objects instead of whole sample, and modeling is done based on the chemical analysis value and image features of individual segmented objects, it is expected that the performance of the model may be improved.
 different types of experimental set up, one has to calibrate the model withknownsamplegradevalues.Itisalsotruethatthesamenumberof features and same type of features has to be selected for all types of minerals; however, number of selected features using genetic algo-rithm may be different as it is experienced through this study (for iron ore 39 features and for limestone 34 features were selected). The fundamental approach will be the same for all types of minerals. References
