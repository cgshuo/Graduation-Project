 Cluster analysis groups a set of objects in such a way that objects in the same cluster are more similar with each other than with those in other clusters. In this paper we consider clustering temporal data, and focus on how to model the tree-like evolutionary trace of clusters over time.
 nomenon for temporal data, such as dynamic topics in text collections, evolution publications for example, with the development of scientific research, new topics emerge and obsolete topics die. Moreover, topics can evolve and branch into several topics, e.g. , the topic of social network has developed many branches, evolving trace of clusters over time is like a tree, where a cluster constantly evolves and branches new clusters.
 Compared with the traditional clustering tasks, modeling tree-like evolution-ary traces meets new challenges. First, evolution of clusters (birth, death and a result, parametric clustering models are improper for this task as they require setting the number of clusters manually. Second, the distribution (popularity) and parameters of clusters are dynamic over time. The model should be able to catch the temporal features of clusters and smooth them over time. Third, for the evolutionary tree of clusters, the number of branches is uncertain. But we still need to control the scale of branches; otherwise the evolutionary trace recovered shall be incomprehensible.
 A handful of temporal clustering models have been proposed to exploit the of topics over time, so they are widely used for clustering evolutionary temporal data. One of the representative work is Recurrent Chinese Restaurant Process (RCRP) [ 2 , 3 ] proposed by Ahmed et.al. RCRP can capture the birth/death of clusters and similar clusters of adjacent epochs form cluster chains. How-ever, RCRF falls short in modeling nonlinear evolutionary patterns because each topic is allowed to have only one variant. Other nonparametric temporal models ture of clusters, there are lots of works on modeling the evolution parameters. Previous schemes for modeling the evolution of cluster parameters are generally designed for chain-like evolutionary trace, e.g., DTM [ 6 ] and SNDTM [ 2 ]. They are difficult to be extended to more complicated case like trees. In summary, to the best of our knowledge, none of existing methods can handle all the challenges mentioned above.
 In this paper, we propose an Evolving Chinese Restaurant Process (ECRP) which can model the tree-like evolutionary trace in temporal data. In the set-ting of ECRP, temporal collections are divided into epoches. To model cluster branching over time, ECRP lets each cluster in current epoch form a Chinese Restaurant Process (CRP) and uses the combination of cluster-specific CRPs as clusters. Moreover, ECRP can model dependence of clusters X  distribution over time. On the top of ECRP, we adopt conjugate prior cascade scheme to model the clusters X  parameter evolution, which can model cluster parameter evolution for tree-like structure. We also design an online learning framework based on Gibbs sampling to infer evolutionary traces of clusters over time. Clustering with ECRP enjoys the following merits. First, our method can model the birth, branch and death of clusters. Second, our method allows easy learning incrementally with the online learning framework. In experiments, we demonstrate that ECRP can capture tree-like evolutionary traces of clusters on real-world data sets and outperform the state-of-the-art methods. settings and reviews necessary backgrounds. Section 3 introduces the Evolving Chinese Restaurant Process and the learning framework. Section 4 conducts experiments. We survey the related work in Section 5 and conclude the paper in Section 6 . In this section, we first introduce the problem settings and then briefly review the Chinese Restaurant Processes (CRP) to make the paper self-contained. 2.1 Problem Settings In this paper, temporal data are split into epochs. n t denotes the number of data in the t th epoch, and x t,i denotes the i th datum in epoch data are assumed to be partially exchangeable, i.e., data within an epoch are exchangeable but cannot be exchanged across epoches. we let cluster associated with data x t,i .Foracluster k in epoch denoted as  X  t,k . And the set of {  X  t,k } define the unique clusters. We assume that the cluster can emerge, branch and die over time. Our goal is to discover the tree-like evolutionary traces of clusters in { X 1 ,  X  X  X  , 2.2 Chinese Restaurant Process CRP is a stochastic process which can model the generation of unbounded num-ber of clusters for static data sets. CRP is specified by a base distribution and a positive real number  X  called the concentration parameter. The generative process of CRP is described by imagining a restaurant serving with infinite number of tables. In this metaphor, a customer corresponds to a datum x ; and a table  X  corresponds to a cluster (as depicted in Figure 1 ). And the process of a customer picking a table corresponds to generating a datum for a cluster. CRP proceeds as follows. When a customer comes into the restaurant, he chooses a table. The probability of choosing the table n , which denotes the number of customers that already sit around the table. While there is nonzero probability, which is proportional to picks an empty table  X  K + . Picking a new table corresponds the creation of a new cluster. The parameter of the cluster is generated as limit of  X   X  0, the data are all concentrated on a single cluster, while in the limit of  X   X  X  X  , each datum forms a cluster all by itself. The process can be summarized as: Where  X  i is the cluster chosen by the i th datum. The value of the datum sampled from  X   X  i .
 In summary, CRP can describe the generation for static data set with an unbounded number of clusters. In the next section, we present the ECRP process which extends CRP for modeling temporal data and mining tree-like evolution-ary trace behind clusters. Then we present how to model the evolution of cluster parameters. Finally, an online learning framework based on Gibbs sampling is presented. 3.1 Evolving Chinese Restaurant Processes The key to discover tree-like evolutionary traces is to model cluster branching. In ECRP, we let each cluster form a CRP for the next epoch, so a cluster can branch multiple variants in the next epoch. And we adopt the posterior of parent cluster as the base measure for the cluster specific CRP so as to smooth the cluster parameter over time. In the sequel, we present the generation procedure of ECRP.
 ECRP is operated in epoches. Let G t denote the distribution of clusters and their parameters in epoch t . As a time-varying variable, emerges as a orphan cluster, G t contains two parts. The first part is which can generate branch clusters. For generating a datum  X  t, X  t,i . In summary, ECRP can be formally defined as follows, where  X  t  X  1 ,k and  X  t,O are the weights of CRPs.
 remain unsettled. First, how to determine the weight of CRPs, i.e.,  X  t,O . Second, what X  X  the marginal distribution for a datum X  X  cluster selection  X  t,i based on the Weight of CRPs in ECRP. Because the larger a cluster is, the more branches it tends to possess. We assume that the weight of CRP (  X , H is proportional to the number of records which serve dish weight of the DP (  X , H ), i.e.  X  t  X  1 ,O , is proportional to with  X  t  X  1 ,k and  X  t,O instantiated, as in Eq.( 3 ).
 where  X   X  [0 , 1] is a decaying factor which influences the smoothness of cluster popularity over time. Specially, for t =0, G 0 is constructed in the same way as CRP.
 Marginal Distribution of  X  t,i . The marginal distribution for the data X  X  clus-data in epoch t  X  1and t , i.e.  X  t  X  1 ,  X  and  X  t, 1  X  X  X  as in Eq.( 4 ) Where O t is the set of orphan clusters. And CRP (  X , H  X  t  X  1 ,k as in Eq.( 5 ):  X  |  X  where S t  X  1 ,k is the set of variants of  X  t  X  1 ,k .
 ent in two aspects. First, the base measure H in CRP (  X , H don X  X  have specific knowledge about it, so a vague prior is preferred. While, the parameter of an variant cluster tends to be similar with its parent. Second, the concentration factor  X  in CRP (  X , H ) is larger than Because a larger concentration factor leads to more clusters generated by the CRP. The number of variants for a cluster is generally small, while that of an orphan cluster is often large.
 Combining Eq.( 3 , 4 , 5 ), the marginal distribution of  X  Eq.( 6 ),  X  |{  X  +
R 3.2 Modeling Evolving Cluster Parameters We adopt the conjugate prior cascade to model the evolution of clusters X  param-eters in ECRP. Because in Bayesian model, the hyper-parameters of a conjugate prior corresponds to having observed a certain number of pseudo observations with properties specified by the parameters [ 11 ]. And data in ancestor clus-ters can serve as pseudo observations for the current cluster. So for a cluster, Furthermore, the posterior of the current cluster can be fetched by absorbing manner, given H and observations, the posterior of clusters can be calculated in a cascaded manner. In the conjugate prior cascade, a decaying factor Evolving Parameter for Temporal Texts. Here we present an evolving topic model for text collections to illustrate the evolution of cluster parameters in ECRP.
 For topics (clusters) in text collections, the parameter is the word distribu-tion. We only care about the prior and posterior of the clusters. In the cascade, both of them take the form of Dirichlet distribution. The parameter of Dirich-let corresponds to the count of words. The prior for orphan topics is set to its parent with a decaying factor  X  . So the prior for topic written as in Eq.( 7 ): Algorithm 1. The online learning framework for ECRP.
 as in Eq.( 8 ), 3.3 Model Inference We employ Markov Chain Monte Carlo (MCMC) methodology to estimate the states of the sampler contain both the cluster indicator for every datum atively sample their states until convergence. Note that {  X  as described in Section 3.2 . So in this part, we focus on sampling Sampling Cluster Indicator  X  t,i . For a datum x t,i , conditioned on parameter of clusters and cluster assignments for other data, its cluster indicator where  X  t,  X  i denotes the set of  X  t,  X  without  X  t,i ,and of  X  3.4 Online Learning Framework It is widely admitted that model learning from online data, such as text col-lections, is computationally demanding. However, ECRP can be incrementally updated and meet the need of online applications.
 In the above Gibbs sampling algorithm, the samplers solely depend on the mation propagated from epoch t + 1. So we can learn an evolutionary trace of {
X 1 ,  X  X  X  , X t } without considering { X t + 1 ,  X  X  X } .For X previous clusters and appending new clusters, instead of relearning the model from scratch. The incremental learning framework is presented in Algorithm 1 . Although the number of temporal data can be infinitely large, for each epoch we only need to handle the newly arrived data. So this framework is efficient for online applications. In this section, we test ECRP w.r.t. its capability of recovering evolutionary traces from real-world text collections. To this end, we conduct the following tests. First, we compare ECRP with the state-of-the-art clustering models, and demonstrate the superiority of ECRP. Second, we use ECRP to analyze the NIPS data set, and demonstrate that ECRP can recover interesting evolving patterns of data. Note that with minor modification on parameter evolution scheme, ECRP can also analyze various types of temporal data sets. 4.1 Experiment Settings Measures. We use the metric of perplexity for evaluating performance of clus-We compute perplexity as in [ 13 ]. 10% of each document is randomly sampled to create a test set while the remaining is used for training. The training set is used for learning model parameters while the test set is held out to compute the perplexity. Low perplexity indicates that model can precisely model user behaviors. Formally, the perplexity is defined as: Benchmarks. We compare ECRP with the following clustering models.  X  CRP [ 15 ]: CRP is a nonparametric clustering model. CRP can only analyze static data set.  X  Dynamic Topic Model (DTM) [ 6 ] : DTM is an extension of LDA for modeling temporal data;  X  Recurrent CRP (RCRP) [ 2 ] : RCRP is an extension of CRP for temporal data, where the clusters over time are organized as linear chains;  X  Distance Dependent CRP (dd-CRP) [ 4 ] : dd-CRP is a nonparametric  X  Incremental Gibbs Sampler (IGS) [ 10 ] : IGS can infer connection of Data Sets. We conduct experiments on three publicly available data sets which are widely used for benchmark. All data sets can be downloaded online. Table 1 summarizes the statistics of the data sets.
 Setting of Parameters. The hyper parameters of ECRP were set as follows: H = Dir (10 ,  X  X  X  , 10), and (  X  =0 . 1 , X  =10  X  4 , X  =0 . 3 Gibbs sampler for 2000 iterations in each epoch. 4.2 Results Method Comparison. Figure 2 compares the perplexity of the clustering result on difference data set. We find that on average ECRP outperforms other meth-ods. The reasons are two folds. First, compared with the parametric Bayesian models, such as DTM, ECRP can learn proper number of topics for each epoch, so data can be more properly clustered. Second, compared with other temporal nonparametric topic model, such as RCRP and dd-CRP, the tree-like evolution-ary trace recovered by ECRP is more close to the actual pattern of temporal data. Another benefit of ECRP is that the parameter can be properly smoothed as each cluster is assigned with a proper prior.
 NIPS Dataset. We used the ECRP to analyze the NIPS collections. The results to be contained in a single graph, we plot partial result in 3 .(e). We can spot birth, branch and death of topics over time. For example, we can spot that after 1988, the topics of image had two branches: feature extraction and MRF . Compared with the clustering result given by RCRP models where topics are organized as chains (as depicted in Figure 3 .(f)), ECRP can discover interesting connections between topics.
 With ECRP, we also mined some interesting knowledge about NIPS data set. Figure 3 .(a) shows that the number topics grew over time, which confirms with our intuition that originally NIPS focused on the topic of neural network and gradually it branched into multiple topics and imported topics from other fields. Figure 3 .(b) shows the average KL distance between the parameter of topics between the parent topics and their variants. The value high above the average distance between the popularity of topics of adjacent epoches. It can be noticed that for the epoch where KL distance high above the average, the number of orphan topics is large. Figure 3 .(d) plots evolvement of topics popularity. Note topics of each era and their evolving trend over time. Combine these indexes, we can find important eras for the development of NIPS. Nonparametric Temporal Clustering Models. We have mentioned that the number of clusters manually. RCRP [ 2 ] is an extension of CRP for tem-Besides RCRP, there were also many other nonparametric temporal clustering tion of the Dirichlet process. In this construction, data are generated with an infinite mixture model, where each mixture component had a weight associated with it. Coupling the weights (some also coupling component parameters) of nearby model state resulted in a form of dependency between them. However, without a proper description of generation of cluster parameters, it was hard to model clusters with tree-like evolutionary pattern. There were also lots para-this paper, we have demonstrated that parametric models are not suitable for modeling dynamic temporal data.
 Hierarchical Clustering Model (HCM). Our work also got inspiration from clustering problem. HCM aimed to model hierarchical structure within group of data, while ECRP focused on modeling the evolutionary trace of data over time. Blei et al. proposed the nested Chinese restaurant process (nCRP)[ 5 ], which assumed that a group of data can be divided into clusters and each cluster can be further divided into smaller clusters recursively. All these clusters were While in ECRP, variant cluster is similar but probabilistically independent to its parent and sibling clusters. nCRP had achieved great success in analyzing prior design for modeling parameter evolution in ECRP.
 tried to model the evolutionary pattern of clusters. Due to the limited space, their details are not discussed. In this paper, we studied a new challenging problem of modeling tree-like evo-lutionary traces of clusters behind temporal data. We presented a new Evolving Chinese Restaurant Process (ECRP for short) to model tree-like evolutionary traces. ECRP not only can recover evolutionary trees of topics efficiently, but also can capture temporal features such as number of topics, popularity of top-ics and parameters of topics. Also, we designed an online learning framework for ECRP so as to handle unbounded temporal data. Experimental results on real-world data sets demonstrated the performance of the proposed method.
