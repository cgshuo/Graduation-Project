 Since the beginning of neuromorphic engineering [1, 2] designers have had great success in build-ing VLSI 1 neurons mimicking the behavior of biological neurons using analog circuits [3 X 8]. The design approaches are quite different though, as the desired functions constrain the design. It has been argued [4] whether it is best to emulate an established model or to create a new one using analog circuits. The second way is gone by [3 X 7] for instance, aiming at the low power consump-tion and fault tolerance of neural computation to be used in a computational device in robotics for example. This can be done most effectively by the technology-driven design of a new model, fitted directly to biological results. We approach gaining access to the computational power of neural sys-tems and creating a device being able to emulate biologically relevant spiking neural networks that can be reproduced in a traditional simulation environment for modeling. The use of a commonly known model enables modelers to do experiments on neuromorphic hardware and compare them to simulations. This design methodology has been applied successfully in [8, 9], implementing the conductance-based integrate-and-fire model [10]. The software framework PyNN [11, 12] even al-lows for directly switching between a simulator and the neuromorphic hardware device, allowing modelers to access the hardware on a high level without knowing all implementation details. The hardware neuron presented here can emulate the adaptive exponential integrate-and-fire neuron model (AdEx) [13], developed within the FACETS-project [14]. The AdEx model can produce complex firing patterns observed in biology [15], like spike-frequency-adaptation, bursting, regular spiking, irregular spiking and transient spiking by tuning a limited number of parameters [16]. Completed by the reset conditions, the model can be described by the following two differential equations for the membrane voltage V and the adaptation variable w : C m , g l , g e and g i are the membrane capacitance, the leakage conductance and the conductances for excitatory and inhibitory synaptic inputs, where g e and g i depend on time and the inputs from other neurons. E l , E i and E e are the leakage reversal potential and the synaptic reversal potentials. The parameters V t and  X  t are the effective threshold potential and the threshold slope factor. The time constant of the adaptation variable is  X  w and a is called adaptation parameter. It has the dimension of a conductance.
 If the membrane voltage crosses a certain threshold voltage  X  , the neuron is reset: The parameter b is responsible for spike-triggered adaptation. Due to the sharp rise, created by the exponential term in equation 1, the exact value of  X  is not critical for the determination of the moment of a spike [13]. Figure 1: Phase plane of the AdEx model with parameters according to figure 4 d) from [16], stimulus excluded. V and w will be rising below their nullclines and falling above.
 Figure 1 shows the phase plane of the AdEx model with its nullclines. The nullcline of a variable is the cline, where its time derivative is zero. The crossing off the nullclines in the left is the stable fix-point, where the trajectory is located in rest. A constant current stimulus will lift the V -nullcline. For V &gt; V t below the V -nullcline, the derivative of V is proportional to V -the exponential dominates and V diverges until  X  is reached.
 The neuron is integrated on a prototype chip called HICANN 2 [17 X 19] (figure 2) which has been produced in 2009. Each HICANN contains 512 dendrite membrane ( DenMem ) circuits (figure 3), each being connected to 224 dynamic input synapses. Neurons are built of DenMem s by shorting their membrane capacitances gaining up to 14336 input synapses for a single neuron. The HICANN is prepared for integration in the FACETS wafer-scale system [17 X 19] allowing to interconnect 384 HICANN s on an uncut silicon wafer via a high speed bus system, so networks of up to 196 608 neurons can be emulated on a single wafer.
 A major feature of the described hardware neuron is that the size of components allows working with an acceleration factor of 10 3 up to 10 5 compared to biological real time, enabling the operator to do several runs of an experiment in a short time to do large parameter sweeps and gain better statistics. Effects occurring on a longer timescale like long term synaptic plasticity could be emulated. This way the wafer-scale system can emerge as an alternative and an enhancement to traditional computer simulations in neuroscience. Another VLSI neuron designed with a time scaling factor is presented in [7]. This implementation is capable of reproducing lots of different firing patterns of cortical neurons, but has no direct correspondence to a neuron from the modeling area. 2.1 Neuron The smallest part of a neuron is a DenMem , which implements the terms of the AdEx neuron de-scribed above. Each term is constructed by a single circuit using operational amplifiers ( OP ) and operational transconductance amplifiers ( OTA ) and can be switched off separately, so less complex models like the leaky integrate-and-fire model implemented in [9] can be emulated. OTA s directly model conductances for small input differences. The conductance is proportional to a biasing cur-rent. A first, not completely implemented version of the neuron has been proposed in [17]. Some simulation results of the actual neuron can be found in [19].
 Figure 3 shows a block diagram of a DenMem . During normal operation, the neuron gets rectangular shaped current pulses as input from the synapse array (figure 2) at one of the two synaptic input circuits. Inside these circuits the current is integrated by a leaky integrator OP-circuit resulting in a voltage that is transformed to a current by an OTA . Using this current as bias for another OTA , a sharply rising and exponentially decaying synaptic input conductance is created. Each DenMem is equipped with two synaptic input circuits, each having its own connection to the synapse array . The output of a synapse can be chosen between them, which allows for two independent synaptic channels which could be inhibitory or excitatory.
 The leakage term of equation 1 can be implemented directly using an OTA , building a conductance between the leakage potential E l and the membrane voltage V .
 Replacing the adaptation variable w in equation 2 by a ( V adapt  X  E l ) , results in: Now the time constant  X  w shall be created by a capacitance C adapt and a conductance g adapt and we get: We need to transform b into a voltage using the conductance a and get where the fixed t pulse is the time a current I b increases V adapt on C adapt at each detected spike of a neuron. These resulting equations for adaptation can be directly implemented as a circuit. A MOSFET 3 connected as a diode is used to emulate the exponential positive feedback of equation 1 difference between the membrane voltage and a voltage V t by an adjustable factor. A simplified version of the circuit can be seen in figure 4. The gate source voltage of M1 is : Deployed in the equation for a MOSFET in sub-threshold mode this results in a current depending exponentially on V following equation 1 where  X  t can be adjusted via the resistors R 1 and R 2 . The factor in front of the exponential g l  X  t and V t of the model can be changed by moving the circuits V . To realize huge (hundreds of k  X  ) variable resistors, the slope of the output characteristic of a MOSFET biased in saturation is used as replacement for R 1 .
 Our neuron detects a spike at a directly adjustable threshold voltage  X  -this is especially necessary as the circuit cannot only implement the AdEx model, but also less complex models. In a model without a sharp spike, like the one created by the positive feedback of the exponential term, spike timing very much depends on the exact voltage  X  .
 A detected spike triggers reseting of the membrane by a current pulse to a potential V reset for an adjustable time. Therefore our circuit supports basic modeling of a refractory period additionally to the modeling by the adaption variable. 2.2 Parameterization In contrast to most other systems, we are using analog floating gate memories similar to [20] as storage device for the analog parameters of a neuron. Due to the small size of these cells, we are capable of providing most parameters individually for a single DenMem circuit. This way, matching issues can be counterbalanced, and different types of neurons can be implemented on a single chip enhancing the universality of the wafer-scale system.
 Table 1 shows the parameters used in the implemented AdEx model and the parameter ranges aimed during design. Technical biasing parameters and parameters of the synaptic input circuits are ex-cluded. Parameter ranges of several orders of magnitude are necessary, as our neurons can work in different time scalings relative to real time. This is achieved by switching between different mul-tiplication factors for biasing currents. As these switches are parameterized globally, ranges of a parameter of a neuron group(one quarter of a HICANN ) need to be in the same order of magnitude. As a starting point for for the parameter ranges, [13] and [21] have been used. The chosen ranges allow leakage time constants  X  mem = C mem /g l at an acceleration factor of 10 4 between 1 ms and 588 ms and an adaptation time constant  X  w between 10 ms and 5 s in terms of biological real time. modes, the regime for a biologically realistic operation is reduced as the needed time constants are shifted one order of magnitude.
 As OTA s are used for modeling conductances, and linear operation for this type of devices can only be achieved for smaller voltage differences, it is necessary to limit the operating range of the variables V and V adapt to some hundreds of millivolts. If this area is left, the OTA s will not work as a conductance anymore, but as a constant current, hence there will not be any more spike triggered adaptation for example.
 A neuron can be composed of up to 64 DenMem circuit hence several different adaptation variables with different time constants for each are allowed. 2.3 Parameter mapping For a given set of parameters from the AdEx model, we want to reproduce the exact same behavior with our hardware neuron. Therefore, a simple two-steps procedure was developed to translate biological parameters from the AdEx model to hardware parameters. The translation procedure is summarized in figure 5: The first step is to scale the biological AdEx parameters in terms of time and voltage. At this stage, the desired time acceleration factor is chosen, and applied to the two time constants of the model. Then, a voltage scaling factor is defined, by which the biological voltages parameters are multiplied. This factor has to be high enough to improve the signal-to-noise ratio in the hardware, but not too high to stay in the operating range of the OTA s.
 The second step is to translate the parameters from the scaled AdEx model to hardware parameters. For this purpose, each part of the DenMem circuit was characterized in transistor-level simulations using a circuit simulator. This theoretical characterization was then used to establish mathematical relations between scaled AdEx parameters and hardware parameters. 2.4 Measurement capabilities For neuron measuring purposes, the membrane can be either stimulated by incoming events from the synapse array -as an additional feature a Poisson event source is implemented on the chip -or by a programmable current. This current can be programmed up to few  X  A r eplaying 129 10 bit values using a sequencer and a digital-to-analog converter. Four current sources are implemented on the chip allowing to stimulate adjacent neurons individually. Currently, the maximum period of a current stimulus is limited to 33  X  s , but this can be easily enhanced as the HICANN host interface allows an update of the value storage in real time.
 The membrane voltage and all stored parameters in the floating gates can directly be measured via one of the two analog outputs of the HICANN chip. Membrane voltages of two arbitrary neurons can be read out at the same time.
 To characterize the chip, parameters like the membrane capacitance need to be measured indirectly using the OTA , emulating g l , as a current source example. Different firing patterns have been reproduced using our hardware neuron and the current stimulus in circuit simulation and in silicon, inducing a periodic step current onto the membrane. The examined neuron consists of two DenMem circuits with their membrane capacitances switched to 2 pF each. Figure 6 shows results of some reproduced patterns according to [23] or [16] neighbored by their phase plane trajectory of V and V adapt . As the simulation describes an electronic circuit, the tra-jectories are continuous. All graphs have been recorded injecting a step current of 600 nA onto the membrane. g adapt and g l have been chosen equal in all simulations except tonic spiking to facilitate the nullclines: As described in [16], the AdEx model allows different types of spike after potentials (SAP). Sharp SAPs are reached if the reset after a spike sets the trajectory to a point, below the V-nullcline. If reset ends in a point, above the V-nullcline, the membrane voltage will be pulled down below the reset voltage V reset by the adaptation current.
 The first pattern -tonic spiking with a sharp reset -can be reached by either setting b to a small value and shrinking the adaptation time constant to make V adapt follow V very fast -at least, the adaptation constant must be small enough to enable V adapt to regenerate b in the inter-spike interval (ISI)-or by setting a to zero. Here, a has been set to zero, while g l has been doubled to keep the total conductance at a similar level. Parameters between simulation and measurement are only roughly mapped, as the precise mapping algorithm is still in progress -on a real chip there is a variation of transistor parameters which still needs to be counterbalanced by parameter choice.
 Spike-frequency adaptation is caused by enlarging V adapt at each detected spike, while still staying below the V-nullcline (equation 9). As metric, for adaptation [24] and [16] use the accommodation index: Here k determines the number of ISI excluded from A to exclude transient behavior [15, 24] and can be chosen as one fifth for small numbers of ISIs [24]. The metric calculates the average of the difference between two neighbored ISIs weighted by their sum, so it should be zero for ideal tonic spiking. For our results we get an accommodation index of 0  X  0 . 0003 for fast spiking neurons in simulation and  X  0 . 0004  X  0 . 001 in measurement. For adaptation the values are 0 . 1256  X  0 . 0002 and Figure 6: Phase plane and transient plot from simulations and measurement results of the neuron stimulated by a step current of 600 nA . 0 . 039  X  0 . 001 . As parameters have been chosen to reproduce the patterns obviously (adaptation is switched of for tonic spiking and strong for spike frequency adaptation) they are a little bit extreme in comparison to the calculated ones in [24] which are 0 . 0045  X  0 . 0023 for fast spiking interneurons and 0 . 017  X  0 . 004 for adapting neurons.
 It is ambiguous to define a burst looking just at the spike frequency. We follow the definition used in [16] and define a burst as one or more sharp resets followed by a broad reset. The bursting results can be found in figure 6, too. To generate bursting behavior, the reset has to be set to a value above the exponential threshold so that V is pulled upwards by the exponential directly after a spike. As can be seen in figure 1, depending on the sharpness  X  t of the exponential term, the exact reset voltage V r might be critical in bursting, when reseting above the exponential threshold and the nullcline is already steep at this point. The AdEx model is capable of irregular spiking in contrast chaotic spiking capability of the AdEx model has been shown in [16]. In Hardware, we observe that it is common to reach regimes, where the exact number of spikes in a burst is not constant, thus the distance to the next spike or burst may differ in the next period. Another effect is that if the equilibrium potential -the potential, where the nullclines cross -is near V t , noise may cause the membrane to cross V t and hence generate a spike (Compare phase planes in figure 6 c) and d) ). Figure 6 shows tonic bursting and phasic bursting. In phasic bursting, the nullclines are still crossing in a stable fix point -the resting potential caused by adaptation, leakage and stimulus is below the firing threshold of the exponential.
 Patterns reproduced in experiment and simulations but not shown here are phasic spiking and initial bursting. The main feature of our neuron is the capability of directly reproducing the AdEx model. It is neither optimized to be low power nor small in size in contrast to postulations by Livi in [6]. Nevertheless, it is low power in comparison to simulation on a supercomputer (estimated 100  X  W in comparison to 370 mW on a Blue Gene/P [26] at an acceleration factor of 10 4 , computing time of Izhikevich neuron model [23] used as estimate.) and does not consume much chip area in comparison to the synapse array and communication infrastructure on the HICANN (figure 2). Complex indi-vidual parameterization allows adaptation onto different models. As our model is working on an accelerated time scale of up to 10 5 times faster than biological real time, it is neither possible nor wanted to interact with systems relying on biological real time. Instead, by scaling the system up to about a million neurons, it will be possible to do experiments which have never been feasible so far due to the long duration of numerical simulations at this scale, i.e. allowing large parameter sweeps, dense real-world stimuli as well as many repetitions of experiments for gaining statistics. Due to the design approach -implementing an established model instead of developing a new model fitting best to hardware devices -we gain a neuron allowing neuroscientist to do experiments without being a hardware specialist. The neuron topology -several DenMem s are interconnected to form a neuron -is predestined to be enhanced to a multi-compartment model. This will be the next design step.
 The simulations and measurements in this work qualitatively reproduce patterns observed in biology and reproduced by the AdEx model in [16]. A method to directly map the parameters of the AdEx quantitatively to the simulations has already been developed. This method needs to be enhanced to a mapping onto the real hardware, counterbalancing mismatch and accounting for limited parameter resolution.
 Nested in the FACETS wafer-scale system, our neuron will complete the universality of the system by a versatile core for analog computation. Encapsulation of the parameter mapping into low level software and PyNN [12] integration of the system will allow computational neural scientists to do experiments on the hardware and compare them to simulations, or to do large experiments, currently not implementable in a simulation.
 Acknowledgments This work is supported in part by the European Union under the grant no. IST-2005-15879 (FACETS).
 References
