 1. Introduction various threat attempts. Intentional biochemical contamination has become a major concern recently due to the potential hazard to human health and the inherent complexities of the contami-nants as well as the system. The installation of well-designed monitoring stations is necessary to detect the contamination and enhance the response capability. Rapid and accurate character-ization of contaminant sources, once detected, is critical for managing an accidental or intentional WDS contamination event.
The process of contaminant source determination involves not only the rapid identification of the injection locations but also the characterization of start time, duration and magnitude of con-taminants to effectively control the spread of contamination as well as remediating the contaminated area. However, insufficient data and countless possible contamination scenarios can pose challenge to the characterization process in terms of both accu-racy and efficiency.
 fication problems have been recommended by several researchers.
The approaches reported previously can be classified into two categories. The first one employs direct sequential and simulta-neous methods (e.g., van Bloemen Wannders et al., 2003 ; Laird et al., 2005 , 2006 ). The second category couples a search procedure with a WDS hydraulic and water quality simulation package. One such approach, introduced by Guan et al. (2006) , links the reduced gradient method with the WDS simulation to identify contaminant sources. Another simulation-optimization approach, proposed by Liu et al. (2006) , uses a multiple population-based EA to search for a set of contaminant source characteristics that may result in similar sensor observations. Preis and Ostfeld (2007 , 2008) described a straightforward approach for contaminant source identification by coupling EPANET simulator with a genetic algorithm. Zechman and Ranjithan (2009) investigated evolution strategy (ES)-based approach and suggested ways to best structure the algorithm to solve this class of problem. Overall, increasing attention has recently been attracted to heuristic search methods due to the complexity of such a problem, such as discreteness, nonlinearity, non-convexity as well as non-uniqueness. More recently, some new methods have been reported to enhance the solution efficiency and allow practical application, such as Perelman and Ostfeld (2010) , Shen and McBean (2010) , etc.

Heuristic search methods have their potential in tackling such complex optimization problems by incorporating simulation mod-els. However, such a method results in increased computational burden because of a large number of time-consuming simulation runs needed to evaluate potential solutions. In particular, it poses challenges to a large network in terms of the identification time as well as the solution quality, even using parallel or distributed computing implementations. Computational requirements may be reduced by using a prescreening technique that eliminates infea-sible solutions to reduce a priori the decision space in which the heuristic procedure must search. One such prescreening method is the back-tracking algorithm reported by De Sanctis et al. (2006 , 2010) , with the aim of identifying all possible locations and times that explain contamination incidents detected by water quality sensors. Di Cristo and Leopardi (2008) proposed an approach using the pollution matrix concept to determine a group of candidate nodes that could explain discrete solute concentration measure-ments. Another approach, proposed by Neupauer et al. (2010) , identifies the probability density functions of possible prior times when the observed contamination was at any upgradient node. Logistic regression model (LRM) is another potential prescreening approach that shows promise, which has been investigated by Liu et al. (2011) to estimate the probability of each node being a candidate source node. The use of LR analysis would provide a more suitable tool due to its computational efficiency and the ability to describe source characteristics allowing for various uncertainties associated with the contamination event. Although the knowledge of potential source locations from the LRMs assists decision makers in isolating the source hydraulically from larger network, estimation of release history is required to identify potential extent of contamination, thus reducing public exposure in the contaminated area ( De Sanctis et al., 2006 , 2010 ). Therefore, subsequent to the LR analysis, heuristic search meth-ods (e.g., EAs) could be considered to further refine the identifica-tion solutions. EAs discover global optima independently of initial guesswork through a population-based scheme and particular operators (e.g., crossover, mutation); however, as the population gradually moves towards optimal solutions, the efficiency of EAs typically decreases due to the stochastic property of the search process ( Gen and Chen, 1997 ; Xu et al., 2001 ). In contrast, local search (LS) approaches, such as the Nelder X  X ead Simplex (NMS) and the Hooke X  X eeves pattern search method, focus mainly on locating locally better solutions by using a deterministic strategy, even though these methods are somewhat sensitive to the initial starting points. Hart (1994) and Land (1998) discuss the advan-tages of such LS procedures for determining the optima in a quick and computationally efficient manner when the search is focused on a local region.

In this study, nongradient-based LS algorithms are examined as the heuristic search method due to the computational effi-ciency. Considering that the quality of LS solutions depends on the quality of the starting solution to these iterative search procedures, it is desirable that the smaller set of candidate nodes identified by the LR approach will serve as a set of good starting solutions for the subsequent LS procedure. Thus, the overall procedure investigated in this paper consists of: (1) a LR analy-sis-based prescreening and (2) a LS technique-based optimization. These components are described in the following subsections. 2. Problem statement and solution techniques 2.1. LR analysis for estimating potential contaminant source locations
The WDS contaminant source identification is challenged by the high degree of uncertainties resulting from numerous possible injection scenarios, unknown water consumption at demand nodes, and errors inherent to measurements and models. To offer a fast probabilistic estimation of candidate source locations, a linear LRM-based approach has been reported in Liu et al. (2011) to model the likelihood that any given node is a source. The LRM, constructed as follows, describes the relationship between the probability of node i as a source and the observations at time t once the contamination is detected at one or more sensors log p  X  A i 1 p  X  A i 9 C 1  X  t  X  , ... , C N  X  t  X  X  !  X  X  b j  X  i , t  X  C j  X  t  X  X  X  b N  X  i , t  X  C N  X  t  X  ,  X  1  X  nant introduced at node i given the observations at time t ; A represents the contaminant entering through node i ;( C 1 C ( t )) are the sensor observations at time t ; and ( b 0 ( i , t ), are regression coefficients for node i at time t obtained by the maximum likelihood procedure. The LRMs are pre-established to describe the contaminant as a function of available measure-ments using a large number of hypothetical contamination simulations. Once established, using these LRMs can lead to fast estimation of candidate source nodes once the contamination is detected. The strength of the LRM is that it offers a simple and direct way to make a fast prediction with low computation costs.
Additional procedural details and application results for example problems are described by Liu et al. (2011) . In this study, the resulting candidate source locations from the LRMs are used to reduce the space of subsequent searches by eliminating unneces-sary nodes that have estimated zero probabilities of being source locations. 2.2. LS approach for WDS contaminant source characterization
After identifying the set of candidate contaminant source locations, heuristic search methods are used to enhance the identification accuracy by determining the optimal characteristics (i.e., injection location, start time and loading history) of the contaminant sources. The objective is to minimize the difference (i.e., the error) between the simulated concentration values and the observed concentration values at the sensors. The following mathematical formulation describes a form of the error function that is minimized by the search method Find L , M t c , T 0
Minimize F  X  where F is the prediction error; L is the contamination source of contamination; t c is the current time; M t c  X f m T 0 represented as a vector of mass injected at the source from time T t , denotes the contaminant mass loadings; C obs it is the observed concentration at sensor i at time t ; C it  X  L , M t c , T
EPANET) calculated concentration value at sensor i at time t ; i is the sensor location; t is the observation time; and N s is the total number of sensors.

The nongradient-based LS method used to solve this optimiza-tion problem in the present paper is the Nelder X  X ead Simplex (NMS) search, introduced by Nelder and Mead (1965) , with the aim of estimating the contaminant release history that corre-sponds to each candidate source node prescreened by the LRMs.
The scheme of the NMS method is to exploit local information and direct the search towards the optimal or near-optimal solutions by replacing the worst vertex with the newly found better vertex in an adaptive manner through iterations. The algorithm termi-nates if the stopping criterion is reached. A detailed description of the NMS method can be found in Nelder and Mead (1965) . 2.3. Coupling the LRM with the LS for contaminant source characterization combined LRM and LS method for WDS contaminant source characterization, using a linked simulation-optimization techni-que. Fig. 1 shows a schematic representation of the proposed
LRM X  X S method. The algorithm begins once contamination is initially detected (by any observed concentration value C 4 0) at one or more monitoring sensors. Given the monitored data, the pre-established LRMs provide a quick estimation of the likelihood that a given node is the contaminant injection location. The estimated probabilities ( p ) are used to screen out the set of nodes that does not yield contaminant concentration profiles to match sensor measurements (0.01% is used as the threshold in this study). The remaining set of nodes is then used as a basis for the subsequent NMS-based LS procedure. For each candidate source location, the LS procedure searches for the additional source characteristics (i.e., contaminant injection start time, duration, and mass loading profile). At every stage of iteration, the evalua-tion of vertices is based on the prediction error by running
EPANET simulation. The LS operation for each candidate node at each time interval terminates when one of the following stopping criteria is met: (1) no improvement is made in the best solution in a specified number of successive iterations, and the minimal prediction error is less than a specified value; and (2) the number of iterations reaches the maximal value allowed. As more observed date become available, the LRM X  X S process is repeated over time. At each time step, this procedure leads to a set of possible solutions that is able to match the sensor observations within a specified range of prediction error. With increasingly available measurements, the set of candidate nodes obtained from the LRMs is composed of the nodes that have the probability value greater than the threshold at the previous time steps as well as the current time step. Therefore, the set of alternatives reduces in number, and eventually reaches a single solution when sufficient sensor information is available. The identified single solution or a set of alternatives is expected to contain the true source characteristics. The algorithm terminates when one poten-tial source node or no additional measurements remain.
As a local optimizer, the NMS method focuses mainly on the exploitation rather than the exploration of the search space, which contributes to the sensitivity of its performance to initial starting points. It is imperative to introduce a certain level of diversity, particularly in the case of such an adaptive problem as the WDS (e.g., water consumption and network operations) and the observed data are continually changing. Accordingly, a re-initialization strategy is incorporated into the NMS operation to appropriately introduce necessary randomness and diversity. This step is conducted on the vertices except the current optimum when new data becomes available or the search converges to a small region of the decision space with a high average prediction error (i.e., the local search gets stuck in a local optimum). This process, as expected, reduces the degree of sensitivity of the LS to the initial starting points and attempts to achieve both the exploitation and diversification during the search. 3. Case studies
The application of the proposed LRM X  X S method to two example networks is discussed in this section. The first example focuses on examining the performance and robustness of the LRM X  X S method considering variations in contaminant source characteristics as well as the amount and quality of the monitor-ing data. The second example is used to test and demonstrate the applicability of the LRM X  X S method to a relatively large network that poses greater challenges in solving the source characteriza-tion problem.
 Hydraulic and water quality simulations are generated using EPANET; it is assumed that the hydraulics are at a steady state during each hour, and that the hydraulics are calculated at hourly intervals and the contaminant transport at 10-min intervals. Synthetic sensor measurements are noted at 10-min increments. Contaminant source characteristics are recovered on the assump-tion that a conservative contaminant is injected at one location under a known water demand condition. These assumptions are made primarily to enable a convenient and viable investigation of the proposed approach; however, they are not expected to limit the broader applicability of the approach to problems with conditions that do not fall within these assumptions.

The effectiveness of the LRMs in identifying candidate source locations has been demonstrated in Liu et al. (2011) . The LRMs established previously are then used here to create a set of alternative candidate source nodes for which the NMS method-based LS procedure is applied to search for the optimal contami-nant injection profile at each candidate source node. Table 1 lists the allowable ranges of contaminant source parameters used for the local search.
 3.1. Small example network
The first network (Example 3 in EPANET), depicted in Fig. 2 , consists of 97 nodes, 117 pipes, 2 water sources (1 river and 1 lake), and 3 tanks. The base demands and the mean temporal variations of the 24-h demand pattern assigned to all the nodes are assumed to be those described in the network input file for this network in EPANET. Four sensors as shown in Fig. 2 are assumed to be active in this network. 3.1.1. Contamination scenarios
To examine the performance of the LRM X  X S method, it was first applied to five contamination events with different source characteristics. The description of these hypothetical events is provided in Table 2 , and the injection locations of the contami-nant are shown graphically in Fig. 2 .

The LRMs predict the probability of the node being the contamination injection location given the observations at each time interval. Nodes with a probability value greater than the threshold (i.e., 0.01%) at all time steps up to the current one are chosen as potential source nodes. Table 3 provides the number of possible injection nodes after different elapsed times since the time of first detection. Scenarios 2 and 3 are observed to have fewer candidates compared to the other scenarios. The NMS method-based LS search was employed at each likely node to identify the optimal contaminant injection profile. The following parameters associated with the NMS method were used: the simplex is formed using four vertices according to the number of decision variables, and the NMS method is applied for up to 30 iterations at each time step corresponding to 10-min observation interval. To gain statistical significance, 30 random trials (i.e., 30 sets of initial solutions forming the simplex) were performed in each scenario, and the results are reported in terms of the average value computed from the solutions obtained for 30 random trials ( Tables 4 X 6 and Fig. 3 ). The characterization results are summar-ized in Table 4 . The average computation time of each random trial was approximately 7 min on the Neptune system (an Opteron cluster) where EPANET simulations were executed in parallel on six 2.2-GHz processors.
 five scenarios. Reported results are compared with the true source location after collecting 3-h of measurements. With regard to the accuracy of the source characteristics, the proposed approach results in good estimates for Scenarios 1, 2, and 3, whereas a relatively poor performance is observed in Scenarios 4 and 5. The discrepancies result mainly from the contaminant injection loca-tion in the network. It is interesting to note that Scenario 4 has the lowest prediction error, despite its higher inaccuracy in the prediction of source characteristics. This behavior reflects that the lowest prediction error does not always signify the best perfor-mance. In addition, the rank of the true source location was compared for the five scenarios, as listed in Table 4 . Potential source nodes were ranked according to the prediction errors. The node with the smallest prediction error was assigned the first rank. It is expected that the true source node is ranked first.
Scenarios 1, 2 and 3 than for Scenarios 4 and 5. The reason for this might be that insufficient observation data did not allow the true source location to be distinguished from the other nodes in
Scenarios 4 and 5. Additionally, the study focused mainly on the degree to which non-uniqueness var ies with different contaminant characteristics. Non-uniquenes s was quantified in terms of the number of alternative solutions. A solution was determined as an alternative when the prediction is within a target value of the lowest prediction error; this was calculated based on the minimal predic-tion error at the optimal node multiplied by a relaxation value (1.5 in this study). Similar to the performance with respect to rank of the injection node, Scenarios 4 and 5 resulted in a larger number of alternatives. From the generated results of the five scenarios, it is worth noting that the LRM X  X MS procedure is capable of recovering thetruesourcenodeasanalternativesolution. 3.1.2. Sensitivity to sensor data uncertainty utilities operators to access real-time or near real-time data, the quality of the collected measurements is a major factor that impacts identification uncertainty. Binary decision sensors are more likely to be installed in the network. To better understand the effect of noise in monitoring data on identification uncertainty, two additional experiments were conducted based on Scenario 1.
The first experiment simulates the scenario using uncertain mea-surements. A normally distributed white noise was added to the measured concentration data, and the mathematical formulation for modeling the noise with perturbation is expressed as follows: y it  X  y it  X  a n y n it N  X  0 , 1  X  ,  X  3  X  where y it err denotes the perturbed measurement of sensor i at time t ; y denotes the measurement of sensor i at time t ;and a represents the error level added to the perturbed factor (0.1 in this example). In the second experiment, the sensors were assumed to output a binary signal to indicate whether contaminant is present or not. For simplicity, a fixed concentration level was specified as the sensor detection threshold (0.1 mg/L is assumed in this example). Then, the simulated concentration data were translated to a 0/1 signal according to the specified threshold.

The results of Scenario 1 under the ideal, noisy, and binary sensor conditions were compared and are summarized in Fig. 3 and Table 5 . Fig. 3 summarizes the mean of the number of alternatives over 30 random trials at different elapsed times. The results indicate that fewer alternatives were identified as the measurement uncertainty decreases. Also, it is noted that the true injection node does not always rank first with respect to the prediction errors. Therefore, one of the most valuable aspects of this proposed approach is that simultaneous searches at multiple locations yield a set of solutions that can help resolve non-uniqueness in identifying the source characteristics.

Over time, however, the number of alternatives did not decrease consistently with increasingly available measurements. This lack of consistency may be explained by the fact that the contaminant source characterization is a dynamic process whereby the observation data is updated dynamically. Each time a new set of observations become available, the time for con-vergence varies depending on the degree of change the new observations represent.

The results reported in Table 5 correspond to the injection node and number of alternatives when 3 h have elapsed since the first detection. The contaminant source is characterized more accurately in the first two cases due to a lower level of uncer-tainty than in the other cases. Although the addition of a 10% measurement error results in slightly smaller prediction errors compared to those under the ideal condition, a larger number of alternative solutions is evident. In addition, it must be noted that the differences in the possible source locations obtained from the LRMs among these three conditions are very small. 3.1.3. Monte Carlo simulation
In this section, the performance of the proposed approach is further evaluated using 50 hypothetical contamination events. These events were simulated by randomly varying the contami-nant characteristics, including injection location, start time, dura-tion and strength. The varying source parameters and their specified ranges are listed in Table 1 . For each arbitrarily simulated contamination event, the LRM X  X S method was executed for one trial and the summary of the performance measures across all the events at different elapsed times since the first detection are presented in Fig. 4 . It is observed that the average rank of the true injection location, based on the prediction error values, approaches one as time goes on. Similarly, the correlation coefficient of x and y coordinates of the true source node and the node identified as the best solution becomes closer to one as the elapsed time increases. Overall, the results indicate the robustness of the LRM X  X S method for a number of random contamination events. 3.2. Comparisons of algorithm performance between LRM-NMS and LRM-ES
In this section, the sensitivity of the results is evaluated in terms of the difference in the search methods (e.g., NMS vs. ES). To demonstrate the advantage of the LS over global search methods for such a problem, the algorithm performance evalua-tion of LRM-ES is added and compared. After identifying a smaller set of candidate nodes by LRMs, the subsequent search is focusing on a local region. As a global optimizer, the ES typically becomes less efficient when the search concentrates on a local region. This is due to the stochastic property of the search process. In contrast, the NMS focus mainly on locating locally better solutions by using a deterministic strategy. For fair comparisons, ( m  X  l )-ES, was applied to the Scenario 1 described above and the parameters used consist of 4 parents ( m ) and 4 mutants ( l ), and the number of generations is 30 at each 10-min interval for one candidate node. The results of these two strategies for Scenario 1 averaged over 30 random trials are summarized in Table 6 . The reported results correspond to the true source location after collecting 3-h of measurements again. When considering the solution accuracy, it can be noted that LRM-NMS procedure improves the solution quality significantly: the prediction error is reduced to 0.02 mg/L and the rank of true source node is much closer to 1. The last line of Table 6 presents the number of alternative solutions identified by these two strategies. Larger number of alternatives represents higher degree of solution non-uniqueness and uncertainty. From the presented results, the LRM-NMS procedure yields less alter-native solutions than the LRM-ES. This provides more insight into the benefit of the LRM-NMS strategy and further demonstrates that the NMS as a hill-climber typically perform more efficiently than ES. 3.3. Micropolis example network To illustrate the applicability of the LRM X  X S method to a larger WDS network, a second network was studied, as shown in Fig. 5 . The entire system contains 1574 junctions, 1415 pipes, 8 pumps, 2 reservoirs, and 1 tank. This network was developed for the micropolis virtual city with 5000 residents, further details of which can be found in Brumbelow et al. (2007) . Fig. 5 also shows the location of the five sensors assumed to be active in the cases studied here as well as one hypothetical contamination scenario.

A contamination event was simulated in this network, with the contaminant injection at node IN1646 (denoted by a triangle in Fig. 5 ). At 10:00 a.m. the contaminant entered the network at the rate of 60 g/min, and the event lasted an hour. Given the five monitoring sensors, the detection occurred initially at sensor S5 at 12:30 p.m. and lasted until 1:40 p.m. The LRMs identified 167 solutions out of 409 nodes that could contribute to observations at the given sensor locations. Fig. 5 illustrates candidate nodes with respect to the first set of observations. It is worth noting that these possible sources are relatively close to the true source, one of which is the true injection node. Subsequent to the LRM-based prescreening, multiple NMS-based LS operations were conducted to seek the optimal release history at each corresponding node identified by the LRMs. At 1:40 p.m., after the last set of measurements was taken, a unique solution identified matched the true source node, start time, duration and the mass loading exactly.

In this study, one of the main interests was to discover the number of alternatives and their distribution with variations given the measurement quality. Similar to the previous case study, and in addition to the ideal sensor condition, a 10% level of random noise was added to the measured data. Again, the target for the alternatives was the minimal prediction error across all the potential source nodes multiplied by a relaxation value (1.5). Results reported here correspond to the last measurement time step. Under the ideal sensor condition, a unique solution at the true injection node was determined. However, in the case with reduction in data quality (i.e., 10% level of random noise added), the resulting alternatives increased to eight. This finding implies that the uncertainties associated with measurements contribute to the complexity of source identification. Fig. 6 (a) presents the location of alternative solutions predicted with data obtained up to 1:40 p.m., one of which was located at the true source node. In addition to the differences in injection locations, these solutions varied in their starting time, duration, and magnitude of contaminant, as shown in Fig. 6 (b). In spite of such differences, Fig. 6 (c) indicates a good agreement between the observed and predicted concentration profiles for eight solutions at sensor S5. No abnormal measurements were obtained from the other four sensors up to 1:40 p.m. It is interesting to note that the obtained alternatives clustered around the true injection node. This information may be valuable for decision makers in locating the region of interest and estimating the potential extent of contamination. Additionally, the actual computation time of each random trial was around 45 min on the Neptune system (an Opteron cluster) using six 2.2-GHz processors to run EPANET simulations in parallel. 4. Summary
Detecting and characterizing a contamination event as it occurs requires an algorithm that can accurately and quickly locate the contaminant X  X  injection node as well as its release history. Specifically, this study concentrates on the LRM X  X S procedure to seek contamination characteristics. Whereas the LRMs facilitate the removal of unlikely nodes as the sources, the S3 S2 0 50 100 150 200 250 300 12:00 PM 12:30 PM 1:00 PM 1:30 PM 2:00 PM subsequent LS procedure enables the efficient characterization of the contaminant in the localized region. Applications of the LRM X  LS method to two example WDS networks include not only various contamination scenarios but also impose variations on the quality of the monitoring sensors.

The results suggest that the LRM X  X S method is capable of adaptively discovering not only contaminant source locations but also their corresponding release histories. Simultaneous searches at multiple locations assist in evaluating the degree of non-uniqueness and accordingly reduce the possibility of misidentifi-cation. The identification accuracy is impacted by the location of the contaminant, monitoring data, and the network size. It is worth mentioning that the true source node does not always rank first (in terms of prediction error values) among candidate nodes. This phenomenon becomes more significant when the uncer-tainty is increased due to insufficient observations, coarse mon-itoring data, unknown water consumption, or a larger network. However, this study shows that the identified solutions typically concentrate in the vicinity of the true source location. Addition-ally, the solutions generated by the LRM-NMS are compared to the results of the LRM-ES. By conducting nearly equal number of objective function evaluations, the LRM-NMS is demonstrated to be more efficient in locally identifying the contaminant source characteristics and resulting in lower degree of solution uncer-tainty. Overall, the advantage of this approach is that the combined LRM X  X S strategy offers a simple, direct and rapid estimation of the contaminant source. Not only does this algo-rithm adaptively yield information on optimal contaminant source characteristics (the selection of the source location as well as the other source characteristics), but it also can assess the degree of non-uniqueness in the solutions.

Finally, it is straightforward to extend the proposed method to solve more complex problems, such as reactive contaminants, multi-source contamination, and assist in the application to more realistic WDS contamination events. Whereas the two case studies did not take into account the uncertainty in the hydraulic model, the procedure described is applicable to the instances with these uncertainties as the use of LRMs provides decision makers with a suitable tool to define the robust solutions. To ensure the robustness of LRM X  X S for the application to actual WDS contam-ination events, the future research should incorporate the uncer-tainties on the hydraulic model, the system as well as sensor measurements into the process of generation of LRMs. To avoid unnecessary computational efforts, further exploration could give consideration to establishing the candidate set from both the LRMs and the LS considering that the LRMs commonly yield a large set of candidate nodes. For example, future work could consider that likely injection locations typically are close to the true injection node ( Hill et al., 2006 ). This is due to the difficulty in distinguishing adjacent nodes given the sparse observed data. Thus, a node close to the current optimum is worth further investigation, even with a high prediction error. Conversely, a node with a high prediction error that is far away from the current optimum may necessarily be eliminated from the candi-date set if the contaminant is assumed to be introduced from a single location, which would further reduce the computational burden associated with the LS.
 Acknowledgements
This work is supported by National Science Foundation (NSF) under Grant no. CMS-0540316 under the DDDAS program and the Fundamental Research Funds for the Central Universities under Grant no. 2010HGBZ0560.
 References
