 Traditionally click models predict click-through rate (CTR) of an advertisement (ad) independent of other ads X . Recent researches however indicate that the CTR of an ad is depen-dent on the quality of the ad itself but also of the neighbor-ing ads. Using historical click-through data of a commer-cially available ad server, we identify two types (competing and collaborating) of influences among sponsored ads and further propose a novel click-model, Full Relation Model (FRM), which explicitly models dependencies between ads. On a test data, FRM shows significant improvement in CTR prediction as compared to earlier click models.
 H.3.3 [ Information Storage and Retrieval ]: Information Search and Retrieval Sponsored Search, Click Models, Collaborating and Com-peting Influence
Influence among ads. The target of click models [1, 2, 4, 5, 6, 7, 8, 9, 11, 12, 13] is to understand the click-through data by analyzing users X  behaviors, in order to get better CTR prediction. Originally, most click models treat each ad independently, while recent work [10] demonstrates that the ads are correlated among each other, and incorporating competing influence within ads into click models would ob-tain better performance [11]. As shown in Figure 1 (left), consider to estimate the CTR of the first ad, denoted as ad under three different cases. The quality of the second ad is denoted by an integer from 1 to 5 (1 is the lowest quality and 5 is the highest). In original click models, the influence among the ads would not be considered. Consequently, the estimation of ad 1  X  X  CTR should be the same in all the three cases. Nevertheless, if the competing influence among ads is considered, the CTR of ad 1 in Case 1 would be smaller than that in Case 2; and the CTR of ad 1 in Case 3 would be larger than that in Case 2. Because following the competing hypothesis, when an ad is displayed with a high-quality ad, its CTR will be decreased; and when it is displayed with a low-quality ad, its CTR will be increased. The intuitive meaning is that the co-occurred high-quality ad will attract some of the users X  attention from ad 1 .

Limitation of previous work. Although previous work has identified the effect of competing influence, through fur-ther investigation in real-world data, we identify a novel ob-servation that would make click models with only competing influence fail to work. The observation is that the compet-ing influence does not always take effect; and under some cases, its opposite, the collaborating influence takes more effect. Consider Scenario 2 in Figure 1. In this scenario, the qualities of the second ad are all below average. If we follow the competing influence, the CTR of ad 1 in Case 3 will be smaller than the CTR of ad 1 in Case 4. However, from statistics in real-world dataset, the opposite observa-tion is true. We have found the CTR in Case 3 will be larger than that in Case 4 in most cases. This is a kind of collab-orating influence, which means when an ad occurs with a high-quality ad, its CTR will be increased and when an ad occurs with a low-quality ad, its CTR will be decreased. An intuitive psychology interpretation could be found from the authority fear [3] phenomenon. It means that users treat the search engines as experts, and do not like to challenge it. However, if an ad is co-occurred with a very low-quality ad, the trust would be destroyed. This will reduce the click chance of the first ad. By further demonstration from data analysis, we will show when the qualities of the co-occurred ads are above average, the competing influence takes more effect; however, when the qualities of the co-occurred ads are below average, the collaborating influence takes more effect. This observation indicates that only incorporating the competing influence will fail to work under the second condition.

Motivation and Contributions. To solve the above limitation, it is natural to incorporate both competing and collaborating influences into the click model. This moti-vates our work in this paper. The main contributions of this paper lies in: 1) we identify the competing and collaborat-ing influence among ads; and 2) we propose a novel click model, which considers both collaborating and completing influences, and the model outperforms previous ones signif-icantly.
We will define and identify the competing and collaborat-ing influence in this section. The dataset information would be presented in the later experiment part. The relation be-tween two ads would be discussed first for clearness. The generalization would be designed in the algorithms.
As shown in Figure 1, suppose the average CTR of ad 1 in all the cases is CT R avg ( ad 1 ), and the CTR of ad 1 impressed with a special ad ad 2 is CT R ad 2 ( ad 1 ).
Definition 1 (negative effect). ad 1 has obtained a negative effect from ad 2 if and only if
Definition 2 (positive effect). ad 1 has obtained a positive effect from ad 2 if and only if
One question is what will result in the negative and pos-itive effects? Do ads compete with each other? Do ads collaborate with each other? Or do competing and collab-orating relations occur together but with different strength in different cases? This is the fundamental problem to be discussed in this session.

Definition 3 (quality). The quality of an ad to a certain query is the probability of clicking the ad on the con-dition of having examined it, denoted as p ( C = 1 | E = 1)
This definition is utilized to remove the position-bias in the relationship between a query and an ad. Under this definition, the competing and collaborating influences are defined as follows.

Definition 4 (competing). ad 2 would have an com-peting influence to ad 1 if and only if
Definition 5 (collaborating). ad 2 would have an col-laborating influence to ad 1 if and only if means what the CTR of ad 1 would be if ad 2 is replaced with a little higher-quality ad. Therefore, we could see that if ad has a competing influence to ad 1 , the higher quality ad the lower CTR ad 1 would get; and if ad 2 has a collaborating influence to ad 1 , the higher quality ad 2 is, the higher CTR ad 1 would get.
The indirect identification is designed as follows. If the ads compete with each other, the higher the quality of the co-occurred ad is, the more chance the current ad gets negative effect; and if the ads collaborate with each other, the higher the quality of the co-occurred ad is, the more chance the current ad gets positive effect. In the statistics, we gather sessions with the same first two ads, making the first ad the current ad and the second one the co-occurred ad. Totally, 700 , 942 gathered sessions are collected. Then we rank the gathered sessions according to the quality of the second ad, approximated by the CTR of the second ad. We divide the ranked sessions into 15 bins with equal size. In each bin, we make statistics about the percentage of the sessions that have the positive effect, and draw the result in Figure 2.
If the ads compete with each other, the result should be a single trend from top to bottom; and if the ads collaborate with each other, the result should be a single trend from bot-tom to top. However, as shown in the figure, the result first goes up and then goes down. This means that both collabo-rating and competing influences exist among ads. When the quality of the co-occurred ad is below average, the collabo-rating influence takes more effect; and when the quality of the co-occurred ad is above average, the competing influence takes more effect.
To directly identify the effect of competing and collaborat-ing influences, we conduct the following data analysis. An ad ad 1 is shown in the first position with different ads in the sec-ond position. When it is shown with ad 2 a , the CTR of ad CT R 2 a ( ad 1 ) and the CTR of ad 2 a is CT R ( ad 2 a ); and when it is shown with ad 2 b , the CTR of ad 1 is CT R 2 b ( ad the CTR of ad 2 b is CT R ( ad 2 b ). If we consider the compet-ing influence, we should have ( CT R 2 a ( ad 1 )  X  CT R 2 b of ad 2 a is better than ad 2 b , the CTR of ad 1 would be de-creased. In the same way, if we consider the collaborating influence, we should have ( CT R 2 a ( ad 1 )  X  CT R 2 b ( ad ( CT R ( ad 2 a )  X  CT R ( ad 2 b )) &gt; 0.

In the statistics, we collect 10 , 356 data samples. Each data sample contains a first ad and two co-occurred second ads. We rank all the data samples according to the quality of the co-occurred ad (the average of the two ads at the second position). In the ranked list, we divide the data samples into 19 bins. The first bin has the lowest quality and the last bin has the highest. For each data sample in a bin, we calculate the value of ( CT R 1 a  X  CT R 1 b )  X  ( CT R 2 a  X  CT R 2 b each bin, we make statistics about the percent of positive values divided by the total data sample size in a bin. We draw the percent values of different bins in Figure 3.
If there is no influence among the ads, the value in all these bins should around 0 . 5; if there is competing influence, the value should below 0 . 5; and if there is collaborating influ-ence, the value should be above 0 . 5.

From the figure, it can be observed that the result drops down as the quality of co-occurred ad increases. When the quality of co-occurred ad is above average, the result is below 0 . 5. This means the ads show more competing influence, which is consistent with previous work [11]. However, when it is below average, the result is above 0 . 5. This means that the collaborating influence takes more effect under this case. This can demonstrate that the collaborating influence does exist in the ads. It takes more effect when the quality of the co-occurred ad is below average.

These two identifications have shown that both compet-ing and collaborating influences exist among ads. Previous work [11], however, only identifies and utilizes the compet-ing influence. Thus when the quality of the co-occurred ad is below average, the model would fail to work.
In this paper, we propose the full relational model (FRM) to incorporate both collaborating and competing influences. The user behavior of FRM is shown in Figure 4. Before ex-amining the ads in detail, we assume that the user skims all the ads first. In the skimming process, the user is supposed to do the following two steps. Figure 4: User behavior of the full relational model.
The first is to see whether he/she is interested in examin-ing the ads. If the user is not interested in the ads, he/she would leave at once without any further examination. The interested issue would be determined by the overall relevance of all the ads. We define the probability of  X  X nterested X  as Therefore, the collaborating influence could be modeled in this step. If the qualities of all of the ads to the query are good enough, the probability of being interested would be larger; or otherwise, it would reduce the probability for further examination.

The second is to re-ranked the ads according to the value of w i  X  r i . r i is defined as r i = p ( C i = 1 | E i = 1). w constant, which denotes a global weight for the ad at posi-tion i . Intuitively, since the position-bias exists, the ad at the latter position should outperform the previous one by a certain margin to win the priority of being examined. Under this assumption, if an ad is much more relevant than others, it would take the first chance to be examined. Consequently, the competing influence among the ads is modeled by this step.

In designing the model, a fact should be considered that when the quality of the co-occurred ad is below average, the collaborating influence would take more effect; and when it is above average, the competing influence would take more effect. Thus we propose to utilize a heuristic way to solve 1), when x is small, the increasing speed of f ( x ) is high; and when x is larger, the increasing speed becomes lower. This means that if we change the probability of  X  X nterested X  to the strength of the collaborating influence would be weak-ened when the value is above the average; and it would be strengthened then below the average. The competing influ-ence would take more effect in the former case, and would be the opposite in the latter case, which is just as expected.
After these two steps, the ads in the re-ranked list are assumed to be examined as previous click models.

In the learning process, the parameters for estimation in-clude r ,  X  , and w . For simplicity, w is set empirically.  X  would be estimated based on the maximum log-likelihood method similar to [6]. In the following, we would introduce how to estimate r in detail.
We utilize the Bayesian estimation to learn r . Suppose for an query-ad pair with r , it occurs at different positions in a set of sessions X 1 , ..., X U . According to Bayes X  X  rule, we have p ( r | X 1: U ) = p ( X p ( X 1: U | r ) =
Y n (0)1 denotes the ads that are examined by the user but are not clicked, and n (0)0 denotes the ads that are not examined by the user thus are also not clicked. If the user clicks an ad, he/she must has already examine the ad, thus the probabil-has examined the ad, the probability is p ( E k 2 = 1)  X  (1  X  r ); or otherwise if the user does not examine the ad, the prob-ability is 1  X  p ( E k 2 = 1).

In the formula, p ( E = 1) could be calculated by utilizing the current r in the system. In this paper, for ad that has not enough evidences to estimate r , we utilize features (such as the category average CTR, etc.) to predict the value. We suppose in the re-ranked list, ad i  X  is in position i . For the i th position, we could have
The main problem is to determine n (0)1 and n (0)0 . If the user has not clicked an ad, we do not know whether he/she has examined it. To solve this problem for simplicity, we utilize a sampling trick to sample these hidden variables in the calculation according to p ( E = 1). We have Thus we sample a random number from 0 to 1. If it is smaller than p ( E  X  i = 1 | C  X  i = 0), we put it into n (0)1 ; or otherwise, we put it into n (0)0 .

After sampling n (0)1 and n (0)0 , we have p ( r | X 1: U ) = p ( X Thus, p ( r | X 1: U ) follows beta distribution. By utilizing the expectation of beta distribution, we could have The dataset we utilized is the click-through log from AT&amp;T. It is collected from September 1st 2011 to September the 15th 2011. In the search engine, when a user submit a query, 6 slots are available for ads impression. Totally, there are 2 , 339 , 992 sessions with 11 , 419 , 160 ad impressions. Over 67% of the sessions have full six ads. There are 197 , 119 unique queries and 1 , 408 , 009 unique ads.

We utilize the area under receiver operating characteristic (ROC) curve as our metric. We calculate the ROC under two scenarios. In the first scenario, we divide the queries into 5 groups, from the most infrequent to the most frequent queries. For each groups, we use the ads in all positions to calculate the ROC value. In the second scenario, we use the ads in all queries, but divide them into 6 groups according to their positions, from the top to bottom.
 The baseline method we utilized is an average-based method. In this method, we utilize constants to model the probabil-ity of examination at different positions. The competitive methods we utilized for comparison are the CCM model and the TCM model.
Table 1 shows the overall performances of different algo-rithms with different query sets. Table 2 shows the overall performances with different positions. The first observation is that TCM constantly outperforms the CCM and the base-line method. This demonstrates that the TCM model is ef-fective in modeling the competing influence among ads and effective in improving the performance. The second obser-vation is that FRM constantly outperforms the TCM. The main reason is that when the quality of co-occurred ad is below average, the collaborating influence, rather than the competing influence, takes more effect. Thus previous TCM model cannot perform well under such cases. For FRM, it considers both collaborating and competing influences, thus it would perform better. This result demonstrates that the FRM is effective in modeling both kinds of influences. The improvement of our proposed model is significant. Com-pared with the competitive model CCM, the improvements in different configurations are from 2 . 5% to 7 . 5%. Espe-cially, from Table 2, we could see that the proposed model is very effective in improving the performance for the lower positions.
In this paper, we investigate how to improve click models by utilizing the influence among ads. Through real-world data analysis, we identify that the competing influence only takes effect when the qualities of co-occurred ads are above the average, and when the qualities of those are poor, its op-posite, collaborating influence would take more effect. We propose a novel click model to incorporate both collaborat-ing and competing influences. Through experimental veri-fication, the proposed model has a significant improvement compared with previous work.
The work described in this paper was supported by a grant from the Research Grants Council of the Hong Kong Special Administrative Region, China (Project No. CUHK 415311 and No. CUHK 415210), a Google Focused Grant Project under  X  X obile 2014 X  and a grant from Beijing Key Labora-tory of Intelligent Information Technology in BIT.
