 We survey the progress in the analysis of gene expression data for the purposes of disease subtype diagnosis, new sub-type discovery, and understanding of diseases and treatment responses. We find existing works fall short on several is-sues: these works provide little information on the inter-play between selected genes; the collection of pathways that can be used, evaluated, and ranked against the observed ex-pression data is limited; and a comprehensive set of rules for reasoning about relevant molecular events has not been compiled and formalized. We thus envision an advanced in-tegrated framework, and are developing a system based on it, to provide biologically inspired solutions. It comprises: (i) automated analysis and extraction of information from biomedical texts; (ii) targeted construction of known path-ways; and (iii) direct hypothesis generation based on logical reasoning on, and tests for, consistencies and inconsistencies of observed data against known pathways. Classification of patient samples is a crucial aspect of cancer diagnosis and treatment, as treatment of this type of diseases is often stratified according to the specific disease subtype and the likely treatment response of the patient. For exam-ple, childhood acute lymphoblastic leukaemia (ALL), has as many as 6 different subtypes with differing treatment out-come. Under-treatment causes relapse and eventual death. Over-treatment causes severe long-term side effects. Thus accurate diagnostic subgroup must be assigned upfront to ensure correct intensity of therapy [33]. One of us previ-ously demonstrated a very accurate platform based on gene expression profiling analysis to risk stratify childhood ALL patients [41]. We can see from Figure 1 the tremendous promise of this work X  X urvival rates are increased, side ef-fects are reduced, and significant cost savings are achieved. There is thus considerable excitement in the development of gene expression profiling analysis for the purposes of under-standing diseases and optimizing treatment.
 In this paper, we first provide in Section 2 a succinct but in-depth review of existing gene expression analysis meth-ods. Our survey spans techniques for disease subtype di-agnosis, disease subtype discovery, and treatment response understanding. In particular, we describe the progress in ap-proaches to gene selection, paying special attention to more recent developments such as overlap methods [42; 8], direct group methods [40; 22], and biological network co-clustering methods [38; 15; 14; 37; 13; 18; 39; 35].
 Then we discuss in Section 3 critical issues remaining in the effective analysis of gene expression data X  X iz., these works provide little information on the interplay between se-lected genes; the collection of pathways that can be analysed against the observed gene expression data is limited; and a comprehensive set of rules for reasoning about relevant mole-cular events has never been compiled and formalized. We outline our vision for an advanced integrated system that is required to directly address these issues.
 Finally, we present in Section 4 our preliminary work to realise the vision. In particular, we are developing an inte-grated system having the capabilities to: (i) automate analy-sis and extraction of information from biomedical texts, (ii) automate targeted construction of known pathways and cir-cuits, and (iii) reason logically and test for consistencies and inconsistencies of observed data with respect to known path-ways and circuits. We hope to enable more biologically in-spired interpretations of gene expression profiles, so as to better decipher the underlying causes of a disease, and the reasons for a drug to be effective or ineffective. We summarize here accomplishments of the past with re-spect to gene expression analysis for the purposes of diag-nosing disease subtypes (Subsection 2.1), discovering new disease subtypes (Subsection 2.2), and understanding the genetic and molecular causes of a disease (Subsection 2.3). Each disease and its various subtypes have their underly-ing causes, which may have different down-stream effects that are useful as diagnostic indicators. These down-stream effects are often manifested as consistent gene expression profile differences in a large number of target genes over the different disease subtypes. The recognition of gene expres-sion profile differences, and their use for diagnosing disease subtypes, has thus become an intensely researched topic. The main approach to this problem is that of supervised learning, as illustrated by the classic paper of Golub and colleagues [12]. The gene expression profiles of patients are collected and labeled according to the disease subtype of the patients. The analysis then proceeds in two main steps. In the first step, those genes that are most differentially ex-pressed or most associated to specific disease subtypes are identified. In the second step, a supervised learning algo-rithm is applied to the expression profiles of genes short-listed in the first step to induce a classifier. The resulting classifier is then used for predicting the disease subtypes of future patients based on their gene expression profiles. A wide variety of test statistics have been proposed for the first step to select relevant genes, which appears to be the more challenging of the two steps. Initially, classical test sta-tistics such as t-statistics, 1  X  2 , and Wilcoxon rank sum test are used. As the number of genes far exceeds the number of samples in typical datasets, more elaborate gene selection test statistics are also developed, such as rank products [5] and sparse logistic regression [6], as well as techniques for assessing false discovery rates [34]. Integrated methods [28; 11], typically involving grouping genes with correlated ex-pression profiles into bins and then selecting representatives
The t -statistics of a gene g given two sets P and N of gene expression profiles of patients in two contrasting classes P and N is defined as: where  X  ( g, P ) and  X  ( g, N ) are the mean expression values of gene g in P and N respectively,  X  2 ( g, P ) and  X  2 ( g, N ) are the variances of the expression values of gene g in P and N respectively. Typically those g where t ( g | P, N ) &gt;  X  , for some threshold  X  , are considered significantly differentially expressed and are used as feature vectors to train a classifier to distinguish P and N samples. from each bin, have also been used. One of the more inter-esting recent developments in gene selection techniques is to look for gene pairs with expression values that are highly correlated [32], instead of considering a single gene at a time. This is a reasonable technique because genes and their prod-ucts generally function as a group in a specific pathway, and thus they expression values should be correlated. An excellent demonstration of this type of analyses is the diagnosis of childhood acute lymphoblastic leukemia (ALL) subtypes [41]. ALL is the most common form of childhood cancer. It has as many as 6 different subtypes. To avoid under-treatment, which causes relapse and eventual death, or over-treatment, which causes severe long-term side ef-fects, accurate diagnostic subgroup must be assigned up-front so that the correct intensity of therapy can be deliv-ered to ensure that the child is accorded the highest chance for cure [33]. Yeoh et. al. [41] first use  X  2 statistics to se-lect genes that are most associated with each of the ALL subtypes, and then use a support vector machine to learn a classifier for the ALL subtypes from the expression profiles of the selected genes. Their classifier achieves an exceedingly accurate overall diagnostic accuracy of 96%. New diseases and subtypes may emerge over time. A clini-cian generally detects the emergence of such cases when he is unable to assign a known phenotype to a patient using traditional procedures such as morphology, immunopheno-typing, cytogenetics, and molecular diagnostics. Such a new disease subtype may manifest itself at the gene expression level. The recognition of distinguishing gene expression pro-files from untyped samples has thus become an important research topic in bioinformatics.
 The main approach to this problem is that of unsupervised learning, as illustrated by the classic work of Cheng and Church [7], although it was not initially used for detecting new disease subtypes. The gene expression profiles of pa-tients are collected, including both patients of known sub-types and unknown subtypes. The analysis then proceeds in two steps. In the first step, those genes whose expres-sion values do not exhibit sufficient variance are removed. In the second step, a biclustering algorithm is applied on the patients and the remaining genes to obtain clusters of patients that share similar expression profiles on the remain-ing genes. If a cluster mostly contains untyped patients, it is inferred as a new subtype of the disease, and the gene expression profile shared by these patients is proposed as a distinguishing marker for this new subtype.
 A large number of clustering methods have been proposed for the second step of this problem [30; 7; 10; 29; 26], which appears to be the more challenging of the two steps. As gene expression data are typically arranged as a matrix, with rows as genes and columns as patient samples, the goal of biclustering is to identify  X  X omogeneous X  subma-trices from such an input matrix. However, there are many ways to define homogeneity X  X .g., biclusters with constant values, biclusters with coherent values, and so on. Most of the biclustering methods applied for this problem design their own measure of homogeneity. As such, they tend to only find clusters that are interesting according to that mea-sure. A recent outstanding development [26] is to look for deficiency of randomness instead of homogeneity. The de-ficiency of randomness is an insightful generalization as it is a measure that can detect many more types of homo-geneous submatrices. This follows because a homogeneous submatrix X  X egardless of the definition of homogeneity X  X s one that exhibits some interesting regularity, which implies the lack of randomless.
 An excellent demonstration of this type of analysis is again the work of Yeoh et. al. on ALL [41] mentioned in the pre-vious subsection. That study contains 327 patient samples, over 60 of which do not fit into existing ALL subtypes. A biclustering of the expression profiles of the genes selected by Yeoh et. al. is shown in Figure 2. The strong associa-tion of different groups of genes for different ALL subtypes is obvious. Moreover, 14 of the samples with unknown sub-types share a novel common distinguishing gene expression profile, as indicated in Figure 2. This novel subtype may be linked to lipoma-associated chromosomal translocation [41]. The two subsections above describe the major approaches to infer differentially expressed genes that are useful for di-agnosis and discovery of disease subtypes. However, there are a number of fundamental problems. Firstly, the number of patient samples is very small compared to the number of genes. Thus, the statistical significance of the selected genes and the accuracy of the resulting diagnosis system have a high degree of uncertainty. Secondly, the transition from the selected genes to the understanding of the sequences of causative molecular events is unclear.
 Let us illustrate these issues using a set of in vitro gene expression data on three nasopharyngeal cancer (NPC) cell lines. A drug CYC202 is tested on the three cell lines, CNE1, CNE2 and HK1. Six time points are taken from the three individual cell lines. HK1 responds to CYC202. CNE1 does Figure 2: Gene expression profiles of childhood ALL. Each row is a gene. Each column is a patient. The group of patients labelled  X  X ovel X  is the newly emerged subtype de-tected by the biclustering [41]. not respond. CNE2 responds in a limited way. Applying the unsupervised approach, or the supervised approach to select genes followed by biclustering on the selected genes, gives a figure similar to Figure 3. We can see clearly that three distinct gene expression profiles are associated with the three cell lines. Even if the selected genes and their expression profiles are truly reliable distinguishing markers for the three cell lines, one does not know how to explain the different ways the cell lines respond to CYC202! Figure 3: Gene expression profiles of NPC cell lines. Rows are samples. Columns are genes.
 In order to qualitatively improve statistical power of the methods described earlier and reliability of the results, and to extend the reach of the predictions, additional dimen-sions present in the problem have to be brought into con-sideration. For example, each disease subtype usually has an underlying cause, and thus there should be a unifying biological theme for genes that are truly associated with a disease subtype. Hence the uncertainty in the reliability of the selected genes can be reduced by considering the mole-cular functions and the biological processes associated with the genes. Such a unifying biological theme is also a ba-sis for inferring the underlying cause of the disease subtype. There are a number of existing approaches to analyze gene expression data with respect to biological context. They can be roughly categorized into three groups [38], viz. the overlap methods, the direct group analysis methods, and the biological network co-clustering methods.
 The overlap methods determine what are the biological path-ways that have a statistically significant overlap X  X ypically the hypergeometric test 2 is used X  X ith the list of differen-tially expressed genes [42; 8]. The significant pathways are then postulated as basis for inferring the underlying causes of the disease subtypes studied or treatment responses ob-served. At the same time, those differentially expressed genes that overlap with these significant pathways are used as more reliable markers. An important weakness of these methods is that the initial list of differentially expressed genes is generally defined using test statistics such as those mentioned in Subsection 2.1 with arbitrary thresholds. Dif-ferent test statistics and different thresholds often result in a distressingly different list of differentially expressed genes. Consequently, the outcome of the whole procedure X  X .e., the biological pathways that are significant X  X s usually not stable with respect to variations in the test statistics and thresholds used in selecting the differentially expressed genes. The direct group analysis methods [40; 22] determine if a bi-ological pathway is relevant by comparing the distributions of expression values of genes on the biological pathway with the distributions of expression values of all the other genes measured in the experiment. The methods in this family dif-fer from each other primarily in the test statistics used for comparing the two sets of distributions. An outstanding ex-ample of this family of methods is gene set enrichment analy-sis, GSEA [40], which uses a weighted Kolmogorov-Smirnov statistics 3 to compare the two sets of distributions and also
The hypergeometric test value for a set W of genes on a pathway W given two sets P and N of gene expression profiles of patients in two contrasting classes P and N is defined as: where A is the set of genes on the microarray used, D is the set of differentially expressed genes with respect to the contrasting sets P and N , a = | A | , d = | D | , wa = | A  X  W | , wd = | D  X  W | . Typically a pathway W such that h ( W | P, N ) &lt;  X  , for some threshold  X  , is considered sig-nificant. Those differentially expressed genes belonging to such pathways can then be analysed further to understand the underlying causes of P vs N , as well as for use as feature vectors to train a classifier for distinguishing P and N .
The weighted Kolmogorov-Smirnov statistics of a set W of genes on pathway W given two sets P and N of gene expression profiles of patients in two contrasting classes P and N is defined as: where Here, A is the set of genes in the microarray used, r ( g | P, N ) is a correlation statistics X  X .g., t -statistics t ( g | P, N ) of a gene g with respect to the contrast sets P and N  X  X nd r ( g | P, N ) is the ranking of g according to r ( g | P, N ) among all the genes in A , while q is a control parameter. Note that KS ( W | P, N ) reduces to the standard Kolmogorov-Smirnov statistics when q = 0. A pathway W is considered signifi-cant if the p-value for KS ( W | P, N ) is significant, where the uses resampling to estimate false discovery rates. These di-rect group analysis methods start with a set of genes that are determined a priori  X  X amely, those that are on the biologi-cal pathway being considered. They are thus less vulnerable to the instability discussed earlier of the overlap methods, which start with a set of genes that are determined a pos-teriori using various test statistics and thresholds. Further-more, these direct group analysis methods are able to detect more subtle changes in gene expression profiles [38]. For ex-ample, if the majority of genes on the biological pathway have small expression level changes, probably none of them can be detected and selected as differentially expressed. The whole group is then missed in the overlap analysis. On the other hand, the high correlation of the changes of expression values in this group of genes can result in high statistical significance of the biological pathway under a direct group analysis method like GSEA.
 The biological network co-clustering methods [38; 15; 14; 37; 13; 18; 39; 35] integrate gene expression data with infor-mation on events underlying cellular response X  X .g., protein interaction, promoter-binding, protein modification X  X o in-fer the relevant signaling and regulatory cascades that ex-plain the disease subtypes studied and drug responses ob-served. Some of them use co-clustering techniques where the distance between genes depends both on the expres-sion profile correlation between the genes and the number of  X  X ops X  between the genes in a given biological network [14; 37; 13]. However, the existence of  X  X ubs X  X  X .e., those pro-teins or genes with very high connectivity in the biolog-ical network X  X an significantly distort such distance mea-sures. So some methods in this family [39; 35] downplay connections through hubs. The most interesting recent de-velopments along this approach are the network enrichment analysis algorithms [38]. These algorithms actually oper-ate in a way similar to GSEA, but they do not consider the genes in a biological pathway as a whole. Instead, for each regulator in the pathway, all its targets are considered as a group, which is then evaluated in a GSEA-like man-ner. Not all genes in the biological pathway are expected to be differentially expressed due to the complexity of regula-tory events. This splitting into separate regulatory groups can pinpoint the transcriptional regulators whose targets ex-hibit consistent and significant differential expression pat-tern, leading to sharper hypotheses that explain the disease subtypes studied or drug responses observed. We now present some of the issues (Subsection 3.1) that still remain in the effective analysis of gene expression data. Then we state our vision (Subsection 3.2) for an advanced system for more sophisticated analysis of gene expression data for understanding a disease and its treatment response. Then we discuss the challenges (Subsection 3.3) in realising the envisioned system. We have seen in Section 2 the tremendous progress already p-value is estimated by repeatedly swapping the members of P and N giving P 0 and N 0 and computing the fraction of KS ( W | P 0 , N 0 )  X  KS ( W | P, N ).
 made in the analysis of gene expression data. Neverthe-less, we still fall short X  X n at least three ways X  X f deci-phering and understanding the causative events of disease subtypes and treatment responses. Firstly, the functional groups determined by methods such as GSEA are usually too general, contain little information on the interplay be-tween their members, and do not tell us if the selected gene groups have expression values that are consistent or inconsis-tent with their known underlying pathways. Secondly, the collection of pathways and other information that can be analysed against the observed expression data is still lim-ited. Thirdly, a comprehensive set of rules for reasoning about signaling cascades, regulatory interactions, and other molecular events has never been compiled and formalized. The first issue calls for continued effort in research on select-ing relevant genes that serve as starting points for analysis of disease subtypes and treatment responses. The data min-ing community has already been paying significant attention to this problem, and we should see continued progress. An advice that we would like to offer in this aspect is that the data mining community should direct their effort in this re-gard towards gene expression analysis methods that consider gene expression data along with additional information such as promoter-binding, protein modification, protein interac-tion, and other bio-molecular events forming the machinery that underlies cellular response.
 The second issue calls for continued effort in the construction of high quality databases of biomolecular networks. Such databases [21] have traditionally been developed by dedi-cated curators in a mostly manual manner. Such develop-ments should be continued and expanded. We suspect this may be most effectively carried out by countries or compa-nies that have access to a large pool of scientifically com-petent curators at an acceptable cost X  X .g., Molecular Con-nections Pvt Ltd in Bangalore, India. 4 More recently, there is also an increased interest in the text mining and natural language processing communities in applying their technolo-gies to extract information on protein modification, protein interaction, and other bio-molecular events from published literature [17; 3; 19], which we hope will eventually lead to a more automated way of constructing and maintaining high quality databases of biomolecular networks.
 The third issue calls for the development of a comprehensive set of reasoning rules for thinking about signaling, regula-tion, and other biomolecular events, as well as the devel-opment of inference systems for supporting the use of such rules. Although there is considerable effort in the systems biology arena in developing accurate simulations [16; 25], the development of systems for reasoning about biomolec-ular events at the logical level appears to be more limited. Such an inference system is likely to involve a significant level of abductive reasoning, as well as some level of deduc-tive reasoning and perhaps some level of inductive reasoning. For more sophisticated gene expression analysis for under-standing diseases and optimizing treatments, we envision an integrated system with the following capabilities: http://www.molecularconnections.com Many established repositories X  X .g., GOPubMed 5  X  X ocus on data integration and aggregation, where they collect and aggregate the latest abstracts, papers, and findings. Sem-Rep [9; 36; 2] is a step closer to our vision. Nevertheless, it is still basically a repository collection of biological informa-tion, extracted from abstracts and papers using natural lan-guage processing techniques. In contrast to SemRep, rather than building a grand biological repository, our vision calls for an integration of (i) knowledge from known biological data repositories, (ii) microarray experiment gene expres-sion data being studied, and (iii) domain-specific inference. Such an integration has to be performed in order to support discovery of consistencies and contradictions with known in-formation. After discovering the consistencies and contra-dictions, we can then generate more informative hypothesis on the causative sequence of events underlying the disease subtypes and treatment responses being studied.
 The least explored component of the envisioned system X  X t least within the bioinformatics community X  X s the develop-ment of the domain-specific inference system in the con-text of gene expression analysis for understanding disease subtypes and treatment responses. Such an inference sys-tem should contain (i) a logical framework for representing biomolecular interactions and events, (ii) a set of domain-specific reasoning rules or heuristics, and (iii) support for abductive, deductive, as well as inductive reasoning. In addition, there should preferably be some support for ex-tracting relevant information from biomedical literature and converting them into the logical framework for representing biomolecular interactions and events. We outline here the challenges to realise our envisioned system.
 As mentioned earlier, current data silos are generally pure repositories of data. Their task is to make data publicly available. However, such databases are more suited towards document retrieval, making knowledge extraction and inte-gration difficult and complicated. As most of the informa-tion stored is in text format, to effectively extract knowledge from such databases, we will need text mining and natural language processing techniques to extract the required infor-mation. Although the concept of applying text mining and http://www.gopubmed.org natural language processing to biological text is not novel, such techniques have been limited to establishing biomolec-ular interactions through co-occurrence or shallow parsing, and not detailed relationships between the genes and pro-teins or conditions underlying the interactions [17]. For in-stance, consider the geneRIF [31] entry below: Conventional natural language processing techniques are able to tag both the entities Chk2 and E2F1 as proteins and in-terpret them as a protein-protein interaction pair due to their co-occurrence in the text. However, we wish to go more in-depth and obtain the following relationships: As one of the objectives is understanding treatment response, specialized metrics, heuristics, and rules are needed to deter-mine and differentiate responses between responsive patients and non-responsive patients. Such metrics, heuristics, and rules have to: Knowing which individual gene regulatory relationships ex-pected in normal pathways are observed in or contradicted by the gene expression data studied may still not be suf-ficient for one to identify the sequence of causative events underlying a disease or a drug response. We therefore need a logical reasoning framework to allow us to chain together the individual observed gene regulatory relationships so that the relevant activated or rewired signaling cascades can be traced, hypothesized, and constructed.
 In addition, a significant portion of the known molecular circuits is at the protein level. In contrast, gene expres-sion data primarily reflect actions at the RNA level and at the transcription factor-DNA interface. Unfortunately, much less information is known at the RNA level and at the transcription factor-DNA interface. Hence we also need a logical reasoning framework that allows us to make infer-ences across all three levels, and especially to make cross inference between the known protein-level circuits and the observed gene expression data.
 Such a logical reasoning framework should contain a knowl-edge base of known biological phenomena at all the three levels of molecular circuitries mentioned above. It should satisfy the following criteria: We describe in Subsection 4.1 our preliminary explorations toward an advanced integrated system for the analysis of gene expression profiles for understanding disease subtypes and treatment responses. Then we discuss in Subsection 4.2 our thoughts on the less explored area of developing a logical model and reasoning system for biomolecular events. To address the issues discussed earlier, we are experimenting with an integrated system having the following capabilities: (i) automated analysis and extraction of information from biomedical texts, (ii) targeted construction of known path-ways and circuits, and (iii) tests for consistencies and incon-sistencies of observed data with respect to these pathways and circuits based on statistics and heuristics. Figure 4 sum-marizes the integrated system we are developing. Its four major components are represented by the red boxes on the left of the figure X  X iz., information gathering, processing en-gine, biological knowledge, and correlation combination. We describe them below: We currently grab data from one main source, NCBI, 6 pulling out the required geneRIFs [31] and paper titles. We concen-trate on just using geneRIFs for the time being. As the data in NCBI is well structured, gathering of such infor-mation is not difficult. Scripts were written to query di-rectly the NCBI database. The scripts consist mainly of two http://www.ncbi.nlm.nih.gov Figure 4: An integrated framework for analysis of molec-ular and genetic causative events in disease subtypes and treatment responses. posts to the database. The first post 7 queries NCBI with the gene name, allowing us to obtain the NCBI GeneID for that particular gene. Another query will then be posted 8 to NCBI, querying it with the GeneID obtained earlier on. After which we use a series of regular expressions to obtain all the geneRIFs for further processing.
 We then process the geneRIFs by identifying the genes and their protein products. It is not difficult to map to the genes mentioned in the geneRIFs using the gene list from the microarray experiment being analysed. After we have successfully identified the genes and protein products in the geneRIFs, we use the snowball [1] algorithm X  X or now X  X o extract individual relationships between the genes and their protein products.
 Figure 5: Relationships between genes and proteins to be extracted from geneRIFs.
 We constraint every relationship between two genes to take the form depicted in Figure 5. Specifically, a gene or its pro-tein product can fall into the following four main groups in any reaction:  X  X egulator X ,  X  X o-regulator X ,  X  X egulatee X , and  X  X o-regulatee X ; and a gene or its protein product can partici-pate in four main types of reactions:  X  X ctivates X ,  X  X nhibits X ,  X  X on-activates X , and  X  X on-inhibits X .
 We used the snowball algorithm here because it has been
The post is of the form http://www.ncbi.nlm.nih.gov/ entrez/query.fcgi?db=gene&amp;cmd=search&amp;term= X , where X is the gene name.
The post is of the form http://www.ncbi.nlm.nih. gov/entrez/query.fcgi?db=gene&amp;cmd=Retrieve&amp;dopt= full report&amp;list uids= Y , where Y is the GeneID. shown to be effective in determining relationships between object pairs within sentences, and has been reported to reach an accuracy of 88% [1]. However the snowball algo-rithm ignores many semantics aspects of natural language, and thus may miss out on many gene relationships that are within the text. In particular, the algorithm can fail poorly when there are multiple genes within the same geneRIF. Wrong associations and relationships can be developed con-sequently. Hence, we plan to require that the text be proc-essed using certain natural language processing themes, and we are currently experimenting with the Stanford Parser. 9 The individual relationships extracted earlier are fused into a form of Boolean gene regulatory network (GRN). We have thus created a small repository of biological information from available biological knowledge.
 With this repository of information, we next process the microarray data. For example, to understand patients X  re-sponsiveness to a drug, we first group the gene expression data according to patients X  responsiveness to the drug. With the repository of reaction pairs between a regulator g i and a regulatee g j in the GRN, we calculate three correlation metrics between g i and g j : These three metrics allow us to find relationships between g and g j that are distinctly different only across the two contrasting groups and show similarity in behaviour within groups.
 Finally, we combine these three metrics with a Bayesian mixture model to yield a single score on g i and g j . A high score suggests that there may be a regulatory relationship between g i and g j that has undergone a change in the two contrasting groups of patients. By comparison with biolog-ical information captured earlier in our repository, we will uncover relationships that are consistent or contradictory to our repository of biological knowledge. For example, if  X  g inhibits g j  X  is in our repository, and a high score is given to http://nlp.stanford.edu/downloads/lex-parser. shtml . See also Klein and Manning [23; 24].
 the pair g i and g j by the Bayesian mixture model, then it is likely that  X  g i inhibits g j  X  is observed in one of the patient groups but is not observed in the other patient groups. This proposed analysis procedure is similar in strategy to network enrichment analysis [38], where one starts with a known regulator and its regulatees as a group. However, network enrichment analysis methods generally test if the whole group share a common gene expression change pat-tern. In our case, we test if a regulatory pattern between a regulator and a regulatee is broken or changed. Hence our test can directly detect if a pathway is behaving normally and directly hypothesize possible breakages in a pathway. Such a test is useful for diseases such as cancers, because cancer cells can hijack normal pathways and rewire them around various checkpoints. The analysis technique described in Subsection 4.1 can pin-point individual gene regulatory relationships that are ob-served and those that are contradicted by the gene expres-sion data studied. However, it still leaves the researcher to chain together these individual relationships to trace, hy-pothesize, and construct the pertinent activated or rewired signal cascades and other causative events. We outline here a reasoning framework for making inferences across interac-tions between proteins, RNAs, and genes.
 Our reasoning framework has the following components: ob-servables, events, rules, and reasoning. These components are explained below.
 We need to represent several types of  X  X bservables X . An ob-servable is some state or property that a researcher measures or determines at a system-wide level or individual molecule level. For example, apoptosis is an observable that can be determined by TUNEL assays, the expression level of a gene can be determined by a microarray, and so on.
 The observables at a system-wide level X  X uch as DNA dam-age, apoptosis, etc. X  X re represented as a formula of the form state(system, X ) , where X is what is observed. For brevity, we write X to mean state(system, X ) . For exam-ple: The observables on the protein complex, protein, RNA, and DNA levels are represented as a formula of the form state( X , S ) , where X is a protein complex, protein, RNA, or DNA; and S is the observed state or property of the molecule, such as activated, inhibited, upregulated, downregulated, abundant, degraded, short half life, etc. For brevity, we write S ( X ) to mean state( X , S ) . For example: We need to represent  X  X vents X  at various levels of molecular circuits. An event is basically a direct or indirect interac-tion that causes the system or a protein complex, a protein, a RNA, or a DNA to adopt or enter a specific observable state. Thus events capture our knowledge of biology at the molecular level.
 We consider two levels of events. A first-order event is rep-resented as a formula of the form E causes F , meaning if E was observed then F would be observed. A second-order event is represented as a formula of the form E causes F provided G , meaning if G was observed then the first-order event E causes F would be observed. For example, We also permit multi-molecule version of these events. For example, the binding of cyclinA and cdk2 to form a complex: We deliberately use the term  X  X auses X  as we do not require the event to represent a direct interaction between mole-cules. In other words, if E 1 triggers E 2 , and E 2 triggers E , it is acceptable to model the indirect triggering of E 3 by E 1 as E 1 causes E 3 , and omit mentioning E 2 altogether. The granularity is left at the discretion of the modeler. This allowance for indirectness is necessary because the current state of knowledge of biology at the molecular level is incom-plete. For example, the inhibition of polymerase II can lead to apoptosis, but we do not really know the precise step-by-step chain of interactions underlying it. This representation of events permits us the flexibility of modeling those events that we know in great detail in a more fine-grain way, and those that we do not know in detail in a more coarse-grain way.
 The static knowledge that we capture as events are generally rich in actions at the protein complex and protein levels, but are usually poor in actions at the RNA and DNA levels. In contrast, the observables that we capture from our gene expression data are at the RNA level. So we also need some  X  X ules X  to capture some domain-specific reasoning that a biologist may use to make cross inference between the known protein-level circuits and the observed gene expression data. We consider two types of rules: those expressing normal expected behavior and those expressing normally mutually exclusive events.
 A rule expressing normal expected behavior is represented in the same way as events X  X iz., E causes F and E causes F provided G  X  X owever, the events may contain variables or place holders for the actual molecules involved. For example, A rule expressing observables that are normally mutually exclusive of each other is represented as a formula of the form E conflicts F , meaning that E and F are normally not observed together. For example, We are now ready to describe the desired  X  X easoning X  to be done in our framework. At the core of the framework is a classical proof system, D , R`  X  , depicted in Figure 6. Here,  X  is a ground formula to be proved; R is a set of domain-specific rules; and D is a set of observables and events. Let us use the CYC202 responses of our three NPC cell lines from Subsection 2.3 to outline how we intend to use the system for reasoning. Recall that the HK1 cell line is the cell line that responds to CYC202. Suppose we have done a TUNEL assay and show that apoptosis is observed in HK1 after treatment by CYC202, and we desire to know if CYC202 is the cause of apoptosis. Let R  X  be the set of all domain-specific rules, and D  X  be the set of all observables ac-tually observed in our gene expression profiling experiments and other experiments on the HK1 cell line. It is easy to see that CYC202 is probably the cause of apoptosis if there is a target inhibited by CYC202 X  X .g., cdk2 X  X uch that we can find R as small as possible, R 0 as large as possible, D as small as possible, and D 0 as large as possible, satisfying the conditions below: (1) R 0  X  X   X  ; (2) R 0  X  X  ; (3) D 0  X  X   X  ; (4) D 0  X  X  ; (5) D , R6` apoptosis ; (6) D X  X  inhibited(cdk2) } , R` apoptosis ; and (7) D X  X  inhibited(cdk2) } , R6` E conf licts F , for all E The logic behind the conditions above is as follows. Condi-tions (1) and (3) allow us to omit some rules, events, and observations that lead to contradictions, corresponding to breakages in the expected normal pathways. Conditions (2) and (4) allow us to insert some new rules and events, as well as hypothesized observations to be subsequently tested, cor-responding to rewiring of pathways. Condition (5) shows that the breakages and rewirings do not by themselves lead to apoptosis. Condition (6) shows that once CYC202 inhib-ited its target, cdk2, the system goes into apoptosis. Con-dition (7) shows that the resulting model contains no incon-sistency. As apoptosis is only provable when the CYC202 target cdk2 is inhibited, this suggests CYC202 has acted through inhibiting cdk2 in HK1 cell lines. The exact cas-cade of signaling events can be reconstructed by tracing the proof tree of D X  X  inhibited(cdk2) } , R` apoptosis . Recall also that the CNE1 cell line does not respond to CYC202 treatment, and we desire to know how this cell line escapes the fate of apoptosis after CYC202 treatment. Let R  X  be the set of all domain-specific rules, and D  X  be the set of all observables actually observed in our gene expression profiling experiments and other experiments on the CNE1 cell line. Suppose cdk2 , cdk7 , and cdk9 are the only known targets of CYC202. Then the CNE1 cell line probably es-capes apoptosis if we can find R as small as possible, R 0 large as possible, D as small as possible, and D 0 as large as possible, satisfying the conditions below: (1) R 0  X  X   X  ; (2) R 0  X  X  ; (3) D 0  X  X   X  ; (4) D 0  X  X  ; (5) D X  X  inhibited(cdk2) , inhibited(cdk7) , inhibited(cdk9) } , (6) D X  X  inhibited(cdk2) , inhibited(cdk7) , inhibited(cdk9) } , The logic for Conditions (1) X (4), and (6) is as before. Con-dition (5) says that even after CYC202 has inhibited all its known target, apoptosis is not observed. Thus the breakages and rewirings in Conditions (1) X (4) allow CNE1 to escape the effects of CYC202.
 The two hypothetical theoretical scenarios above suggest we know how to search for which parts of which pathways to break, which parts of which pathways to rewire, and which CYC202 target to check. In practice, the search must be guided. This is where the integrated system presented ear-lier in Subsection 4.1 comes in. Specifically, the last com-ponent of the integrated system is designed to identify can-didate regulatory relationships of normal pathways that are observed to be consistent or changed in the gene expression data. Personalized drugs are widely promised to revolutionize the face of medicine. Yet it is important to note that during its infancy now, it begins with simple stratification policies in drug prescription, albeit at a highly sophisticated and pre-cise level. This approach of prescribing personalized drugs for patients is known collectively by the term pharmaco-genetics. As defined by [27], we refer to the term phar-macogenetics as different individuals having differences in drug responses as a consequence of having different genetic makeup, hence the term  X  X enetics X . The term pharmacoge-nomics however, refers to the study of the effects of drug re-sponses on the entire genome. Hence the term  X  X enomics X . grounding substitution as usual.
 The primary distinction is their intended use. One serves to study the differences of a single compound with a number of individuals, while the other serves to study the differences of a number of drugs with a single individual.
 Gene expression analysis is a key tool for pharmacogenomics and pharmacogenetics [20]. The most common example cited in this category is that of the breast cancer treatment drug trastuzamab [4]. This is a specific antibody against breast cancer and happens to be ineffective against two thirds of the patients who do not over-express the drug X  X  target, whereas it significantly improves the survival in the remaining one third where the target is over-expressed. In this paper, we have provided a succinct but in-depth survey of progress in the analysis of gene expression data for the purposes of (i) disease subtype diagnosis, (ii) new subtype discovery, and (iii) understanding of disease sub-types and treatment responses. We have discussed the is-sues where existing works still fall short on. We have fur-ther envisioned, and are developing, an integrated system X  comprising (i) automated analysis and extraction of infor-mation from biomedical texts, (ii) targeted construction of known pathways, and (iii) direct hypothesis generation based on logical reasoning on and tests for consistencies and incon-sistencies of observed data with known pathways X  X o ad-dress the issues. Thus the system can provide a researcher possible biologically inspired interpretations and solutions to his questions, enabling him to better decipher what are the reasons that cause a drug to be effective or ineffective. We thank Ken Sung and Xu Han for providing Figure 3. [1] E. Agichtein and L. Gravano. Snowball: Extracting re-[2] C. Ahlers, M. Fiszman, D. Demner-Fushman, et. al. Ex-[3] S. Ananiadou and J. McNaught, editors. Text Mining [4] J. Baselga, D. Tripathy, J. Mendelsohn, et. al. Phase [5] R. Breitling and P. Herzyk. Rank-based methods as [6] G. C. Cawley and N. L. C. Talbot. Gene selection in [7] Y. Cheng and G. M. Church. Biclustering of expres-[8] S. W. Doniger, N. Salomonis, K. D. Dahlquist, et. al. [9] C. Friedman, P. Kra, H. Yu, et. al. GENIES: A natural [10] M. E. Futschik and B. Carlisle. Noise-robust soft clus-[11] L. Goh and N. Kasabov. An integrated feature selection [12] T. R. Golub, D. K. Slonim, P. Tamayo, et. al. Mole-[13] K. C. Gunsalus, H. Ge, A. J. Schetter, et. al. Predictive [14] D. Hanisch, A. Zien, R. Zimmer, and T. Lengauer. Co-[15] C. Henegar, R. Cancello, S. Rome, et. al. Cluster-[16] W. J. Heuett and H. Qian. Combining flux and energy [17] L. Hirschman, J. C. Park, J. Tsujii, et. al. Accomplish-[18] T. Ideker, O. Ozier, B. Schwikowski, and A. F. Siegel. [19] J. L. Jensen, J. Saric, and P. Bork. Literature mining for [20] W. Kalow. Pharmacogenomics: Historical perspec-[21] M. Kanehisa, S. Goto, S. Kawashima, and A. Nakaya. [22] S. Y. Kim and D. J. Volsky. PAGE: Parametric analysis [23] D. Klein and C. D. Manning. Fast exact inference with [24] D. Klein and C. D. Manning. Accurate unlexicalized [25] C. Li, S. Suzuki, Q.-W. Ge, et. al. Structural modeling [26] H. Li, X. Chen, K. Zhang, and T. Jiang. A gen-[27] K. LindPaintner. Pharmacogenetics and the future of [28] H. Liu, J. Li, and L. Wong. Selection of patient samples [29] Z. Liu, D. Chen, H. Bensmail, and Y. Xu. Clustering [30] S. C. Madeira and A. L. Oliveira. Biclustering algo-[31] J. A. Mitchell, A. R. Aaronson, J. G. Mork, et. al. [32] V. Olman, C. Hicks, P. Wang, and Y. Xu. Gene ex-[33] C. H. Pui and W. E. Evans. Acute lymphoblastic [34] X. Qiu and A. Yakovlev. Some comments on instabil-[35] D. Rajagopalan and P. Agarwal. Inferring pathways [36] A. Rzhetsky, I. Iossifov, T. Koike, et. al. GeneWays: A [37] E. Segal, H. Wang, and D. Koller. Discovering mole-[38] A. Y. Sivachenko, A. Yuryev, N. Daraselia, and I. Mazo. [39] F. Sohler, D. Hanisch, and R. Zimmer. New methods [40] A. Subramanian, P. Tamayo, V. K. Mootha, et. al. Gene [41] E.-J. Yeoh, M. E. Ross, S. A. Shurtleff, et. al. Classi-[42] B. R. Zeeberg, W. Feng, G. Wang, et. al. GoMiner:
