 Crime forecasting is notoriously difficult. A crime incident is a multi-dimensional complex phenomenon that is closely associated with temporal, spatial, societal, and ecological factors. In an attempt to utilize all these factors in crime pattern formulation, we propose a new feature construction and feature selection frame-work for crime forecasting. A new concep t of multi-dimensional feature denoted as spatio-temporal pattern, is construct ed from local crime cluster distributions in different time periods at different granularity levels.

Crime distributions are of different sizes and shapes with respect to spatial space over time. We use clustering to find local crime distributions in differ-ent time periods. The spatial-temporal patterns then are induced from each crime distribution through classification. Each spatio-temporal pattern uses re-lated crime incidences as indicators to represent a local cri me pattern at certain clustered locations during a certain time period. However, these locally learned patterns could be redundant or overlapping at global level.

We design and develop the Cluster-Confidence-Rate-Boosting (CCRBoost) algorithm to efficiently select relevant loca l spatio-temporal patterns to construct a global crime pattern from a training set. The main idea of this approach is to iteratively pick a set of local patterns which give the least classification error at each boosting round. Each set of local patterns is referred as an ensemble spatio-temporal pattern and is assigned a score (Called confidence-rate in our approach). At the end of boosting, a global pattern is constructed from these ensemble patterns. This global pattern is capable of predicting crime by scaling the total score of an input, a collection of crime indicators, evaluated on each crafted ensemble patterns. The proposed algorithm is depicted in Figure 1.
In our real-world case study, we collaborated with the police department of a northeastern city in the US to collect 4-year historical crime data, from January 2006 to December 2009. These data are used to evaluate the proposed framework on residential burglary prediction. This city is 90 square miles in size and more than 600 thousands in population. The results show that the proposed CCRBoost algorithm has achieved about 80% on accuracy in predicting residential burglary using the grid cell of 800-meter by 800-meter in size as one single location.
This rest of the paper is organized as the followings. The related work is de-scribed and compared with our algorithm in Section 2. Our proposed CCRBoost algorithm is thoroughly discussed in Section 3, including its theoretical analysis. The setting and results of our experiments are presented in Section 4. We then conclude our study in Section 5. Crime forecasting techniques from featur econstructionand feature selection point of view, can be categorized into statistic mapping, mathematical modeling, and clustering.

Statistic mapping uses historical statistics of the crime occurred at the same location for forecast[1]. It focuses on sea sonality of the crime with the assumption that same type of crime recurs regularly with respect to time, while our approach, in addition to time dimension, also factors in spatial neighborhood and other relevant societal and ecological factors.

In [11], mathematical modeling is used to simulate the formatting of the crime hotspots based on the crime frequency ob tained from statistical model of indi-vidual criminals. These hotspots are density based and overlapped with each other. Therefore, a suppression process is needed to filter out the true hotspots. Later in [8], Mohler proposed a point-based model that eliminates the suppres-sion step. Using the concept in predictin g aftershock, this model simulates how the crime spreads out, like diseases, from the initial background events. The hotspots defined in this model are those locations covering most spread points. The approach suits better for capturing the crime patterns with short life cycles at local level while our algorithm is able to capture the long term cycles at global level using our ensemble patterns. Another caveat of this model fitting approach is that the results can be way off when the i ncorrect initial points are given. In our framework, the built-in feature selection process can discard irrelevant or misrepresenting patterns when learning the global ensemble pattern.

The clustering approach adapted by Kumar is to define the geographic bound-aries of each spatial clusters [7]. With these boundaries, the changing of crime densities in a fixed size cluster is considered as the crime trend of this particu-lar cluster. Our global ensemble spatio-temporal pattern is designed to forecast crime for the whole study area. 3.1 The Concept of Spatio-temporal Patterns Our approach is designed to enhance the utility of the near repeat hypothesis formulated in Social Science [12]. This hypothesis suggests that the same type of crime possibly recurs not only at the same neighboring locations but also at a regular interval of time. In addition, crime incidents are closely related with social behaviors and environmental conditions[6]. This implies that crime tends to have similar trends at locations with similar societal and ecological structures. We hypothesize that crime can be fores een by investigating the trends of its correlated crime incidences. All of these three dimensions (location, time, and correlated incidences) are taking into account when we define a spatio-temporal pattern. A spatio-temporal pattern is a local pattern that represents the crime pattern at certain locations during certain time period using correlated crime incidences as the indicators. These indica tors are used to represent societal and ecological factors of different locations.

The challenges are that how many local patterns there are during certain time period and at which locations are unknown. Additionally, crime is not evenly distributed throughout a city and there are areas that are more attractive than others to criminals[3]. In order to find the possible local patterns, we use the unsupervised clustering approach without involving geographical features to group those locations with similar indicators in the same time period. This group of locations is considered as the spatial distribution of a possible crime pattern. By varying the configuration of the clustering method, the clusters with different sizes during different periods of time can b e generated. A classifier is then trained from each cluster and will be used to represent a local crime pattern.
Our next task is to use the spatio-temporal patterns as features to construct a global level spatio-temporal pattern. This global crime pattern should be capable of detecting crime incidences at every location. Which of these patterns should be selected to form the global crime pattern? Those locally learned spatio-temporal patterns could be redundant or overlapping. And, how can this global pattern be constructed? To resolve these two issues at the same time, we propose a confidence-rate boosting approach. We will first formulate the problem and then discuss our boosting algorithm in detail. 3.2 Problem Formulation We denote one crime indicator, a type of relevant crime event, as f p . Different indicators of the same location in the same period of time are used to form a vector, denoted as x =[ f 1 ,f 2 ,...,f P ], where P is the number of correlated incidence types. Each vector x has one class label y which tells whether this location is a hotspot. Through the clustering process, the vectors with similar indicators are grouped in to one cluster, denoted as c . A local spatio-temporal pattern, denoted as r , is defined as: r = q ( c ). q (), in our case, is a classifier induced from the cluster c and used to extract the crime pattern. This pattern r is used to identify whether a v ector is a hotspot. We denote x  X  r if x is recognized as hotspot by pattern r .Otherwise, x  X  r .

In reality, a crime pattern might not be represented as one single local pat-tern because this pattern might shift location-wise or change size over time[9]. In order to truly capture the dynamics of crime patterns, we introduce the en-semble spatio-temporal pattern, denoted as R =[ r 1  X  r 2  X  ...  X  r i ], which is the conjunction of selected spatio -temporal patterns. Thus, if x  X  R , then it must be true that x  X  r 1 and x  X  r 2 and ... and x  X  r i . This ensemble pattern is served as the base learner in our confidence-rate boosting approach. 3.3 Confidence-Rate Boosting Before boosting, we balance the training data by setting the weight of hotspots as 1 2 H and 1 2 C for coldspots, H and C are the numbers of hotspots and coldspots, respectively. Each vector x i in the training data is denoted as D ( i ). The main idea of our confidence-rate boosting approach is to repeatedly pick the best hypothesis h t which yields the least error rate at each boosting round t .Inour case, h t is an ensemble spatio-temporal pattern R t built at round t . The error function is defined as: where D t is the weight distribution at boosting round t . The theoretical back-ground of the confidence-rate boosting approach is analyzed as follows. so the upper bound of the error rate is t Z t . Z t is defined as: Thus, a smaller Z t that has a lower error upper bound will lead to a smaller training error at each boosting round. Now, we let C R =  X  t h t ( x i ) and ignore the boosting round t . Then, we define our loss function as: and we want to find the minimum value of Z to lower the training error as much as possible. C R is the confidence-rate for pattern R and C R =0if x i /  X  R . Here, x y =1.Otherwise,set y i =  X  1. Since C R =0where x i /  X  R ,weobtain Equation (4) can be rewritten as: where W 0 = i | x W + is the total weights of true hotspots (true positives), and W  X  is the total weights of false hotspots (false positives). By taking the first derivative of Z with respect to C R and let dZ dC maximum or minimum value: =  X  W  X  exp ( C =  X  ln( W  X  exp ( C =  X  ln( W  X  )+ C =  X  2 C =  X  C W + exp ( than zero, Z has the minimum value of W 0 +2 W + W  X  when C R = 1 2 ln( W + W  X  ).
To prevent the situation of W  X  = 0, we adjust the above equation as: where n is the total number of vectors. Equation (7) is then used to calculate the confidence-rate  X  C R t for pattern R t at each round t . 3.4 CCRBoost Algorithm As described in Algorithm 1, the first task of the CCRBoost algorithm is to identify spatio-temporal patterns of d ifferent sizes and shapes with respect to spatial space during each period of time. To add spatio-temporal dimension to our feature, a clustering step is adopted to find the crime distributions at local level in different time periods. K-Means, but not limited to, is chosen to find these patterns. We perform K-Means K times to obtain 1+2+ ... + K clusters and then train classifiers from each cluster to extract local spatio-temporal patterns at different granularity levels. The data is divided into M subsets before clustering by certain length of time interval. For example, if the raw crime data is processed by month, then M equals to 12 when one year worth of data is used. As a result, there are total M  X  (1 + 2 + ... + K ) possible patterns acquired from these M subsets.

Next, the weights of the entire data set is set to be in a probability distribution which makes the total weight equals to 1. The data set is then randomly divided into two subsets, GrowSet and PruneSet . This split is based on the total weight instead of the number of records. By calling BuildChain (), an ensemble spatio-temporal pattern R is built from those local patterns. This R gives the minimum Z value while evaluating R on GrowSet .Furthermore, PruneChain () is called to trim the list of R and prevents R from over fitting by using PruneSet to reevaluate R and then obtain the final ensemble pattern R t . The confidence-(7). Based on  X  C R t , the boosting algorithm updated the weights of those vectors that are classified as hotspots. This weight update function is defined as: The goal is to exponentially lower the weights on those vectors that are recog-nized by the current global pattern. This way, the data instances which have not been fitted to the pattern are getting more attentions for the next round.
The boosting process is repeated for T times, where T is a user-defined vari-able. At the end, T ensemble spatio-temporal patterns, R 1 ,R 2 ,...,R T ,and global spatio-temporal pattern is defined as: while  X  is a user-defined threshold.

By taking an input vector x , this formula evaluates x over each ensemble confidence score h ( x ). x is predicted as a hotspot if h ( x ) is greater than the threshold  X  . Normally, this threshold  X  is set to zero. This ensemble learning algorithm is inspired by Cohen and Singer X  X  research in [2]. The steps of the CCRBoost algorithm are given in Algorithm 1.
 Algorithm 1. CCRBoost Algorithm Data Configuration: 4-years X  (January 2006 to December 2009) crime records have been used for the evaluation. In addition, three different grid resolutions have been applied to gener ate three data sets from the original crime records. These three resolutions have the squared cell/block with edge lengths of 800, 600, and 450 meters, respectively.
 The targeting crime to be predicted is residential burglary in our experiments. Residential burglary is a particularly interesting crime to study from a predic-tion perspective since the near repeat h ypothesis suggests that proximity to a burgled residence increases the likelihood of victimization of other domiciles in the neighborhood[12].

Based on the criminology theory[6] and after consulting with the domain experts, six categories of i ncidences are identified having the higher correlation with residential burglary crime than others. These six categories are arrest, com-mercial burglary, foreclos ure, motor vehicle larceny, 911 call, an d street robbery. Thus, the aggregations of these six categories from the crime records are used as the crime indicators in our experiments.

The Choice of Pattern Learning Classifier: LADTree[5] has been cho-sen as the base classifier to identify these patterns in our experiments because LADTree adapts same confidence-rated system to grow a decision tree. However, our algorithm is not limited to LADTree because a spatio-temporal pattern can be represented in any format or model as long as it can tell whether a vector is a hotspot.

Clustering Approach in Finding Spatio-temporal Patterns: In this experiment, the effectiveness of K is evaluated. The other user-defined variables T (The number of boosting iteration) and  X  (The threshold for h ( x )) are set to 500 and 0, respectively. The results of th is experiment are obtained from three data sets with different grid cell sizes. When K = 1, the data is not clustered. Therefore, the results obtained from the setting of K = 1 is used as the baseline to compare with others. According to the results shown in Figure 2, the clustering approach yields not only the better overall accuracy but also the better F1-score on hotspots. This is because using clustering enhances the feature with spatial dimension by taking into account the crime distribution at local levels. Moreover, we found that the perform ance reaches certain level when K =4and then maintains at this level when K  X  5. This shows that the patterns lose the true representative of local crime distributions when the resolution is set too high and suggests that there are less than or e qual to 5 different levels of local crime patterns in our target city. Thus, K is set to 5 in the rest of our experiments.
Comparing Spatio-Temporal Pattern Features with Random Sam-pling Features: In this experiment, the variable K is used to decide the number of random sampling data sets. This sampling method randomly selects 50% of the data records from a monthly data set for 1 + 2 + ... + K times without re-placement, which means that there is no duplicated records in each sample. This method constructs 1 + 2 + ... + K samples with unified size and then trains the base classifiers from them using the LADTree algorithm. The purpose is to have same number of features while comparing random sampling with the proposed spatio-temporal pattern.

Next, our confidence-rate boosting algorithm is used to pick features from those patterns generated from random sampled clusters and then build a global pattern. By this way, we can tell that which kind of feature delivers the bet-ter prediction results. According to Fig ure 3, using spatio-temperal patterns has better performance regardless the resolution of the data set. Thus, spatio-temperal patterns do have the advantage over random sampling due to their spatio-temporal multi-dimensional characteristic.
Comparing with Classification Approaches: Using the same crime data sets, other commonly used classification methods are adapted to generate the prediction results to compare with our proposed algorithm. Support Vector Ma-chine (SVM), C4.5, Naive Bayes classifier, and LADTree[5] are chosen in this experiment. As shown in Table 1, our proposed CCRBoost algorithm has the best accuracy and F1-score over other classifiers on all three data sets.
Comparing CCRBoost with AdaBoost: During this experiment, the var-ious numbers of iterations, T , are used in comparing our algorithm with the AdaBoost[4] algorithm. LADTree is chosen as the base learning classifier in both algorithms. Shown in Figure 4, the accuracy obtained from the AdaBoost algo-rithm reaches its ceiling when T&gt; 50. However, our CCRBoost algorithm not only can obtain better accuracy but also ha s better convergence rate throughout three data sets. In conclusion, the boosting effect of our algorithm is more effi-cient than AdaBoost because our algorithm enhanced with new spatio-temporal features has a strong impact in predicting crime.
The Resulting Global Spatio-temporal Pattern: The selection of the local patterns used in the final spatio-temporal pattern has been visualized on the map, which is shown in Figure 5. The red grid cells represent hotspots and blue cells are coldspots. The first pattern chosen by the proposed algorithm is a cluster from September 2007. The locations of this cluster are consistent with known crime pattern of our target city. The second cluster representing August 2009 data identifies crime hotspots that were excluded from the first cluster. More importantly, this second cluster is useful for pinpointing coldspots areas that have some protective factor against residential burglary and other crimes.
As a result, the first two clusters are com plementary in identifying locations where we would expect residential bur glary across the entire city as well as areas that are coldspots. Interestingly and consistent with criminological liter-ature, both clusters are in the summer months when children are out of school and individuals may take vacations and be less vigilant about protecting their property. It may be that there is an increased likelihood of residential burglary in this city during the summer time. Based on the consistency with actual crime patterns, our algorithm does find the patterns which recognize not only the spa-tial but also the temporal factors that are useful for criminal justice professionals in predicting the incidence of future crime. From a practical standpoint, the patterns selected from this algorithm are in-dicative of the true locations of residential burglaries throughout the target city. This gives the concrete evidence that using proposed spatio-temporal pattern has the great potential in predicting crime. The ultimate goal of our research is to build a crime prediction system with strong predictive power, which is able to provide forecast in a timely manner and requires less amount of data inputs. Ultimately, the law enforcement is able to fight criminals pro-actively instead of passively.
 Acknowledgments. The work was partially funded by the National Institute of Justice (No.2009-DE-BX-K219).

