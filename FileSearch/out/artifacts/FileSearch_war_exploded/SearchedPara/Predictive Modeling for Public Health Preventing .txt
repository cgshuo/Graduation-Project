 Lead poisoning is a major public health problem that affects hundreds of thousands of children in the United States every year. A common approach to identifying lead hazards is to test all children for elevated blood lead levels and then in-vestigate and remediate the homes of children with elevated tests. This can prevent exposure to lead of future residents, but only after a child has been poisoned. This paper de-scribes joint work with the Chicago Department of Public Health (CDPH) in which we build a model that predicts the risk of a child to being poisoned so that an intervention can take place before that happens. Using two decades of blood lead level tests, home lead inspections, property value as-sessments, and census data, our model allows inspectors to prioritize houses on an intractably long list of potential haz-ards and identify children who are at the highest risk. This work has been described by CDPH as pioneering in the use of machine learning and predictive analytics in public health and has the potential to have a significant impact on both health and economic outcomes for communities across the US.
 J.3 [ Life and Medical Sciences ]: Health; K.4.1 [ Public Policy Issues ]: Human Safety c  X  2015 ACM. ISBN 978-1-4503-3664-2/15/08 $15.00 Machine Learning, Social Good, Lead Poisoning, Public Health, Public Policy
Lead poisoning is a major public health issue, imposing lifelong health and economic costs on hundreds of thousands of children every year in the United States. Although Eu-ropean states banned lead paint as early as 1909 [19], po-litical forces and vested business interests delayed bans on leaded consumer products in the United States until the late 1970s [21]. Throughout most of the 20th century, cars ran on leaded gas, houses were coated with leaded paint, and industry emitted leaded waste products directly into the en-vironment. To this day, lead in paint remains a significant hazard. In Chicago, almost 90% of the housing stock was built before the ban [13].

Exposure to lead has been found to be associated with premature birth and early neurological development issues such as edema, herniation, atrophy, and white-matter de-generation [12, 10]. Lead can cause vomiting; convulsions; paralysis; and, in high concentrations, death [14]. Elevated blood lead levels are associated with lower IQs in children. A retrospective study by Mazumdar et al [20] shows that, on average, a 1  X  g/dL increase in blood-lead level is associated with a decrease of 1 IQ point among six-month-olds and 2 IQ points among 10 year olds.

Because of the permanent damage it can inflict, lead poi-soning imposes significant indirect costs on society. Based on its well-documented effects on IQ and contributions to neuropsychiatric disorders such as ADHD, lead poisoning has been estimated to significantly lower lifetime earnings for individuals and greatly increase the costs of crime pre-vention and special-education programs for the government. Lead-related child health issues conservatively cost over $40 billion annually [18]. Completely eliminating lead in the United States could indirectly save $200 billion dollars per year [22], ten times more than needed for removal. Figure 1: The proportion of blood lead tests conducted each year with a concentration greater than 5  X  g/dL (blue) and greater than 10  X  g/dL each year (green).

While the Chicago Department of Public Health (CDPH) devotes an enormous and concerted effort to solving the problem of lead exposure, it is like many American depart-ments of public health in its shortage of resources. At cur-rent levels of funding and staffing, it would take CDPH 76 years and $98 million to inspect X  X et alone remediate X  X he 197,157 older buildings in Chicago. The only hope of mak-ing a significant impact with the available budget is to use it efficiently.

In collaboration with CDPH, we focused on identifying children who are at risk of lead poisoning and homes that are likely to contain lead hazards so that the hazards can be remediated before the children are poisoned. Our approach uses two decades of blood lead level tests, home lead inspec-tions and remediations, housing records, and census data to build a model that can successfully predict the risk of lead poisoning for individual children.

Based on these results, we are designing experiments to pilot the use of these predictions by CDPH to perform proac-tive home inspections and targeted education and outreach about lead hazards. In addition, we are working with med-ical providers in Chicago to deploy our risk score into elec-tronic medical record systems to raise early alerts for blood tests in children with high risk levels. This work has been described by CDPH as pioneering in the use of machine learning and predictive analytics in public health and has the potential to have a significant impact on both health and economic outcomes for communities across the US.
The current approaches used to deal with lead poison-ing are centered around testing children for lead exposure with blood tests and preventing lead exposure by inspect-ing homes that contain lead hazards. In this section, we describe those approaches, their shortcomings, and the mo-tivation for our work.

The Center for Disease Control (CDC) recommends all children at risk for exposure get a lead test between one and two years of age. This is known to be the period when chil-dren start crawling and exhibiting hand-to-mouth behavior, which puts them most at-risk for lead dust ingestion [17]. Figure 2: A heatmap of lead poisoning cases in 2012. There are spatial patterns, but space cannot adequately predict lead poisoning alone. There are too many houses in the dark-red (poisoned) areas for the city to inspect.
 Our data show that lead levels rise during this period, peak-ing around age two.

Despite this being well known to public health officials, implementation of these testing recommendations is far from universal. Often, the children least at risk are the most likely to be tested early, and those most at risk do not get tested until well after their period of greatest risk.

In addition to the CDC recommendations, many school districts, including Chicago Public Schools, require children to have had a lead test no more than a year before their matriculation. Again, this requirement may not always be adhered to and misses the most dangerous window X  X he first two years of the child X  X  life X  X or lead poisoning. Many of the most vulnerable children are not getting tested early enough.
Screening of blood lead levels in children identifies cases but does not prevent their occurrence. Primary prevention requires that older housing units comply with lead safety standards before they are occupied by children. Though screening and primary prevention work are complementary, the latter is recognized to be more important and far more cost-effective in the effort to eliminate lead poisoning [19].
Despite these guidelines for testing and prevention, prob-lems remain. First, lead inspections and remediation often come too late, after a child has been poisoned. A positive blood test triggers an inspection, and a positive inspection triggers remediation proceedings. CDPH cannot enforce re-mediation until a child living in a home tests positive. Sec-ond, inspectors may focus too heavily on lead paint. While lead paint is the primary cause of poisoning [15], there are of-ten multiple sources of poisoning, especially for higher blood lead levels [11]. In 5% of cases, no source can be identified [8]. Third, lead continues to poison some segments of soci-ety more heavily than others. A survey conducted in two of Chicago X  X  riskiest neighborhoods found that 27% of chil-dren had elevated blood lead levels and 61% had never been tested previously [13].

Secondary care is a challenge. Lead paint remediation (the removal of leaded paint) and soil abatement, even when con-ducted by a certified professional, can lead to an increase in BLLs by dispersing lead particulates into the air where they are more accessible to inhalation [9]. In Chicago, most BLLs drop following the intervention (Figure 3), though the extent to which this is environmental as opposed to behavioral is unclear. Worryingly, in 9.3% of the sample, BLLs increased by at least 5  X  g/dL following remediation. Approximately 46% of children with BLLs over 10 did not receive adequate follow-up testing [16].
Since even small quantities of lead are toxic, a transi-tion from secondary (screening) to primary (pre-emptive re-mediation) care has the potential to dramatically improve health outcomes. However, if not implemented efficiently, prevention could be prohibitively expensive and cannibalize resources for remediating confirmed cases of lead poisoning. This is perhaps the chief impediment to adoption of primary care for lead poisoning.

Fortunately, these challenges of primary care can be mit-igated by recent advances in computation. Addressing the scale and complexity of lead-related data is both practical and affordable. Likewise, recent improvements in the qual-ity, scope, and availability of data make the task of pre-dictive lead poisoning prevention feasible. The availability of public infrastructure data, combined with the digitiza-tion of medical and inspections and remediation records, of-fer public-health practitioners the opportunity to model the risk factors associated with lead poisoning, thereby enabling them to target interventions, prevent illness, and use their resources efficiently.
The solution we developed to predict risk for lead poison-ing is based on a variety of data sources. We obtained data from the Chicago Department of Public Health that consists of blood lead level (BLL) tests and home-inspection records, combined that with housing records and other public data (described in detail below), and built a classifier to predict the risk of lead poisoning. The city of Chicago has adopted the CDC definition of lead poisoning of a BLL of 5  X  g/dL.
Our system consists of the following components: 1. Data Integration and Cleaning 2. Feature Generation 3. Model Selection and Training 4. Model Validation 5. Deployment and Implementation
The next several sections describe each of the components in more detail.
CDPH has two been collecting key data sources that form the basis of our predictions: 1. Blood Lead Level Tests : We were given the re-2. Home Lead Inspection Records : We were also
We augment these two sources with a variety of publicly available data. The city X  X  building footprint data [1] con-tains building characteristics such as year of construction, physical condition, number of units, stories (floors), and va-cancy status. The city also provides shapefiles of the census tract [2] and ward [3] boundaries. The Cook County Asses-sor X  X  Office [5] has data on the assessed property value and building classification.

The American Community Five-Year Survey [7] contains census tract variables such as socio-demographics, educa-tion, health insurance, and home ownership. We also use the census surname ethnicity data [6], which allows esti-mates of ethnicity from surname alone. We combine the probability of an ethnicity given a surname with the prior probability of an ethnicity given a census tract to get a lo-cal maximum likelihood ethnicity estimate. Ethnicity was anticipated to be a predictive variable because of the his-tory of African Americans being funneled differentially into lower-quality housing, a process known as  X  X edlining. X 
Blood test records are recorded manually and individually, so linking multiple records for a single child requires fuzzy matching of error-prone names and birthdates. We perform this using thresholded Levenshtein distances, where date of birth is a  X  X YYYMMDD X -formatted string. Because there are millions of records, we use blocking on initials to paral-lelize and reduce the complexity of the computation. This process finds roughly 12% of records contain errors in these fields.

Home addresses in the blood test records are also prone to typographic error. Roughly 20% match exactly with our address dataset. Another 75% match after cleaning using regular expressions. Another 1% are processed using a fuzzy geocoder, leaving 4% of test addresses unresolved.

After cleaning, we collect and generate three kinds of fea-tures: Figure 4: The time periods used for aggregating different events at different spatial scales.
 The data pipeline is visualized in Figure 6. We used PostgreSQL with the geospatial extension PostGIS for data cleaning and aggregation. Deduplication and dataset assem-bly is done in Python and models are run using the scikit-learn module. The source code is available at the Data Sci-ence for Social Good GitHub repository [4].
To evaluate our models, we use a cross-validation strategy that emulates the way in which our models will be employed by CDPH and provides an accurate performance estimate.
For a given point in time t 0 , we train our models only on information available to CDPH before t 0 to avoid training on data from the  X  X uture. X  The length of the training period dt is an additional necessary input to the cross validation, which we measure in years.

Our training set is thus comprised of blood tests occurring in the dt years before the t 0 . For recent times t 0 , the corre-sponding training set contains roughly 100,000* dt examples.
Recall that we are interested in predicting childhood lead poisoning and not individual blood samples. Thus the test-ing examples, unlike the training examples, correspond to children, not blood tests. Children are included in the test set if they were born before t 0 and have not been poisoned as of t 0 . There are about 50,000 children in the test set for any recent t 0 .

Note this evaluation setup dictates that we cannot use the (future) dates of a child X  X  blood test as features in predicting whether those tests will return positive for lead. However, we can use the minimum of the child X  X  age at t 0 mean age of blood testing in the training period. Figure 7 shows an example transformation.

Also note that the same child may appear in both the training and test periods if he or she is below the BLL thresh-old before t 0 but above it after that time. We are modeling childhood lead poisoning, so we only consider blood samples up to three years after t 0 . Because we train and test our models on data through 2013, we can only test on children born before January 1st, 2011, so that is the maximum t 0 we will consider below.
CDPH would deploy our models to rank children (or build-ings) according to their risk for getting (or causing) lead poi-soning. Due to limited resources, CDPH can only investigate a subset of cases. Therefore we measure the performance of a model by computing its precision in the examples pre-dicted to be most at risk by that model. In this way we can estimate how many cases of future lead poisoning would be found, and so potentially ameliorated or avoided, if CDPH investigated a given number of cases.

Figure 8 shows the precision at different proportions of intervention for several model types evaluated at two dif-ferent years. The baseline here and henceforth is given by random classification and so is equal to the incidence of lead poisoning in the test set.

For simplicity the evaluations below will use precision in the top 5% as a representative metric. This choice is based on our observation over hundreds of model runs that this number is representative of precision at the top. That is, if the model A dominates model B at 1% then it unlikely that B dominates A at 10%. Note that 1% to 10% amounts to about 500 to 5,000 children (per year). This range is representative of the numbers that CDPH is considering for various interventions.

After tweaking each model X  X  parameters, we observed sim-ilar performance for logistic regression, random forest, and support vector machines. See Figure 9 for a comparison of the best models of each type. Based on this observation, we use logistic regression as a representative model for the following evaluations.
Once our dataset is assembled, we train a variety of clas-sification algorithms including logistic regressions, support vector machines, and random forests.

Here we present the results of running a variety of models to find optimal parameters and measure the value of different kinds of features.

By varying the number of years in the training period, we determined that approximately three years of training data child birth inspection test poisoned 1 2010-1-1 null 2010-9-1 True 1 2010-1-1 null 2012-6-1 True 2 2010-6-1 null null False Figure 8: Precision at different proportions of investigation for different model types for the same year.
 Figure 9: The best models of each class perform comparably across years.
 Figure 10: Performance plateaus after about three years of training data. is optimal. See Figure 10. Note that the training period determines which blood samples are seen by the model but that all training examples include spatio-temporal features that draw on the entire history (blood tests and inspections) of an address or tract.

By fitting the same model on an increasing set of features we can observe the value added by those features. Figure 11 shows that as we refine the spatial scale of our features the model improves dramatically, with address-level features (building age, condition, and history of lead poisoning and inspections) being especially important.

We can also categorize features as they were presented in Section 5. Figure 12 shows that the spatial and spatio-temporal aggregations are very important.
 We use the l 1 -penalized (inverse regularization coefficient C = . 001) logistic regression for feature selection. We ex-amine the most important features as measured by the mag-nitude of their (normalized) coefficients. Figures 14 and 13 show these features having negative and positive coefficients respectively, i.e. corresponding to reduced and increased risk for lead poisoning, respectively. See the captions for a descriptions of the features.
Based on the encouraging results of our experiments de-scribed in the previous section, this section focuses on how CDPH is using our predictive models to prevent lead poison-ing. Currently, Chicago requires doctors to determine the Figure 12: Increasing precision as we supplement the child features with spatial features and spatio-temporal features. Figure 13: Features with positive standardized coefficients (increased risk for lead poisoning) in a regularized logistic regression. In order, these are the age of the child at the time of testing, the age of the home according to the assessor, the proportion of children tested at this address in the past three years who were poisoned first at this address, the proportion of children tested at this tract in the last year who were poisoned first at this tract, the proportion of blood tests at this address that were poisoned, the number of blood tests at this address in the past three years that were poisoned, and the number of children poisoned on this tract in the past year. Figure 14: Features with negative standardized coefficients (decreased risk for lead poisoning) in a regularized logistic regression. In order, these are the percentage of the census tract that are white, the percentage of the tract that have employer health insurance, the percentage of adults with at least a bachelor X  X  degree, the proportion of all inspections on this tract which have been complied, the year the home was built according to the buildings department, percentage of adults on the tract with an advanced degree, whether or not a child has been previously tested at this address, and the latitude of the address. BLLs of all young children, regardless of housing age or the absence of other risk factors for lead exposure. This require-ment is often ignored. Medicaid also requires two blood tests by age two. In the near future, these requirements will be loosened or will be ignored even more frequently as the risk of elevated lead exposure continues its rapid decline. This will increase the need for and usefulness of a tool that al-lows stakeholders to better assess risk and take preventative actions as warranted.

There are several ways that CDPH is planning to use the risk model. Each method involves a variation on dissemi-nating the risk score to participants in a young child X  X  life who provide medical care, child rearing, or housing and ed-ucating them on how to use this to reduce exposure to lead.
For pregnant women and parents of young chil-dren , CDPH is using billboard advertisements to encourage them to request home inspections. The risk score for these homes will be used by CDPH to prioritize inspections. In addition, publishing and publicizing the risk scores of hous-ing allows this target audience to choose low risk housing when they are moving or request an inspection to determine if there are actual lead-based paint hazards. Even when no hazards exist, a high risk score may prompt families to make other behavior changes that minimize exposure from exte-rior soil (e.g. removing shoes, covering bare soil) and water (e.g. flushing) and more carefully monitor the child X  X  diet to reduce absorption.

For doctors and other health care providers , know-ing the risk score for a child can allow them to provide advice to the family regarding inspections and other exposure re-ducing practices. CDPH is recruiting health and social ser-vice providers to facilitate lead-based paint hazard inspec-tions by city inspectors when their patients who are perina-tal women live in high-risk housing. In addition, the CDPH is actively trying to pilot an effort where risk scores are in-corporated into a child X  X  medical record thus being available to the doctor during well-child visits.

For landlords and housing providers , CDPH is devel-oping a program of outreach and education. For large land-lords, CDPH will disseminate risk scores for their properties and encourage them to discuss and negotiate a maintenance plan with the inspectors to reduce the risk of exposure from current hazards and avoid hazardous maintenance and ren-ovation practices. For home owners, CDPH will use the risk score to prioritize free inspections; CDPH has funding to pay for remediation for poorer owners and residents, which reduces the chance that the family will be burdened by un-sustainable expenses required after the inspection.
While this paper describes in detail one model that was used, there are many other possible approaches to this prob-lem and several others that are already being explored. One approach attempts to predict later lifetime exposure from infancy, using features on the child at birth, or from early doctors visits. The rationale relies on the idea that trace amounts of lead, perhaps acquired from the air or even from the mother, indicate much higher amounts of environmental lead. The infant is not yet at risk from these sources exclu-sively because of their inability to crawl. While measured levels at infancy might be below the CDC threshold, not
Figure 15: Lifetime trajectories from aggregated data giving a doctor quantitative cause for concern, they might also be strong indicators that the threshold will be crossed, once crawling begins  X  allowing a critical window of up to several months for remediation. In addition to being strictly preventative, this approach has the added significant bene-fit that it could be included as a part of post-natal doctors visits, meaning a schedule of opportunities for an early test is already in place.

While few features and few tests were available for an in-dividual, there was sufficient variation in age at the time of a test to construct rough canonical lifetime trajectories by ag-gregating tests from many children. In other words,  X  X verage BLL at age X X  could be calculated easily. One such trajec-tory was constructed for each census tract in the city, and these trajectories were clustered into low, medium, and high risk. These clusters were cleanly distinguishable even during the period prior to the jump in lead levels that takes place when crawling begins  X  suggesting that with more features (and aggressive early testing), this approach has significant preventative potential.
Thousands of Chicago children are poisoned by lead every year, incurring great health and social costs to the city in both the short and long term. We developed this model in conjunction with the Chicago Department of Public Health to help them prioritize their inspection and testing sched-ule. Using blood tests, home inspections, county land assess-ments, and census data, the model produces more accurate predictions of lead risk than what CDPH had available. CDPH is working to implement this model in several ways. CDPH has deployed billboards encouraging families to con-tact the city for free home lead inspections; CDPH will use the model to prioritize which houses to target first. CDPH also plans to make house-level risk scores available to the public so families can better choose where to live or, if they live there, to minimize their risk. CDPH is working to inte-grate the model into local electronic medical record systems to encourage health professionals to engage families at risk. Finally, CDPH plans to use the model to work with large landlords to rid their properties of lead hazards. The work described in this paper was begun as part of the The Eric &amp; Wendy Schmidt Data Science for Social Good Fellowship at the University of Chicago and continued at the Center for Data Science and Public Policy. We thank our collaborators at the Chicago Department of Public Health as well as the mentors and fellows in the fellowship program for their helpful comments and feedback. [1] Chicago building footprints. https: [2] Chicago census tract boundaries. [3] Chicago ward boundaries. [4] University of Chicago Data Science for Social Good [5] Cook county assessor X  X  office database. [6] Demographic aspects of surnames from census 2000. [7] U.S. census bureau; generated by eric potash; using [8] Arizona Department of Health Services. Annual Report [9] A. Aschengrau, A. Beiser, D. Bellinger, [10] D. C. Bellinger. Neurological and behavioral [11] S. M. Bernard and M. A. McGeehin. Prevalence of [12] L. M. Cleveland, M. L. Minter, K. A. Cobb, A. A. [13] T. A. Dignam, A. Evens, E. Eduardo, S. M. Ramirez, [14] P. Elliott, R. Arnold, D. Barltrop, I. Thornton, I. M. [15] C. for Disease Control and Prevention. Screening [16] A. R. Kemper, L. M. Cohn, K. E. Fant, K. J.
 [17] S. Ko, P. D. Schaefer, C. M. Vicario, and H. J. Binns. [18] P. J. Landrigan, C. B. Schechter, J. M. Lipton, M. C. [19] B. P. Lanphear. Childhood lead poisoning prevention: [20] M. Mazumdar, D. C. Bellinger, M. Gregas, [21] H. L. Needleman. Childhood lead poisoning: the [22] S. Zahran, H. W. Mielke, S. Weiler, and C. R.
