 It is one of the important tasks for data mining to discover frequent patterns from time-related data. For such a task, Mannila et al. [4] have introduced the episode mining to discover frequent episodes in an event sequence . Here, the episode is formulated as an acyclic labeled digraphs of which label is an event type and of which edges specify the tempo ral precedent-subsequent relation in an event sequence, which proposes a richer re presentation of temporal relationship than a subsequence in sequential pattern mining ( cf. ,[5]).

Then, Mannila et al. [4] have designed an algorithm to construct episodes from a parallel episode as a set of events and a serial episode as a sequence of events. Note that their algorithm is general but inefficient. In order to avoid such inefficiency, Katoh et al. have introduced the specific forms of episodes, that is, sectorial episodes [2], diamond episodes [3] and elliptic episodes [1], and designed efficient algorit hms to extract them. Such efficiency follows from the construction of episodes from just inform ation for occurrences of serial episodes in an event sequence, which is obtained by scanning an event sequence just once. On the other hand, there has remained an open problem of what form of episodes is constructible from just information for occurrences of serial episodes .
Consider the event sequence W consisting of a pair ( e, t )ofaneventtype e and the occurrence time t of e described as Figure 1 (upper left), where all of the serial episodes occurring in W are described as Figure 1 (upper right). Also consider the episodes D 1 , D 2 and D 3 described in Figure 1 (lower) as acyclic labeled digraphs. Note first that all of D i are embedded into W .
 Since D 2 is not embedded into W with distinguishing an event type a in D 2 , D 2 is not constructible from just information for occurrences of serial episodes in D 2 . On the other hand, while D 3 is embedded into W with distinguishing every event type in D 3 , D 3 is not constructible from just information for occurrences of serial episodes in D 3 , because all of the serial episodes occurring in D 3 coincide with ones in a serial episode bcab in W underlined in Figure 1 (upper right).
In order to solve the problem of what form of episodes is constructible from just information for occurrences of serial episodes with capturing the above situations, we formulate both an epis ode and an event sequence as an acyclic transitive labeled digraph ( ATL-digraph , for short) of which label is an event type. We say that an ATL-digraph D is parallel-free if D always has an arc between vertices with the same label. Also we say that an ATL-digraph D is serially constructible if D is embedded into every parallel-free ATL-digraph con-taining all of the serial episodes occurring in D . Hence, we show that an episode (as an ATL-digraph ) is parallel-free if and only if it is serially constructible . Let E be a set of event types . Then, a pair ( e, t ) is called an event ,where e  X  X  and t is a natural number which is the ( occurrence ) time of the event. For a set E  X  X  of event types, we denote { ( e, t ) | e  X  X } by ( E, t ). An event sequence S on E is a triple S, T s ,T e ,where S = ( E 1 ,t 1 ) ,..., ( E n ,t n ) is an ordered T s &lt;t e and w consists of all of the events ( e, t )in S for t s  X  t&lt;t e .
While Mannila et al. [4] have formulated an episode as an acyclic labeled digraph , we formulate it as an acyclic transitive labeled digraph as follows. A digraph (or a directed graph ) D =( V, A ) consists of a finite, nonempty set V of vertices and a (possibly empty) set A of ordered pairs of distinct vertices. We sometimes denote V , A and | V | by V ( D ), A ( D )and | D | , respectively. A digraph (  X  ,  X  ) is called empty and denoted by  X  .Anelementof A is called an arc . For an arc ( u, v )  X  A , u is said to be adjacent to v and v is adjacent from u .Foradigraph D and a vertex v  X  V ,the outdegree of v in D , denoted by od
D ( v ), is the number of vertices adjacent from v in D and the indegree of v in D , denoted by id D ( v ), is the number of vertices adjacent to v in D . Then, we define refer digraphs ( V, A ), ( V 1 ,A 1 )and( V 2 ,A 2 )to D , D 1 and D 2 , respectively.
We denote a digraph ( V 1  X  V 2 ,A 1  X  A 2 )by D 1  X  D 2 .For W  X  V ,wedenotea digraph ( V  X  W, A  X  X  ( v, u )  X  A | v  X  W or u  X  W } )by D  X  W .Alsowedenote in ( D, W )= { v  X  V | ( v, w )  X  A, w  X  W } and out ( D, W )= { v  X  V | ( w, v )  X  A, w  X  W } .Furthermore, D 1 is a subgraph of D 2 if V 1  X  V 2 and A 1  X  A 2 .For S ( =  X  )  X  V ,the subgraph of D induced by S , denoted by S D , is the maximal subgraph of D of which vertices is S ,thatis, S D =( S, { ( u, v )  X  A | u, v  X  S } ).
A walk in D is an alternating sequence w = v 0 a 1 v 1  X  X  X  a n v n of vertices and D )ifthereexistsa u -v walk in D . A digraph D is acyclic if there exists no v -v walk in D . A digraph D is transitive if, for u, v, w  X  V , it holds that ( u, w )  X  A whenever it holds that ( u, v )  X  A and ( v, w )  X  A .Foraset L of labels, a digraph D is labeled (by L ) if every vertex v  X  V has a label l ( v )  X  L .Wecallanacyclic transitive labeled digraph an ATL-digraph . For an ATL-digraph D =( V, A ), D  X  denotes an acyclic labeled digraph with a minimal number of arcs satisfying that Note that D  X  is uniquely determined for every ATL-digraph D .

Two ATL-digraphs D 1 and D 2 are isomorphic , denoted by D 1  X  = D 2 ,if there exists a bijection  X  from V 1 to V 2 such that ( u, v )  X  A 1 if and only if is embedded into an ATL-digraph D 2 , denoted by D 1 D 2 ,ifthereexistsan l ( v )= l (  X  ( v )) for every v  X  V 1 .

In this paper, we formulate an episode as an ATL-digraph of which label is an event type. Also we formulate a serial episode a 1  X  X  X  a n [4] as an ATL-digraph the set of all serial episodes embedded into D by se ( D ). We deal with an event sequence S as an ATL-digraph d ( S )=( V, A ) satisfying the following conditions. It is obvious that, for an event sequence S , d ( S ) is determined uniquely. In this section, we newly introduce a parallel-free and a serially constructible ATL-digraphs. Then, we show the main result of this paper that an episode as an ATL-digraph is parallel-free if and only if it is serially constructible. Definition 1 (Katoh &amp; Hirata [1]). Let W and D be ATL-digraphs W = ( V 1 ,A 1 )and D =( V 2 ,A 2 ), respectively. Then, we say that D is parallel-free in that either ( u, v )  X  A 1 or ( v, u )  X  A 1 .Alsowesaythat D is parallel-free if D is parallel-free in D itself.
 For example, every serial episode is parallel-free. Also d ( S ) for an event sequence S is parallel-free. Furthermore, if an ATL-digraph D is parallel-free, then D is parallel-free in an ATL-digraph W such that D W .
 Definition 2 (Katoh &amp; Hirata [1]). An ATL-digraph D is serially con-structible if it holds that D W for every parallel-free ATL-digraph W such that se ( D )  X  se ( W ).
 Definition 2 requires that, for ATL-digraphs D and W , every serial episode in W is corresponding to exactly one serial episode in D . Hence, by regarding D as an episode and W as a window, Definition 2 claims that a window W contains the information of occurrences of serial episodes in D without duplication. Example 1 (Katoh &amp; Hirata [1]). Every serial episode is serially constructible. On the other hand, let D and W be ATL-digraphs such that D  X  and W  X  are de-scribed as Figure 2. Then, it holds that W is parallel-free and se ( D )= se ( W )= { to V ( W ), so D W . Hence, D is not serially constructible. V  X  V j =  X  (1  X  i&lt;j  X  3) and two sets B B ( V, A ) such that V = V 1  X  V 2  X  V 3 and A = A 1  X  A 2  X  A 3  X  B 1  X  B 2 . Definition 3. Let D =( V, A ) be an ATL-digraph. 1. We say that D has a serial decomposition if there exist ATL-digraphs D i = 2. We say that D has a diamond decomposition if there exist ATL-digraphs Lemma 1. Let W be an ATL-digraph. Also let D and E ATL-digraphs embedded D F that is parallel-free in W , embedded into W and has a diamond decomposition [ F 1 , F D ,F E ,F 3 ] satisfying the following conditions. See Figure 3. 2. F 1  X  = D 1 (  X  = E 1 ) and F 3  X  = D 3 (  X  = E 3 ) . 3. F D  X  = D 2 and F E  X  = E 2 . 4. For every v  X  V ( F 1 ) , it holds that either v  X  V ( D 1 ) or v  X  V ( E 1 ) . 5. For every v  X  V ( F 3 ) , it holds that either v  X  V ( D 3 ) or v  X  V ( E 3 ) . Proof. We show the statement by induction on | D 1 | and | D 3 | .

If | D 1 | = | D 3 | =0,thatis, D 1 and D 3 are empty, then E 1 and E 3 are empty D Then, we can write D as Figure 4. Here, for a set A i,j = { ( u, v )  X  A ( D ) | u  X  D ,v  X  D j } (1  X  i&lt;j  X  3) of arcs in D ,everyset A i,j of arcs from V ( D i )to V ( D j )in D (1  X  i&lt;j  X  4) satisfies the following statements.
 A 3 , 4 = { ( v, v 1 )  X  A ( D ) | v  X  V ( D 3 ) } .

Also let E 1 = E 1 , E 2 = E 2 , E 3 = E 3  X  X  v 2 } and E 4 = { v 2 } E 3 . Then, we (1  X  i&lt;j  X  3) of arcs in E ,everyset B i,j of arcs from V ( E i )to V ( E j )in E (1  X  i&lt;j  X  4) satisfies the following statements.
 B 3 , 4 = { ( v, v 2 )  X  A ( E ) | v  X  V ( E 3 ) } .

Let D = D  X  X  v 1 } and E = E  X  X  v 2 } . Then, it holds that D =[ D 1 ,D 2 ,D 3 ] exist ATL-digraphs F 1 and F 3 such that F =[ F 1 , F D ,F E ,F 3 ] is parallel-free and embedded into D , and the statements from 1 to 5 replaced F D , F E , F i , D i and E i with F D , F E , F i , D i and E i hold.

It is sufficient to show how to construct F 3 satisfying the statements. Note (a) In the case that v 1 = v 2 , construct the following ATL-digraph F 3 . See Figure 5 (a). We denote an ATL-digraph by adding arcs A  X  , 4  X  B  X  , 4 to [ F 1 , F D ,F E ,F 3 ]by F .Since F is parallel-free, so is F .Since[ F 1 ,F D ,F 3 ] which implies the condition 1. By induction hypothesis, the conditions 2, 3 and Since D 3 = D 3  X  X  v 1 } and E 3 = E 3  X  X  v 1 } , it holds that either v  X  V ( D 3 )or v  X  V ( E either v  X  V ( D 3 )or v  X  V ( E 3 ) for every v  X  V ( F 3 ), there exists a vertex v  X  V ( F ( v, v 2 )  X  A ( W ), so construct the following ATL-digraph F 3 ,seeFigure5(b). We denote an ATL-digraph by adding arcs A  X  , 4  X  B  X  , 4 to [ F 1 , F D ,F E ,F 3 ]by F . Then, we can check that F satisfies the conditions as similar as the case (a). (c) For the case that ( v 2 ,v 1 )  X  A ( W ), there exists a vertex v  X  V ( F 3 )such We denote an ATL-digraph by adding arcs A  X  , 4  X  B  X  , 4 to [ F 1 , F D ,F E ,F 3 ]by F . Then, we can check that F satisfies the conditions as similar as the case (a). We can give the similar proof of the case that | D 1 | = | E 1 | = n . Theorem 1. Every parallel-free ATL-digraph is serially constructible. Proof. For a parallel-free ATL-digraph F , we show the statement by induction on | F | .If | F | X  1, then F is a serial episode, so the statement holds.
Suppose that the statement holds for | F | &lt;n and consider the case that |
F | = n and F is not a serial episode. Then, there exist vertices u and v in F such that (1) ( u, v )  X  A ( F )and(2)( v, u )  X  A ( F ). Let acc ( F, v )= { v } X  is accessible to v in F or v is accessible to u in F . Then, for this v ,weconstruct the following ATL-digraphs F 1 , F 2 , F 3 and F 4 : Forexample,consideranATL-digraph F such that F  X  is described in Figure 6 (left). Suppose that v  X  V ( F ) in Figure 6 (left) satisfies the above condition. Then, we obtain F  X  i ( i =1 , 2 , 3 , 4) as the dashed boxes in Figure 6 (right).
Then, from F , we can construct the ATL-digraphs X =[ F 1 ,F 2 ,F 4 ]and Y = [ F 1 ,F 3 ,F 4 ]. By the construction of F i ,itisobviousthat v and se ( Y )  X  se ( F ). Since F is parallel-free, F 2  X  F 3 is also parallel-free.
Let W be a parallel-free ATL-digraph such that se ( F )  X  se ( W ). Then, it holds that se ( X )  X  se ( W )and se ( Y )  X  se ( W ). Since X and Y are serially constructible and by induction hypothesis, it holds that X W and Y W . By regarding X and Y as D and E in Lemma 1, there exists an ATL-digraph Z =[ F 1 , F D ,F E ,F 4 ] that is parallel-free in W andembeddedinto W .Since F  X  = Z , it holds that F W . Hence, F is serially constructible.
 Theorem 2. Every serially constructible ATL-digraph is parallel-free. Proof. It is sufficient to show that, for every ATL-digraph D =( V, A )having exists an ATL-digraph W such that se ( D )  X  se ( W ) but D W .
 Let A u and A u  X  v be the following sets of arcs.
 Also let W be an ATL-digraph ( V  X  X  u } , ( A  X  A u )  X  A u  X  v ). Then, D  X  X  u } (= ( V  X  X  u } ,A  X  A u )) is a subgraph of W .
 serial episodes containing u and v at k with length n ( n  X  1 , 1  X  k  X  n ). Then, every serial episo de not containing u andembeddedinto D is embedded into W . Then, it holds that se ( D )  X  se ( W ). However, since | W | = | D | X  1, there exists no injection from V ( D )to V ( W ), which implies that D W . In this paper, we have shown that an episode is parallel-free if and only if it is serially constructible . This equivalence result gives a simple characterization on serially constructible episodes, and then concludes that a parallel-free episode is one of the theoretical limitations on efficiently constructing episodes.
It is a future work to design an efficient algorithm to extract parallel-free episodes from an event sequence. Also it is an important future work to extend a parallel-free and serially constructible episodes to subsequences [5].
