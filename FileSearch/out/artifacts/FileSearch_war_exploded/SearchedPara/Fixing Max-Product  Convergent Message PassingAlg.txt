 tree-width of the underlying graph.
 shown to converge to the LP solution for binary x favorably with max-product (which often does not converge f or these problems) and TRMP. have several key advantages: the derivation of the MPLP algorithms and prove their proper ties. We consider functions over n variables x = { x The MAP problem is defined as finding an assignment x Below we describe the standard LP relaxation for this proble m. Denote by {  X  butions over variables corresponding to edges ij  X  E and {  X  set M M L ( G ) =  X   X  0 Now consider the following linear program: where  X   X  is shorthand for  X   X  = P Furthermore, when the optimal  X   X  be derived from the dual of MAPLPR. MAPLPR using a different representation of M in the following proposition.
 Proposition 1 The following optimization problem is a convex dual of MAPLP R where the dual variables are  X  shaped graph G edge ki (for k  X  N ( i ) ) is  X  max  X  assignment such that star decoding yields the optimal value of MAPLPR.  X  objective depend on  X  where we defined  X   X  j Note that the function f (  X  This implies that the optimization can be done solely in term s of  X  store the  X  values explicitly. The optimal  X  to the re-parameterization constraint  X  sition characterizes the minimum of f (  X  characterize the optimal  X  Proposition 2 Maximizing the function f (  X  expression for  X  in Fig. 1. Note that since the  X  optimization affects both  X  need to be updated simultaneously.
 implies that  X   X  i yields the following relation between  X   X  j Plugging this into the definition of  X  will correspond to valid  X  values. the exact MAP assignment is obtained.
 Proposition 3 If the fixed point of MPLP has b unique maximizer x  X  To see why the second equality holds, note that b b ( x  X  j ) = max x the two max operations are equal. From the unique maximum ass umption it follows that x  X  the unique maximizers of the above. It follows that  X  do correspond to primal solutions, as the following proposi tion states. Proposition 4 When x The claim can be shown by constructing a primal optimal solut ion  X   X  . For tied b and for untied b is, we set  X   X  x (  X  LP is partially decodable for binary variables. the graph. A more general setting considers clusters c denoted by C ), and a function f ( x ;  X  ) = P this set by M is that one needs to introduce |S ( c ) | copies of each marginal  X  corresponding to some cluster c . The resulting messages are  X  intersection sets s  X  S ( c ) . The update on these messages turns out to be: where for a given c  X  C all  X  tailored for this case, and uses updates that are similar to o ur edge based updates. a Potts model: f ( x ) = P were randomly drawn from [  X  c c value. The performance of MP was good on the runs where it conv erged. (a) (b) (c) (d) Before deriving the dual, we first express the constraint set M definition of M and  X   X  is clearly equivalent to M correspond to each constraint (we omit non-negativity cons traints). We denote the set of (  X  ,  X   X  ) satisfying these constraints by  X  M problem is to maximize  X   X  subject to (  X  ,  X   X  )  X   X  M  X  copy). LP duality transformation of the extended problem yi elds the following LP variable  X  max x pears in a single constraint, we have that for all ij  X  E, ji  X  E, x and the constraints with  X  Eq. 3 is convex since it is a sum of point-wise maxima of convex functions. We wish to minimize f in Eq. 4 subject to the constraint that  X  The sum of the two arguments in the max is  X   X  j max x which implies  X  The resulting  X  Acknowledgments
