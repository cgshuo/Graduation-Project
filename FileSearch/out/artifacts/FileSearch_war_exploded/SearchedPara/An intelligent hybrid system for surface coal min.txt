 1. Introduction
One of the most important and also most complex problems encountered in surface coal mines is safety analysis. An appro-priate and reliable solution for this problem is vital for the working process in mines with surface exploitation.

Published studies on mine safety analysis are usually based on research related to accidents statistics ( Kecojevic and Radomsky, 2004; Karra, 2005 ; Bennett and Passmore, 1986 ; Marovelli, 1981 ).
Several studies have been conducted on hazard identification and risk assessment ( South African Mining Industry, 2003 ; Joy and
Griffiths, 2005 ) which aims to provide advice on hazard identification and risk assessment within the mining industry.
Systems safety analysis methods provide a proactive approach to analyze systems for potential hazards that may threaten the health and safety of miners. The systems approach to the safety problem focuses on the system taken as a whole. It involves the interaction of people, machines, and environment within proce-dural constraints ( Hammer, 1972). It uses a number of techni-ques: the technique of operations review, the failure mode and effects analysis technique, the fault tree analysis technique.
Contemporary mining theory operates with a number of methods and techniques which can be used to solve mine safety problems.
These methods are used in current engineering practice with the help of appropriate software products.
 experience to be fully exploited. This knowledge consists of rules and heuristics experts use when they apply numerical methods, and Artificial Intelligence offers formalisms and mechanisms for its incorporation in software systems ( Russell and Norvig, 2002 ).
Formalization of knowledge representation and development of mechanisms for using this knowledge are among methods and tools developed by AI for solving complex problems ( Giarratano and Riley, 2004 ). However, the complexity of some problems outgrows the potentials of single methods. A possible solution is to combine two or more AI methods into a hybrid intelligent system ( Goonatilake and Khebbal, 1995 ). This approach has been adopted in the case of PROTECTOR, a hybrid system for the analysis and estimation of safety in mining environment, devel-oped at the Faculty of Mining and Geology of the University of Belgrade. PROTECTOR was developed by combining neural networks and expert system technology. While the mining environment estimation methodology is implemented through an expert system, some of the related estimation parameters are determined by neural networks.
 combined AI methods in the analysis of safety in mining environment. A full understanding of the process and use of all collected data require the involvement of an experienced specialist in the mine safety field. The solution was found in the creation of PROTECTOR, whose knowledge base represents a formalization of the expert knowledge in the mine safety field. strategy through a hierarchical decomposition of the main goal, the evaluation of the mining environment, and the formalization of this strategy by means of a modified object-oriented analysis (OOA) model. The system structure and the main architectural components of the PROTECTOR system are described in Section 3.
The implementation of the system in the KAPPA-PC expert systems shell is discussed in Section 4. Section 5 presents a case study, followed by a conclusion in the last section. 2. A formalization of mining environment evaluation problem-solving
Analysis of safety in coal mines represents a very complex process based on estimation of numerous and interdependent parameters that are classified into several basic criteria for estimation of mining environment. These criteria are related to the following conditions: gas, dust, climate, noise, vibration, illumination and geotechnical hazard (highwall stability and waste stability).

In discussing occupational risks in the mining industry, it is common practice to identify health and safety hazards separately.
Some of these environmental stresses may interact to produce a greater overall effect. In combination or alone, if environmental stresses exceed human tolerance levels for prolonged periods of time, feelings of discomfort will arise, alertness will decrease, accidents will occur, and performance and productivity will drop.
Mining is among the more traditional and conservative engineering disciplines. Although various assessment techniques and numerical methods are available, the analysis of safety in surface coal mines relies mostly on heuristics formulated by mine safety experts. This was precisely the motivation for developing of PROTECTOR as a hybrid system, with its expert system component in its core. The system architecture draws upon the experience gained by successful implementation of hybrid systems in different fields, but represents a novel approach when mining is concerned. The novelty of the approach to mine safety was further reinforced by the development of an evaluation strategy. The main goal of the system is the estimation of mining environment as one of the significant components of general safety state in mine. This global goal can be subdivided into a hierarchical structure of subgoals where each of these subgoals can be viewed as the estimation of a set of parameters (gas, dust, climate, noise, vibration, illumination and geotechnical hazard) which determine the general mine safety state and category of hazard in mining environment. During this process, the impor-tance, i.e. significance of each particular parameter must be taken into account. The hierarchical decomposition of the main goal into subgoals, representing the problem-solving strategy, makes it easier to cope with the complexities and to coordinate the use of the knowledge incorporated in the system.

The strategy for evaluation of the safety in mining environ-ment is formally represented using a modification of the Coad-Yourdon object-oriented analysis (OOA) model ( Coad and Yourdon, 1991 ). In the standard model every real world entity is represented by a class (object) consisting of its name, attributes and methods pertaining to the procedures related to the object. However, in order to incorporate declarative knowledge, we have resorted to a modification of this model by including a new (fourth) element, featuring the production (IF-THEN) rules related to an object in the model. Thus both the procedural and declara-tive knowledge related to a class object could be represented. Such a modified OOA model was then used for the representation of the mining environment evaluation strategy as well as other objects in the system and their mutual relationships ( Fig. 1 ).
The inheritance relations between hierarchically connected objects representing elements of the strategy are given by full lines, while the exchange of messages between classes is represented with dotted lines. The model was the basis for the implementation of the system in an object-oriented expert system shell. 3. Architecture of the PROTECTOR system
Safety of mines and prevention of accidents is an issue of great importance in mine management. In order to be able to make appropriate and timely decision in this delicate matter the management needs to be adequately and accurately informed about the mine safety state on a daily basis. This information is, naturally, only part of the information required by mine manage-ment. Information systems offer the tools and techniques for handling all the information flows in complex system such as mines. To that end, a Technological Information System (TIS) has been developed, which can be tailored to suit requirements of any mine in Serbia. It integrates the following modules: Human
Resources, Maintenance, Mine Safety, Mine Planning and Produc-tion, Management Information Decision Support System and
Technical Data, and delivers critical internal and external information needed to support mining business. TIS components are integrated and operate with a unique database, and
PROTECTOR, the hybrid system presented in this paper is part of the Mine Safety TIS module named MISS (Mine Safety Information System).

The Unified Modeling Language (UML) diagram in Fig. 2 represents the structure of TIS and the place of MISS within TIS, as well as the structure of MISS and the place of the hybrid system
Protector within MISS. UML, as a standard language for visualization, specification, constructing and documenting of data on software was adopted for the software development analysis phase.

MISS module as a part of TIS contains several components such as: Health Care, Injuries and Professional Diseases, Personnel
Safety Revises, Safety Reports. Each of these components has components of its own, as shown by the PROTECTOR system example.
 such as VB (Visual Basic) Application, Expert system, Neuro
Application ( Fig .2 )(Lilic  X  et al., 2002a, b ). The system connects numerical methods with AI methods, thus introducing heuristics and forming a knowledge base with knowledge obtained from engineering practice.
 records of mining environment characteristic, runs analysis and presents a result of the expert system analysis.
 analyses the obtained results according to a series of criteria (gas, dust, climate, noise, vibration, illumination and geotechnical hazard). As a result of expert analysis, an estimation of validity and effectiveness of the mining environment state is obtained, followed by suggestions for its improvement. The architecture of the system and the software environment in which the system was developed provide for a dynamic communication between differ-ent segments of the system and thus for unlimited possibilities of testing different modifications of the system and obtaining a final solution which satisfies all of the established criteria. determination of permitted exposure time on specific vibration level. The neural network was trained through NeuroShell (Samarasinghe, 2006 ; Marques de Sa  X  et al., 2007 ) with data obtained from diagrams for determination of permitted exposure time on specific vibration level in dependence of frequency and acceleration.
 system: the knowledge base, an inference engine, the user interface and a working memory, but also a module for the interface with routines for relevant parameters determination, the Visual Basic routines themselves, and a database used by these routines ( Fig. 3 ).
 a successful dialogue, i.e. an exchange of information between the user and the system. It is the user interface that enables
PROTECTOR to obtain all the necessary information from the user, on one hand, and that transforms system X  X  results and conclusions into information the user can understand, on the other. safety expert X  X  knowledge. Knowledge in expert systems basically consists of facts and heuristics which can be represented by means of rules, frames, semantic networks and other formalisms.
Since knowledge is the key factor in problem solution and decision making, the quality and usability of an expert system is basically determined by the accuracy and completeness of its knowledge base. The selection of the representation formalism is very important and plays a significant role in knowledge-based design.

The problem-solving strategy is realized by the expert system X  X  inference engine . This reasoning mechanism infers conclusions based on knowledge from the knowledge base and the available information pertaining to the safety problem at hand. The inference engine stores intermediate results in the working memory . 4. Implementation issues
The object-oriented approach in system structuring and modeling ( Fowler, 2007 ; Stevens, 2006 ) was used as the strategy for defining the model of processes and data in the development of PROTECTOR, and UML for the software development analysis phase. The task of visual modeling of the system is to define the objects and logic of the real system using the adopted graphic notation.

Visual Studio 6.0 was chosen as the programming environment for the development of PROTECTOR. UML has been used as the most appropriate notation, and the system X  X  architecture was conceived in the form of a three-level class diagram. This architecture supports well the object-oriented approach in model development for complex applications. Its main characteristic is a separation of the domain model, which is represented by business services and data services, from user interface, represented by user services. Fig. 4 depicts the three-tiered service model of PROTECTOR.
 The nine classes identified within the user services of PROTECTOR represent its interface forms. They are used for data manipulation (entering, viewing and searching the data), textual and graphical presentation of results and communication with other modules in PROTECTOR (expert system and neural net-work). The classes related to user services communicate with classes at the business service level by sending messages that initiate the execution of specific applications.

Two interface forms belonging to user services are shown in Fig. 5 . They enable text search and editing, communication with the database, creation of business diagrams, etc. Business Services Data Services of them are Visual Basic application modules and they are used for safety assessment. In Fig. 6 an activity diagram depicts the dynamic model of one of these classes -the Neuro class. This class includes specific procedures based on the model of permitted time determination for specified level of vibration using a neural network and linear interpolation.
 modification functions. In view of the complexity of the
PROTECTOR system X  X  global model data structure, which had to model all relevant parameters of complex surface coal mine safety analysis, the design and realization of the database was executed in the MSAccess relational database management system. The system offers safe data archiving for complex data models as this one, as well as all procedures for data manipulation. The use of
SQL as a standard query language for data manipulation secures the openness of the hybrid system PROTECTOR for a connection with different environments. Fig. 7 depicts the structure of the database relevant to PROTECTOR through the MSAccess Relationships panel.
 KAPPA-PC applications development system. KAPPA-PC is a MS
Windows application which provides a wide range of tools for constructing and using applications by means of a high-level graphical environment which generates standard C code. In the
KAPPA-PC system, the components of the domain are represented by objects that can be either classes or instances within classes.
The relationships among the objects in a model can be represented by linking them together into a hierarchical structure. Thus the modified OOA model based on the strategy for evaluation of the general safety state of the surface coal mine could be easily mapped onto the appropriate elements of KAPPA-PC.

Object-oriented programming tools within KAPPA-PC were used to endow PROTECTOR objects with methods that specify what objects can do. First the objects and methods for the knowledge base were constructed. Then mechanisms were build that specify how objects should behave and that can reason about the objects by using rules. Each rule specifies a set of conditions and a set of conclusions to be made if the conditions are true. The conclusions may represent logical deductions about the knowl-edge base or specifications of how it changes over time. Each rule is a relatively independent module, which made it possible to build the reasoning systems gradually, rule by rule.
The classes and objects of the modified OOA model were transformed to classes and instances in the KAPPA-PC system as shown in the system X  X  object browser ( Fig. 8 ). The object browser shows also classes that KAPPA-PC generates for each application, such as Root, Image and KWindow.

Classes/instances are described using the class/instance editor, while slot facets are defined by means of the slot editor. Slots represent class attributes while methods in the class/instance editor account for both methods and IF-THEN rules related to a class in the modified OOA model. As an example consider the Gas class given in Fig. 9 .

The class has a parent class MineEnviron and six slots. Five methods are listed. The first three are numerical procedures (CalcFakGas, CalcFakMix, CalcHlpFMix) used for calculating the value of attributes FakGasa and FakMix and the remaining (CalcKatME, CalcEstimate) contain rules for the evaluation of the mine environment on basis of several parameters and their mutual relationships.

Since all rules in the system do not have to be related to particular objects KAPPA-PC offers the possibility of specifying rules independently, using a rule editor. The problem-solving process in PROTECTOR unfolds by means of the KAPPA-PC backward chaining inference engine. Goals to be satisfied by backward chaining are defined by means of the goal editor. The goals in PROTECTOR pertain to estimation of different parameter values. Goals can also be generated and modified within methods. This feature enables the creation of new rules and modification of existing ones dynamically, during system operation. An example of a rule for noise and the decomposition of the goal Para-metClima into subgoals are illustrated in Fig. 10 .

The interface developed for PROTECTOR in KAPPA-PC fully exploits the GUI (graphical user interface) technology available for MS Windows applications. It enables a straightforward and easy manipulation of input data and control over parts of the problem-solving process. It also offers suggestions and recom-mendations to the user which can contribute to the improvement of the overall performance of the mine system. 5. The opencast mine Kolubara field D: a case study
This section illustrates the use of the PROTECTOR hybrid system in the analysis and estimation of the state of mining environment safety in the opencast mine Kolubara Field D. One of the main reasons for choosing opencast Kolubara Field D for the analysis is the scale of this mine in terms of coal production and number of employees, which makes it the largest coal opencast mine in Serbia. The Kolubara mining region is about 50 km southwest of Belgrade near the town of Lazarevac. Four opencast mines are operated in this region at present. The total output in 2008 was 29.3 million tons which is about 80% of the lignite output from Serbian opencast mines.

The opencast mine Kolubara Field D is equipped exclusively with bucket-wheel excavators  X  belt conveyor  X  spreader systems (Fig. 11 ). Draglines of various sizes are used to support the main equipment. The bucket-wheel excavators used for overburden removal are connected to the spreaders on the inside dump via belt conveyor systems. Two separate belt conveyor systems are operating on independent working levels for lignite mining. The opencast mine capacity is rated for a lignite output of 15 million tons supported by a workforce of 2550 employees.

In order to assess the overall mining environment safety state of the Field D open pit, measurements of physical and chemical parameters at the working environment were undertaken. Measurements included determination of concentration of gases and airborne dust, levels of noise and vibrations, as well as illumination and climate conditions (dry and wet bulb tempera-ture, humidity, effective temperature) at working environments. Observations were performed at all working environments on the Field D open pit during the summer period as requested by
On basis of all data collected in the system X  X  database, an expertise by PROTECTOR was initiated. A chain of rules leading to assessments of specific characteristics of the mine working environment was activated using the appropriate command buttons on the main interface panel ( Fig. 12 ). The report on the results of the expertise was then displayed on the same panel.
Application of PROTECTOR enabled evaluation and analyses of physical and chemical parameters at working environments for each working position separately, resulting in suggestion of measures for condition improvements.

Some 144 working environments were analyzed, with a total of 864 parameters examined. Fig. 13 provides an overview of the number of working environments which meet requirements regarding safety and comfort according to six (out of six), five, four and three examined parameters in the process of lignite mining at Field D open pit.

It should be emphasized that only 19 examined working environments, out of 144, or 13.19%, meet each requirement. It should be added that as much as 63 (43.75%) and 58 (40.27%) working environments are having, respectively, at least one and two parameter values which are harmful for the health of employees. A somewhat favorable fact is that only 4 working environments (2.77%) have half of the examined parameters with harmful values.

Evaluation overview (satisfactory/unsatisfactory) by specific parameters is presented in Fig. 14 . The benchmarks for satis-factory parameters are limit values defined by mining legislation.
Airborne dust concentration, with levels higher than allowed, was found at 102 working environments. This parameter stands for 53.12% of the total of unsatisfactory parameters (192). Noise level was higher than allowed at 76 working environments (39.58% of total unsatisfactory parameters). Climate parameters were unsatisfactory at 10 working environments, accounting for 5.20% of the total number of unsatisfactory parameters. Illumina-tion was below allowed minimum value at 3 working environ-ments, thus making only 1.56% of total unsatisfactory parameters. Vibrations have not met the requirements at only 1 working environment; therefore, this parameter makes only 0.52% of total unsatisfactory parameters. Each of 144 examined environments has met requirements regarding concentration of gasses.
The expert system gives estimates for all of the mine environment safety characteristics. However, it is well known from current engineering practice that users are often unable to determine solutions for poorly or unfavorably estimated char-acteristics. In order to solve this problem PROTECTOR offers suggestions with concrete measures for improvement of certain characteristics as well as of the overall mine environment safety state. By simply activating the command buttons in the recommendations group, suggestions are obtained followed by proposal of possible measures. Suggestions for the improvement of unfavorably estimated characteristics of dust concentration at Field D open pit (bucket-wheel excavator G-1, operator X  X  cab  X  measurement point) are given in Fig. 15 .

PROTECTOR was implemented for the first time in 2005 in the opencast mine Kolubara Field D. A substantial growth of the number of injuries in 2005 and the preceding year secured full support of the mine management for the implementation of the system. The management was particularly interested in the application of the measures and recommendations for the improvement of safety conditions. The results of the application of the system were highly encouraging as the number of injuries started to decrease considerably in the following years.
The injury experience data used that support the effective-ness of PROTECTOR were obtained from the Kolubara Mine Safety Division accident investigation reports. These records indicate a total of 1368 injuries for the 11-year period from 1998 to 2008 ( Fig. 16 ). Among these records, 7 cases belong to fatal injuries, 192 to the serious and 1169 to light injuries. It should be emphasized that according to regulations and laws in Serbia injuries are categorized into the three categories: fatal, serious (more than 30 workdays lost) and light (less than 30 workdays lost) injuries.

The historical record of injuries shows a decline as the total number of injuries dropped from 162 in 2005 to 126 in 2007, with a slight raise to 131 in 2008. Despite the record of progress that has been achieved in reducing mining injuries in the last few years, the number of mining accidents is still unacceptable. Further reduction is expected with improvements to be made, inter alia, by continuing to use PROTECTOR.

Besides the aforementioned analysis of injuries in the context of the validation of the system we should also mention the fact that as a result of the implementation of the suggestions and measures offered by the system, an improvement was also made in the overall state of mine safety, namely a yearly reduction of the number of unsatisfactory parameters from 20% to 25% was achieved. This only further reinforced the decision of the mine management to continue with the usage of the PROTECTOR system. 6. Conclusion
The approach to the estimation of mining environment presented in this paper is aimed at solving one of the significant components of general safety state in mine. The methodology for mining environment estimation proposed in this study was implemented in the hybrid system PROTECTOR, a helpful tool for assessment of the general mine safety state and category of hazard in mining environment. The effectiveness of the metho-dology and the resulting hybrid system has been asserted by their successful application in several Serbian mines, as witnessed by the case study of the opencast mine Kolubara Field D. The authors feel that the proposed methodology and the developed hybrid system are also universally applicable to any opencast coal mine practice.

PROTECTOR was developed by integrating neural networks and expert system technology, which was an approach novel to the mining industry. While the mine environment estimation methodology is implemented through an expert system, some of the related estimation parameters are determined by neural networks. The conceived system structure was realized in the
KAPPA-PC expert system shell resulting in PROTECTOR. The aim of such a system is to generate an overall evaluation of the general safety state of the mine as well as suggestions for the improvement of particular characteristics of the mine system.
Further upgrade of PROTECTOR is planned through introduc-tion of fuzzy logic in the rules of the expert component of the system.
 References
