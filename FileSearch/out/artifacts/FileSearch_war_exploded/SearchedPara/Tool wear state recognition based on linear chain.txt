 1. Introduction
With the development of modern manufacturing industry, severe challenge appears on how to improve the quality, reduce the time and lower the cost. However, the tool wear, which appears during the machining process, produces bad effect on the quality of the workpiece. If the tool wear state cannot be recognized in time, the efficiency of the machining will be reduced greatly or even the machine tools will be destroyed.
Therefore, it is necessary to realize the online estimation of the tool wear state by integrating the accurate tool wear recognition model into the tool condition monitoring (TCM) software system.
Up to now, many models have been proposed to realize the tool wear monitoring ( Huang et al., 2011 ; Fu and Hope, 2007 ; Kang et al., 2007 ). Of these methods, HMM is pr eferred by many researchers and utilized for different machining processes such as turning ( Wang et al., 2002 ; Lee et al., 2010 ), grinding( Liao et al., 2006 ), drilling( Natarajan et al., 2006 ; Ertunc et al., 2001 ),milling ( Kassim et al., 2006 ; Zhu et al.,2008 , 2009 ; Wang and Wang, 2012 ; Boutros and Liang, 2011 ; Cetin and Ostendorf, 2007 ). The main characteristic of the HMM based classifier is that it can realize the statistical modeling of the sequential feature data. Moreover, the judgment of the tool wear state is not determined by a single data, but the maximum probability of the whole observation sequence. Therefore, it has exceptional ability to depict the sensory signal robustly and get advantageous results sometimes ( Ge et al., 2004 ). However, one of shortcomings for the HMM method is that this model assumes that the observation value is statistically independent of the previous sequence ( Liu et al., 2005 ). While the tool wear in the machining process is a continuous process in which the feature data of the current state are interrelated with their previous data unavoidably. Therefore, the HMM model fails to depict the adjacent information between different feature data, which sometimes dete-riorate the recognition accuracy correspondingly. Moreover, the application of HMM model depends on the correct selection of the state number and observation number in each state, which also brings some difficulties on quick and accurate construction of the pattern recognition model.
 probability model which is firstly proposed by Lafferty in 2001. In comparison with HMM, the CRF model is much more expressive because it allows arbitrary dependencies on the observation sequence. Another attractive property of the CRF model is the convexity of the loss function because it shares all of the convexity properties of the general maximum entropy model ( Lafferty et al., 2001 ). Up to now, the CRF based algorithm is mainly utilized in the field of state labeling of sub-sequence such as biological named entities recognition ( Sun et al., 2007 ), video sequences labeling ( Sminchisescu et al., 2005 ) and continuous speech segment ( Zweig and Nguyen, 2009 ). However, its classification capability of the whole dynamic sequence, to the authors X  knowledge, has not been assessed. To overcome the shortcomings of the HMM algorithm, a linear chain CRF model in which the label sequence is assumed as first order linear Markov chain, is proposed to build the relation-ship between the sensory features and the tool wear state so as to realize the classification of tool wear states. To test the effective-ness of the proposed method, acoustic emission signals are collected under four kinds of tool wear states and seven statistical indicators are extracted as features to realize the tool wear classification by using the CRF and the HMM respectively. The analysis and comparison shows that the CRF model is more accurate and faster than the HMM. Moreover, the stability of the CRF classifier is stronger.

The remainder of this paper is organized as follows. The principle of the CRF modeling and classification is given in Section 2 .In
Section 3 , experimental setup is illustrated and feature extraction method for the acoustic emission signals is presented. In Section 4 , the algorithm of linear chain CRF training and classification are described in detail. Based on the proposed algorithm, the classifica-tion of four kinds of tool wear states is realized using k-fold cross validation method. At the same time, the HMM is also utilized for the same data and the accuracy comparison between them is carried out. The results under dif ferent folds schemes show the CRF model can get more accurate re sults in comparison with the
HMM based method. Moreover, the training speed and stability of theCRFclassifieroutperformstheHMM.Someusefulconclusions are given in the last section. 2. Principle of CRF based pattern recognition 2.1. Structure of linear chain CRF model
The commonly used CRF model is shown in Fig. 1 ,inwhichthe output node y is linked by edges in a linear chain. Suppose
X  X  { x denotes the observation sequences and the state sequences respec-tively, the joint probability distribution of X and Y can be constructed by an undirected graphical model. In this model, Y tends to satisfy the maximum global conditional probability ( Lafferty et al., 2001 ) Y n ,i.e Y n  X  argmax
The primary advantage of CRF over HMM is its conditional nature which relaxes the independence assumptions required by the HMM in order to ensure tractable inference ( Sajjanhar, 2008 ).
Therefore, the CRF is more expressive because it allows arbitrary dependencies on the observation sequence. In addition, the features do not need to specify completely a state or observation, so the model can be estimated from less training data. Another attractive property of the CRF model is the convexity of the loss function which can ensure that the optimum model parameters can be calculated ( Lafferty et al., 2001 ). 2.2. Pattern recognition based on CRF
For the tool wear monitoring, the features extracted from the sensory signal can be viewed as the observation sequence and the tool wear condition can be viewed as the state of the observation sequence. For the observation data x , the probability of the state sequence y can be represented as Py 9 x , y  X  1 Z  X  x  X  exp
Z ( x ) is called the normalization factor which can be described as Z  X  x  X  X  entire observation sequence and the state at positions i and i 1 respectively; S m ( y i , x , i ) denotes the state feature function of the state at position i and the observation sequence. l k is the weight value of the transition feature function which denotes the prior probabilities of the transition from the state y i to y j sents the weight value of the state feature function which depicts the prior probabilities of the state y i . y  X  ( l 1 , l 2 the model parameters which are need to be estimated based on the training data.

For the given data x and model parameters, the optimum state y can be calculated by solving y n  X  argmax
This equation denotes that the label corresponding to the maximum probability is viewed as the state of the current data x . Here, to reduce the computational complexity and improve the efficiency, the forwards X  X ackwards algorithm ( Pietra et al., 1997 ) is adopted to deduce the optimum state. 2.3. Model parameter estimation
The key to realize CRF modeling is the estimation of the model parameters y . Here the maximum likelihood estimation (MLE) algorithm is adopted to estimate these parameters iteratively. The main principle of the MLE ( Pietra et al., 1997 ) is given as follows.
Assuming that the training data set D  X  { / x n , y n S } is indepen-dently and identically distributed, the likelihood function of the conditional probability P ( y 9 x, y ) on the data set D is defined as L  X  y  X  X  where, L ( y ) is viewed as a function of the parameters y . Therefore, the task of MLE is to obtain the optimum estimation value which should satisfy ^ y  X  argmax By combining Eqs. 2 and 5 , can be rewritten as L y  X  X  X 
The solution of the parameters y is realized using the limited memory Broyden X  X letcher X  X oldfarb X  X hanno (LBFGS) optimizing method ( Byrd et al., 1995 ) so as to get better tradeoff between the model accuracy and the training efficiency. 3. Experimental setup and feature extraction 3.1. Experimental setup
To test the effectiveness of the proposed method for the tool wear classification, an experimental system was built which com-prised of FNC -A20 vertical machine tools, PCI-2 double channel sampling card, optical microscope and the computer controlling system. The sampling card was used to collect the acoustic emission signal during the milling process and the optical microscope was adopted to measure the tool wear value. The framework of the experimental system is given in Fig. 2 .

The cutting parameters were selected as follows: the cutting depth was 0.4 mm, the cutting width was 6 mm and the feed rate was 0.1 mm/r. The workpiece was Titanium alloy Ti X 6Al X 4V (size 150 100 30 mm). The main wear zone appeared around the tool nose and the maximal length of this zone was measured by the optical microscope. The experiment was performed continu-ously until the value of the tool nose wear exceeded 0.6 mm. Four kinds of wear states are selected to realize the classification of the tool condition, which are labeled as new cutter, small wear, middle wear and severe wear. The topologies of the tool wear zone under these four states are illustrated in Fig. 3 . 3.2. Feature extraction
Acoustic emission (AE) is the energy released in the form of mechanical vibration from material as it undergoes stress. AE derived from metal cutting comprise of rich information about the machining process such as deformation in the shear zone, sliding friction at the chip tool interface, sliding friction at the tool flank X  X orkpiece interface, etc. ( Abellan-Nebot and Subiro  X  n, 2010 ).
The main advantage of AE is that the frequency range of its signals is much higher than that of the machine vibration and environ-mental noises. So in this paper, AE signal is collected during the machining process using the PCI-2 card sampling at 1 MHz. The signals ranging from 60 KHz to 200 KHz are obtained based on discrete wavelet decomposition. To depict the characteristic of AE signal under different tool wear states effectively, seven time domain statistical features are calculated and adopted as the feature vectors. The mathematical description and equation of these indicators are listed in Table 1 .
 4. Classification of tool wear based on CRF model 4.1. Tool wear classification based on CRF model
In this section, the CRF model is adopted to realize the tool wear classification based on the features extracted above. The application of the CRF model for the tool wear classification includes two steps.
The first step is training stage. In this stage, the LBFGS algorithm is used ( Pietra et al., 1997 ) to calculate the model parameters l and m iteratively based on the training samples. Because the length of feature vectors is 7 and the states number is 4, the sizes of l and m are 4 7and4 4 respectively. The termination criterion for the training process is the converge nt accuracy reaches certain fixed value. The flowchart of the CRF training is given in Fig. 4 . The second step is to realize the tool wear clas sification by taking these features as the input data. When this classifier is utilized in the tool condition monitoring system, the sensory signals need to be collected and preprocessed firstly. Then the statistical features are calculated and input into the trained CRF model. The category of the tool wear is finally recognized by calculating the maximal conditional probabil-ity using Eq. 4 . The flowchart of the CRF based tool wear classifica-tion is illustrated in Fig. 5 .

According to the steps above, the training and test samples are firstly generated by extracting seven statistical parameters from the acoustic emission signals and organizing them as the observa-tion sequences. To guarantee the generalization ability of the CRF model, 100 samples are selected from four tool wear state respectively, so the total number of samples is 400. The state of each sample for new cutter, small, middle and severe wear is labeled as 1, 2, 3 and 4 respectively. Then, these samples are divided into the training data and the test data. To improve the robustness of the classifier evaluation, k -fold cross validation method is adopted ( Anguita et al., 2009 ). The k -fold cross valida-tion method splits a dataset into k independent subsets. Then, k 1 subsets are used to train a classifier, while the remaining one is used to evaluate the generalization error. This procedure is repeated k times and each subset is adopted for testing only once. By averaging the test errors over k trials, it gives an estimation of the expected generalization error. Here in this paper, two-fold, four-fold and five-fold cross validation schemes are adopted. Based on these training data, the CRF model under different fold schemes is built according to the flowchart in Fig. 4 . Here, the initial model parameters l and m are set to zero and the convergent accuracy limit e is equal to 0.0001.The training curves under different folds schemes are shown in Fig. 6 from which it can be seen that the accuracy reaches the convergence limit e at most 27 times iterations. The maximum training time is 0.86 s using the AMD AthlonII X4 640 processor (3 GHz) with 4 G memory.

After these models are built, the test data is taken as the input and the states of tool wear can be recognized by calculating the maximum conditional probability. Moreover, the accuracy rate of different CRF models is calculated by comparing it with the real tool wear states, which are illustrated in Fig. 7 . It can be seen that the accuracy rate of the four kinds of tool wear states is higher than 95% and it can reach 100% for some data. Moreover, the difference between different folds schemes is very small which shows that the stability of the classifier is very strong. 4.2. Comparison with HMM model classification in some previous papers. To make a comparison with
CRF model, HMM is adopted to realize the tool wear classification with the same data. HMM ( Rabiner, 1989 ) model is composed of
Markov chain and stochastic process. The Markov chain corre-sponds to the state sequence, which is described by p and A .The stochastic process is depicted as the observation sequence, which is described by B . Therefore, a HMM model can be described as o  X f N , M , p , A , B g X  8  X  where, N is the state number of the Markov chain and M is the possible number of observed value in each state. The selection of N and M has important effect on the accuracy rate and there is no analytic rule to determine them currently. Therefore, the trial and error method is commonly used to decide their values. p is the initial probability distribution vector with length N , A is state transfer probability matrix with sizes N N and B is the probability matrix of the observed values whose sizes are equal to N M . include two steps. The first step is the construction of the HMM model. For each tool wear state, Baum X  X elch algorithm is adopted to calculate the model parameters so as to guarantee the maximum probability of the training data. Here N and M is selected as 12 and 8 respectively by using the trial and error method. Four HMM models are finally built to depict the relation-ship between four kinds of tool wear state and the selected features. The training curves of four HMM models under different folds schemes are given in Fig. 8 . The maximum computational Log-likelihood probability value Log-likelihood probability value time in the training process reach 5.76 s using the same micro processor as above. This speed is slower than the CRF model obviously.

The second step is to recognize the tool wear state by inputting the test data into the built model respectively. The probability of the test data coming from each HMM model is calculated by summing up the probability of each hidden state ( Rabiner, 1989 ).

PO 9 l  X  where, N is the number of the hidden states and q t denotes the current state. The tool wear category is finally recognized by using the following equation: C  X f n 9 P n  X  max  X  PX 9 o , i  X  1 , 2 UUU n g X  10  X 
This equation means that the label corresponding to the maximum probability is selected as the final tool wear state. The flowchart of the HMM based tool wear recognition is given in
Fig. 9 . Based on above algorithm, the tool wear state for each test data is recognized and the accuracy rate is calculated correspondingly by comparing them with the real tool wear label. The bar plot of the accuracy rate under different folds schemes is given in Fig. 10 . Comparing between Figs. 7 and 10 shows that the accuracy rate of the HMM is lower than the CRF model for every tool wear state. Moreover, the fluctuation between different folds schemes is larger than CRF model, which proves that the stability of the HMM is worse than the CRF based classifier. Therefore, it can be concluded that the CRF model significantly outperforms the HMM for the tool wear state classification. 5. Conclusions
In this paper, the CRF based sequence classification model is proposed to realize the tool condition recognition. The main characteristic of this method is that it allows arbitrary depen-dencies on the observation sequences. Therefore, the adjacent information in the training data can be utilized to build the relationship between the observation sequences and state sequences. To test the effectiveness of the proposed method, seven statistical features are extracted from acoustic emission signal to characterize the state of different tool wear severity. At the same time, the CRF and HMM is utilized respectively to realize the tool wear classification using k fold cross validation method. The analysis and comparison of the accuracy rate under different folds schemes show that the CRF model outperforms the HMM model for the recognition of the tool wear state. This method casts some new lights on the tool wear classification in real industrial environment.
 Acknowledgment
This project is supported by National Natural Science Founda-tion of China (51175371).
 References
