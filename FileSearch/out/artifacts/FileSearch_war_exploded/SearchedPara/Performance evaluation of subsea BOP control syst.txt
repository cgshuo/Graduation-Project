 1. Introduction providing safe working conditions for drilling activities in 10,000 ft ultra-deepwater regions. Subsea BOP failures could cause cata-strophic accidents such as the explosion of the deep-sea petro-leum drilling rig Deepwater Horizon and the oil spill off the coast of Louisiana on April 20, 2010. The subsea BOP on the Deepwater
Horizon rig was believed to have failed isolating the well before and after the explosions. The subsea BOP might have been faulty before the blowout, or it might have been damaged because of the accident ( Harlow et al., 2011 ; Skogdalen et al., 2011 ). redundant control system con fi guration is standard for the control of the subsea BOP. Such a system can provide the tolerance against single component failure. For this purpose, a highly reliable fault-attention in the fi eld of reliability analysis, and it is a particularly powerful tool for handling uncertainty information. In predictive analysis, the probability of occurrence of any node is calculated on the basis of the prior probabilities of the root nodes and the conditional dependence of each node. In diagnostic analysis, the posterior probability of any given set of variables is calculated given some observation (the evidence), represented as instantia-tion of some of the variables to one of their admissible values ( Bobbio et al., 2001 ). Nordgard and Sand (2010) described a methodology for application of BN for risk analysis in electricity distribution system maintenance management. Khakzad et al. (2011) demonstrated the application of BN in safety analysis of process systems, and compared the approaches of fault tree and BN. Jones et al. (2010) applied BN modeling to a maintenance and inspection department, and established and modeled various parameters responsible for the failure rate of a carbon black producing system, in order to apply it to a delay-time analysis study. Honari et al. (2009) showed how one may use Bayesian networks as a statistical technique to develop a new approach to evaluate the reliability of an ( r , s )-out-of-( m , n ): F system. Wilson and Huzurbazar (2007) extended the applications of Bayesian networks on binary outcomes to multilevel discrete data and discussed how to make joint inference about all of the nodes in the network.

A key issue in this thematic fi eld is the integration of two important features of redundant control systems including common cause failure and imperfect coverage into a BN and DBN model. They have signi fi cant effects on the system reliability, which have been studied by the traditional reliability methods ( Hoepfer et al., 2009 ; Li et al., 2010 ; Amari et al., 1999 ; Doyle et al., 1995 ). Few researches about Bayesian networks for reliability evaluation with respect to common cause failure and imperfect coverage were reported. Liu and Singh (2010) proposed a BN based method to investigate the overall effects of hurricanes on the reliability evaluation of composite power systems. This method used the Noisy-OR gate model to consider both common cause failures and independent failures of transmission lines and generating units. Langseth and Portinale (2007) introduced a coverage factor, which is de fi ned as the probability that a single failure entails a complete system failure, to Bayesian networks in order to model the inaccurate recovery mechanism of redundant system.

Another key issue is the integration of repair actions into a BN and DBN model. Flammini et al. (2009) presented both a failure model for voting architectures based on BN and a maintenance model based on continuous time Markov chains, and proposed to combine them according to a compositional multiformalism modeling approach in order to analyze the impact of imperfect maintenance on the system safety. Neil and Marquez (2012) presented a hybrid BN framework to model the availability of renewable systems. They used an approximate inference algorithm for hybrid BN that involves dynamically discretizing the domain of all continuous variables and used this to obtain accurate approx-imations for the renewal or repair time distributions for a system. Portinale et al. presented an approach to reliability modeling and analysis based on the automatic conversion of dynamic fault tree or series and parallel modules into BN taking repair into con-sideration ( Portinale et al., 2010 ; Codetta-Raiteri et al., 2012 ). However, few researches about BN with imperfect repairs and preventive maintenance are reported.

The work focuses on the DBN modeling of series, parallel and 2oo3 voting systems, taking account of common-cause failure, imperfect coverage, imperfect repair and preventive maintenance. The paper is structured as follows: Section 2 presents the DBN modeling of series, parallel and 2oo3 voting systems. Section 3 analyzes a case of subsea BOP control systems to demonstrate the application of the proposed DBN modeling. Section 4 summarizes the paper.
Components C1 and C2, C2 and C3, and C1 and C3, respectively. The basic events S123 refers to the common state of Components C1, C2 and C3. The system state is assigned to X. The events S1, S2, S3, S12,
S23, S13 and S123 are assumed to be independent due to the fact that they cannot occur simultaneously. For example, S1, S12, S13, and S123 denote one (C1), two (C1 and C2, C1 and C3) and three (C1, C2 and C3) components failure, respectively. As seen, they can all cause the failure of component C1; therefore, the four nodes are the parent nodes of node C1.
 different copies represent different states of the variables over time. The series, parallel and voting systems with common-cause failure are extended from 0th to 2nd week. As indicated in series system shown in Fig. 1 (a), the node S1 at time t  X  0 is extended to node S4 at time t  X  2 with an inter-slice arc, the node S12 at time t  X  0 is extended to node S14 at time t  X  2 with another inter-slice arc, and the node S123 at time t  X  0 is extended to node S124 at time t  X  2 with a third inter-slice arc. There is no relationship between parent nodes S1, S2, S3, S12, S23, S13 and S123, causing that no intra-slice arc is used to contact them. For these parent nodes, there are four states, namely, No, DS1, DS2 and Yes. The child nodes C1, C2 and C3, and system state X have two states, namely, No and Yes. The details of the states will be described in the following section.
 (4) The current degradation is observable through some system Each parent node of DBN involves four states, namely, No, DS1, DS2 and Yes. The state No refers to no failure or perfect function-ing state. The state Yes refers to failure or failed state. The states DS1 and DS2 refer to the fi rst and the second degraded states, respectively. Each parent node is initially in its perfect functioning state (No). As time progresses, it can either go to the fi rst (DS1) or the second (DS2) degraded states, or it can go to a failed state (Yes).

When the node reaches a last acceptable state, which is the second degraded state, preventive maintenance is performed to restore the node to the previous higher performance states. It can either only go to the perfect functioning state, which is considered to be perfect preventive maintenance, or it can go to the perfect functioning state and the fi rst degraded state, which is considered to be imperfect preventive maintenance.

If the inspection fi nds the node in the failed state, it cannot satisfy the demand, this must be treated as a failure, and a repair is required. It can either only go to the perfect functioning state, which is considered to be perfect repair, or it can go to the perfect functioning state as well as the two degraded states, which is considered to be imperfect repair. The failure rates and repair rates are given above the state transition arcs, as shown in Fig. 2 .
Assume that the current time is t , and the time interval between two successive trials is  X  t . Then, the transition relations between consecutive nodes without repair, with perfect repair, with imperfect repair, and with imperfect repair and preventive maintenance are given in Tables 1  X  4 , respectively ( Kohda and Cui, 2007 ).

For the sake of simplicity in the current study, given the failure rate  X  and repair rates  X  of each parent node, the failure rates  X  1 ,  X  2 ,  X  , be obtained from the following assumptive equations.  X   X   X  5  X  3  X  and  X  S123  X  3.54 10 7 . The MTTR for the parent nodes are
MTTR S1  X  MTTR S2  X  MTTR S3  X  5, MTTR S12  X  MTTR S23  X  MTTR S13  X  10, and MTTR S123  X  15. The repair rate is the reciprocal of MTTR.
Therefore, the failure rates and repair rates between the states of each node can be calculated using Eqs. (3)  X  (10) . Subsequently, the transition relations between consecutive nodes can be calculated using Tables 1  X  4 . 2.4. Conditional probability table nodes, it requires m n independent parameters to completely specify the CPT. It is unfeasible to specify so many parameters to quantify the relationship when n is large. When the relation between parent nodes and child node is OR, Noisy-OR gate model is used to solve this problem.
 pendence, and accountability are made in the models ( Neapolitan, 2003 ). Assume that there are n causes X 1 , X 2 , ... and X n of Y , the variable I j is the mechanism that inhibits X j . The I j are independent owing to exception independence assumption. The variable A j is on if and only if X j is present and is not being inhibited. And Y should be present if any one of the A j is present owing to the causal inhibition assumption. Therefore, the Noisy-OR gate model can be expressed as follows:
P  X  Y j X 1 ; X 2 ; ... ; X n  X  X  1  X  systems, the degradation probabilities are P (C1  X  Yes | DS1  X  Yes)  X  2.1% and P (C1  X  Yes | DS2  X  Yes)  X  5.2%. The child node C1 have n  X  4 parent nodes S1, S12, S13 and S123, and for each parent node, it has m  X  4 states No, DS1, DS2 and Yes; therefore, the CPT of C1 have m n  X  256 states. By using Eq. (11) , the CPT of C1 is calculated as shown in Table 5 . Two methods can be used to input the CPT into Netica software, which are (a) using Noisy-OR equation directly in Equation Support Function of Netica, and (b) copying 2oo3 voting system, it can recover when only one component fails. Therefore, the imperfect coverage makes sense for both of parallel and 2oo3 voting systems. It is modeled in the CPT of system state X with a given coverage factor c , as shown in Tables 6  X  8 . For the two systems, the coverage factor c is 0.95. 2.5. Reliability and availability
Fig. 3 reports the reliability and availability with respect to perfect repair, imperfect repair, and imperfect repair and preventive main-tenance for series, parallel and 2oo3 voting systems. As indicated in Fig. 3 (a), with the increasing of time, the reliability and availability for series system decreases. The reliability drops to almost 0 in about 1000th week. Because of the repair, the availability decreases slowly. When perfect repair is considered, it reaches a value of approximately 0.907 in about 1000th week. When imperfect repair is considered, it reaches a lower value of 0.898 in about 1000th week. If both of imperfect repair and preventive maintenance are considered, the availability improves greatly, and reaches a high value of 0.956 in about 1000th week. It can be seen that the imperfect repair does not degrade the performances of series system signi fi cantly, whereas the preventive maintenance improves the performances signi fi cantly.
Similar results for parallel and 2oo3 voting systems are obtained, as shown in Fig. 3 (b and c). However, the reliability and availability values are higher than series system. The reliabil-ities with perfect repair drop to about 0.723 and 0.312 for parallel and 2oo3 voting systems in about 1000th week. The availabilities with perfect repair reach the values of approximately 0.9953 and 0.9921, and availabilities with imperfect repair reach the values of approximately 0.9948 and 0.9910, and availabilities with imperfect repair and preventive maintenance reach the values of approxi-mately 0.9978 and 0.9974 for parallel and 2oo3 voting systems in about 1000th week. The results also suggest that the imperfect repair does not degrade the performances of parallel and 2oo3 voting systems signi fi cantly, whereas the preventive maintenance improves the performances signi fi cantly. 3. Case study 3.1. Con fi guration of subsea BOP control system A PLC-based fault-tolerant redundant control system for subsea BOP is schematically illustrated in Fig. 4 ( Cai et al., 2012a ). The system includes surface components, connecting umbilical cables and subsea components ( Cai et al., 2012b ). The surface components, which are located in drilling rig, are mainly the CCU. It consists of three PC in central control unit, driller's station and toolpusher's station, and three PLC, forming a triple modular redundant processor subsystem. The communications between PC and PLC are completed via an Ethernet network by using two redundant ES. Therefore, the PC, PLC, and ES subsystems can be considered as parallel with two or three components.

The subsea components are two sets of independent input and output subsystems, locating in the SEM of blue and yellow control pods. The AI and DI subsystem performs 3-2-1-0 voting by the Genius modular redundancy software, which can be considered as parallel with three components. The DO voting is performed at the H-Block output subsystem. Each output subsystem is supported by two Genius source output blocks (DO-A and DO-B) and two Genius sink output blocks (DO-C and DO-D). The sink output block DO-D is controlled by source output blocks DO-A and DO-B, which can expressed as DO-D  X  DO-A&amp;DO-B. Therefore, the output subsystem performs 2oo3 voting for the blocks DO-A, DO-B and DO-C using the data from the PLCs. The communications between CCU and in Fig. 5 . For the surface subsystems, the failure of any one of the PC, PLC, and ES subsystems will cause the failure of CCU; therefore, the three subsystems are connected together through series relationship. For the subsea subsystems, both of failure of subsea blue and yellow pods will cause the failure of subsea control system; therefore, the two control pods are connected together through parallel relationship. For the surface subsystems, includ-ing PC, PLC, and ES, common-cause failure, imperfect coverage, perfect repair, imperfect repair, and preventive maintenance are modeled in the DBN. For the subsea subsystems, including AI, DI, and DO, common-cause failure and imperfect coverage are mod-eled in the DBN. Only when one SEM fails, the other one will be used to operate all of the subsea functions and be not affected by the disabled one, which will be retrieved to the surface for repair. Therefore, for the subsea subsystems, only perfect repair are modeled in the DBN. For the sake of simplicity, the Genius buses and fi ber optic repeaters are not modeled in DBN.

As indicated in Fig. 5 , each parent node is initially in its perfect functioning state (No  X  100%) in 0th week, and has different probabilities for each state in 2nd week because of the failure and repair. The basic events Mn of DBN, which refer to n components fails simultaneously for M because of the common-cause failure, are shown in Table 9 . The values of failure rate, MTTR, DS1 and DS2 for each basic event are listed in the 3rd  X  6th columns. 3.3. Evaluation and validation
The quantitative reliability evaluation of subsea BOP control system is performed using Netica software, in which can use the networks to perform various kinds of inference using the fastest and most modern algorithms, such as Junction Tree algorithm ( Murphy, 2002 ). The reliability and availability of subsea BOP control system with common-cause failure, imperfect coverage, perfect repair, imperfect repair, and preventive maintenance are evaluated via forward analysis, and the posterior probability given the system failure is evaluated via backward analysis. The mutual information is researched in order to assess the important degree of basic events. The analysis results can provide useful information to handle the risk incident or prevent the accident reoccurring. The effect of degradation probability, failure rate and MTTR on the 3.4. Results and discussions 3.4.1. Reliability and availability system within 30 weeks is investigated using DBN. The prior prob-ability and posterior probability given the system failure in 30th week with imperfect repair and preventive maintenance are given in the 7th and 8th columns of Table 9 .
 repair, and preventive maintenance are plotted in Fig. 6 .As indicated, as time progresses, the reliability and availability decrease. The reliability drops to about 0.99466 in 30th week, and the availability reaches the values of approximately 0.99823, 0.99819 and 0.99859 in 30th week for the system with perfect repair, with imperfect repair and with imperfect repair and pre-ventive maintenance, respectively. Obviously, the availabilities with perfect repair and with imperfect repair are almost the same, which PLC3 and PC3) contribute much. The subsea components, such as AI, DI and DO, contribute little to the system failure in comparison with the surface components, due to the facts that the yellow and blue SEM provide completely redundant control of subsea func-tions. Therefore, the single surface components and the compo-nents with all-common-cause failure should given more attention in order to improve the performance of subsea BOP system and prevent the potential accident occurring. 3.4.3. Effect of degradation probability
Three basic events of single component failure, PC, ES, and PLC, are sensitive to subsea BOP system failure according to the mutual information investigation. Each degradation probability of DS1 and DS2 for the three components increases 5% from the values given in Table 9 , the reliability and availability of subsea BOP control system are calculated. The three-dimensional surface plots show-ing the effects of DS1 and DS2 of PC, ES, and PLC on the reliability and availability are shown in Fig. 8 .
 in fl uence of each failure rate and MTTR are clearly different.
Accounting for the failure rate and MTTR of a single component, the in fl uence on the reliability and availability is in the following order: PLC 4 ES 4 PC 4 DO 4 DI 4 AI. The analysis results suggest that surface components PLC, ES and PC contribute considerably to the reliability and availability, which should be given more attention when designing a subsea BOP control system. 3.4.5. Validation of the model a reasonable representation of an actual system. A sensitivity analysis has been carried out in order to give a partial validation of the model. The model should at least satisfy the three axioms described in
Section 3.3 . Taking the child nodes of ES shown in Fig. 5 for example, when the state Yes of ES_SA is set to 50% from 0%, the reliability of system decreases to 0.9947 from 0.9657, and the availability decreases to 0.9986 from 0.9984. When both the change plus the state Yes of
ES_SB are set to 50%, the reliability of system decreases to 0.7170 and the availability decreases to 0.9982. Finally when the state Yes of last parent node ES_SAB is set to 50% the r eliability of system decreases to 0.3585, and the availability dec reases to 0.9976. The exercise of increasing each in fl uencing node satis fi es the axioms, thus giving a partial validation to the model.
 another similar case subsea production control system, and the validation results are correct, which indicates that the proposed
DBN model is generic and correct. 4. Conclusions series, parallel and 2-out-of-3 voting systems, taking account of common-cause failure, imperfect coverage, imperfect repair and preventive maintenance. A case of subsea BOP control system is analyzed to demonstrate the presented DBN modeling. (1) The repairs and maintenance can improve the performances of (2) The single surface components (ES1, PLC1 and PC1) and the (3) The in fl uence of degradation probability on the performance (4) The in fl uence of failure rate and MTTR on the performance of (5) The sensitivity analysis partially validate the proposed DBN reliability evaluation and fault diagnosis by extending the pro-posed DBN model.

