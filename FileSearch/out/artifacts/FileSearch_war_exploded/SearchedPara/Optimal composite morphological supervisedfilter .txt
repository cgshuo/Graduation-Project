 fi 1. Introduction
Magnetic resonance imaging (MRI) is widely used technique in medical diagnostic. Although it is very useful but images obtained are highly sensitive to noise. Denoising and enhancement of MR signal improve the accuracy of diagnostic system in clinical areas. This area has attracted considerable interest in the image processing research ( Llado et al., 2012 ). MR signal is usually affected at the acquisition time by several artifacts and noise sources. One of them is thermal noise that degrades the signal to the extent to get any quantitative information ( Manjon et al., 2008 ). Averaging of multiple acquisitions during scan can be one of the remedy to this problem. This process is not a common practice in the clinics, as increasing the acquisition time is dangerous to human health. Therefore rather than experimenting on human life the effort is being put on post processing of already obtained MR data. Several enhancement methods are applied to get reasonable data ( Manjon et al., 2012 ).
In MRI the raw data are acquired in spatial frequency space. The acquired raw data are intrinsically complex valued and corrupted by Gaussian distributed noise. The data remain complex and Gaussian distributed after applying an invers e Fourier transform. After inverse Fourier transform the signal amplitude can be estimated directly from the complex valued data, or one can fi rst perform a magnitude operation on this data and estimate the signal amplitude from the obtained magnitude data. The magnitude operation changes the distribution of the data from Gaussian to Rician ( Macovski, 1996 ). Rician noise restoration is a complex task due to its variation. In low intensity regions of the signal, the Rician distribution tends to Rayleigh distribution while in hig h intensity regions it approaches to Gaussian distribution ( Nowak, 1999 ). The search for ef effective denoising methods is still a valid challenging task.
In the literature, a variety of denoising methods have been proposed in the spatial and transform domains. One common and simple approach is to apply the Gaussian fi lter ( Ashburner and Friston, 2000 ). This method is capable of reducing noise, particu-larly it is effective in homogeneous areas but affects high frequency signal. As a result this method blurs edges in the images. However, it is widely applied for regularization purpose (such as in voxel-based morphometry) ( Ashburner and Friston, 2000 ) to reduce anatomical inconsistencies ( Manjon et al., 2012 ).
In order to overcome this problem a large number of edge preserving fi lters are used such as anisotropic diffusion ( Gerig et al., 1992 ). This method is based on gradient information keeping the important image structures unchanged. Recently a new variant of ADF is proposed for Rician noise removal that has achieved good results based on a linear minimum mean squared error and partial differential equations ( Krissian and Aja-Fernandez, 2009 ).
 include discrete wavelet transform ( Pizurica et al., 2003 ), principal component analysis ( Muresan and Parks, 2003 ), and discrete cosine transform ( Yaroslavsky et al., 2001 ). Mostly, these methods are based on transform-threshold-inverse transform principle. In recent years, local transform approaches (i.e., sliding-window with or without overlapping) have obtained good results than trans-form domain approaches ( Manjon et al., 2012 ).
 based on the natural redundancy of patterns within the images, and considered as a very simple and effective technique to reduce noise while preserving the structural information of the image ( Buades et al., 2005 ). In the literature, multiple variants of NLM fi lters are used to denoise MRI ( Manjon et al., 2008 , 2012 ). In unbiased NLM the variance of noise should be known however in some applications the noise variance is unknown hence causing the technique to fail. Adaptive NLM fi lters have been introduced to overcome this problem by estimating noise ratio from the noisy images ( Manjon et al., 2012 ). Most of the above discussed methods show reasonable performance only when the image model corre-sponds to the algorithm assumptions. Otherwise these techniques blur the edges in the image and introduce some bias in the quanti fi cation process.
 tors (MMO) have been used in image processing ( Maragos and
Schafer, 1987a , 1987b ; Sinha et al., 1997 ; Bloch, 2011 ) and are getting considerable attraction in noise reduction ( Sinha et al., 1997 ; Verd-Monedero et al., 2011 ; Ze-Feng et al., 2007 ). In the framework of MM, the set-theoretic interpretation of the mor-phological fi lters is analyzed and introduced the classical linear fi lters in terms of morphological correlations ( Maragos and
Schafer, 1987a ). The theory of non-linear fi lters (median, order-statistic, and stack fi lters) has been extended by using MM, and their relation with basic morphological operations has been analyzed ( Maragos and Schafer, 1987b ). In MM based fi lters, the combinations of the basic MMO and the shape of the structuring element are important parameters. Most of the above discussed
MM based approaches depend on some pre-fi xed MMO combina-tion. Therefore, in diverse nature of noise levels in MRI the performance of these approaches is limited.
 phological fi lters to enhance the denoising capability ( Sharif et al., 2010 ; Terebes et al., 2002 ). Genetic algorithm is applied to combination of morphological operators and morphological mask (shape and size of neighborhood) for binary image denoising ( Terebes et al., 2002 ). Later this idea is extended for gray-scale images by using binary particle swarm optimization method ( Sharif et al., 2010 ). Gray-scale soft morphological fi used in the literature for automatic image restoration ( Hamid et al., 2003 ). While these approaches are able to enhance the denoising performance by obtaining the optimal parameters of the composite fi lters, they are still suffering from the same limitation i.e. the use of pre-fi xed combination of different MMO. Thus, the development of an optimal composite fi lter that can effectively combine multiple MMO for optimal results is a challenging task. programming (GP) based approach to combine MMO for denoising
MRI. GP approach works on the prin ciples of natural selection and recombination to search the space for possible solutions and widely used in the applications of image processing, pattern recognition, and computer vision ( Mahmood et al., 2011 ; Choi and Choi, 2012 ). In proposed scheme, an optimal composite morphological supervised fi lter ( F OCMSF ) is evolved through a certain number of generations by combining the gray-scale MMO under a particular fi tness criterion. The composite fi lter is then applied to restore the actual image from its noisy version. The proposed method does not need any prior informa-tion about the variance of noise or point spread function (PSF). The improved performance of the developed fi lter is investigated using the standard MRI datasets and its performance is compared with the existing well-known methods. Comparative analysis demonstrates the superiority of the proposed GP based scheme over the existing approaches.

In the remainder of the paper, Section 2 describes input preparation and the development of GP-based composite fi lter in detail. In Section 3.1 the description of experimental setup and implementation details are given. Comparative analysis is provided in Section 3.2 using the well-known qualitative measures to evaluate the performance of the proposed scheme. Finally, Section 4 con-cludes this study. In addition, frequ entlyusedsymbolsandnotations are summarized in Table 1 . 2. Proposed technique
The aim of the proposed approach is to develop a GP based composite morphological fi lter to restore the original image f  X  x from its degraded and noisy version g  X  x ; y  X  . The proposed method is divided into three modules: preprocessing module, GP module and evaluation module. In preprocessing module, the required components for the development of the proposed GP based fi are prepared. These include selected morphological operators, structuring element, original image, degraded image, and features of the original image. During GP process, F OCMSF is evolved through evaluating the fi tness of several individuals over certain numbers of generations. The evaluation module provides the mechanism for measuring the performance of the evolved fi lter. The block diagram of the proposed GP based scheme is shown in Fig. 1 . 2.1. Preprocessing module 2.1.1. Construction of degraded images
In preprocessing module, fi rst, an input data for the GP module is prepared. g  X  x ; y  X  is constructed by adding Rician noise to f  X  x Rician noise is incorporated by adding white Gaussian noise to the real and imaginary parts of the original MR magnitude image. The Rician noise is built from white Gaussian noise in the complex domain as f  X  x ; y  X  X  f  X  x ; y  X  X   X  1  X  x ; y  X  ;  X  1  X  x ; y  X   X  N f  X  x ; y  X  X   X  2  X  x ; y  X  ;  X  2  X  x ; y  X   X  N  X  0 ; s  X  g  X  x ; y  X  X  where f r  X  x ; y  X  is the real component of f  X  x ; y  X  , f imaginary component of f  X  x ; y  X  , and s is the standard deviation of the white Gaussian noise. 2.1.2. Features
In proposed scheme, the fi tness of an individual during the GP evolution process depends upon the features of the original and observed images. In this module, a set of n features V f for f  X  x are calculated, denoted as V f  X f V 1 f ; V 2 f ; V 3 f ; ... ; partitioned into 3 3 non-overlapping n number of blocks. If f  X  x ; y  X  is not divisible into 3 3 blocks, then the image should be padded with the replication of last row and last column to make it divisible into 3 3 blocks. For each block, statistical features such as mean, median and variance can be computed. These features are used during the learning process for the optimal solution. These features may affect the learning time for obtaining an optimal solution. In proposed approach a single value feature for each block is calculated, using the weighted average (weighted arithmetic mean) of the pixel intensity values of the block, de as V where f k  X  x ; y  X  is the k th non-overlapping block and w is a weight matrix as  X 
The size of the resultant features set V f is equal to 1/9 of f  X  x size. V f is passed to the GP module that is to be used for the evaluation during the evolution of GP. 2.1.3. Morphological mask and operators
The proposed technique fi nds the fi lter that is a combination of morphological operations. These operations are based on set-theory and provide a powerful methodology for quantitative analysis of geometrical structures ( Serra, 1982 ). The basic opera-tions of MM are using non-linear algebra. These operations are depended upon a mask/structuring element S , used as a fi mask, that has a important role in morphological operations. In proposed technique an octagon shaped structuring element of radius ( R  X  3) is used, gives empirically good results for Rician noise estimation, de fi ned as
S  X 
Octagon creates a fl at, octagonal structuring element, where radius speci fi es the distance from the structuring element origin to the sides of the octagon, as measured along the horizontal and vertical axes.
 the GP module, as non-terminal node s. In proposed scheme primitive and extended gray-scale morphological operators are used: 2.2. GP module evolves the required fi lter. In order to train the fi lter, the degraded image and set of morphological operators are provided to the GP evolutionary process. Table 2 shows all the necessary parameter settings for the GP simulation. 2.2.1. Initial population evolutionary process. The initialization process places the indivi-duals at the initial starting points in the search space. This module generates the initial population of Z number of individuals. The individuals in GP are tree structures constituent of terminal (leaf) and non-terminal nodes. In the proposed scheme, the non-terminal nodes represent morphological operators and the term-inal nodes represent the degraded image. The initial population is created using ramped half-and-half method ( Koza, 1992 ), ensures a good initial sample of trees. In this method, half of the tree structures of the initial population must have all the branches of maximum depth and the remaining tree structures have all the branches not exceeding the maximum depth, where the maximum depth represents the height of a tree equals to the length of the longest path from the root to a leaf node. In the second step, the fi tness of each individual tree is evaluated. 2.2.2. Fitness measure for GP module
It provides feedback to the GP module about the fi tness of the individuals. The fi tness measure indicates how effectively a GP individual moves towards the best solution. In the proposed GP evolution process, an individual i represents a candidate solution, comprises MMO and g  X  x ; y  X  . Fitness of the individual i is calculated in three steps as shown in Fig. 2 . In general for any individual, the observed image is calculated from the corresponding indivi-dual by performing the morphological operations on the degraded image. Second, ^ f  X  x ; y  X  is divided into 3 3 non-overlapping blocks blocks, then it should be padded with the replication of last row and last column to make it divisible into 3 3 blocks. The feature
V ^ f  X  k  X  X   X  1 where k shows the block number in ^ f  X  x ; y  X  . Finally, root mean squared error (RMSE) of the feature sets, V ^ f and V f of f  X  x ; y  X  , respectively, is calculated. This value is used as the value of the corresponding individual. The fi tness of an individual i is computed as
Fitness i  X 
It has been analyzed empirically by the authors that the proposed scheme for denoising brain MRI to remove Rician noise, weighted average (Eq. (2) ) in case of V f and median (Eq. (16) ) in case of V gives us better results. 2.2.3. New generation
Genetic operators need parent individuals to produce their children. Lexicographic tournament selection method is used for the selection of parent individuals ( Luke and Panait, 2002 ). Like in tournament , a random number of individuals are chosen from the population and the best of them is chosen. The main difference is, if two individuals are equally fi t, the tree with less nodes is chosen as the best. This technique controls the bloating effect in the GP process ( Silva, 2007 ). For each team of the tournament, the best individuals are ranked and selected, based on the survival of the fi ttest rule. The probability Pr i of an individual i to be selected is computed as Pr  X  Fitness i Total fitness  X  18  X  where Total fitness  X   X  z where z is a size of the tournament's team, and is equal to 1% of the population size. Crossover, mutation, and replication operators are applied on the selected individuals to generate new popula-tion. The simulation is run until the termination criteria is ful i.e., either if the number of generations reaches the maximum limit or the fi tness value approaches the minimum set value.
On termination of GP evolution, the evolved function ( F OCMSF best individual is obtained. 2.3. Evaluation module fi lter F OCMSF is described. Once, the composite fi lter F developed, it is simple and time ef fi cient to estimate image from its noisy version. The estimated image ^ f  X  x ; y  X  is obtained by passing the noisy image g  X  x ; y  X  to the developed fi lter F notable that the g  X  x ; y  X  denotes any noisy image. It can be obtained by adding noise in the MRI datasets as we did for the training purpose or/and the image may contain noise at the acquisition time. The developed fi lter is able to estimate image from its noisy image and symbolically, it can be represented as ^ f  X  x ; y  X  X  F OCMSF  X  g  X  x ; y  X  X  X  20  X 
In this work, in order to test and evaluate the proposed fi we created several noisy images by adding Rician noise to MRI datasets with varying noise density. The degraded images are then passed to the developed fi lter to estimate noise free images. It is notable that the noisy images are different from the images used during the training of the fi lter. Thus, the generalization property of the proposed fi lter is also evaluated during the experiments. In addition, we have ground truth images for the noisy images. Thus, we are able to evaluate performance of the proposed fi lter by using qualitative measures. In order to measure the performance of the proposed method, we use the most widely used qualitative measures: Root mean squared error (RMSE), peak signal to noise ratio (PSNR), structural similarity index measure (SSIM), and of merit (FOM). 2.3.1. Root mean squared error (RMSE) The mean squared error of these two images is
RMSE  X  f  X  x ; y  X  ; ^ f  X  x ; y  X  X  X  where m and n represent the size of the image. 2.3.2. Peak signal to noise ratio (PSNR) calculated as
PSNR  X  f  X  x ; y  X  ; ^ f  X  x ; y  X  X  X  10 log 10 GL where GL represent the number of gray levels. 2.3.3. Structural similarity index measure (SSIM) hypotheses that human visual system is highly adopted for extracting structural information. This is a method for measuring the similarity between two images. SSIM is designed to improve on traditional methods like PSNR and MSE. These methods have proved to be inconsistent with human eye perception. The SSIM metric is calculated on various windows of an image. The measure between two windows x and y of common size NN (default window sizes are 8 by 8) is SSIM  X  x ; y  X  X  the variance of x , the variance of y , and the covariance of x and y , respectively. c 1 and c 2 are two variables to stabilize the division with weak denominator, c 1  X  X  k 1 L  X  2 , and c 2  X  X  k 2 L  X  dynamic range, k 1  X  0 : 01, and k 2  X  0 : 03. The resultant SSIM index is a decimal value between 1 and 1. The value 1 represents that two sets of data are identical. 2.3.4. Figure of merit (FOM)
FOM is used to compare edge preservation performances of different noise reduction schemes. The FOM ranges between 0 and 1, and is de fi ned by ( Liang et al., 2008 ) FOM  X  1 where ^ N and N ideal are the number of detected and ideal edge pixels, respectively, d i is the Euclidean distance between the i th detected edge pixel and the nearest ideal edge pixel, and constant typically set to 1/9. FOM value is unity for ideal edge detection ( Liang et al., 2008 ). 3. Results and discussions 3.1. Experimental setup In experiments, the simulation of three types of standard BrainWeb phantom datasets is analyzed: T1-weighted (1 mm 3 voxel resolution), T2-weighted (1 mm 3 voxel resolution), and PD-weighted (1 mm 3 voxel resolution) ( Cocosco et al., 1997 ). Every BrainWeb phantom dataset (T1, T2, and PD) composed of 181 number of 2-D images, where size of an image (slice) is 181 217. proposed scheme for the datasets T1-weighted, T2-weighted, and PD-weighted, respectively.

In order to develop the F OCMSF , the training data has been prepared using slice number 70, of each dataset. First, the noisy image g  X  x ; y  X  , is created from the original synthetic image f  X  x using slice number 70 by adding Rician noise with 10% density. A set of features vector of the form V f is calculated. The length of the resultant V f is equal to 1/9 of the size  X  181 217  X  of f  X  x improves the temporal ef fi ciency of the GP evolution. g  X  x and O are passed to the GP module for the GP evolution. During the evolution process, the observed image ^ f i  X  x ; y  X  is computed for an individual i . The fi tness of an individual i in GP evolution process is calculated, using Eq. (17) . Fig. 3 shows the accuracy versus complexity of the best individual in each generation, for the fi lter development for the T1-weighted MRI, using the proposed scheme. In this fi gure, the (a) part shows the improvement in accuracy in each generation, and the (b) part shows the complex-ity as a function of tree depth levels and the number of nodes, obtained at the end of simulation. This is clear from the in several regions, the complexity of the GP grows exponentially without appreciable improvement in the accuracy, because in GP evolution, constructive blocks are created that try to minimize the destruction of useful building blocks ( Majid et al., 2006 ). This fi gure shows with the increase in complexity, accuracy curve approaches towards the optimal solution. In order to fi nd the optimal fi lter, several GP runs were carried out and the best function is reported. At the end of GP simulation, the developed fi lters in the pre fi x form are given as well.
 weighted, T2-weighted, and PD-weighted datasets, respectively.
The tree structure for the evolved fi lter F  X  T 2  X  OCMSF where g  X  x ; y  X  is at terminal nodes and the operators are at non-terminal nodes.
 3.2. Comparative analysis
There are 181 number of images in each of testing MRI dataset (T1, T2, and PD -weighted). The proposed scheme is applicable to all the images (slices) in each dataset. Three images (slice number 70, 110, and 150) have more complex structures and cover approxi-mately all of the structural and detail information in each MR volume as shown in Fig. 5 . Therefore for the evaluation of the proposed scheme with the existing methods, the results of these three images for different datasets are incorporated in the manuscript.
In order to measure the quality of the restored image ^ f  X  x compare the results quantitatively, four types of qualitative mea-sures (RMSE, PSNR, SSIM and FOM) have been used. The accuracy of the proposed scheme is evaluated using the noise variances (5%, 10%, 15%, and 20%). The performance is then compared with the well-known approaches ADF ( Gerig et al., 1992 ; Perona and Malik, 1990 ; Samsonov and Johnson, 2004 ), median fi lter (MF) ( Lim, 1990a ), adaptive Wiener fi lter (AWF) ( Lim, 1990b ), and NLM ( Manjon et al., 2008 ). All of the experiments were performed using Matlab 7.9.0 ( Matlab, 2009 ) and the parameters of these techni-ques are tuned for the best possible results.

The quantitative results listed in Tables 3  X  8 clearly show the improvement in four parameters (RMSE, PSNR, SSIM, and FOM) compared with the other methods already mentioned above. The results for T1, T2, and PD are shown in Tables 3  X  8 , respectively. The quantitative outcome of four parameters from F OCMSF evi-dently show the improvement compared with the other methods.
Qualitative comparisons of the proposed algorithm with the other existing approaches are shown in Figs. 6  X  8 for T1, T2, and PD-weighted images respectively where these images were degraded with Rician noise levels of 10%, 5%, and 20%, respectively. In visual comparison each fi gure shows the comparison of the restored images by using the proposed scheme and existing techniques. It is cleared from these results that NLM fi lter is the nearest competitor to our scheme. Finally we can conclude from the tabulated and visual results that the proposed method outperforms the other existing techniques for low and high level of Rician noise. It can be observed that the proposed approach has preserved edges and fi ne details of the restored images as well. 4. Conclusion and future work In this work, GP based supervised denoising approach for the Rician noise removal is presented. The proposed method is able to explore an optimize sequential order of morphological operators and best suitable morphological structuring element. The explored optimal fi lter F OCMSF is a combination of basic morphological operators. The results are compared quantitatively and visually with the available techniques. Comparative analysis has shown the effectiveness of the current technique that can contribute to the clinical research.

The proposed scheme provides a combination of pure gray-scale MMO for Rician noise removal that can be improved by using fuzzy morphological operators in addition. This model can be improved by making a hybrid fi lter of the existing fi lters. The proposed idea can also be used for the detection of noisy pixels in detection-removal based image denoising techniques. In future, the proposed approach would be extended to be applicable for unsupervised denoising of the magnitude MR data as well. Acknowledgment
This research was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) grant funded by the Ministry of Science, ICT &amp; Future Planning (MSIP) (2013-R1A1A-2008180).
 References
