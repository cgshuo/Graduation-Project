 In stock markets, an emerging challenge for surveillance is that a group of hidden manipulators collaborate with each other to manipulate the price movement of securities. Re-cently, the coupled hidden Markov model (CHMM)-based coupled behavior analysis (CBA) has been proposed to con-sider the coupling relationships in the above group-based behaviors for manipulation detection. From the modeling perspective, however, this requires overall aggregation of the behavioral data to cater for the CHMM modeling, which does not differentiate the coupling relationships presented in different forms within the aggregated behaviors and de-grade the capability for further anomaly detection. Thus, this paper suggests a general CBA framework for detecting group-based market manipulation by capturing more com-prehensive couplings and proposes two variant implementa-tions, which are hybrid coupling (HC)-based and hierarchical grouping (HG)-based respectively. The proposed framework consists of three stages. The first stage, qualitative analysis, generates possible qualitative coupling relationships between behaviors with or without domain knowledge. In the sec-ond stage, quantitative representation of coupled behaviors is learned via proper methods. For the third stage, anomaly detection algorithms are proposed to cater for different ap-plication scenarios. Experimental results on data from a ma-jor Asian stock market show that the proposed framework outperforms the CHMM-based analysis in terms of detecting abnormal collaborative market manipulations. Additionally,  X 
Email: yin.song@student.uts.edu.au.  X  Corresponding author (xwu@uvm.edu).
 the two different implementations are compared with their effectiveness for different application scenarios. H.2.8 [ Information Systems ]: Database applications X  Data Mining Algorithms, Economics, Security Coupled behavior analysis, anomaly detection, market ma-nipulation, coupled hidden Markov model, hierarchical clus-tering, relational learning
For many decades, human behavior analysis has been ex-tensively investigated in many fields, such as social and be-havioral sciences [5, 13] and computer science [10]. For simplicity,  X  X ehavior X  in this paper is used as a synonym of  X  X uman behavior X , which refers to an action from a hu-man and usually interacts with behaviors of his/her own and of other actors [3].  X  X oupled X  in this paper refers to ac-tors and their behaviors having certain relationships which are not independent. The interactions within an actor are referred to as intra-coupled relationships (interchangeable with  X  X ntra-couplings X ) while inter-coupled relationships (in-terchangeable with  X  X nter-couplings X ) are between behaviors of different actors [3]. Taking the couplings into account is critical for a deep understanding of group behaviors in many real-life scenarios. For instance, in stock markets, in-vestors X  trading behaviors are not isolated but affected by each other, which is caused by the supply-and-demand na-ture of the markets. Most of existing research efforts on behavior studies, however, focus mainly on individual be-haviors [4]. A comprehensive analysis of intra and inter-coupled relationships is beyond current individual behavior analysis techniques, to the best of our knowledge. In addi-tion, the intra-and inter-couplings between behaviors are usually implicit or hidden, making it even more challeng-ing to define, model and analyze the coupling relationships among behaviors in a group.

One useful application of considering these intra and inter-couplings is to detect abnormal coupled behaviors in stock markets [4]. As mentioned before, the behaviors of investors are inherently coupled with each other. Meanwhile, on some trading days, some investors (termed as  X  X anipulators X ) may intentionally arrange trading behaviors for the purpose of exceptionally high profit, which is not allowed by the corre-sponding regulations and could bring great losses to other investors. Any financial market regulators are keen to effec-tively detect these coupled trading behaviors and discover such manipulations. As initial attempts for this purpose, the CHMM-based CBA [4] suggests a method to implicitly represent the couplings in statistical models, such as CHMM [2]. It regards all the actors as a whole group, aggregates their behaviors for each time interval and analyzes the aggre-gated behaviors based on a CHMM. This is feasible to some extent but has some limitations: e.g., segmentation and ag-gregation of the behaviors may lose important coupling in-formation within these aggregated behaviors, which may fur-ther deteriorate the performance of anomaly detection. In other words, capturing richer couplings for coupled behav-ior analysis may enhance the capability of detecting manip-ulations. Motivated by this, this paper proposes a general CBA framework to capture richer coupling relationships be-tween behaviors, which is further used to detect anomalies in group-based behaviors. By capturing more comprehensive couplings between the behaviors, better anomaly detection performance is expected.

The main contributions of this paper are summarized as follows.
The remainder of this paper is organized as follows. Sec-tion 2 describes the proposed general CBA framework. Then the hybrid coupling-based implementation of the proposed framework is described in Section 3, when assuming there is no domain knowledge of the coupling relationships. Sec-tion 4 describes another variant of the proposed framework based on a hierarchical grouping representation, when some domain knowledge is available. Section 5 reports the exper-imental results while conclusions are drawn and future work is discussed in Section 6.
The proposed framework consists of three key stages: qual-itative analysis, which converts the transactional data to proper representations and provides a flexible coupling struc-ture for the next-stage quantitative coupling relationships modeling; quantitative analysis, which characterizes the cou-pled behaviors by learning the corresponding model and is helpful for further analysis; and anomaly detection, which is the final stage of checking whether or not the new coupled behaviors are abnormal. The following sections describe how the proposed framework works, which is depicted in Fig-ure 1.
Here we first briefly review the concept of coupled behav-iors . Suppose there are I actors, and an actor i undertakes m i behaviors b i1 , b i2 ,  X  X  X  , b im i . Each actor i  X  X  j ior b ij is associated with a behavioral type T ( b ij )= t (e.g., buy, sell and trade.). Each behavioral type t  X  T has a number of associated properties P t =( P t 1 ,P t 2 ,  X  X  X  may vary for different t value). Thus, each behavior b ij associated with a set of behavioral property value (a vector) ( p 1 ,  X  X  X  ,p behavioral type t b ij .A behavior feature matrix FM ( b )for all actors for a specific period of time can be then repre-sented as follows [3]: where m max =max { m 1 ,m 2 ,...,m I } , and for each actor i ,if m i &lt;m max the corresponding element b ij ( m i &lt;j m max ) is defined as  X  , which means no action taken. Thus, the intra-couplings are reflected by the relationship between elements within one row of the above matrix, whereas the re-lationships between elements of different rows indicate the inter-couplings .Actor i  X  X  behaviors b ij are intra-coupled with other behaviors of the same actor in terms of the cor-responding function  X  i k (  X  )(1 &lt;j  X  m i ,k = j )andinter-coupled with other actors X  behaviors in terms of the cor-responding function  X  i k (  X  )(1 &lt;k  X  I ,k = i ), with non-determinism.

The behavior feature matrix defined in Equation 1 repre-sents a group of behaviors that are coupled for analysis. To consider the coupled relationships, the space for analyzing the couplings of these behaviors is almost infinite. For a behavior b j among n coupled behaviors, it can be coupled to any one of the remaining n  X  1 behaviors and the corre-sponding search space is O ( C 1 n  X  1 )= O ( n  X  1). Generally, if it is considered to be coupled to any k ,1  X  k  X  n  X  1, the possible search space can be O ( C k n  X  1 )= O ( ( n  X  1)! Thus, the sum of the above search space could be O (2 n  X  1 which means the computational complexity is exponential to the increase of the number of coupled behaviors. This is intractable when the number of coupled behaviors is large. To avoid this, the CHMM-based framework aggregates all the behaviors within time intervals and considers to model the couplings between these interval aggregated activities. The above approach may lose important coupling informa-tion within these aggregated behaviors, which may be useful for further anomaly detection. In this paper, to enrich the modeling capability of the CBA framework, we propose to integrate qualitative analysis into the CBA framework. To achieve this, two different strategies are designed, which are further discussed in Section 3 and Section 4. The former implementation is designed for the settings with no prior do-main knowledge about the coupling relationships. Then we assume hybrid couplings exist between the behaviors, which means behaviors are associated with each other in a compli-cated structure of multiple different coupling relationships [3]. By contrast, when some domain knowledge is known about the couplings, the latter implementation is adopted. In this paper, we consider the hierarchical coupling struc-ture [3], which means behaviors are coupled with each other in a hierarchical structure (determined by the corresponding grouping structure of the actors). All the above considera-tions are advantageous compared to the CHMM-framework because the possible coupled relationships we consider here are more comprehensive.
After the qualitative analysis of the coupled behaviors, the possible coupling relationships between behaviors are ex-panded and efficiently constrained, compared to the CHMM-based framework. Then how to quantitatively model the couplings becomes the key point and we solve it by modeling the autocorrelations that exist in coupled behaviors. More formally, for a set of coupled behaviors b , there could be possible coupled relationships (  X  (  X  ) , X  (  X  )); Then the autocor-relation for coupled behaviors with respect to one behavioral attribute P can be defined as follows:
Definition 1 (Coupled Autocorrelation). It mea-sures the dependence among the values of a behavioral vari-able P  X  P t defined on the coupled behavior pairs (  X  (  X  Given a set of coupled behavior pairs (  X  (  X  ) , X  (  X  )) , the auto-correlation of a continuous variable can be calculated as:
Motivated by the considerations of the coupled autocorre-lations for quantitative analysis, different strategies are pro-posed for different variant CBA frameworks to efficiently consider these coupled autocorrelations for modeling the coupled behaviors.
To determine whether the new coupled behaviors b k are normal or abnormal, we choose to calculate the likelihood given the observations of the coupled behaviors based on the established normal model M . The higher the likelihood of the coupled behaviors b k , the more likely b k conforms to be normal. The following two sections will describe two variant implementations for the general framework proposed in this section.
When there is no prior knowledge of how the behaviors are coupled, to comprehensively capture the couplings with rea-sonable search space is challenging. In addition, to avoid the loss of coupling information of aggregating all the behaviors within time intervals, we alternatively consider the possible hybrid couplings within the behaviors. To achieve this, we use links to indicate possible coupled relationships that are suggested by some of the qualitative behavioral properties of the behaviors, which can be seen as qualitative analysis. This is advantageous compared to the CHMM-framework because we do not forcedly aggregate the behaviors within one time intervals and makes it possible to consider the couplings be-tween them. Then the remaining behavioral properties can be defined as quantitative properties and used for learning the coupling relationships between the behaviors from the perspective of quantitative analysis. The formal definition of two such properties is as follows.

Definition 2 (Qualitative Property). A qualitative property R  X  P refers to the behavioral property which is used to generate the possible underlying coupling relation-ships between behaviors, usually user-defined. Figure 2: An Example of Qualitative Analysis.

Definition 3 (Quantitative Property). An quanti-tative property A  X  P refers to the behavioral property which is used to learn the coupling relationships between behaviors.
Based on the qualitative properties, Algorithm 1 describes the procedure to generate links according to the qualitative properties. In Algorithm 1, steps 2 to 8 form an inner loop process to generate links between behaviors which have the same values as the qualitative property and steps 1 to 9 form an outer loop process to generate the corresponding links for the behaviors according to every reference property. A toy example of the link generation process is shown in Figure 2, which transforms the raw behaviors 1 in the left to the linked behaviors in the right. To be more specific, in Figure 2, the behavioral properties of  X  X uy X ,  X  X ell X  and  X  X rade X  behaviors are:  X  X rice X ,  X  X olume X ,  X  X ime X  and  X  X rder No. X . The qualitative properties used are  X  X ime X  and  X  X rder No. X  while the quantitative properties used are  X  X rice X  and  X  X olume X  after the link generation. Then a group of coupled behaviors can be represented by a typed attributed graph G
B =( V B ,E B ). The nodes V B represent behaviors (e.g., buy i (1  X  i  X  3), sell i (1  X  i  X  4) and trade i (1  X  i  X  the edges E B represent potential coupled relations among the behaviors (e.g., the edges in Figure 2).
 Algorithm 1 The Link Generation Algorithm Input: A Group of Behaviors { b i } , Output: A Set of Generated Links { l } . 1: { l } X  X  X  2: for all R j in the set of qualitative properties do 3: for all values r jk of the qualitative property R j do 4: if exists R b m j == r jk then 5: Add links { l n } between the behaviors { b m } 6: { l } X  X  l n } X  X  l } 7: end if 8: end for 9: end for
After obtaining the graph structure of the coupled be-haviors, we explore the learning of couplings between the behaviors in a numerical form. For a quantitative model to
Each behavior here refers to a transaction record. describe the coupling relationships, we choose to learn the joint probability distribution of these behaviors X  attributes considering their coupled autocorrelations. Exact learning of this joint probability is very computationally intensive and we adopt an approximate approach by learning a set of conditional prolixity distributions (CPDs) [12]. For each quantitative behavioral property A  X  A we try to learn the probability distribution of its values conditioned on other possible coupled behaviors X  behavioral attribute values (i.e., the CPD of A ). Consequently, we approximate the joint probability distribution of the coupled behaviors with a set of CPDs. For this purpose, we introduce relational depen-dency network (RDN) [12], to model the joint probability distribution of the coupled behaviors since its key idea is based on a set of CPDs.
The RDN learning algorithm uses pseudo-likelihood tech-niques [12] to efficiently approximate the joint probability distribution. Unlike relational Bayesian network (RBN) [8] and relational Markov network (RMN) [14], it learns con-ditional distributions independently, rather than jointly, us-ing local conditional probability models, such as Relational Bayesian Classifiers (RBCs). For example, considering the coupled behaviors in Figure 2, for each behavioral property of these coupled behaviors, the RDN learns a CPD model and obtain a set of CPD models. The joint probability dis-tribution model is formed by the integration of these models, which becomes the quantitative model of coupled behaviors. The next section describes how to learn these CPDs.
In consequence, in order to model the coupled behaviors, we could estimate a set of the CPDs of the quantitative behavioral properties conditioned on other possible coupled behaviors X  behavioral attribute values, and underline which coupled autocorrelations between behaviors are considered. To learn the CPD is challenging because of two issues: each quantitative behavioral attribute instance could be condi-tioned on different linked behaviors X  behavioral property val-ues (e.g., heterogeneous structure of links and various behav-ioral property types) and the linked behaviors to consider could be limitless. To cater for the second issue, we must determine how much should be modeled for the CPD of each quantitative behavioral attribute instance. For compu-tational simplicity, we may only consider two related behav-ior links from the target behaviors for modeling the CPD. The whole graph can then be decomposed into subgraphs according to each quantitative behavior property and this could be done by the visual query language QGraph [1]. A toy example can be seen in Figure 3(a) and the quantitative behavioral property A is one of the property of  X  X rade X  be-haviors ( trade 1 and trade 2 in Figure 2). Then trade 1 trade 2 are transformed to two subgraphs with consideration of coupled behaviors 1-link away (we could consider n -link ( n  X  1), but we only depict the 1-link situation for simplic-ity).

After that, the aforementioned first issue can be solved by  X  X latten X  the subgraphs into propositional instances consist-ing of relational features RF 1 ,RF 2 ,  X  X  X  ,RF n and the quan-titative behavioral property A . HerewechooseRBCsto generate the relational features for simplicity and efficiency. Figure 3: An Example of the  X  X lattened X  Proposi-tional Coupled Behavioral Data The relational features for one quantitative behavioral at-tribute are the linked behaviors X  attributes and each at-tribute contains multiple sets of values within the subgraph; for example, considering the quantitative property A of the  X  X rade X  behaviors as in Figure 3. The RBC considers all the attributes associated with the linked behaviors  X  X uy X ,  X  X ell X  and  X  X rade X  and treats them as independent relational fea-tures RF 1 ,  X  X  X  ,RF n . For any specific instance of RF i  X  n ), for example rf i 1 is a multi-set of values rf i 11 and these values are assumed to be independently drawn from p ( RF 1 | A ). Then p ( RF 1 | A ) can be estimated by count-ing the frequency of the values in all the multi-set instances of RF 1 and similar estimation can be done on p ( RF 2 | A ), p ( RF n | A ). The CPD p ( A | RF 1 ,  X  X  X  ,RF n ) can be estimated as where  X  is the normalized constant [12]. For example, with respect to the quantitative property A , the coupled behav-iors in Figure 3(a) can be transformed into Table 3(b) by generating the relational features RF 1 ,  X  X  X  ,RF n . CPD for A then becomes p ( A | RF 1 ,RF 2 ,  X  X  X  ,RF n ) and the joint probability distribution of coupled behaviors becomes p ( b )=
A  X  A CPD A , which model the coupled behaviors.
Training on a set of coupled behaviors ( { b i } ) is compu-tationally intensive and the coupling relationships in some { b i } may be similar. Thus, in order to relief the compu-tational complexity and modeling efficiency, we propose a match pursuit [11] like algorithm to only pick up a subset of coupled behaviors to model.

Matching pursuit [11] is a type of numerical technique widely used in signal processing. Informally speaking, the basic idea is to find the best representation of a signal using a subset of elements provided by a dictionary D . Similarly, our aim is to find the best representation of a subset of cou-pled behaviors among all groups of coupled behaviors. As described in Algorithm 2, step 1 initializes the dictionary D to all the set of training coupled behaviors. Then steps 2 to 11 choose the most representative groups of coupled be-haviors and train a set of models M i (1  X  i  X  n ). Finally, steps 12 to 20 detect the anomaly based on the set of mod-els. The training computational complexity is very inten-sive when the number of coupled behaviors increase and our proposed algorithm efficiently choose a small set of repre-sentative ones, which improves the efficiency of the learning process.
 Algorithm 2 Matching Pursuit-like Anomaly Detection Input: A Training set { b i } (1  X  i  X  N ), Output: An anomaly set A . 1: n  X  1, 2: repeat 3: Train one M n model on the first training sample 4: for all b d (1  X  d  X  N )in D do 5: Compute the likelihood of b d given the model M n : 6: if p ( b d | M n ) &gt;Th 1 then 7: Delete b d from D 8: end if 9: end for 10: n  X  n +1 11: until stop condition (e.g., D =  X  ) 12: for all b k in the Testing set do 13: for i =1  X  n do 14: Compute the likelihood of b k given the model M i : 15: end for 16: D k =max { p ( b k | M i ) } (1  X  i  X  n ) 17: if D k &lt;Th 0 then 18: b k  X  X  19: end if 20: end for
Sometimes, some prior domain knowledge is known about the possible coupling relationships among behaviors of some investors. This provides a possible method to explore cou-plings between behaviors of actors within certain subgroups (at a local level), rather than taking the whole population as a group (at a global level). Such analysis of behaviors is crucial for capturing more comprehensive couplings exist-ing in behaviors, which may be helpful to further detect-ing abnormal coupled behaviors. As mentioned before, the CHMM-based CBA framework may fail to explore some de-tailed information of the couplings between behaviors, due to the aggregation of all the actors X  behaviors, which makes the modeling relatively coarse and in turn may render it less capable to detect abnormal coupled behaviors. For this pur-pose, with the presence of some useful domain knowledge, we propose the corresponding hierarchical grouping-based CBA framework below.

The qualitative analysis stage is to partition the whole in-vestor population according to prior domain knowledge so that the couplings between the behaviors in the resultant sub-groups will be modeled more precisely. We define these groups as  X  X article Groups X . Performing CBA on behaviors of these particle groups can lead to more precise modeling of local interaction characteristics within local groups than directly on the global population. However, dividing actors into particle groups only cater for the couplings between behaviors within each particle group, it does not necessar-ily consider the couplings between behaviors from different particle groups. To cater for between-group couplings, we further propose a hierarchical clustering-based algorithm to merge those relevant particle groups into larger groups until finally into one super-group. Through this manner, the cou-plings between behaviors from different particle groups are expected to be captured. Then in the quantitative analysis stage, the coupled relationships in different group levels are also modeled. This hierarchical grouping strategy captures behavior interactions at different group levels, therefore is more effective to capture the more comprehensive couplings within the coupled behaviors, which makes it possible for detecting abnormal couplings more accurately. In the next sections, we illustrate the details of this variant framework for the general CBA.
In stock markets, investors may be intentionally or un-intentionally grouped. Based on domain knowledge, stock market surveillance experts often create rules according to their judgement and group investors who are likely to co-operate to have manipulative behaviors. As a result, an empirical blacklist is often generated for further monitor-ing. Such domain knowledge is very helpful for our initial understanding of investors grouping. We model the normal couplings in each group of investor behaviors, and build ini-tial corresponding particle groups. This initial grouping of the investors aims to divide them into small particle groups so that the most likely coupled investors form into parti-cle groups with similar coupled relationships. We define the result of these groups as particle groups.

Definition 4 (Particle Groups). The particle groups, which are represented by { PG j } (1  X  j  X  N ) are the par-titioning result of actors { A i } (1  X  i  X  I ) by the rule R ( made by domain experts:
This qualitative analysis stage is domain knowledge driven and any useful information related to investors can be uti-lized to group the investors. In this paper, except for trad-ing record data, there is no additional information available about the investors. Domain knowledge experts advise us to consider the average ordering/trading volume of a trading day for each investor as an initial grouping rule. Based on such information and related domain knowledge, investors are grouped as if they have similar ordering/trading volume of a security. Because the abnormal collaborative behaviors are more likely to happen in these predefined groups, it is reasonable to model the normal couplings within the groups and use the model to check the anomaly. By dividing the actors into particle groups and performing CBA on them separately, we can avoid the influence of roughly analyzing all the investors as a whole group, which may weaken the performance of the modeling. According to [4], we can con-vert the behavioral data for each particle group into three behavioral sequences, the  X  X uy X ,  X  X ell X  and  X  X rade X  sequence, in terms of the trading behavior types. For a particle group, we can transfer the trading records related to them into three coupled sequences. Further, in order to fit the behavior se-quences to CHMM observation sequences for modeling, we also convert them to interval activities to reflect the char-acteristic of behaviors within the particle group during a period, similar to [4]. This makes modeling the couplings within these particle groups possible. However, this mecha-nism of dividing actors into particle groups can only describe the couplings between behaviors within each particle group, while it may omit the couplings between behaviors from dif-ferent particle groups.

To overcome this, we not only model the behavioral cou-plings within particle groups but also merge the particle groups into larger groups and consider the coupled relation-ships in different group levels. To do this, we further de-fine the distance/similarity measure based on the coupling patterns of the two particle groups. Because of the variety and dynamics of coupled behaviors, we merge those groups having most similar coupling patterns first and then join the remaining groups progressively into a super hierarchi-cal group, within which there are many different levels of groups. Through this way, the coupled relationships be-tween the behaviors are hopefully captured in a finer gran-ularity. The detailed definition for the similarity measure for coupling patterns is discussed in the following. Each CHMM represents the corresponding coupling pattern for behaviors in each particle group, our proposed similarity measure is based on the distance/similarity between two CHMMs. Inspired by [7], we put forward a novel similar-ity measure based on the Kullback-Leibler (KL) divergence [9, 6], which is a standard measure for the similarity be-tween probability density functions. To be more specific, for two particle groups i and j , represented by  X  i and  X  respectively, there are corresponding interval activities sets { b is the number of the trading days. The likelihood of the pled points from the model space representing the fitness of the coupled behaviors set to the CHMM  X  j . Similarly, we pled behaviors set { b n , i IA } to the CHMM  X  i . If we normalize  X  ij and  X  ii , the corresponding probability density functions f ij and f  X  ii can be obtained. Then, the distance/similarity between two set of coupled behaviors is converted to the similarity measure between probability density functions, for which the KL divergence is a suitable choice. Its formulation for the discrete case is as follows:
In the same way, D KL ( f  X  jj | f  X  ji ) reflects the similarity be-tween the CHMMs  X  i and  X  j from the angle of the coupled behaviors set { b n , j IA } . Finally, the symmetric distance be-tween the coupled behaviors of two particle groups of  X  i and  X  j is defined as:
By calculating the similarities between particle groups, hi-erarchical clustering [15] is used on the basis of the similarity matrix to reveal the coupling structure in a hierarchical way, which is expected to make a full-scale modeling and can re-flect different levels of couplings between behaviors.
After the qualitative analysis of hierarchically grouping the investors and their corresponding behaviors. For the coupled behaviors of each group in different levels, we can learn the corresponding CHMM (for further details, please refer to [4, 3]). Then these CHMMs are the quantitative models that capture the couplings between the behaviors and provide helpful information for further anomaly detec-tion.
After hierarchically grouping (HG) of all the investors and quantitatively modeling their coupled behaviors in multi-level groups, we are also able to detect the abnormal coupled behaviors. Algorithm 3 illustrates the process.
 Algorithm 3 The Anomaly Detection Algorithm of HG-based CBA Input: A Training set { b i } (1  X  i  X  N ), Output: An anomaly set A . 1: for all Particle group PG l in the Training set do 2: Construct its interval activity behavioral sequences 3: end for 4: Hierarchically cluster the Particle group { PG l } and gen-5: for all Groups { G l } in the Training set do 6: Train the corresponding CHMM  X  G l for each group X  X  7: end for 8: for all Groups { G l } in the Testing set do 9: Construct its interval activity behavioral sequences 10: Calculate their likelihood p ( b k 11: end for 12: for all Trading day k in the testing set, do 13: we choose L k =argmin 14: if L k &lt;Th 0 then 15: b k  X  X  16: end if 17: end for
Our algorithms are tested on a real data set from a ma-jor Asian stock exchange. The tick data covers 388 valid trading days from 1 June 2004 to 31 December 2005. It consists of 58333 traders, and 174416 buy orders, 178464 sell orders, and 189148 trades. The data is partitioned into two sets suggested by domain experts. The training data set is extracted from the transactions from 1 June 2004 to 31 December 2004 and those transactions associated with the identified alerts is filtered. Models are trained on such la-beled normal data to capture the characteristics in so-called  X  X ormal X  coupled trading behaviors. The test set consists of the remaining transactional data and is made up of both normal and abnormal coupled trading behaviors. For eval-uating the performance of the proposed approaches, true positive TP , true negative TN , false positive FP and false negative FN are counted in terms of treating the abnormal cases as the positive class. Then four generally accepted technical performance measures.
We tested the HC-based CBA framework using the RDN model (denoted as  X  X BA-RDN X ) on the test data set and compared it to the CHMM-based CBA framework (denoted as  X  X BA-CHMM X ) 2 . Figure 4 shows the technical perfor-mance. We vary the threshold Th 0 in Algorithm 2 for de-tecting different numbers of anomalies and compare the cor-responding performance for both the algorithms. By do-ing this, we expect to provide a comprehensive compari-son without considering the influence of the threshold. The horizontal axis (P-Num) stands for the number of detected group-based abnormal behaviors (i.e., the number of trading days with abnormal coupled behaviors), and the vertical axis represents the values of technical measures (accuracy, preci-sion, recall or specificity). Figure 4 shows the four technical measures of the HC-based and CHMM-based CBA frame-works. Generally speaking, the former performs better than the latter in terms of all the metrics. For instance, the precision 3 of the CBA-RDN framework of P  X  num =45 is 0 . 38 while that of the CBA-HMM framework is 0 . 28, which improves the precision of 35% higher than that of the CHMM-based framework. With respect to other measures, the CBA-RDN has better results as well, which proves that the HC-based CBA framework can characterize the coupled behaviors with more comprehensive information than the CHMM-based framework. This may lead to better anomaly detection performance to some extent.
For the HG-based framework, here we study seven variant strategies for detecting abnormal coupled behaviors.
The performance results are the averaged values of different time sliding windows [4].
The precision looks very low, since we use the alerts from the market surveillance system as the benchmark, which is known with high overall false positive rate.
We tested the above seven strategies on the test dataset by setting various window sizes ( winsize ) and the results reported here are the averaged ones over different window sizes. Figure 5 shows their technical performance. The horizontal axis and the vertical axis have the same mean-ings in Figure 4. The performance of CBA-PG, CBA-PG2 and CBA-PG3 are worse than CBA-CHMM. This is because dividing investors into small particle groups only models the couplings within these groups and ignores the coupled relationships between particle groups. By contrast, while CBA-HG and CBA-HG3 perform better than other schemes in most cases, CBA-HG2 does not. A possible ex-planation is that the former two schemes integrate a hierar-chical group structure based on reasonable similarity mea-sures rather than a random merger. CBA-HG generally per-forms best out of the three strategies at general, which indi-cates suitable domain knowledge and a reasonable hierarchi-cal structure is valuable for a more accurate grouping and corresponding anomaly detection of the investors. Although the technical measures of CBA-HG is not much higher than those of other strategies when P-Num is small (smaller than 45), they are significantly higher as P-Num increases. For instance, as shown in Figure 5, when P  X  Num =40,the precision of CBA-HG is 0 . 33, while that of CBA-PG is 0 . 24 and that of CBA-CHMM is 0 . 25. The precision of CBA-HG can be 32% higher than that of CBA-CHMM. It reveals that our proposed framework performs best and is most sta-ble than other strategies.
The above experiments show the performance of the two variant CBA frameworks respectively. To further compare their performance, Figure 6 shows the performance compar-ison of the two variant frameworks and the CHMM-based framework. As can be seen from the figure, the CBA-HG framework obtains the best performance in terms of all the technical measures. This is because the proper domain knowl-edge directs us to model proper and more comprehensive
Figure 6: Comparison of the Three Frameworks couplings between behaviors for anomaly detection. In ad-dition, this proves integrating the proper domain knowledge for CBA could enhance its performance to some extent. The CBA-RDN performs better than the CBA-CHMM frame-work, which may benefit from the modeling of more compre-hensive coupling relationships. When there is no prior do-main knowledge, it is reasonable to assume hybrid couplings between the behaviors and give a comprehensive modeling. This method is still advantageous compared to the CBA-CHMM framework, which aggregates all investors X  behav-iors and may omit important coupled relationships. To sum up, the HC-based CBA considers hybrid couplings between behaviors for modeling is helpful when there is little knowl-edge about the coupling structures while HG-based CBA could provide better analysis of the coupled behaviors when the proper domain knowledge is set up for the underlying couplings.
This paper examined a challenging issue of detecting group-based market manipulations from the perspective of cou-pled behavior analysis. In order to analyze the rich cou-plings among behaviors and detect anomalies more accu-rately, we proposed a three-stage general CBA framework for abnormal behavior detection, which consists of qualita-tive analysis, quantitative analysis and anomaly detection stages. To cater for different situations of prior domain knowledge about the couplings, two variant implementation approaches have been proposed. The experimental results on a real-world data set in a major Asian stock market ex-hibited that the proposed approaches generally outperform the previous CHMM-based one by taking the miscellaneous alerts fired in the market surveillance system as a bench-mark. In addition, we also found that integrating domain knowledge into abnormal coupled behavior detection can sig-nificantly improve the performance while detecting anoma-lies without additional domain knowledge is still possible. Future research could be on exploration of how to integrate more sophisticated domain knowledge for CBA and consid-ering other application domains.
This work is supported by the Australian Research Coun-cil (ARC) Discovery Grant (DP1096218), ARC Linkage Grant (LP100200774), the National 863 Program of China (2012AA011005), and the US NASA Research Award (NNX09AK86G). [1] H. Blau. A visual query language for relational [2] M. Brand, N. Oliver, and A. Pentland. Coupled [3] L. Cao, Y. Ou, and P. Yu. Coupled behavior analysis [4] L. Cao, Y. Ou, P. Yu, and G. Wei. Detecting [5] D. Cohen. JB Watson, the founder of behaviourism: a [6] J. Friedman, T. Hastie, and R. Tibshirani. The [7] D. Garcia-Garcia, E. Hernandez, and F. Diaz de [8] L. Getoor and B. Taskar. Introduction to statistical [9] S. Kullback and R. Leibler. On information and [10] H. Liu, J. Salerno, and M. Young. Social computing, [11] S. Mallat and Z. Zhang. Matching pursuits with [12] J. Neville. Statistical models and analysis techniques [13] B. Skinner. About behaviorism, alfred a, 1974. [14] B. Taskar, P. Abbeel, and D. Koller. Discriminative [15] J. Ward. Hierarchical grouping to optimize an
