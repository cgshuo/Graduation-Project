 The notion of peer -to -peer (P2P) refers to a class of systems and applications that employ distributed resources to perform a critical function in a decentralized manner [8]. Currently the growth of availability of powerful networked computers and decentralizing trends of large-scale software development are to form the perfect playground for P2P research and product development [21], which result in many namable systems and applications, such as FreeNet [3], Napster 1 ,PAST [9], Gnutella 2 ,Seti@Home 3 , etc. Since there is no general agreement about what is and what is not P2P [17], here we only extract some striking features to describe its general meaning as follows: (1) Sharing of digital resources by direct exchange; (2) Fault-tolerant (variable connectivity and transmission) and self-organizing [10, 14, 17]; (3) Decentralized computing with independent addressing system on operational computers.The advantages of P2P systems are obvious, cost sharing/reduction, improved scalability/reliability, resource aggregation and interoperability, increased autonomy and anonymity (a privacy feature [20]) [8].
Resource dissemination is an important P2P application category on the net-work, which allows personal computers to function in a coordinated manner as a distributed storage medium by contributing, searching, and obtaining digital resource [17, 22]. However, it also raises some security concerns for privacy pro-tection, intellectual property rights protection along resource dissemination in P2P environment. For example, in some applications, different users in the P2P network may need different identity control policies when they try to access dif-ferent resources, which can be exactly expressed by access control models. But whether or how to enforce access control mechanisms on P2P network is still an open problem [4], as many P2P systems just focus on enough information sharing but not authentication and authorization on resource dissemination.
We argue that a feasible access control policy or mechanism is indispens-able for property rights protection in generic hybrid P2P resource dissemination applications [22, 17]. In addition, privacy protection on user attracts more and more human attention. In generic P2P applications, a troubling contradiction is that the user X  X  identity should be hid as user X  X  private information in a resource dissemination transaction while it is needed to be known by another user for the trust relationship establishment between two sides, which is a critical factor for successful resource dissemination beside property rights allowance. The user pseudonymity is a requirement for privacy protection [5, 1, 20, 2], which should refer to that user X  X  identity should be hid in the access transaction to the system. Further, the relative user X  X  behaviors should also be protected as the unobserv-ability requirement for privacy protection [20, 2].
 With advantages of neutral-policy, self-organization, and ease administration, Role-Based Access Control (RBAC) forms to a popular access control policy deployed in a large number of applications for secure resource access [18, 7]. The role notion in RBAC application is a system entity as the bridge of privilege management and information flow between user and resource. So we introduce it into generic P2P modelling for effective control on resource dissemination for property rights protection, as well as privacy protection through its pseudonym function in global decentralized P2P environment.

We propose the Role-Based P2P model to capture all of the above require-ments (access control, property rights protection, privacy protection on user X  X  identity and behaviors) in hybrid resource dissemination P2P applications, which is the main contribution of the paper. The model can be used for integrating sev-eral centralized RBAC applications to be a decentralized hybrid P2P system by taking global role as the connection among diverse (local) role structures. At the same time, global role can be seen as user X  X  pseudonym over the global network that is consistent with the pseudonymity requirement of privacy protection on user X  X  identity. In each local environment, the initial role hierarchies, user-role assignment, and role-permission assignment relations are maintained without change, while the local access decision module can collaborate with others to provide more resource sharing and dissemination opportunities.
 The rest of this paper is organized as follows: Section 2 identifies the hybrid P2P model based on the taxonomy of P2P, the security challenges and the re-quirement for role policies and relative constraints in RBAC. Section 3 focuses on the role-based hybrid P2P integrating hybrid P2P model with RBAC mech-anism. Finally, Section 4 gives a short conclusion of the whole paper. As proposed in the literature [17], we can classify P2P model into two categories: pure P2P and hybrid P2P model.  X  Pure P2P refers to a completely decentralized P2P system, in which all nodes  X  Hybrid P2P refers to a P2P system with limited nonequivalent nodes, such as
The essential difference between pure and hybrid P2P is the degree of central-ization . In fact, there are three classifications for the centralization difference: fully (globally) centralized, partially (locally) centralized, non-centralized (com-pletely decentralized). The first one refers to non -P2P systems, such as general RBAC systems, which is not in the scope of this paper, but the second refers to hybrid P2P and the third refers to pure P2P. In general, a hybrid P2P has more advantages than a pure one, such as its better flexibility, and effective resource dissemination among peers with respect to access control and privacy protection. And especially, all requirements and security mechanisms for the pure model should be described and specified for the hybrid one. So we take the hybrid P2P model as the generic base for convenient discussion in this paper.
As the hybrid P2P model definition described, there are some limited nonequivalent peers in hybrid P2P applications. So in our hybrid P2P model, we classify peers into three types according to their different privileges and domains: host peer , user peer and resource peer .  X  Host peer refers to a local supernode with a control domain similar to a  X  User peer refers to a user end-point, such as client-side automatic access  X  Resource peer refers to a storage warehouse in end-point storage medium to
It should be noted that user peer and resource peer can be integrated together in one end-point, which can both store and disseminate resource to other peers as well as access to resource in others.

Atypical hybrid P2P network topology is demonstrated in Fig.1 .Itisobvious that there are different relations between user and resource, or among users in the hybrid P2P application. In some narrow domains consisting of several peers, users may be familiar with each other, including the name, role, habit, and behavior in the system. So user X  X  identity is unnecessary to be hid in such a narrow environment. But users may require the system to protect (hide) their identities during the resource dissemination transaction with others out of the local environment. To distinguish the above different requirements while keep the role mechanism still feasible for such a complicated hybrid P2P application, we firstly identify two basic networks induced by the hybrid P2P model topology as the base for the solution, and then take local and global role structures to handle the difference, where the detail is discussed in the next section. Definition 1 (inter-P2P network). An inter-P2P network (also named host peer network) refers to a subnetwork of the whole P2P topology consisting of all active host peers and their connections.
 We define that a peer is active if it is on-line on the current time point. An active host peer takes the function of a reference monitor over the access requests to the outer resource from inner users and the requests to the inner resource from outer users. The inter -P2P network is a full complete graph, since there is always a connection edge(path) that have been existed or can be existed between any two active host peers.
 Definition 2 (intra-P2P network). An intra-P2P network (also named local centralized network) is a subnetwork of a hybrid P2P topology consisting of one active host peer, several user and resource peers that connect to the host peer. The intra -P2P network represents a narrow control domain which is indepen-dent from the outer peers. In such a domain, inner resource can be accessed and disseminated to inner users through the authentication and authorization mechanism on the host peer, which is worked as a local reference monitor in this domain. In general, we just define just one monitor in an intra -P2P network (it is helpful for control consistency). Over all, the network is similar to a centralized access control topology.
 In any hybrid P2P network model, there is one and only one induced inter -P2P network, but several induced intra -P2P networks. As in Fig.1 ,thereare four intra -P2P networks in the model (marked by four circles). In such a hybrid P2P model, it is obvious that any two host peers connect mutually in the inter -P2P network, and any user/resource peer connects with an active host peer in at least one local intra -P2P network.

To capture the different requirements above, the role mechanism is indispens-abletoasuccessful hybrid P2P resource dissemination application. There are several reasons supporting this view.  X  Role is semantic constraint integration expressing a set of permissions, which  X  Role mechanism can be extended for user identity and behavior information
In short, the extended role mechanism is indispensable for a privacy-preserving hybrid P2P application. Before the elaborate solution on their integration, we first introduce the general RBAC model that contains role mechanism as the  X  X ridge X  function between users and permissions.

RBAC is a centralized policy by taking a reference monitor (with server func-tion) to control all subjects X  requests for resource, which is concerned more with access to functions and information than strictly with access to information in many applications [18, 7]. Role in RBAC is a bridge of information flow and permission management between subject and object. Core concepts of the gen-eral RBAC model include roles (and its hierarchy structure), users, permissions, user-role assignments, role-permission a ssignments, static/dynamic separation of duty (SSD/DSD) [6, 7].

RBAC is preferred within limited centralized control domain, and it is impos-sible to efficiently handle access requests from a large number of users within decentralized environment only by itself [11].

In our P2P modelling process, we should utilize RBAC X  X  advantages, such as high efficiency for narrow centralized access control decision, while avoid its disadvantages including low performance for large-scale decentralized control.
To achieve the goal in a hybrid P2P model, we design the local and global role mechanisms for resource access decision in intra -P2P network and inter -P2P network, respectively. In intra -P2P environment, the role structure, user-role assignment, and role-permission assign ment are maintained similar to general RBAC application. While in the inter -P2P environment, we take global role as a conversion balance among these roles in different local networks. Such a mechanism is contained in our proposed Role-Based hybrid P2P model. The above hybrid P2P model is just a framework abstracting generic P2P ap-plications. Based on it, we define the Role-Based Hybrid P2P model to achieve the objectives proposed above, including digital rights protection through au-thorization and authentication, user  X  X  identity and behavior protection. It uses the local role mechanism and the relative constraints in the local intra-P2P environment to build the quasi-RBAC reference monitor in the host peer domain, while it creates a global role structure to balance the access permission conversion among different local networks.  X  It is an extended hybrid P2P model that can be available for most compre- X  It is a dual-technology model providing maximal resource dissemination un- X  It is a privacy-aware model, in which the pseudonymity feature is satisfied as
Fig.2 illustrates an application with the model. Node H 1(or H 2), R 1(or R 2), and U 1(or U 2) refer to the host peer, resource peer, and user peer in intra-P2P network L 1(or L 2). The role structures in L 1and L 2 are different, such as r 1 and r 2 in the former structure and r 1 and r 2 in the latter one. In L 1(or L 2), U 1(or U 2) can successfully access to resources in R 1(or R 2) through activating an appropriate role satisfying relative constraints in H 1(or H 2). For accessing to resource out of the local environment, as the model defined, we set several global roles to balance the access permission conversion between the two role structures. For instance, we take g 1 as the conversion between r 1 and r 2 ,and g 2 between r 2 and r 2 .Itmeansifauserin L 1 can activate r 1 (or r 2 ), he/she can also activate r 1 (or r 2 )in L 2 and successfully access to some resources in R 2 that can be accessed by local users who can activate r 1 (or r 2 ). Users in L 2 can do similarly. Overall, with the model, resource dissemination and sharing have been extended obviously while the relative digital rights protection and user identity protection are handled appropriately.

To specify the elaborate access control mechanism with role structure and some relations on the abstract hybrid model, we should firstly clarify the local and global notions for user, resource and role identification in various situations:  X  X userisa local user within his/her belonged intra -P2P network, but is iden-tified as a global one by peers in other indirect connected intra -P2P networks;  X  X resourceisa local resource within the intra -P2P network, but is identified as a global one by peers in other indirect connected intra -P2P networks;  X  X  local role refers to a role defined in a local centralized host peer as the bridge between local user and local resource, but a global role refers to a role as permis-sion or function connection way of role hierarchy structure among host peers, which is activated automatically when a user accesses a resource dominated in different intra -P2P networks.

A global roles should be equivalent on access rights with a corresponding local role. For the whole P2P application with this model, the unique global admin-istration task is to define global roles and their comparable relations with local roles in all intra -P2P networks. How to accomplish this work will be discussed later. Further, we describe the access trace from user to the resource by an active path defined as follows.
 Definition 3 (Active Path). An active path , denoted as &lt; ActiveHostPeerID, ActiveResourcePeerID, ResourceID &gt; , is a dissemination channel which is avail-able for resource dissemination from an active resource peer to an active user peer in the current P2P network status, where AcitiveHostPeerID, AcitiveRe-sourcePeerID, ResourceID denotes the identity of an active host peer, an active resource peer, and a special resource respectively.
 The preconditions for a resource can be disseminated to a user is that existing an active path towards the resource, and secondly, the user should be powerful (with enough rights) to access that resource, or in another word, the user can activate a role of appropriate permissions to do it. Now we define elements in our model formally.  X  Resource( Re )= { &lt; ResourceID &gt; } , which is dominated in the user peer side  X  Resource-RoleSet( RR )= { &lt; ResourceID,RoleSet &gt; } . It is dominated in the re- X  Resource-HostPeer( RHP )= { &lt; ResourceIDHostPeerIDSet &gt; } , which is domi- X  Resource-ResourcePeer( RRP )= { &lt; ResourceID,ResourcePeerID &gt; } ,whichis  X  User-Role( UR )= { &lt; UserID,LocalRole,GlobalRole &gt; } , which is dominated in  X  Role-Hierarchy( RH )= { &lt; Role,Role &gt; } , which denotes the role hierarchy  X  Static-Separation-of-Duty( SSD )= { &lt; Role,Role &gt; } , which denotes mutual ex-We can specify the relative RBAC security constraints by the above UR , RH and SSD within P2P network peers, and the expressive capability by our specification is equivalent to the original constraints in general RBAC models. We describe the security constraints within the above formula as follows: Constraint 1.  X  &lt;u , r i &gt; , &lt;u , r j &gt;  X  UR 5 , &lt;r i , r j &gt;  X  SSD . Constraint 2. &lt;r i , r j &gt;  X  SSD , &lt;r j , r k &gt;  X  RH  X  &lt;r i , r k &gt;  X  SSD . Constraint 3.  X  &lt;u , r i &gt; , &lt;u , r j &gt;  X  UR , &lt;r i , r j &gt;  X  RH . Constraint 4. For roles activated by users to access to resource peers should be listed in UR .
 Access Control Algorithm Running the Model. Now we propose the access control algorithm to describe the deta il resource dissemination mechanism in the Role-Based Hybrid P2P model for general access control, property rights protection, and the user X  X  pseudonym feature as follows:
Through the algorithm, we can get two schemas of resource access process, the first is the access policy in an intra -P2P network, or called the intra schema , and the second is the access to resource among indirect connected intra -P2P networks, or called the inter schema .
 Intra Schema. This schema is the simple one, where resource dissemination is limited in an intra -P2P network with local roles (without global roles). In Fig. 3 I , user peer U 1 wants to require resource r 1 , we can demonstrate the process within this schema as follows: (1) U 1 sends the resource identity denoted by r 1 to the direct-connected active host peer H 1 ;(2) H 1 returns an active local role properly and an active path towards the resource peer R 1 containing r 1 ;(3) U 1 builds a connection to R 1 for r 1 dissemination; (4) R 1 directly sends r 1 to U 1 . Inter Schema. This schema is the complex one, where resource dissemination is propagated to global network with both local and global roles. In Fig. 3 II ,user peer U 1 wants to require resource r 3 , we can demonstrate the process within this schema as follows: (1) U 1 sends the resource identity denoted by r 3 to the direct-connected active host peer H 1 ;(2) H 1 sends r 3 to any active host peers; (3) the host peer H 3 returns H 1 an active path towards to the resource peer R 3 containing r 3 ;(4) H 1 retransmits it with an active global role properly to U 1 ; (5) U 1 builds a connection to R 3 for r 3 dissemination by the global role; (6) R 3 directly sends r 3 to U 1 .
 Case Study 1 : Distributed Dissemination Control (DCON). DCON means that the distributor or rights holder can control recipients X  access to the digital information [11], In another word, it is a security policy of controlling digital resource access before and after distribution [15, 16]. Through Internet, DCON can be applied as large as possible by taking local networks as intra -P2P networks and taking routers as host peers in P2P resource dissemination application model with RBAC policy. The special constraints in the real ap-plication, which should be implemented in P2P system, include: (1) different resources need different restriction levels for intellectual property rights protec-tion, which can be expressed by role (with its hierarchy structure) mechanism; (2) it is allowed that customers in the DCON application are anonymous, which can be implemented by special technics on user peer identity in the P2P system; (3) resource property right should be mat erialized by users X  some contributions such as money, contracts or other payments, which is implemented by a special e-payment system dominated in host peers. In conclusion, a DCON application can be modelled by a hybrid P2P network model with a special RBAC policy. Case Study 2 : Audio/Video (AV) Supply Application. Building a dis-tributed AV supply application on P2P network requires that, (1) different AV agents should acquire and process different kinds of AV products; (2) different AV products can be stored in different databases or computers in different re-gions; (3) AV centers do not need to support the service 24 hours for 7 days a week; (4) different databases or AV agents can open or close the service freely. So the active statues of these centers, agents, and databases should be monitored dynamically for successful resource dissemination. We can easily use our hybrid P2P model with a special RBAC policy to express and specify this application practice. In our model, we define that, a host peer denotes a local AV supply center, a user peer denotes an AV agent and a resource peer denotes an AV supply database, a resource is an AV product and a user is a customer or a sub-AV center principal. It is reasonable in reality that an AV agent contains some AV products, which is also mapped to the coexistence of a host peer or a user peer and some resource. From the above mapping specification, we can infer that the detail access process in this AV resource dissemination application can be simulated by the access control algorithm in our model.
 Administration. The administration of our hybrid P2P model with RBAC policy mainly should dominate in host peers to manage all access control deci-sions and active status modification, since host peers contains the RBAC policy management to handle all requests from users and to be the access bridge for re-source dissemination from resource peers to user peers. For administrating host peers in our model, we propose that it be preferred to set a central adminis-trator (a software of automatization capability preferred) to manage the whole P2P system X  X  work. It is feasible and effective since there is only one induced inter -P2P network in every P2P network model, where access elements in every host peer and transmission connections among them can be monitored efficiently by a central administrator. The corresponding tasks are: (1) automatically main-tains Re list in user peer side, and makes sure that resourceIDs listed in Re can cover all existed or newly emerged resource identities; (2) automatically main-tains RR list in resource peer side according to role setting and local resource status changes; (3) automatically maintains RHP , RRP in host peer side dy-namically, and makes sure the active path can be built successfully according to the current P2P network status; (4) automatically maintains UR , RH , SSD in host peer side, and makes sure constraints for RBAC policy can be effective in time. Further, the dynamical status of P2P network should be monitored in real time. Any interaction can arise the modification of the whole P2P network. This paper propose a hybrid P2P model with RBAC policy and constraints to effectively manage resource dissemination within the hybrid P2P environment. The access control algorithm provided describes how to handle access requests by RBAC policy and constraints within P2P network environment. The two access schemas ( intra and inter ) are to express the algorithm in detail. We propose the item active path for a role activated by a user to access to a resource by satisfying RBAC constraints on role cardinality, role hierarchy, static separation of duty. The advantages of our model include flexibility, scalability, and security.
In the above, we give the way of building a hybrid P2P model with RBAC policy and a novel access control algorithm to guide the real resource dissemi-nation application on P2P network. The administration part proposed briefly in the end of the paper describes the functions of an excellent administrator, which should be specified in more detail in the following P2P modeling research.
