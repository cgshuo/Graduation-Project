 What is the best way to exploit linguistic infor-mation in statistical text processing models? For tasks like text classification, sentiment analysis, and text-driven forecasting, this is an open ques-tion, as cheap  X  X ag-of-words X  models often per-form well. Much recent work in NLP has fo-cused on linguistic feature engineering (Joshi et al., 2010) or representation learning (Glorot et al., 2011; Socher et al., 2013).
 In this paper, we propose a radical alternative. We embrace the conventional bag-of-words repre-sentation of text, instead bringing linguistic bias to bear on regularization . Since the seminal work of Chen and Rosenfeld (2000), the importance of regularization in discriminative models of text X  including language modeling, structured predic-tion, and classification X  X as been widely recog-nized. The emphasis, however, has largely been on one specific kind of inductive bias: avoiding large weights (i.e., coefficients in a linear model).
Recently, structured (or composite) regulariza-tion has been introduced; simply put, it reasons about different weights jointly. The most widely explored variant, group lasso (Yuan and Lin, 2006) seeks to avoid large ` 2 norms for groups of weights. Group lasso has been shown useful in a range of applications, including computational biology (Kim and Xing, 2008), signal processing (Lv et al., 2011), and NLP (Eisenstein et al., 2011; Martins et al., 2011; Nelakanti et al., 2013). For text categorization problems, Yogatama and Smith (2014) proposed groups based on sentences, an idea generalized here to take advantage of richer linguistic information.

In this paper, we show how linguistic informa-tion of various kinds X  X arse trees, thematic topics, and hierarchical word clusterings X  X an be used to construct group lasso variants that impose linguis-tic bias without introducing any new features. Our experiments demonstrate that structured regulariz-ers can squeeze higher performance out of conven-tional bag-of-words models on seven out of eight of text categorization tasks tested, in six cases with more compact models than the best-performing unstructured-regularized model. We represent each document as a feature vector x  X  R V , where V is the vocabulary size. x v is the frequency of the v th word (i.e., this is a  X  X ag of words X  model).

Consider a linear model that predicts a binary response y  X  X  X  1 , +1 } given x and weight vector w  X  R V . We denote our training data of D doc-uments in the corpus by { x d ,y d } D the learning procedure is to estimate w by mini-mizing the regularized training data loss: where L ( x , w ,y ) is the loss function for docu-ment d and  X ( w ) is the regularizer.
 In this work, we use the log loss:
L ( x d , w ,y d ) =  X  log(1 + exp(  X  y d w &gt; x d )) , Other loss functions (e.g., hinge loss, squared loss) can also be used with any of the regularizers dis-cussed in this paper.

Our focus is on the regularizer,  X ( w ) . For high dimensional data such as text, regularization is
The usual starting points for regularization are the  X  X asso X  (Tibshirani, 1996) and the  X  X idge X  (Ho-erl and Kennard, 1970), based respectively on the ` 1 and squared ` 2 norms: Both methods disprefer weights of large magni-tude; smaller (relative) magnitude means a feature (here, a word) has a smaller effect on the predic-hyperparameter  X  in each case is typically tuned on a development dataset. A linear combination of ridge and lasso is known as the elastic net (Zou and Hastie, 2005). The lasso, ridge, and elastic net are three strong baselines in our experiments. Structured regularizers penalize estimates of w in which collections of weights are penalized jointly. For example, in the group lasso (Yuan and Lin, 2006), predefined groups of weights (subvectors of w ) are encouraged to either go to zero (as a group) or not (as a group) X  X his is known as
The variant of group lasso we explore here uses an ` 1 , 2 norm. Let g index the G predefined groups of weights and w g denote the subvector of w con-taining weights for group g : where  X  glas is a hyperparameter tuned on a devel-opment data, and  X  g is a group specific weight. Typically the groups are non-overlapping, which offers computational advantages, but this need not be the case (Jacob et al., 2009; Jenatton et al., 2011). Past work applying the group lasso to NLP prob-lems has considered four ways of defining the groups. Eisenstein et al. (2011) defined groups of coefficients corresponding to the same inde-pendent variable applied to different (continuous) output variables in multi-output regression. Mar-tins et al. (2011) defined groups based on fea-ture templates used in chunking and parsing tasks. Nelakanti et al. (2013) defined groups based on n -gram histories for language modeling. In each of these cases, the groups were defined based on in-formation from feature types alone; given the fea-tures to be used, the groups were known.

Here we build on a fourth approach that exploits introduced the sentence regularizer , which uses patterns of word cooccurrence in the training data to define groups. We review this method, then ap-ply the idea to three more linguistically informed structure in text data. 4.1 Sentence Regularizer The sentence regularizer exploits sentence bound-aries in each training document. The idea is to define a group g d,s for every sentence s in every training document d . The group contains coeffi-cients for words that occur in its sentence. This means that a word is a member of one group for every distinct (training) sentence it occurs in, and that the regularizer is based on word tokens, not types as in the approach of Martins et al. (2011) and Nelakanti et al. (2013). The regularizer is: where S d is the number of sentences in document d . This regularizer results in tens of thousands to millions of heavily overlapping groups, since a standard corpus typically contains thousands to millions of sentences and many words that appear in more than one sentence.
If the norm of w g learner has deemed the corresponding sentence ir-relevant to the prediction. It is important to point out that, while the regularizer prefers to zero out the weights for all words in irrelevant sentences, it also prefers not to zero out weights for words in relevant sentences. Since the groups overlap and may work against each other, the regularizer may not be able to drive many weights to zero on its own. Yogatama and Smith (2014) used a linear combination of the sentence regularizer and the lasso (a kind of sparse group lasso ; Friedman et al., 2010) to also encourage weights of irrelevant 4.2 Parse Tree Regularizer Sentence boundaries are a rather superficial kind of linguistic structure; syntactic parse trees pro-vide more fine-grained information. We introduce a new regularizer, the parse tree regularizer, in which groups are defined for every constituent in every parse of a training data sentence.

Figure 1 illustrates the group structures derived from an example sentence from the Stanford sen-timent treebank (Socher et al., 2013). This regu-larizer captures the idea that phrases might be se-lected as relevant or (in most cases) irrelevant to a task, and is expected to be especially useful in sentence-level prediction tasks.

The parse-tree regularizer (omitting the group coefficients and  X  ) for one sentence with the parse tree shown in Figure 1 is:
The groups have a tree structure, in that assign-ing zero values to the weights in a group corre-sponding to a higher-level constituent implies the same for those constituents that are dominated by it. This resembles the tree-guided group lasso in Kim and Xing (2008), although the leaf nodes in their tree represent tasks in multi-task regression.
Of course, in a corpus there are many parse trees (one per sentence, so the number of parse trees is the number of sentences). The parse-tree regular-izer is:
 X  over (training) documents and c ranges over con-stituents in the parse of sentence s in docu-ment d . Similar to the sentence regularizer, the parse-tree regularizer operates on word to-kens. Note that, since each word token is it-self a constituent, the parse tree regularizer in-cludes terms just like the lasso naturally, penal-izing the absolute value of each word X  X  weight in isolation. For the lasso-like penalty on each word, instead of defining the group weights to be 1  X  the number of tokens for each word type, we tune one group weight for all word types on a de-velopment data. As a result, besides  X  glas , we have an additional hyperparameter, denoted by  X  las .
To gain an intuition for this regularizer, consider the case where we apply the penalty only for a sin-gle tree (sentence), which for ease of exposition is assumed not to use the same word more than once (i.e., k x k  X  = 1 ). Because it instantiates the tree-structured group lasso, the regularizer will require bigger constituents to be  X  X ncluded X  (i.e., their words given nonzero weight) before smaller con-stituents can be included. The result is that some words may not be included. Of course, in some sentences, some words will occur more than once, and the parse tree regularizer instantiates groups for constituents in every sentence in the training corpus, and these groups may work against each other. The parse tree regularizer should therefore be understood as encouraging group behavior of syntactically grouped words, or sharing of infor-mation by syntactic neighbors.

In sentence level prediction tasks, such as sentence-level sentiment analysis, it is known that most constituents (especially those that corre-spond to shorter phrases) in a parse tree are un-informative (neutral sentiment). This was verified by Socher et al. (2013) when annotating phrases in a sentence for building the Stanford sentiment treebank. Our regularizer incorporates our prior expectation that most constituents should have no effect on prediction. 4.3 LDA Regularizer Another type of structure to consider is topics. For example, if we want to predict whether a pa-per will be cited or not (Yogatama et al., 2011), the model can perform better if it knows before-hand the collections of words that represent certain themes (e.g., in ACL papers, these might include machine translation, parsing, etc.). As a result, the model can focus on which topics will increase the probability of getting citations, and penalize weights for words in the same topic together, in-stead of treating each word separately.

We do this by inferring topics in the training corpus by estimating the latent Dirichlet alloca-tion (LDA) model (Blei et al., 2003)). Note that LDA is an unsupervised method, so we can in-fer topical structures from any collection of docu-ments that are considered related to the target cor-pus (e.g., training documents, text from the web, etc.). This contrasts with typical semi-supervised learning methods for text categorization that com-bine unlabeled and labeled data within a genera-tive model, such as multinomial na  X   X ve Bayes, via expectation-maximization (Nigam et al., 2000) or semi-supervised frequency estimation (Su et al., 2011). Our method does not use unlabeled data to obtain more training documents or estimate the joint distributions of words better, but it allows the use of unlabeled data to induce topics. We leave comparison with other semi-supervised methods for future work.

There are many ways to associate inferred top-ics with group structure. In our experiments, we choose the R most probable words given a topic izer can be written as: where k ranges over the K topics. Similar to our earlier notations, w k corresponds to the subvec-tor of w such that the corresponding features are present in topic k . Note that in this case we can also have overlapping groups, since words can ap-pear in the top R of many topics.
To gain an intuition for this regularizer, consider the toy example in Table 1. the case where we have K = 4 topics and we select R = 5 top words from each topic. Supposed that we want to clas-sify whether an article is a sports article or a sci-ence article. The regularizer might encourage the weights for the fourth topics X  words toward zero, since they are less useful for the task. Addition-ally, the regularizer will penalize words in each of the other three groups collectively. Therefore, if (for example) ligament is deemed a useful feature for classifying an article to be about sports, then the other words in that topic will have a smaller ef-fective penalty for getting nonzero weights X  X ven weights of the opposite sign as w ligament . It is im-portant to distinguish this from unstructured reg-ularizers such as the lasso, which penalize each word X  X  weight on its own without regard for re-lated word types.

Unlike the parse tree regularizer, the LDA regu-larizer is not tree structured. Since the lasso-like penalty does not occur naturally in a non tree-structured regularizer, we add an additional lasso penalty for each word type (with hyperparameter  X  las ) to also encourage weights of irrelevant words to go to zero. Our LDA regularizer is an instance of sparse group lasso (Friedman et al., 2010). 4.4 Brown Cluster Regularizer Brown clustering is a commonly used unsuper-vised method for grouping words into a hierarchy of clusters (Brown et al., 1992). Because it uses local information, it tends to discover words with similar syntactic behavior, though semantic group-ings are often evident, especially at the more fine-grained end of the hierarchy.

We incorporate Brown clusters into a regular-izer in a similar way to the topical word groups inferred using LDA in  X  4.3, but here we make use of the hierarchy. Specifically, we construct tree-structured groups, one per cluster (i.e., one per node in the hierarchy). The Brown cluster regu-larizer is: where v ranges over the N nodes in the Brown cluster tree. As a tree structured regularizer, this regularizer enforces constraints that a node v  X  X  group is given nonzero weights only if those nodes that dominate v (i.e., are on a path from v to the root) have their groups selected.

Consider a similar toy example to the LDA reg-ularizer (sports vs. science) and the hierarchical clustering of words in Figure 2. In this case, the Brown cluster regularizer will create 17 groups, one for every node in the clustering tree. The regu-larizer for this tree (omitting the group coefficients and  X  ) is:  X  The regularizer penalizes words in a cluster to-gether, exploiting discovered syntactic related-ness. Additionally, the regularizer can zero out weights of words corresponding to any of the in-ternal nodes, such as v 7 if the words monday and sunday are deemed irrelevant to prediction.
Note that the regularizer already includes terms like the lasso naturally. Similar to the parse tree regularizer, for the lasso-like penalty on each word, we tune one group weight for all word types on a development data with a hyperparameter  X  las .
A key difference between the Brown cluster regularizer and the parse tree regularizer is that there is only one tree for Brown cluster regularizer, whereas the parse tree regularizer can have mil-lions (one per sentence in the training data). The LDA and Brown cluster regularizers offer ways to incorporate unlabeled data, if we believe that the unlabeled data can help us infer better topics or clusters. Note that the processes of learning topics or clusters, or parsing training data sentences, are a separate stage that precedes learning our predic-tive model. There are many optimization methods for learn-ing models with structured regularizers, particu-lary group lasso (Jacob et al., 2009; Jenatton et al., 2011; Chen et al., 2011; Qin and Goldfarb, 2012; Yuan et al., 2013). We choose the optimization method of Yogatama and Smith (2014) since it handles millions of overlapping groups effectively. The method is based on the alternating directions method of multipliers (ADMM; Hestenes, 1969; Powell, 1969). We review it here in brief, for com-pleteness, and show how it can be applied to tree-structured regularizers (such as the parse tree and Brown cluster regularizers in  X  4) in particular.
Our learning problem is, generically: Separating the lasso-like penalty for each word type from our group regularizers, we can rewrite this problem as: min where v consists of copies of the elements of w . Notice that we work directly on w instead of the copies for the lasso-like penalty, since it does not have overlaps and has its own hyper-parameters  X  las . For the remaining groups with size greater than one, we create copies v of size L = trix whose 1s link elements of w to their copies. 7 We now have a constrained optimization prob-lem, from which we can create an augmented La-grangian problem; let u be the Lagrange variables:
ADMM proceeds by iteratively updating each of w , v , and u , amounting to the following sub-problems:
Yogatama and Smith (2014) show that Eq. 1 can be rewritten in a form quite similar to ` 2 -
Eq. 2 is the proximal operator of 1 plied to Mw  X  u form of M . Note that when applied to the col-lection of  X  X opies X  of the parameters, v ,  X  glas no longer has overlapping groups. Defined M g as the rows of M corresponding to weight copies as-signed to group g . Let z g , M g w  X  u g solved by applying the proximal operator used in non-overlapping group lasso to each subvector: For a tree structured regularizer, we can get speedups by working from the root node towards the leaf nodes when applying the proximal oper-ator in the second step. If g is a node in a tree which is driven to zero, all of its children h that has  X  h  X   X  g will also be driven to zero.
 Eq. 3 is a simple update of the dual variable u . Algorithm 1 ADMM for overlapping group lasso 6.1 Datasets We use publicly available datasets to evaluate our model described in more detail below.
 Topic classification. We consider four binary categorization tasks from the 20 Newsgroups document according to two related categories: comp.sys: ibm.pc.hardware vs. mac.hardware; rec.sport: baseball vs. hockey; sci: med vs. space; and alt.atheism vs. soc.religion.christian. Sentiment analysis. One task in sentiment anal-ysis is predicting the polarity of a piece of text, i.e., whether the author is favorably inclined toward a (usually known) subject of discussion or proposi-tion (Pang and Lee, 2008). Sentiment analysis, even at the coarse level of polarity we consider here, can be confused by negation, stylistic use of irony, and other linguistic phenomena. Our sen-timent analysis datasets consist of movie reviews from the Stanford sentiment treebank (Socher et men alongside  X  X ea X / X  X ay X  votes on the bill under ford sentiment treebank, we only predict binary classifications (positive or negative) and exclude neutral reviews.
 Text-driven forecasting. Forecasting from text requires identifying textual correlates of a re-sponse variable revealed in the future, most of which will be weak and many of which will be spurious (Kogan et al., 2009). We consider two such problems. The first one is predicting whether a scientific paper will be cited or not within three years of its publication (Yogatama et al., 2011); the dataset comes from the ACL Anthology and consists of research papers from the Association for Computational Linguistics and citation data (Radev et al., 2009). The second task is predicting whether a legislative bill will be recommended by
Table 2 summarizes statistics about the datasets used in our experiments. In total, we evaluate our method on eight binary classification tasks. 6.2 Setup In all our experiments, we use unigram features plus an additional bias term which is not regu-larized. We compare our new regularizers with state-of-the-art methods for document classifica-tion: lasso, ridge, and elastic net regularization, as well as the sentence regularizer discussed in  X  4.1
We parsed all corpora using the Berkeley parser K = 1 , 000 and R = 10 . For the Brown cluster ing documents with 5 , 000 clusters for the topic classification and sentiment analysis datasets, and 1 , 000 for the larger text forecasting datasets (since they are bigger datasets that took more time). 6.3 Results Table 3 shows the results of our experiments on the eight datasets. The results demonstrate the su-periority of structured regularizers. One of them is also worth noting that in most cases all variants of the structured regularizers outperformed lasso, ridge, and elastic net. In four cases, the new regu-larizers in this paper outperform the sentence reg-ularizer.

We can see that the parse tree regularizer per-formed the best for the movie review dataset. The task is to predict sentence-level sentiment, so each training example is a sentence. Since constituent-level annotations are available for this dataset, we only constructed groups for neutral constituents (i.e., we drive neutral constituents to zero during training). It has been shown that syntactic in-formation is helpful for sentence-level predictions (Socher et al., 2013), so the parse tree regularizer is naturally suitable for this task.

The Brown cluster and LDA regularizers per-formed best for the forecasting scientific articles dataset. The task is to predict whether an article will be cited or not within three years after publi-cation. Regularizers that exploit the knowledge of semantic relations (e.g., topical categories), such as the Brown cluster and LDA regularizers, are therefore suitable for this type of prediction.
Table 4 shows model sizes obtained by each of the regularizers for each dataset. While lasso prunes more aggressively, it almost always per-forms worse. Our structured regularizers were able to obtain a significantly smaller model (27%, 34%, 19% as large on average for parse tree, Brown, and LDA regularizers respectively) com-pared to the ridge model.
 Topic and cluster features. Another way to in-corporate LDA topics and Brown clusters into a linear model is by adding them as additional fea-tures. For the 20N datasets, we also ran lasso, ridge, and elastic net with additional LDA topic baselines use more features than our model. We can also add these additional features to our model and treat them as regular features (i.e., they do not belong to any groups and are regularized with standard regularizer such as the lasso penalty). The results in Table 5 show that for these datasets, models that incorporate this information through structured regularizers outperformed models that encode this information as additional features in 4 out 4 of cases (LDA) and 2 out of 4 cases (Brown). Sparse models with Brown clusters ap-pear to overfit badly; recall that the clusters were learned on only the training data X  X lusters from a larger dataset would likely give stronger re-sults. Of course, better performance might also be achieved by incorporating new features as well as using structured regularizers. 6.4 Examples To gain an insight into the models, we inspect group sparsity patterns in the learned models by looking at the parameter copies v . This lets us see which groups are considered important (i.e.,  X  X e-lected X  vs.  X  X emoved X ). For each of the proposed regularizers, we inspect the model a task in which it performed well.

For the parse tree regularizer, we inspect the model for the 20N:religion task. We observed that the model included most of the sentences (root node groups), but in some cases removed phrases from the parse trees, such as ozzy osbourne in the sentence ozzy osbourne , ex-singer and main char-acter of the black sabbath of good ole days past , is and always was a devout catholic .

For the LDA regularizer, we inspect zero and nonzero groups (topics) in the forecasting scien-tific articles task. In this task, we observed that 642 out of 1,000 topics are driven to zero by our model. Table 6 shows examples of zero and nonzero topics for the dev.-tuned hyperparameter values. We can see that in this particular case, the model kept meaningful topics such as parsing and speech processing, and discarded general topics that are not correlated with the content of the pa-pers (e.g., acknowledgment, document metadata, equation, etc.). Note that most weights for non-selected groups, even in w , are near zero.
For the Brown cluster regularizer, we inspect the model from the 20N:science task. 771 out of 5,775 groups were driven to zero for the best model tuned on the development set. Examples of zero and nonzero groups are shown in Ta-ble 7. Similar to the LDA example, the groups that were driven to zero tend to contain generic words that are not relevant to the predictions. We can also see the tree structure effect in the regu-larizer. The group { underwater , industrial } was driven to zero, but not once it combined with other words such as hpr , std , obsessive . Note that we ran Brown clustering only on the training docu-ments; running it on a larger collection of (unla-beled) documents relevant to the prediction task (i.e., semi-supervised learning) is worth exploring in future work. Overall, our results demonstrate that linguistic structure in the data can be used to improve bag-of-words models, through structured regulariza-tion. State-of-the-art approaches to some of these problems have used additional features and repre-sentations (Yessenalina et al., 2010; Socher et al., 2013). For example, for the vote sentiment analy-sis datasets, latent variable models of Yessenalina et al. (2010) achieved a superior result of 77.67%. To do so, they sacrificed convexity and had to rely on side information for initialization. Our exper-imental focus has been on a controlled compari-son between regularizers for a fixed model family (the simplest available, linear with bag-of-words features). However, the improvements offered by our regularization methods can be applied in fu-ture work to other model families with more care-fully engineered features, metadata features (espe-cially important in forecasting), latent variables, etc. In particular, note that other kinds of weights (e.g., metadata) can be penalized conventionally, or incorporated into the structured regularization where it makes sense to do so (e.g., n -grams, as in Nelakanti et al., 2013). We introduced three data-driven, linguistically informed structured regularizers based on parse trees, topics, and hierarchical word clusters. We empirically showed that models regularized us-ing our methods consistently outperformed stan-dard regularizers that penalize features in isolation such as lasso, ridge, and elastic net on a range of datasets for various text prediction problems: topic classification, sentiment analysis, and fore-casting.
 The authors thank Brendan O X  X onnor for help with visualization and three anonymous review-ers for helpful feedback on an earlier draft of this paper. This research was supported in part by computing resources provided by a grant from the Pittsburgh Supercomputing Center, a Google re-search award, and the Intelligence Advanced Re-search Projects Activity via Department of In-terior National Business Center contract number D12PC00347. The U.S. Government is authorized to reproduce and distribute reprints for Govern-mental purposes notwithstanding any copyright annotation thereon. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily represent-ing the official policies or endorsements, either ex-pressed or implied, of IARPA, DoI/NBC, or the U.S. Government.
