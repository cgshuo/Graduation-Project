 1. Introduction
In the last two decades there has been an increasing interest in understanding how some organisms generate different patterns, and how some of them use collective behaviors to solve problems approach ( Passino, 2005 ) has been used to exploit the evolved animal societies that are able to solve large-scale distributed problems. Some of the algorithms that have been developed are inspired on the collective foraging behavior of ants (Dorigo and Maniezzo, 1996 ), bees ( Nakrani and Tovey, 2003; Teodorovic and different animal societies (e.g., school of fishes) ( Kennedy and
Eberhart, 1995 ). For instance, the ant colony optimization (ACO) applications (e.g., Schoonderwoerd et al., 1996; Reimann et al., 2004). Another approach that mimics the behavior of social organisms is the particle swarm optimization (PSO) technique, Many applications have applied this type of optimization method from an evolutionary game-theoret ic perspective, and (ii) provide novel strategies for multizone temperature control, an important ACO is designed and successful for primarily static discrete optimization problems, like for shortest paths and hence is not directly applicable to dynamic continuous resource allocation problems. In the other hand, PSO has been used for continuous optimization problems. Even though we might be able to formulate our problem using an objective function and solve it with PSO, the main objective of this paper is not to compare with optimization we aim to study the game-theoretic development of the honey bee social foraging (rather than optimization), and the implementation of those game-theoretic methods.

Our model of honey bee social foraging relies on experimental studies ( Seeley, 1995) and some ideas from other mathematical models of the process. A differential equation model of functional aspects of dynamic labor force allocation of honey bees is developed and validated for one set of experimental conditions in Seeley et al. (1991) and Camazine and Sneyd (1991) . The work in Cox and Myerscough (2003) extends this model (e.g., by adding details on energetics and currency) and Sumpter and Pratt (2003) introduced a generic nonlinear differential equation model that in Sumpter and Pratt (2003) and Cox and Myerscough (2003) , our model of recruitment uses the idea from Seeley et al. (1991) and
Camazine and Sneyd (1991) that dance strength proportioning on the dance floor shares some characteristics with the evolutionary and reproduction to recruitment as discussed in Seeley, 1995).
Here we make such connections more concrete by modeling the bee recruitment process in an analogous manner to how survival of the fittest and natural selection are modeled in genetic algorithms using a stochastic process of fitness proportionate (1998) introduce an  X  X  X ndividual-oriented X  X  model of social fora-ging and validate it against one set of experimental conditions as was done in Seeley et al. (1991) and Camazine and Sneyd (1991) .
More recently, in de Vries and Biesmeijer (2002) the authors expanded and improved the model in de Vries and Biesmeijer (1998) (e.g., taking into account the findings in Seeley and Tovey (1994) and by studying an equal harvest rate forager allocation distribution). The work in Bartholdi et al. (1993) studies the in Dukas and Edelstein-Keshet (1998) study the spatial distribu-tion of solitary and social food provisioners under different currency assumptions. The work in Bartholdi et al. (1993) , Dukas and Edelstein-Keshet (1998), and de Vries and Biesmeijer (2002) tion X  X  (IFD) ( Fretwell and Lucas, 1970 ). Here, we do not use a detailed characterization of bee and nectar energetics and currency since there is not enough experimental evidence to justify whether or when a gathering rate or efficiency-based currency is used ( Seeley, 1995); instead, we develop a generic measure of forage site profitability. This general profitability measure approach is the same one used in Passino and Seeley (2006) to represent the nest-site quality landscape for the honey bee nest-site selection process. Our general measure has the advantage of allowing us to easily represent a wide range of density-dependent foraging currencies via the classical 1970). Also, it eases the transition to the multizone temperature control problem since the temperature control objective can be easily characterized with our general profitability measure.
The IFD concept has been used to analyze how animals distribute themselves across different habitats or patches of food (Fretwell and Lucas, 1970 ). These habitats have different characteristics (e.g., one habitat might have a higher nutrient input rate than another), but animals tend to reach an equilibrium point where each has the same correlate of fitness (e.g., consump-sense the quality of all habitats and seek to maximize the reside in), and the term  X  X  X ree X  X  means that the animals can go to any habitat. In this paper, the IFD is a central unifying concept.
The IFD will emerge for one hive as the foragers are cooperatively allocated across sites. Moreover, if n hives compete in the same environment for a resource the IFD will also emerge. Here, we create a mathematical representation of the n -hive game where each hive X  X  strategy choice entails picking the distribution of showing that the IFD is a strict Nash equilibrium ( Bas -
Olsder, 1999) in terms of the payoffs to each hive and a special of an ESS is based on one important assumption: the population size has to be infinite. In Schaffer (1988) and Maynard Smith (1988) the authors define the conditions that must be satisfied in population size. Using the ideas in Schaffer (1988) we state the cannot survive when competing against a field of n 1 hives that use the IFD strategy. While this means that the IFD is locally tion deviations by a hive are not profitable), here we show that the achieved IFD is a global optimum point for both single hive forager allocation of all hives but one is at the IFD, then the is to maximize its return.

Finally, it is important to highlight that other algorithms have been developed using honey bee social foraging. For instance, in
Teodorovic and Dell X  X rco (2008) the authors introduce a bee colony optimization (BCO) algorithm, which is a generalization of the bee system (BS) tested in another combinatorial optimization problems, to solve a common problem in traffic congestion.
Others have used different approaches to solve different optimi-zation problems such as energy efficient mobile ad hoc networks (Wedde and Farooq , 2005 ), job shop scheduling ( Chong et al., 2006), or Internet servers ( Nakrani and Tovey, 2003; Walker, foraging algorithm do not focus on trying to mimic the whole behavior of the foraging process. They tend to concentrate on the most important part of the foraging process, i.e., the waggle can be grouped into continuous optimization problems. As it was pointed out before, our approach seeks to illustrate concepts from a game-theoretic perspective rather than the optimization one used in most of these algorithms ( Pankiw, 2005; Pham et al., 2006; Teodorovic and Dell X  X rco, 2005; Chong et al., 2006; concepts introduced in this paper, and the honey bee social foraging algorithm are illustrated by means of an engineering application. In general, most of the applications that use honey bee social foraging approaches use their algorithms in simula-tions, or in applications where the algorithm is not directly applied to solve a real engineering application. However, in our case, the technological challenge we confront is experimental multizone temperature control. Achievement of high performance multizone temperature control is very important in a range of commercial and industrial applications. For instance, recent work in this area includes distributed control of thermal processes 2003; Demetriou et al., 2003; Ross, 2004 ), and semiconductor processing ( Alaeddine and Doumanidis, 2004a,b ; Schaper et al., 1999b ). Particularly relevant to our work is the study in Emami-
Naeini et al. (2003) , where the authors use multivariable distributed control in order to maintain a uniform temperature across a wafer during ramp-up (similar to the control objective we study here). In Schaper et al. (1999a) the authors describe a lithographical system that is heated by 49 independently controlled zones. Here, we use a multizone experimental setup that is similar to the one in Quijano et al. (2005) where dynamic resource allocation methods are studied. In Quijano and Passino (2007) a multizone temperature control experiment is also used, but the dynamics are based on a replicator dynamics model.
Our experiments demonstrate how one hive can achieve an IFD that corresponds to maximum uniform temperatures on the temperature grid using a honey bee social foraging algorithm.
We illustrate the dynamics of the foraging algorithm by showing how it can successfully eliminate the effects of ambient temperature disturbances. Moreover, we show that even if two hives have imperfect information they can be used as a feedback control that will still achieve an IFD.

The paper is organized as follows. First, in Section 2 we introduce the honey bee social foraging algorithm. In Section 3 we perform a theoretical analysis of the hives X  achieved IFD equilibrium. In Section 4 we apply the honey bee social foraging algorithm to a multizone temperature control experiment and show how the IFD emerges under a variety of conditions. 2. Honey bee social foraging algorithm
Modeling social foraging for nectar involves representing the environment, activities during bee expeditions (exploration and foraging), unloading nectar, dance strength decisions, explorer allocation, recruitment on the dance floor, and accounting for interactions with other hive functions. The experimental studies we rely on are summarized in Seeley (1995). Our primary sources for constructing components of our model are as follows: dance strength determination, dance threshold, and unloading area (Seeley and Towne, 1992; Seeley, 1994; Seeley and Tovey, 1994 ); dance floor and recruitment rates ( Seeley et al., 1991 ); and
Seeley and Visscher, 1988 ). Table 1 summarizes all notation used for the model that is explained next. 2.1. Foraging profitability landscape
We assume that there are a fixed number of B bees involved in foraging. For i  X  1,2, y , B bee i is represented by y i A position in two-dimensional space. During foraging, bees sample distribution of forage sites with encoded information on foraging profitability that quantifies distance from hive, nectar sugar content, nectar abundance, and any other relevant site variables. sents a location with no profitability, and 0 o J f  X  y  X  locations of intermediate profitability. For y  X  X  y 1 , y y directions for our example foraging area are for convenience scaled to [ 1,1] since the distance from the hive is assumed to be
As an example of the type of foraging profitability landscape we could have four forage sites centered at various positions that are initially unknown to the bees (e.g., site 1 could be at forage site, and the height is proportional to the nectar profitability. For example, we could use cylinders with heights N
A  X  0 , 1 that are proportional to nectar profitability, and the  X  y i  X  1 : 5 , 2 &gt;  X  &gt;  X  y i  X  1 : 5 , 2 &gt;  X  q other sites. 2.2. Bee roles and expeditions
Let k be the index of the foraging expedition and assume that assessments at one time (an asynchronous model with randomly spaced arrivals and departures will behave in a qualitatively similar manner). Our convention is that at time k  X  0no expeditions have occurred (e.g., start of a foraging day), at time k  X  1 one has occurred, and so on. All bees, i  X  1,2, y , B , have y profitability of being at site j , which we denote by s j Caraco, 2000) is to represent this by letting, for each j , s  X  k  X  X  In this case, we could assume that a j is the number of nutrients and Lucas, 1970 ).

Of the B bees involved in the foraging process, we assume that back from some site and that will not follow dances). Initially, B (0)  X  0 since no foraging sites have been found. We assume that that seek to observe the dances of employed foragers on the dance given below will set the number of resters and observers. We positions in the environment, bring their nectar back if they find any, and dance accordingly, but were not dedicated to the site (of course they may become dedicated if they find a relatively good site).
 e
We ignore the specific path used by the foragers on expeditions and what specific activities they perform. We assume that a bee simply samples the foraging profitability landscape once on its expedition and hence this sample represents its combined overall that it holds when it returns to the hive. It also brings back knowledge of the forage location which is represented with y by employed forager (or forage explorer) i be
F  X  k  X  X  be uniformly distributed on ( w f , w f )with w f value e n 4 0 sets a lower threshold on site profitability. Here, on average have an accurate profitability assessment since the expected value with respect to k of w i f ( k ), E [ w i f all unemployed foragers. 2.3. Dance strength determination called  X  X  X ance strength. X  X  The B u ( k ) unemployed foragers have
L ( k )  X  0. All employed foragers and forage explorers that have
F and will not dance; these bees will become unemployed foragers. 2.3.1. Unload wait time
Next, we will explain dance strength decisions for the employed foragers and forage explorers with F i  X  k  X  4 e this, we first model wait times to get unloaded and how they influence the  X  X  X ance threshold. X  X  Define F t  X  k  X  X  P B i  X  1 total nectar profitability assessment at step k for the hive.
Foragers at profitable sites tend to gather a greater quantity of nectar (load size) gathered for a profitability assessment F constant. We choose a  X  1 so that F i q  X  k  X  A  X  0 , 1 , with F representing the largest nectar load size. Notice that if we let
F
F  X  k  X  X  forager contributes to the total nectar influx.
 The average wait time to be unloaded for each bee with the number of food-storer bees is sufficiently large so the wait time W i ( k ) that bee i experiences is given by
W  X  k  X  X  c max f F tq  X  k  X  X  w i w  X  k  X  , 0 g X  c max f a F represents variations in the wait time a bee experiences. We assume that w w i ( k ) is uniformly distributed on ( w w
F  X  k  X 
A  X  0 , a B , c  X  a B  X  w w  X  is the maximum value of the wait time which is achieved when total nectar influx is maximum. For the experiments in Seeley and Tovey (1994) (July 12 and 14 data) the maximum wait time is about 30s (and we know that it must be under this value or bees will tend to perform a tremble dance rather than a waggle dance to recruit unloaders, Seeley, 1995); hence, we choose c  X  a B  X  w w  X  X  30. Note that 7 c w w seconds is the variation in the number of seconds in wait time due to the noise and w w should be set accordingly. We let c w w  X  5 to get a variation of 7 5s.If B  X  200 is known, we have two equations and two unknowns, so combining these we have c B  X  c w w  X  30, which gives c  X  25 = 200 and w w  X  40.

That there is a linear relationship between wait times and total experiments described in Seeley and Tovey (1994) and Seeley (1995, p. 112) . Deviations from linearity come from two sources, the w i ( k ) noise and the  X  X  X ax X  X  in Eq. (1). Each successful forager has a different and inaccurate individual assessment of the total nectar influx since each individual bee experiences different wait this. Some foragers can get lucky and get unloaded quickly and foragers may be unlucky and slow to get unloaded and this will result in an impression that there is a very high nectar influx. 2.3.2. The dance decision function
Next, we assume that the i th successful forager converts the total nectar influx that we define as ^
F  X  k  X  X  d W i  X  k  X  X  2  X 
So, we are assuming that each bee has an internal mechanism for relating the wait time it experiences to its guess at how well all the other foragers are doing ( Seeley, 1995). The proportionality constant for this is d 4 0 and since W i  X  k  X  A  X  0 , c  X  we have ^ F i tq  X  k  X  A  X  0 , 30 d .

So, how does total nectar influx influence the dance strength how long to dance, the bee takes into account a set of forage site from hive, sugar content of nectar, nectar abundance), together with a set of general foraging conditions that determine the time of day) ( Seeley, 1995). Here, we build on this by defining a  X  X  X ecision function X  X  for each bee that shows how the dance threshold for each individual bee shifts based on the i th bee X  X  estimate of total nectar influx. The decision function is
L  X  k  X  X  max f b  X  F i  X  k  X  ^ F i tq  X  k  X  X  , 0 g X  3  X  which is shown in Fig. 1 . The parameter b 4 0 affects the number of dances produced for an above-threshold profitability.
The diagonal bold line in Fig. 1 shifts based on the bee X  X  estimation of total nectar influx since this is proportional to ^
F maximum with zero in Eq. (3), the lowest value of nectar estimate of the total nectar influx. Note that changing b does not shift the dance threshold. The parameter b will, however, have the influx to the hive and it has been found experimentally ( Seeley, can dance with 100 or more waggle runs. Hence, we choose  X  k  X  A  X  0 , b  X  X  0 , 100 waggle runs for all i and k .
 The dance threshold in Eq. (2) is defined using the parameter d .
What value would we expect a bee to hold for d ? Since the nectar profitability F i  X  k  X  A  X  0 , 1 , d needs to be defined so that so that the dance threshold is within the range of possible nectar profitabilities. This means that we need 0 o d r 1 30  X  4  X 
To gain insight into how to pick d in this range notice that d is proportional to the site abandonment rate: (i) if d 0, then the of significantly inferior relative profitability will never be abandoned, something that does not occur in nature; and (ii) if dance threshold is so high and the foraging process fails completely, something that does not occur in nature. Hence, d must be somewhere in the middle of the range in Eq. (4); in simulations we tuned the value of d to match experiments and found d  X  0 : 02. 2.3.3. Dance/no-dance choice
The set of bees that, after dance strength determination as consider dancing for their forage site. Here, we let p r  X  i , k  X  site it is dedicated to. We assume that p  X  i , k  X  X  f  X  1 since it resulted in matching the qualitative behavior of what is found in experiments. For low nectar influx, (waggle-dancing) bees will tend to dance and (waggle-dancing and non-waggle-dancing) bees stay at discovered forage sites. As nectar influx increases, waggle-dancing bees will only dance for the most profitable sites, and inferior sites will be abandoned by all bees. Hence, a bee with an above-threshold profitability is more likely to dance the further its profitability is above the threshold as seen in experiments ( Seeley, 1995). In this way, relatively high quality new discoveries will typically be danced for, but as more bees are recruited for that site and hive nectar influx increases, it will become less likely that bees (e.g., the danced for; however, bees that decide not to dance will still go back to the site and remain an employed forager for it. If bee i for its last site. We let B fd ( k ) denote the number of employed foragers with above-threshold profitability that dance. 2.4. Explorer allocation and forager recruitment 2.4.1. Resters and observers
The bees that either were not successful on an expedition, or were successful enough to get unloaded but judged that the profitability of their site was below the dance threshold, become unemployed foragers. Some of these bees will start to rest and other dance  X  X  X bservers X  X  will actively pursue getting involved in the foraging process by seeking a dancing bee to get recruited. unemployed forager or currently resting bee will become an observer bee; hence 1 p o is the probability that an unemployed has been seen experimentally ( Seeley, 1983 ) that in times where there are no forage sites being harvested there can be about 35% of the bees performing as forage explorers, but when there are many sites being harvested there can be as few as 5%. Hence, we choose p o  X  0.35 so that when all bees are unemployed, 35% will explore. In Anderson (2001) the author shows how the optimal available forage, and the ability to find it. 2.4.2. Explorers and recruits
Here, we assume that an observer bee on the dance floor length of time, it gives up and goes exploring. To model explorer allocation based on wait-time cues, we assume that wait-time is assumed to be proportional to the total number of waggle runs on the dance floor. Let L  X  k  X  X  be the total number of waggle runs on the dance floor at step k . p ( k ) we make it an explorer. We choose p  X  k  X  X  exp p ( k )  X  1 and all the observer bees will explore (e.g., L initially all observer bees will choose to explore). If L the observer bees are less likely to find a dancer and hence will not get recruited to a forage site. They will, in a sense, be L ( k ) increases, they become less likely to explore and, as discussed below, will be more likely to find a dancer and get recruited to a forage site. Here, we choose s  X  1000 since it produces patterns of foraging behavior in simulations that correspond to experiments.

The explorer allocation process is concurrent with the recruitment of observer bees to forage sites. Observer bees are observer bee that did not go explore and have it be recruited. To model the actual forager recruitment process we view L i f  X  X  X itness X  X  of the forage site that the i th bee visited during expedition k . Then, the probability that an observer bee will
L (k) f follow the dance of bee i is defined to be p  X  k  X  X 
In this manner, bees that dance stronger will tend to recruit more foragers to their site.

To summarize, Algorithm 1 shows the pseudo-code of the honey bee social foraging algorithm described above.
Algorithm 1. Honey bee social foraging algorithm 1: Set the parameter values. 2: for Fixed number of expeditions do 3: Determine number of bees at each forage site, and 4: for Each employed forager and explorer do 5: Define a noisy assessment according to the location. 6: if Bee is successful in getting an above profitability 7: if Bee is an employed forager then 8: Stays that way. 9: else if Bee is an explorer then 10: Bee becomes an employed forager. 11: end if 12: else 13: Bee becomes an observer or rester. 14: end if 15: end for 16: Compute the total nectar profitability, and the total 17: for All employed foragers do 18: Compute wait time W i , and the noise for unload wait 19: Compute estimate of scaled total nectar influx ^ F tq 20: Compute dance decision function L i f . 21: if L i f  X  0 then 22: Bee i becomes unemployed. 23: else if Employed forager should not recruit then 24: L i f  X  0. Bee i is removed from those that dance. 25: end if 26: end for 27: Determine L t . Employed foragers and successful forager 28: Send all employed foragers back to their previous site 29: for Unemployed foragers do 30: Since the unemployed foragers do not dance, we set 31: We split the unemployed foragers in resters and 32: end for 33: Set p e . 34: for Unemployed foragers do 35: if rand o p e then 36: Bee becomes an explorer. Set location for explorer 37: end if 38: end for 39: for Unemployed observers do 40: Recruit the unemployed forager by some employed 41: Recruit the unemployed to a noisy position of the 42: end for 43: end for 2.5. Discussion
We have conducted extensive simulations to validate the bees. In particular, we have shown that the model represents seen in Seeley et al. (1991) and Camazine and Sneyd (1991) (the models discussed earlier), reallocation when new forage sites suddenly appear or disappear, or when site qualities change (Seeley, 1995; Seeley et al., 1991; Camazine and Sneyd, 1991). In the interest of brevity we do not include these simulations here since: (i) our focus is not on model validation (i.e., accurate representation of numerical data from experiments on honey bee social foraging) but on bioinspired design based on the main algorithm features; and (ii) the key qualitative features of the 3. Equilibrium analysis of hive allocations
In Section 2 we explained how the honey bee social foraging we prove that the hives X  IFD is a global optimum point. For that, some assumptions have to be made. In the previous section we saw how bees in different roles were allocated to different forage sites by their behavior in the hive. In the following analysis we assume that there exists a fixed number of hives n in an environment, that each hive contains a fixed amount of employed different sites (i.e., we ignore the components of the process associated with searching for forage sites). 3.1. The n-hive game 3.1.1. Nash equilibrium amount of bees the i th hive can allocate. Also, assume that a could be proportional to site profitability). Hence, in an n -hive game each hive has N pure strategies corresponding to choosing allocates to each site, or for hive i , the strategy is x  X  X  x i 1 , x i 2 , ... , x i N &gt; element of the simplex
D  X  x  X  X  x 1 , ... , x N : 8 &lt; : following is valid for all y i a x i , i  X  1,2, y , n : f  X  y j x i  X  r f  X  x i j x i  X  X  7  X  x allocate the bees using the optimum strategy x so that its gain is maximum in terms of fitness payoff. Notice that if the inequality hives
The original formulation of an evolutionarily stable strategy (ESS) introduced in Maynard Smith and Price (1973) and Maynard
Smith (1982) assumes that the population size (number of hives) is infinite and hence does not apply here. There have been a
However, the seminal work is contained in Maynard Smith (1988) and Schaffer (1988) where the authors state the equilibrium and stability conditions similar to the ones defined in Hofbauer and
Sigmund (1998) . The n -hive game that we set up in this case can ESS for finite populations as follows.
 set made up of n 2 x -strategists and only one y -strategist. Let of n 1 x -strategists. The mixed incumbent strategy holds: f  X  y , P x  X  o f  X  x , P x , y  X  X  8  X  for all y a x .

This is what is known as the equilibrium condition for the game clear that this condition only tests if the population of hives cannot be invaded by only one mutant. If we have more than one mutant, we have to check another condition. This condition is usually known as the stability condition, and it says that a said that the ESS is globally stable whenever Y  X  n 1. Here, we assume that there is only one mutant since mutants are rare; hence, we do not need to check the stability condition. 3.1.3. Hive/bee fitness definitions
Before we show that the IFD is a strict Nash equilibrium, we need to define the payoff of hive i . First, let us define the contribution to the fitness of hive i at site j as f  X  j  X  X  a j number of bees allocated to that site by all hives. Then, there is investing x j i bees at site j , while the other n 1 hives invest
P hive i , i  X  1,2, y , n ,is f  X  all i a i 0 ,asin f  X  equally in every site so that x i  X  1,2, y , n , for j  X  1,2, y , N , P Notice that since P N k  X  1 x i k  X  B f for all i  X  1,2, y Sutherland, 1986; Parker, 1978 ) to the n -hive game. In Quijano and Passino (2007) the authors have shown the equivalence between the input and the habitat matching rule for a general case of suitability functions. We can use the same ideas as in Quijano and Passino (2007) to prove that Eq. (13) can also be written as x a for all k , j  X  1,2, y , N , and i  X  1,2, y , n .

Eq. (9) defines the fitness for multiple hives. However, when For that, we can assume that each bee is identical and represented by a small e x 4 0 so that there is an arbitrarily large (integer) number n 4 0 of bees in the hive, where n e x  X  B f we define this bee X  X  fitness as f  X  j  X  X  a j = n j .If a j gets at site j . Notice that f  X  j  X  X  a j n These ideas will be helpful in Section 3.3. 3.2. The multiple hive IFD is a strict Nash equilibrium and ESS In the next theorem 1 we show that the IFD in Eq. (13) is a strict Nash equilibrium. This implies by Eq. (8) that the IFD is a one-stable ESS, because the IFD is the best strategy whenever one mutant hive plays against n 1 incumbents in an n -hive game. Theorem 3.1. For the n-hive game if the x j i , j  X  1,2, y a finite population one-stable ESS .
 discussed as if it were with respect to a number of animals (e.g., that if we think of achievement of Eq. (13) by each hive as  X  X  X ndividual-level X  X  IFD achievement, then for all j  X  1,2, and i  X  1,2, y , n , x and if we sum over i , ! or for all j  X  1,2, y , N ,
P
P
Eq. (15) can be interpreted as a  X  X  X ive population-level X  X  or  X  X  X nvironment-wide X  X  IFD. Clearly, however, Eq. (13) is only one way to achieve this population-level IFD (as the next example will and (i) still get the same fitness as each other and as the fitness achieved at the IFD in Eq. (13), and (ii) achieve the population-level IFD in Eq. (15). For example, if N  X  n  X  2, B a  X  a from Eq. (13) is used. Also, Eq. (15) holds for the alternative strategy choice. 3.3. Optimality of the single and multiple hive IFD
The results in Section 3.2 show that the IFD is a local optimum point in a game-theoretic sense. Here, we show that the
IFD is a global optimum point for both a single hive and multiple hives. 3.3.1. Single-hive allocation
First, we take the perspective that a single hive wants to allocate some number of bees B f to N choices (sites) in order to optimize its payoff (fitness). We drop the superscript and use x
The percentage of the total number of bees to site j is x J  X  to the hive. This is a consequence of the  X  X  X ontinuous input X  X  assumption for the IFD formulation that says that all nutrients arrive at a constant rate and are immediately consumed use the strategy of maximizing J in order to determine how to allocate the number of bees. Does there exist a payoff function that the hive can try to optimize that does guide it to maximize its payoff? Next, we show two approaches to answer this question.

First, assume that a j 4 0, x j 4 0, and note that a j = x return from each investment, under the constraint that P minimum fitness as defined by Eq. (14), i.e., solve the optimiza-tion problem maxmin a 1 x subject to x j 4 0 , j  X  1 , 2 , ... , N  X  17  X  strategies). The  X  X  X ax min X  X  represents that multiple bees simultaneously shift strategies to improve their fitness since at least some bees with lowest fitness shift sites (and if a = x j  X  e x a k = x k for some j and k the min can be achieved at multiple sites). It has been shown in Quijano and Passino (2007) global maximum for that optimization problem and hence will maximize the hive X  X  payoff.

Second, viewing the hive X  X  effort allocation strategy as being would be appropriately modeled as the optimization of some payoff functions be used besides the one in Eq. (17)? Generally, variables x j to payoff J and other equally valid relationships between these two could lead to optimal effort distributions, introduce another candidate payoff function J .

To develop this J suppose that a j 4 0 and x j 4 0 for j  X  1,2, return from site j . For instance, if a j is in units of nutrients hive wants to invest as few as possible bees, yet get as much minimize J  X  then it will maximize its return on investment by minimizing its losses. Or, from another perspective, it minimizes the average IFD.

Theorem 3.2. The point x  X  is the global minimizer for the constrained optimization problem defined as minimize J  X  1 B subject to x j 4 0 , j  X  1 , 2 , ... , N 3.3.2. Multiple hive allocations
Theorem 3.2 shows that the IFD is achieved for a single-hive allocation. Now, we want to prove that the IFD is also reached for the case when we have multiple hives that want to allocate bees across different sites. From the proof of Theorem 3.1 it should be clear that there are an infinite number of points x j i , j  X  1,2, i  X  1,2, y , n , that result in P which is the achievement of an IFD by the aggregate of the number of bees X  allocation. In the next theorem, we show that the optimum payoff value is given by what we call the population-level IFD in Eq. (19).
 payoff .

The optimization problem can be interpreted as one hive allocating some number of bees at the site where n 1 hives have hive, the total number of bees across the N sites is equal to P gets the same payoff that all the other hives get if it plays a strategy such that the population-level IFD is achieved. 3.4. Discussion
The previous analysis is based on the hypothesis that we have full static information. This means that we did not analyze the chosen, or when the fitness functions in (9) or (14) have dynamics. Analysis for these cases remains a (challenging) research direction. In the next section, we motivate the impor-tance of addressing these theoretical questions by showing that multiple poorly informed socially foraging honey bee hives can achieve an IFD in an application where there is significant noise. 4. Engineering application: dynamic resource allocation for multizone temperature control
In this section we introduce an engineering application that illustrates the basic features of the dynamical operation of the honey bee social foraging algorithm. First, we describe the hardware used and some implementation issues. Next, we provide data from three experiments that demonstrate the achievement of the ideal free distribution and the effects of cross-inhibition and imperfect information flow. 4.1. Experiment and honey bee social foraging algorithm design
We implemented the multizone temperature control grid shown in Fig. 2 . A zone contains a lamp and a National Semiconductors LM35CAZ temperature sensor. The temperature is acquired using four analog inputs with 16 bits resolution each on a dSPACE DS1104 card. Although we cannot guarantee that the four sensors have the same characteristics, they have 7 0 : 2 3 C typical accuracy, and 7 0 : 5 3 C guaranteed. The lamps are turned card and a DS2003 Darlington device that drives the amount of current necessary to turn on a lamp. The lamps change their intensities drastically when we apply more than 1.6V. We added by software a DC value of 1.25V, which implies that there is a range where the lamps are off even if we allocate a small amount of energy in a zone.

We assume that there is a fixed total amount of voltage V (the resource) that can be split up and applied to the zones. The goal is to allocate this fixed amount of voltage in a way that (i) makes the temperatures in all zones the same, and (ii) maximally elevates the temperature across the grid. In other words, we want a maximum uniform temperature. Achievement of this goal is complicated by interzone effects (e.g., lamps affecting the temperature in neighboring zones), ambient temperature and wind current challenges (from overhead vents), zone component differences, and sensor noise. These effects demand that voltage be dynamically allocated. For example, if there is an ambient lamp in zone 4 should decrease and that voltage should be allocated across the other three zones.

Given the hardware description and the model, we choose a honey bee social foraging algorithm as follows: 1. We assume that there are a fixed number of bees involved in the foraging process, B . Each bee corresponds to a quanta of energy, which in this case corresponds to a certain amount of volts, of the V tot available volts, that will be specified below. 2. We assume that the foraging landscape is composed of four forage sites, which correspond to the zones j , j  X  1,2,3,4. 3. Let T d be a temperature value that cannot be achieved in the experiment (here we use T d  X  29 3 C). Let T j be the temperature in zone j , and let e j  X  T d T j be the temperature error for zone j . We assume that the  X  X  X est X  X  (most profitable) forage site corresponds to the zone that has the highest error. Bees (quanta of voltage) that are allocated to better sites will raise the temperature there. Repetitive allocation will result in persistently raising the minimum temperature. 4. We assume that the profitability assessment of each site F is proportional to e j and given by
F j  X  k  X  X 
We let g  X  1 8 since given T d the temperature error e j o 8 g e  X  0 : 1 since this means that sensor inaccuracies are not interpreted as profitability differences and, so that with
T  X  29 3 C any temperature error is profitable for allocation. 5. The waiting time defined in Eq. (1) has two tunable parameters, c and w w . In this case, we have tuned these values and we chose c  X  0 : 25 and w w  X  20. b  X  100 to ensure that bees are persistently recruited to achieve the bee (voltage) allocation and persistently explore sites for more temperature error. The particular values chosen were explained in Section 2, and these values did not need to be retuned for the application.

The experimental results shown below were obtained on different days with different ambient room temperatures. 4.2. Experiment 1: one hive IFD achievement
In this experiment we seek the maximum uniform tempera-ture when we have V tot  X  2.5V of resource available. We assume that there is one hive that has 200 bees, which are equivalent to
V . In other words, we assume that each bee is equivalent to 0.0125V. Fig. 3 shows the experimental results for the tempe-(bottom plots), when the room temperature is T a  X  22 3 C. Fig. 4 illustrates how the bees are allocated to various roles.
The top plot shows how the number of employed foragers B f increases drastically at the beginning, but then it drops until it arrives to a steady-state. The bottom plot shows the number of search for temperature error. From the data obtained, it can also be seen that many bees get recruited. This implies that these bees find a site and they do not abandon it, which provides good temperature regulation.

Fig. 7 , which will be used to compare the results of all the experiments, shows the average temperature (top plot) and the average number of bees (bottom plot) for the last 100s. The data for experiment 1 show how an ideal free distribution is achieved.
As we can see, the final temperature reached by all zones is around 27 3 C. In terms of the average number of bees for the last 100s, we can see that the voltage allocated is around 1.7V (DC offset included), which is equivalent to 35 bees per zone.
However, due to the differences between sensors and lamps, more bees are allocated in the fourth zone (i.e., zone 4 is more results shown below. and site truncation
The second experiment is similar to the first one, but we add two disturbances to the system. These disturbances are created by two extra lamps, one placed next to zone 1 and another placed next to zone 4. We start the experiment at a room temperature of
T and top right plots represent the disturbance types applied to the 0 1000 2000 3000 18 20 22 24 26 28 30 0 1000 2000 3000 0 20 40 60 80 100
B
B 18 20 22 24 26 28 30 0 20 40 60 80 100 120 system: 1. We turn on the disturbance lamp next to zone 4 at t  X  850s, and we turn it off at 1170s. 2. We turn on the disturbance lamp next to zone 1 at t  X  2160s, and we turn it off at 2500s. 3. We turn on the disturbance lamps next to zones 1 and 4 at t  X  3200s, and we turn them off at 5400s.

When we apply disturbance 1, the temperature in zone 4 starts to increase, and the number of bees allocated in that zone decreases drastically. At the same time, the number of bees in the other three zones increases. This is because site number 4 is the least the other three zones; this is why the temperatures in zones 1 X 3 increase until the disturbance is turned off. At that moment, the zones are practically at the same temperature. During the 5min of disturbance, the temperatures in zones 2 and 3 remain close to 25 : 5 3 C, while the temperature in zone 1 is around 25 : 4 3 C.
Therefore, zone 1 becomes the most profitable one, and hence more bees are allocated to that site (around 76 bees were allocated on average to zone 1, while 37, 41, and 10 bees were allocated on average to zones 2, 3, and 4, respectively). The same basic behavior occurs when disturbance 2 is applied to the 27 1
C, while the other temperatures were close to 25.6 1 C. As in the previous case, the temperature in zone 4 was close to 25.5 and 93 bees were allocated on average to zones 1 through 4, respectively). We highlight the fact that zone 4 has more bees than the middle zones. As we mentioned in Section 4.2 this is due to the differences between sensors and lamps. After disturbance 2 temperatures equilibrate but with a bee allocation where there are far fewer bees in zones 1 and 4 and more in zones 2 and 3. To 100s is practically the same for the middle zones (34.8 bees), and there are practically the same number of bees allocated to zones 1 temperature that is practically the same for zones 1 and 4 (i.e., around 28.6 1 C) and for the middle zones (i.e., around 28
However, as we mentioned before, the fact that there are 10 bees in a zone does not necessarily imply that the lamp is on. In this case, 10 bees corresponds to 0.125V, which implies that the lamp is off (recall that the DC value was 1.25V). Therefore, the bees allocated to zones 1 and 4 do not have any influence on the temperature. Only the disturbances affect these temperatures.
Hence the residual number of 10 or so bees simply represents that the hive is continually sampling these sites in case they become profitable. 4.4. Experiment 3: two hives and imperfect information
In this final experiment, we change the conditions and instead of using only one hive, we assume that we have two hives each with limited information. The first hive is assumed to only have access to the temperatures in zones 1 X 3, while the second hive has access to the temperatures of zones 2 X 4. This may happen in nature if a hive has not discovered a site. In temperature control applications such sensing restrictions commonly arise due to sensor or other hardware costs.

Each hive is composed of 200 bees, which implies that the 5V that we allocate corresponds to 400 bees (i.e., each bee corresponds again to 0.0125V). Fig. 6 shows the results for this final temperature is practically the same, around 25.4 1 C. The main difference in this case is that the number of bees in zones 2 allocates on average around 50 bees to zones 2 and 3, while the second hive allocates on average around 20 bees to zones 2 and 3.
However, as we can see in the experiment 3 data in the bottom two hives except for zone 4. It is important to notice that the difference between the initial temperature and the final temperature in the first experiment is around 5 1 C, while in this case is around 6 1 C. Therefore, as we expect, the maximum temperature reached by the grid is higher than the first one if we compare the temperatures relative to room temperature. This is mainly due to the fact that at the end we are allocating more bees and 2 where we had V tot  X  2.5V. Finally, another important issue and lamps in zone 4 with respect to the other zones (as it was seen in the previous experiments), there is imperfect information.
As we can see, hive 1 allocates more bees to zones 2 and 3 compared to the number allocated by hive 2. This implies that the temperature errors in these zones decrease, while the temperature in zone 4 seems to be lower than the middle zones due to sensor differences. Then, the second hive allocates more (these zones receive more bees from hive 1, and its total value is similar to the number of bees allocated in zone 1). The bottom plot in Fig. 6 illustrates this point. 4.5. Discussion
Some of the main concepts described in social foraging modeling section (Section 2) can be seen in these experiments.
In Section 4.2 we have seen how an IFD is reached by all zones, and good regulation is obtained even though the search space is limited (Section 4.4). As shown in Section 4.3, an IFD is also reached when disturbances are applied to the system. The IFD zones, depending on whether the disturbance is on or not. In other words, the middle zones that are not significantly affected by any type of disturbance increase their temperature to their maximum possible value. This maximum depends on the amount of energy available. This energy is practically the same in each zone, which leads to uniformity in these zones. The other two zones have a disturbance associated with each of them, which implies that the number of bees allocated to each of these zones must be lower than for the middle ones. As we expect, the final temperature in this case is higher than in the first experiment because of the disturbances, and the numbers of bees allocated to
If we had reduced the magnitude of the disturbances in zones 1 and 4 then we would have gotten results analogous to those for disturbances 1 and 2. We chose the particular disturbance magnitudes in order to illustrate the elimination of zones 1 and and how the hive can then focus most of its attention on only the best sites.

Another important idea that is illustrated in these experiments in Fig. 5 . First, all zones were under the same conditions, and 18 20 22 24 26 28 30 0 50 100 150 practically the same number of bees visited sites 1, 2, and 3 (45, bees where allocated to zone 4 due to sensor differences). When while the number of bees in zone 4 reduces drastically. The same thing happens when disturbances 2 and 3 are applied. It is clear that in any of these cases one or two zones becomes less profitable (the temperature increases due to the disturbance, and hence the error decreases), which implies that the hive has to reduce the number of bees recruited to these poorer sites. This is given in the algorithm by a reduction of the number of dances for those zones where the error is smaller, which leads to a reduction in the number of bees that are recruited to these sites.
Experiment 3 shows how another IFD is achieved over all zones, even though there is not perfect information (see Fig. 7 ). tically the same (taking into account the sensor differences accuracy). However, as we mentioned before, hive 2 must use more of its bees to raise the temperature in zone 4, and that is why the number of bees allocated by this hive to zones 2 and 3 is small. This problem can be seen also as having a zone with a disturbance. In this case, zone 4 needs more energy, which the middle zones are not visited as much by the bees since they that is why a smaller amount of bees are allocated to zones 2 and 3 by hive 1 (compared to those that are allocated in zone 1 as it can be seen in the bottom plot in Fig. 6 ). However, the total number of bees (those allocated by hives 1 and 2) leads to prac-tically the same numbers of bees in zones 2 and 3, and the grid reaches a maximum uniform temperature.
 In all these cases, the temperature grid reached an equilibrium.
If we compare the experimental results with the theoretical results (Section 3), we can see that the equilibrium point for the first experiment is similar to what is shown in Theorem 3.2. In clear that the hive will allocate more bees where the error is higher. For the last experiment a population level type IFD as in (19) is achieved, again with a j proportional to the temperature error. We have proven in Theorem 3.3 that the IFD was the optimum point, and the experiments illustrate that this equili-brium was reached for n  X  2 hives. 5. Conclusions
In this paper we provided a novel bio-inspired resource allocation method, developed theory to explain key properties of the algorithm, and studied an application that illustrates the used is a multizone temperature control grid, where the control objective is to seek the maximum uniform temperature. In
Quijano and Passino (2007) the authors use the same testbed to show how the replicator dynamics model leads to an ideal free distribution (IFD). Here, the honey bee social foraging algorithm gives us similar results, and also helped us to illustrate dynamic re-allocation, cross-inhibition, and the IFD. We leave as an important future direction the comparative analysis with the performance of other methods for the experimental testbed. for allocation, for instance, in the area of formation control and task allocation of multiple agents.

The game and optimization theoretic theory that characterizes
IFD concept from theoretical ecology. We have shown that the IFD is a strict Nash equilibrium for an n -hive game and a one-stable
ESS. In other words, in an n -hive game the IFD is reached whenever n 1 hives are using it as a strategy and only one hive is much as the other hives. Since this is only a local concept, we extend our results to show that the IFD is a global optimum point for both a single hive and multiple hives. In this case we have develop in the future a dynamical model of IFD achievement (e.g., adaptive dynamics such as a replicator dynamics model, Hofbauer and Sigmund, 1998 ).

Finally, it is clear that in the implementation we have limited our system and drawn some analogies that might not seem real from a biological perspective. For instance, consider the informa-tion structure of the algorithm (i.e., what characteristics are present to provide information to the algorithm and between components of the algorithm). In a honey bee hive, the forage allocation process does not need a centralized entity that makes the decisions and allocates bees to each site, i.e., the hive is a decentralized system ( Seeley, 1995). However, if we analyze the honey bee social foraging algorithm, and more precisely Eqs. (1), (5) and (6), it is clear that the algorithm is not totally  X  X  X ndividual-based X  X  (e.g., Eq. (5) has to know a noisy version of the total number of waggle runs in order to decide how many in the future a more fully distributed version that faithfully respects what is known by individuals. Also, other large-scale optimization problems will be considered to show the applic-ability of our algorithm. Finally, it is our hope to in the future conduct a more complete mathematical and experimental evaluation of the robustness of our distributed dynamical control system.
 Acknowledgements This research was supported in part by the OSU Office of
Research. We would like to thank Thomas D. Seeley for a number of fruitful conversations on the biology of honey bee social simulation code for the honey bee social foraging algorithm and for some suggestions on the manuscript.

The authors would like to thank NIST for support for development of the temperature control experiment. Also, we support via an interdisciplinary research grant.
 Appendix A. Proofs of theorems A.1. Proof of Theorem 3.1 We will show that if x i  X  X  x i 1 , x i 2 , ... , x i  X  B f a j = hive mutant y i a x i will have a lower fitness for the moment, when y i A D x @ D x (i.e., strictly inside the simplex). This is equivalent to show that Eq. (7) is satisfied for all i  X  1,2,
But, it can also be seen as a constrained optimization problem of the form maximize f i  X  subject to This is a nonlinear optimization problem that we will solve using Lagrange multiplier theory (e.g., Bertsekas, 1995 ).
Second, replace in Eq. (10) the constraint x k j  X  B f a j all k a i to get f  X  where f  X 
The problem in Eq. (21) becomes maximize f i subject to
Now, we define the vector x  X  X  x i 1 , x i 2 , ... , x i N the points for which we want to find an extremizer point. equal to r f i  X  x  X  X  @ f i r f i  X  x  X  X  a 1 f 1 Also, @ h =@ x i j  X  1 for all j  X  1,2, y , N . Let l be the
Lagrange multiplier for this constrained optimization problem. Then, we have to solve the following set of equations for x i j 4 0:  X  x ^  X  x x  X  x i 2  X  X  x i N  X  B f  X  x
Using Eq. (22),  X  x a !
Simplifying, we get that for all i , j  X  1 , 2 , ... , N , a x j  X  a j x After some algebraic manipulations, this implies that for all i  X  1 , 2 , ... , N , x  X 
In order to see that x i we need to prove the second order sufficiency condition. For that, 0). In this case, f j  X  x  X  X 
It is clear that the Hessian of f i ( x ) for x j i n , j  X  1,2, the cost function is convex on the simplex D x ). Hence, x by Eq. (23) (which is equivalent to Eq. (13)) is a strict Nash equilibrium. Also, since it is a strict Nash equilibrium, Eq. (8) holds. Therefore, the IFD is a one-stable ESS for the finite population in a game against the field.
 A.2. Proof of Theorem 3.2 constraint so it can be ignored. Let h  X  x  X  X  P N j  X  1 x case, we will have that the gradient of h ( x ) is equal to r h  X  x  X  X  X  1 , 1 , ... , 1 &gt; and the gradient for J ( x ) is given by r J  X  x  X  X  2 x 1 B Let l be the Lagrange multiplier for this constrained optimization problem. Then, we have to solve the following set of equations for x 4 0: 2 x B a 1  X  l  X  0 ^ 2 x B a N  X  l  X  0 x  X  x 2  X  X  x N  X  B f As in the proof of Theorem 3.1 this implies that a x for all j , k  X  1,2, y , N , which implies that x  X  need to prove the second order sufficiency condition. For that, we
In this case,
J  X  x  X  X  which implies by the second-order sufficient condition that x n
Eq. (24) is a local minimizer. However, we know that the cost function J is defined over a simplex D x , which is nonempty, minimum in Eq. (24) is also global ( Bertsekas, 1995 ). A.3. Proof of Theorem 3.3
From an optimization point of view, the problem that we want to solve is the same as maximize f i subject to inactive, so it can be ignored. Using Lagrange multipliers, we of the constraint. In this case, we have r f  X  @ f where @ f @ x  X  solve the following set of equations for x i j 4 0: a  X  x  X  ^ a  X  x  X  x  X  x 2  X  ... x i N  X  B f
Then, for any i , j  X  1 , 2 , ... , N , a  X  x  X 
Replacing the constraint in Eq. (25), a nPa i which implies that a x x  X 
The point in Eq. (26) is an extremizer for the optimization problem defined in (25). Now, let us prove that (26) is indeed a global maximizer for this problem. For that, we need to analyze f  X  x  X  X 
Clearly, since a j 4 0, B f 4 0, x i j 4 0, P n k  X  1 , k a i
Hessian is negative definite. Therefore we can conclude that the extremizer points defined in Eq. (26) are global maxi-mizers (because it is clear that the cost function is convex on the simplex D x ).

Replacing the optimum point, we can notice that the equivalent to Eq. (19).
 References
