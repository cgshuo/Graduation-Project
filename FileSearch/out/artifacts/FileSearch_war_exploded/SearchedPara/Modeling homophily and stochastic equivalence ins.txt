 Let { y i,j : 1  X  i &lt; j  X  n } denote data measured on pairs of a set of n objects or nodes. The examples considered in this article include friendships among people, associations among words and interactions among proteins. Such measurements are often represented by a sociomatrix Y , which is a symmetric n  X  n matrix with an undefined diagonal. One of the goals of relational data analysis is to describe the variation among the entries of Y , as well as any potential covariation of Y with observed explanatory variables X = { x i,j , 1  X  i &lt; j  X  n } .
 To this end, a variety of statistical models have been developed that describe y i,j as some function of node-specific latent variables u i and u j and a linear predictor  X  T x i,j . In such formulations, { u 1 ,...,u n } represent across-node variation in the y i,j  X  X  and  X  represents covariation of the y i,j  X  X  with the x i,j  X  X . For example, Nowicki and Snijders [2001] present a model in which each node i is assumed to belong to an unobserved latent class u i , and a probability distribution describes the relationships between each pair of classes (see Kemp et al. [2004] and Airoldi et al. [2005] for recent extensions of this approach). Such a model captures stochastic equivalence , a type of pattern often seen in network data in which the nodes can be divided into groups such that members of the same group have similar patterns of relationships.
 An alternative approach to representing across-node variation is based on the idea of homophily , in which the relationships between nodes with similar characteristics are stronger than the relationships between nodes having different characteristics. Homophily provides an explanation to data patterns often seen in social networks, such as transitivity ( X  X  friend of a friend is a friend X ), balance ( X  X he enemy of my friend is an enemy X ) and the existence of cohesive subgroups of nodes. In order to represent such patterns, Hoff et al. [2002] present a model in which the conditional mean of y i,j is a in a Euclidean space. In the context of binary relational data, such a model predicts the existence of more transitive triples, or  X  X riangles, X  than would be seen under a random allocation of edges among pairs of nodes. An important assumption of this model is that two nodes with a strong
Figure 1: Networks exhibiting homophily (left panel) and stochastic equivalence (right panel). relationship between them are also similar to each other in terms of how they relate to other nodes: A strong relationship between i and j suggests | u i  X  u j | is small, but this further implies that | u i  X  u k | X  X  u j  X  u k | , and so nodes i and j are assumed to have similar relationships to other nodes. The latent class model of Nowicki and Snijders [2001] and the latent distance model of Hoff et al. [2002] are able to identify, respectively, classes of nodes with similar roles, and the locational prop-erties of the nodes. These two items are perhaps the two primary features of interest in social network and relational data analysis. For example, discussion of these concepts makes up more than half of the 734 pages of main text in Wasserman and Faust [1994]. However, a model that can represent one feature may not be able to represent the other: Consider the two graphs in Figure 1. The graph on the left displays a large degree of transitivity, and can be well-represented by the latent distance model with a set of vectors { u 1 ,...,u n } in two-dimensional space, in which the probability of an class model would require a large number of classes, none of which would be particularly cohesive or distinguishable from the others. The second panel of Figure 1 displays a network involving three classes of stochastically equivalent nodes, two of which (say A and B ) have only across-class ties, and one ( C ) that has both within-and across-class ties. This graph is well-represented by a latent class model in which edges occur with high probability between pairs having one member in each of A and B or in B and C , and among pairs having both members in C (in models of stochastic equivalence, nodes within each class are not differentiated). In contrast, representation of this type of graph with a latent distance model would require the dimension of the latent characteristics to be on the order of the class membership sizes.
 Many real networks exhibit combinations of structural equivalence and homophily in varying de-grees. In these situations, use of either the latent class or distance model would only be representing part of the network structure. The goal of this paper is to show that a simple statistical model based on the eigenvalue decomposition can generalize the latent class and distance models: Just as any symmetric matrix can be approximated with a subset of its largest eigenvalues and corresponding eigenvectors, the variation in a sociomatrix can be represented by modeling y i,j as a function of  X  article, we show mathematically and by example how this eigenmodel can represent both stochastic equivalence and homophily in symmetric relational data, and thus is more general than the other two latent variable models.
 The next section motivates the use of latent variables models for relational data, and shows mathe-matically that the eigenmodel generalizes the latent class and distance models in the sense that it can compactly represent the same network features as these other models but not vice-versa. Section 3 compares the out-of-sample predictive performance of these three models on three different datasets: a social network of 12th graders; a relational dataset on word association counts from the first chap-ter of Genesis; and a dataset on protein-protein interactions. The first two networks exhibit latent homophily and stochastic equivalence respectively, whereas the third shows both to some degree. In support of the theoretical results of Section 2, the latent distance and class models perform well for the first and second datasets respectively, whereas the eigenmodel performs well for all three. Section 4 summarizes the results and discusses some extensions. 2.1 Justification of latent variable modeling The use of probabilistic latent variable models for the representation of relational data can be moti-vated in a natural way: For undirected data without covariate information, symmetry suggests that any probability model we consider should treat the nodes as being exchangeable, so that for any permutation  X  of the integers { 1 ,...,n } and any set of sociomatrices A . Results of Hoover [1982] and Aldous [1985, chap. 14] show that if a model satisfies the above exchangeability condi-tion for each integer n , then it can be written as a latent variable model of the form function h that is symmetric in its second and third arguments. This result is very general -it says that any statistical model for a sociomatrix in which the nodes are exchangeable can be written as a latent variable model.
 Difference choices of h lead to different models for y . A general probit model for binary network data can be put in the form of (1) as follows: where  X  and  X  are parameters to be estimated, and  X  is a symmetric function, also potentially involving parameters to be estimated. Covariation between Y and an array of predictor variables X can be represented by adding a linear predictor  X  T x i,j to  X  . Finally, integrating over i,j we independent, the conditional probability of Y given X and { u 1 ,...,u n } can be expressed as Many relational datasets have ordinal, non-binary measurements (for example, the word association data in Section 3.2). Rather than  X  X hresholding X  the data to force it to be binary, we can make use of the full information in the data with an ordered probit version of (2): where {  X  y } are parameters to be estimated for all but the lowest value y in the sample space. 2.2 Effects of nodal variation The latent variable models described in the Introduction correspond to different choices for the symmetric function  X  :
Latent class model:
Latent distance model:
Latent eigenmodel: Interpretations of the latent class and distance models were given in the Introduction. An inter-pretation of the latent eigenmodel is that each node i has a vector of unobserved characteristics u tively to the relationship between i and j , depending on whether  X  k &gt; 0 or  X  k &lt; 0 . In this way, the model can represent both positive or negative homophily in varying degrees, and stochastically equivalent nodes (nodes with the same or similar latent vectors) may or may not have strong rela-tionships with one another.
 We now show that the eigenmodel generalizes the latent class and distance models: Let S n be the set of n  X  n sociomatrices, and let In other words, C K is the set of possible values of {  X  ( u i ,u j ) , 1  X  i &lt; j  X  n } under a K -dimensional latent class model, and similarly for D K and E K .
 E
K generalizes C K : Let C  X  X  K and let There are at most K unique rows of  X  C and so  X  C is of rank K at most. Since the set E K contains all sociomatrices that can be completed as a rank-K matrix, we have C K  X  X  K . Since E K includes matrices with n unique rows, C K  X  X  K unless K  X  n in which case the two sets are equal. E
K +1 weakly generalizes D K : Let D  X  X  K . Such a (negative) distance matrix will generally be of full rank, in which case it cannot be represented exactly by an E  X  X  K for K &lt; n . However, what is critical from a modeling perspective is whether or not the order of the entries of each D can be matched by the order of the entries of an E . This is because the probit and ordered probit model we are considering include threshold variables {  X  y : y  X  X } which can be adjusted to accommodate monotone transformations of  X  ( u i ,u j ) . With this in mind, note that the matrix of squared distances among a set of K -dimensional vectors { z 1 ,...,z n } is a monotonic transformation of the distances, u is an increasing function of the negative distance d i,j . For large enough r the numerical order of the entries of this E  X  X  K +1 is the same as that of D  X  X  K .
 D
K does not weakly generalize E 1 : Consider E  X  X  1 generated by  X  = 1 , u 1 = 1 and u i = ordering of the elements of D  X  X  K possible? If K = 1 then such an ordering is possible only if n = 3 . For K = 2 such an ordering is possible for n  X  6 . This is because the kissing number in R , or the number of non-overlapping spheres of unit radius that can simultaneously touch a central sphere of unit radius, is 6. If we put node 1 at the center of the central sphere, and 6 nodes at the between those remaining, leaving one central sphere plus five kissing spheres for a total of n = 6 . Increasing n increases the necessary dimension of the Euclidean space, and so for any K there are n and E  X  X  1 that have entry orderings that cannot be matched by those of any D  X  X  K . A less general positive semi-definite version of the eigenmodel has been studied by Hoff [2005], in which  X  was taken to be the identity matrix. Such a model can weakly generalize a distance model, but cannot generalize a latent class model, as the eigenvalues of a latent class model could be negative. 3.1 Parameter estimation Bayesian parameter estimation for the three models under consideration can be achieved via Markov chain Monte Carlo (MCMC) algorithms, in which posterior distributions for the unknown quantities are approximated with empirical distributions of samples from a Markov chain. For these algo-rithms, it is useful to formulate the probit models described in Section 2.1 in terms of an additional conjugate prior distributions where possible, the MCMC algorithms proceed by generating a new To facilitate comparison across models, we used prior distributions in which the level of prior vari-ment these algorithms are available at my website). 3.2 Cross validation To compare the performance of these three different models we evaluated their out-of-sample pre-dictive performance under a range of dimensions ( K  X  X  3 , 5 , 10 } ) and on three different datasets exhibiting varying combinations of homophily and stochastic equivalence. For each combination of dataset, dimension and model we performed a five-fold cross validation experiment as follows: This procedure generates a sociomatrix  X  Y , in which each entry  X  y i,j represents a predicted value obtained from using a subset of the data that does not include y i,j . Thus  X  Y is a sociomatrix of out-of-sample predictions of the observed data Y . 3.3 Adolescent Health social network The first dataset records friendship ties among 247 12th-graders, obtained from the National Longi-tudinal Study of Adolescent Health ( www.cpc.unc.edu/projects/addhealth ). For these data, y i,j = 1 or 0 depending on whether or not there is a close friendship tie between student i and j (as reported by either i or j ). These data are represented as an undirected graph in the first panel of Figure 2. Like many social networks, these data exhibit a good deal of transitivity. It is therefore not surprising that the best performing models considered (in terms of area under the ROC curve, given in Table 1) are the distance models, with the eigenmodels close behind. In contrast, the latent class models perform poorly, and the results suggest that increasing K for this model would not improve its performance. 3.4 Word neighbors in Genesis The second dataset we consider is derived from word and punctuation counts in the first chapter of the King James version of Genesis ( www.gutenberg.org/dirs/etext05/bib0110.txt ).
 There are 158 unique words and punctuation marks in this chapter, and for our example we take y i,j to be the number of times that word i and word j appear next to each other (a model extension, appropriate for an asymmetric version of this dataset, is discussed in the next section). These data can be viewed as a graph with weighted edges, the unweighted version of which is shown in the first panel of Figure 3. The lack of a clear spatial representation of these data is not unexpected, as text data such as these do not have groups of words with strong within-group connections, nor do they display much homophily: a given noun may appear quite frequently next to two different verbs, but these verbs will not appear next to each other. A better description of these data might be that there are classes of words, and connections occur between words of different classes. The cross validation results support this claim, in that the latent class model performs much better than the distance model on these data, as seen in the second panel of Figure 3 and in Table 1. As discussed in the previous section, the eigenmodel generalizes the latent class model and performs equally well. We note that parameter estimates for these data were obtained using the ordered probit versions of the models (as the data are not binary), but the out-of-sample predictive performance was evaluated based on each model X  X  ability to predict a non-zero relationship. 3.5 Protein-protein interaction data Our last example is the protein-protein interaction data of Butland et al. [2005], in which y i,j = 1 if proteins i and j bind and y i,j = 0 otherwise. We analyze the large connected component of this graph, which includes 230 proteins and is displayed in the first panel of 4. This graph indicates patterns of both stochastic equivalence and homophily: Some nodes could be described as  X  X ubs X , connecting to many other nodes which in turn do not connect to each other. Such structure is better represented by a latent class model than a distance model. However, most nodes connecting to hubs generally connect to only one hub, which is a feature that is hard to represent with a small number of latent classes. To represent this structure well, we would need two latent classes per hub, one for the hub itself and one for the nodes connecting to the hub. Furthermore, the core of the network (the nodes with more than two connections) displays a good degree of homophily in the form of transitive triads, a feature which is easiest to represent with a distance model. The eigenmodel is able to capture both of these data features and performs better than the other two models in terms of out-of-sample predictive performance. In fact, the K = 3 eigenmodel performs better than the other two models for any value of K considered. Latent distance and latent class models provide concise, easily interpreted descriptions of social networks and relational data. However, neither of these models will provide a complete picture of relational data that exhibit degrees of both homophily and stochastic equivalence. In contrast, we have shown that a latent eigenmodel is able to represent datasets with either or both of these data patterns. This is due to the fact that the eigenmodel provides an unrestricted low-rank approximation to the sociomatrix, and is therefore able to represent a wide array of patterns in the data. The concept behind the eigenmodel is the familiar eigenvalue decomposition of a symmetric ma-trix. The analogue for directed networks or rectangular matrix data would be a model based on the singular value decomposition, in which data y i,j could be modeled as depending on u T i Dv j , where u and v j represent vectors of latent row and column effects respectively. Statistical inference using the singular value decomposition for Gaussian data is straightforward. A model-based version of the approach for binary and other non-Gaussian relational datasets could be implemented using the ordered probit model discussed in this paper.
 Acknowledgment This work was partially funded by NSF grant number 0631531.
 Edoardo Airoldi, David Blei, Eric Xing, and Stephen Fienberg. A latent mixed membership model for relational data. In LinkKDD  X 05: Proceedings of the 3rd international workshop on Link discovery , pages 82 X 89, New York, NY, USA, 2005. ACM Press. ISBN 1-59593-215-1. doi: http://doi.acm.org/10.1145/1134271.1134283.
 XIII X 1983 , volume 1117 of Lecture Notes in Math. , pages 1 X 198. Springer, Berlin, 1985. G. Butland, J. M. Peregrin-Alvarez, J. Li, W. Yang, X. Yang, V. Canadien, A. Starostine, D. Richards,
B. Beattie, N. Krogan, M. Davey, J. Parkinson, J. Greenblatt, and A. Emili. Interaction network containing conserved and essential protein complexes in escherichia coli. Nature , 433:531 X 537, 2005.
 Peter D. Hoff. Bilinear mixed-effects models for dyadic data. J. Amer. Statist. Assoc. , 100(469): 286 X 295, 2005. ISSN 0162-1459.
 Peter D. Hoff, Adrian E. Raftery, and Mark S. Handcock. Latent space approaches to social network analysis. J. Amer. Statist. Assoc. , 97(460):1090 X 1098, 2002. ISSN 0162-1459.
 D. N. Hoover. Row-column exchangeability and a generalized model for probability. In Exchange-ability in probability and statistics (Rome, 1981) , pages 281 X 291. North-Holland, Amsterdam, 1982.
 Charles Kemp, Thomas L. Griffiths, and Joshua B. Tenenbaum. Discovering latent classes in rela-tional data. AI Memo 2004-019, Massachusetts Institute of Technology, 2004.
 Krzysztof Nowicki and Tom A. B. Snijders. Estimation and prediction for stochastic blockstructures. J. Amer. Statist. Assoc. , 96(455):1077 X 1087, 2001. ISSN 0162-1459.
 Stanley Wasserman and Katherine Faust. Social Network Analysis: Methods and Applications .
Cambridge University Press, Cambridge, 1994.
