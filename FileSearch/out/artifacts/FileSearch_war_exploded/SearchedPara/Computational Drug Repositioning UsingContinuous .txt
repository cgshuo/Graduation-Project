 Computational Drug Repositioning (CDR) is the task of discovering potential new indications for existing drugs by mining large-scale heterogeneous drug-related data sources. Leveraging the patient-level temporal ordering information between numeric physiological measurements and various drug prescriptions provided in Electronic Health Records (EHRs), we propose a Continuous Self-controlled Case Se-ries (CSCCS) model for CDR. As an initial evaluation, we look for drugs that can control Fasting Blood Glucose (FBG) level in our experiments. Applying CSCCS to the Marshfield Clinic EHR, well-known drugs that are indicated for control-ling blood glucose level are rediscovered. Furthermore, some drugs with recent literature support for the potential effect of blood glucose level control are also identified.  X  Mathematics of computing  X  Regression analysis;  X  Applied computing  X  Health care information sys-tems; Health informatics; Longitudinal Data; Self-Controlled Case Series; Computa-tional Drug Repositioning
Drug repositioning is the task of identifying new potential indications for existing drugs. This task has been steadily rising to prominence because the traditional process of de novo drug discovery can be slow, expensive, and risky [1]. Moreover, with the advent of the big data era, abundant data sources that collect rich drug-related information are emerging. Mining large-scale heterogeneous drug-related data sources, Computational Drug Repositioning (CDR) has become an active research area that has the potential to de-liver more effective drug repositioning. There have been sev-eral comprehensive reviews in the literature on CDR [2, 3]. Many methods leverage genotypic and transcriptomic infor-mation [4, 5], as well as drug molecular structure and drug combination information [6, 7]. A prior study that used Electronic Health Records (EHRs) to validate a potential indication of one existing drug has also been reported [8].
We are interested in mining EHRs in order to identify a potential indication from multiple existing drugs simultane-ously. As an initial attempt, we examine the numeric values of Fasting Blood Glucose (FBG) level recorded in patients X  EHRs before and after some drugs are prescribed to those patients, in the hope of identifying previously unknown po-tential uses of drugs to control blood glucose level.
For this purpose, we extend the Self-Controlled Case Se-ries (SCCS) [9] model that has been widely used in the Adverse Drug Reactions (ADRs) discovery community to handle continuous numeric response, hence the name of our model, Continuous Self-Controlled Case Series (CSCCS).
The cornerstone of a self-controlled method is an under-standing of how drug prescription history will potentially influence the FBG level every time such a measurement is taken. For example, an antibiotic drug taken ten years ago might have less, if any, influence on the FBG level than an anti-diabetic drug taken a day before that FBG level is measured. To determine how long a drug can potentially influence a patient, we furthermore propose a data-driven approach that leverages change point detection [10], result-ing in estimations of different time spans of influence for different drugs.

Our contributions are three-fold:  X  To the best of our knowledge, this is the first translation of SCCS methodology from ADR discovery to CDR. Our work is a pilot study evaluating the use of temporal order-ing information between numeric physical measurements and drug prescriptions available in EHRs for the knowl-edge discovery process of CDR.  X  Based on the insightful observations of [11], we derive our
CSCCS model from a fixed effect model and hence extend the original SCCS model to address continuous numeric response variables.  X  We introduce to the CDR and ADR discovery commu-nity a data-driven approach for adaptively determining the time spans of influence of different drugs to the pa-tients.
Figure 1 visualizes an example of health records for two patients. To confine the time span of a drug that has po-tential influence on that patient, we use the concept of drug era , which is recorded with its start date, end date and the name (or id) of the drug. We consider a patient to be un-der consistent influence of a drug during a drug era of that drug. However, drug era information is not readily available in most EHRs. Instead, drug prescription information with the name of a drug and the start date of the prescription is usually provided in observational data. How to construct drug eras from prescription records is a challenging and sig-nificant task for both CDR and ADR discovery [12, 13]. We provide a data-driven approach to this task in Section 4.
Measurements of FBG level might also be taken from time to time and are recorded with the date taken, as well as their numeric measurement values. We assume that at most one FBG measurement is taken for a particular patient on a particular day.

Let there be N patients with FBG measurements and M different drugs in the EHR. We construct a cohort using all the FBG measurement records as well as all the drug era records from all the N patients. Furthermore, we use a continuous random variable y ij , where i  X  { 1 , 2 ,  X  X  X  ,N } , j  X  X  1 , 2 ,  X  X  X  ,J i } , to denote the value of the j th surement taken among a total number of J i measurements during the observation period of the i th person. Similarly, we use a binary variable x ijm , i  X  X  1 , 2 ,  X  X  X  ,N } , j  X  X  1 , 2 ,  X  X  X  ,J m  X  X  1 , 2 ,  X  X  X  ,M } to denote the exposure status of the m drug of the i th person at the date when the j th FBG mea-surement is taken, with 1 representing exposure and 0 oth-erwise.
We treat the y ij  X  X  as the response variables and first con-sider the following linear regression model: where  X  , which is called the nuisance parameter , represents the in-dividual effect of the i th person on the value of y ij , invariant to day j , drug m , and other patients, and ij  X  X  are indepen-dent and identically distributed Gaussian noises with zero mean and fixed but unknown variance  X  2 .

The parameter of interest in this problem is  X  , which rep-resents the effect of each of the M drugs on the response y when a patient is under the joint exposure statuses specified by x ij . More specifically, suppose the m th component of  X  ,  X  m , is evaluated to a negative number, that is to say, expo-sure to the m th drug will cause the FBG level to decrease. If this drug is not known to be prescribed for lowering FBG, such a decrease is an indicator that this drug might have the potential to be repositioned to help diabetic patients control their blood glucose level, given further investigation.
In this setting, fitting a linear regression model is equiva-lent to solving the following least squares problem: where where Z is a block diagonal matrix with 1 i being a J i  X  1 vector where all the components are 1. The least squares problem in (2) is a linear fixed effect model with  X  being a nonrandom quantity whose i th component  X  i , can be in-terpreted as the average FBG measurement level of the i th patient taken over time without exposing to any drugs.
Like the SCCS model, the motivation behind the CSCCS model is to use only  X  as a parsimonious parameterization to predict the response vector y . Inspired by the work in [11], where the equivalence between the Poisson fixed effect model and the SCCS model is established, we are able to derive the CSCCS model from the linear fixed effect model in (2) in a similar fashion. Let We consider,  X  X  (  X  ,  X  ) where  X  y is an N  X  1 vector with the i th component,  X  y
P J i j =1 y ij , and  X  X is an N  X  M matrix with the i th  X  X CSCCS model: The model in (4) is in the desired form of parsimonious parameterization in that the optimization problem is defined only in the space of  X  , and the nuisance parameter  X  is eliminated.

The CSCCS model is a linear model and hence CSCCS is able to predict continuous response y . The model is self-controlled in that each FBG measurement and their corre-sponding drug exposure statuses are adjusted by their mean within each individual. The model also utilizes case series in that only cases (patients that have at least one FBG mea-surement) are admitted in the cohort.

CSCCS is derived from its linear fixed effect model coun-terpart. This derivation shares the same spirit with the equivalence between the original SCCS and the Poisson fixed effect model; in this sense, CSCCS extends SCCS to address numeric response in the new setting.

Although both models in (2) and (4) can be considered as linear models, from the perspective of implementation efficiency, the explicit form of CSCCS in (4) is of vital im-portance for the task of CDR using large-scale EHRs. This is because the parameter of interest in our task is  X  and the nuisance parameters do not provide direct information in evaluating the impact of a drug in changing FBG level. In the setting of large-scale EHRs, where tens of thousands of patient records might be admitted into the cohort as cases, the dimension of the nuisance parameter can potentially be very high. In this scenario, without the access to a special purpose solver for the fixed effect model, solving a model in the form of (2) using only a general purpose linear model solver can be time consuming or even infeasible. On the contrary, using the explicit form of CSCCS in (4), a gen-eral purpose linear model solver only needs to find solutions in the space of  X  , a parameter whose dimension is only as large as the number of drugs available in the cohort, which is a much smaller number than the dimension of nuisance parameters.
Several challenges arise when we apply CSCCS to EHR data. In this section, we present the further refinements we perform on the CSCCS model presented in (4) in order to address these challenges. EHR data is a type of high-dimensional longitudinal data. While tens of thousands of patient records might be admit-ted into the cohort, effects of thousands of drugs on the FBG level need to be evaluated simultaneously, introducing a high-dimensional problem. This motivates us to incorpo-rate sparsity into our model using the penalty [14], where  X  &gt; 0 is a tuning parameter determining the level of sparsity.

The incorporation of this penalty essentially assumes that only a small portion of drugs are related to the change of FBG level, and the rest of them do not have significant effect on changing FBG level when patients are exposed to those drugs. With the L 1 penalization, most components of  X  will be evaluated to zero or a number that is close to zero. The result is, instead of evaluating the effect of each of the M drugs on FBG level, L 1 penalized CSCCS only selects a sub-set of drugs that, in some sense, are most correlated to the change of FBG level, and estimates their relative strength and direction of change among the drugs chosen.
The linear fixed effect model assumes that all responses are independent of each other. The meaning of independence is two-fold. On one hand, responses from different patients are independent of each other. To explain differences across patients (e.g. some patients tend to have higher FBG lev-els than others in general),  X  is used with each component representing the time-invariant effect of each patient on the response. On the other hand, responses observed at different time are independent of each other. To explain differences across time (e.g. FBG levels observed in early age might be lower than those in old age), a time-dependent variable that has the same value across all patients can be introduced. That is to say: where t j is the time-dependent nuisance parameter whose value depends only on the time when the j th measurement is taken. If observations are recorded regularly across time, (6) defines a two-way fixed effect model , as opposed to the one-way fixed effect model defined in (2) [15].

In practice, a one-way model might be preferred over a two-way model if we assume that the heterogeneity across different individuals is much more significant than that across time. However, in the task of CDR from EHRs, this assump-tion might be too restrictive. To begin with, EHRs usually contain observational data of patients that are recorded over decades. Therefore, it is probable that the baseline FBG levels of patients change significantly over the years. This is especially true when some persistent FBG level altering events, such as the diagnosis of diabetes, occur to some pa-tients. Furthermore, the length of observation periods varies dramatically among patients. Therefore, we do not have a fully observed and consistent dataset to model the set of time-dependent nuisance parameters. Last but not least, the incorporation of time-dependent nuisance parameters is pro-posed in a setting where data are collected regularly. With the irregular nature of EHR data, modeling time-dependent nuisance parameters directly with a classic two-way fixed effect model is impractical.

To address the aforementioned challenges without much loss in efficiency, we consider a reasonable assumption: given y ij and y ij 0 , where j 6 = j 0 , but the dates of the two measure-ments taken are very close to each other, we assume the two corresponding time-dependent nuisance parameters are equal to each other, i.e. t j = t j 0 . More specifically, where d ij and d ij 0 represent that the j th and j 0 th measure-ments of the i th patient are taken at the d th ij day and d of the observation period, and  X  is a predetermined thresh-old. Then, where the nuisance parameters are eliminated. Therefore, the quantity in (7) depends only on  X  and the data.
Based on this formulation, we can reconstruct the CSCCS model to address irregular time dependency as follow: firstly, given  X  , construct a cohort where only patients with at least a pair of FBG measurements taken within  X  days are ad-mitted; only adjacent pairs are used. Secondly, solve the following lasso problem: where D , when multiplied with y or X , generates the differ-ence between the measurement of an earlier record and the corresponding measurement of its adjacent later-measured record of the same patient, with the constraint that the two records are collected within a time span of  X  days.
Note that the model in (8) is not equivalent to the model in (5). However, the model in (8) can still be considered as a variant of CSCCS in that its parameterization is still restricted to  X  , with the goal of predicting a continuous response, using data subtraction within the same patient as a self-controlled mechanism, and only admitting cases into the cohort. We call the the model in (8) as CSCCS for Adjacent response, or CSCCSA.
Another challenge an algorithm must tackle is the con-founding issue arises due to the complex nature of clinical observational data. In the setting of EHRs, one important confounding issue is called confounding by co-medication . Consider drug A and drug B, where only drug A can lower FBG level and drug B has no significant effect on changing blood sugar. However, drug B is usually prescribed with drug A. In this case, drug B can be a confounder if we only evaluate the marginal correlation between each drug and FBG level. Another confounding issue in this setting is confounding by comorbidity . Consider the FBG-lowering drug A given to a diabetic patient. Following the prescrip-tion of drug A, some other conditions could occur to this patient since diabetes can lead to various comorbidities [16]. To treat a newly introduced condition, drug B is prescribed to the patient. In this case, if we again consider only the marginal correlation between drug B and FBG level, one might draw the conclusion that drug B could lower FBG level since after the prescription of drug A, the FBG level has decreased.

In the two aforementioned confounding issues, drug B is called an innocent bystander . Like multiple SCCS [9], mul-tiple CSCCS can effectively handle the innocent bystander confounding problem (a.k.a. Simpson X  X  Paradox). This is because the confounder seems to spuriously correlated to the FBG level when we consider their marginal correlation. However, using a multiple linear model like CSCCS, the joint exposure statuses of both drug A and drug B can be con-sidered simultaneously. Therefore, CSCCS might be able to identify that the decrease of FBG level occurs only when conditioning on the exposure of drug A and hence rule out drug B in the model.

In terms of addressing various confounding issues, CSCCS inherits most of the strengths and weaknesses from SCCS, due to the close relationship between the two models. While CSCCS might address reasonably well the innocent bystander confounding problem, it might not be well suited to handle confounding issues such as time-varying confounding [17]. In Section 5, we empirically evaluate the performance of CSCCS in the CDR task and illustrate how its performance is related to its capabilities of addressing various confound-ing issues.
A prerequisite of CSCCS is the availability of drug era in-formation of each drug prescribed to each patient. However, Figure 2: Time gap of Humalog in ascending order: the size of dots represents the number of time gaps that share the same value drug era information is usually not provided in most EHRs. Instead, drug prescription records of each patient are kept, usually with the name (or id) of the drug and the date of prescription. Constructing drug eras from drug prescription records is an important but challenging task for both CDR using CSCCS and ADR discovery.
A heuristic proposed in the Common Data Model (CDM) [18] by Observational Medical Outcome Partnership (OMOP) is to first consider the prescription dates of each prescription record as the start date of the drug era. It then assumes that each drug era lasts n days and hence computes the end date of the drug era accordingly. Within the same patient, we as-sume there is only one drug prescription record of the same drug in a given date. In this way, drug eras of the same drug within each patient constructed as before start from differ-ent dates. For an adjacent pair of drug eras of the same drug within the same patient, we call the drug era that starts ear-lier a former era , and the other a latter era . CDM defines a parameter called persistence window . If the start date of the latter era, subtracted by the end date of the former era, is no larger than the persistence window, CDM merges the two drug eras into one, using the start date of the former era as the start date of the new era and the end date of the latter era as the end date of the new era. CDM tries to merge as many drug eras of the same drug within the same patient as possible in this fashion, until every resultant drug era of the same drug within the same patient is separated by more than persistence window amount of time. In CDM, both n and the persistence window are usually set to thirty days.
The intuition behind this heuristic is to build a longer drug era if the prescription date of an adjacent pair of records of the same drug are close enough to each other. A natural question to ask is how large the time gap between the two adjacent prescription records can be for us to still consider them close enough?
Instead of specifying a predetermined threshold on time gap as it is in CDM, we answer this question via a data-driven approach: for each drug, we compute the time gaps between all adjacent pairs of prescription records. We then sort these time gaps in ascending order. A visualization of Figure 3: Change points of all drugs in the EHRs in ascend-ing order the values of the time gaps of Humalog against their rela-tive rankings is given in Figure 2. From Figure 2, we notice that the distribution of time gaps can be approximated by a piecewise linear model with a change point close to the end of the sample with large time gap values. The smaller time gaps can be fitted well by the flat linear segment of the model while the larger time gaps can be fitted well by the steep linear segment. This phenomenon leads to a reason-able assumption that the smaller time gaps are sampling from a different underlying distribution than that of the larger time gaps. The smaller time gaps sampling from the same distribution correspond to the adjacent pairs of pre-scription records that we can consider close enough to each other to construct a lasting drug era. A threshold we can use to distinguish the two types of time gaps is the change point of the piecewise linear model.

For each drug with at least fifty prescription records in the EHRs, we perform change point detection analysis in the aforementioned fashion using R package segmented . We plot the change points of all the drugs against their relative rankings after sorting them in ascending order in Figure 3. Interestingly, there is also a change point in Figure 3. A possible explanation of the existence of a change point in Figure 3 is that in EHR data, drug prescriptions of some particular drugs are recurrent in order to battle chronic dis-ease. For example, a diabetic patient needs long-term pre-scriptions of some FBG lowering drugs. On the other hand, the prescriptions of some other drugs are non-recurrent, such as antibiotics. We consider the change point in Figure 3 as a threshold to distinguish recurrent drugs from non-recurrent drugs in the EHR because a reasonable expectation is that if a drug is recurrent, the gap between an adjacent pair of prescription records of that drug from the same patient will tend not to be too large and hopefully under the change point specified in Figure 3.

We extend the heuristic provided in CDM as follow: We first denote the mean of all change point values of the recur-rent drugs in the EHR as  X  . For all the recurrent drugs, we set their corresponding n  X  X  and the value of their persistence windows to  X  2 . We then set n = 0 . 04year (approximately two weeks) for all non-recurrent drugs and 0 as the value of their persistence windows.
As far as we know, our CSCCS model is the first of its kind to explicitly use temporal ordering information in EHRs for CDR. How do we evaluate the performance of a method that utilizes this type of information? As a preliminary en-deavor, we try to answer this question by addressing two major challenges for our experiments.
The first challenge we need to handle is the lack of a base-line method that also utilizes temporal ordering informa-tion in an EHR for CDR. Inspired by the idea of dispropor-tionality analysis from the pharmacovigilance literature [19], we propose the Pairwise Mean (PM) method as a baseline method. PM assigns a real-valued score to each of the M drugs in the EHR to represent how likely the drug decreases FBG level, and a smaller score implies a stronger decreasing tendency. The score of the m th drug, s m , is computed as follow: first, for the i th patient who has FBG measurements within two years before and after the first prescription of the m th drug, we compute the mean of those FBG measure-ments before and after the first prescription, denoted as b and a mi , respectively; second, compute s m as: where N m is the number of patients that have FBG mea-surements two years before and after the first prescription of the m th drug.
Unlike the task of ADR discovery from the EHR, where numerous research efforts have been invested on develop-ing a set of ground truth [20] drug-adverse-reaction pairs so that algorithms can be run and evaluated, we do not have access to such a ground truth set for the task of CDR from EHRs. We use Marshfield Clinic EHR as our data source and there are about two thousand drugs for evaluation. To evaluate the performance of our algorithm without knowing the glucose altering effect of every drug, we focus on the top forty most promising drugs generated by PM, CSCCS, and CSCCSA, as shown in Table 2, Table 3, and Table 4, respectively.

In these three tables, rows that are shaded in green rep-resent the drugs commonly prescribed for lowering glucose while rows that are shaded in red represent the drugs com-monly prescribed for increasing glucose. The two types of drugs in the three tables are all manually labeled. Drugs in the unshaded rows might potentially be irrelevant, or might constitute new discoveries. These drugs are discussed in fur-ther detail in Section 5.7. A summary of the number of each of the three types of drugs discovered by the three algorithms are given in Table 1.
 In CSCCSA, we set  X  defined in Section 3.2 to four years. In Table 2, the counts and scores are N m  X  X  and s m  X  X  defined in Section 5.1, while in Table 3 and Table 4, the counts are the L 1 norm of the columns in X corresponding to different drugs, and the scores are the regression coefficients of differ-ent drugs. We only consider drugs with counts greater than or equal to eight. For CSCCS and CSCCSA, we first con-struct drug eras using the method described in Section 4, where we determine that  X  = 0 . 34 years. We then use a lasso penalty for variable selection to generate a long list of about two hundred drugs, and we present the top forty among those selected drugs as the short list. The num-ber eight and forty could be tuned to optimize accuracy but were fixed here beforehand for practical reasons. Drugs with fewer than eight prescriptions might not have sufficient ev-idence to support a new use. Evaluating more than forty results per method was too large a burden for human liter-ature review.
 Table 1: A summary of three types of drugs discovered by the three algorithms
EHRs of 64515 patients from Marshfield Clinic are used in the CSCCS and CSCCSA experiments, providing 219306 FBG measurement records and 2980 drug candidates.
As shown in Tables 2 X 4, all three methods capture a rea-sonable number of drugs that are prescribed for lowering glucose among their top forty candidates. We therefore con-sider identifying drugs prescribed for glucose-lowering as a binary classification task and use Receiver Operating Char-acteristics (ROC) curves as well as Area Under ROC (AU-ROC) to evaluate the performance of each algorithm.
We first construct the ROC curves of the three methods using the union list of drugs from Tables 2 X 4. The three ROC curves are presented in Figure 4(a). Since we per-form variable selection in CSCCS and CSCCSA, some drugs might be assigned scores of zero and hence are considered irrelevant to the prediction of FBG level. In these cases, we put these drugs at the bottom of the union list and consider them to be identified as positive examples by the algorithms only at the very end. This results in the straight line segment of the ROC curves of CSCCS and CSCCSA at the liberal region. Figure 4(a) shows that CSCCSA has the highest AUC, outperforming CSCCS and PM by a significant mar-gin, while PM and CSCCS have similar AUCs. However, in the more conservative region where there is drug support for all three methods, CSCCS outperforms PM while CSCCSA maintains the best performance. This phenomenon suggests that the modeling assumptions of CSCCS and CSCCSA are able to provide insights into making reasonable prediction of FBG level.

Figure 4(b) uses the forty drugs in Tables 2 and 3 to gen-erate the ROC curves, in red for PM and in blue for CSCCS. As a comparison, we also plot the ROC curve of the following ensemble strategy: we first use the top forty drugs in Table 3 as a result of variable selection via CSCCS, then we com-pute the PM scores over the selected drugs. By comparing the AUCs of the three curves, we notice that the ensemble method outperforms CSCCS and PM, while CSCCS outper-forms PM. Since the scores used to construct the CSCCS ROC curve are regression coefficients of drug exposure sta-tuses under a lasso penalty, the lack of an oracle property for the lasso [21] might potentially trade off the inherent order among drugs for a sparse model. However, such a trade-off is arguably beneficial, based on the significant improvement of AUC of CSCCS compared with the AUC of PM.

Figure 4(c) is generated similarly as Figure 4(b). The en-semble of CSCCSA with PM outperforms the two individual algorithms. Although the AUC of CSCCSA is less than that of CSCCS, it is worthy to notice that all but one true pos-itive drugs in Table 3 are discovered in Table 4 at the top fifteen positions. Other than that, CSCCSA is also able to discover twelve more true positives that CSCCS does not capture among its top forty discoveries.
The task of CDR from EHRs is somewhat analogous to web search. Specifically, the algorithm should select only a few drugs that have interesting unexpected effects on the response: returning too many results makes it infeasible for human experts to evaluate the potential effect of the selected drugs. This is similar to users performing web search on a search engine, where typically only the quality of the results on the first page, or the first K results, matters. Based on this observation, an algorithm with a high precision-at-K value is desirable. Figure 5 shows the precision of each of the three algorithms at different positions (K) in the task of identifying drugs prescribed for lowering glucose. CSCCSA achieves the highest performance at all positions. CSCCS outperforms PM significantly at smaller K X  X , but the perfor-mances of the two algorithms are similar at larger K X  X . This is consistent with results in Table 1, showing that CSCCSA is able to identify more prescribed drugs for lowering glucose than the other two methods. Moreover, these drugs are at the very top of Table 4. Therefore, precision-at-K provides evidence for CSCCSA X  X  utility for CDR from EHRs.
Figure 5: Precision at K of PM, CSCCS, and CSCCSA
From Tables 2 X 4, we notice that CSCCSA discovers the most number of drugs prescribed for lowering glucose among the three methods under consideration. This reaffirms our belief that CSCCSA is a promising method for CDR from EHR. Furthermore, we also notice that drugs prescribed for increasing glucose are reported in all but the table of CSCCSA.
 In Table 2, sucrose is observed as a false positive using PM. Based on its count, this might be a spurious correlation in the data. This is even more probable when we consider the fact that the effect of sucrose on blood glucose level is short-term, and sucrose is not a drug that consistently enter patients X  EHR for a long period of time. However, PM considers the glucose measurement records of the patients within two years before and after the first prescription of sucrose, during which many stronger confounding factors could have occurred to alter the glucose level.

In Table 3, glucagon is identified. Glucagon is given to diabetic patients that take glucose-lowering drugs to avoid hypoglycemia. However, glucagon alone is not frequently administered. Therefore, in the data, we observe the co-occurrence of glucagon with various glucose-lowering drugs. While glucagon alone increase blood glucose, combining with glucose-lowering drugs usually results in the decrease of blood sugar. On the other hand, we did not have enough data where glucagon is prescribed alone to observe the responses. Therefore, the algorithm will consider glucagon to have glucose-lowering effects since most of the time the occurrence of glucagon is accompanied by blood sugar decreasing medi-cations. The algorithm might even consider it as a strong glucose-lowering drug because the actual glucose-lowering drugs are coded in various names in the EHR, hence dis-persing the effect, while glucagon is coded only by a few different names.
We now turn to the discussion of the drugs discovered by the three algorithms in Table 2 X 4 that are not prescribed for glucose increasing/decreasing. We will make use of a list providing drugs that can influence blood glucose level available in [22] to aid our evaluation process.
According to [22], in Table 2, Actigall can cause blood glu-cose level to increase while amphotericin B can cause blood glucose level to decrease. An interesting drug that is also brought to our attention is buderprion SR. Buderprion SR is an antidepressant prescribed for the treatment of depressive disorder. For diabetic patients with depression, buderprion SR can help to alleviate their depressive symptom, making them in a better mood. This in turn has a positive effect on better controlling blood glucose level for longer period of time [23]. PM is able to discover the blood glucose low-ering effect of buderprion SR, even with a mere support of nine patients. The fact that PM considers the marginal cor-relation of each drug-indication pair independently makes it more likely to discover interesting drug-indication pairs with a weaker support. However, spurious correlations, es-pecially those caused by the innocent bystander problem, are also more likely to be reported this way.

Comparing the results from Table 2 with those from Ta-ble 3 and Table 4 could justify our argument. In Table 2, Habitrol is a nicotine patch, and Monistat, Voriconazole, amphotericin B, and Hibiclens are all used to treat fungal infection. Interestingly, fungal infection is a comorbidity of diabetes [24, 25], and smokers are also more inclined to be diabetic [26]. On the other hand, we cannot find any drugs that are related to fungal infection or quitting smoke in Table 3 and Table 4. This comparison suggests that the aforementioned drugs in Table 2 generated by marginal as-sociation methods like PM might be innocent bystanders while a multiple regression approach such as CSCCS and CSCCSA might significantly help to alleviate this type of confounding issue.
In Table 3, a study [27] indicates that enalapril helps to decrease the occurrence rate of diabetes in patients with chronic heart failure. Tricor might also have the potential to lower blood sugar level, based on the findings in [28] and [29]. Vitamin B12 is another interesting drug for consider-ation. In a rat model used by [30], deficiency in vitamin B12 is linked to hyperglycemia. However, blood glucose level can be decreased by providing vitamin B12. A re-cent study suggests that diabetic patients under metformin might experience vitamin B12 deficiency [31]. In a study on depressive patients, Zoloft, which is an antidepressant, is linked to the increase of insulin level after its prescrip-tion [32]. Zestril, which is the brand name of lisinopril, is found to inhibit high blood sugar level in rats [29]. Capto-pril is also reported to improve daily glucose profile among non-insulin-dependent patients [33]. However, hydralazine HCl is linked to glucose-increasing in a rat model, accord-ing to the findings in [34]. Nifedipine, verapamil HCl, and morphine sulfate can decrease blood sugar while captopril interacting with hydrochlorothiazide could cause high blood sugar, according to the list in [22]. The potential glucose-lowering drugs discovered indicate that CSCCS is a reason-able method for the task of CDR.

In Table 4, Pravachol is a member of a popular class of drugs called statins which are prescribed to lower cholesterol level. Although the Food and Drug Administration (FDA) has added blood-glucose-increase warnings to all the drugs in the statin class [35], Pravachol itself has been considered to have blood-glucose lowering effects [36, 37]. The fact that CSCCSA can single out this particular drug from other statin class drug members indicates the potential of the al-gorithm to distinguish among similar drugs that have subtle differences. Celexa has a mild but non-significant effect on FBG level reduction in a study with seventeen depressive patients [38]. Several cases of hypoglycemia linked to the use of Neurontin have also been reported [39]. Thiamine is reported to reduce the adverse effect of hyperglycemia by inhibiting certain biological pathways [40] and deficiency of thiamine is observed in diabetic patients [41]. Cardura is found to reduce insulin resilience in a study on hyperten-sive patients with diabetes [42]. According to [22], Prozac can cause both high or lower blood sugar while diltiazem is linked to low blood glucose level.
To demonstrate the potential of our methodology, we also apply our method to predict the numeric value of low-density lipoprotein (LDL). We first construct drug eras from drug prescription records with the approach proposed in Section 4, where  X  is computed as 0 . 36 years. We then run CSCCSA and generate a long list of about two hundred drugs. We report the top forty drugs from the list in Table 5. No con-firmed false positives are discovered in the table while all the confirmed true positives are reported at the very top of the list. Some entries of hormone are discovered, which are linked to the decrease of LDL in drug/laboratory tests [43]. Interestingly, many entries of antibiotics are discovered, and all of them are classified as non-recurrent drugs by the algo-rithm in Section 4. This is consistent with the clinical prac-tice that antibiotics are usually not prescribed for long-term use. Some antibiotics have also been considered to manage cholesterol level, with literature support dating back to the 1950 X  X  [44, 45, 46]. The experimental results on LDL sug-gest that our algorithm is not fine-tuned to boost the perfor-mance on discovering drugs that control FBG level. Instead, it is readily applicable to other important numeric clinical measurements that might lead to interesting discoveries in drug repositioning. We have introduced the CSCCS model for the task of CDR using EHRs. To our best knowledge, the proposed model is the first of its kind to extensively leverage tempo-ral ordering information from EHR to predict indications for multiple drugs at the same time. The CSCCS model extends the SCCS model that is popular in the ADR community to address a continuous response. As an initial effort, we eval-uate our methodology on the task of discovering potential blood-sugar-lowering indications for a variety of drugs in a real world EHR. We develop a set of experimental evalua-tion methods specific to this problem in order to estimate the performance of our method. Our experimental results suggest that CSCCS can not only discover existing indica-tions but is also able to identify potentially new use of drugs. We hence believe that CSCCS is a promising model to aid the knowledge discovery process in CDR.

Future applications and extensions of the CSCCS model are exciting. To begin with, CSCCS can be applied to a broad variety of numeric responses such as blood pres-sure level, cholesterol level, or body weight, to name a few. Therefore, potentially new indications of drugs to control the aforementioned important physical measurements can be examined in the same paradigm. Furthermore, many other sources of patient information, such as demographic infor-mation, diagnosis codes, other type of lab measurements, as well as interactions among all these information sources can be taken into consideration to facilitate the prediction of the physical measurement level. Last but not least, although the proposed CSCCS model in its simplest form is a linear model, the history of SCCS model development [47] could help guide on future development of CSCCS model. More complicated models can be derived from its simpler counter-parts for better predictive performance in more specific and refined applications.
 The authors would like to gratefully acknowledge the anony-mous reviewers for their reviewing efforts and invaluable suggestions. This research is funded by the NIH BD2K Ini-tiative grant U54 AI117924, and the NIGMS grant 2RO1 GM097618. The authors would also like to acknowledge the supports from these two grants.

