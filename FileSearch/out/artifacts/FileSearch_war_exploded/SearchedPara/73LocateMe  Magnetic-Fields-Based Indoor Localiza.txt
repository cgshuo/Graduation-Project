 KALYAN PATHAPATI SUBBU, BRANDON GOZICK, and RAM DANTU , Indoor localization has been a well-known problem for which numerous solutions rang-ing from infrastructure-based to wearable-sensor-based and now smartphone-based have been proposed. The rapid growth of smartphones in today X  X  market has increased the ubiquitous nature of these devices to a great extent. Embedded with GPS, mi-crophones, cameras, accelerometers, and magnetic field sensors, they provide ample means to develop innovative solutions for this problem. GPS is already being used for outdoor localization and navigation [Zheng and Xie 2011]. However, it does not function indoors due to signal attenuation and interference. WiFi-based systems assume ubiq-uitous availability [Cheng et al. 2005; Evennou and Marx 2006] and may have device compatibility and authentication issues. Accelerometers [Ofstad et al. 2008], micro-phones [Pathapati-Subbu et al. 2009], and a combination of these sensors, along with WiFi [Azizyan and Choudhury 2009], have also been used for localization. However, no work has utilized the built-in magnetic field sensor for this purpose.

Ambient magnetic fields indoors comprise of disturbances in the Earth X  X  magnetic field that are present everywhere, caused by the ferromagnetic nature [Yamazaki et al. 2003] of steel structures [Burnett and Yaping 2002]. These disturbances [Roetenberg et al. 2003] fluctuate the compass heading, thereby resulting in incorrect direction and location information. The heading or the direction using these magnetic fields was esti-mated in Afzal and Renaudin [2011] with mathematical error correction mechanisms. Instead of developing compensating mechanisms for this issue, some works [Haverinen and Kemppainen 2009; Storms and Raquet 2009] used external sensors and robots to collect these ambient magnetic fields along different hallways and showed that their uniqueness due to the presence of different kinds of pillars, doors, and elevators could be exploited as a solution for indoor localization. However, they do not provide any quantitative reasoning for the occurrence and uniqueness of the signatures. So rather than merely stating that steel structures cause disturbances in the Earth X  X  field, we analytically show the impact of these structures on the Earth X  X  field by modeling the magnetic field distribution of different kinds and sizes of pillars, doors, and elevators. With this modeling, we show how and why magnetic signatures appear the way they do. Also, factors like usability, applicability to different users, and practical implemen-tation have not been considered in their work.

To the best of our knowledge, no work in the literature has utilized the embedded magnetic field sensor as a magnetometer to capture these signatures and utilize them for localization. Subbu et al. [2011] showed the possibility of performing coarse local-ization using magnetic signatures entirely on a smartphone. We extend this work to provide finer location information instead of just the hallway name. We envision a sce-nario where a user walks a few meters in an unknown hallway, then uses a smartphone to identify his position in that hallway based on the magnetic signature collected for the distance walked. To brief up the idea, we first fingerprint each hallway using the measured magnetic signature. Then, by classifying the test signature of an unknown hallway to one of the fingerprints, we obtain the person X  X  position in meters, thereby providing fine-grained localization. Differences in human walking speeds cause varia-tions in the time and magnitude of signatures, even if they retain the same pattern. Therefore, we incorporate the dynamic time warping (DTW) classifier, which is known to account for these differences and perform alignment by stretching or compressing the signals. Our contributions are as follows. (1) Analytically modeling ferromagnetic structures. In Section 4, we implement an an-(2) Developing an application encapsulated in a single sensing unit. The localization (3) Presenting an application that can be used in a realistic setting with real users. In this section, we briefly discuss the hardware and software platform and the data collection procedure followed for obtaining the magnetic signatures. We employed an HTC Nexus One smartphone with a 1GHz Snapdragon ARMv7 pro-cessor and 512MB of RAM. It has a built-in three-axis AK8973 monolithic geomagnetic sensor or magnetometer manufactured by Asahi Kasei. 1 The sensor is capable of pro-viding a dynamic sampling frequency, meaning that the number of samples recorded per second can be changed using the APIs offered in the Android operating system. 2 By choosing a sampling rate, we can control the number of samples recorded by the sensor which has great influence on both the power consumption and also the amount of processing time needed for computations.

The smartphone runs on the Android operating system which has an easy develop-ment environment and access to hardware-level application programming interfaces (APIs). With this, we can create a smartphone application that is both practical and user friendly. The fingerprints were collected in different hallways of two campus buildings, Uni-versity Union and College of Engineering (COE). The floor maps in Figures 1(a) and 1(b)illustrate the different hallways.

Table I summarizes some experimental specifications showing the number of hall-ways ( N h w ys ), number of fingerprint repetitions ( F r ), average hallway length ( HL a v g ), total training file size ( Tr fs ), and time consumed for data collection ( T c )ineachofthe buildings.

Both the subjects walked with an average speed of 1.5 m/s along the walls or pillars for three main reasons: (1) to obtain a dominant signature that could arise due to walls and ferromagnetic objects; (2) to mimic usual walking patterns of people; and (3) to make the application useful for visually-impaired people who follow a wall trailing [Hill and Punder 1976] procedure where they walk past walls holding or sensing the touch of objects, such as pillars, doors, walls, etc. A simple description of the walking process is depicted in the video available at http://www.youtube.com/watch?feature=player_ embedded&amp;v=iHVoI1n89TY . This section discusses factors such as variations in (a) the built-in sensors, (b) the measurement procedure, and (c) the environment that could potentially affect the stability of the magnetic signatures.  X  Built-in sensor model variation. Different smartphones consist of different models of built-in magnetic field sensors that vary in their sensitivities. For our system to work, it is imperative that the magnetic signatures collected at the same location show similarity. To check this similarity, we employed four phones with different magnetic field sensors. Table II lists the phones and the model number of the built-in sensors. the signature of the Electrical Engineering hallway recorded using the four phones.  X  Measurement process. The measurement process in this work is simply to walk past pillars along the hallway. However, care has to be taken to walk closer to the pillars, since magnetic field magnitudes are known to be inversely proportional to the cube of the distance. In other words, the farther the distance from an object, the lower the magnitude. To observe if this phenomenon affected the signatures, measurements were made at different horizontal distances from walls and pillars. This gives an idea of how far users can walk and still be able to obtain a satisfactory signature.
Figure 3 illustrates this observation.  X  Device placement. Since we are only considering the overall squared magnitude of the magnetic field and not the magnitude of individual axes, the placement of the phone should not cause any problems in our work. To verify this, we collected data with the phone at different locations. Figure 4 illustrates the findings.  X  Presence of furniture. The other factor that we speculated would affect the magnetic signatures is the presence of furnitures along hallways. To test this speculation, we collected data in the presence and absence of furniture in certain hallways.
Figure 5 shows the signatures obtained with a chair and table placed at different spots along the hallway. As can be seen, there is not much difference in the two signatures. The furniture experimented with was chairs with metal support and wooden tables. Unless the furniture consists of heavy metallic objects that are frequently replaced, we believe there would not be any issue with the system, since finding such equipment was a difficult task to fulfill. We therefore found similar objects which might be realistically placed and then removed inside a hallway.  X  Presence of personal metallic objects. We also tested the affect of magnetic signatures due to the presence of small metallic objects in the user X  X  pocket along with the smartphone. In other words, we wanted to find if the magnetic field sensor was disturbed by common items carried by people in their pockets, thereby drastically changing the magnetic signatures collected. Figure 6 shows signatures obtained from three separate measurement processes involving a key chain, loose change, and a flash drive placed along with the phone in the pocket. Again, we can see that presence of various objects in the pocket along with the phone did not cause any major effect on the signature (other than a time delay due to different walking speeds) and magnitude variations (due to the distance from wall) which the dynamic time warping algorithm is capable of matching.  X  Long-term variation. Similar to variations in the sensors and variations in the mea-surement process, long-term variations in the environment itself could be a cause for changes in the magnetic signatures. Long-term variation is the change in the magnetic field magnitudes over a certain period of time. To check if this phenomenon was present in the signatures, we computed the variance of the magnetic signature of a particular hallway collected over a year. Figure 7 depicts this observation. In this section, we provide an analytical reasoning for the occurrence and uniqueness of magnetic signatures observed and then extend the modeling to a simulation framework that can be used to generate magnetic signatures of various hallways with different kinds of pillars, elevators, and other ferromagnetic objects present. Indoor magnetic signatures are a combination of the Earth X  X  magnetic field and the fields from ferromagnetic objects, such as pillars, doors, and elevators. These signatures are known as anomalies because they disturb the Earth X  X  magnetic field.

The Earth acts like a great spherical magnet, surrounded by a magnetic field [Oldenburg and Moridis 1998] which changes both with time and location and re-sembles the field generated by a tilted dipole magnet whose axis is offset from the axis of the Earth X  X  rotation by approximately 11  X  . The Earth X  X  magnetic field can be generated using the IGRF-International Geomagnetic Reference Field model 3 released by the International Association of Geomagnetism and Aeronomy (IAGA). The model-generated Earth X  X  magnetic field was compared with the field measured at five different locations depicted in Figure 8.

However, as we know, in indoor environments, the Earth X  X  magnetic field is disturbed by structures made of ferromagnetic materials. The impact of these structures becomes dominant as the distance to the observation point decreases, or in other words, distance towards the pillar decreases. This impact can be observed in Figure 9. The COE and Union buildings consist of solid steel and steel-reinforced concrete pillars, respectively. The magnitudes of the signatures in the two buildings varied between 35 X  115  X  T and 100 X 220  X  T, respectively. This shows that steel-reinforced concrete pillars caused stronger disturbances on the Earth X  X  magnetic field than solid steel pillars. To understand this observation, we implemented an analytical model to generate magnetic signatures in the presence of these pillars and compared them with the measured data. We followed the point dipole model [Jackson 1999] given by Equation (1).
 where  X  is permeability of free space, m denotes the magnetic moment, which is the average field strength at any particular point (also known as saturation magnetization), and r is the distance between the dipole and the observation point. The resultant moment arising due to the interaction of multiple dipoles is given by with  X  being the angle between the dipoles and m 1 and m 2 the magnetic moments of the two interacting dipoles. By substituting M total in Eq. (1), the magnetic field was obtained for both steel-reinforced concrete and solid steel pillars. (1) Steel-Reinforced Concrete. Typically, steel-reinforced concrete pillars are con-(2) Solid Steel. Now, using the same model, the pillars at the COE were considered as The previous sections explained the ferromagnetic phenomenon observed from the collected magnetic signatures. To extend this analytical modeling, we performed simu-lations to generate magnetic signatures assuming either steel-reinforced or solid steel pillars, doors, and elevators present along hallways of different lengths. The motive be-hind this simulation was to validate the classification algorithm that will be explained in Section 5 on various kinds of hallways, since data collection over all possible hallways is not possible for the evaluation of the proposed system. The simulation methodology consisted of the following steps. (1) Consider a geometrical shape, for instance, a cube, for a solid pillar, as seen in the (2) Next, the magnetic moment of the pillar was calculated as (3) The magnetic moment in the pillar varied depending upon the number of atoms (4) Next, the magnetic field of the pillar was calculated using Eq. (1). (5) Finally, a signature, as shown in Figure 13, was obtained assuming a person walk-
We clarify here that a quantitative comparison between the measured and simulated magnetic signatures between existing hallways cannot be performed due to the pres-ence of unknown variables, such as the exact make or type of iron used in the pillars, their properties, etc. The idea behind generating such signatures will be understood in Section 6 where we show how these generated signatures are used for validating the dynamic time warping classifier.
 Doors are other elements that constitute ferromagnetic materials. There are different kinds of doors present in hallways. Our magnetic signature collection process revealed that door frames were made of steel and this resulted in patterns identifiable along hallways making it feasible to detect the door a person is close to while walking in a hallway. Figure 14 illustrates this finding.

The analytical implementation of the door signatures was performed by using the dipole model and considering each frame in the door as a ferromagnetic object. Figure 15 depicts both the analytical and measured signatures of a door.

In Section 6, we present classification results of this particular door, that is, F226 along a hallway. To conclude, this section provided an understanding of the ferromag-netism phenomenon and the magnetic behavior of different kinds of pillars, doors, and elevators and their effect on the Earth X  X  magnetic field. The next section briefly explains the classification algorithm that forms the backbone of this location identifi-cation system.
 The previous section explained the reason behind obtaining unique magnetic signa-tures. In this section, we transition to the application domain and explain the classi-fication technique implemented on the measured signatures. We start with the DTW algorithm and its applicability to indoor localization and then the procedure for local-izing and estimating the distance walked using DTW on the magnetic signatures. The technique in DTW is to compress or stretch the time axis of one (or both) sequences to achieve a better alignment. In general, consider two signatures, T ={ t 1 , t 2 ,..., t A } and S ={ s 1 , s 2 ,..., s B } of different lengths. The goal is to find the best match between the two signatures by some alignment w , the optimal warping path. The warping path samples, where i and j corresponding to the time axes of two sequences, respectively. The objective of the warping function is to minimize the overall cost function given by where  X  ( w ( n )) is the squared distance between the sample points given by The warping path must satisfy the following constraints.  X  Monotonicity. The warping path must progress in the forward direction, that is, i ( n )  X   X  Boundary. The function must always start at w (1) = (1 , 1) and end at w ( n ) = ( A , B )
To generate a warping path, a cost matrix is constructed. This matrix represents the minimum cost required to reach a particular point ( i , j ) from (1 , 1). This minimization problem is usually solved using the dynamic programming approach, whereby a cumu-lative or accumulated distance  X  ( i , j ) is computed as the sum of  X  ( w ( n )), the distance obtained from the current set of points, and the minimum of the cumulative distances of the adjacent elements or neighbors. This is given by
After performing the time warping, the closest match is obtained by the lowest cumulative distance between the signatures.
 Instead of classifying the test signature of an entire hallway [Subbu et al. 2011], we performed DTW between a short test signature and stored signatures. (For the remaining sections, we will refer to stored signatures as maps.) To compare the short signature, we implemented a sliding windowed DTW, explained in Figure 16.

Our program picked 100 random positions from each test signature and performed classification for each of those positions. This was mimicking the procedure of obtaining a signature when a person walks for a short distance. The randomly picked segments were of length equal to W l which ranged between 5 and 35. In simple terms, W l is nothing but the resolution or shortest distance required to walk in a particular hallway to get localized. We basically tested different resolutions to see which one was the best for each hallway. The DTW was performed between each short test segment and sliding windowed segments of the maps.
 The classification accuracy was calculated as
Then using the sampling rate s r and W l , the time taken to walk a certain distance t was calculated as W l / s r . The distance for the stored maps was calculated using  X  = v  X  t , where v is the velocity. The localized or estimated distance was obtained from the section of the stored maps where DTW correctly matched the test signature. The estimation error for every W l was calculated as E =  X  M  X   X  E , where  X  M is the distance measured manually using a surveyor X  X  wheel. Finally, the average estimation error  X  e over all positions for a particular W l was calculated. In this section, we discuss the performance of the classification algorithm on both the measured and simulated magnetic signatures. We also discuss the response or result computation times, memory, and power consumption of the algorithm when run as a stand-alone application on different smartphones. 6.1.1. Alignment Evaluation. Figure 17 illustrates the sliding windowed DTW on the measurement data. Short segments of a test signature were randomly picked as explained in Section 5.2, and DTW aligned these segments with an appropriate win-dowed segment of the map, thereby matching the test signatures correctly to the re-spective map or hallway. 6.1.2. Independence of Phones and Sensors. In Section 3, we showed visually the similar-ity of signatures collected from smartphones with different magnetic field sensors. Here we show the performance of DTW in classifying such magnetic signatures, indicating the independence of our system on devices.

A total of 16 test signatures were obtained from four subjects, each using a different phone listed in Table II. The windowed DTW was performed on each of these test signatures for random number of positions or short segments of size 35 samples. Figure 18 illustrates the matching process. The signature obtained from the Galaxy Nexus, which has the MPL magnetic field sensor, was considered as the training signature or the map, and the signatures from the other phones were tested against this signature for a correct match. From the plots, we can see that DTW classifies signatures irrespective of the sensor sensing the magnetic fields. The classification accuracies were computed as A = N P / T P and listed in Table IV, where N P and T P are the number of correctly matched positions and total number of positions, respectively. We performed both Matlab (offline) and smartphone (online) based evaluations to ob-tain the estimation error and localization distances. For offline evaluation, we gathered a database for each building which had one stored signature map for each hallway in the building. The estimation error was computed as explained in Section 5.2 for each random position and averaged. Figure 19 depicts the average estimation errors computed offline over all the positions chosen for every window size (resolution) in the University Union building.

We can see that for five out of the six hallways, the error is between 0 and 3.5 m, approximately. There are some outliers, such as 25.2 m for a W l of five samples in the ESSCLvL2 and 17 m for 15 samples in the Bookstore hallways. The reason for this is very low resolution in those particular hallways for which DTW was unable to obtain a correct match. Moreover, there could have been segments of signatures that had a similar pattern as that of the test which resulted in the DTW performing a wrong match. However, for the remaining window sizes, the error reduced to within 2 m and 5 m, respectively, for the two hallways.

Next, we developed the entire application Locate Me on the smartphone. The applica-tion was written in Java using Android APIs. It has three components: sensor sampling rate identifier, test signature collector, and hallway classifier. The sampling rate iden-tifier calculates the frequency of the magnetic field sensor in the Android phone being used. During our preliminary data collection, we noticed that different smartphones had different sampling rates. For this application to function properly, it is required finding the sampling rates in the phones. This process is performed automatically once the application is opened and requires no user interaction to complete (i.e., no user re-quirements). The splash screen shown in Figure 20(a) performs this analysis. Finding this rate allows consistency in functionality and an accurate hallway match. The other components and the complete user interface of the application are shown next.
Figure 20(b) shows the home screen for the LocateMe application. This screen con-tains the building selection drop down list. The user, assuming he/she knows which building they are in (can also be obtained using GPS just before entering), picks the building from the list. This list is shown in Figure 20(c). Magnetic maps for the cor-responding building are then downloaded onto the phone. The localization results will reflect the comparison of these stored maps with the test signature collected by the user. The test signature collector obtains the sensor data when the user pushes the Start/Stop toggle button shown in Figure 20(b) and walks a certain distance. An exam-ple of test signature collection is shown in Figure 20(d).
 For evaluation, we used different sets of phones, namely, Nexus One, Droid, Nexus S, and HTC Hero. We chose ten users for a total of ten hallways in two buildings, one user per hallway. Given the fewer number of hallways in the COE building and the convenient access we had to it, we instructed the users to walk and record random segments of the hallway, each starting at different positions. The users therefore walked 26, 15, 13, and 13 different positions in their hallway, varying the walking distance each time. A lower total of ten segments in the Union were subsequently recorded due to inconvenient access and a high afternoon building population. After collecting the test signature, the user pushed the Classify button located at the bottom-right corner shown in Figure 20b. This is when the hallway classifier is activated, which in turn activates the classification system block explained in Section 5.

Obtaining similar error plots as in Figure 19, we analyzed which particular window size resulted in a high accuracy and low estimation error for a particular hallway. In other words, we picked the lowest resolution that was obtained with a high accuracy and low estimation error for both the offline and online evaluations. We list these statistics in Tables V and VI.

As seen, a 96% accuracy was obtained for Corr2 as 25/26, where 25 is the number of correct matches and 26 is the total number of repetitions.

The tables indicate the resolution (distance required to walk) within certain meters with a certain accuracy obtained from offline (Matlab) and online (smartphone) evalu-ations. For instance, we can say that it is required to walk 2.32 m in Corr2 hallway to be localized within 3 m with 90% accuracy. The smartphone-based results were close to the Matlab results, thereby validating the evaluation procedure. The slight differences in the results between the two evaluations were due to minor variations in the sensor data collected while experimenting. However, this did not affect the outcome in a major way.

Now, we compare our results with those obtained (tabulated in Table VII) from a particle-filter-based approach [Haverinen and Kemppainen 2009]. This is the only existing work related to magnetic-field-based localization with humans. Haverinen and Kemppainen [2009] conducted their experiment in main corridors of a floor of total length 278 m. The particle filter simulation program incremented the position of the human by 1 m, thereby obtaining 278 positions for the entire hallway. Further, each experiment set was conducted using different values of standard deviation  X  r of the measurement model between [1  X  T, 5  X  T]. The measurement model used was a single variable Gaussian probability density function given by where x is the state of the system. The magnetic field data captured by a user using a wireless magnetometer was the observation z , and function h ( x ) was used to map x to the observation. In other words, the particle filter compared the z at every instant to the map data (collected by a robot).

From Tables V and VI, we can see that minimum and maximum localization distance required to walk are 1.83 m and 6.3 m, respectively. Although 6.3 m is a large distance for this particular hallway, it was less than 5 m for the other hallways. This is a significant improvement over values between 9 m and 45 m shown in Table VII. The cause for large localization distances obtained using particle filters can be attributed to the fact that particles take a longer time or distance to converge at a point where there is a minimal deviation between the map and the test signatures. In contrast, the DTW algorithm handles these deviations very well by either stretching or compressing the signatures. Response time is the time spent by the user waiting from initially pushing the classify button to the time he/she receives a classification and position estimates. Average response times were calculated for each hallway and summed to obtain a total response time for the building. The response times in seconds, obtained from each smartphone, are illustrated in Figure 21.

The following observations can be made from this figure. (1) There was a linear increase in the response times for both buildings. This was (2) The hallways in the University Union had shorter response times when compared (3) Both Nexus One and Nexus S had faster response times when compared to Droid
A screenshot of the results showing the classification result, distance, and response time is illustrated in Figure 22.
 Gozick et al. [2011] showed how magnetic signatures can be used as landmarks. Using this information, the position of a user near certain landmarks, as shown in Figure 22, can be given. There are also other means of extracting landmarks [Millonig and Schechtner 2005] and integrating them with the fine localization results presented in this work. Android allows external storage up to 32GB, which is more than sufficient for storing a set of magnetic maps for each building, since the size of the database is very small, as listed in Table IX.

The amount of resources consumed by the LocateMe application is of primary inter-est. From the response times shown earlier, it is clear that LocateMe does not require more than two minutes for all three components explained earlier to run. So we com-pared the memory usage of RAM in megabytes and power consumed in millWatts by our application to other activities that normally run on a smartphone for a duration of two minutes.

The table shows that LocateMe does not consume much resources and can be run without affecting the functioning of other applications or burdening the CPU. The simulation methodology explained in Section 4.3 was performed assuming hall-ways of lengths 40 X 80 m, since most of the hallways at which measurements were taken were normally between this range. For each hallway length, 100 different hallway sig-natures were generated, and the dynamic time warping algorithm was evaluated on each of the 100 signatures by checking if the closest match was equal to the expected.
The simulation picked 100 random positions from each of the 100 test signatures and performed classification for each of those positions. Figure 23 illustrates the DTW matching.

Table X lists the average error and average localization distances obtained for hall-ways of different lengths generated, assuming the presence of pillars, doors, and eleva-tors. The distance between each of these objects was assumed to be 4.75 m, similar to the distances measured in the COE building. The accuracy was computed using Eq. (9) and then an average accuracy was further calculated as A v g A = A H /100. In Section 4.4, we showed that metallic door frames tend to create disturbances, thereby resulting in signatures sensed by the smartphone sensor. Here, we show how the door signatures could be identified in a hallway using DTW. Figure 24 depicts two different door signatures and the performance of DTW in classifying them. From the results obtained, we showed the applicability of DTW to match signatures collected by different people and provide localization independent of the user and the device. The proposed application was also validated with subjects completely new to the buildings and also various kinds of signatures. Hence, it is practically feasible and can be used by anyone owning a smartphone (regardless of the position and orientation).
Creating and building a database of fingerprints is not a cumbersome task. As men-tioned in Varshavsky et al. [2007], the time spent in fingerprinting hallways can be very much less than that for following maintenance procedures, like elevator servicing, emergency exit lighting, etc. Crowdsourcing is the concept that describes a distributed problem solving and product model, in which small tasks are broadcasted to a crowd in the form of open calls for solutions [Alt et al. 2010]. Everyday users engage in activ-ities that help in solving or providing information for a larger context [Eagle 2009]. As part of future work, we plan on integrating this concept to our data collection process around different hallways. In other words, the occupants of the building can collect magnetic signatures of different hallways, since they usually move around the same set of locations daily, following routine paths and since most of them carry smart-phones. The data collected can be uploaded onto a server. This form of data collection and sharing can be also categorized as participatory sensing [Burke et al. 2006], where users can passively participate in the sensing process, since all that is required is to walk and collect data. Following the crowdsourcing concept, a database can be built and continuously updated providing accurate maps of the building.

To summarize, this article showed the possibility of using dynamic time warping for indoor localization. Future work would involve developing a more robust DTW and implementing a real-time localization system that can perform classification instanta-neously. We also plan to integrate existing landmark-based solutions with our work, so that a person X  X  location near certain landmarks could be easily provided, which could in turn be used for navigating the person to his/her destination. We also plan on devel-oping a more user-friendly application with voice alerts that could be suitable for the blind and visually impaired. Many indoor localization systems or solutions exist. They can be grouped based on the types of systems used to provide location estimates: (1) wearable sensors, (2) infras-tructure, (3) ambient sensing, (4) probabilistic, and (5) smartphones. For each category, we highlight the well-known solutions and also list some of the areas where DTW has been applied. Golding and Lesh [1999] use wearable accelerometer, magnetometer, light, and audio sensors to provide indoor localization and navigation. Collin et al. [2003] propose an indoor positioning system using accelerometers and compasses. Lee and Mase [2002] develop a dead-reckoning-based activity and location recognition system. Vildjiounaite et al. [2002] propose a location estimation system by combining data from wearable sensors and a map. Although pioneering, these solutions require all kinds of electronic circuitry in order to be usable. Cricket [Nissanka et al. 2000] functions through a combination of RF and ultrasound beaconing systems. Active Badge [Want et al. 1992] provides location information us-ing infrared-based transmission and reception. Bat system [Addlesee et al. 2001] used ultrasonic location estimation to provide more accurate position data. Another system for location tracking, PlaceLab [Otsason et al. 2005] used signal strength of various wireless connections, such as GSM (global system for mobile communications), Blue-tooth, and WiFi [Yin et al. 2004]. Randall et al. [2007] use solar cells combined with an RFID-based localization system to determine the user X  X  location. Although these works achieved very fine localization accuracies, they carry with them high installation costs and are not practically feasible for daily use. Ravi and Iftode [2007] perform room-level localization using light sensors assuming uniform lighting conditions. This assumption may not be valid every time and users X  movements are constrained to very slow speeds in order to obtain match. Also, the position of the sensor is fixed. Bucur and Kjrgaard [2008] propose an indoor localiza-tion system by sensing indoor radioactivity. This work requires specialized sensors not available in smartphones for both fingerprinting and using as an application. Location fingerprinting-based systems surveyed in Liu et al. [2007] use pattern recognition tech-niques like k-nearest neighbor, neural networks, probabilistic methods, and support vector machines. SkyLoc [Varshavsky et al. 2007] performs floor-level localization of different buildings using GSM fingerprinting. RADAR [Bahl and Padmanabhan 2000] uses WiFi fingerprints but requires calibration of signal strengths at many physical locations in the building. Chung et al. [2011] used a compass on a rotating motor to develop an indoor location system using ambient magnetic fields. Probabilistic-techniques-based particle filters [Arulampalam et al. 2001] have been employed for location estimation using foot-mounted inertial sensors [Krach and Roberston 2008; Woodman and Harle 2008], fusing information from multiple sen-sors [Wendlandt et al. 2006] and using infrared laser range finders and ultrasound sensors [Fox et al. 2003; Hightower and Borriello 2004]. But these are not classification-based systems where the location information is available in a database. Instead they have to be integrated with floor plan information or have to be used with map matching techniques [Bernstein and Kornhauser 1996] to obtain the position estimates. Other methods require calibration, which is a burden for the system [Chai and Yang 2007]. With the proliferation of mobile phones embedded with sensors, various solutions for in-door localization have been on the rise, such as those based on activity recognition using accelerometers [Constandache et al. 2010]. However, this work relies on initial GPS and Google Maps for path trails. Accelerometers have also been used for human localization in that a human X  X  daily walking trial is used to locate him. This involves monitoring, collecting, and storing every user X  X  movement. Parnandi et al. [2010] perform coarse localization using a mobile phone X  X  built-in accelerometer by recognizing the walking type. Their idea of using the time taken to walk a particular staircase as a means for localization may not be valid for people walking with different speeds or implementa-tion in all possible buildings. WiFi-based fingerprinting and localization using mobile phones has also been attempted [Azizyan and Choudhury 2009]. However, fluctuations in signal strengths, temporary disconnections, and maintaining accurate distances from access points during training and testing phases are some of the issues. Ravi et al. [2006] propose a solution by capturing images with a mobile phone camera. The camera has to be worn as a pendant, thereby imposing a placement constraint. Also, building a database of images for all possible locations is cumbersome and may even raise privacy concerns. Blankenbach et al. [2011] showed how artificially magnetic fields collected using the built-in magnetometer can be used as a source of indoor positioning. DTW has been employed as a classifier in some of the existing work. We highlight a few here. Muscillo et al. [2007] perform activity recognition by considering variability in speeds and perform classification of motor activities using DTW and derivative DTW. Parnandi et al. [2010] perform DTW-based classification of user activities; however, they do not build upon the classification to provide fine-grained location estimates. Grzonka et al. [2010] classify motion templates using DTW to perform simultaneous localization and mapping (SLAM). SLAM techniques may not be useful for a common man, since a simple localization application should have prior knowledge about the locations in order to accurately locate him indoors. Gayathri et al. [2011] estimates vehicular speeds through classification of RSS signal strengths of similar looking but time-or magnitude-varying GSM signals obtained while traveling in a car at different speeds. DTW has also been utilized in power disturbance classification [Youssef et al. 2004], chromosome classification [Legrand et al. 2008], and recognition of ECG changes [Tuzcu and Nas 2005]. Tuzcu and Nas [2005] use DTW algorithm to account for time fluctuations and classify footsteps using the footstep sound.

Overall, the existing work requires sensors to be interfaced with laptops or base stations that have to be placed strategically or systems that pose constraints on the placement and orientation. There is also infrastructure, installation, and maintenance costs associated with certain solutions. In contrast to all these existing systems, we developed a fine localization application utilizing just a smartphone. We showed that our work does not pose any placement or orientation constraints, is practically imple-mentable on smartphones with different hardware, and most importantly, can perform localization independent of the subject and his/her walking speed. Locating a person indoors is an interesting problem in the mobile computing field. By capturing the unique magnetic signatures of different hallways using a smartphone, we exploited the magnetic fields present indoors as a solution to the localization problem. Through analytical modeling, we explained the occurrence of magnetic signatures due to different components or sources of disturbances, such as pillars, doors, and elevators. Then, by applying time-warping technique to the measured magnetic signatures, we showed that our classification framework is independent of the user and also the phone used. Our classification accuracies indicate that hallways can be distinguished with a good success rate. Our low resolution and estimation errors showed the feasibility of our approach. The faster response times and low memory and power consumption indicate the successful implementation of our dynamic time-warping algorithm on resource-limited smartphones.

