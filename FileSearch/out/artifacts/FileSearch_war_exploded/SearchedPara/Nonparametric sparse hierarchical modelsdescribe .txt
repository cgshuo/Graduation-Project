 Thomas Naselaris, Kendrick N. Kay and Jack L. Gallant An important step toward understanding the neural basis of vision is to develop computational mod-els that describe how complex visual stimuli are mapping onto evoked neuronal responses. This task is made challenging in part by the inherent difficulty of obtaining neurophysiological recordings from single neurons in vivo . An alternative approach is to base models on brain activity measured by means of functional magnetic resonance imaging (fMRI). fMRI measures changes in blood oxy-genation and flow throughout the brain that occur as a consequence of metabolic demands. Although the relationship between measured fMRI activity and the spiking activity of neurons is rather com-plex, as a first-order approximation the fMRI signal can be considered to be monotonically related to the pooled activity of the underlying neural population. In this paper we consider the task of predicting fMRI brain activity evoked by a series of gray-scale natural images. Natural images are a useful stimulus set for efficiently probing the visual system, because they are likely to evoke response from both early visual areas and from more central, highly nonlinear visual areas. The fMRI scanner provides a three-dimensional image of the brain with a spatial resolution of a few cubic millimeters and fairly low temporal resolution (about 0.5 X 1 Hz). After pre-processing the fMRI signals are represented as a vector of three-dimensional volume elements called voxels. Here we restrict our analysis to voxels sampled from visual area V1, the primary visual area in humans.
 There are two problems that make predicting evoked responses of fMRI voxels difficult. First, fMRI signals are noisy and non-stationary in time. Second, each voxel reflects the combined influence of hundreds of thousands of neurons [4]. fMRI scans of a single voxel in human V1 likely reflect the that provides good predictions but whose function remains opaque ( i.e. , a black box). In order for a predictive model to advance our understanding of the brain, the function of any predictive model must be conceptually interpretable.
 In this paper we propose a new model that aims to overcome some of these problems. Our V-SPAM model is a hierarchical and sparse nonparametric additive model. It combines a biologically-inspired hierarchical filtering scheme with a nonlinear (nonparametric) pooling of the outputs from various levels of the hierarchical filtering stage. The model is estimated separately for each recorded fMRI reserved for this purpose.
 The filtering component of the model consists of three distinct layers: simple cells, complex cells, and linear combinations of the complex cells (here called pooled-complex cells ). The fMRI response complex and pooled-complex cell model outputs. This last step automatically learns the optimal nonlinear V1 responses not captured by the simple and complex cell model components alone [6]. The fMRI dataset used in this paper was collected as part of an earlier study by [5]. That study also used a filtering model to describe the relationship between natural images and evoked fMRI signals, and used the estimated models in turn to decode (identify) images. However, the earlier study only provided linear pooling of model complex cell filters. Our results show that the V-SPAM model predicts fMRI responses evoked by natural images better than does the earlier linear pooling model. Furthermore, the spatial receptive fields, frequency tuning and orientation tuning curves of the V-SPAM model estimated for each voxel appear to be consistent with the known properties of V1, and with the previous results [5]. 2.1 Sparse Additive Models The regression task consists of estimating the regression function Y  X  R and a predictor-vector X = ( X 1 ,...,X p )  X  R p from data { ( X In the nonparametric regression model, the response Y smooth function. Estimating this function ( i.e. , smoothing) becomes challenging when the num-ber of predictors p is large. Even estimating linear models of the form Y challenging in these high-dimensional settings. For linear models however, when the vector  X  is sparse, Tibshirani [8] and others have shown that the ` 1  X   X  = arg min  X 
P ( Y i  X   X  &gt; X i ) 2 +  X  P p j =1 |  X  j | can estimate a sparse model and has strong theoret-ical properties.
 The sparse additive model (SpAM) framework of Ravikumar et al [7] extends these sparse linear models to the nonparametric domain. In additive models, introduced by Hastie and Tibshirani [3], the response Y is an additive combination of functions of the predictors, Y = P additive model then imposes a sparsity constraint on the set J = { j : f are nonzero. 2.2 Fitting Algorithm for Sparse Additive Models The paper [7] proposes a fitting procedure for sparse additive models that has good statistical prop-erties even in the large p small n regime. Their SpAM fitting algorithm is summarized in Figure 1. It performs a coordinate descent (in the L 2 ( P n ) space, with P step the algorithm performs nonparametric regression of the current residual onto a single predictor, and then does a soft threshold.
 = f (0) j , for j = 1 ,...,p .
 Compute the residual: R j = Y  X  P k 6 = k f k ( X k ) ;
Estimate the conditional expectation P j = E [ R j | X j ] by smoothing:
Set s j = n Soft-threshold: f j = [1  X   X /  X  s j ] +  X  P j ; Center: f j  X  f j  X  mean ( f j ) .
 Our V-SPAM model combines a biologically-inspired filtering scheme and a novel algorithm that three distinct layers, arranged hierarchically: simple cells, complex cells, and linear combinations fed to an algorithm that estimates a nonlinear pooling function that optimizes predictive power. 3.1 Simple Cell Model The receptive fields of V1 simple cells are known to be generally consistent with a Gabor wavelet model [6]. Most importantly, they are spatially localized, oriented, spatial frequency band-pass and phase selective. (see Figure 2.) Figure 2: Gabor wavelets. Each row shows a family of Gabor wavelets that share a common spatial in the pyramid. In our model the simple cell filter bank was implemented as a Gabor wavelet pyramid, as follows. Let I denote an image, and d the number of pixels. It can thus be represented as a pixel vector in
R d . Denote by  X  j a Gabor wavelet sampled on a grid the size of the image, so that it too can be represented as vector in R d . Then our simple cell model, for the activation given the image I is a non-negative rectification. (See Figure 3.) Correspondingly, X activation of the 180  X  spatial phase counterpart.
 Figure 3: Simple cell model. The activation of a model simple cell given an image is the inner product of the image with a Gabor wavelet, followed by a non-negative rectification. 3.2 Complex Cell Model our model the complex cell filter bank was implemented by taking the sum of squares of the outputs of four simple cells (corresponding to the wavelet pairs that are identical up to phase), followed by a fixed output nonlinearity. The activation of the model complex cell given an image I is given by, ( I ) = log(1 + q [  X   X  j ,I  X  ] 2 + + [  X  X  X   X  j ,I  X  ] 2 + = log(1 + q [  X   X  j ,I  X  ] 2 + [  X  0 j ,I ] 2 ) , (2) where  X  j and  X  are Gabor wavelets identical up to phase (also called a quadrature pair; see Fig-ure 4).
 Figure 4: Complex cell model. The activation of a model complex cell given an image is the sum of squares of the inner products of the image with a quadrature pair of Gabor wavelets followed by a nonlinearity. This is equivalently modeled by summing the squares of 4 simple cell model outputs, followed by a nonlinearity. 3.3 Pooled-complex Cell Model of complex cells sharing a common spatial location and frequency. This stage has no direct biolog-ical interpretation in terms of area V1, but has been included to improve representational power of the model: a linear combination of complex cells (the pooled-complex cell), followed by a nonlin-earity, cannot be expressed as an additive combination of nonlinear functions of individual complex cells. Note that this element might be particularly useful for modeling responses in higher visual areas beyond V1.
 If { X j 1 ,...,X } correspond to complex cells with the same spatial location and frequency, then the corresponding pooled-complex cell (which thus sums over different orientations) is given by, Z X j l . (See Figure 5.) Figure 5: Pooled-complex cell model. Subsets of complex cells that share a common spatial location and frequency are summed. 3.4 V-SPAM model Finally, the predicted fMRI response Y is obtained as a sparse additive combination of complex cell and pooled-complex cell outputs. Denote the complex cell outputs by { X pooled-complex cell outputs by { Z 1 ,...,Z q } . Then the fMRI response Y is modeled as a sparse additive (nonparametric) model, Y = P p j =1 f j ( X j ) + P entire V-SPAM model, including both filtering and pooling components. Figure 6: V-SPAM model. The fMRI voxel response is modeled as the summation of nonlinear functions of complex and pooled-complex cell outputs. The connections and components in the dashed region are to be estimated from the data under the assumption that many of them are null. 4.1 Data description The data set analyzed in this paper consists of a total of 1,294 voxels recorded from area V1 of one human observer. A 4T Varian MRI scanner provided voxels of size 2mm x 2mm x 2.5mm degree grayscale natural images, masked by a circular aperture. A two-stage procedure was used for This data set was used to fit the model. In the second stage, 120 additional natural images were presented 13 times each. This data set was used for model validation. (Note that the images used for estimation and validation were distinct.) In all cases images were flashed briefly 3 times during a 1 second display period, and there was a blank period of 3 seconds between successive images. After acquisition the fMRI signals were pre-processed to reduce temporal non-stationarity and increase signal-to-noise [5]. Complete details of the fMRI experiment can be found in [5]. 4.2 V-SPAM model fitting 1,750 images and the evoked fMRI responses. The fitting procedure can be conceptualized in four successive stages that roughly parallel the hierarchical layers of the model itself. In the first stage, the model complex cell outputs are computed according to equation (2) using a pyramid (or family) of Gabor wavelets sampled on a grid of 128 x 128 pixels. The pyramid includes  X  the wavelets are positioned evenly on a  X   X   X  grid covering the image. All combinations of 8 orientations and 2 phases occur at each of the  X   X   X  positions. In total, the pyramid consists of 10,920 quadrature pairs plus 1 constant wavelet (corresponding to mean luminance).
 In the second stage, the model complex cell outputs are pre-screened in order to eliminate complex cell outputs that are unrelated to a voxel X  X  response, and to reduce the computational complexity of successive stages of fitting. This is accomplished by considering the squared-correlation of the response of each complex cell with the evoked voxel response, using the 1,750 images in the training set. Only the top k complex cells are retained. In pilot studies we found empirically that k = 100 was enough to give good statistical and computational performance (data not shown). In the third stage, pooled-complex cells (see Section 3) are formed from the complex cell outputs that passed the pre-screening in fitting stage 2.
 In the fourth and final stage, the complex and pooled-complex cell responses to the images in the to fit the voxel responses evoked by the same 1,750 images in the training set. The smoothing is done by means of Gaussian kernel regression with plug-in bandwidth, and the regularization parameter is selected by the Akaike information criterion (AIC). 4.3 Model validation For each voxel, we evaluate the fitted V-SPAM models by computing the predictive R correlation) of the predicted and actual fMRI responses evoked by each of the 120 images in the validation set.
 To permit a more complete evaluation of the V-SPAM model, we used the same data to fit a simpler model more directly comparable to the one used in earlier work with this data set [5]. The sparse linear pooling model aims to predict each voxel X  X  response as a linear combination of all 10,921 estimated complex cell outputs. This model has the form, Y ( I ) =  X  the X j ( I ) are the complex cell outputs estimated according to (2), with the p = 10 , 921 Gabor [1] with the stopping criterion determined by 5-fold cross-validation within the same data set. This model is a sparsified version of the one used in [5], and has comparable prediction performance. Figure 7 (left) shows a scatterplot comparing the performance of the V-SPAM model with that of the sparse linear pooling model for all 1,294 voxels. The vertical axis gives performance of the V-SPAM model, and the horizontal axis the sparse linear pooling model. Each point corresponds to a single voxel. The inset region contains 429 voxels for which both models had some predictive power ( R 2  X  0 . 1 ). For these voxels, the relative improvement of the V-SPAM model over the sparse linear pooling model is shown in the histogram to the right. The predictions of the V-SPAM model were on average 14% better than those of the sparse linear pooling model (standard deviation 17%). 5.1 Estimated receptive fields and tuning curves Figure 8 shows the spatial receptive-fields (RF X  X ) and joint frequency and orientation tuning curves estimated using the V-SPAM model for 3 voxels. These voxels were chosen because they had high accurately. The upper row of the figure shows the spatial RF of each voxel. The intensity at each Figure 7: Predictive R 2 of the fitted V-SPAM model compared against the fitted sparse linear pooling model. (Left) Each of the 1,294 points in the scatterplot corresponds to a single voxel. (Right) Relative performance for the 429 voxels contained in the inset region on the left. location in the spatial RF represents the standardized predicted response of the voxel to an image stimulus consisting of a single pixel at that location. The spatial RF X  X  of these voxels are clearly localized in space, consistent with the known retinotopic organization of V1 and previous fMRI results [9]. The lower row of Figure 8 shows the joint frequency and orientation tuning properties of these same 3 voxels. Here the tuning curves were estimated by computing the predicted response of the fitted voxel model to cosine gratings of varying orientation (degrees) and spatial frequency tuning of all 3 voxels appears to be non-separable (i.e. their orientation tuning is not a constant function of frequency). Figure 8: (upper) Spatial receptive-fields (RF X  X ) and (lower) joint frequency and orientation tuning curves estimated by the V-SPAM model for 3 voxels with high predictive power ( R 0.63, left to right). Each location in the spatial RF shows the standardized predicted response of standardized predicted response of the voxel to cosine gratings of varying orientation (degrees) and spatial frequency (cycles/field of view). 5.2 Nonlinearities One of the potential advantages of the V-SPAM model over other approaches is that it can reveal novel nonlinear tuning and pooling properties, as revealed by the nonlinear summation occurring in the final stage of the V-SPAM model. Figure 9 illustrates some of these functions estimated for a typical voxel with high predictive power ( R 2 of 0.63). These correspond to the nonlinearities appearing in the final stage of the V-SPAM model (see Figure 6). Here the horizontal axis is the input in standard units of the corresponding model complex or pooled-complex cell outputs, and 4 largest (ranked by L 2 norm) nonlinearities. All 4 of these nonlinearities are compressive. The remaining 75 nonlinearities present in the voxel X  X  fitted model have similar shapes, but are much smaller and hence contribute less to the predicted response. They are overlaid in the final panel of Figure 9. Figure 9: Nonlinearities estimated in the V-SPAM model for a voxel with high predictive power ( R 2 : 0.63). The 4 largest (ranked by L 2 norm) are shown left to right by the thick lines. The other 75 nonlinearities for this voxel (overlaid in the right panel) are smaller and contribute less to the predicted response. Our V-SPAM model provides better predictions of fMRI activity evoked by natural images than predictive power of the V-SPAM model reflects the fact that it can describe explicitly the nonlinear pooling that likely occurs among the many neurons whose pooled activity contributes to measured fMRI signals. These pooled output nonlinearities are likely a critical component of nonlinear com-putation across the visual hierarchy. Therefore, the SpAM framework may be particularly useful for modeling neurons or fMRI signals recorded in higher and more nonlinear stages of visual processing beyond V1.

