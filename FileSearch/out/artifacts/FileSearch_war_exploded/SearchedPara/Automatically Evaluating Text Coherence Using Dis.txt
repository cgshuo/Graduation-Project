 The coherence of a text is usually reflected by its dis-course structure and relations. In Rhetorical Struc-ture Theory (RST), Mann and Thompson (1988) ob-served that certain RST relations tend to favor one of two possible canonical orderings. Some rela-tions ( e.g. , Concessive and Conditional) favor ar-ranging their satellite span before the nucleus span. In contrast, other relations ( e.g. , Elaboration and Ev-idence) usually order their nucleus before the satel-lite. If a text that uses non-canonical relation order-ings is rewritten to use canonical orderings, it often improves text quality and coherence.

This notion of preferential ordering of discourse relations is observed in natural language in general, and generalizes to other discourse frameworks aside from RST. The following example shows a Contrast relation between the two sentences. Here the second sentence provides contrasting infor-mation to the first. If this order is violated without rewording ( i.e. , if the two sentences are swapped), it produces an incoherent text (Marcu, 1996).

In addition to the intra-relation ordering, such preferences also extend to inter-relation ordering: The second sentence above provides a contrast to the previous sentence and an explanation for the next one. This pattern of Contrast-followed-by-Cause is rather common in text (Pitler et al., 2008). Ordering the three sentences differently results in incoherent, cryptic text.

Thus coherent text exhibits measurable prefer-ences for specific intra-and inter-discourse relation ordering. Our key idea is to use the converse of this phenomenon to assess the coherence of a text. In this paper, we detail our model to capture the coher-ence of a text based on the statistical distribution of the discourse structure and relations. Our method specifically focuses on the discourse relation transi-tions between adjacent sentences, modeling them in a discourse role matrix.
Our study makes additional contributions. We im-plement and validate our model on three data sets, which show robust improvements over the current state-of-the-art for coherence assessment. We also provide the first assessment of the upper-bound of human performance on the standard task of distin-guishing coherent from incoherent orderings. To the best our knowledge, this is also the first study in which we show output from an automatic discourse parser helps in coherence modeling. The study of coherence in discourse has led to many linguistic theories, of which we only discuss algo-rithms that have been reduced to practice.

Barzilay and Lapata (2005; 2008) proposed an entity-based model to represent and assess local tex-tual coherence. The model is motivated by Center-ing Theory (Grosz et al., 1995), which states that subsequent sentences in a locally coherent text are likely to continue to focus on the same entities as in previous sentences. Barzilay and Lapata op-erationalized Centering Theory by creating an en-tity grid model to capture discourse entity transi-tions at the sentence-to-sentence level, and demon-strated their model X  X  ability to discern coherent texts from incoherent ones. Barzilay and Lee (2004) pro-posed a domain-dependent HMM model to capture topic shift in a text, where topics are represented by hidden states and sentences are observations. The global coherence of a text can then be summarized by the overall probability of topic shift from the first sentence to the last. Following these two directions, Soricut and Marcu (2006) and Elsner et al. (2007) combined the entity-based and HMM-based models and demonstrated that these two models are comple-mentary to each other in coherence assessment.
Our approach differs from these models in that it introduces and operationalizes another indicator of discourse coherence, by modeling a text X  X  dis-course relation transitions. Karamanis (2007) has tried to integrate local discourse relations into the Centering-based coherence metrics for the task of information ordering, but was not able to obtain im-provement over the baseline method, which is partly due to the much smaller data set and the way the discourse relation information is utilized in heuristic constraints and rules.

To implement our proposal, we need to identify the text X  X  discourse relations. This task, discourse parsing , has been a recent focus of study in the nat-ural language processing (NLP) community, largely enabled by the availability of large-scale discourse annotated corpora (Wellner and Pustejovsky, 2007; Elwell and Baldridge, 2008; Lin et al., 2009; Pitler et al., 2009; Pitler and Nenkova, 2009; Lin et al., 2010; Wang et al., 2010). The Penn Discourse Tree-bank (PDTB) (Prasad et al., 2008) is such a cor-pus which provides a discourse-level annotation on top of the Penn Treebank, following a predicate-argument approach (Webber, 2004). Crucially, the PDTB provides annotations not only on explicit ( i.e. , signaled by discourse connectives such as because ) discourse relations, but also implicit ( i.e. , inferred by readers) ones. To utilize discourse relations of a text, we first ap-ply automatic discourse parsing on the input text. While any discourse framework, such as the Rhetor-ical Structure Theory (RST), could be applied in our work to encode discourse information, we have cho-sen to work with the Discourse Lexicalized Tree Ad-joining Grammar (D-LTAG) by Webber (2004) as embodied in the PDTB, as a PDTB-styled discourse become freely available.

This parser tags each explicit/implicit relation with two levels of relation types. In this work, we utilize the four PDTB Level-1 types: Temporal (Temp), Contingency (Cont), Comparison (Comp), and Expansion (Exp). This parser automatically identifies the discourse relations, labels the argu-ment spans, and classifies the relation types, includ-ing identifying common entity and no relation (En-tRel and NoRel) as types.

A simple approach to directly model the connec-tions among discourse relations is to use the se-quence of discourse relation transitions. Text (2) in Section 1 can be represented by S S , for instance, when we use Level-1 types. In such a basic approach, we can compile a distribu-tion of the n-gram discourse relation transition se-quences in gold standard coherent text, and a similar one for incoherent text. For example, the above text would generate the transition bigram Comp  X  Cont. We can build a classifier to distinguish one from the other through learned examples or using a suitable distribution distance measure ( e.g. , KL Divergence).
In our pilot work where we implemented such a basic model with n-gram features for relation tran-sitions, the performance was very poor. Our analy-sis revealed a serious shortcoming: as the discourse relation transitions in short texts are few in num-ber, we have very little data to base the coherence judgment on. However, when faced with even short text excerpts, humans can distinguish coherent texts from incoherent ones, as exemplified in our exam-ple texts. The basic approach also does not model the intra-relation preference. In Text (1), a Com-parison (Comp) relation would be recorded between the two sentences, irregardless of whether S comes first. However, it is clear that the ordering of (
S The central problem with the basic approach is in its sparse modeling of discourse relations. In develop-ing an improved model, we need to better exploit the discourse parser X  X  output to provide more circum-stantial evidence to support the system X  X  coherence decision.

In this section, we introduce the concept of a dis-course role matrix which aims to capture an ex-panded set of discourse relation transition patterns. We describe how to represent the coherence of a text with its discourse relations and how to transform such information into a matrix representation. We then illustrate how we use the matrix to formulate a preference ranking problem. 4.1 Discourse Role Matrix Figure 1 shows a text and its gold standard PDTB discourse relations. When a term appears in a dis-course relation, the discourse role of this term is defined as the discourse relation type plus the argu-ment span in which the term is located ( i.e. , the argu-ment tag). For instance, consider the term  X  X ananea X  in the first relation. Since the relation type is a Comparison and  X  X ananea X  is found in the Arg1 span, the discourse role of  X  X ananea X  is defined as Comp.Arg1. When terms appear in different rela-tions and/or argument spans, they obtain different discourse roles in the text. For instance,  X  X ananea X  plays a different discourse role of Temp.Arg1 in the third relation in Figure 1. In the fourth relation, since  X  X ananea X  appears in both argument spans, it has two additional discourse roles, Exp.Arg1 and Exp.Arg2. The discourse role matrix thus represents the different discourse roles of the terms across the continuous text units. We use sentences as the text units, and define terms to be the stemmed forms of the open class words: nouns, verbs, adjectives, and adverbs. We formulate the discourse role matrix such that it encodes the discourse roles of the terms across adjacent sentences.

Table 1 shows a fragment of the matrix represen-tation of the text in Figure 1. Columns correspond to the extracted terms; rows, the contiguous sentences. A cell C roles of the term T example, the term  X  X ananea X  from S the first relation, so the cell C role Comp.Arg1. A cell may be empty ( nil , as in C in C the second, third, and fourth relations). Given these discourse relations, building the matrix is straight-forward: we note down the relations that a term T from a sentence S course roles in the respective cell.

We hypothesize that the sequence of discourse role transitions in a coherent text provides clues that distinguish it from an incoherent text. The discourse role matrix thus provides the foundation for com-puting such role transitions, on a per term basis. In fact, each column of the matrix corresponds to a lexical chain (Morris and Hirst, 1991) for a partic-ular term across the whole text. The key differences from the traditional lexical chains are that our chain nodes X  entities are simplified (they share the same stemmed form, instead being connected by WordNet relations), but are further enriched by being typed with discourse relations.

We compile the set of sub-sequences of discourse role transitions for every term in the matrix. These transitions tell us how the discourse role of a term varies through the progression of the text. For in-stance,  X  X ananea X  functions as Comp.Arg1 in S Comp.Arg2 in S and Exp.Arg2 in S have six relation types (Temp(oral), Cont(ingency), Comp(arison), Exp(ansion), EntRel and NoRel) and two argument tags (Arg1 and Arg2) for each type, we have a total of 6  X  2 = 12 possible dis-course roles, plus a nil value. We define a dis-course role transition as the sub-sequence of dis-course roles for a term in multiple consecutive sen-tences. For example, the discourse role transition of  X  X ananea X  from S cell may contain multiple discourse roles, a transi-tion may produce multiple sub-sequences. For ex-ample, the length 2 sub-sequences for  X  X ananea X  from S Temp.Arg1  X  Exp.Arg2, and Exp.Arg1  X  Exp.Arg2.
Each sub-sequence has a probability that can be computed from the matrix. To illustrate the calcu-lation, suppose the matrix fragment in Table 1 is the entire discourse role matrix. Then since there are in total 25 length 2 sub-sequences and the sub-sequence Comp.Arg2  X  Exp.Arg2 has a count of two, its probability is 2 / 25 = 0 . 08 . A key prop-erty of our approach is that, while discourse tran-sitions are captured locally on a per-term basis, the probabilities of the discourse transitions are aggre-gated globally, across all terms. We believe that the overall distribution of discourse role transitions for a coherent text is distinguishable from that for an in-coherent text. Our model captures the distributional differences of such sub-sequences in coherent and incoherent text in training to determine an unseen text X  X  coherence. To evaluate the coherence of a text, we extract sub-sequences with various lengths from the sub-sequence probabilities as the feature values.
To further refine the computation of the sub-sequence distribution, we follow (Barzilay and La-pata, 2005) and divide the matrix into a salient ma-trix and a non-salient matrix. Terms (columns) with a frequency greater than a threshold form the salient matrix, while the rest form the non-salient matrix. The sub-sequence distributions are then calculated separately for these two matrices. 4.2 Preference Ranking While some texts can be said to be simply coherent or incoherent, often it is a matter of degree. A text can be less coherent when compared to one text, but more coherent when compared to another. As such, since the notion of coherence is relative, we feel that coherence assessment is better represented as a ranking problem rather than a classification prob-lem. Given a pair of texts, the system ranks them based on how coherent they are. Applications of such a system include differentiating a text from its permutation ( i.e. , the sentence ordering of the text is shuffled) and identifying a more well-written es-say from a pair. Such a system can easily generalize from pairwise ranking into listwise, suitable for the ordinal ranking of a set of texts. Coherence scoring equations can also be deduced (Lapata and Barzilay, 2005) from such a model, yielding coherence scores.
To induce a model for preference ranking, we use the preference ranking configuration for training and testing. All parameters are set to their default values. We evaluate our coherence model on the task of text ordering ranking , a standard coherence evaluation task used in both (Barzilay and Lapata, 2005) and (Elsner et al., 2007). In this task, the system is asked to decide which of two texts is more coherent. The pair of texts consists of a source text and one of its permutations ( i.e. , the text X  X  sentence order is randomized). Assuming that the original text is al-ways more discourse-coherent than its permutation, an ideal system will prefer the original to the per-muted text. A system X  X  accuracy is thus the number of times the system correctly chooses the original divided by the total number of test pairs.

In order to acquire a large data set for training and testing, we follow the approach in (Barzilay and La-pata, 2005) to create a collection of synthetic data from Wall Street Journal (WSJ) articles in the Penn Treebank. All of the WSJ articles are randomly split into a training and a testing set; 40 articles are held out from the training set for development. For each article, its sentences are permuted up to 20 times to paired with its source text to form a pair.

We also evaluate on two other data collections (cf. Table 2), provided by (Barzilay and Lapata, 2005), for a direct comparison with their entity-based model. These two data sets consist of Associ-ated Press articles about earthquakes from the North American News Corpus, and narratives from the Na-tional Transportation Safety Board. These collec-tions are much smaller than the WSJ data, as each training/testing set contains only up to 100 source articles. Similar to the WSJ data, we construct pairs by permuting each source article up to 20 times.
Our model has two parameters: (1) the term fre-quency (TF) that is used as a threshold to iden-tify salient terms, and (2) the lengths of the sub-sequences that are extracted as features. These pa-rameters are tuned on the development set, and the best ones that produce the optimal accuracy are TF &gt; = 2 and lengths of the sub-sequences &lt; = 3.
We must also be careful in using the automatic discourse parser. We note that the discourse parser of Lin et al. (2010) comes trained on the PDTB, which provides annotations on top of the whole WSJ data. As we also use the WSJ data for evaluation, we must avoid parsing an article that has already been used in training the parser to prevent training on the test data. We re-train the parser with 24 WSJ sections and use the trained parser to parse the sen-tences in our WSJ collection from the remaining section. We repeat this re-training/parsing process for all 25 sections. Because the Earthquakes and Accidents data do not overlap with the WSJ training data, we use the parser as distributed to parse these two data sets. Since the discourse parser utilizes paragraph boundaries but a permuted text does not have such boundaries, we ignore paragraph bound-aries and treat the source text as if it has only one paragraph. This is to make sure that we do not give the system extra information because of this differ-ence between the source and permuted text. 5.1 Human Evaluation While the text ordering ranking task has been used in previous studies, two key questions about this task have remained unaddressed in the previous work: (1) to what extent is the assumption that the source text is more coherent than its permutation correct? and (2) how well do humans perform on this task? The answer to the first is needed to validate the cor-rectness of this synthetic task, while the second aims to obtain the upper bound for evaluation. We con-duct a human evaluation to answer these questions.
We randomly select 50 source text/permutation pairs from each of the WSJ, Earthquakes, and Ac-cidents training sets. We observe that some of the source texts have formulaic structures in their ini-tial sentences that give away the correct ordering. Sources from the Earthquakes data always begin with a headline sentence and a location-newswire sentence, and many sources from the Accidents data start with two sentences of  X  X his is preliminary . . . errors. Any errors . . . completed. X  We remove these sentences from the source and permuted texts, to avoid the subjects judging based on these clues in-stead of textual coherence. For each set of 50 pairs, we assigned two human subjects (who are not au-thors of this paper) to perform the ranking. The sub-jects are told to identify the source text from the pair. When both subjects rank a source text higher than its permutation, we interpret it as the subjects agreeing that the source text is more coherent than the permu-tation. Table 3 shows the inter-subject agreements.
While our study is limited and only indicative, we conclude from these results that the task is tractable. Also, since our subjects X  judgments correlate highly with the gold standard, the assumption that the orig-inal text is always more coherent than the permuted text is supported. Importantly though, human per-formance is not perfect, suggesting fair upper bound limits on system performance. We note that the Ac-cidents data set is relatively easier to rank, as it has a higher upper bound than the other two. 5.2 Baseline Barzilay and Lapata (2005) showed that their entity-based model is able to distinguish a source text from its permutation accurately. Thus, it can serve as a good comparison point for our discourse relation-based model. We compare against their Syn-tax+Salience setting. Since they did not automat-ically determine the coreferential information of a permuted text but obtained that from its correspond-ing source text, we do not perform automatic coref-erence resolution in our reimplementation of their system. For fair comparison, we follow their experi-ment settings as closely as possible. We re-use their Earthquakes and Accidents dataset as is, using their exact permutations and pre-processing. For the WSJ data, we need to perform our own pre-processing, sentence segmentation and constituent parsing, fol-lowed by entity extraction. 5.3 Results We perform a series of experiments to answer the following four questions: 1. Does our model outperform the baseline? 2. How do the different features derived from us-3. Can the combination of the baseline and our 4. How does system performance of these models
Baseline results are shown in the first row of Ta-ble 4. The results on the Earthquakes and Accidents data are quite similar to those published in (Barzilay and Lapata, 2005) (they reported 83.4% on Earth-quakes and 89.7% on Accidents), validating the cor-rectness of our reimplementation of their method.
Row 2 in Table 4 shows the overall performance of the proposed refined model, answering Question 1. The model setting of Type+Arg+Sal means that the model makes use of the discourse roles consist-ing of 1) relation types and 2) argument tags ( e.g. , the discourse role Comp.Arg2 consists of the type Comp(arison) and the tag Arg2), and 3) two dis-tinct feature sets from salient and non-salient terms. Comparing these accuracies to the baseline, our model significantly outperforms the baseline with p &lt; 0 . 01 in the WSJ and Earthquakes data sets with accuracy increments of 2.35% and 2.91%, re-spectively. In Accidents, our model X  X  performance is slightly lower than the baseline, but the difference is not statistically significant.

To answer Question 2, we perform feature abla-tion testing. We eliminate each of the information sources from the full model. In Row 3 , we first delete relation types from the discourse roles, which causes discourse roles to only contain the argument tags. A discourse role such as Comp.Arg2 becomes Arg2 after deleting the relation type. Comparing Row 3 to Row 2, we see performance reductions on the Earthquakes and Accidents data after eliminat-ing type information. Row 4 measures the effect of omitting argument tags (Type+Sal). In this setting, the discourse role Comp.Arg2 reduces to Comp. We see a large reduction in performance across all three data sets. This model is also most similar to the ba-sic na  X  X ve model in Section 3. These results suggest that the argument tag information plays an impor-tant role in our discourse role transition model. Row 5 omits the salience information (Type+Arg), which also markedly reduces performance. This result sup-ports the use of salience, in line with the conclusion drawn in (Barzilay and Lapata, 2005).

To answer Question 3, we train and test a com-bined model using features from both the baseline and our model (shown as Row 6 in Table 4). The entity-based model of Barzilay and Lapata (2005) connects the local entity transition with textual co-herence, while our model looks at the patterns of discourse relation transitions. As these two models focus on different aspects of coherence, we expect that they are complementary to each other. The com-bined model in all three data sets gives the highest performance in comparison to all single models, and it significantly outperforms the baseline model with p &lt; 0 . 01 . This confirms that the combined model is linguistically richer than the single models as it inte-grates different information together, and the entity-based model and our model are synergistic.

To answer Question 4, when compared to the hu-man upper bound (Table 3), the performance gaps for the baseline model are relatively large, while those for our full model are more acceptable in the WSJ and Earthquakes data. For the combined model, the error rates are significantly reduced in all three data sets. The average error rate reduc-tions against 100% are 9.57% for the full model and 26.37% for the combined model. If we compute the average error rate reductions against the human up-per bounds (rather than an oracular 100%), the aver-age error rate reduction for the full model is 29% and that for the combined model is 73%. While these are only indicative results, they do highlight the signifi-cant gains that our model is making towards reach-ing human performance levels.

We further note that some of the permuted texts may read as coherently as the original text. This phe-nomenon has been observed in several natural lan-guage synthesis tasks such as generation and sum-marization, in which a single gold standard is inade-quate to fully assess performance. As such, both au-tomated systems and humans may actually perform better than our performance measures indicate. We leave it to future work to measure the impact of this phenomenon. When we compare the accuracies of the full model in the three data sets (Row 2), the accuracy in the Accidents data is the highest (89.38%), followed by that in the WSJ (88.06%), with Earthquakes at the lowest (86.50%). To explain the variation, we exam-ine the ratio between the number of the relations in the article and the article length ( i.e. , number of sen-tences). This ratio is 1.22 for the Accidents source articles, 1.2 for the WSJ, and 1.08 for Earthquakes. The relation/length ratio gives us an idea of how of-ten a sentence participates in discourse relations. A high ratio means that the article is densely intercon-nected by discourse relations, and may make dis-tinguishing this article from its permutation easier compared to that for a loosely connected article.
We expect that when a text contains more dis-course relation types ( i.e. , Temporal, Contingency, Comparison, Expansion) and less EntRel and NoRel types, it is easier to compute how coherent this text is. This is because compared to EntRel and NoRel, these four discourse relations can combine to pro-duce meaningful transitions, such as the example Text (2). To examine how this affects performance, we calculate the average ratio between the number of the four discourse relations in the permuted text and the length for the permuted text. The ratio is 0.58 for those that are correctly ranked by our sys-tem, and 0.48 for those that are incorrectly ranked, which supports our hypothesis.
 We also examined the learning curves for our Type+Arg+Sal model, the baseline model, and the combined model on the data sets, as shown in Fig-ure 2(a) X 2(c). In the WSJ data, the accuracies for all three models increase rapidly as more pairs are added to the training set. After 2,000 pairs, the in-crease slows until 8,000 pairs, after which the curve is nearly flat. From the curves, our model consis-tently performs better than the baseline with a signif-icant gap, and the combined model also consistently and significantly outperforms the other two. Only about half of the total training data is needed to reach optimal performance for all three models. The learn-ing curves in the Earthquakes data show that the per-formance for all models is always increasing as more training pairs are utilized. The Type+Arg+Sal and combined models start with lower accuracies than the baseline, but catch up with it at 1,000 and 400 pairs, respectively, and consistently outperform the baseline beyond this point. On the other hand, the learning curves for the Type+Arg+Sal and baseline models in Accidents do not show any one curve con-sistently better than the other: our model outper-forms in the middle segment but underperforms in the first and last segments. The curve for the com-bined model shows a consistently significant gap be-tween it and the other two curves after the point at 400 pairs.

With the performance of the model as it is, how can future work improve upon it? We point out one weakness that we plan to explore. We use the full Type+Arg+Sal model trained on the WSJ training data to test Text (2) from the introduction. As (2) has 3 sentences, permuting it gives rise to 5 permu-tations. The model is able to correctly rank four of these 5 pairs. The only permutation it fails on is ( S moved to the beginning. A very good clue of co-herence in Text (2) is the explicit Comp relation between S (
S tinguish this ordering from the source. In contrast, as this clue is not present in the other four permuta-tions, it is easier to distinguish them as incoherent. By modeling longer range discourse relation transi-tions, we may be able to discern these two cases.
While performance on identifying explicit dis-course relations in the PDTB is as high as 93% (Pitler et al., 2008), identifying implicit ones has been shown to be a difficult task with accuracy of 40% at Level-2 types (Lin et al., 2009). As the overall performance of the PDTB parser is still less accurate than we hope it to be, we expect that our proposed model will give better performance than it does now, when the current PDTB parser perfor-mance is improved. We have proposed a new model for discourse co-herence that leverages the observation that coherent texts preferentially follow certain discourse struc-tures. We posit that these structures can be cap-tured in and represented by the patterns of discourse relation transitions. We first demonstrate that sim-ply using the sequence of discourse relation tran-sition leads to sparse features and is insufficient to distinguish coherent from incoherent text. To ad-dress this, our method transforms the discourse re-lation transitions into a discourse role matrix. The matrix schematically represents term occurrences in text units and associates each occurrence with its discourse roles in the text units. In our approach, n-gram sub-sequences of transitions per term in the discourse role matrix then constitute the more fine-grained evidence used in our model to distinguish coherence from incoherence.

When applied to distinguish a source text from a sentence-reordered permutation, our model sig-nificantly outperforms the previous state-of-the-art, the entity-based local coherence model. While the entity-based model captures repetitive mentions of entities, our discourse relation-based model gleans its evidence from the argumentative and discourse structure of the text. Our model is complementary to the entity-based model, as it tackles the same prob-lem from a different perspective. Experiments vali-date our claim, with a combined model outperform-ing both single models.

The idea of modeling coherence with discourse relations and formulating it in a discourse role ma-trix can also be applied to other NLP tasks. We plan to apply our methodology to other tasks, such as summarization, text generation and essay scoring, which also need to produce and assess discourse co-herence.

