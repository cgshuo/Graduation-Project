 Tuomo Korenius  X  Jorma Laurikkala  X  Martti Juhola  X  Kalervo J  X  arvelin
Abstract Search facilitated with agglomerative hierarchical clustering methods was studied in a collection of Finnish newspaper articles ( N = 53,893). To allow quick experiments, clustering was applied to a sample ( N = 5,000) that was reduced with principal components analysis. The dendrograms were heuristically cut to find an optimal partition, whose clusters were compared with each of the 30 queries to retrieve the best-matching cluster. The four-level relevance assessment was collapsed into a binary one by (A) considering all the relevant and (B) only the highly relevant documents relevant, respectively. Single linkage (SL) was the worst method. It created many tiny clusters, and, consequently, searches enabled with it had high precision and low recall. The complete linkage (CL), average linkage (AL), and Ward X  X  methods (WM) returned reasonably-sized clusters typically of 18 X 32 documents. Their recall (A: 27 X 52%, B: 50 X 82%) and precision (A: 83 X 90%, B: 18 X 21%) was higher than and comparable to those of the SL clusters, respectively. The AL and WM clustering had 1 X 8% better effectiveness than nearest neighbor searching (NN), and SL and CL were 1 X 9% less efficient that NN. However, the differences were statistically insignificant. When evaluated with the liberal assessment A, the results suggest that the AL and WM clustering offer better retrieval ability than NN. Assessment B renders the AL and WM clustering better than NN, when recall is considered more important than precision. The results imply that collections in the highly inflectional and agglutinative languages, such as Finnish, may be clustered as the collections in English, provided that documents are appropriately preprocessed.
Keywords Hierarchical clustering . Graded relevance . Finnish language components analysis 1. Introduction
Cluster analysis (Jain and Dubes 1988, Kaufman and Rousseeuw 1990, Sharma 1996, Everitt of documents, so that each object typically belongs to one group (or cluster) only and the union of the groups contains all the objects. Grouping should be such that objects within a particular group have higher associations between each other than between the objects of the other groups. Cluster analysis is a well-established method that has numerous applications in the areas of archaeology, astronomy, biology, medicine, market research, and psychiatry, among others (Willett 1988, Everitt et al. 2001). Cluster analysis is also considered as one of the unsupervised machine learning methods, which do not use class information in learning.
Supervised methods, such as the decision rule and tree generators (Mitchell 1997), build classification models from class labeled data. Since the composition and possibly the number of groups are in clustering unknown a priori , the supervised statistical and machine learning methods are fundamentally different from the cluster analysis technique. Both unsupervised and supervised methods have extensively been applied in information retrieval (Belew 2000,
Sebastiani 2002). Most of the cluster analysis research in the area of information retrieval has considered the clustering of documents (Willett 1988, Baeza-Yates and Ribeiro-Neto 1999), the clustering of terms Salton (1983), and query expansion (Baeza-Yates and Ribeiro-Neto 1999).

The aim of the present study was to improve search effectiveness by clustering documents with the hierarchical clustering methods. Because of the quadratic time and memory require-ments, the hierarchical clustering methods are ill-suited to highly dynamic tasks, which are common in modern information retrieval. However, the applications we are interested in are quite stationary and major real-time updates are not required. Therefore, accurate but computationally intensive methods are feasible. We selected the standard agglomerative hi-erarchical methods, because they have earlier been used in information retrieval and they are known to produce solutions of high quality (Willett 1988, El-Hamdouchi and Willett 1989).
Furthermore, since clustering was applied and evaluated in a novel context, we felt that these well-established methods were the safest choice.

We clustered a collection of Finnish newspaper articles (Kek  X  al  X  ainen 1999) and evaluated the search results with a graded relevance scale (Sormunen 2000, Kek  X  al  X  ainen and J  X  arvelin 2002) which judges documents as irrelevant or marginally, fairly, or highly relevant to a query.
To our knowledge, the present study is the first one where a Finnish document collection has been clustered. Finnish is very different from the major European languages, and, therefore, its characteristics need to be addressed. Moreover, it seems that earlier studies have not addressed graded relevance in the evaluation of cluster-based searches. The graded assessments allow fine-grained studies and comparisons of retrieval system performance. This is especially important in modern information retrieval where an abundance of information is available, but a user is interested in only the highly relevant information, which typically is only a fraction of all the relevant information. The traditional binary relevance assessment is liberal, because it does not quantify the degree of relevance, but merely informs whether a document documents have clearly different levels of relevance: A small piece of relevant information is hardly as valuable to a user as a document entirely of the topic, unless one is searching for a simple fact. However, graded relevance assessment has only recently been studied in a wider scale (Sormunen 2000, 2002, Voorhees 2001, Kek  X  al  X  ainen and J  X  arvelin 2002).
Since the clustering methods applied here were quite complex, the dimensions of the collection were reduced with the principal components analysis technique (Jolliffe 1986,
Sharma 1996, Rencher 2002). The hierarchical cluster structures were not used as search trees. Instead, they were cut with a heuristic rule and cluster-based searches were purely performed with the resulting partitions. It appears that this type of approach to facilitate the cluster-based search has rarely been studied earlier. Our results showed the average linkage and Ward X  X  methods better than the single and complete linkage techniques. The searches facilitated with these two methods were able to retrieve the relevant documents better than the conventional best-match search, and the retrieved clusters were reasonably large and of good quality. These results are encouraging and show that the hierarchical cluster analysis is useful in information retrieval, provided that the environment is not highly dynamic. The results also indicate that if the features of a compound-rich and highly agglutinative language are appropriately considered, document collections in these languages may be successfully clustered.

The study is organized as follows. In Section 2, the early and current document clustering research is reviewed. Then, the hierarchical clustering methods, techniques to identify the optimal partition, principal components analysis, and the retrieval performance evaluation are described in Section 3. In Section 4, the characteristics of the Finnish language are shortly discussed and the collection and its numerical representation are presented. The results are given in Section 5 and they are discussed in Section 6, where some conclusions are also drawn and possible future work is described. 2. Document clustering
Document clustering is based on the co-occurrence information in the documents. Usually the tf  X  idf term weights are used (Willett 1988, Salton 1989), but also other co-occurrence information may facilitate document clustering. For example, citations have been used to get insights into the literature of a field, and topical themes among WWW pages have been identified on the basis of links (Rasmussen 1992, Baeza-Yates and Ribeiro-Neto 1999). Since terms may be clustered using the documents where the terms co-occur (Salton 1983, Willett 1988), document and term clustering are closely related. A recent study by Slonim and Tishby (2000) describes a double clustering procedure which actually combines these two types of clustering. Original motivations for the clustering of documents were both the increased effectiveness and efficiency of retrieval. The argument on behalf the effectiveness is based on the van Rijsbergen X  X  cluster hypothesis which states that  X  X losely associated documents tend to be relevant to the same requests X  (van Rijsbergen 1980, p. 45). If the hypothesis is valid, the relationships between the document contents are captured by the document clusters and search is more effective, because the relevant and irrelevant clusters contain most of the relevant and irrelevant documents, respectively (Willett 1988). In addition, a search strategy that utilizes cluster structure is more efficient than the conventional exhaustive best-match search.

Most of the early clustering work in information retrieval was done with nonhierarchical methods due to the limited computing resources, but as increasingly efficient computers be-came available in the 1980s, the research concentrated on the hierarchical clustering methods (Rasmussen 1992). In retrospect, the experimental settings of the first clustering studies were unrealistic and their results too optimistic (Willett 1988). These studies involved mainly the
Cranfield collection, which is better suited to clustering than the collections available at the time, and tiny clusters characteristic to the single linkage method were considered as satisfac-tory search results. Studies with other collections and hierarchical methods showed that even if clustering was less successful than assumed, it could produce result sets both of sensible size and quality. However, the use of standard agglomerative hierarchical algorithms was found difficult in practice due to the running times of O ( N 2 of O ( N 2 ), where N is the number of documents (Willett 1988, Rasmussen 1992).
Undoubtedly, the intuitive appeal of search through the tree-like cluster structure was one reason behind the past popularity of the hierarchical methods in document clustering. The search can proceed in a tree in a top-down or bottom-up manner (Willett 1988, Salton 1989).
The top-down search enters the tree via its root or a node at a lower level, when top-level clusters do not differ enough. The query is then matched against the clusters (nodes) and the path of the higher similarity is selected until a stopping criterion is fulfilled. However, traversing the tree upwards from its base is a better approach, except in hierarchies built with the complete linkage algorithm (Willett 1988). Research started to move away from the cluster-based search in the early 1990s, when it was found only comparable to the simpler search methods. El-Hamdouchi and Willett (1989) showed in their careful comparison that the best-match search and the search enabled with the simple nearest neighbor clustering were usually better than four bottom-up search strategies. The popularity of the hierarchical methods declined further as Cutting et al. (1992) proposed a new paradigm which advocated the use of cluster analysis as a tool to browse large collections. Since on-line browsing requires fast responses to user X  X  actions, hierarchical methods were too slow for new applications. In addition, along with the growth of Internet, the size of a typical collection suddenly increased from a few thousands to tens of thousands documents.

The optimization techniques (Everitt et al. 2001), such as the k -means algorithm, have been the most popular nonhierarchical clustering methods in information retrieval (Rasmussen 1992). These methods produce a flat cluster structure known as the partition by optimizing some numerical criterion (Rasmussen 1992, Everitt et al. 2001). With running times of
O ( KN ), where K is the number of clusters, they can cluster large collections reasonably fast, provided that K N (Rasmussen 1992). Unfortunately, these methods often assume that the user guesses the optimal number of groups and supplies starting points (seeds). Since the grouping also depends on the order in which objects are processed, the partitions may markedly differ from one run to another. Optimization techniques are not free of the problems caused by high dimensionality either. Many of them utilize cluster representatives, which may not significantly differ from each other in high dimensional data, especially when the seeds are poorly chosen (Boley 1998, Nilsson 2002).

For these reasons, hybrid clustering schemes and new algorithms have been pre-sented. Buckshot and fractionation (Cutting et al. 1992) X  X he two Scatter/Gather clustering methods X  X re fast optimization algorithms of O ( KN ) which utilize the more accurate, but slower average linkage algorithm to find seeds of better quality. The principal direction di-visive partitioning algorithm (Boley 1998) and its non-greedy version (Nilsson 2002) are efficient methods that partition a collection in a divisive manner and produce a hierarchical tree structure which resembles the trees built by the hierarchical methods. Besides being fast, these methods have also the advantage of being deterministic, which the Scatter/Gather methods are not. 3. Methods 3.1. Hierarchical clustering
The single linkage, complete linkage, group average linkage, and Ward X  X  clustering methods (Jain and Dubes 1988, Rasmussen 1992, Everitt et al. 2001) were selected, because they are accurate and have often been applied in the cluster-based search studies (Willett 1988,
El-Hamdouchi and Willett 1989, Rasmussen 1992). Furthermore, it is advisable not to rely on one clustering method to avoid overly optimistic or pessimistic inferences (Everitt et al. 2001). The hierarchical methods are often classified as agglomerative and divisive , of which the agglomerative approach has been the more popular and a large number of applications requirements, the major drawback of the hierarchical clustering is the irreversibility of the fusions and divisions: Once two clusters have been fused, or one split, they cannot be later separated or merged (Everitt et al. 2001). The four methods studied here are agglomerative techniques which start from N clusters of individual objects and fuse pairs of clusters together until all the N objects are in the same cluster. Divisive methods operate in reverse direction by splitting the clusters until N single-member clusters have been produced. The hierarchical methods create a series of partitions P 1 , P 2 ,..., P N disjoint subsets A  X  B = X  , where A  X  P i , B  X  P i , P i
The agglomerative algorithms operate in a greedy and local manner. They merge at each stage a pair of clusters scored the best under some criterion which usually is a proximity (distance or similarity) measure. Therefore, the selection of an appropriate proximity measure is a central problem in applying the hierarchical methods. Measure unsuitable to the data may dramatically degrade the performance of a clustering method. The standard hierarchical methods store the proximities into a matrix and update them as clusters are fused. The iterative evaluation and updating of the pairwise cluster proximities requires at least O ( N the need to initially store proximities between all the objects explains the typical O ( N complexity. Proximity matrixes of the combinatorial methods may be updated without the original data using the Lance-Williams recurrence formula (Jain and Dubes 1988, Everitt et al. 2001). Only the proximity matrix is required to apply the formula in single and complete linkage, while to update the average linkage and Ward X  X  matrixes the cluster sizes are needed besides the proximities.

The consecutive fusions are represented with a tree structure known as the dendrogram which is a mathematical and visual presentation of the clustering process (Jain and Dubes 1988, Everitt et al. 2001). The internal nodes represent clusters, the terminal nodes (leaves) the N objects, and the edges between the nodes indicate which clusters were fused to produce a new cluster. The dendrograms of the present study were weighed: Their height indicates the distances between the fused pairs. Figure 1 shows the progress of the single linkage method when vectors (1, 1), (1, 2), (3, 2), and (4, 1) were clustered with the Euclidean distance. For example, the last cluster is at height 2, because the smallest distance between clusters
A ={ (1 , 1) , (1 , 2) } and B ={ (3 , 2) , (4 , 1) } was that between objects (1, 2) and (3, 2). The weighed dendrograms may also be inspected by considering only its levels, i.e. the order of the fusions. In Figure 1, levels 1, 2, and 3 refer to the first, second, and third fusion, respectively. 3.2. Choice of partition
Since searches utilizing the tree structure have not been found superior to simpler search strategies (El-Hamdouchi and Willett 1989), we decided to abandon the tree-based search and, instead, cut the trees at optimal height and used the resulting partitions to facilitate the cluster-based search. Selecting the optimal number of clusters is one of the central problems both in nonhierarchical and hierarchical cluster analysis (Everitt et al. 2001). A hierarchical cluster structure is converted into a partition by selecting one of the fusion or division levels of the structure, which is equivalent to  X  X utting X  the dendrogram at a particular height. One can visually inspect the dendrogram to find large changes in heights, which are taken to indicate the best level. This informal eyeballing approach, however, tends to be unfeasible with large data sets and is subject to a priori expectations. A number of formal methods to decide the best partition have been proposed, but their accuracy varies widely. Milligan and
Cooper (1985) found in their comparison of 30 procedures that although the best procedures worked fairly well, the worst performers functioned only slightly better than chance level. We applied the inconsistency (The Math Works Inc. 2002) and silhouette (Kaufman and
Rousseeuw 1990) coefficients to the dendrograms created by the hierarchical methods. Since the partitions identified with the inconsistency coefficient were better than those found with the silhouette coefficient (see Section 5), only the former is described here. The inconsistency coefficient is similar to the well-known Mojena upper tail rule (Milligan and Cooper 1985, inconsistency coefficient considers only some of the previous levels, while the Mojena rule considers them all. The inconsistency coefficient for the i th ( i level  X  i is c = where  X   X  z and  X  z are the respective mean and standard deviation of the heights of level the z highest fusion levels before it. It should be noted that the z heights are taken from the subtree rooted at the node of the i th level. Let the subtree contain l fusion levels. If 0 the l levels are considered, and when l = 0, the consistency coefficient is zero. Levels  X  1 are the first and last merging levels, respectively. Cutting the dendrogram at any height between level max( c i ) and the level of the subtree immediately before max( c partition with N  X  i + 1 clusters. Let us study Figure 1. Since l = 0 for subtrees of the two first levels, their coefficients are 0. If z = 2, the coefficient of the last level is (2 where  X   X  2  X  1 . 4714 and  X  2  X  0 . 5024 are the mean and standard deviation of heights 1, and 2. Therefore, the optimal number of clusters is two and cutting the tree at height] [produces clusters A and B.
 3.3. Principal components analysis
Principal components analysis (PCA) (Jolliffe 1986, Sharma 1996, Rencher 2002) is a mul-tivariate statistical method that forms new variables (principal components) which are linear combinations of the original variables. The geometrical interpretation of PCA in an M -dimensional space is straightforward: the original M axes X are rotated to the direction of the maximum variance to create M new axes X . The first new axis X where the first principal component, i.e. projections of data points onto X maximum of the total variance. Then, new axes are formed in the same manner using the variance which the previous principal components did not account for, until M new axes and their corresponding principal components have been created. The axes are orthogonal and the new variables uncorrelated with each other.

Popular approaches to facilitate PCA include finding the eigenstructure of the covariance matrix and solving the singular value decomposition (SVD) of the data set (Sharma 1996). Of these two approaches, SVD is computationally more efficient, because PCA is accomplished directly from the data without the need to build the covariance matrix. Both approaches require transformed data. Mean-corrected data is used, if it is assumed that the relative variances of the variables reflect their importance in forming new variables, while standardization of the original data allows weighing variables as equally important. The PCA solution is ideally such that the original variables have high correlations (loadings) with a small number of principal components, and few of the first principal components account for most of the variance of the data.

The PCA method may be seen as a tool that groups together correlated variables and, thus, helps the analysis of dependencies in data described with a large number variables. This analytical approach requires that one can successfully interpret the principal components using the loadings (Sharma 1996). On the other hand, PCA may be applied only to reduce the number of variables to facilitate analyses otherwise impossible due to processing time or memory limits. Dimension reduction is achieved by selecting K (1 principal components for further analysis. PCA is closely related to the latent semantic indexing (LSI) model which states that the ideas in a text are better captured by concepts than the index terms (Baeza-Yates and Ribeiro-Neto 1999, Belew 2000). Mapping of the document and query vectors into a lower dimensional space associated with the concepts is claimed to produce better retrieval performance than that of the original space. Dimension reduction is usually accomplished through the SVD technique. In this paper, we adopted purely the data reduction approach, and, thus, we neither attempt to interpret the principal components using the loadings, nor do we claim the improved retrieval levels as the LSI model does. Since it is known that dimension reduction often  X  X olishes X  data by removing some of its irregularities, such as noise, it is possible that the subspace may produce slightly better results than the original vector space. 3.4. Retrieval performance evaluation
The search capability of the cluster analysis methods was evaluated using the recall, precision, and effectiveness measures (Baeza-Yates and Ribeiro-Neto 1999, Belew 2000).

The effectiveness measure ( E ) combines recall ( R ) and precision ( P ) and allows their weighing with parameter  X &gt; 0:
E = 1  X  (1
Value of  X  indicates how many times more important recall is compared to precision. If  X  = 1, recall and precision are equally important. Recall is weighed more than precision, when  X &gt; 1 and vice versa. As the recall and precision measures, the effectiveness values are in [0, 1]. It should be noted that the effectiveness values are conversely interpreted to the recall and precision values. The small values indicate high effectiveness, while the large values are a sign of low effectiveness.

To calculate recall, precision, and the E-measure, the graded relevance assessment was binarized with two different approaches: (A) The relevant documents were weighed against the irrelevant ones, and (B) only the highly relevant documents were considered relevant, while all the other documents were labeled as irrelevant. In the following, we will name these relevance assessments in short as A and B, respectively. Statistical significance does not necessarily imply that the difference between methods is of practical importance (Keen 1992). Furthermore, relative differences only should not be reported, because they may be misleading. For these reasons, we use as a rule of thumb that the absolute differences in the results would be regarded as material if greater than 10%, noticeable if 5 X 10%, and not noticeable if smaller than 5% (Keen 1992). 4. Materials 4.1. The Finnish language and information retrieval
As one of the Finno-Ugrian languages, Finnish is very different from the Indo-European languages, such as the English language and the neighboring Indo-European languages, such as Swedish and Russian. Not surprisingly, the Finnish language has special characteristics which pose problems to the standard information retrieval methods developed for the pro-cessing of English. From the information retrieval viewpoint, the main problems are the various possibilities to inflect words and the abundance of compound words (Kek  X  al  X  ainen 1999, Alkula 2001). For example, each noun of the Finnish language has 15 cases, while
English as only the nominative and genitive. Several different endings indicating number, case, possession, modality, tense, person, and other morphological characteristics, may be affixed to word stems. By considering all theoretically possible combinations, each sub-count. Although in practice only some of the inflectional variants of each word are in a collection, it is obvious that indexing words without any preprocessing produces a large number of index entries and makes searching for any one of the different word forms demanding.

In highly agglutinative languages, such as Finnish or German, compound words are often spelled together. For example, the English compound word nuclear power plant is ydin-voimalaitos and atomkraftwerk in Finnish and German, respectively. The Dictionary of Mod-ern Finnish contains approximately 130,000 compound words which represent two-thirds of all the words in the dictionary. Finnish compound words are difficult for information re-trieval applications, because when included in the index as they are, searches using a part of a compound word are less likely to return documents containing the compound word. This problem is quite different from the challenge of phrase identification in English. It should be noted that because of the agglutinative nature of the Finnish language, the Finnish text documents may appear to be short. However, with an equal word count, a Finnish text tends to be content-wise longer than an equal-length English one, because compounds are spelled together, and, furthermore, because Finnish lacks prepositions and articles. 4.2. The collection
The collection contained 53,893 articles published in three Finnish newspapers in 1988 X  1992 (Kek  X  al  X  ainen 1999). The average article length was 233 words and paragraphs were typically made of two or three sentences. The articles were mainly of domestic and foreign affairs and economics. The collection was processed with Finnish morphological analysis programs (Kek  X  al  X  ainen 1999, Alkula 2001). The inflected words were transformed into their morphological basic forms so that for each word its basic form was included into index.
Some ambiguous words produced multiple basic form entities. The compound words were split into their parts, and the parts were further processed as the individual words. Split-improves recall. Some words, usually foreign proper names and typing errors, were not rec-ognized because of the dictionary-based morphological analysis (Kek  X  al  X  ainen 1999, Alkula 2001).

The relevance of 16,539 documents to 30 queries had earlier been assessed with a four-
These documents were judged as (0) irrelevant X  X he document was not about the topic of the query ( N = 14,588), (1) marginally relevant X  X he topic was mentioned ( N fairly relevant X  X he topic was discussed briefly ( N = 700), and (3) highly relevant X  X he topic was the main theme of the article ( N = 366). The articles were assessed by two experienced journalists and two information retrieval specialists. The relevance of documents to 20 queries was evaluated by two or three persons and the rest 10 queries by one person. The assessors agreed in 73% of the assessments. Differences of one point (21%) were solved by taking the assessment from each judge in turn, and the most plausible grade after reevaluation was selected, when differences of two or three points (6%) were settled. The remaining 37,353 documents were marked as irrelevant.

The length of relevant documents at all relevance levels exceeded the average length of 233 words, but the highly relevant documents were, on average, shorter (306 words) than the fairly or marginally relevant documents whose respective average lengths were 314 and 334 words (J  X  arvelin and Kek  X  al  X  ainen 2000). Highly relevant documents did not gain from higher document length in clustering because of the minor differences in average document lengths. 4.3. Numerical representation of text
The collection was represented as the N  X  M document-term matrix D for the clustering methods. As usual, the rows of the matrix correspond to the N documents (objects) which are characterized by the M terms (variables). The elements of each document vector d ( w i 1 ,w i 2 ,...,w iM ) are term weights computed according to the tf 1989): w ij = tf ij  X  ( id f j + 1) = tfi j  X  ln where tf ij is the frequency of the j th term in the i th document (1 and 1 is added to keep the weight greater than zero, when a term occurs in all the documents. The matrix representation takes quadratic space, but was convenient for us for two reasons.
Firstly, the standard statistical and matrix computation software for clustering and dimension reduction assume observation matrix representation. Secondly, this representation facilitates the easy use of the conventional vector space model which is popular in document clustering (Willett 1988, Salton 1989).

A sample of 5,000 documents was studied, because preliminary runs showed that the available hardware and software could process roughly 10% of the data fast enough to allow series of quick experiments. The sample contained 1,926 relevant documents, because 26 relevant documents were accidentally missed while taking the sample. The irrelevant docu-ments ( N = 3,074) of the sample were randomly selected among the graded and non-graded ones, because their degree of irrelevance may differ. The documents graded as irrelevant were retrieved, and, consequently, resembled more the relevant documents than the non-graded ir-relevant documents, which were not returned by the 30 queries. Therefore, using only graded irrelevant documents would have made the clustering task overly difficult, while clustering might have been too easy had solely non-graded irrelevant documents been used.

A pure random sampling would have been an inappropriate approach, because we espe-cially aimed to study the graded relevance assessments in the clustering. The random sample might have excluded, for example, all documents highly relevant to some query, while keep-ing the marginally and fairly relevant documents. This is likely, because seven out of the 30 queries had less than six highly relevant documents and because there were clearly more marginally (886/1,952  X  100%  X  45%) and fairly (36%) relevant documents than highly rele-vant ones (19%). Moreover, some smaller queries might have been lost totally, because none of the relevant document would have been sampled. Therefore, to virtually make the study possible, we had to include all relevant documents in the sample.

Although a typical collection does not have as many relevant documents as the sample, the large proportion of the relevant documents does not necessarily mean that the retrieval would be markedly easier than in the full collection. For each query, we hoped that on average 1,952/30  X  65 relevant documents would be brought together by the clustering methods. As in the full collection, this process is disturbed by two sets of documents: (A) roughly 1,900 documents that are relevant to the 29 other topics and (B) irrelevant documents, which are relevant to other topics than those in the current set of queries. The set A may be suspected under consideration, because they are relevant to another topic, which should reflect in their content, and because there were no topic overlaps. However, the document set A does not make the clustering task easier, quite the contrary. If one would start with set B and 65 relevant documents for topic S , and would then consider adding another set of 65 relevant documents for another topic T , the clustering task would not be easier than, but at least as difficult as before. The over 3,000 documents in the set B may be considered to be stronger random noise. If we assume the distribution of relevance levels similar in the sets A and
B , the relevant documents in B are mainly marginally and fairly relevant because of the random sampling. These less relevant documents are prone to affect the clustering of the set
A , because many the corresponding highly relevant documents were probably excluded from the sample.
 The dimension reduction and clustering were performed with the Matlab software on an
AlphaServer main frame of CSC X  X cientific Computing Ltd. The computer had four 64-bit processors and 12 GB memory. Running times were from half an hour, taken by the clustering, to several hours needed to compute the silhouette coefficient. Since the main frame batched the runs, the actual running times were somewhat shorter. After the unrecog-nized words were excluded, the sample contained 53,621 index terms which had the total of 1,821,326 occurrences. The final 5,000  X  13,693 document-term matrix was produced with further elimination of 773 words on a stoplist and 39,146 words that appeared in less than five documents. Preliminary tests with a smaller sample showed that exclusion of the most frequent and infrequent words had practically no effect on the clustering results. The matrix was constructed with Java programs written by the first author. 5. Results 5.1. Reduction and clustering of the sample
The mean-corrected and length-normalized sample was reduced with PCA which produced only 4,999 new non-zero variables. When the number of observations ( N than the number of variables ( M = 13,693), PCA creates N because a large number of columns of this type of matrix are linearly dependent (Horn and Johnson 1990). Unstandardized variables were used because of the same scale and equally-sized variances of the original variables. There are various methods to decide the number of principal components (Jolliffe 1986, Sharma 1996, Rencher 2002). One pop-ponent ( eigenvalue ) against the component numbers and look for an  X  X lbow X . Figure 2 shows such scree plot (Jolliffe 1986, Sharma 1996, Rencher 2002) for our data. It can be seen that there is no apparent elbow and the largest principal components account only world data analyses. Here the sparse matrix made the results even further different from the ideal solution: The large number of zero entries explains the small equally-sized vari-ances of both the original and new variables. Because of the missing elbow, we used an-other popular rule and selected the 1,500 largest principal components which accounted for 80% of the total variance (Jolliffe 1986, Rencher 2002). Through PCA we were able to conduct the hierarchical cluster analysis in space roughly nine times smaller than the original one.

To keep the clustering results of the original and reduced data as similar as possible, the clustering of new document vectors, i.e. the principal component score vectors, was performed using the Euclidean distance. Since mean-correction moves the data into origin, the angles between the vectors change, and, consequently, the cosine similarities between documents of the original and new data differ. If document vectors are normalized into the same length and the Euclidean distance is used in the clustering of the PCA results, the clustering results are exactly the same as those obtained with the original data and the cosine similarity measure, provided that the clustering method is invariant to order preserving proximity transformations. Korenius et al. (2004) discuss this matter in detail. Obviously, reduction of the data produces somewhat different result because part of information has been discarded.

The optimal partitions identified with the inconsistency coefficient for the single linkage, complete linkage, average linkage, and Ward X  X  methods had 3197 ( z ( z = 3), and 160 ( z = 3) clusters, respectively. When the respective dendrograms were cut at heights indicated by the silhouette coefficient, the partitions had 3652, 1755, 1455, and 1664 clusters. Although both methods had one maximum, several values nearly as large as the maxima made the solutions ambiguous. The coefficients agreed in single linkage, but for the other methods the inconsistency coefficient suggested levels closer to the root than the silhouette coefficient. Since reasonably large clusters are desirable, the solution given by the inconsistency coefficient was selected. Figure 3 presents the cluster size distributions, which were as expected. The single linkage method produced, due to the chaining effect (see e.g. Everitt et al. 2001), a few large and various singleton clusters, while the complete linkage method created many compact clusters. The average linkage method created more large clusters than the two former methods. The results of the Ward X  X  method differ from those of the other clustering methods. This method discovered many equally-sized large clusters. 5.2. Best cluster performance
To study the clustering behavior, we evaluated clusters that contained one or more relevant documents. The typical recall values of the single and complete linkage clusters were ex-tremely low (see Korenius et al. 2004). The subsequent tests showed that, as the typical complete linkage clusters, the typical average linkage and Ward X  X  method clusters had also low precision. However, all the methods produced also large clusters with reasonably good recall and precision values. To study the best performance of clustering methods closer, we had to first decide how to measure the goodness of a cluster. This was a difficult task for two reasons. Firstly, the relative importance of recall and precision is known to be highly task de-pendent (Salton 1989). Secondly, there were a number of clusters too small to be considered as useful search results. Since the small clusters had typically high precision, we chose to use recall as the goodness measure, because recall is a more honest measure of performance than precision when small clusters abound. If precision had been used, tiny clusters would have been considered better than large ones, which are preferable in information retrieval.
Table 1 shows statistics for the best cluster of each query according to recall with rel-evance assessment B. Since the recall and precision measures were clearly better than the typical results, we decided to pursue the research further despite the poor typical results.
It was also noteworthy that the best clusters contained fairly and marginally relevant doc-uments in addition to the highly relevant ones. The complete linkage, average linkage, and
Ward X  X  methods produced high recall and low precision values, while the single linkage method had low recall and high precision. This discrepancy was detected also with the typi-cal results (Korenius et al. 2004), because the single linkage characteristically produced tiny clusters.
 5.3. Comparison of the cluster analysis and nearest neighbor search results
The results reported in the previous section were quite good, but unrealistic since the optimal cluster is not necessarily the cluster that matches the query best (Willett 1988). Therefore, we implemented a simple cluster-based search engine for the evaluation of the clustering solution.
The cosine similarity between the query and the mean of each cluster was computed using the original data, and the cluster most similar to the query was returned to the user. This approach is even simpler than that of El-Hamdouchi and Willett (1989), because it does not make any use of the hierarchical cluster structure. We provide also nearest neighbor search results for the comparison purposes. Nearest neighbor (NN) is a well-known technique that allows the search and classification of objects (Mitchell 1997). The conventional exhaustive best-match search (Willett 1988), where documents are ranked in decreasing order by their similarity with the query, is in effect the popular NN search. The same number of documents as in the corresponding cluster was retrieved with the NN technique for each query.
Tables 2 X 5 depict statistics for the performance measures of the cluster-based and NN searches using relevance assessments A and B. The effectiveness measure is reported with  X  = 0 . 5 (precision twice as important as recall) and  X  = 2 (recall twice as important as precision). Since a large number of the documents retrieved with the cluster-based and NN searches were the same and the sample size ( N = 30) was small, the statistical significance of differences was assessed with the two-tailed Wilcoxon signed ranks test (Pett 1997) X  X  nonparametric alternative of the paired t test. In the following, the results are studied mainly by comparing medians that are a more appropriate central statistic than means for skew dis-tributions. Expectedly, the large differences in the median effectiveness showed the single linkage method clearly worse than the other methods. All the absolute differences, excluding those with relevance assessment B and  X  = 0 . 5, were large (21 X 47%) and statistically signif-icant at  X  = 0 . 05 ( p &lt; 0 . 03). Most of the differences between the complete linkage, average linkage, and Ward X  X  methods were insignificant. However, with relevance assessment A and  X  = 2, the absolute differences of 21% and 23% were significant ( p the average and Ward X  X  methods. Recall of both the clustering and NN methods was clearly lower with relevance assessment A than B, and precision of the both methods was clearly higher with assessment A than B.

Table 6 represents the absolute and relative differences in medians of the effectiveness mea-sures of the NN and cluster-based searches. For example, the absolute and relative differences between the NN and Ward X  X  method with relevance assessment A and 0.34)  X  100%  X  8% and (0.42 X 0.34)/0.42  X  100%  X  19%, respectively. The NN searches were equal or better than the single and complete linkage searches and equal or worse than the av-erage linkage and Ward X  X  searches. Unfortunately, nearly all the differences were statistically insignificant. The NN and single linkage searches with relevance assessment A and were significantly ( p &lt; 0 . 05) different even though the medians were the same. This result was an anomaly: Total of 21 value pairs was equal, and by chance eight of the extremely small ranked differences were for single linkage. As expected, the average linkage and Ward X  X  methods performed better in comparison to the NN search than the single linkage method. Table 7 shows the sizes the retrieved clusters and their ranks with assessments A and B.
Ranks for each query were obtained by observing the position of the retrieved cluster in the order created by sorting the clusters in decreasing order according to the number of documents relevant to the query. The simple cluster-based search strategy identified the best cluster, i.e. cluster with the largest number of relevant documents, surprisingly well. The retrieved single linkage clusters were clearly smaller (median 4.00) than those of the other methods, and the retrieved complete linkage clusters (median 18.00) smaller than the retrieved average linkage and Ward X  X  method clusters (medians 24.50 and 31.50). Many of the single linkage clusters did not contain any of the highly relevant documents. As with the best clusters, the relevant documents in the clusters were not only the highly relevant ones. The median percentage of the highly relevant documents in the retrieved single, complete, average linkage, and Ward X  X  method clusters were 40, 25, 24, and 21%, respectively.
 6. Discussion
A Finnish newspaper collection was clustered with four agglomerative hierarchical methods to facilitate cluster-based information retrieval. The collection was assessed into marginally, fairly, and highly relevant or irrelevant documents with respect to 30 queries. To allow appli-cation of the methods with the time complexity of O ( N 2 of O ( N 2 ), we focused on a sample of 5,000 documents that was further reduced utilizing principal components analysis (PCA). The reduced data were clustered with the single link-age, complete linkage, average linkage, and Ward X  X  methods, whose dendrograms were cut at optimal heights identified with the inconsistency coefficient. The resulting partitions were analyzed by studying the retrieval performance with two binarized relevance assessments. The cluster-based searches were also compared to the nearest neighbor (NN) searches.
Analysis of the clusters containing relevant documents produced discouraging results (see Korenius et al. 2004). However, the best clusters were reasonably large and had good retrieval levels (see Table 1). The typical best complete linkage, average linkage, and Ward X  X  cluster contained 62 X 77% of the relevant documents and 20 X 25% of their contents were relevant. The median effectiveness (  X  = 2) was 0.51 X 0.56. The imbalance between recall and precision was in expected direction, because recall was used as the goodness measure to take also into account the cluster size. The single linkage method behaved conversely to the other clustering methods studied here, because many of its clusters were expectedly small.
Consequently, the best single linkage clusters had low recall, high precision, and median effectiveness of 0.62 which showed single linkage to be an outlying method. Although initial results reported in Korenius et al. (2004) were poor, the best clustering results, and the finding that the highly relevant documents tended to cluster together with the less relevant ones, provided evidence on behalf of the validity of the cluster hypothesis in the collection studied.
As pointed out by Willett (1988), the problem in concentrating on the optimal clusters is that there is no guarantee that they will be retrieved. Since the best cluster results were obviously too optimistic, we built a simple cluster-based search engine to evaluate the retrieval assessments A and B, the retrieved best-matching clusters were always among the top five ranked clusters (see Table 7). Furthermore, most of the retrieved clusters were also the best clusters: More than 75% of the retrieved average linkage and Ward X  X  method clusters were ranked the first. These clusters were quite large with the respective median sizes of 24.50 and 31.50 documents. It is possible that using recall as the measure of goodness introduced some bias to our study: The ranks of the retrieved clusters might have been lower, if precision had also been considered. However, the retrieved clusters were of surprisingly good quality bearing in mind the straightforward manner the cluster-based search was performed.
These results are in accord with the results of El-Hamdouchi and Willett (1989), who found that the partition utilizing search was more effective than the four tree-based search strategies.
However, our approach to identify the optimal partition was not empirical but heuristic. To verify the decision based on the inconsistency coefficient, we evaluated systematically all coefficient, is able to identify a solution that is feasible in information retrieval. Obviously, enumerative evaluation is not even possible with many real-world collections, which do not have relevance assessments.
 As earlier, the single linkage results differed from those of the other clustering methods.
The significant differences showed the single linkage searches 21 X 45% less effective than the searches based on the complete linkage, average linkage, and Ward X  X  method results. Since the retrieved clusters were also small (median size 4.00), the single linkage was undoubtedly the worst of the clustering methods. Single linkage it is not discussed further, because the earlier studies of Willett (1988) and El-Hamdouchi and Willett (1989) support this conclusion.
Conversely to the results of Willett (1988), we found that the complete linkage method may be worse than the average linkage and Ward X  X  methods. With relevance assessment A, the respective absolute differences in effectiveness were ( 21% and 23%, while with assessment B the differences were ( (  X  = 2) 11% and 6%. However, only the largest differences of 21% and 23% showed the two methods significantly better than complete linkage. The effectiveness of the average linkage and Ward X  X  methods were better, because their recall was mostly clearly higher than that of complete linkage. The good performance of average linkage was consistent with the results of El-Hamdouchi and Willett (1989) which showed it the best of the four methods studied.
The comparison of the NN and cluster-based searches showed the two methods well-matched with a slight advantage to the searches facilitated by clustering. The NN searches were equal or better than searches based on the single and complete linkage clusters, and, on the other hand, the results were opposite when the performance of NN searches was compared to that of the average linkage and Ward X  X  methods. Total six out of the 16 differences in medians were of noticeable size, five for and one against the two clustering methods, but none of them was statistically significant (see Table 6). The search results were evaluated with the binarized relevance assessments A and B (see Section 3.4). The former is the same as the traditional binary relevance assessment, where the degree of the relevance is not estimated.
The latter assessment, in which only the highly relevant documents were judged relevant, allowed us to study how the highly relevant documents were retrieved.

Clustering had a bigger advantage over NN on relevance assessment A than B. When retrieval performance was evaluated with assessment A, the average linkage and Ward X  X  methods were better than NN both when precision was weighed twice more than recall (  X  = 0 . 5) and recall was considered twice as important as precision ( complete linkage methods were even with NN. These two clustering methods were worse than NN, when the results were inspected with assessment B. The average linkage and Ward X  X  methods were still even with and better than NN with weighs
The results suggest that the partitions created with the average linkage and Ward X  X  methods may offer better retrieval ability than the NN technique. Moreover, these methods may retrieve the highly relevant documents better than NN, if recall is more important than precision. Although our results are not directly comparable with the partition search results of El-
Hamdouchi and Willett (1989), the similarity of results suggest that when the characteristics highly inflectional and agglutinative language, may be clustered as well as collections in
English. The large number of inflected forms and compound words in Finnish were the main problems from information retrieval viewpoint. Transforming the inflected words into their morphological basic forms and splitting the compound words into their parts was an appropriate preprocessing approach to facilitate successful clustering of documents in Finnish.

Our results can also be used to partially validate the relevance assessments of the ex-perts. Provided that the most relevant documents are truly highly relevant, it is likely that with assessment B many of the relevant documents are retrieved, but since the fairly and marginally relevant are considered irrelevant, also several irrelevant documents are retrieved.
Consequently, recall and precision should be clearly different from those obtained when all relevant documents are clumped together. Since Tables 2 X 5 show consistently the recall of assessment A lower than that of B and the precision of A higher than that of B, it seems that the assessors have done their work reliably.

The dimension reduction of data has been applied in information retrieval, but its use in document clustering has been infrequent. The results showed that PCA is a useful technique to enable the use of memory intensive hierarchical clustering. The number of terms could be reduced from 13,693 to 1,500, and, furthermore, the clustering of the greatly reduced data was successful when the pitfalls discussed by Korenius et al. (2004) were avoided. In our study, the lack of memory caused most problems. The running times of the dimension reduction and clustering methods were reasonable when a powerful computer was used, but the PCA method itself required large amounts of memory. However, there exist special algorithms, with smaller time and memory complexities than required by the algorithms used here, that utilize the sparsity of matrix to compute a partial SVD solution (Boley 1998). We plan to address these in the future research.

The standard hierarchical methods were an obvious choice, because the environments we are interested in are quite static and such where the accurate solutions are considered better than real-time responses. Since these methods have often been used in the document cluster-ing, we were also able to compare our results to the results of the earlier studies. Moreover, the proven methods were, in our opinion, the best approach to tackle a novel problem. Future research should also consider the efficient new clustering algorithms presented in the area of data mining (Boley 1998, Nilsson 2002), because they might be used to generate clusters for search purposes. Besides supervised machine learning techniques, clustering might also be a tool to assess assessments: By comparing the relevance classes to a grouping, one can study to which degree the unsupervised method was able to recover the inherent structure (see, for example, Slonim and Tishby 2000).
 Acknowledgments
This study was supported by the grants 50973 and 55243 from the Academy of Finland. The authors wish to thank the anonymous referees for many valuable comments which helped us to improve the paper.
 References
