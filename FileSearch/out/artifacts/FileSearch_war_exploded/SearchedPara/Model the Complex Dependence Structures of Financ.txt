 Financial variables such as asset returns in the massive mar-ket contain various hierarchical and horizontal relationships forming complicated dependence structures. Modeling and mining of these structures is challenging due to their own high structural complexities as well as the stylized facts of the market data. This paper introduces a new canonical vine dependence model to identify the asymmetric and non-linear dependence structures of asset returns without any prior in-dependence assumptions. To simplify the model while main-taining its merit, a partial correlation based method is pro-posed to optimize the canonical vine. Compared with the original canonical vine, the new model can still maintain the most important dependence but many unimportant nodes are removed to simplify the canonical vine structure. Our model is applied to construct and analyze dependence struc-tures of European stocks as case studies. Its performance is evaluated by measuring portfolio of Value at Risk, a widely used risk management measure. In comparison to a very recent canonical vine model and the  X  X ull X  model, our ex-perimental results demonstrate that our model has a much better quality of Value at Risk, providing insightful knowl-edge for investors to control and reduce the aggregation risk of the portfolio.
 J.1 [ Computer Applications ]: Financial Economics Financial Variables, Dependence Structure, Canonical Vine
Modeling the complex dependence structures of financial variables is a fundamental research problem in the finan-cial domain useful for a wide range of applications including price prediction and risk measurement. Its extreme impor-tance has been partially demonstrated in the 2007 global financial crisis. That financial turmoil was originated from the subprime mortgage market in the United States (US), and it quickly spread to every cell in the US and global finan-cial system. The bankrupt of Lehman Brothers in Septem-ber, 2008 marked a peak point of the crisis X  X he failure of the fourth largest investment company was the largest bankrupt in US history. The European financial market was heavily impacted by the collapse of Lehman Brothers as the Euro-pean financial market was not isolated. If early precautious measures were taken according to the fundamental under-standing of the global financial dependence, some of the cri-sis may be avoided.

There are various hierarchical and horizontal coupling re-lations in the stock markets [4]. We take European stocks as an example to explain the concept of dependence.  X STOXX-50E is a composite index of European stocks, composing of 50 European stocks from six countries. Siemens and Allianz are two companies in Germany; France Telecom and Societe Generale GRP are two companies from France. It is easily understood that the price index of Siemens is directly de-pendent on its national index of Germany. Although some-times not easily visible, its price index is also dependent on the composite index  X STOXX50E, the national index of France, the price index of Allianz, that of France Telecom, or that of Societe Generale GRP (see the dashed lines in Figure 1). Thus, the price of an individual stock can be
Fi gure 1: An Example of Dependence Structure affected not only by the composite index and its national index, but also by other national indices and the price of in-divid ual stocks from other countries. So, the price index of two stocks even from different countries should be dependent to each other which is however assumed as independent by past models. Our concept of this comprehensive dependence structure without prior independence assumptions can give investors an insightful understanding of the financial market. In particular, it is useful for portfolio investors to control the aggregation risk [2] of the portfolio with higher precision.
To model the price and composite index in stock markets, the price X  X  log difference of every two consecutive trading days is usually taken, which are called returns. Early tech-niques in modeling dependence of returns in stock markets is by the Pearson X  X  correlation method. It uses the average deviation from mean, ignoring the small or large returns as well as negative and positive returns. However, it is unable to explain the asymmetric correlation of stock markets as shown in [17]. Another classical idea in modeling depen-dence is through the use of the Capital Asset Pricing Model (CAPM). CAPM belongs to the family of factor models, in which CAPM is the simplest version with only one factor to control market. The normality assumption makes CAPM inappropriate in modeling returns of stocks, as the returns of stock markets are not normally distributed.

Copula model is a powerful tool in modeling the depen-dence structure for the returns of stock markets. This is mostly attributed to that copula model can separate the de-pendence structure from the marginal distribution. There-fore, the selection of copula functions is not constrained by the choice of marginal distributions. Another key point of copula model is its consideration of both the dependence of the portfolio of stock returns as well as correlations of in-dividual stock returns at the same time. Recently, Heinen and Valdesogo [10] proposed a new copula model, named Canonical Vine Autoregressive (CAVA) model, which intro-duces three different levels of variables: market indices, sec-tor indices and individual stock returns. It integrates these different levels of stock returns as a whole to conduct de-pendence analysis. However, one limit of the CAVA model is that it imposes two independence assumptions on the de-pendence structure. With this restriction on dependence structures, it is definitely not a perfect model to understand the complex relationships of financial variables.
The challenging task to investigate the dependence struc-ture in stock returns contains other three difficulties. Firstly, it is difficult to build an appropriate model to describe and capture the dependence. The dependence structure will be very much complicated as the data dimension is quite large. If the dependence is constructed by using canonical vine (which is discussed in Section 2 in detail), the number of nodes increases exponentially as the the number of variables grows. It is difficult to construct and optimize the model when the variables is quite large. Second, financial variables has its own characteristics, which is called stylized facts. The most important stylized facts are volatility clustering, fat tails and asymmetry. Volatility clustering refers to the variance of returns, namely low values of volatility tend to be followed by low values; and high values of volatility fol-lowed by high values [3]. The fat tail means that extreme values in stock return occur more frequent than the implied number by a normal distribution. Asymmetry means that positive and negative returns of the same magnitude have different impact on the variance. For example, stock return will have stronger correlation in bear market downturn than in bull market [7]. Third, daily returns are not normally dis-tributed. Even after the daily returns being standardized by dependence model, the standardized residuals are still not normally distributed. Therefore, a new idea in modeling the dependence structure is demanded to consider both the de-pendence between stock returns as well as the stylized facts of financial time series at the same time.

To fulfill this need, we propose a new canonical vine based dependence model, called Canonical V ine Dependence M o del (CVDM). CVDM can capture various and important hierarchical and horizontal dependence. In order to ad-dress the high-dimensionality issue, we use an idea of par-tial correlation to optimize the canonical vine structure. The canonical vine, when it is constructed and optimized by the partial correlation method, is able to model high-dimensional dependence structures. It is capable of main-taining the most important dependence, while reducing the complexity of the dependence structure remarkably, espe-cially for high-dimensional input. In addition, we also take an ARMA-GARCH model with skewed student t distribu-tion for marginal models to capture the stylized facts in financial variables, such as volatility clustering and fat tail.
The main contribution made by this work is the new par-tial correlation method to construct and optimize the canon-ical vine in our model CVDM. It is practically needed to optimize the canonical vine as the number of parameters in canonical vine is quit large for high dimensional data. The optimal canonical vine can reduce the number of parameters and simplify the canonical vine structure. The optimal vine can capture the most important dependence of data, with-out big affect on the structure of canonical vine. In addition, compared with CAVA model, the partial correlation based canonical vine model, CVDM, does not impose any indepen-dence assumption on the structure, totally eliminating any prior bias for modeling the dependence structure in stock re-turns. CVDM not only summarizes the various dependence with a single number, but also contains much information which is helpful for a deeper understanding of dependence structure. For example, CVDM can be used to determine the correlation between two stock returns as well as multi-variate stock returns. It can be also used to calculate the conditional copula of stock return, such as the correlation of two stock returns conditioning on market indices. Further, the rich information in CVDM can be utilized to compute risk measures such as Value at Risk.

The rest of the paper is organized as follows. In Section 2, we provide a short introduction to copula and present related works. Section 3 describes the framework of our Canonical V ine Dependence M odel in detail, including construction and optimization of canonical vine. Section 4 discusses the selection of marginal distributions. Section 5 provides simu-lation steps for calculating the portfolio of Value at Risk. In Section 6, we apply the Canonical Vine Dependence Model to capture the dependence of returns in European stock mar-kets, and evaluate out model by comparing with the per-formance of CAVA and full canonical vine model. Finally, Section 7 concludes the paper. Recently, copula theories have been rapidly developed. Copula is a powerful tool in modeling the dependence of variables. It can capture complicated correlations between variables, including linear or non-linear ones. According to Skla r X  X  theorem [18], a copula function is defined to con-nect univariate functions to form a multivariate distribution function. The definition of a copula function is given by: where, x = [ x 1 , x 2 , ..., x n ] is a random variable vector, F is a joint distribution and F 1 , F 2 , ..., F n are the marginal dis-tributions of the corresponding variables respectively. The differential of Equation (1) is: where, c is the density copula function and f i ( x i ) is the density function of marginal distributions. A useful prop-erty of copula is that given any set of marginal distribu-can obtain a joint distribution via Equation (1). Equation (2) implies another important property: copula function can separate dependence from marginal distributions. This indi-cates that the choice of copula functions is not constrained by the choice of marginal distributions and the marginal distributions do not have to be the same X  X he marginal dis-tribution can even be selected from mixed families. This property makes copula flexible and be a powerful tool for modeling dependence.

One way to build high-dimensional copula models is to construct multivariate copula model based on canonical vine defined by Aas et.al [1] as: where, c ( , ) is the pair copula density function. In Equa-tion (3), the jointly copula function can be decomposed into many conditional pair copula functions. Canonical vine is hierarchical in nature. The basic scheme for modeling de-pendence with canonical vine model is to decompose mul-tivariate density functions into many conditional pair cop-ulas. These pair copulas are bivariate copulas in one time. The multivariate model based on canonical vine transforms one high dimensional model into multiple two-dimensional models, which makes canonical vine model the complex de-pendence structure with high dimensional variables.
Chollete et al. [5] proposed a multivariate copula regime-switching model based on vine copula to capture the asym-metric dependence in stock markets. Berg and Aas [1] com-pared multivariate model based on canonical vine with the nested Archimedean construction. The result suggested that canonical vine is better in fitting the data based on empir-ical study with two four-dimensional data sets. Min and Czado [16] proposed a Bayesian inference for canonical vine. They developed a Markov chain Monte Carlo (MCMC) algo-rithm, which can reveal unconditional and conditional inde-pendence in data sets. Smith et al [19] proposed a Bayesian method for the estimation of parameters in high-dimensional model based on canonical vine.
 Recently, Heinen and Valdesogo [10] proposed a Canonical Vine Autoregressive (CAVA) model based on canonical vine. Suppose that there are four stock returns ( r A 1 , r A 2 r
B 2 ) from two different sectors ( S A and S B ). The return of market is r M , and the returns of sector A and B are r A r
B respectively. The independence assumptions imposed by the CAVA model are: Thus, we can obtain the joint density function (Equation (4)) by rewriting Equation (2) tion, which can be decomposed into the following Equation:
The dependence structure modeled by CAVA is described in Figure 2, where a dashed line indicates that the correla-tion is assumed to be independent. It is a biased assumption, not an assumption based on data analysis. It is implausible.
Figure 3 shows the flow chart of our Canonical Vine De-pendence Model (CVDM). It consists of two separated parts: canonical vine and marginal distributions. For the part of canonical vine, the first step is to construct the canonical vine, and then optimize the canonical vine. Both steps are based on partial correlation. For the second part, we take the ARMA-GARCH model for the marginal distribu-tion with the skew student t distribution for error distribu-tion. The parameters of both parts are estimated by using maximize likelihood estimation. A parameterized CVDM is therefore capable of measuring the risk or trends of the financial market.
As highlighted in Introduction, our CVDM is centered on the canonical vine. It is constructed by a large number of conditional pair copula functions, making it flexible and powerful for modeling the complex dependence structures of high-dimensional financial variables. We do not impose any independence assumption on the CVDM, which is more appropriate in modeling the dependence structure of stock returns. We continue the example from the Introduction to describe the main ideas of CVDM.

Suppose that there is one market M with four stocks in two sectors ( A and B ). The return of M is denoted by r M returns of sectors A and B are denoted by r A and r B respec-tively. The returns of stocks r A 1 and r A 2 belong to sector A , and the returns of stocks r B 1 and r B 2 belong to sector B . Mapping to the example discussed in Introduction, M (Market) stands for  X STOXX50E (market index), A and B stand for Germany and France respectively. A 1, A 2, B 1 and B 2 stand for Siemens, Allianz, France Telecom and Societe Generale GRP respectively. The joint density function of the CVDM model is given by: where f ( r B 2 ) are marginal distributions, which will be described in Section 4. c ( r M , r A , r B , r A 1 , r A 2 , r B 1 function defined by Equation (7): where c r M ,r A stands for the copula between the return of market and the return of sector A , c r M ,r A 1 is the copula be-tween the return of market and the return of stock 1 in sector conditional copula, meaning the dependence of the four stocks conditioned on the market and the two sectors. The term c ditional pair copulas.

This dependence structure is displayed in Figure 4, where the term ( M, A ) stands for the correlation between the mar-ket and sector A measured by the copula function c r M ,r The term ( A, B j M ) means the conditional correlation be-tween sector A and sector B conditioned on M , measured by the conditional copula function c r A ,r B | r M . In the example, the canonical vine consists of 6 trees and 21 nodes. All trees and nodes (explained in Section 3.2) are shown as Figure 5. If the dependence is modeled by CAVA which imposes two independence assumptions, then the following copula func-c c CVDM does not make any independence assumption in the structure. The conditional independence or dependence be-tween financial variables are judged by data instead.
The key step to construct a canonical vine is to determine the root variables for all trees. We take the example in section 3.1 to explain the root variable. In Figure 5, from first tree to sixth tree, the corresponding root variables are M , A , B , A 1, A 2, B 1, B 2 respectively. When the root variable of each tree is identified, the whole canonical vine structure is then determined. Nodes in a canonical vine are defined as the relations in this paper. Each tree has different number of nodes, and each node can only be allocated to one conditional pair copula. We take the example in Section 3.1 to explain nodes. In Figure 5, for the first tree, there are 6 nodes, and each nodes are allocated to one bivariate sixth tree, there is only one node, which is allocated to one that the number of nodes in a canonical vine will increase exponentially as the number of variables increases. Since each node has to be allocated to one conditional copula, the number of parameters will be double for the two-parameter conditional pair copulas. For ease of comprehensibility, it is essential to simplify and optimize the canonical vine.
In the Canonical Vine Dependent Model, the principle for canonical vine construction and optimization is to re-duce the complexity of model without significantly affect-ing or changing the original structure. It means that the optimal canonical vine should capture the most important dependence, ignoring the weak dependence. Based on this principle, we use a partial correlation method to construct the canonical vine dependence structure. In CVDM, the construction of canonical vine is based on conditional cop-ula. The new method is to build a canonical vine based on partial correlation, which has same structure as canonical vine based on conditional copula . Then, we optimize the canonical vine based partial correlation by setting the small value of partial correlation (the absolute values of partial correlation less than significance value  X  ) to zero, in order to decrease the number of nodes and reduce the complex-ity of canonical vine. The optimal canonical vine based on partial vine can be used to mapping into the canonical vine based on conditional copula, since canonical vine based on conditional copula has the same structure as the canonical vine based on partial correlation, which is explained in [13].
The reason for using partial correlation is that it is not easy to obtain the conditional copula in high-dimensional model, but partial correlations can be easily obtained from the correlation matrix. The definition of a partial correlation is as follows: Ob viou sly,  X  1 , 2 is equal to the  X  X endall X  correlation with two variables. For elliptical distributions, partial correlations are equal to conditional copula [12]. Therefore, we can build de-pendent structure via partial correlations. Then, the canon-ical vine based on partial correlation is optimized by setting small values to zero as the small values (weak partial cor-relation) can be ignored. The canonical vine based on par-tial correlation will correspond to the canonical vine depen-dence structure based on conditional copula. The method to construct a canonical vine based on partial correlation is described in Algorithm 1, where the function of log ( D ) is explained in Equation (9).
 Al g ori thm 1 Canonical Vine Construction and Optimiza-tion 1: Calculate all values of partial correlation, and then allocate 2: for k = 1 , ..., n 2 do 3: For those trees exceeding the k th tree ( &gt; k ) excluding the 4: For those trees from the rst to the k th tree ( &lt; = k ), nd an 5: end for 6: There will be ( n 2) 1 canonical vines as k = 1 , ..., n 2. 7: For the 'best' canonical vine, the small absolute values of 8: The optimal canonical vine based on conditional copula is 9: return The optimal canonical vine dependence structure
W e ta ke the example in Section 3.1 to explain how to construct a canonical vine based on the partial correlation. There are one market variable ( M ), two sector variables ( A , B ), and four stocks ( A 1, A 2, B 1, B 2), totally 7 variables. There will have 6 trees and 21 nodes in both canonical vine structure based on partial correlation and conditional cop-ula. Each node can be allocated to one bivariate copula or one partial correlation. For constructing the canonical vine based on conditional copula, we build the canonical vine based on partial correlation at first. The partial cor-relation can be obtained via the Equation 8. For these 7 variables, there are totally 21 partial correlations, including  X   X  partial correlations is allocated to the root node of last tree (the sixth tree in Figure 5) as the last tree only has one node. Suppose the selected partial correlation in the last variables B 1 and B 2. The sets c 7 = f B 1 , B 2 g and d f
M, A, B, A 1 , A 2 g are called conditioned set and condition-ing set respectively. For the selection of the root variable of th e second to last tree (the fifth tree in Figure 5), there are two nodes which can be allocated as two partial corre-lations. We have to select one root variable for the second to last tree (the fifth tree) from d 7 and generate 2 new con-ditioned sets. If the selected root variable of the second to last tree is A 2, then the two new conditioned sets are c = f A 2 , B 1 g and c  X  6 = f A 2 , B 2 g . The corresponding con-ditioning set for c 6 and c  X  6 is d 6 = f M, A, B, A 1 g correlations allocated to the two nodes are  X  A 2 ,B 1; M,A,B,A 1 and  X  A 2 ,B 2; M,A,B,A 1 . If the chosen root variable is A 1, the two new conditioned sets will be c 6 = f A 1 , B 1 g and c f
A 1 , B 2 g . The corresponding conditioning set for c 6 c is d 6 = f M, A, B, A 2 g . The partial correlation allocated When the selected root variable of the second to last tree is M , A or B , the process is similar to A 1 and A 2. The next step is to determine k , where k is a tree-broken level. For trees beyond the k th tree ( &gt; k ), the appropriate root vari-able must minimize the value of function within the k th tree ( &lt; = k ), the appropriate root variables must minimize the value of function ample, suppose k is 3 in the example. For the first, second and third trees, the selected root variables for each tree must minimize the value of function and sixth trees, the chosen root variables for each tree must minimize the value of function eter k can choose different values, such as k = 1 , 2 , 3 , 4 , 5. Therefore, there should totally have 5 canonical vines. The  X  X est X  canonical vine should maximize the value of function of log ( D ), where D is the determinant. The determinant ( D ) can be calculated by using: where d ( i, j ) is the conditioning set excluding variable i, j . The corresponding conditioned set is i, j . The small abso-lute values of partial correlation in the  X  X est X  canonical vine, which are less than significance value  X  , will be set to zero. Finally, the optimal canonical vine structure based on par-tial correlation is built. Since the canonical vine based on conditional vine has a similar structure, we can construct the optimal canonical vine based conditional copula by us-ing the structure based on partial correlation.
Parameters of CVDM are estimated by optimizing the following log-likelihood function: where  X  = (  X ,  X  ) is a vector covering all parameters of the marginal distributions  X  = (  X  1 , ...,  X  p ) and the copula pa-rameters  X  . Then, we decompose Equation (10) into two parts, marginal distribution log likelihood function and cop-ula log likelihood function. The marginal distribution log-likelihood can be written as: and the copula log likelihood is: where u = ( F 1 ( x 1 ) , ...F p ( x p )). Therefore, the parameters of the whole model can be estimated via two steps: marginal step and copula step. For the marginal step, parameters are estimated by optimizing the marginal log likelihood: For the copula step, parameters are estimated by optimizing the copula log likelihood L c (  X  ; u,  X  ) which is conditional on the estimated parameters  X  for marginal distributions:
Volatility clustering is one of the most important char-acteristic of stocks, referring to the variance of returns. It says that low values of volatility tend to be followed by low values, and that high values of volatility is followed by high values. As ARMA representation of GARCH models can capture this characteristic of volatility clustering, we choose ARMA-GARCH model as the marginal distribution of our CVDM to capture the volatility of daily returns. ARMA(p,q)-GARCH(1,1) model is defined as follows: where  X  &gt; 0 ,  X  0 ,  X  0 ,  X  +  X  &lt; 1 , X t is actual stock return and  X  t is volatility of return on day t . The constraint  X  +  X  &lt; 1 is to maintain the GARCH weak stationary. e t is the error as discussed in next subsection. In general, a GARCH (1, 1) model with three parameters is adequate to fit the financial time series. Hansen and Lunde [9] provided evidence that it is difficult to find a volatility model which outperforms the GARCH (1, 1) model. In this paper, we take GARCH (1, 1) to interpret how GARCH models cap-ture volatility clustering. The GARCH coefficient is to be constant and positive. Given the value of  X  , it is obvious that a small value of  X  2 t  X  1 will result in a small value of  X  and a large value of  X  2 t  X  1 will result in a large value of  X  Therefore, we select the ARMA-GARCH for the marginal distributions in CVDM.
The simplest choice of an error is the standard normal distribution, such as e t N (0 , 1). The ARMA-GARCH with normal distribution errors indicates a symmetric dis-tribution for observations f x t g . However, the distribution of financial time series is not normal with negative skewness and excess kurtosis. It also has been demonstrated that the distribution of financial time series has fat tails beyond normal distribution [3]. Fat tail means that extreme val-ues occur more frequently than that produced by a normal distribution. The ARMA-GARCH with normal error can-not take account of the asymmetry in the distribution of financial data. Therefore, the normal distribution should be excluded. It is more appropriate to use a distribution which has fatter tails than Gaussian distribution. The most com-monly used fat tail distributions for fitting ARMA-GARCH model are the skew student t distribution. Hansen [9] pro-posed the skew student t distribution to fit the financial time series. Its density function is as follows: where I ( ) is the indicator function ,  X  &gt; 0 and f t ( ) is the density of the student t distribution with v degrees of free-dom. When  X  = 1, the skew student t distribution becomes student t distribution. The skew student t distribution is to skew the symmetric student t distribution by combining together two differently scaled halves of the symmetric dis-tributions. The advantage of skew student t distribution is that it can fit the fat-tailed data very well as it has two tails behaving as polynomials. Therefore, we select the skew student t error distribution in our application.
Value at Risk (VaR) is a widely used risk measurement on a specific portfolio of stock returns [2]. The performance of models can be evaluated by estimating the value at risk. A good model can generate good estimates of VaR. The quality of VaR generated by different models can be judged by using backtesting methods, including unconditional coverage test [11] and the conditional coverage test [6]. These tests are based on likelihood ratios and the null hypothesis is that VaR should exhibit a conditional or unconditional coverage equal to the normal significance level  X  (0.05 in general). The details of these tests can be found in [8]. The portfolio of stock returns is denoted by: where r i is the return for i = 1 , ..., n and  X  i is the weight.
The process for computing a Value at Risk is as follows: (i). The AR(1)-GARCH(1,1) with skewed t student distri-(ii). Use the parameter estimations to calculate the one (iii). The standardized residuals obtained from AR(1)-(iv). Fit a CVDM by using these data and estimated pa-(v). Use the estimated parameters of copula functions to (vi). Calculate the one day forecast return for each stocks (vii). The portfolio return is calculated by using Equation The backtesting used to evaluate the performance of the portfolio of VaR by using the CVDM. If the VaR forecast is accurate, the VaR forecast should possess two properties. The first property is that the exceedances has to occur in-dependently. The second property is that the proportion of exceedances should approximately equal to the significance level  X  . The hit variable of ex-post exceedances is given by: where r t,p denote the ex-post observed portfolio return at time t . If the VaR forecast is accurate, the I t should be equal to  X  that is the significance level in the backtesting.
To evaluate the performance of CVDM on real financial data, we used the log returns of 45 stocks from  X STOXX50E, a Europe-wide composite index, corresponding to the mar-ket variable ( M ) mentioned in the example of Section 3.1. The sector variables are the five national leading stock in-dices corresponding to the home country of our chosen stocks such as  X FCHI,  X GDAXIP,  X AEX, FTSEMIB.MI and  X IBEX, namely the national indices of France, Germany, Netherland, Spain and Italy. Some of these national leading stock indices are referred as the sector variables A and B by the exam-ple of Section 3.1. There are 51 variables involved in our experiment in total. The data were download from yahoo finance (http://finance.yahoo.com), it spans 970 days from 22/05/2006 to 30/06/2010. These stocks and indices in our experiment are listed in Table 1. The returns of these in-dices and stocks are calculated by taking the log difference of the prices on every two consecutive trading days.
We ca rried out experiments and obtained descriptive statis-tics of the data as shown in Table 2. Skewness (Skew) is a measure of asymmetry of financial time series, and Kurto-sis (Kurt) is to measure the  X  X eakedness X . We can see that all of the variables have positive skewness, excluding the national indices  X AEX and  X IBEX. All of the variables ex-hibit an excess kurtosis, indicating that they do not follow any normal distribution. This is suggestive of that different and appropriate models should be selected for their marginal distributions. As described in the method section, AR (1) -GARCH(1,1) is considered as the marginal distribution model to capture the asymmetry. The Ljung Box Q test [15] was then used for examining the existence of residual autocorrelation for each time series.

We conducted the Ljung Box Q test for each marginal model to ensure that residuals do not have autocorrelation. When marginal distributions fail the Q test, we increased the value of p and q in ARMA (p,q) -GARCH (1,1) model until all marginal distributions pass the Q test. The Ljung Q Test results of the composition index  X STOXX50E and the five national leading indices are shown in Table 3. The 45 stocks are not listed due to the limit of pages. In Table 3, p is the corresponding p value. The results indicate that the six indices do not have autocorrelation as all of the p values are bigger than the significance level 0.05.
A case study was conducted to compare the detailed per-formance of our CVDM with a recent CAVA model and the  X  X ull X  canonical vine model. The  X  X ull X  canonical vine model is constructed by taking the  X  X ull X  canonical vine. The  X  X ull X  canonical vine can be constructed via Algorithm 1 without the optimization step. Given the 51-variable data set above, the canonical vine contains 50 trees and 1275 nodes. In the case study, all nodes are t copulas. For k = 1 , 2 , 3 , ..., 49, there are totally 49 canonical vines based on partial corre-lation. We choose the canonical vine based on partial cor-relation which can maximize the value of function log ( D ), where D is the determinant of partial correlation. The re-sult shows that when k = 47, the canonical vine has the maximum value of the function log ( D ), which is the  X  X est X  canonical vine. The selected root variables of the first five trees of the canonical vine are  X STOXX50E,  X FCHI, FT-SEMIB.MI,  X AEX and  X GDPAXIP. The two variables in the last tree (the fiftieth tree) are SU.PA and CS.PA. Then, the selected canonical vine is optimized based on partial cor-relation. The value of partial correlation, which is less than significance value  X  , is set to zero. In our experiment, we considered to use different significance values to optimize the canonical vine, and then compare the optimal canonical vine with the  X  X ull X  canonical vine. The comparison between canonical vines with different significance value  X  is based on the function log ( D ), where D is the determinant of par-tial correlation as mentioned in Section 3.2. The function is to calculate the determinant canonical vine based on partial correlation, which can also be used to compare the similarity of vine structure based on partial correlation [14].
Table 4 shows the determinants and numbers of pair cop-ulas under various significance value  X  . When  X  is equal to 0, all values that are less than 0 were set to zero to in-dicate that the canonical vine is the  X  X ull X  canonical vine without any simplification or optimization. The value of log ( D ) means the strength of a canonical vine based on partial correlation. When  X  is equal to 0.1, the value of log ( D ) is 27.43, which is not significantly different from the value of the  X  X ull X  canonical vine. Compared with the number of nodes in the  X  X ull X  canonical vine, the number of nodes of the canonical vine with  X  =0.1 is 217, decreasing the complexity of the canonical vine a lot. If the conditional pair copulas for each node are selected from t copula family, the gap of parameters will double as the t conditional pair copula has two parameters. When  X  takes the value of 0.2, 0.25 or 0.3, the number of nodes decreased to 90, 69 and 59 respectively, however, the value of log ( D ) are signifi-cantly different from the  X  X ull X  model. It indicates that these canonical vines with high value of  X  are obviously different from the  X  X ull X  canonical vine model. We also constructed the optimal canonical vine based on conditional copula. Since the canonical vine based on conditional copula has a similar structure with that of the canonical vine based on partial correlation, we can construct the canonical vine based on conditional copula and then built our CVDM. In the ex-periment, we built two CVDMs with  X  = 0 . 1 and 0 . 2, in order to compare the performance of Value at Risk in the following section. CVDM (  X  =0.1) has similar determinant as the  X  X ull X  model, but the number of nodes is significantly decreased. CVDM (  X  =0.2) has less number of nodes, but the determinant is obviously different from the  X  X ull X  model. The performance of the two CVDMs is further evaluated in the section below.
 Table 4: Determinants and Numbers of Pair Copu-las
The performance of our model was further evaluated by measuring the Value at Risk (VaR). The backtesting tests discussed in Section 5 were used for validating VaR fore-cast generated by different models. A moving window of 970 observations, corresponding to appropriately 4 years of daily returns from 22/05/2006 to 30/6/2010, was used to construct the model. The test period was from 01/07/2010 to 01/03/2012 with 500 observations of daily returns. We calculated three VaRs: 90%, 95%, and 99% VaR. The pro-cess is explained in Section 5. The VaR of portfolio returns of 51 variables (45 stocks, 5 leading national indices and 1 composite index) in the test period was calculated by using Equation (19). We compared our CVDM (  X  = 0 . 1 and 0 . 2) with the  X  X ull X  model and CAVA model.

It is important to examine whether VaR are consistent with subsequently realized return given a significant level. Kupiec [11] introduced a percentage of failure of uncondi-tional coverage to examine the quality of VaR. Christoffersen [6] proposed a more complete test to examine the conditional coverage and independence of VaR. These tests were used as backtesting for examining the quality of VaR here. The ex-ceedances result is presented in Table 5, where POF stands for the percentage of failure. It can been seen that CVDM (  X  =0.1) performs very good as the two levels of POF are in the level 95% and 90%, lower than  X  . At the level 99%, the exceedances is slightly increased in comparison to those expected ones. Compared with CVDM (  X  =0.1), the  X  X ull X  canonical vine model has a similar performance. However, the CAVA model does not have a good performance, as all of the three levels of exceedances are higher than the expected one. The performance of CVDM (  X  = 0.2) is worse than CAVA. The corresponding display of these VaR forecasts is shown in Figure 6.

Table 6 presents statistics of a conditional coverage test, unconditional coverage test and an independent coverage test, where LRCC, LRUC, and LRIC are short for the likeli-hood ratio of conditional coverage, likelihood ratio of uncon-ditional coverage and likelihood ratio of independent cover-age respectively. The values in the parentheses are the cor-responding P values of these tests. The smaller the statis-tics is, the bigger the corresponding P value is, indicating that the VaR forecast is more accurate. If the P value is bigger than 0.05, it means that the null hypothesis of back-testing can be accepted, and the VaR forecasts are accurate and reliable. For CVDM (  X  =0.1), it can been seen that the VaR forecasting at all of the three levels are sufficiently accurate, as the null hypotheses of the conditional, uncon-ditional and independent cannot be rejected according to these tests. The  X  X ull X  canonical vine model has similar per-formance in backtesting. It is evident that the model based on our optimal canonical vine performs as good as the  X  X ull X  model, suggesting that these weak correlations can be ig-nored without affecting or changing the whole dependence structure. It means that our new method for constructing and optimizing canonical vine is excellent and reliable. On the other hand, the tests on CAVA suggest that VaR fore-casting at all of the three levels is not accurate, since the null hypotheses of conditional, unconditional and indepen-dent at all of the three levels are rejected. The reason is that CAVA imposes two independence assumptions to ig-nore some strong correlations in the canonical vine. CVDM (  X  =0.2) has similar performance with CAVA, and the reason is that the number of nodes is too small to capture the most important dependence in caonoical vine.

We have conducted similar analysis for CVDM under dif-ferent significance value (  X  ) listed in Table 4. The results show that for those CVDMs with  X  greater than 0.1, their VaR performance are not accepted. For those CVDMs with  X  less than 0.1, their performance are as good as the  X  X ull X  model, however, the number of nodes are quite large. When  X  is equal to 0.1, the nodes is small enough, and the perfor-mance is accepted. We also conduct analysis for other five portfolios of European stocks , the results show that CVDM (  X  =0.1) performs as good as the  X  X ull X  canonical vine model, and better than CAVA X  X .
 Table 5: Number of Exceedances of VaR Forecast
This work proposes a new canonical vine, as optimized based on partial correlation, to model the complex depen-dence structures of financial variables. It has been demon-strated useful for analyzing the complicated dependence struc-ture of a big portfolio of European stocks. Compared with CAVA, our CVDM shows a much better performance in producing the VaR forecasts of portfolio returns. CVDM also has a similar performance of VaR forecasting as that of the  X  X ull X  canonical vine model although with a size much smaller. As a future work, we will examine in detail the strong correlations identified by CVDM to understand more about dependence structures of European/Asian/US stocks. This work is sponsored in part by Australian Research Council Discovery Grants (DP1096218) and ARC Linkage Grant (LP100200774).
Figu re 6: The VaR Forecast of Portfolio Returns [1] K. Aas and D. Berg. Models for construction of [2] C. Alexander. Market Risk Analysis, Value at Risk [3] T. Andersen, R. Davis, and J. Kreis. Handbook of [4] L. Cao, Y. Ou, P. YU, and G. Wei. Detecting [5] L. Chollete, A. Heinen, and A. Valdesogo. Modeling [6] P. Christoffersen. Evaluating interval forecasts. [7] C. Erb, C. Harvey, and T. Viskanta. Forecasting [8] C. Guermat. Robust conditional variance estimation [9] B. E. Hansen. Autoregressive conditional density [10] A. Heinen. Asymmetric capm dependence for large [11] P. Kupiec. Techniques for verifying the accuracy of [12] D. Kurowicka. Optimal truncation of vines.
 [13] D. Kurowicka and R. Cooke. Uncertainty analysis with [14] D. Kurowicka, R. Cooke, and U. Callies. Vines [15] A. McLeod and W. Li. Diagnostic checking arma time [16] A. Min and C. Czado. Bayesian inference for [17] A. Patton. On the out-of-sample importance of [18] A. Sklar. Fonctions de r  X epartition `a n dimensions et [19] M. Smith, A. Min, C. Almeida, and C. Czado.

