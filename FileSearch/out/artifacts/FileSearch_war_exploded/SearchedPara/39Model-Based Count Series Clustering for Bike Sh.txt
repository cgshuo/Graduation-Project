 C  X  OME ETIENNE and OUKHELLOU LATIFA ,Universit  X  e Paris-Est With a growing population and more and more people living in cities, as well as the increase in nuisance factors such as pollution, noise, congestion, and greenhouse gas emissions, the development of new sustainable mobility strategies in urban areas has become a necessity. Public authorities need to deploy urban mobility policies in order to organize passenger mobility differently and thus lessen the negative impact of mobility demands. One possible approach is the promotion of soft modes of transport such as walking and cycling, which are economical, healthy, less pollutant, and more equitable [Pucher and Buehler 2008; B  X  uttner et al. 2011; Dill 2009].

The implementation of bike sharing systems (BSSs) is one of the urban mobility mea-sures proposed in many cities all over the world as an additional means of sustainable intermodal transport. Over the last few years, different BSSs have been implemented in European cities, the main motivation being to provide users with free or rental bi-cycles especially suited for short-distance trips in urban areas, thus reducing traffic congestion, air pollution, and noise. In Europe, BSSs are most popular in the southern European countries, where a cycling tradition does not exist. Thanks to their unques-tionable success [De Maio 2009; B  X  uttner et al. 2011], more and more cities want to provide this mode of mobility in order to show that they are sustainable and modern. Since the implementation of the first BSS in Lyon, France, in 2005 (called V  X  elo X  X ), BSSs have been launched in 20 French cities, including Paris, one of the most large-scale BSSs implemented in France (called V  X  elib X ).

The key to its success is having good knowledge of BSS usage and performance. This knowledge can then be transferred to other cities wishing to introduce BSSs. Several studies [Froehlich et al. 2009; Borgnat et al. 2011; Vogel and Mattfeld 2011; Lathia et al. 2012] have shown the usefulness of analyzing the data collected by BSS operators and city authorities. A statistical analysis of such data helps in the development of new and innovative approaches for a better understanding of both urban mobility and BSS use and performance. The design of BSSs, the adjustment of pricing policies, and the improvement of the service level of the system (redistribution of bikes over stations) can all benefit from this kind of analysis [Dell X  X lio et al. 2011; Lin and Yang 2011; APUR 2006], which also helps sociologists and planners to understand user mobility patterns within the cities.

However, the amount of data collected on such systems is often very large. It is there-fore difficult to acquire knowledge using it without the help of automatic algorithms that extract mobility patterns and give a synthetic view of the information. This arti-cle presents one such automatic algorithm based on a new statistical model that will automatically cluster BSS stations according to their usage profile. The analysis will help us to understand the BSS station X  X  attractiveness, with respect to city geography and demographics, by identifying different functions in different areas, which give rise to specific usage patterns in BSS data. The model proposed here therefore shares some of the objectives highlighted in Yuan et al. [2012], that is, finding functional areas in a city through the mining of mobility data (taxi journeys in this application). How-ever, the specific nature of the transport mode analyzed here (which is mainly used for short-distance trips) requires the development of a particular model more fitted to these data. The clustering of the BSS stations is closely related to the city X  X  activities (transportation, leisure, employment) and can be helpful for a variety of applications, including urban planning and the choice of business location, as mentioned by the pre-vious authors. In addition, the analysis of the results provided by the model provides insights into the relations between the kinds of neighborhoods of the stations (the type of amenities they offer, their demographics, etc.) and their associated usage profiles. Crossing the results of the model with sociological and economic data is carried out to this end and shows the close links between these two aspects and the use of a bike sharing transport scheme, which may be useful for bike redistribution planning and for designing new BSSs.

This article presents a dedicated model based on count series clustering that has been developed in order to highlight mobility patterns in the BSS usage data. The model, which uses trips data to describe station usage, is a generative mixture model; an EM algorithm is derived to learn the model parameters and to perform the station clustering. The formalization of the model is general enough to take into account specific hypotheses related to the BSS case study. The proposed approach is validated through extensive investigations carried out on data collected on the Paris large-scale BSS (V  X  elib X ).

This article is organized as follows: Section 2 presents a survey of related work in the relevant literature. Section 3 introduces the proposed statistical model based on count series clustering. The V  X  elib X  example is detailed in Section 4, the results are given and discussed in Section 5, and a general discussion and conclusion are provided in Section 6. Mobility patterns are traditionally analyzed using human and social science method-ologies. The data used for these studies are collected either from sensing devices or through observational mechanisms (e.g., surveys). However, the emergence of informa-tion and communication technologies, as well as the advent of new observation and tracking capabilities, has boosted the availability of sizable mobility datasets. Indeed, most people carry passive urban mobile sensors including mobile phones, GPSs, and so forth, and leave digital traces through ticketing data of public transportation systems. All these datasets can be used to recover mobility footprints, and the development of such new sensors therefore greatly benefits urban mobility studies. This leads to the emergence of a new field of research, namely, urban computing. The type of dataset used and the applicative objectives addressed by this research are many and various: human mobility can be captured through GPS trajectories of vehicles or pedestrians [Wangsheng et al. 2012], cell phone usage [Ratti et al. 2006], and data related to bicycle sharing systems, as is the case here. Such digital traces can then be used to extract mobility patterns [Calabrese et al. 2013; Yuan et al. 2012], to estimate traffic informa-tion [Hofleitner et al. 2012], or to detect traffic problems [Yuan et al. 2010]. Another example of such new usage of these data is the work of Zheng et al. [2011], where GPS trajectories of taxicabs have been used to detect flawed urban planning in a city. Fi-nally, the aim of such research may also be to design new smart services, as in the work of Ma et al. [2013], who proposed a large-scale taxi ridesharing service, for example. In this instance, real-time requests sent by taxi users are taken into account in order to generate ridesharing schedules that reduce the total travel distance significantly. More generally, the availability of these new data sources underlines the importance of the development of novel approaches based on engineering and computer sciences. Tools for processing mobility data are needed for a better understanding of mobility patterns of travelers and goods, as well as of the use and performance of transportation systems.

For the specific case of BSSs, several requirements have motivated earlier studies from the urban computing field: improvement of existing systems, growth of knowledge on urban mobility, and, more generally, development of the BSSs of tomorrow. The design of new BSSs can benefit from the experience gathered on existing systems, the analysis of which can help us to better understand their usage. The long-term goal is to be able, before and after BSS implementation, to optimize station planning in terms of urban planning, mobility needs, and the redistribution capacities of the system.
One of the main issues raised by users in recent surveys is the availability of bikes: users find themselves with empty stations when renting or borrowing bikes and full sta-tions when returning them. Redistribution of bikes is indeed necessary in most BSSs to compensate for the uneven demand of users by relocating the bikes among the stations, thus ensuring a good quality of service of the system. This is generally performed by redistribution trucks driving around the city that move bikes between stations. Several studies address the issues related to the optimization of bike redistribution policies, including Benchimol et al. [2011], Chemla et al. [2011], and Nair et al. [2012].
Other work from computer science or signal processing domains has involved the study of existing BSSs. These approaches vary according to the kind of data they use and the goal they set out to reach. The collected data on existing systems might correspond to station occupancy statistics, such as station occupancy over the day or over several time frames, but trip data could also be available (i.e., for each trip made using the system), in which case the departure station and starting time, and the arrival station and stopping time are recorded. This last form of dataset is interesting since it provides information on the users X  X  starting place and destination and therefore enables the construction of OD matrices indexed by time.

Using these types of datasets, researchers have investigated two main topics, namely, clustering and prediction. Whereas the aim of clustering is to identify mobility patterns in BSS usage by partitioning the stations into different clusters having a similar usage, prediction focuses on developing models able to predict the occupancy of the stations or more globally the state of the network over time.

The prediction problem has been studied by Froehlich et al. [2009], Borgnat et al. [2009], Kaltenbrunner et al. [2010], Michau et al. [2011], and Vogel et al. [2011]. In the first study, the problem of forecasting near-term station usage is addressed using Bayesian networks, the performance of which is analyzed with respect to factors such as time of day and station activity. The same problem is addressed in Kaltenbrunner et al. [2010] and Vogel et al. [2011] using a time series analysis. Borgnat et al. [2009] predicts the global rental volume using the cyclostationarity of the temporal series, while Michau et al. [2011], using a parsimonious statistical regression model, seeks to relate social, demographic, and economic data of the various neighborhoods of the city with the actual number of trips made from and to the different parts of the city.
In almost all of the clustering studies carried out until now, the bicycle sharing sta-tions are grouped according to their usage profiles, thus highlighting the relationships between time of day, location, and usage. Depending on how the station usage is de-scribed and the clustering technique they use, different approaches have been proposed. The first attempt in this line of work is due to Froehlich et al. [2008], who analyzed a dataset from the Barcelona Bicing system by means of clustering techniques. The data correspond to station occupancy statistics in the form of free slots, available bikes over several time frames, and other station activity statistics derived from station oc-cupancy raw data collected every 5 minutes. The clustering is then performed using a Gaussian mixture model estimated by an EM algorithm. In Froehlich et al. [2009], two clusterings are compared, both being performed by hierarchical aggregation. The first one uses activity statistics derived from the evolution of station occupancy, while the second uses directly the number of available bicycles along the day. Other studies like Lathia et al. [2012] use similar clustering techniques and data to study the effect of changing the user access policy in the London Barclays cycle hire scheme. The authors investigate how the change affected the system usage throughout the city via both spatial and temporal analysis of station occupancy data. As in Froehlich et al. [2009], each station is described by a time series vector that corresponds to the normalized available bicycle value of the station along the day. Each element of the feature vector is therefore equal to the number of available bicycles divided by the station size (the 95th percentile of the sums of free slots and available bikes). These time series are then smoothed using a moving average and clustered using a hierarchical agglomerative algorithm [Duda et al. 2001, see p. 552] with a cosine distance.

Other approaches closer to the one proposed here use trip data to build station us-age profiles and perform the clustering on this basis. One such example is the recent study of Borgnat et al. [2013], who use different graphs to describe the similarity of usage profiles (in terms of arrivals/departures count correlations) between pairs of sta-tions for weekdays and weekends. The resulting four graphs (departures weekdays, arrivals weekdays, departures weekends, arrivals weekends) are then thresholded and summed together to provide a single graph that gives the global similarity in terms of usage between the stations. This final graph is then analyzed using a community detection algorithm, based on modularity optimization [see Newman 2006, for details on modularity clustering], which provides clusters of stations with similar usage pro-files. Another piece of research that uses the same type of data was proposed by Vogel order to better understand temporal and spatial causes of imbalances between BSS stations. The proposed methodology, based on the Geographical Business Intelligence process, was successfully applied to data collected from Vienna X  X  BSS (Citybike Wien). It used feature vectors to describe the stations that come from normalizing arrival and departure counts per hour and also handled weekdays and weekends separately. Classical clustering algorithms, namely, K-means, Gaussian mixture model estimated through the EM algorithm, and sequential information-bottleneck (sIB), were then compared.

Lastly, Borgnat et al. [2011, 2013] consider other approaches that do not partition stations with respect to their usage profiles but with respect to the way they exchange bikes. This dynamic complex network view of the problem uses graph clustering algo-rithms to identify communities of stations that exchange bikes in a preferential way. Using several temporal aggregation schemes enables the investigation of the dynam-ics of the system in particular contexts. Another line of work is also investigated in Borgnat et al. [2011], where clustering tools are used to partition the flows between stations that exhibit similar usage profiles and not the stations themselves.
In this article, we investigate the analysis of BSSs through the clustering of their stations with respect to their usage data. Before detailing the proposed model and the estimation procedure, we position our work with respect to the related work presented earlier and describe the count statistics used by the model to achieve the clustering. The approach undertaken here follows the line of research initiated by Froehlich et al. [2008] and pursued in Vogel et al. [2011], Borgnat et al. [2013], and Lathia et al. [2012], but with a new tool tailored to fit the specificity of the data. As in the previous studies related to BSS station clustering, the method investigated here aims to identify groups of stations with similar usage profiles, but it differs from these studies on a number of points. First, it differs from the work of Froehlich et al. [2008] and Lathia et al. [2012] since it does not use the station occupancy data but arrivals/departures count time series derived from trip data to describe the stations. This description of the stations is significantly more detailed than station occupancy statistics. In particular, it is able to differentiate between situations when a lot of bikes come to and leave from a station and the cases where there is no activity at the station, whereas the descriptions built from station occupancy data cannot account for such a difference. The proposed model can also deal with the differences in behavior observed during weekdays and weekends. As noted by several authors [Borgnat et al. 2013; Vogel et al. 2011], there are great differences between the two and this must be taken into account when performing the clustering. These differences are handled directly by the model proposed in this article whereas it was handled through data preprocessing and feature construction in the two previous studies. Furthermore, the station usage count for each available day will be processed by the model and not a summary over a long period, which may be affected by seasonal or meteorological factors. Lastly, the proposed model can handle the specific nature of the observations (i.e., that they are counts and therefore belong to N ), whereas previous solutions do not use this particularity.

To achieve these goals, we propose a generative mixture model and derive the asso-ciated EM algorithm to estimate the parameters of the model and the clustering. This work adopts, therefore, the model-based clustering framework [Mclachlan and Peel 2000; Fraley and Raftery 2002], with specific hypotheses related to the phenomena under analysis as discussed in the following paragraphs. We begin with a more formal description of the count time series construction and then introduce the notations used in the rest of the article. The target dataset of the proposed method corresponds to classical trip data recorded on BSS. It contains the following information for each trip: station of departure, time of departure, station of arrival, time of arrival, and possibly a type of user subscription (day/year). This last piece of information is not used in the proposed model since its nature may depend on the BSS implementation and is therefore not generic enough. These raw data can be used to derive the following counts statistics to describe station usage: h  X  X  1 ,..., 24 } ;  X  X in sdh : arrival count for station s  X  X  1 ,..., S } during day d  X  X  1 ,..., D } and at hour h  X  X  1 ,..., 24 } .
 The aggregation at 1 hour was used to produce the counts since it gives a good tradeoff between resolution of details and fluctuations [Borgnat et al. 2011]. These two time se-ries of counts are then concatenated in a vector X sd describing the arrival and departure activity of station s during day d : These activity vectors can then be arranged in a tensor (or three-way array) of size N  X  D  X  T ,with N the number of stations, D the number of available days in the dataset, and T the length of the description vector, here 48 since nonoverlapping windows of 1 hour are used to compute the arrivals and departures counts. Since the observed data are counts, we propose to use Poisson mixtures to build the generative model. Poisson mixtures have already been used successfully in several applicative domains and can take different forms depending on specific assumptions [Rau et al. 2011; Thomas 2010; Karlis and Meligkosidou 2003; Govaert and Nadif 2010]. As in this earlier work, we will consider that conditionally on the clusters, the observed variables are drawn from Poisson distributions, but we will adapt the model to our needs by making further hypotheses on the model parameterization. The generative model that we propose uses two additional sets of variables. The first is a classic one corresponding to indicator variables (denoted by Z s ) encoding the cluster membership of the stations and taking their values in Z ={{ 0 , 1 } K : k Z sk = 1 } ,with K the number of station clusters; these variables are not observed and must be obtained. The variables in the second set denoted by W d are also indicator variables, but they are attached to the days and encode the differences between weekdays and weekends (which present very different usage profiles). These variables take their value in W ={{ 0 , 1 } 2 : l W dl = 1 } and we consider that they are observed. Using these two sets of variables, the following generative model is then assumed for the observed data: with P (  X  ) the Poisson distribution of parameter  X  and M (1 , X  ) the multinomial dis-tribution of parameter  X  . This generative model assumes therefore that, knowing the cluster of the station and the cluster of the day, the departure and arrival counts of each hour are independent, and that they follow a Poisson distribution of parameter  X  s  X  kl t . The parameter  X  s is a scaling factor specific to station s and will capture the global activity of the station. The parameters  X  kl t describe the temporal variations of depar-tures/arrivals and are specific to each station cluster and day type (weekday/weekend). For the parameters to be identifiable, we must have constraints on the  X  . The fol-lowing constraints will ensure that the model is identifiable up to the permutation undetermination, which is unavoidable in all mixture models: with D l = d W dl the number of days in day cluster l . The conditional independence assumption relates this model to the naive Bayes model and can be criticized; it is nonetheless a good first approximation. The Poisson hypothesis is natural for count data, and furthermore it enables the introduction of the station scaling factor  X  s [Rau et al. 2011; Govaert and Nadif 2010]. These scaling factors are necessary to produce useful results since stations may share a common usage profile but differ strongly in terms of departure/arrival volume. Using these assumptions, the conditional density of an activity vector x sd can be derived as with p ( .,  X  ) the density of a Poisson distribution of mean  X  . Parameter estimation and station clustering with such a model is performed in the classical maximum likelihood framework. The log-likelihood must therefore be derived. It is given by The maximization of this quantity can be achieved by an EM-type algorithm described in the next section. The EM algorithm [Dempster et al. 1977; Mclachlan and Krishnan 1996] is a popular algorithm for maximum likelihood estimation in statistics when the problem involves missing values or latent variables. It is an iterative algorithm that alternates between maximizing a lower bound of the log-likelihood and updating the bound. This bound is classically obtained from the completed likelihood that introduces the latent variable Z : During the E step of the algorithm, the conditional expectation of this function over Z with respect to the current parameter values is computed. This expectation will provide the lower bound of the log-likelihood, which will be maximized during the M step. This expectation is given by where the t sk are the a posteriori probabilities (given that the current parameters estimate ( q ) ) of each cluster given by These quantities are computed during the E step of the algorithm. During the M step, this expectation is maximized with respect to the parameters in order to increase the likelihood. This maximization, detailed in Appendixes A and B, leads to the following update rules: The update formulas have natural interpretations; the scale factor of station s ,  X  s , is simply given by the average of its activity vectors along all the time frames and days. Since they do not depend on the t sk , they can be computed only once. The proportions  X  k are classically updated using the a posteriori probabilities of each cluster. The are given by a weighted mean of the activity of cluster k stations in day cluster l and time frame t . Lastly, the E and M steps are iterated to build an EM algorithm (see Algorithm 1), which will converge toward a local maximum of the log-likelihood. This algorithm was implemented in R [R Core Team 2012] and the source code of this implementation is available upon request to the author.

Before exploring the results obtained with this model on a 1-month trip dataset historical background are provided in the next section. Since 2001, the city of Paris has deployed urban policies aiming to favor public trans-portation and soft modes of transport such as bicycles, walking, and so forth. Within this context, the V  X  elib X  bike sharing system was launched in July 2007. V  X  elib X  is op-erated as a concession by Cyclocity, a subsidiary company of the French advertising corporation JCDecaux. Seven thousand bikes were initially distributed on 750 fixed stations. Five years ago, the V  X  elib X  system was extended to 20,000 bikes spread out over 1,208 fixed stations, with 224,000 annual subscribers making on average 110,000 trips each day. V  X  elib X  is a large-scale scheme, the second largest BSS in the world after a BSS launched in China. V  X  elib X  is available mainly in Paris intramuros , some stations being located in the suburbs.

V  X  elib X  offers a nonstop service (24/7). Each V  X  elib X  station is equipped with an au-tomatic rental terminal. The whole network includes 40,000 docking points (between eight and 70 per station). The bikes are locked to the electronically controlled docking points. Users can purchase a short-term daily or weekly subscription or a long-term annual subscription. The subscription allows an unlimited number of rentals, the first half hour (or the first 45 minutes for a long-term subscription) of every individual trip being free. Registration of users is required. The bicycles can be hired at any of the stations and at any time and returned back at any other station and at any time.
Despite the boost in bike use in Paris that followed the introduction of the BSS, the cycling modal share is still very low compared to other cities in Europe. Analyzing modal splits [B  X  uttner et al. 2011] in Paris can give hints about the local cycling culture. Cycling share is still very low in Paris (3%) but has been on the increase in the last few years. The modal share of BSS is about 2%. Public transport has an estimated modal share of 40%, while car share is estimated at 21% [APUR 2006]. Even if France does not have a strong cycling culture (the primary purpose of cycling is leisure), people seem to be very enthusiastic about public bike plans. Bikes are considered to be environmentally friendly by 62% of people in France [APUR 2006].
 The aim here is to obtain some general statistics to highlight global trends in V  X  elib X  usage. The dataset used to estimate these global statistics and analyze the results of the proposed methodology corresponds to 1 month of trip data recorded in April 2011. This corresponds to roughly 2,500,000 trips after data cleansing. The data were cleansed by just removing trips with a duration of less than 1 minute and with the same station as point of departure and destination. These trips correspond to user misoperation and not to real trips.

Figure 1 shows the whole number of recorded V  X  elib X  trips per hour and day of the week during a month, with respect to the type of subscription (day or year). It shows that V  X  elib X  usage is closely linked not only to the hour and the day but also to the kind of day (weekday or weekend) and to the type of subscription.

A first significant difference in V  X  elib X  usage between short-term and long-term sub-scribers can be seen. This difference is reflected in terms of the usage volume: most of the V  X  elib X  trips are generated by long-term subscribers, even if the difference be-tween the two subscriptions is smaller during the weekend. This can be linked to the fact that short-term subscriptions are mainly associated with leisure, while long-term subscriptions tend to cover the users X  X  daily mobility routines.
 This figure also shows a difference in V  X  elib X  usage during weekdays and weekends. A cyclostationarity pattern can be seen in V  X  elib X  usage during weekdays. Three peaks of weekday usage can be observed in Figure 2: the two most significant correspond to the commutes (8 a.m. and 6 p.m.), while the third one at 12 noon corresponds to the lunch break. As can be expected, the morning peak usage disappears during the weekend, where V  X  elib X  usage gradually increases to reach a maximum in the afternoon. It should be noted that Friday is the peak usage for weekdays. These temporal trends of BSS usage can provide information on the sociological characteristics of the city. Considering the study carried out by Froehlich et al. [2009] on the Barcelona Bicing system, some sociological differences between the two cities can indeed be highlighted. The lunch peak occurring at 2 p.m. in Barcelona Bicing data occurs at 12 noon in V  X  elib X  data, reflecting thus the late lunch culture of Spain (the earlier lunch culture of France, respectively). Second, Friday is the least active day in Barcelona Bicing usage (resp. the most active one in V  X  elib usage).
 closely linked to geographical aspects of the city can also be identified. Figure 3 shows the average number of observed departures and arrivals per hour with respect to the distance from the station to the center of Paris. It is clear that the closer the station is to the center of Paris, the greater this mean activity. Furthermore, the duration and distance of trips can also be used as indicators of V  X  elib X  usage. As shown in Figure 4, half of the V  X  elib X  trips last 12 minutes. This can be linked to the V  X  elib X  pricing policy (free for half an hour). It should be noted that the trips recorded with null distances correspond to round trips; that is, users rent bikes from and return them to the same station.

These first statistics show the global dynamic of the V  X  elib X  system. Let us now exam-ine the clustering results obtained using the proposed statistical model to automatically extract finer details from BSS data. Count series for each station were derived from the cleansed raw trip data as described in Section 3.1 and used for the algorithm. The final formatted data correspond in the V  X  elib X  case to a tensor of size 1,185 (the number of stations) times 30 (the number of available days) times 48 (the number of counts in the station profiles). Before discussing in detail the results obtained with a particular number of clusters, it is necessary to look at the methodology and the results that we used to select this value. The proposed algorithm was tested on these data with a varying number of clusters from 1 to 25. To pick an appropriate value for the number of clusters, the evolution of the model log-likelihood with respect to the number of clusters was analyzed. This curve is depicted in Figure 5 and presents an elbow around eight clusters; above this heuristic, a value of eight seems therefore to be a good candidate for the number of clusters. We therefore choose to analyze in more detail the clustering found for K = 8 in this section. A first way to investigate the nature of the different clusters found is to look at their temporal profiles given by the parameters  X  of the model. In order to give a clear overview of these profiles, we organize them according to the nature of the count (departures/arrivals), in rows, and to the day type (week/weekend), in columns.
The results for two specific clusters are presented in Figure 6. We name the first cluster  X  X ailway stations X  and the second  X  X arks, X  because these two clusters corre-spond to stations close to these two kinds of amenities. This can easily be seen from the corresponding maps also presented in Figure 6, which show the cluster station posi-tions above a map background, which presents the metro and railway lines, the parks, and the Seine. The relationship between these two clusters and their corresponding amenity is clearly shown. The temporal profiles of these two clusters also present inter-esting points: the profile of the  X  X ailway stations X  cluster shows much activity around peak hours for both departures and arrivals, the other time frame being the average of the total station population. The  X  X arks X  profiles give a totally different picture, with a rush of activity during the weekend afternoons and low activity during the weekday peak hours. The maps (see Figure 6) that depict the positions of the cluster stations confirm the interpretation of these two usage clusters. All the railway stations of Paris are clearly visible on the first map, along with several important metro stations like Nation, Denfert-Rochereau, Porte d X  X rl  X  eans, and Vincennes. The map of the stations that belong to the  X  X arks X  cluster also gives a clear view of the nature of this cluster: all the stations are close to parks like Vincennes, Buttes-Chaumont, Montsouris, La Villette, and so forth.

The remaining clusters shown in Figures 9 and 10 can also be explained in terms of geography and demographics. The  X  X pare-time (1) X  and  X  X pare-time (2) X  clusters present high activity values during the night. The difference between these two sets of stations appears during the weekend, when the  X  X pare-time (2) X  cluster has a higher activity. From a geographical point of view, these stations also correspond to specific parts of the city that are close to important tourist places like the Eiffel Tower, the Cit  X  e des sciences et de l X  X ndustrie (science museum complex), the old historical center of Paris, and so forth, whereas the stations from the  X  X pare-time (1) X  cluster are in neighborhoods with known night activities like Pigalle, Mouffetard, and so forth.
The  X  X ousing X  cluster has an asymmetrical profile, with a lot of departures during the morning rush but few arrivals, and the reverse during the end of the work peak. These stations belong to a belt surrounding the center of Paris, which presents the high population density visible in Figure 7.

The next two clusters,  X  X mployment (1) X  and  X  X mployment (2), X  present a reverse asymmetry to that of the  X  X ousing X  clusters: a lot of arrivals during the morning rush but few departures, and the reverse during the end of the work peak. These two clusters are correlated to the employment density as shown in Figure 8. During the weekend, the two clusters present differences, with more activity in stations from  X  X mployment (2). X  Finally, the last  X  X ixed X  cluster appears to be the stations having a mixed usage with an average temporal profile and no specific features. The previous observations concerning the relationships between the clusters and the nature of the neighborhoods of the stations that belong to them made through the anal-ysis of the maps presented in Figures 7 and 8 can be quantitatively investigated. To this end, the per-cluster average of additional socioeconomic variables (population den-sity, employment density, services (restaurants, hairdressers, etc.), and shops density) have been computed (see Table I). An analysis of variance confirms that the station clusters derived from BSS usage data are significantly different with respect to these four variables. As expected, the local density of inhabitants is particularly high for the  X  X ousing X  cluster, the density of employment being, at the opposite end, high for the  X  X mployment (1) X  and  X  X mployment (2) X  clusters. Finally, the shops and services densities are high for the  X  X pare-time X  clusters. This article has presented a new model-based clustering methodology to explore the usage statistics generated by BSSs. This model introduces a latent variable to encode station cluster membership and an observed variable that deals with the difference in usage between weekdays and weekend. Conditionally, on these variables the observed counts are assumed to be Poissonians and independent. Their intensities take into account a station scaling factor that handles the differences between the global station activities. An EM algorithm was then derived to estimate the parameters of the model. The methodology was tested to mine 1 month of usage data from the Paris V  X  elib X  system. The clustering found is rich with interpretable clusters that are easily linked to the presence of certain types of amenities such as parks and railway stations and to sociological variables like population, job, and service densities.

Such a clustering tool, which is an exploratory technique, may serve as a first step toward the initial applicative objectives: urban planning, firm location, and BSS fleet management. The clustering model results can be particularly used to calibrate simulation tools from the operational research field with realistic values to optimize bike redistribution policies and plan new BSSs (position, size of the stations, bike fleet size, etc.). Furthermore, the crossing of the clustering results with socioeconomical and geographical variables gives clues on the important aspects of the city that explain the demand variation and may therefore help to design new predictive demand models used by urban planners to position and dimension the BSS stations. Eventually, the spatial analysis of the discovered clusters may be helpful to understand a complex metropolitan and can benefit from a variety of applications, such as location choosing for a business, advertisement casting, and social recommendations [Yuan et al. 2012].
The proposed methodology is obviously very general and can be applied to many other problems involving data that could be obtained on urban activity. Data produced by a self-service vehicle system obviously can be analyzed using the same methodology. Similarly, data collected by public transportation fare collection systems, if available in the origin X  X estination form, can be analyzed by the proposed methodology in order to extract mobility patterns.
 Concerning the BSS application of the method, interesting open questions remain. For example, previous studies carried out on BSSs mainly use station occupancy statis-tics to describe station usage. It would be interesting to conduct a comparative study to quantify how the clustering results are affected by the type of data (occupancy statistics/ trip data) we use to obtain the partition. This will require availability of both types address the problem of demand estimation. This problem affects all the studies done with usage data since, by definition, they only contain information on the satisfied part of the demand. The unsatisfied part of the demand, which corresponds to the users that have left the system for bike unavailability reasons, do not leave numerical traces in the system records. Developing tools to handle this issue by trying to estimate the unsatisfied part of the demand is therefore a challenging and interesting direction for future research.
 From a methodological point of view, there is also room for possible improvements. Because of the limited data size (1 month) used during the experiments, further in-vestigations involving a larger dataset (collected over the year, for example) have to be made in order to take into account the influence of seasons and weather conditions. The proposed mixture model framework is flexible enough to easily take into account this season variability. Adding an observed variable linked to weather conditions could be an interesting way to handle this issue. Also, the naive assumption of conditional independence between the time frames could perhaps be removed with profit using approaches like Karlis and Meligkosidou [2003] and Thomas [2010]. The use of zero inflated Poisson or negative binomial laws to model the observed counts would also deserve to be tested and compared with the approach proposed here. Lastly, the use of a mix-membership mixture model like LDA [Blei et al. 2003] will be interesting in order to describe the mixed nature of the city neighborhoods.
 The optimization must take into account the constraints l , t D l  X  kl t = DT ,  X  k  X  { 1 ,..., K } ,with D associated with these K equality constraints is given by with  X  k the Lagrange multiplier associated with the k th constraints. The partial deriva-tive of this lower bound with respect to  X  kl t is given by The Lagrange multipliers can be obtained by setting these equations to zeros as fol-lows: The update formulas for the  X  kl t are then given by The partial derivative of the lower bound with respect to  X  s is given by The update rules for these parameters are obtained by setting these derivatives to zero, which leads to
