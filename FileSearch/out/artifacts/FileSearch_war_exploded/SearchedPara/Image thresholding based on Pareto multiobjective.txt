 A. Nakib, H. Oulhadj, P. Siarry n 1. Introduction
Image segmentation is the most important component of any image analysis system. Consequently, this problem received a great deal of attention; as a consequence, giving a complete survey of the literature in this paper would be too space-consuming. However, the most important thresholding methods can be found in this recently published review ( Sezgin and Sankur, 2004 ).

Image thresholding is definitely one of the most popular segmentation approaches to extract objects from image, e.g. (Gonzalez et al., 2004 ). It is based on the assumption that the objects can be distinguished by their gray levels. In the case of a simple thresholding (two classes), the optimal threshold is the one that permits to separate different objects from each other or different objects from the background ( Gonzalez et al., 2004 ;
Otsu, 1979 ). The automatic fitting of this threshold is one of the main challenges of image thresholding.

The progress due to optimization techniques was very important during these last years. Many metaheuristic methods, such as genetic algorithms ( Bhanu et al., 1995 ) and recently particle swarm optimization ( Nakib et al., 2007 ; Zahara et al., 2004 ) have been applied to image segmentation problems. Zahara et al . proposed a hybrid Nelder-Mead particle swarm optimization method to handle the objective function associated to Gaussian curve fitting for multi-level thresholding. However, curve fitting is unusually time-consuming for multilevel thresholding and when the optimal threshold is not located at the intersection of the
Gaussian curves it may never be found. In Bhanu et al. (1995) the authors attempt to use a genetic-based segmentation algorithm in a real-time application. However, the segmentation result de-pends on the segmentation algorithm which is employed and the executing times are far from real-time processing rates. simultaneous optimization of some criteria gives satisfactory results and increases the ability to apply one same technique to a wide variety of images. We also show that segmenting with a threshold which optimizes more than one criterion helps to overcome the weaknesses of these criteria, when used separately. optimization) is an extension of the optimization technique allowing several objectives to be optimized simultaneously.
Several metaheuristics have been developed for MO problems, including particle swarm optimization ( Coello-Coello and Salazar
Lechuga, 2002 ), ant colony optimization ( Doerner et al., 2004 ), genetic algorithms ( Deb et al., 2002 ), simulated annealing (Engrand, 1997 ), and many others, a description of some of them can be found in Collette and Siarry (2002).
 called Thresholding using Pareto MO (TPMO), is proposed, that combines the flexibility of multiobjective fitness functions with the power of an enhanced version of the most popular multi-objective genetic optimization algorithm NSGA-II ( Deb et al., 2002 ) for searching vast combinatorial state spaces. we introduce the problem of multi-level image thresholding as a multiobjective problem. In Section 3, the mathematical formulation of the different criteria is given in the first part of the section; in the second part, we present the proposed algorithm based on Pareto MO. In Section 4, we illustrate the obtained results through the proposed image thresholding algorithm. The paper ends with a brief concluding section. 2. Formulation of multi-level image thresholding as a MO problem
In this section, we show that the segmentation problem can be formulated as a multiobjective optimization problem. In most cases this problem is NP-hard.

The segmentation of an image I , using, for example, a homogeneity criterion A , is defined as a partition P = R I where: n is the number of regions.
 I  X [ R i ; i A  X  1 ; n
R connected region ; 8 i A  X  1 ; n
A  X  R  X  X  True ; 8 i A  X  1 ; n
A  X  R [ R j  X  X  False ; 8 i A  X  1 ; n ; for all connected regions  X  R
We note that the uniqueness of the segmentation result is not guaranteed by the conditions above. The results of segmentation do not only depend on the information contained in the image, but also on the used method to find the optimal solution.
Generally, to force the uniqueness of the solution, regularization is obtained by constraining the problem. This constraint consists in optimizing a function F , characterizing the quality of a good segmentation. Then, the last condition is: F  X  P  X  X  Min partitions of I .

It is clear that this condition does not entirely solve the problem of uniqueness of the segmentation. Indeed, some segmentations may have the same optimal solution P n . This explains the need for using metaheuristics to solve the optimiza-tion problem.

In the literature several criteria to regularize the segmentation problem are presented ( Sezgin and Sankur, 2004 ). In the following, we will deal with the non-parametric criteria based on the image histogram analysis. The advantage of using non-parametric criteria is that the method can be used independently of the shape of the image histogram: multimodal or unimodal.
Then, the optimal vector of thresholds can be searched in the gray-level space.

Looking at the literature, we can say that there is no single criterion able to regularize the segmentation problem for all kinds of images. Then, our approach consists in optimizing several functions simultaneously, in order to have a good segmentation on more kinds of images than when the criteria are used separately. Then, to optimize simultaneously some criteria, we used Pareto MO technique.

Consequently, the segmentation problem can be formulated as an MO problem: Minimize = Maximize f m  X  t 1 ;:::; t N 1  X  m  X  1 ; 2 ;:::; M
Subject to 0 o t 1 o o t N 1 o L where M is the number of criteria used for the segmentation, t segmentation thresholds, and L the number of gray levels. 3. Proposed method
In this section, we describe the proposed segmentation method. In the first part, we define the different used criteria. In the second part, the optimization technique is presented, then a brief presentation of NSGA-II is given, followed by its enhance-ment. The proposed method is based on the assumption that the number of segmentation classes is known. Fig. 1 illustrates the principle of the proposed method. A detailed description of the different parts is presented thereafter. 3.1. Segmentation criteria 3.1.1. The biased intraclass variance criterion
The biased intraclass variance results from the changes applied to the interclass variance used in the Otsu method ( Otsu, 1979 ). Improvements include the addition of parameters which guaran-tee a segmentation of higher quality. The new expression of the segmentation criterion is: MVar  X  T  X  X  a where T ( t 1 , y , t N 1 ) is the vector of thresholds and N the number of classes to segment s 2 int is the intraclass variance defined by s 2 int  X  j  X  X  P i A C the class C j and p i the probability of the gray level x coefficient equal to number of pixels in the image and NR the number of regions (connected components) within the segmented image. This coefficient is used to normalize and to penalize the segmentation which forms too many regions.

It is chosen so that the term s 2 int  X  j  X  = b j is low for the large classes.

The term b 1 j  X  1 = 1  X  log  X  N j  X  is high for non-homogeneous regions (typically, large ones), N j being the number of pixels in the N is equal to the area of many other regions in the segmented image (typically, small regions). R ( N j ) is the number of regions of denominator N j forces g j to be close to zero for large regions.
Then, the problem of the segmentation of an image consists in finding the optimal thresholds minimizing expression (1): T  X  Min f MVar  X  t 1 ;:::; t N 1  X g  X  2  X  where 1 o t 1 o t 2 o y o 225. 3.1.2. Shannon entropy criterion The entropy of an image is given by the relation: H  X  where p i is the probability of the gray-level i in the image, represented by its normalized histogram, and L is the total number of gray-levels. In the case of two classes segmentation, we denote the first class by A and the second by B and we assume that the first class corresponds to gray-levels greater than the thresh-old value ( t ) and the second one to gray-levels lower than t . Then, the method is based on the assumption that the background and the objects have two independent probability densities: Class A : p 1 P Class B : p t  X  1 P where P A and P B denote the accumulated probabilities of the two classes A and B.

We define the entropies H t ( A ) and H t ( B ) corresponding to the classes A and B , respectively, by
H  X  A  X  X 
H  X  B  X  X  Then, the total entropy H t ( I ) of an image I is given by H  X  I  X  X  H t  X  A  X  X  H t  X  B  X  X  8  X 
Consequently, in the case of the segmentation of an image I into N classes, the total entropy is defined by H  X  I  X  X  the class number i .

The optimal segmentation threshold vector is that maximizing the total entropy defined in (9). Therefore, the segmentation problem can be formulated as an optimization problem:
T  X  Min 3.1.3. The two-dimensional entropy criterion approach to the two dimensional case by adding more informa-tion about the spatial pixel distribution. It consisted in a two dimensional image histogram, by adding a matrix that charac-terizes the spatial distribution of the pixels (the co-occurrence matrix of pixels, filtered image, etc.).

It allows highlighting the textures within the image. An element of the co-occurrence matrix CM ( x , y ) represents the number of times the gray-level x is adjacent to the gray-level y in the horizontal direction; a detailed analysis of the co-occurrence shape of the co-occurrence matrices of test images house and plane . These test images are from the Berkeley segmentation database ( Berkekey, 2007 ).
 quadrant 1, the included coefficients belong to the image background, on the contrary in the quadrant 2 the coefficients correspond to the foreground of the image or vice versa. However, the quadrants 3 and 4, made identical by construction of a symmetric matrix, contain coefficients related to the transitions between the image background and foreground. These coefficients are mostly low and negligible ( Corneloup et al., 1996 ). The two dimensional entropy of one class k is given by:
G  X  X  where p ij are normalized coefficients of the co-occurrence matrix and P k is the cumulative probability of the k class.
 Then the total entropy in the case of N classes is G  X  I  X  X 
The optimal segmentation thresholds are those maximizing the total entropy 2D given in (12). Therefore, the formulation of the problem as an optimization problem is given by:
T  X  Min where L is the total number of gray-levels. 3.2. TMPO algorithm
The genetic algorithm we used is based on NSGA-II (elitist non-dominated sorting genetic algorithm). The aim of the improved
NSGA-II module is to figure out the exact Pareto points effectively and maintain diversity in the meantime. The original NSGA-II algorithm consists of five operators: initialization, constrained nondominated sorting, crossover, mutation and elitist crowded-comparison operator. The details of the complete method can be found in Deb X  X  paper ( Deb et al., 2002 ). The improved module does not maintain all the operators of the original NSGA-II, and the modification is operated on the mutation operator.
The mutation used is inspired from the Schwefel mutation (Sch  X  utz and Schwefel, 2000 ). Each variable is mutated according to a normally distributed random number d i N  X  0 ; s 2 i t  X  t  X  d i and the variance s 2 i is obtained by mutating the strategy parameters (step sizes) s I according to: s  X  s i  X  as i N  X  0 ; 1  X  where a =1.50 (set empirically).

The choice of NSGA-II is motivated by its good performance on various multiobjective optimization problems, as it was shown in (Shukla and Deb, 2007 ). 3.3. Parameter fitting
The stopping criterion we used is based on the number N g generations. This number is defined by: N g =5 N c , where N number of classes, assumed known a priori. The used selection is that implemented in the original NSGA-II: tournament selection, and we fixed the number of tournaments at 5, empirically. The goal of this operator is to increase the diversification in the population. If we take more than 5 tournaments, the result will not be improved, since the best result is already reached and the computation cost will be increased. However, if we take less than 5 tournaments, the population will not be enough diversified and we will not be sure to obtain the best solution.

The crossover parameter is fixed at 0.5. The Fig. 4 illustrates the different steps of the optimization algorithm. The population size is defined by N =20 N c . 3.4. The thresholding algorithm
From previous subsections, the proposed algorithm consists in the optimization simultaneously of the functions MVar , H and G . Then, the optimal threshold vectors correspond to the Pareto solution. 4. Experimental results and discussion
In this section, we present the results obtained via the application of our method to different kinds of images. This section is divided into two parts; in the first subsection, we evaluate the performance results in comparison with those of five other methods: EM algorithm based method (EM) ( Bazi et al., 2007 ), one method based on valley-emphasis (VE) ( Ng, 2006 ), Otsu method (1979) , Kapur et al. method (1985) and Sahoo and Arora (2006) method based on two-dimensional Tsallis entropy (TE).
The algorithms are coded in Matlab version 7 and are run on a 2.26 GHz Pentium4 personal computer, under Microsoft Windows XP pro Operating system. 4.1. Evaluation of the performance based on synthetic images
We used a synthetic image with different degrees of noise measured by PSNR (peak signal to noise ratio) ( Fig. 5 ).
In order to measure the performance of the segmentation, we used the criterion of error misclassification ( ME ). ME is defined in terms of correlation of images with human observation. It is the ratio of the number of pixels in the background falsely classified in the foreground and vice versa. ME is given by: ME  X  1 where B 0 and F 0 are the background and the foreground of the original image, respectively, B T and F T the background and the foreground of the segmented noisy image, respectively. In the ideal case, ME is 0% and in the worst cases, ME is equal to 100%. The obtained performances ( Table 1 ) show that the TPMO Give the number of classes: k.

Initialize randomly the initial population P 0 of size 10 Nk .
Calculate the various fronts F i of the population P 0 Select in P 0 and create Q 0 by applying genetic operators. While the stopping criterion is unsatisfied do: End of while Return the results: threshold ( t ) and se g mented ima g e. algorithm achieves the best result when the image is slightly noisy (images B, C and D). In the case of highly noisy images (E, F and G), TPMO does not produce the best results. However, its performances remain close to those of EM method. Given the dispersion of the results of the other methods, one can easily conclude that TPMO has, generally, satisfactory performance. 4.2. Application to well known test images The two images used in this second part of the evaluation of
TPMO are selected among the images usually used to test the segmentation algorithms. Fig. 2 ((a) house , (b) plane ) illustrates these two images. Fig. 6 presents the obtained results. The segmentations into two classes are presented in Fig. 6 (a) and (b).
From a visual point of view, the segmentation of the image house is of good quality. Furthermore, the borders of the house are protected well. In the case of the second image representing a plane, we notice that the object plane is globally well extracted from the background, although certain pixels of the fuselage of the plane are missing, because classified in the background and vice versa. The segmentations into three classes are shown in Fig. 6 (c) and (d). In that case, the segmentation of the image house is also of rather good quality, always from a visual point of view.
However, the segmentation of the image plane is worse: more points belonging to the background, in the left of the bottom corner of the image, are stored in the same class of the pixels which composes the plane.
 fronts in the case of segmentation of the images house and plane into three classes. These results are the average of 20 successive executions of the TPMO algorithm. 4.3. Application to MRI images the application of TPMO to biomedical images, in particular the brain MRI images. In this case, the goal of the segmentation is to quickly detect the different spaces and the white matter surrounding the ventricular space. Fig. 8 (a) and (b) illustrate the test images used.

The segmentation results are shown in Fig. 9 (a) X (d). The segmentation into two and three classes of the sane MRI are shown on Fig. 9 (a) and (c), respectively. In both cases, one can notice that the cortex and the ventricles are well extracted. In the pathologic case, the modification of the size of the ventricle due to the atrophy is well extracted too, as well with the segmentation in two classes ( Fig. 9 (b)) than with the segmentation in three classes (Fig. 9 (d)). However, the segmentation of the cerebral cortex requires an improvement.

The average computational cost on our configuration is around 2 s in the case of 2 classes and around 7 s in the case of 3 classes. 5. Conclusion
In this paper, a thresholding method based on Pareto multi-objective optimization (TPMO) was presented. To resolve the segmentation problem, we used an improved version of the well-known evolutionary algorithm NSGA-II. We have adapted the algorithm by changing the stopping criterion and automating the choice of the size of the initial population and the number of generations. The results on various types of images show that this segmentation method is quite efficient. In most cases, these performances are due to the inclusion of several criteria in the segmentation process.
 tion criteria to further improve the quality of the segmented images. These criteria can be classified in a database, according to the type of image to be processed. An expert system could help us to automatically select the suitable criteria to be operated, considering the type of image to be processed.
 References
