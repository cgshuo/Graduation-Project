 Yi Zhuang 1 , Nan Jiang 2 , Zhiang Wu 3 , Dickson Chiu 4 , Guochang Jiang 5 , and Hua Hu 6 Nowadays, with an explosive increase of medical multimedia data in hospital information management systems(H IMS ), many applications require an efficient access most important media types, management, query, and analysis of medical images plays a critical role in modern H IMS s. Although a considerable amount of related work has been carried out on medical image indexing and similarity query in high-dimensional spaces [1][2], most of them focus on a centralized way (i.e., single-PC-based) which cannot scale up well to large data volume. The query efficiencies of these centralized query methods becomes a critically important research topic. 
A Cloud, especially mobile Cloud ( M C ) can be seen as a type of flexible computing infrastructure consisting of many compu ting nodes, which can provide resizable computing capacities to different users anywhere anytime. To fully harness the power image data and support a large number of concurrent end users (e.g., doctors). Additionally, the M C environment provides us with a location-based query that enables doctors to retrieve patient records and images conveniently. To achieve this, scalable, high-throughput, location-based querying and indexing schemes are generally required. However, as shown in Fig. 1, for M C -based medical image query, exploring parallelism attention so far. The challenges include three main aspects: 1) High computation cost in medical image retrieval : for a medical image, three scale . So the query cost of such medical images is very high. 2) The mobility of users in the M C : most of the users (i.e., doctors) in the M C are moving. That means the spatial position of each user varies with the variance of time. So how to perform an optimal data placement is also a challenging issue. 3) The instability and heterogeneity of the M C : the nodes in the M C are instable, that means, some nodes may be down or connected intermittently to the network. The bandwidth of any two nodes in the M C may be different according to the variance of time. There is no guarantee that the total response time of each query can be equal. To address the above challenges, we propose an efficient distributed similarity ( MiMiC ) query processing technique in the mobile cloud environment. The MiMiC includes two enabling techniques, namely, learning-based optimal data placement scheme and bandwidth-conscious multi-resolution-based image data transfer . We have implemented the MiMiC method and extensive experiments indicate that our method is specifically suitable for the large high-dimensional data queries. Without loss of generality, Euclidean Distance is used as the underlying distance function in our research . The contributions of this paper are summarized as follows:  X  We introduce a framework of a bandwidth-aware medical image retrieval in the mobile cloud environment ( MiMiC ) to improve search efficiency, especially for large-scale high-dimensional image repository.  X  We present a learning-based adaptive data placement scheme to maximize the query parallelism at the master node level, in which doctors X  moving trajectories with different departments are sampled and analyzed to get optimal placement positions of the medical image data with different department.  X  We propose a bandwidth-conscious multi-resolution -based image data transfer algorithm to progressively reduce the communication cost in M C environment and speed up MiMiC processing.  X  Extensive experimental studies are conducted to evaluate the efficiency, scalability, and robustness of our proposed algorithm. Preliminary work is given in Section 3. In Section 4, two enabling techniques, viz., the adaptive learning-based data placement scheme and the bandwidth-conscious multi-resolution-based data transfer scheme are introduced to facilitate a fast similar search over mobile cloud. In Section 5, we propose a MiMiC query processing algorithm. In Section 6, we perform comprehensive experiments to evaluate the efficiency of our proposed method. We conclude the paper in Section 7. Medical images have often been used for retrieval systems and the medical domain is often cited as one of the principal application domains for content-based access A
SSERT system [1] on the classification of high resolution CTs of the lung and the I RMA system [2] for the classification of images into anatomical areas, modalities and view points. As both of them are based on a single PC environment, their processing scalabilities are limited, especially for a large volume of the medical images. 
Much effort has been invested in designing distributed storage systems to manage large amounts of data, such as Google File System [3] (G FS ), which serves Google X  X  managing structured data of very large scales. Yahoo proposed P NUTS [5], a hosted, centrally controlled parallel and distributed database system for Yahoo X  X  applications. These systems organize data into chunks, and then randomly disseminate chunks into clusters to improve data access parallelism. Some central servers working as routers are responsible for guiding queries to nodes that hold query results. Amazon X  X  Dynamo [4] provide eventual consistency. MapReduce [6] was proposed to process large datasets disseminated among clusters. bases by providing a near-optimal distribution of data items among the disks. Further-more, Sahin et al. [10] presented a similarity search using disk array. Recently, Peer-to-Peer(P2P)-based similarity search has been received attention increasingly. C AN [11] is the first system supporting multi-dimensional data. These works behave poorly proposed for document retrieval in P2P networks by rotating the dimensions in indexing. Another system also based on C AN proposed by Schmidt &amp; Parashar [12] is indexing schemes in the P2P network environment. Few work, however, have touched on medical image query in M C environment due to the different query mechanism. 3.1 Problem Formulation The list of symbols used throughout the rest of this paper is first summarized in Table 1. D formally denoted as M C =(N,E,T), where N refers to the set of nodes, E refers to a set of edges representing the network bandwidths for data transfer at time T, and T means the time.
 In the above definition, due to the instability and heterogeneity of the M C environment, the bandwidth of any two nodes in M C may be different and variant with the change of the time. D
EFINITION 2. The nodes in M C , formally denoted as N=N q +N m +N s , can be logically divided into three categories: the query node(N q ), master nodes(N m ), and slave i=j  X  [ 1 ,  X  ].
 As defined in Definition 2, in a M C , a doctor submits a query from the query node; the departments and their corresponding indexes; the slave nodes can receive the candidate images (  X   X  ) obtained by image set filtering in the master nodes. Then the refinement conducted. Finally the answer set (  X   X  X  ) is sent back to the query node. 
In addition, for easy illustration, suppose that one department corresponds to a master node and a slave node. So the number of master nodes(  X  ) or the number of the slave nodes(  X  ) equals to that of departments(  X  ), respectively. 3.2 iDistance iDistance [8] is a distance-based high-dimensional index method for similarity search. reduction.  X   X  is added to the result set. we introduce two enabling techniques: a dynamic learning-based data placement scheme and a bandwidth-conscious multi-resolution-based transfer mechanism . Their purposes are to minimize the transfer cost and maximize the query parallelism, respectively. 4.1 Learning-Based Data Placement Scheme in Master Nodes For many existing distributed database systems, the study of data placement is challenges to data placement in such a dynamic environment as explained below. 4.1.1 Motivations The motivations of the learning-based data placement scheme are based on the following key observations: 4.1.2 Mining Doctors X  Moving Trajectories As mentioned above, the efficiency of fast data access is very important to the location-based query in the M C . So the basic idea of this approach is to find an optimal data placement in the M C by first mining doctors X  moving trajectories. First, a doctor object can be modeled by a four-tuple: where The 1 st Stage. In Fig. 3(a), suppose that there are nine doctors in a department. We first calculate the centroid (C1) axis of all the nine doctors by Eq. (2). where | Dep | means the total number of doctors in the department Dep . 
Given centroid C1, a virtual circle region ( V CR ) centered by C1 and radius  X  (see the dash blue circle in Fig. 3(b)) can be obtained, where  X  is a threshold value. So the V CR can be seen as the department region. The doctors inside the V CR are the candidate ones. centroid (C2) axis of them by Eq.(3) (see the shadow circle region in Fig. 3(c)), where C 2 is a final center and r is a radius. where | Can | means the total number of the candidate doctors in the department Dep . 4.2 Multi-resolution-Based Adaptive Data Transfer Scheme As mentioned before, since the pixel resolution of a medical image is usually very high transfer an image with big size to the destination nodes especially in a wireless network. As shown in Fig. 4, the basic idea of our proposed enabling technique is that for a same medical image, the image with different pi xel resolutions can be transferred according to the variance of the network bandwidth. Specifically, for high network bandwidth, the medical image with high-resolution for which doctors can get a high-quality image can be transferred in a reasonable short period of time. On the contrary, in order to get a method is to get a tradeoff between the quality of a medical image and the transferring time under different resolution and current network bandwidth. x
UPPER mean the lower bound and upper bound resolution of the i -th image. Similarly, are the lower bound and upper bound bandwidth of the j -th edge. So the optimal image resolution under the current network bandwidth can be derived as follows: where i  X  [ 1,  X  ] and  X  is a granularity value. value of  X  . Therefore, the pixel resolution of i -th image can be rewritten by Eq. (6). On the support of the above two enabling techniques, a MiMiC query can be efficiently conducted in the mobile cloud environment. The whole query process can be composed of three stages: (namely query image I q , radius r and the department information) from the query node N , the query is sent to the master node level N m ,. (2). Global Image Data Filtering. In this stage, once the query request is received by the corresponding master node j m N , then the irrelevant images in the j m N are filtered quickly by using the iDistance [8] index, thereby the transfer cost from the master node level to the slave one can be reduced significantly. 
Specifically, in this master node j m N , an input buffer called IB is created for caching output buffer OB which is used to store the candidate image set  X   X  ( j ) is also created. candidate images are transferred to the slave node through the package-based data transfer mode. cluster (cf. [8]). (3). Data Refinement. In the final stage, the distances between the candidate images and the query image I q are computed in the corresponding slave node. If the distance is package-based manner. Specifically, in the j -th slave node j S N , we need to set an input buffer OB is set, which is used to store the answer images temporarily. If the data size of the answer image set in OB equals to the package size, then the answer images are sent to the query node N q in the package-based transfer manner. To verify the efficiency of the proposed MiMiC method, we conduct simulation experiments to demonstrate the query performance. The retrieval system is run on Android platform [16] and the backend system is simulated by the Amazon EC2 [17]. For the index part of the system, iDistance [8] is adopted to support quick filtering of medical images deployed at the master node level. The medical image dataset we used is download from Medical image archive [15], which includes 100,000 64-D color histogram features, the value range of each dimension is between 0 and 1. 6.1 Effect of Adaptive Data Transfer Scheme In the first experiment, we study the effect of the adaptive(i.e., multi-resolution-based) image data transfer scheme on the performance of the MiMiC query processing. Method 1 does not adopt the adaptive data transfer algorithm and method 2 uses it. Fig. 5 shows when r is fixed and the bandwidth is relatively stable, the total response time using the method 2 is superior to that of method 1. Meanwhile, with the condition that rapidly that the images can not be sent to the destination nodes quickly. 6.2 Effect of Data Size This experiment studies the effect of data size on the performance of the MiMiC query processing. 
In Fig. 6, with the increase of data size, the response time keeps increasing. When the data size is larger than 60,000, the increasing tendency becomes slowly. This is because always larger than the distance computation cost in the slave nodes. The total response time can be mainly dominated by the transfer cost. Therefore it is more suitable and effective for the large high-dimensional dataset. 6.3 Effect of Radius This experiment tests the effect of radius on the query performance. Suppose that the data size and the number of master(slave) nodes are fixed, when r increases from 0.2 to 1, it is clear that the query response time is gradually increasing. This is because with the increase of r , the search region in the high-dimensional spaces becomes larger and accordingly. processing, which specifically caters for the different bandwidth of nodes in the mobile cloud. Two enabling techniques, namely, learning-based adaptive data placement scheme , and multi-resolution-based adaptive data transfer scheme are proposed to reduce the communication cost. The experimental studies indicate that the proposed MiMiC method is more suitable for the large-scale medical image retrieval in minimizing the network communication cost and maximizing the parallelism in I/O and CPU. 
