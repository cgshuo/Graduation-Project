 Fr  X  ed  X  eric Chazal FREDERIC . CHAZAL @ INRIA . FR INRIA Saclay  X  Ile-de-France, Palaiseau, France INRIA Saclay  X  Ile-de-France, Palaiseau, France Catherine Labru ` ere CLABRUER @ U -BOURGOGNE . FR Institut de Math  X  ematiques de Bourgogne, France LSTA, Universit  X  e Pierre et Marie Curie, Paris Motivations. During the last decades, the wide availabil-ity of measurement devices and simulation tools has led to an explosion in the amount of available data in almost all domains of science, industry, economy and even everyday life. Often these data come as point clouds sampled in pos-sibly high (or infinite) dimensional spaces. They are usu-ally not uniformly distributed in the embedding space but carry some geometric structure (manifold or more general stratified space) which reflects important properties of the  X  X ystems X  from which they have been generated. More-over, in many cases data are not embedded in Euclidean spaces and come as (finite) sets of points with pairwise dis-tance information. This often happens, e.g. with social net-work or sensor network data where each sensor may not know its own position, but may evaluate its distance to the other sensors using the strength of the signal received from them. In such cases, data are given as matrices of pairwise distances between the observations, i.e. as (discrete) met-ric spaces. Again, although they come as abstract spaces, these data often carry specific topological and geometric structures.
 A large amount of research has been done on dimen-sionality reduction, manifold learning and geometric inference for data embedded in Euclidean spaces and assumed to be concentrated around submanifolds; see for instance (Wang, 2012). However, the assumption that data lies on a manifold may fail in many applica-tions. In addition, the strategy of representing data by points in Euclidean spaces may introduce large metric distortions as the data may lie in highly curved spaces. With the emergence of new geometric inference and algebraic topology tools, computational topology (Edels-brunner &amp; Harer, 2010) has recently seen an important development toward data analysis, giving birth to the field of Topological Data Analysis (TDA) (Carlsson, 2009)-(https://sites.google.com/site/nips2012topology/) whose aim is to infer relevant, multiscale, qualitative and, quantitative topological structures directly from the data. Topological persistence, more precisely persis-tent homology appears as a fundamental tool for TDA. Roughly, homology (with coefficient in a field such as, e.g., Z { 2 Z ) associates to any topological space M family of vector spaces (the so-called homology groups) H k p M q , k  X  0 , 1 ,... , each of them encoding topological features of M . The k th Betti number of M , denoted  X  is the dimension of H k p M q and measures the number of k -dimensional features of M : for example,  X  0 is the number of connected components of M ,  X  1 the number of independent cycles or  X  X unnels X ,  X  2 the number of  X  X oids X , etc. (see (Hatcher, 2001)). Persistent homology provides a framework (Edelsbrunner et al., 2002)-(Zomorodian &amp; Carlsson, 2005)-(Chazal et al., 2012) and efficient algorithms to encode the evolution of the homology of families of nested topological spaces indexed by a set of real numbers that may often be seen as scales, such as the sublevel sets of a function, the union of growing balls, etc. The obtained multiscale topological information is then represented in a simple way as a barcode or persistence diagram; see Figure 4 and Section 2.
 In TDA, persistent homology has found applications in many fields, including neuroscience (Singh et al., 2008), bioinformatics (Kasson et al., 2007), shape classification (Chazal et al., 2009b), clustering (Chazal et al., 2011b) and sensor networks (De Silva &amp; Ghrist, 2007). It is usually computed for a filtered simplicial complex built on top of the available data, i.e. a nested family of simplicial complexes whose vertex set is the data set (see Section 2). The obtained persistence diagrams are then used as  X  X opological signatures X  to exhibit and compare the topological structure underlying the data; see Figure 1. The relevance of this approach relies on stability results ensuring that close data sets, with respect to the Hausdorff or Gromov-Hausdorff distance, have close persistence diagrams (Cohen-Steiner et al., 2005)-(Chazal et al., 2009a)-(Chazal et al., 2012)-(Chazal et al., 2013a). How-ever these results are not statistical and thus only provide heuristic or exploratory uses in data analysis. Moreover, The goal of this paper is to show that, thanks to recent re-sults (Chazal et al., 2012)-(Chazal et al., 2013a) that al-low to consider persistence diagrams associated to infinite spaces, the use of persistent homology in TDA can be nat-urally considered in general statistical frameworks and per-sistence diagrams can be used as statistics with interesting convergence properties.
 Contribution. In this paper we assume that the avail-able data is the realization of a probability distribution sup-ported on an unknown compact metric space. We con-sider the persistent homology of different filtered simpli-cial complexes built on top of the data. We study, with a minimax approach, the rate of convergence of the associ-ated persistence diagrams to some well-defined persistence diagram associated to the support of the probability distri-bution. More precisely, we assume that we observe a set of n points p X n  X  t X 1 ...,X n u in a metric space p M , X  q , drawn i.i.d. from some unknown measure  X  whose sup-port is a compact set denoted X  X   X  M . We also assume that  X  satisfies the so-called p a,b q -standard assumption for some constants a,b  X  0 : for any x P X  X  and any r  X  0 ,  X  p B p x,r qq  X  min p ar b , 1 q . We then consider the persistent homology of some filtered simplicial complexes Filt p X  X  and Filt p p X q built on top of X  X  and p X n respectively and we establish convergence rates to zero of the bottleneck dis-tance between their persistence diagrams. The definition of this distance is given in the second section. We illustrate our results when M  X  R d and also discuss the case where the data are corrupted by an additional Gaussian noise. Our approach relies on the general theory of persistence modules and our results follow from two recently proven properties of persistence diagrams (Chazal et al., 2013a)-(Chazal et al., 2009a)-(Chazal et al., 2012). First, as X be any compact metric space (possibly infinite), the filtered complex Filt p X  X  q is usually not finite or even countable and the existence of its persistence diagram cannot be es-tablished from the  X  X lassical X  persistence theory (Zomoro-dian &amp; Carlsson, 2005)-(Edelsbrunner et al., 2002). To overcome this issue we use the general persistence frame-work introduced in (Chazal et al., 2009a)-(Chazal et al., 2012). Notice that although this framework is rather ab-stract and theoretical, it does not have any practical draw-back as only persistence diagrams of complexes built on top of finite data are computed. Second, a fundamental property of the persistence diagrams we are considering is their stability proven in (Chazal et al., 2013a) that estab-lishes a strong connection between the persistence estima-tion problem and more classical support estimation prob-lems.
 Related works. Although it is attracting more and more interest, the use of persistent homology in data analysis re-mains widely heuristic. Despite a few promising results, the statistical analysis of persistent homology is still in its infancy. One of the first statistical results about persis-tent homology has been given in a parametric setting, by Bubenik and Kim in (Bubenik &amp; Kim, 2007). They show for instance that for data sampled on an hypersphere ac-cording to a von Mises-Fisher distribution, the persistence diagrams of the density can be estimated with the paramet-ric rate n  X  1 { 2 . However assuming that both the support and the parametric family of the distribution are known are strong assumptions hardly met in practice. Closer to our approach, statistical analysis of homology has also been proposed recently in (Balakrishnan et al., 2012) when the geometric structure underlying the data is a smooth sub-manifold of an Euclidean space. The persistence diagram of a space contains much more information than the ho-mology of this space. So, it is not surprising that the con-vergence rates for the estimation of the persistence diagram we find in this paper are much slower than the convergence rates of (Balakrishnan et al., 2012) for the estimation of the homology. Our approach is also strongly connected to manifold estimation results obtained in (Genovese et al., 2012b). Our results extend to persistent homology and al-low us to deal with general compact metric spaces. Still in the manifold setting, (Balakrishnan et al., 2013) develops several methods to find confidence sets for persistence di-agrams using subsampling methods and kernel estimators among other approaches.
 Both (Balakrishnan et al., 2013) and our work start from the observation that persistence diagram inference is strongly connected to the better known problem of measure support estimation. As far as we know, only few results about sup-port estimation in general metric spaces are available. For example (De Vito et al., 2012) proposes kernel methods to tackle the support estimation problem. On the other hand, a large amount of literature is available for support estima-tion in R d ; see for instance the review in (Cuevas, 2009). The convergence rate of the estimator p X n  X  t X 1 ,...X to the support of the measure  X  with respect to the Haus-dorff distance is given in (Cuevas &amp; Rodr  X   X guez-Casal, 2004) in R d . Support estimation in R d has also been stud-ied under various additional assumptions such as convexity assumptions (Rodr  X   X guez-Casal, 2007) or through boundary fragments estimation (Korostel  X  ev &amp; Tsybakov, 1993) just to name a few. When the measure has a density with re-spect to the Lebesgue measure, plug-in methods based on non parametric estimators have been proposed in (Cuevas &amp; Fraiman, 1997) and (Tsybakov, 1997).
 A few different methods have also been proposed for topology estimation in non-deterministic frameworks such as those based on deconvolution (Caillerie et al., 2011)-(Niyogi et al., 2011). Several recent attempts have also been made, with completely different approaches, to study persistence diagrams from a statistical point of view, such as (Mileyko et al., 2011) that studies probability measures on the space of persistence diagrams or (Bubenik, 2012) that introduces a functional representation of persistence diagrams, the so-called persistence landscapes, allowing means and variance of persistence diagrams to be defined. Notice that our results should easily extend to persistence landscapes.
 Organization of the paper. The necessary background material is presented in Section 2. The convergence results are established in Section 3 for general metric spaces and in Section 4 for measures supported in R d . Some numerical experiments are given in Section 5. All the proofs of the results are available in (Chazal et al., 2013b). Measured metric spaces. Let us denote p M , X  q a met-ric space, K p M q the set of all the compact subsets of M and d H p C 1 ,C 2 q the Hausdorff distance between two sub-sets C 1 ,C 2 P K p M q (Burago et al., 2001). Note that p
K p M q , d H q is a metric space. Two compact metric spaces p M 1 , X  1 q and p M 2 , X  2 q are isometric if there exists a bijec-tion  X  : M 1  X  M 2 that preserves distances. One way to compare two metric spaces is to measure how far these two metric spaces are from being isometric. The corresponding distance is called the Gromov-Hausdorff distance (Burago et al., 2001). Intuitively, it is the infimum of their Hausdorff distance over all possible isometric embeddings of these two spaces into a common metric space. The Gromov-Hausdorff distance d GH defines a metric on the space K of isometry classes of compact metric spaces (see Theo-rem 7.3.30 in (Burago et al., 2001)). Notice that when M 1 and M 2 are subspaces of a same metric space p M , X  q then d Let  X  be a probability measure on p M , X  q equipped with its Borel algebra. Let X  X  denote the support of the measure  X  , namely the smallest closed set with probability one. In the following of the paper, we will assume that X  X  is compact and thus X  X  P K p M q . Also note that p X  X  , X  q P K . Geometric complexes. The geometric complexes we consider in this paper are built on top of metric spaces and come as nested families indexed by a real parameter. Topo-logical persistence is used to infer and encode the evolution of the topology of theses families as the parameter grows. For a complete definition of these geometric filtered com-plexes and their use in TDA, we refer to (Chazal et al., 2013a), Section 4.2. Here, we only give a brief reminder and refer to Figure 2 for illustrations. A simplicial com-plex C is a set of simplexes (points, segments, triangles, etc) such that any face from a simplex in C is also in C and the intersection of any two simplexes of C is a (possibly empty) face of these simplexes. We do not assume such simplicial complexes to be finite. The complexes consid-ered in this paper can be seen as a generalization of neigh-borhood graphs in dimension larger than 1 .
 Given a metric space X which will also serve as the vertex set, the Vietoris-Rips complex Rips  X  p X q is the set of sim-The  X  Cech complex Cech  X  p X q is similarly defined as the set of simplexes r x 0 ,...,x k s such that the k ` 1 closed balls B p x i , X  q have a non-empty intersection. Note that these two families of complexes only depend on the pairwise dis-tances between the points of X .
 When X is embedded in R d , we can extend the definition of the  X  Cech complex to the set of simplexes r x 0 ,...,x such that the k ` 1 closed balls B p x i , X  q have a non-empty intersection in R d (not just in X ). We also define the  X  -complex as the set of simplexes r x 0 ,...,x k s such that, for some  X   X   X  that depends on the simplex, the k ` 1 closed balls B p x i , X  q and the complement of all the other balls B p x, X  q for x P X have a non-empty intersection in R (equivalently, there exists a ball of radius at most  X  in such that x 0 ,...,x k are on its boundary and the interior of the ball contains no point of X ). Those two complexes have the same homology as the union of the balls B p x, X  q for x P X (see Figure 2). The  X  -complex is a subcom-plex of the Delaunay triangulation and thus only contains simplexes of dimension at most d . The union of the balls B p x, X  q is also the  X  -sublevel set of the distance function to X , d p  X  , X q , and as a consequence, those filtrations provide a convenient way to study the evolution of the topology of the union of growing balls or the sublevel sets of d p  X  , (see Figure 2 and Section 5).
 All these families of complexes are non-decreasing with  X  : for any  X   X   X  , there is an inclusion of Rips  X  p X q in Rips  X  p X q , and similarly for the  X  Cech, and Alpha com-plexes. They are called filtrations . In the following, the notation Filt p X q :  X  p Filt  X  p X qq  X  P A denotes one of the fil-trations defined above. Persistence diagrams. An extensive presentation of per-sistence diagrams is available in (Chazal et al., 2012). We recall a few definitions and results needed in this paper and give the intuition behind persistence.
 Given a filtration, the topology of Filt  X  p X q changes as  X  increases: new connected components can appear, existing connected components can merge, cycles and cavities can appear or be filled, etc. Persistent homology tracks these changes, identifies features and associates an interval or lifetime (from  X  birth to  X  death ) to them. For instance, a con-nected component is a feature that is born at the smallest  X  such that the component is present in Filt  X  p X q , and dies when it merges with an older connected component. In-tuitively, the longer a feature persists, the more relevant it is.
 A feature, or more precisely its lifetime, can be represented as a segment whose extremities have abscissae  X  birth and  X  death ; the set of these segments is called the barcode of Filt p X q . An interval can also be represented as a point in the plane with coordinates p  X  birth , X  death q (see Figure 4). The set of points (with multiplicity) representing the inter-vals is called the persistence diagram dg p Filt p X qq . Note that the diagram is entirely contained in the half-plane above the diagonal  X  defined by y  X  x , since death al-ways occurs after birth. (Chazal et al., 2012) shows that this diagram is still well-defined under very weak hypotheses, and in particular dg p Filt p X qq is well-defined for any com-pact metric space X (Chazal et al., 2013a). The most per-sistent features (supposedly the most important) are those represented by the points furthest from the diagonal in the diagram, whereas points close to the diagonal can be inter-preted as (topological) noise.
 The space of persistence diagrams is endowed with a metric called the bottleneck distance d b . Given two persistence diagrams, it is defined as the infimum of the  X  for which we can find a matching between the diagrams, such that two points can only be matched if their distance is less than  X  and all points at distance more than  X  from the diagonal must be matched (see Figure 3). Note that points close to the diagonal  X  are easily ignored, which fits with their interpretation as irrelevant noise.
 A fundamental property of persistence diagrams, proven in (Chazal et al., 2012), is their stability . If X and  X  X compact metric spaces then one has Moreover, if X and  X  X are embedded in the same space p M , X  q then (1) holds for d H in place of d GH . Note that these properties are metric: they do not involve any probability measure on X and  X  X . Let p M , X  q be a metric space. Assume that we observe n points X 1 ...,X n in M drawn i.i.d. from some unknown measure  X  whose support is a compact set denoted X  X  . The Gromov-Hausdorff distance allows us to compare X  X  with compact metric spaces not necessarily embedded in M . We thus consider p X  X  , X  q as an element of K (rather than an element of K p M q ). In the following, an estimator p X of is a function of X 1 ...,X n that takes values in K and is measurable for the Borel algebra induced by d GH . Let Filt p X  X  q and Filt p p X q be two filtrations defined on X and p X . The statistical analysis of persistence diagrams pro-posed below starts from the following key fact: according to (1), for any  X   X  0 : where the probability corresponds to the product measure  X  b n . Our strategy then consists in estimating the support X  X  with respect to the d GH distance. Note that this gen-eral strategy of estimating X  X  in K is not only of theo-retical interest. Indeed, as mentioned in the introduction, in some cases the space M is unknown and the observa-tions X 1 ...,X n are just known through their pairwise dis-tances  X  p X i ,X j q , i,j  X  1 ,  X   X   X  ,n . The use of the Gromov-Hausdorff distance then allows us to consider this set of ob-servations as an abstract metric space of cardinality n , in-dependently of the way it is embedded in M . This general framework includes the more standard approach consist-ing in estimating the support with respect to the Hausdorff distance by restraining the values of p X to K p M q equation (2), the problem of persistence diagrams estima-tion reduces to the better known problem of estimating the support of a measure.
 Let p X n :  X  t X 1 ,...,X n u be a set of independent observa-tions endowed with the restriction of the distance  X  to this set. This finite metric space is a natural estimator of the support X  X  . In several contexts discussed in the following, p X n shows optimal rates of convergence to X  X  with respect to the Hausdorff and Gromov-Hausdorff distance. From (2) we then obtain upper bounds on the rate of convergence of Filt p p X n q . We also obtain the corresponding lower bounds to prove optimality.
 The rate of convergence of p X n in Gromov-Hausdorff dis-tance for probability measures  X  satisfying an p a,d q -standard assumption is obtained using classical covering arguments -see, e.g. (Cuevas &amp; Rodr  X   X guez-Casal, 2004; Niyogi et al., 2008). We then derive the following result for persistence diagram estimation.
 Theorem 1. Assume that the probability measure  X  on M satisfies the p a,b q -standard assumption, then for any  X   X  0 : Moreover, lim sup almost surely, and P  X  converges to 1 when n  X  8 , where C 1 and C 2 only depend on a and b .
 Let P  X  P p a,b, M q be the set of all the probability measures on the metric space p M , X  q satisfying the p a,b q -standard assumption on M : The next theorem gives upper and lower bounds for the rate of convergence of persistence diagrams. The upper bound is a consequence of Theorem 1, while the lower bound is established using Le Cam X  X  lemma.
 Theorem 2. Let p M , X  q be a metric space and let a  X  0 and b  X  0 . Then: sup where the constant C only depends on a and b (not on M ). Assume moreover that there exists a non isolated point x in
M and consider any sequence p x n q P p M zt x uq N such that  X  p x,x n q  X  p an q  X  1 { b . Then for any estimator dg p Filt p X  X  qq : lim inf where C 1 is an absolute constant.
 Consequently, the estimator dg p Filt p p X n qq is minimax op-timal on the space P p a,b, M q up to a logarithmic term as soon as we can find a non-isolated point in M and a se-quence p x n q in M such that  X  p x n ,x q  X  p an q  X  1 { b obviously the case for the Euclidean space R d .
 Remark. Theorem 1 can also be used to find confidence sets for persistence diagrams. Such confidence sets depend on a and b which may be unknown and whose estimation is beyond the scope of this paper. Alternative solutions have been proposed recently in (Balakrishnan et al., 2013). Persistence diagram estimation for nonsingular mea-sures in R k . Paper (Singh et al., 2009) is a significant breakthrough for level set estimation through density es-timation. It presents a fully data-driven procedure, in the spirit of Lepski X  X  method, that is adaptive to unknown local density regularity and achieves a Hausdorff error control that is minimax optimal for a class of level sets with very general shapes. In this section, we study persistence dia-gram inference in the framework of (Singh et al., 2009). Nevertheless, we do not use the estimator of (Singh et al., 2009) for this task since we only consider here the support estimation problem (and not the more general level set is-sue as in (Singh et al., 2009)). Let X 1 ,...,X n observations drawn from an unknown probability measure  X  having density f with respect to the Lebesgue measure on R k . Let X f :  X  X  X  be the support of  X  and let G 0 t x P R k | f p x q  X  0 u . The boundary of a set G is denoted B G and for any  X   X  0 , I  X  p G q :  X   X  x | B p x, X  q X  G B p x, X  q is the  X  -inner of G . We denote by F p  X  q the set composed of all the densities which supports are included in a fixed compact domain  X  and satisfy the two following assump-tions r A s and r B s , for fixed positive constants C a , C r A s : The density f is upper bounded by f max  X  0 and r B s : There exist constants  X  0  X  0 and C b  X  0 such that Assumption r A s describes how fast the density increases in the neighborhood of the boundary of the support: the smaller  X  , the easier the support may be possible to detect. Assumption r B s prevents the boundary from having arbi-trarily small features (as for cusps). Under assumptions r A s and r B s , the measure  X  also satisfies the standard assump-tion with b  X   X  ` k . Moreover, G 0 and the support X f are almost identical in the sense that d H p G 0 , X f q  X  0 . As a consequence, we obtain from Theorem 2 that the estimator dg p Filt p p X n qq converges in expectation to dg p Filt d b with a rate upper bounded by p log n { n q 1 {p k `  X  q over, this rate is minimax over the sets F p  X  q . Persistence diagram estimation for singular measures in
R D . We now consider the case where the support of  X  is a smooth submanifold of R D . As far as we know, rates of convergence for manifold estimation have only been stud-ied recently in (Genovese et al., 2012b) and (Genovese et al., 2012a) under several noise models that can be con-sidered in the context of persistence diagram estimation. However, for the sake of simplicity, we only study here the noiseless model considered in (Genovese et al., 2012b). For a fixed positive integer k  X  D , for some fixed posi-tive constants b , B ,  X  and for a fixed compact domain  X  in
R D , let H :  X  H p d,A,B, X , X  q be the set of probabil-ity measures on  X  satisfying the two assumptions of (Gen-ovese et al., 2012b):  X  is in H if and only if X  X  is a k -dimensional manifold whose reach -a measure of the reg-ularity of X  X  , see Section 2 in (Genovese et al., 2012b) -is lower bounded by  X  and if  X  has a density g with re-spect to the k -dimensional volume measure on X  X  , such that 0  X  A  X  inf y P X  X  g p y q  X  sup y P X  X  g p y q  X  B  X  8 . Under these two assumptions,  X  satisfies the standard as-sumption with b  X  k . Thus, if we take  X  X n for estimating the support X  X  in this context, we obtain a rate of conver-gence upper bounded by p log n n q 1 { k both for support and persistence diagram estimation. Nevertheless, this rate is not minimax optimal on the space H , as shown by Theo-rem 2 in (Genovese et al., 2012b). The correct minimax rate is n  X  2 { k for both estimation problems. However, the achievement of the optimal rate relies on a  X  X heoretical X  es-timator that cannot be computed in practice.
 Additive noise. To finish this section, we shortly discuss the additive Gaussian noise model: we now assume that the data are of the form Y i  X  X i `  X  i where X 1 ,...X n are sampled according to a measure  X  as in the previous paragraph and where  X  1 ,..., X  n are i.i.d. standard Gaus-sian random variables. We deduce from the results given in (Genovese et al., 2012b) in this context that the minimax convergence rates for the persistence diagram estimation is upper bounded by some rate of the order of p log n q  X  1 { 2 However, giving a tight lower bound for this problem ap-pears to be more difficult than for the support estimation. Space k n Geom. complex M 1 100 r 4000 : 500 : 8500 s  X  -complex
M 2 20 250 Vietoris-Rips A few experiments were conducted in order to illustrate our results and the behavior of the persistence diagrams under sampling of metric spaces. We consider two different met-ric spaces, denoted M 1 and M 2 hereafter. M 1 is the torus of revolution in R 3 with parametric equations x p u,v q  X  p 5 ` cos p u qq cos p v q , y p u,v q  X  p 5 ` cos p u qq sin metric is the restriction of the Euclidean metric in R 3 and it is endowed with the push forward by the parametriza-tion of the uniform measure on the square r 0 , 2  X  s 2 . is a space of images: we used a 3D character from the SCAPE database (Anguelov et al., 2005) and considered all the images of this character from a view rotating around a fixed vertical axis. We converted these images in gray color and resized these images to 300  X  400  X  120 , 000 pixels (see Figure 6). Each is then identified with a point in R 120 , 000 where the i th coordinate is the level of gray of the i th pixel. The metric space M 2 is the obtained subset with the restriction of the Euclidean metric in R 120 , 000 . As it is parametrized by a circular set of views, it is endowed with the push forward of the uniform measure on the circle. From each of the measured metric spaces M 1 and M 2 we sampled k sets of n points for different values of n from which we computed persistence diagrams for differ-ent geometric complexes (see Table 1). For M 1 we have computed the persistence diagrams for the 1 -dimensional homology of the  X  -complex built on top of the sampled sets. As  X  -complexes have the same homology as the cor-responding union of balls, these persistence diagrams are the ones of the distance function to the sampled point set (Edelsbrunner, 1995). So, for each n we computed the av-erage bottleneck distance between the obtained diagrams and the persistence diagram dg p M 1 q of the distance to M which is known exactly and represented in blue on Figure 5, middle. For each n , the average bottleneck distance be-tween dg p M 1 q and the persistence diagrams obtained for the k  X  100 randomly sampled sets X n of size n has been used as an estimate  X  E of E  X  d b p dg p M 1 q , dg p where C  X  denotes the  X  -complex filtration. log p  X  E q is plot-ted as a function of log p log p n q{ n q on Figure 5, right. As expected, since the the torus is 2 -dimensional, the points are close to a line of slope 1 { 2 .
 For M 2 , as it is embedded in a very high dimensional space, computing the  X  -complex is out of reach. So, we computed the persistence diagrams for the 1 -dimensional homology of the Vietoris-Rips complex built on top of the sampled sets. As in that case the exact persistence diagram of the Vietoris-Rips filtration built on top of M 2 is not known, we only computed the 1 -dimensional homology persistence di-agrams of the Vietoris-Rips filtrations built on top of 20 sets of 250 points each, randomly sampled on M 2 . All these di-agrams have been plotted on the same Figure 6, middle. The right of Figure 6 represents a 2D embedding of one of the 250 points sampled data set using the Multidimen-sional Scaling algorithm (MDS). Since M 2 is a set of im-ages taken according to a rotating viewpoint, it carries a circular structure highlighted by the MDS embedding. The persistence diagrams that all have one point clearly off the diagonal assert the presence of a cycle in M 2 . In previous works, persistent homology in TDA has been mainly considered with a non statistical approach, where persistence diagrams are used as exploratory tools to ana-lyze the topological structure of data. The results we obtain open the door to a rigorous use of persistence diagrams in statistical frameworks.
 Since our approach is based on very general recent stabil-ity results in persistence theory, it can be adapted to other frameworks. For example, building on ideas developed in (Chazal et al., 2011a) and (Caillerie et al., 2011), it is possible to extend our results to persistence diagram esti-mation for data corrupted by different kinds of noise us-ing Wasserstein deconvolution methods. In another direc-tion, an interesting representation of persistence diagrams as elements of a Hilbert space has recently been proposed in (Bubenik, 2012). Our results easily extend to this rep-resentation called persistence landscapes . Following this point of view, we also intend to adapt classical kernel-based methods with kernels carrying topological information. Anguelov, D., Srinivasan, P., Koller, D., Thrun, S.,
Rodgers, J., and Davis, J. SCAPE: shape completion and animation of people. In Proceedings of SIGGRAPH , pp. 408 X 416, 2005.
 Balakrishnan, S., Rinaldo, A., Sheehy, D., Singh, A., and
Wasserman, L. A. Minimax rates for homology infer-ence. Journal of Machine Learning Research -Proceed-ings Track , 22:64 X 72, 2012.
 Balakrishnan, S., Fasy, B.and Lecci, F., Rinaldo, A., Singh,
A., and Wasserman, L. Statistical inference for persistent homology. arXiv preprint arXiv:1303.7117 , 2013.
 Bubenik, P. Statistical topology using persistence land-scapes. ArXiv e-prints , July 2012.
 Bubenik, P. and Kim, P. T. A statistical approach to persis-tent homology. Homology, Homotopy and Applications , 9(2):337 X 362, 2007.
 Burago, D., Burago, Y., and Ivanov, S. A course in metric geometry , volume 33. Amer. Math. Soc., 2001.
 Caillerie, C., Chazal, F., Dedecker, J., and Michel, B. De-convolution for the Wasserstein metric and geometric in-ference. Electronic Journal of Statistics , 5:1394 X 1423, 2011.
 Carlsson, G. Topology and data. AMS Bulletin , 46(2):255 X  308, 2009.
 Chazal, F., Cohen-Steiner, D., Glisse, M., Guibas, L.J., and
Oudot, S.Y. Proximity of persistence modules and their diagrams. In SCG , pp. 237 X 246, 2009a. ISBN 978-1-60558-501-7. doi: http://doi.acm.org/10.1145/1542362. 1542407.
 Chazal, F., Cohen-Steiner, D., Guibas, L. J., Memoli, F., and Oudot, S. Y. Gromov-Hausdorff stable signatures for shapes using persistence. Computer Graphics Forum , pp. 1393 X 1403, 2009b.
 Chazal, F., Cohen-Steiner, D., and M  X  erigot, Q. Geomet-ric inference for probability measures. Foundations of Computational Mathematics , 11(6):733 X 751, 2011a.
 Chazal, F., Guibas, L. J., Oudot, S., and Skraba, P. Persistence-based clustering in Riemannian manifolds.
In Proc. of the 27th ACM Symp. on Computational Ge-ometry , 2011b.
 Chazal, F., de Silva, V., Glisse, M., and Oudot, S. The structure and stability of persistence modules. arXiv preprint arXiv:1207.3674 , 2012.
 Chazal, F., de Silva, V., and Oudot, S. Persistence stabil-ity for geometric complexes. Geometriae Dedicata (to appear -online first Dec. 2013) , 2013a.

Michel, Bertrand. Optimal rates of convergence for per-sistence diagrams in topological data analysis. arXiv preprint arXiv:1305.6239 , 2013b.
 Cohen-Steiner, D., Edelsbrunner, H., and Harer, J. Stability of persistence diagrams. In SCG , pp. 263 X 271, 2005. Cuevas, A. Set estimation: another bridge between statis-tics and geometry. Bol. Estad. Investig. Oper. , 25(2): 71 X 85, 2009. ISSN 1889-3805.
 Cuevas, A. and Fraiman, R. A plug-in approach to support estimation. Ann. Stat. , 25(6):2300 X 2312, 1997.
 Cuevas, A. and Rodr  X   X guez-Casal, A. On boundary estima-tion. Adv. in Appl. Prob. , 36(2):340 X 354, 2004.
 De Silva, V. and Ghrist, R. Homological sensor networks. Notices of the American Math Soc , 54(1), 2007.
 De Vito, E., Rosasco, L., and Toigo, A. Learning sets with separating kernels, 2012. URL http://arxiv. org/abs/1204.3573 . submitted.
 Edelsbrunner, H. The union of balls and its dual shape. Discrete Comput. Geom. , 13(1):415 X 440, 1995.
 Edelsbrunner, H. and Harer, J. Computational topology: an introduction . American Math. Soc., 2010.
 Edelsbrunner, H., Letscher, D., and Zomorodian, A. Topo-logical persistence and simplification. Discrete Comput. Geom. , 28:511 X 533, 2002.
 Genovese, C., Perone-Pacifico, M., Verdinelli, I., and Wasserman, L. Minimax manifold estimation. Journal of Machine Learning Research , 13:1263 X 1291, july 2012a. Genovese, C. R., Perone-Pacifico, M., Verdinelli, I., and
Wasserman, L. Manifold estimation and singular decon-volution under hausdorff loss. Ann. Statist. , 40:941 X 963, 2012b.
 Hatcher, A. Algebraic Topology . Cambridge Univ. Press, 2001. https://sites.google.com/site/nips2012topology/. Nips 2012 workshop on alg. topol. and machine learning. Kasson, P. M., Zomorodian, A., Park, S., Singhal, N.,
Guibas, L. J., and Pande, V. S. Persistent voids: a new structural metric for membrane fusion. Bioinformatics , 23(14):1753 X 1759, 2007.
 Korostel  X  ev, A. P. and Tsybakov, A. B. Minimax theory of image reconstruction , volume 82 of Lecture Notes in Statistics . Springer-Verlag, New York, 1993.
 Mileyko, Y., Mukherjee, S., and Harer, John. Probability measures on the space of persistence diagrams. Inverse Problems , 27(12), 2011.
 Niyogi, P., Smale, S., and Weinberger, S. Finding the ho-mology of submanifolds with high confidence from ran-dom samples. Discrete &amp; Computational Geometry , 39 (1-3):419 X 441, March 2008.
 Niyogi, P., Smale, S., and Weinberger, S. A topological view of unsupervised learning from noisy data. SIAM Journal on Computing , 40(3):646 X 663, 2011.
 Rodr  X   X guez-Casal, A. Set estimation under convexity type assumptions. Annales de l X  X nstitut Henri Poincare (B) Probability and Statistics , 43(6):763  X  774, 2007. Singh, A., Scott, C., and Nowak, R. Adaptive Hausdorff estimation of density level sets. Ann. Stat. , 37(5B):2760 X  2782, 2009.
 Singh, G., Memoli, F., Ishkhanov, T., Sapiro, G., Carlsson,
G., and Ringach, D. L. Topological analysis of popu-lation activity in visual cortex. Journal of vision , 8(8), 2008.
 Tsybakov, A. B. On nonparametric estimation of density level sets. Ann. Statist. , 25(3):948 X 969, 1997.
 Wang, J. Geometric structure of high-dimensional data and dimensionality reduction . Springer, 2012.
 Zomorodian, A. and Carlsson, G. Computing persistent
