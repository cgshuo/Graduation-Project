 1. Introduction
The aim of the supervision of mass and heat transfer systems is to contribute to the enhancement of safety, production ef cycle. This type of problems suffers from very high dynamics complexity derived from the viscosity variability with temperature making the analytical solutions inaccurate, or not cost effective in terms of fl uid behaviour modelling. Since a lot of changing parameters and variables are involved in any thermal fl uid transfer system, it is possible to obtain alternative mathematical models, such as the method described in this study using functional approximation based on neural networks.

A considerable background exists in terms of fl uid transfer plants supervision. In this way, when us ing model-based approaches and the models describing the process are accurate, the problem of fault detection may be solved by observer-type fi lters. These fi generate the so-called residuals computed from the inputs and outputs of the process. The generation of these residual signals is to the faults under consideration. That way, the residuals are designed so that the effects of po ssible faults are enhanced, which quickly. The residuals are evaluated by means of a parity space approach in order to detect the presence of faults. A considerable amount of scienti fi c literature reporting FDI methods has been previously reported, and more recently the papers referenced as those of Rengaswamy et al. (2001) , Varanon et al. (2007) and Deyin et al. (2013) . 1.1. Model based fault detection methods include actuators, processes and sensors for which input and output variables must be precisely measured. Such methods deal mainly with parameter estimation, state observers and parity equation methods. If measuring system fails, fault detection methods based on the use of input/output measurements yields ambiguous and/or erroneous results. An intensive research on model based fault detection methods has been carried out during the last three decades. Nevertheless, no general method exists for solving FDI cases. Successful FDI applications are based on a combination of several methods ( Ferreiro Garcia et al., 2010 ; as mass fl ow rate balance, energy fl ow rate balance, force/torque/ power balances and commonly, the mathematical balance of any cause-effect equilibrium condition.

Previously mentioned diagnosing techniques, when applied to non-linear processes, suffer from lack of detectability. With regard to residuals, they are the outcomes of consistency checks between the plant observations and a mathematical model of the plant under given conditions. The three main ways to generate residuals are parameter estimation, observers and parity relations. For parameter estimation, the residuals are the difference between the nominal model parameters and the estimated model para-meters. Derivations in the model parameters serve as the basis for detecting and isolating faults.

The tasks to be carried out consist of achieving a set of NN based on steady state models of the plant modules to be used as a bank of observers. Models outputs are used as residual generators by parity relations. Achieved residuals are evaluated by a set of rules responsible for detecting and isolating plant faults, which include process and sensor faults.

Subsequent sections are devoted to the description of the proposed technique, resulting in an interesting complement to some conventional supervision techniques. Thus, in the next section the problem statement is addressed. In Section 3 , the supervision task implementation is described and fi nally in
Section 4 the analysis and discussion of results and conclusions are presented. 2. Problem statement
A model based thermal fl uid transfer system is de fi ned by the energy equation, the af fi nity laws, and the power according to the following generic expressions.

Energy equation : h  X  p 2  X  p 1  X   X 
Eq. (1) express that net head is equal to the static pressure difference plus the potential energy plus the kinetic energy. Similarity rules : For diameter constant pumps
Q
Q For geometrically similar pumps Analytical pump power :
Pw  X  Q
When the differences in elevations and velocities are small, they can be considered negligible thus yielding h  X  p 2
Described system model suffers from accuracy mainly due to the following causes:  X 
Fluid degradation (changing of characteristics).  X 
Piping deterioration, (fouling or surface roughness).  X 
Variable fl ow regimes (turbulent laminar).  X 
Variable thermal fl uid viscosity as function of temperature and pressure.  X  Pump deterioration (degradation of impeller and/or casing).
Furthermore, the real pump head data differ considerably from responsible for signi fi cant differences, which belong to three types: 1. Impeller recirculation loss, signi fi cant only at low 2. Friction losses on the blade and passage surfaces, which increase monotonically with the fl ow rate. 3.  X  Shock  X  loss due to mismatch between the blade angles and the inlet fl ow direction, especially signi fi cant at high fl
Computational fl uid dynamics depend on fl uid viscosity which is a function of the fl uid temperature and pressure, a scenario in which an important group of analytic model based diagnostic tasks suffer from the required accuracy. Since viscosity can be between moving solids, viscosity transforms kinetic energy of macroscopic motion into heat energy, while the temperature
Nomenclature h pump actual head rise (m) p i pressures (Pa) z i elevation levels (m)
V i fl uid velocity (m/s)  X  density (kg/m 3 ) g acceleration gravity (m/s 2 ) m  X  mass fl ow rate (kg/s)
Q volumetric fl ow rate (kg/s)  X  pump angular velocity (rad/s) D pump impeller diameter (m) P pump power (W)
P m measured pumping power (W) P
N nominal pumping power (W)  X  net ef fi ciency m  X  N nominal mass fl ow rate  X  p N nominal pressure increment ( p 2  X  p 1 ) (bar) AMT N nominal arithmetic mean temperature (C) Acronyms BP backpropagation BPNN backpropagation neural network DM decision making FDI fault detection and isolation FFNN feedforward neural networks HTF heat transfer fl uid NN neural network NNFA neural networks based functional approximation TC temperature controller TT temperature transmitter, T 2 dependence of viscosity at isobaric conditions is well established (the viscosity increases with decreasing temperature), current discussion on the dependence of viscosity on external pressure (at isothermal conditions) shows a spectrum of controversial statements.

Assuming the number of degrees of freedom of the system is equal to 2 for analysis simplicity, and choosing temperature and pressure as the independent variables determining the properties of the system, in such cases, the dynamic viscosity  X  can be considered as a function of pressure and temperature according to  X   X   X   X  p ; T  X  X  5  X 
It is assumed, also, that the analysis is restricted to cases where the thermal expansion coef fi cient of the liquid is positive, (this property is ful fi lled at atmospheric pressure for most but not all liquids), so that the following relations must be ful fi lled  X   X   X   X 
These relations imply that the viscosity must decrease with increasing temperature (for isobaric processes), and must increase with increasing pressure (at isothermal conditions). Moreover, considering the viscosity as a function of pressure and tempera-ture, i.e.,  X   X   X   X  p ; T  X  , the following identity can be written:  X   X   X   X 
Eq. (7) follows from purely analytical considerations and does not involve originally any experimental physics. Taking into account inequality given at (8) must be ful fi lled  X  p  X   X 
This equation described as a purely mathematical relation has a quite de fi nite physical meaning since the viscosity of liquids of constant composition can be considered as a function of two state variables, pressure and temperature.

Since the complexity of the heat transfer problem to be analysed is in part due to the fact that the temperature and hence achieve a manageable solution to the referred controversy on the effects of pressure and temperature on viscosity, it is highly interesting to look for an alternative model on the basis of experimental techniques in order to accurately represent the particular fl uid dynamic ' s behaviour.

Due to the mentioned causes which de fi nitely contribute to the model inaccuracies, the problem of diagnosing a thermal fl transfer system based on fl uid transfer modules is being carried out on the basis of functional approximation modelling techniques using NNFA, where residual generation by parity equations are processed by expert rules responsible for fault detection, fault isolation and DM tasks. 2.1. Problem solving methodology using NNFA and rule based techniques
NNFA based models are achieved on the basis of experimental data. Experimental data has been previously achieved under all possible scenarios so that neural networks are trained. Then neural networks outputs are used to be compared with actual measured data. The condition to assure the accuracy of a feedforward neural network based function requires the accuracy of data used in the training task, as well as the correct selection of signi fi functional variables. Such condition requires accurate and well calibrated instrumentation applied on data acquisition tasks and data measurement when in on-line tasks. Consequently the task of data acquisition to be applied in a training phase is technically critical. This means that the instrumentation involved in the data acquisition must operate under fault free conditions. During the last decade sophisticated supervising methods using arti fi intelligence techniques have been developed such as those of (2009) , Abraham et al. (2009) , Hong and May (2004) . Never-of Ferreiro Garcia et al. (2010) and Ferreiro et al. (2010) . neural networks trained by means of the conjugate gradient algorithm is proposed and applied in the problem solving task.
Therefore given a data base where a historical set of data related with the problem solving task is available, the following sequence of sub-tasks inherent to the general supervision task is to be carried out: (a) Functional approximation, which deals with the process (b) Residuals evaluation, which deals with the comparison of 3. System supervision task implementation on the basis of functional approximation modelling techniques combined with rule based knowledge management. A parabolic through based solar power plant operating with thermal oil as heat transfer working fl uid is considered.
 requires piping lengths of several thousands of metres where temperature varies according to the heat fl ow absorbed. According transfer pump along a heat absorber pipe which absorbs the concentrated solar heat, to be delivered into a heat exchanger responsible for providing high temperature heat to a thermal to mechanical energy converter, commonly a thermodynamic cycle.
The mass fl ow rate m  X  , pressure at pump discharge p 2 , pressure before heat absorber pipe T 2 , are relevant heat transfer system parameters which will be used to supervise the transfer system in terms of performance and malfunction or faults detection and isolation. Furthermore the mentioned variable parameters are used to describe the plant behaviour in terms of an experimental model. While system performance is concerned with the exploita-tion cost during the life cycle, where pump ef fi ciency plays an important role, supervision should provide a more extensive insight of the plant offering valuable information regarding plant behaviour. system
Applying the concepts described by Eqs. (2)  X  (4) to the transfer system model, a parity space is being used to achieve the inherent residuals. Accurately residuals are further processed by the rule based system.

In order to carry out practical experiments related with measuring error and/or the parameter ' s sensitivities assumed as a facility based on a controlled pilot plant is available to help accuracy on the data acquisition task. The implemented test rig shown in Appendix A . The solar parabolic through fi eld is emulated by means of an electric heater in which the power consumed or supplied energy is deterministically known and controlled. Since the dimensions of the pilot plant are reduced with regard to that of a conventional solar power plant, obviously the results cannot be extrapolated. However the applied strategies and methodology are useful. In the same way the data of a given solar plant is only useful for such a solar plant, meaning that it cannot be extrapolated to different plants.

In Fig. 3 the basic structure of the transfer system supervision procedure is depicted. Under nominal operating conditions a database containing the relevant dynamic data is achieved as historical data represented in Appendix A . Since the last set of stored data is available representing the last fault free operating conditions, feedforward neural networks are trained with such nominal data. In this way, several time based scaled models may be used to study the deterioration historical data. For the purpose of total plant changes evaluation, a nominal plant model is useful. Under this scenario, Fig. 3 shows the basic scheme used to obtain a increment due to the pumping effect denoted as  X  p N  X  p 2 the arithmetic mean temperature denoted as AMT  X  0.5( T 2 obtained from the lowest and highest temperatures.

The feedforward structure of the selected backpropagation NN based functional approximation algorithm has been selected for this application as 3-10-1 with acceptable accuracy. This structure has been selected after some trial and error tests, where the selected structure complies with the required accuracy. The selected training algorithm shown in Table 1 is the conjugate gradient of Fletcher and Reeves, which provides us with quick convergence under acceptable accuracy under the condition of a coherent database. 3.2. Sensitivity analysis
When referring to the degree to which an input parameter affects the model output, the terms  X  sensitive  X  ,  X  important in fl uential  X  , among others may be used to de fi ne the degrees of sensitivities. Thus, a distinction must be taken into account by referring to  X  important  X  parameters as those whose uncertainty contributes substantially to the uncertainty in assessment results, and  X  sensitive  X  parameters as those which have a signi fi in fl uence on assessment results.

The simplest approach to sensitivity analysis is the one-at-a-time method where sensitivity measures are determined by varying each parameter while all others are held constant.
The most fundamental of sensitivity techniques is the direct method. Direct sensitivity analysis involves calculating partial derivatives of the model with respect to each input parameter. A sensitivity coef fi cient is basically the ratio of the change in output to the change in input while all other parameters remain constant. The model result while all parameters are held constant is de fi ned as the  X  base case  X  .

In this case, the sensitivity coef fi cient,  X  i , for a particular independent variable can be calculated from the partial derivative of the dependent variable with respect to the independent vari-able, i.e.  X   X   X  Y  X  where the quotient, X i / Y , is introduced to normalise the coef by removing the affects of units. Inherent to this calculation are the assumptions that the higher ordered partials are negligible and there is no correlation between input parameters. For large sets of equations, the partial derivative can be approximated as a difference and output values calculated for small changes in the input parameter. Thus, for small variations, the partial derivative can be approximated as  X   X  %  X  Y %  X 
Since this approach is only valid for small changes in parameter values, when parameter variability is allowed to take on  X  values, the direct approach is seriously violated. The parameters involved in the functional model investigated in this work are the mass fl ow rate m  X  , the net pump head expressed by pressure change due to the pumping work  X  p  X  p 2  X  p 1 , and the changes in the AMT. Thus, according to the de fi nition of sensitivity given by (13) follows that  X   X   X  %  X  Y %  X   X   X 
The results of a sensitivity study carried out by applying the in measuring errors are really high, meaning that any drift-like as in the temperature sensors supposes a dramatic drawback in the supervision task. The effect of measuring errors in mass rate sensor, pressure and/or temperature sensors have a strong impact on the diagnostic reliability.

Thus, the effect on the residuals increment obtained as con-sequence of abrupt or drift-like changes in the measuring system due to pressure sensors, mass fl ow sensors and/or temperature sensors, supposes an important drawback in the diagnostic task. 3.3. The parity space approach
The evaluation of residuals is carried out by means of an intensive rule based processing task in which alerts and conclusions about faults isolation and system recon fi guration actions could be considered and taken into account. The time dependency of faults due to sensors can be distinguished as abrupt fault (step wise) or incipient fault (drift-like). In any case, the changes observed every chosen period of time means a malfunc-tion symptom that at least supposes a severe warning about a system fault detected (not isolated) and can be deterministically evaluated.
 condition) modus operandi of the plant deals with a steady state status in which constant nominal variables and parameters are common (no system faults means transfer process parameters and sensors operating in nominal conditions). Consequently using the plant performance index given by a tolerated residual, an approach to a deterministic conclusion is achieved about plant performance. To diagnose the plant under absolutely determinism in terms of fault isolation redundancy (physical and/or analytical) is required. 3.4. Rule base architecture and its inherent operation modes make it dif and/or costly due to the amount of redundant instrumentation needed for a successful diagnostic task.
 are not applicable since unacceptable modelling errors will occur.
Consequently, instead, well known experimental techniques are to be applied since Feedforward NNs are well understood when applied to functional approximation purposes ( Ferreiro Garcia et al., 2013 ). Feedforward BPNNs are used here for plant modelling. methods of fault detection involves the pump ef fi
Rule based residuals evaluation and decision making task. m X  p
AMT
P assessment. On the other hand, residuals are important for pumping system supervision.

Fig. 7 shows the generic scheme of the monitoring system including the hydraulic pumping system with a conventional strategy ( Ferreiro Garcia et al., 2013 ).

The necessary steps to implement the expert monitoring system include the following off-line and on-line tasks shown in Fig. 7 , assumed as:
Off line data acquisition and information processing includes the following actions:
Hydraulic pumping system modelling using feedforward NNs trained with a backpropagation conjugate gradient algorithm.
On-line information processing which includes the following tasks:
Residuals evaluation from parity equations of the pumping system model.

Rule based monitoring of the pumping system using residuals dynamics.

The next action consists of evaluating a set of rules which depends on the conclusions obtained from the performance evaluation using the RB1. In Table 2 , a list of rules to diagnose the plant performance including sensors involved in data acquisi-tion for nominal NN based model is depicted. The constants is adjusted so that every signi fi cant change in the corresponding variable involved in its rule can be detected. Abrupt or step wise-like faults can be detected by a rule based strategy taking into account the evolution of a given variable during a time period. In this way, in Table 2 there is necessary the set of rules to detect faults due to abrupt and drift-like changes in measuring system variables.

An additional rule set applied on plant operation scheduling including safety warnings and alarms is integrated into the global this paper. 4. Analysis of results and conclusions
The low-cost test rig designed to research the problem of solar parabolic through heat transfer system by means of thermal oils has been used to obtain experience in developing supervision strategies and data regarding to monitoring tasks in the above fi designed as simple as possible, with a minimum number of tools to ensure a monitoring system with effective cost. Thus, only three variables pump head pressure, arithmetic mean temperature and mass fl ow rate are used to achieve a reliable model.
The model of the plant must be trained each time the plant is operated for repair or refurbishment. This plant intervention task requires checking the calibration of all instrumentation involved in the data acquisition tasks assuring the accuracy of achieved data. Thermal oil, pump degradation or oil leakage are examples of parameter changes that can only be detected if the measuring instrumentation is operating correctly. On the other hand, if no redundancy is applied to the measuring system ambiguous con-clusions are expected. However, determinism is assumed if resi-duals do not exceed the proposed limit, so that the main problem regarding ambiguity, rely on the fault isolation instead of faults detection which is determinist. 4.1. Test results
As expected after being aware of the high sensitivity of the process variables on the residuals turns out to have a positive effect on the rule-based diagnosis, since in the cases of abrupt changes due to sensors faults, the high sensitivity favours the conclusive information regarding sensory system behaviour.
The rules that have proven effective have not been removed from effective.

As shown in Fig. 8 , the abrupt changes in pressure sensors due to the invocation of a fault applied to the test rig pressure sensor ( p ), are clearly detected. The generated calibration error for this test approaches 50% of the pressure span.

In the same way, in Fig. 9 an abrupt change in the mass fl rate sensor has been invoked. As expected, the results are conclusive: faults are detected but isolation is not possible since the faults can proceed from any involved sensor. Since ambiguity in the decision making strategy persists acceptable determinism requires physical redundancy. The generated calibration error for this test approaches 50% of the mass fl ow rate span.
According to the rule base conclusions, faults in mass fl and/or pressure sensors cause the same residual behaviour as the process faults. Thus, faults in the measuring system and transfer process can occur simultaneously and although deterministically detected, it is not possible the isolation of such faults without sensors redundancy and/or analytical redundancy, which is tech-nically applicable and cost effective in this monitoring process. 4.2. Conclusions
A supervision strategy has been implemented as part of a general SCADA for a unit of a solar power plant emulated by a test rig. A set of experimental data into the ranges of possible operating conditions has been achieved which is represented in
Table A1 of Appendix A . The corresponding neural network has been trained of fl ine, and subsequently integrated into the mon-itoring system. This process must be performed each time the system is operated for repair. Furthermore, whenever the lack of accuracy is relevant, a new training task of the NN based model is executed. The validation of the monitoring system for perfor-mance and consistency has been tested after eliminating incon-sistent rules as well as super fl uous rules or confusing rules.
A series of test has been carried out by invoking all sensor faults to verify the RB1 consistence. Continuously, a test on the process has been performed by gradually restricting the transfer pump outlet valve so that a signi fi cant increase on pump load was observed. The task of fault detection is carried out with acceptable determinism, assuming proper operation of the data acquisition system. However, by implementing a low cost system without redundancy in data acquisition sensors and/or analytical redun-dancy for the process model, there is ambiguity in the task of fault isolation.

The main conclusions deals with the fact that except for fault types not modelled by the neural network based function, the proposed strategy is cost effective, reliable and works as expected with the limitations imposed by the lack of determinism derived from redundancy avoidance.

Appendix A. Historical data used on neural networks training tasks See Appendix ( Table A1 ).
 References
