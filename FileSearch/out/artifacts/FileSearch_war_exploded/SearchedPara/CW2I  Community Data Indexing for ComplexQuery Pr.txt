 C o mmu ni t yW eb M a n ageme n t Sy stems ( C WMS s ) are e ff ect iv e in c oll ect in ga n d o rga ni z in gthe wi sd o m o fcr ow ds [13]. T he y pr ovi de a p l atf o rm in w h i ch users o fac o mmu ni t y ca nin teract a n dc oll ab o rate .U sers ca n c on tr i bute t o, a n dtake aC WMS st o res in f o rmat ion on a wi de -ra n g in gset o fe n t i t i es , such as pr o ducts , c o mmerc i a loff ers ,o rpers on s .D ue t o d iv erse pr o duct spec i ficat ion s , user e x pec -tat ion s ,o rpers on a lin terests , the data set ca n be v er y sparse w he n re n dered as atab l e .T hus , such s y stems a l s o ra i se des i g n requ i reme n ts that d iff er fr o mth o se o fc onv e n t ion a l database s y stems .

Fo r in sta n ce , the data set o ftheC N E T e -c o mmerce s y stem e x am in ed in [10] c o mpr i ses o fat o ta lo f2 ,9 84 attr i butes a n d2 33,30 4pr o ducts ; st ill, apr o duct i s descr i bed b yonly te n attr i butes on a v erage .Li ke wi se , m o st c o mmu ni t y-based data pub li sh in gs y stems a llow users t o defi n e metadata a n dst o re in f o rmat ion in the w a y the y prefer ( see Fi gure 1). Fo re x amp l e , a subset o fG oo g l e B ase [1] that w ed ownlo aded c o mpr i ses o f 1,1 47 attr i butes ov er 77 9,019 i tems ,w h il e on a v erage 16 attr i butes are defi n ed per tup l e .
 A p o pu l ar st o rage structure f o rC WMS s i sthe S parse Wi de T ab l e (SWT).
 S parse wi de tab l es w ere in depe n de n t ly pr o c l a i med in [1 8 ] a n d [10] as a usefu l c o mp on e n t o fse l f -ma n ag in g database s y stems ; the y free users fr o map o te n t i a lly in e ff ect iv eschema -des i g n phase w he n ma n ag in gsparsedatasets .F urtherm o re , [1 8 ]w as the first wo rk t o pr o p o se a t y pe o f inv erted in de xin gschemef o rsparse tab l edatama n ageme n t .

N e v erthe l ess , m o st e xi st in gC WMS se i ther are d i sad v a n taged b y a l ack o f sca l ab ili t y t ol arge data sets ,o r off er g oo dperf o rma n ce only f o rspec i a li zed k in ds o fquer i es .Non e o fthes ol ut ion shaspr ovi ded t o date a scheme that ca n ha n d l ee v er -in creas in gam o u n ts o fdataas w e ll as a llow effic i e n tpr o cess in g o f ge n era l-purp o se c o mp l e x quer i es .

In th i spaper ,w ec o mb in et wo e ff ect iv e in de xin gmeth o ds :Fi rst , a n inverted in de x f o r each attr i bute gathers a li st o ftup l es , s o rted b y tup l e ID, f o reach a separate direct in de x f o r each attr i bute pr ovi des fast access t o th o se tup l es f o r w h i ch the g iv e n attr i bute i sdefi n ed , s o rted b y tup l e ID, f ollowin gac ol um n-t ion tech ni ques t oo ur frame wo rk a n dd i scuss the be n efit ga in ed b y uniting the inv erted in de x es o f l ess -freque n t attr i butes .W ec on duct a perf o rma n ce e v a l ua -t ion us in gtheG oo g l e B ase dataset a n dc o mpare o ur pr o p o sed meth o dt o e xi st in g on es .T he resu l ts c on firm that the in de xin gscheme w epr o p o se o utperf o rms the tat ion. Our pr o p o sed C W 2 I scheme ca n effic i e n t ly ha n d l ec o mp l e x quer i es ov er C o mmu ni t yD ata .
 Outline. T he rema in der o fth i spaper i s structured as f ollow s .S ect ion 2prese n ts re l ated wo rk on SWT st o rage a n dd i scusses the defic i e n c i es o fpre vio us ap -pr o aches .InS ect ion 3 w e in tr o duce o ur t wo-w a yin de xin gs ol ut ion f o r SWT data ma n ageme n ta n dat y p olo g yo fquer i es defi n ed ov er such a s y stem .S ect ion 4prese n ts o ur e x per i me n ta l resu l ts us in grea l-wo r l ddatasets .Fin a lly, in S ect ion 5w e o ut lin e o ur c on c l us ion s . I thasbee nlon g o bser v ed that c onv e n t ion a l h o r i z on ta l-schema database repre -se n tat ion sare no tsu i ted f o remerg in gapp li cat ion s wi th sparse ly p o pu l ated a n d rap i d ly e volvin g data schemas .In th i s sect ion w eprese n ta nov er vi e wo fe xi st -in g appr o aches t o ha n d lin gsuchdatab y e xi st in gC o mmu ni t yW eb M a n ageme n t Sy stems . 2.1 Binary Vertical Representation An atura l appr o ach t o ha n d lin gsparsere l at ion a l data i st o sp li t a sparse h o r i z on-in the sparse tab l e .T h i s i dea w as fist suggested in the c on te x t o f database ma -ch in es [1 4 ] a n d w as br o ught up aga in wi th the dec o mp o s i t ion st o rage m o de l [11,1 2 ]. T h i st y pe o fc ol um n-st o re m o de l has bee n f ollow ed b yMon et DB, a lon g wi th a n a l gebra t o h i de the dec o mp o s i t ion [ 8 ,9], as w e ll as C -S t o re [16], ga inin g be n efits o fc o mpress i b ili t y[3] a n dperf o rma n ce [5]. F urtherm o re ,in a vi s ion ar y paper [ 2 ], A bad i suggested that , apart fr o mdata w areh o uses a n dO LAP wo rk -lo ads , c ol um n-st o res ma y a l s o be w e ll su i ted f o rst o r in ge x treme ly sparse a n d wi de tab l es . 2.2 Ternary Vertical Representation A gra w a l et a l. [6] d i scer n ed that a ter n ar y(3-ar y) v ert i ca l represe n tat ion off ers a R DBMS sf o r non-sparse data a n dtheb in ar yv ert i ca l represe n tat ion o ut lin ed ab ov e .T he y f o u n dthatth i s v ert i ca l represe n tat ion d o es u ni f o rm ly o utperf o rm the h o r i z on ta l represe n tat ion f o rsparsedata ,y et the b in ar y represe n tat ion per -f o rms better .In resp on se ,[6] suggested the use o fmu l t i p l e , partial indexes ,i. e ., on e in de xon each o fthethreec ol um n s o ftheter n ar yv ert i ca l tab l e , a lon gthe lin es o f [15]. A prem oni t ion o famu l t i p l e -in de xin g appr o ach i sa l s o c on ta in ed in th i s suggest ion. 2.3 Interpreted Storage Format B eckma nn et a l. [ 7 ] suggests a st o rage f o rmat that atta in s in depe n de n ce fr o m schema wi dth .Un f o rtu n ate ly, as [ 7 ]o bser v ed , th i sre n ders the retr i e v a lo f v a l ues fr o m attr i butes in tup l es s i g ni fica n t ly m o re c o mp l e x. To ame lio rate th i spr o b -l em ,[ 7 ] suggests a n extract o perat o r that retur n sthe off sets t o the refere n ced in terpreted attr i bute v a l ues .S t ill, as [ 2 , 4 ,1 7 ] ha v e no ted , ha n d lin gsparsetab l es in such a w a yin curs a s i g ni fica n tperf o rma n ce ov erhead . In o rder t o address the af o reme n t ion ed d i fficu l t i es ,w epr o p o se the c o mb in at ion o f three des i g n appr o aches f o rc o mp l e x quer y pr o cess in g on SWT s . First ,w e esp o use a b in ar yv ert i ca l represe n tat ion f o r each attr i bute Aid defi n ed in the data at ha n d ,w h i ch c oll ects a sorted v ect o r o f Tid ( tuple identifier ) e n tr i es . Each o fthesee n tr i es i sappe n ded wi th a n ass o c i ated s o rted li st o f attr i bute v a l ues Val .W eca ll th i sb in ar y represe n tat ion direct in de x. T he b in ar yv ert i ca l represe n tat ion o f [11,1 2 , 8 , 2 ] ca n be see n as a ma ni festat ion o f o ur direct in de x. Second ,w earguef o ra ninv erted in de x bu il t ov er each frequent attr i bute .An attribute identifier Aid i s lin ked t o a n inverted in de x, c on s i st in g o fas o rted v ect o r o f Val ( attribute value ) e n tr i es , appe n ded wi th the i rass o c i ated s o rted li sts o f Tids &lt; Tid 1 , Tid 2 , ... , Tid n &gt; that match the g iv e nv a l ue f o rthe Aid attr i bute .In in de x ed b yo ur inv erted in de x. S tr in g separat o rs pre v a l e n t dur in gdatae n tr y are used f o rth i s purp o se . Third ,w est o re a s in g l e li st o f attr i bute -v a l ue pa i rs f o reachtup l e , as in [ 7 ]. T h i sdes i g n am o u n ts t o d o ub l e in de xin gschemef o r C o mmu ni t yW eb data ,w h i ch w eca ll C W 2 I. I t i s capab l et o address b o th loo kup a n d aggregat ion quer i es , as w e ll as m o re c o mp l e x quer i es involvin gse v era ljoin o perat ion s .In e ff ect ,i tr o bust ly ha n d l es a ll w a y s o fquer yin g the data . 3.1 The Unified Inverted Index T he ma in pr o b l em ar i s in g o ut o f attr i bute freque n c y ske wn ess i sthat ,i f w eare supp o sed t o bu il db o th a direct a n da n inverted in de x f o r each attr i bute , the n w era i se u n reas on ab l est o rage requ i reme n ts wi th o ut much o fabe n efit ar i s in g fr o mthem .A fter a ll, i fa n attr i bute i sdefi n ed f o r only afe w tup l es , the nno t much sta n ds t o be ga in ed b yin de xin gthefe wv a l ues i t assumes ov er the w h ol e data set in b o th a direct a n da n inverted ma nn er .F urtherm o re , m o st users are no te x pected t o e x press quer i es us in gthe n ames o fth o usa n ds o f l esser -used at -tr i butes .T heref o re ,w e suggest that less frequent attributes ma y best be see n as rep o s i t o r i es o f unstructured in f o rmat ion ab o ut tup l es .A s far as text attr i butes ke ywo rds re l ated t o the tup l es in quest ion. T hus ,w epr o p o se t o ha n d l e l esser used text attr i butes in a unified ma nn er , gather in ga ll o fthemt o gether in a unified inverted index .T h i s in de x pr ovi des a p ow erfu l ke ywo rd -search -li ke fu n ct ion a l-i t yov er these attr i butes ,w h il e i t in creases b o th the st o rage -effic i e n c y a n dthe user -fr i e n d lin ess o f o ur s y stem .In part i cu l ar , the u ni fied inv erted in de x gathers as o rted v ect o r o f attribute value e n tr i es , regard l ess o f the attr i bute the y c o rre -sp on dt o; each e n tr yi sass o c i ated t o a li st &lt; Tid ( tuple identifier ), Aid ( attribute identifier ) &gt; pa i rs .

I trema in st o be dec i ded h ow attr i butes are t o be d ivi ded in t o more frequent a n d less frequent on es , s o as t o dec i de w h i ch sh o u l d rece iv ethe i r own separate inv erted in de x es , a n d w h i ch are t o be ma n aged b y the u ni fied inv erted in de x. A fter e x per i me n tat ion, w edec i ded that the f ollowin gru l e o fthumbpr ovi des a reas on ab l ed ivi d in g lin e :T he t o p quartile o f text attr i butes , s o rted b y decreas in g freque n c yv a l ue , ha v easeparate inv erted in de x bu il tf o rthem .T he rest 3 4 o f attr i butes are t o be treated b y the u ni fied inv erted in de x.

N umer i ca l attr i butes are e x c l uded fr o mtheu ni fied inv erted in de x; th i sd i s -cuss ion perta in st o text attr i butes only. How e v er ,n umer i ca l attr i butes that fa ll be low the freque n c y thresh ol dt o rece iv ethe i r own inv erted in de x, are no t in-de x ed in th i sma nn er at a ll. G iv e n the spars i t yo f such attr i butes , a ninv erted in de xi sredu n da n tf o rthem .Aloo kup t o the i rd i rect in de xi ssuffic i e n tt o detect a ny tup l es that match a g iv e nv a l ue -based pred i cate .B es i des , such n umer i ca l v a l ues d ono t off er a ny th in g in terms o fke ywo rd -search .U sers are e x pected t o refer t o such attr i butes b yn ame .T he same reas onin gapp li es t o the case w he n a user n eeds t o refer t o aspec i fic l esser -used te x t attr i bute b yn ame ; aga in, the low de n s i t yo f the attr i bute i tse l fre n ders a loo kup f o r v a l ues matches in the d i rect in de x pract i cab l ee no ugh .

T he usage o fth i su ni fied inv erted in de x addresses a pr o b l em that i spart i cu -l ar t o the c o mmu ni t yw eb data w ee x am in e .Mo re ov er ,i tc on fers the f ollowin g ad v a n tages t oo ur C W 2 I s y stem :  X  S t o rage effic i e n c y, as i t i s no teffic i e n tfr o mast o rage p oin t o f vi e w t o ha v e  X  F ac ili tat ion o fke ywo rd -search quer i es ,inw h i ch a g iv e n str in g i st o be f o u n d  X  U ser -fr i e n d lin ess , users are no te x pected ,o rrequ i red , t o k now o bscure at - X  F u n ct ion a li t y a n dpract i ca l se n se : f o rrare ly used attr i butes , the d i rect in de x  X  S afeguard aga in st user in c on s i ste n c y. Diff ere n tusersare li ke ly t o defi n ethe 3.2 Query Typology A s w eha v ed i scussed , se v era l attr i bute v a l ues in C o mmu ni t yW eb s y stems usu -a lly appear as c oll ect ion s o fsh o rt str in gs .S uch str in gs are usua lly d i st in gu i shed b y separat o rs . Each user ma y emp loy d iv erse separat o rs ( such as  X  &gt;  X ,  X / X ,  X : X ,  X ; X , ) creates a separate e n tr y f o reach o fthem .A str in g match dur in gquer y pr o cess in g ca n be sat i sfied e i ther in a n exact o ra fuzzy ma nn er . E x act str in gmatch in g i s stra i ghtf o r w ard .Fo rthecase o ffuzz y match in g ,w est ill wi sh t o take ad v a n tage o f l e xi c o graph i c o rder f o rfastquer y pr o cess in g .T hus ,w esa y that a quer y str in g s o f l e n gth L a n da nin de x ed str in g s i sat i sf y a fuzzy string match w he n there i s a n exact match o f the first ha l f o fthequer y str in ga n das i m il ar i t y bet w ee n the i r o ther parts .T hus ,i f prefix ( K, s )i sthe l e n gth -K prefi xo fstr in g s ,w edefi n ea fuzz y mach as : prefix W here  X  de no tes a n appr oxi mate str in gs i m il ar i t y measure .A cc o rd in gt o th i s k in d o ffuzz y match in g , sh o rt str in gs li ke  X  access o r i es  X  X o u l dmatch wi th  X  acces -s o r i ze  X  a n d  X  access o r y X , but no t wi th  X  access ,win d ow s v ers ion X . In the case o fte x t match ,w edefi n ethefuzz y match sc o re bet w ee n t wo te x t v a l ues s i a n d s j as : w here N i sthe n umber o fmatched wo rds in s i a n d s j , len ( s i )i sthe n umber o f wo rds in te x t v a l ue s i a n d len ( s j )i sthe n umber o f wo rds in te x t v a l ue s j . W e set a thresh ol d  X  ,w he nS c o re ( s i ,s j )  X   X  ,w esa y s i matches s j .T h i sru l e o f thumb o perates w e ll in pract i ce , a llowin gf o rthe i de n t i ficat ion o fre l ated str in gs wi th t ol era n ce t oo rth o graph i ca n dterm inolo g i ca lv ar i at ion s .

W ed i st in gu i sh f o ur d iff ere n tt y pes o fquer i es that C W 2 I ca n pr o cess , based on the i re x p loi tat ion o f inv erted in de x es , u ni fied inv erted in de x, a n dfuzz y str in g match in g , as f ollow s .A ge n era l complex query , c ov er in ga ll f o ur t y pes ,i sdefi n ed as f ollow s .

Q { p w here p i ( G i )i sset o f ( se l ect ) pred i cates that defi n eagr o up o ftup l es G i a n d r the i r respect iv epred i cates .Fo r in sta n ce , c on s i der the quer y X  fi n dtheb l ack -c olo r T he n G 1 i s  X  b l ack c olo r j e w e l r y X , he n ce the pred i cate that defi n es th i sgr o up i s Li ke wi se , G 2 i s  X  purp l ec olo r j e w e l r y X , he n ce the pred i cate that defi n es i t i s T he re l at ion that sh o u l dbesat i sfied am on ga ny i tem t 1  X  G 1 a n da ny i tem t  X  G W eca n the n c l ass i f y the bas i c join quer i es that sat i sf y th i sge n era l-purp o se defi ni t ion in t o f o ur d i st in ct c l asses as f ollow s . 1. Exact join query without keyword. In such a quer y, the se l ect pred i-2 . Exact join query with keyword. In th i st y pe o fquer y, the se l ect pred -3. Fuzzy join query without keyword. In th i scase , the se l ect pred i cates 4 . Fuzzy join query with keyword. A quer yo fth i st y pe ma y ha v eb o th a In th i s sect ion w ed i scuss e x per i me n ta l stud i es o fthesca l ab ili t y a n dperf o rma n ce o fC W 2 I scheme .W ec o mpare the perf o rma n ce o fC W 2 Iin a n s w er in g Ty pe -1 st o rage scheme (V ER TI). T he quer y pr o cess in gt i me i srec o rded f o r Ty pe -2 , Ty pe -3 a n d Ty pe -4quer i es w h i ch are no te v a l uated in e xi st in gs y stems .W e stud y the perf o rma n ce a n dthesca l ab ili t yo fC W 2 Ion them . 4.1 Experiment Setup In V ER TI, w est o re each attr i bute as a separate tab l ea n dbu il d in de xon the tup l e i dc ol um n. T h i s i ssameasthed i rect in de xin C W 2 I. T he d iff ere n ce o f i mp l eme n tat ion bet w ee n C W 2 I a n d V ER TI i sthat w ecreate on e inv erted in de x f o reach o fthe in de x ed attr i butes a n dau ni fied in de x f o reach o fthe o ther attr i butes .W ebu il da B + tree in de xon the ke ywo rd c ol um no fthe inv erted in de x a n dtheu ni fied in de x. In H OR I Z ,w est o re the in de x ed attr i butes in on ere l at ion a l tab l ea n dthe o ther u n-in de x ed attr i butes in the v ert i ca l st o rage f o rmat .W ebu il d a B + tree in de xonTID( tup l e i d ) c ol um n. Our e x per i me n ta l e nvi r on me n t i sa In te l C o re2 D u o1. 8G H zmach in e wi th 2G B mem o r y, 160 G B hard d i sk , ru nnin g Win d ow s XP P r o fess ion a lwi th SP 2 . 4.2 Description of Data W ed ownlo aded pub li shed data i tems fr o mG oo g l e B ase , a n dsetup o ur e x per i-me n ta l e v a l uat ion on th i s dataset .I tc on s i sts o f 30 th o usa n ds tup l es w h i ch are descr i bed b y 1319 attr i butes o ut o f w h i ch 1 2 1 7arete x t attr i butes a n d o thers are n umer i ca l attr i butes .A cc o rd in gt oo ur stat i st i cs , the a v erage n umber o fat -tr i butes per tup l e i s 16. To test the st o rage c o st o fthethreemeth o ds ,w e ini t i a lly in sert 10 ktup l es .W emeasuretheadd i t ion a l d i sk space c o st b yin creme n ta lly in sert in g 5K tup l es each t i me , as sh own in Fi gure2 .W e o bser v e that the st o r -age space lin ear ly in creases wi th the n umber o ftup l es in serted . C W 2 I c on sumes ab o ut 2 5% m o re d i sk space tha nV ER TI a n d H OR I Z . 4.3 Description of Queries W ed i scuss the f o ur t y pes o fquer i es in S ect ion 3. 2 .Ino ur e x per i me n t w ege n-erate se v era l quer i es f o reachquer y t y pe .Fo r Ty pe -1 quer i es ,i. e . e x act join quer ywi th o ut ke ywo rd ,w ec o mpare the e x ecut ion t i me o fC W 2 I t oV ER TI a n d H OR I Z .W e descr i be the quer i es a n dthe i mp l eme n tat ion deta il sbe low. Type-1 Queries. W efirst o ut lin ethe Ty pe -1 quer i es w eha v e in c l uded in o ur e x per i me n ta l stud y.  X  X uery1. Fin dthe n umber o fpr o ducts that be lon gt o the mp3 t y pe .  X  X uery2. Fin dthest o res w h i ch sa l eb o th mp3 a n d computer pr o ducts .  X  X uery3. Fin dpa i rs o fa n mp3 a n da headphone o fthesamec olo r .  X  X uery4. Fin dab l ack j e w e l r yi tem a n d a purp l e j e w e l r yi tem such that the  X  X uery5. Fin dake y b o ard a n dam o use o fthesame condition(new, used, on  X  X uery6. Fin dpa i rs o fb oo ks a n dC D s such that the i r condition i s new a n d Type-2 Queries. W e now defi n ethe Ty pe -2quer i es w eha v eusedf o r o ur e x per i me n ta l e v a l uat ion.  X  X uery1. Fin dthest o res w h i ch se ll b o th a n mp 3 a n dac o mputer wi th  X  X uery2. Fin dpa i rs o ft wo  X  X  p o ds  X , such that on e  X  spr i ce i s l ess tha n 2 00$,  X  X uery3. Fin dthest o res that sa l eb o th M aha l X  sC D a n d Do r in a  X  sC D.  X  X uery4. Fin dth in kpad T 4 1 sa n dth in kpad T 2 0 s that the d iff ere n ce o fthe i r Type-3 Queries. W eha v ea l s o defi n ed t wo Ty pe -3 quer i es , as f ollow s .  X  X uery1. Fin dbra n ds that make b o th ce ll ph on es a n d l apt o ps .  X  X uery2. Fin dt y pes o fpr o ducts such that there e xi sts b o th at l east on e Type-4 Queries. L ast ly, w eha v ea l s oin c l uded t wo quer i es o fthem o st c o mp l e x t y pe in o ur t y p olo g y, Ty pe -4 ,ino ur stud y, w h i ch are o ut lin ed be low.  X  X uery1. Fin d hardcover b oo ks a n d M aha l X  sC D s wi th the same a llow ed  X  X uery2. Fin dpr o ducts o fmater i a l X  st on e  X  a n dpr o ducts o fmater i a l X  s ilv er  X , 4.4 Results In th i s sect ion w erep o rt the resu l ts o f o ur e x per i me n ta l stud ywi th the quer i es descr i bed in S ect ion 4 .3. W eusepr o gress iv e ly l arger prefi x es o fthee x per i me n ta l data set w h il emeasur in gthee x ecut ion t i me o feachquer y. W euse lo gar i thm i c y-a x es f o rthee x ecut ion t i me in each case .Ty p i ca lly, the perf o rma n ce o f o ur CW2I scheme i s 10 o rm o re t i mes better tha nH OR I Za n d V ER TI.

Fi gure 3( a ) sh ow sthee x ecut ion t i me resu l ts f o r Ty pe -1 Quer y1.In th i s case , C W 2 Il arge ly o utperf o rms b o th o ur pr o t o t y pe i mp l eme n tat ion o f H OR I Z a n d V ER TI. T ha n ks t o the a v a il ab ili t yo fa ninv erted in de xin CW2I ,onlyon e B + -tree search i srequ i red in o rder t o fi n dthe n umber o fqua li f yin g i tems .In c on trast , a w h ol etab l esca ni s n ecess i tated b y b o th H OR I Za n d V ER TI.
G iv e n that the s i ze o fthe v ert i ca l tab l e i ssma ll er tha n that o ftheh o r i z on ta l tab l e , the perf o rma n ce o f V ER TI i s no t i ceab ly better tha n that o f H OR I Z .B e -s i des , the gr ow th o fe x ecut ion t i me wi th the s i ze o f the data set i s percept i b l e f o rb o th H OR I Za n d V ER TI; on the o ther ha n d , the e x ecut ion t i me rema in s re l at iv e ly stab l ef o r CW2I , as n e w re l e v a n t i tems are in serted in the idlist o fthe inv erted in de x a n dca n st ill be eas ily retr i e v ed wi th o ut substa n t i a lov erhead .
Our resu l ts f o rQuer y 2 o f Ty pe -1 i ssh own in Fi gure 3( b ). W e o bser v ethat b o th CW2I a n d H OR I Z o utperf o rm V ER TI, w h il e CW2I i ss li ght ly better tha n H OR I Z i tse l f .T ha n ks t o the inv erted in de x bu il t on attr i bute product type , CW2I gets the tup l e i ds o f mp3 a n d computer wi th li tt l ec o st . O n the o ther ha n d , V ER TI has t o sca n the v ert i ca l tab l e o f attr i bute product type t wi ce f o rthat purp o se .A s far as H OR I Z i sc on cer n ed , ase l f join on attr i bute store id i sc on-ducted qu i te effic i e n t ly in th i scase .

Fi gure 3( c ) dep i cts o ur resu l ts on Ty pe -1 Quer y3. Obser v ab ly, C W 2 I ga in sa s i g ni fica n tad v a n tage ov er b o th H OR I Za n d V ER TI. T he u n der lyin gcause o fth i s effic i e n c y ad v a n tage i sthesameas in o ur preced in ga n a ly s i sf o rQuer y 2 .How e v er , now th i sad v a n tage i sm o re percept i b l e wi th in the e x am in ed data set s i zes .
Our resu l ts f o r Ty pe -1, Quer y 4are ill ustrated in Fi gure 3( d ). In th i scase , the effic i e n c y be n efit o f CW2I ov er the o ther t wo schemes i sremarkab l e .T he reas on f o rthead v a n tage b y CW2I rema in sthesameas w eha v ea l read y a n a ly zed in the case o f Ty pe 1-Quer y 2 .How e v er ,in th i scase , there are t wo se l ect pred i cates on i tems ,in stead o f only on e , theref o re the ga in bec o mes m o re no te wo rth y.
Li ke wi se ,Fi gure 3( e ) sh ow s o ur e x ecut ion t i me resu l ts wi th the fifth quer y in Ty pe 1. T he ad v a n tage gap on beha l f o f CW2I i s aga in due t o the effic i e n t e x ecut ion o fthese l ect pred i cate .T he c o st f o r CW2I i s aga in low er , e v e n th o ugh in th i s case the gr ow th i sm o re percept i b l e , due t o the character i st i c o f the data set on the spec i fied se l ect pred i cates on product type .S t ill, the ga in gr ow s wi th the data set s i ze in th i scaseas w e ll.

Fi gure 3( f ) dep i cts o ur resu l ts f o r Ty pe -1 Quer y6. T he add i t ion a l se l ect pred -i cates in th i squer y reduce the n umber o fse l ected resu l ts , theref o re the c o st o f the merge step i s reduced .S t ill, the ad v a n tages o f CW2I are st ill sa li e n t , e x-act ly tha n ks t o thefactthatthese li m i ted resu l ts are much m o re eas ily der iv ed tha nwi th the o ther schemes .B es i des , the subseque n t join o perat ion i s now l ess dema n d in g .
 Fi gure 4 ( a ) ill ustrates the resu l ts o fthe Ty pe -2quer i es .I t i s in d i cated that C W 2 I sca l es w e ll f o rthequer i es o f Ty pe -2 wi th the in crease o f the dataset s i ze . Q 1 a n dQ 3 are a l m o st i de n t i ca l a n dthe y b o th join on attr i bute st o re i d ,w h il e Q2 a n dQ4 join on attr i bute pr i ce .T he effic i e n c y gap i s due t o the fact that the card in a li t yo f attr i bute pr i ce i ssma ll er tha n attr i bute st o re i d , s o the sec on d gr o up gets better sca l ab ili t y. Mo re ov er , the d iff ere n ce bet w ee n the resu l ts o fQ2 a n dQ4 i s due t o the d iff ere n ce o fthes i zes o fthe in termed i ate resu l ts .
Fi gure 4 ( b ) sh ow s o ur resu l ts f o rquer i es o f Ty pe -3 a n d Ty pe -4 . C W 2 I sca l es w e ll f o rthequer i es o ftheset wo t y pes .S t ill, c o mpared t oTy pe -2quer i es (Fi gure fact that the join o perat ion s o f Ty pe -3 a n d Ty pe -4arefuzz yjoin s ,w h i ch c o st m o re tha n the e x act join o perat ion s o f Ty pe -2 .B es i des ,w e o bser v ed iff ere n ces am on gthequer i es o f Ty pe -3 a n d Ty pe -4themse lv es ,w h i ch are due t ov ar i at ion s in resu l tsets i zes . In th i spaper w eha v epr o p o sed a n arch i tecture f o rthema n ageme n t o fsparsea n d wi de data in C o mmu ni t yW eb s y stems that ca n effic i e n t ly ha n d l ec o mp l e x quer i es . Our pr o p o sa l c o mb in es t wo h i thert o d i st in ct appr o aches . O n the on eha n d ,w eem -p loy a v ert i ca l represe n tat ion scheme ,w hereb y each attr i bute ,no matter h ow fre -que n t ly defi n ed ,o bta in s i ts own c ol um n-o r i e n ted direct in de x. O n the o ther ha n d , w eut ili ze a n inverted in de xin gscheme ,w hereb y the tup l es that defi n e more fre-quent attr i butes are in de x ed by value .F urtherm o re ,w epr o p o se a unified inverted in de xin g scheme that gathers t o gether a ll less frequent in as in g l eke ywo rd -o r i e n ted in de x. T h i sadd i t ion a lin de x fac ili tates schema -ag no st i cke ywo rd search that fits the n ature o fsuch l ess freque n t attr i butes .W eha v edefi n ed f o ur d i st in ct t y pes o f join quer i es that o ur C W 2 I s y stem ca nn atura lly pr o cess . Our e x per i me n ta l stud y c on firms that C W 2 I e n ab l es fast a n dsca l ab l epr o cess in g o fc o mp l e x quer i es ov er C o mmu ni t yD ata m o re effic i e n t ly tha n s y stems based on am onoli th i c v ert i ca l-o rders o fmag ni tude ov er them in o ur pr o t o t y pe i mp l eme n tat ion.
