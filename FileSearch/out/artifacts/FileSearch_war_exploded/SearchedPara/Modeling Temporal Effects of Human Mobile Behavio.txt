 The rapid growth of location-based social networks (LBSNs) invig-orates an increasing number of LBSN users, providing an unprece-dented opportunity to study human mobile behavior from spatial, temporal, and social aspects. Among these aspects, temporal ef-fects o ff er an essential contextual cue for inferring a user X  X  move-ment. Strong temporal cyclic patterns have been observed in user movement in LBSNs with their correlated spatial and social e ff ects (i.e., temporal correlations). It is a propitious time to model these temporal e ff ects (patterns and correlations) on a user X  X  mobile be-havior. In this paper, we present the first comprehensive study of temporal e ff ects on LBSNs. We propose a general framework to exploit and model temporal cyclic patterns and their relation-ships with spatial and social data. The experimental results on two real-world LBSN datasets validate the power of temporal e ff ects in capturing user mobile behavior, and demonstrate the ability of our framework to select the most e ff ective location prediction algorithm under various combinations of prediction models.
 J.4 [ Computer Applications ]: Social and Behavioral Sciences Location-Based Social Networks; Location Prediction; Temporal E ff ect; Human Mobile Behavior
The wide use of mobile devices has greatly enriched users X  urban experience and promoted the development of location-based social services in recent years. Typical location-based social network-billions of users around the world and generated massive location-based social network data, providing us with both opportunities and http://foursquare.com/ http://www.facebook.com/about/location/ challenges for investigating a user X  X  mobile behavior, with the pur-pose of designing more advanced location-based services such as location-based marketing [9] and disaster relief [3].

Location-based social network data contain three distinct infor-mation layers: a social layer, a geographical layer, and a temporal layer, as shown in Figure 1. The social layer consists of social friendships, the geographical layer displays historical check-ins of users, and the temporal layer indicates temporal stamps of each check-in action. The availability of multiple information sources presents various views to study a user X  X  mobile behavior from spatio-temporal, social-temporal, socio-spatial, and spatial-temporal-social aspects. Previous research studied the social and spatial layers on LBSNs in terms of social-historical ties [4], social-spatial prop-erties [10], geographical influence [14], and  X  X eo-social X  correla-tions [5], etc., while the temporal layer in terms of temporal e ff ects has been rarely studied to model user mobile behavior on LBSNs.
In this paper, we aim to present a comprehensive study of tem-poral e ff ects on LBSNs to model user mobile behavior. The tem-poral layer on LBSNs is usually leveraged as an order indicator to connect check-ins chronologically for generating location trajecto-ries [15], which has not been fully exploited. As observed in [13, 8], human movement exhibits strong temporal cyclic patterns in terms of hour of the day and day of the week. For example, a user regularly goes to a restaurant for lunch around 12:00 pm, watches a movie on Friday night, and shops during weekends. Previous work has leveraged these patterns as features under supervised learning to solve location prediction problem [1]. Since human movement is observed as a stochastic process [7], the temporal features gen-erated from a user X  X  movement become very sparse in the large temporal feature space, while the unobserved features severely af-fect the prediction performance. Due to the temporal continuity of human movement, it is possible to infer an unobserved temporal feature with observed temporal patterns. For example, a tempo-ral pattern of visiting a restaurant at 10:00 am and 12:00 pm could imply the user X  X  potential presence at that restaurant at 11:00 a m, although such presence at 11:00 am is unobserved in the user X  X  pre-vious movement. This inspires us to exploit these temporal cyclic patterns for modeling a user X  X  temporal preferences.

In addition, temporal cyclic patterns strongly correlate to the spatial and social layers. Firstly, they imply the chronological in-formation for generating location trajectories, which form a user X  X  spatial context [6]. Secondly, social correlation suggests that hu-man movement is usually a ff ected by their social context, such as having lunch with friends at noon. Therefore, to model the tempo-ral e ff ects on LBSNs, we inevitably need to consider two aspects: (1) temporal preferences in terms of cyclic patterns; and (2) tem-poral correlations in terms of temporal-spatial correlations and temporal-social correlations.

In this paper, we model temporal e ff ects of user mobile behav-ior on location-based social networks in terms of the above two aspects. To the best of our knowledge, this work presents the first comprehensive study of temporal e ff ects on LBSNs. The contribu-tions of our work are the following:
To investigate the temporal e ff ects, we first propose a general framework to model a user X  X  mobile behavior w.r.t. the temporal cyclic patterns and temporal correlations. Let U = { u 1 , be the set of users and L = { l 1 , l 2 ,..., l m } be the set of locations where n and m are the numbers of users and locations, respec-tively. Each check-in action is represented as a tuple h u indicating user u i  X  U checks in at location l j  X  L at time t where C is the observed check-in set. Let F ( u ) denote u  X  X  so-cial friends, H u , t = {h u i , l j , t k i|h u i , l j , the observed historical check-in actions of u before time t , and S served check-in actions of u  X  X  friends before time t . t represented by standard time format  X  X YYY-MM-DD hh:mm:ss am / pm X , e.g.,  X 2013-02-22 11:09:59 pm X .

Figure 2 shows a user u  X  X  mobile behavior (represented by  X ? X ) at time t w.r.t. his / her personal check-in history H u , t check-in history S u , t . Given the corresponding observations of H and S u , t , the probability distribution over the check-in locations of u at time t is governed by the following formula: where c u denotes the check-in location of user u . Various tempo-ral information related to cyclic patterns can be implied by t (e.g.,  X 2013-02-22 11:09:59 pm X ) to indicate a user X  X  check-in state, such as a specific hour of the day (11:00 pm), a day of the week (Fri-day), or a month of the year (February), etc. We use temporal state to represent such information and introduce r ( t ) to denote the temporal state extracted from the time t . Depending on the type of temporal state, r ( t ) can be a di ff erent function. For exam-ple, if r ( t ) denotes temporal state in terms of hour of the day, then is 2 am. If r ( t ) denotes temporal state in terms of day of the week, state is Wednesday. Without loss of generality, we use r ( t ) to de-note a type of temporal state in the following description. Eq.(1) is then reformulated as Applying Bayes X  rule, we reformulate Eq. (2) and obtain
The above equation decomposes a user X  X  check-in probability into two components w.r.t. spatial and temporal context, with each context associated with the observed H u , t and S u , t . P ( c is the spatial context indicating the location distribution of u  X  X  check-in given his / her personal check-in history and friends X  check-senting the temporal state distribution of u  X  X  check-in, given the observed check-in location at l with the corresponding H u , t
Various approaches have been proposed to model the spatial con-observed in spatial context, the chronological information of H and S u , t is commonly utilized to generate location trajectories. For example, the Order-k Markov Model [11] considers only H u , t generates the probability based on the most frequent location se-quential patterns. The Social-Historical Model [4] considers both H u , t and S u , t and generates the probability based on the combination of their weighted location sequential patterns.

Compared to the spatial context, the temporal context has been little exploited in previous research. It builds the nexus between a user X  X  visited location and the corresponding visiting time, and pro-vides context of how likely a user would visit a location at a specific temporal state according to his / her personal preferences and so-cial networks. In this paper, we model it as a probability function w.r.t. the combinational e ff ect of personal preferences from H and social influence from S u , t . Following the common assumption of modeling user behavior in online social media [12], we consider the personal preferences and social influence of a user as two inde-pendent parts and adopt a combinational approach similar to [4]: where  X  is a parameter that controls the contribution of personal preferences and social influence. sim ( u , u i ) is the similarity be-tween u and u i . In this paper, we compute it as cosine similarity based on the visited locations of u and u i .

According to Eq.(3) and Eq.(4), we obtain the framework of modeling temporal e ff ects of user mobile behavior:
In the above framework, P ( r ( t ) | c u = l , H u , t ) plays an important role as an elemental distribution. It captures a user u  X  X  temporal preferences, and generates the social context P ( r ( t ) | c incorporating social friend u i  X  X  temporal preferences P ( r ( t ) | c l ,
H u i , t ). The temporal preferences and social context are corre-lated through Eq.(4) forming a user X  X  temporal context, which is correlated to the spatial context through Eq.(5). These temporal preferences and correlations form the temporal e ff ects on LBSNs, resulting in three major aspects that we study in this paper:
In the above section, we have modeled a user X  X  mobile behavior and presented the importance of the temporal distributions P ( r ( t ) | c l ,
H u , t ) in capturing a user X  X  temporal preferences and connecting spatial and social contexts. In this section, we discuss how to model ent types of temporal cyclic patterns from a user X  X  check-in history, followed by the modeling of these patterns and then discuss how to integrate them together.
Previous work has discovered that human mobility exhibits strong temporal cyclic patterns, and suggested that daily patterns (hour of the day) and weekly patterns (day of the week) are the two most fundamental patterns in reflecting a user X  X  mobile behavior [13, 8]. It is also reported as a mobile property that a user mostly visits a location during one or more specific periods of time, while rarely visiting it during other time periods [6]. Figure 3 plots a user X  X  daily and weekly check-in distribution at a location l from our dataset. Each point in Figure 3(a) and Figure 3(b) represents the total num-ber of check-ins that occurred at a specific hour of the day (day of the week) at location l by that user, respectively. We can observe the phenomenon of  X  X heck-in probability centering on certain time periods and decreasing during other time periods X  from this figure, which is consistent with the above property. (a) Daily Check-in Frequency Figure 3: Daily and Weekly Check-in Distribution of a User at Location l To model the temporal preferences P ( r ( t ) | c u = l , likely the user would visit location l at 16:00 pm, one can sim-ply count the number of a user X  X  previous check-ins at location l at 16:00 pm, and compute its ratio to the total number of his / her check-ins at location l through Figure 3. However, users usually do not have check-ins at each hour of the day (day of the week) on a location. For example, there are no check-ins from hour 0 to hour 2 in Figure 3(a). It would be arbitrary to determine that the proba-bility of his / her check-in during that time is zero, as the visit time of a user at the same location tends to be within a user-biased time period. Therefore, a smoothing technique is inevitable to evaluate the probability of a check-in at unvisited time.
Mathematically, we need a probability distribution to model a user X  X  temporal preferences at a location P ( r ( t ) = q | c Such distribution should satisfy the following requirements: (1) probability distribution centers on one or more temporal states; (2) probability decreases as the distance to the center point increases; and (3) each user has a biased probability decreasing speed around a center. Among various distributions, Gaussian mixture distribu-tion is such a distribution capturing these properties. Thus, in this paper, we utilize the Gaussian mixture model ( GMM ) to capture a user X  X  temporal preferences. The hypothesis is that a user u  X  X  vis-iting time at a location l is a stochastic process centered around several time points, as shown below: where k is the number of centers considered to model P ( r ( t ) | c = l , H u , t ). A i controls the maximum power of Gaussian distribution and variance.

Each user may have di ff erent temporal preferences on di ff erent locations, resulting in di ff erent numbers of centers in the above distribution. To determine the value of k , we design a center de-tection strategy to compute the number of possible centers in the temporal state distribution on each observed user-location pair. A temporal state is considered as a center as long as the check-in fre-quency on this temporal state is higher than that of the previously observed temporal state and the next observed temporal state. For a user-location pair with less than three observed temporal states, we consider it a single center case whose center corresponds to the temporal state with the highest check-in frequency.

We applied the center detection strategy to our dataset, and ob-served that more than 90% of daily and weekly patterns have less than two centers , indicating that k = 2 represents the majority. In addition, due to the data sparseness, the daily pattern has a maxi-mum of 24 input points for training, while the weekly pattern has 7 points at most, which is insu ffi cient to accurately model a compli-cated process with too many center points. Therefore, in this paper, we select the number of centers k as two for modeling temporal preferences and take the gradient descent method to solve Eq. (6).
In previous sections, we modeled daily and weekly patterns of a user X  X  mobile behavior with Gaussian mixture distribution. In this section, we discuss how to integrate the two temporal cyclic pat-terns together. We first formally define r ( t ) in terms of daily and weekly temporal states. We define r ( t ) = { r d ( t ) , cator functions mapping the time stamp for each type of time state, where r d ( t )  X  { 0 , 1 ,.... 23 } is the hour of the day (e.g., 10:00 am), indicating the daily temporal state. r w ( t )  X  { 0 , 1 ,..., the week (e.g., Monday), indicating the weekly temporal state. As-sume the time stamp t =  X 2012-11-24 12:30:00pm X , then r d (12:00 pm) and r w ( t ) = 5 (Saturday). We follow the independence assumption [6] of daily and weekly patterns and obtain in happening at hour r d ( t ) given the observation that the check-in actually occurred at location l . Similarly, P ( r w ( t ) | c cates the probability of the check-in happening at day r w the observation that the check-in actually occurred at location l .
In this section, we evaluate the significance of temporal e ff ects with our proposed models under the general framework on two real-world location-based social network datasets. We use loca-tion prediction as an application for evaluation. Since we focus on investigating the temporal e ff ects of user mobile behavior, we perform the evaluation in two stages: (1) we evaluate the models based on temporal preferences, temporal-social correlations, and temporal-spatial correlations, respectively, to see their ability in improving location prediction performance; and (2) we compare the selected location prediction models from our framework with a state-of-the-art location prediction method, which utilizes spatial, temporal and social information in order to give a general idea of the e ff ectiveness and reasonableness of our framework.
We use two publicly available datasets from two location-based http://www.public.asu.edu/~hgao16/dataset.html http://snap.stanford.edu/data/loc-brightkite.html # of Unique Locations 751,176 43,063 # of Test Check-ins 134,575 90, 935 ate the temporal e ff ects of user mobile behavior. Both sites allow a user to check-in at a physical location through his / her cellphone and then let his / her online friends know where he / she is. In both datasets, the friendships are undirected.

We select users who have at least 10 check-ins, and obtain 26,915 and 18,107 users on each dataset. For each user, we randomly sam-ple five of his / her total check-ins as test check-ins. The statistic information of these two datasets is listed in Table 1. For each test check-in from a user u , we consider its check-in time t , the user X  X  historical check-ins before t ( H u , t ), and the check-ins from u  X  X  friends before t ( S u , t ) as observed data. We then predict the test check-in location based on models of temporal preferences, tem-poral social-correlations, and temporal-spatial correlations, respec-tively. We use prediction accuracy , i.e., the ratio of the number of accurately predicted check-ins to the total number of test check-ins, to evaluate the prediction performance.

For the temporal preference model, we use GMM to compute the temporal state probability P ( r ( t ) | c u = l , H u , t Section 4. We rank all the locations observed in H u , t based on their in time t and report the top ranked location for prediction. For the temporal-social correlation model, we first apply GMM to com-pute P ( r ( t ) | c u = l , H u i , t ) for each user u  X  X  friend u the P ( r ( t ) | c u = l , S u , t ) and P ( r ( t ) | c location prediction. Finally, for the temporal-spatial correlation model, we compute the check-in probability P ( c u = l | r ( t ) through Eq.(5) with the temporal-social correlation model and existing spatial models.
In this section, we evaluate the e ff ectiveness of temporal pref-erences in terms of (1) whether applying smooth technology can capture a user X  X  temporal preferences more accurately; and (2) how do di ff erent temporal cyclic patterns a ff ect a user X  X  temporal pref-erences. Table 2 shows the detailed prediction performance, where  X  X aily X  and  X  X eekly X  indicate the type of patterns used in Eq. (7).  X  X aily_Weekly X  represents the combination of the two patterns through Eq.(7). The non-smooth approaches simply consider the ratio of a user X  X  previous check-ins on l at r ( t ):
We summarize the essential observations from Table 2:
In sum, both daily and weekly cyclic patterns observed from a user X  X  check-in history can be utilized for improving location pre-diction performance. By exploiting their relationship to the unob-served cyclic patterns through smoothing, we are able to capture a user X  X  mobile behavior more accurately. In addition, the com-bination of daily and weekly patterns can better explain a user X  X  temporal preferences than each pattern.
In this section, we investigate the e ff ectiveness of temporal-social correlations. We are interested in how a user X  X  mobile behavior on a location is a ff ected by his / her temporal preferences and his / her friends X  temporal preferences. According to the temporal-social correlation model in Eq.(4),  X  is a parameter to control the con-tribution of personal preferences and social influence. Therefore, to investigate the temporal-social correlations, we consider three variants of the model: The results are reported in Table 3. Due to the space limit, we only present the results on Brightkite, as similar results are observed on Foursquare. We summarize the essential observations below: Table 3: Location Prediction with Temp-Social Correlations Brightkite
In this section, we investigate the e ff ectiveness of temporal-spatial correlations in Eq. (5), which also corresponds to our framework. We first present a set of state-of-the-art approaches for modeling spatial correlations model.
We introduce three state-of-the-art spatial models, which utilize location trajectory patterns for location prediction.
Table 4 lists the location prediction performance with various spatial-temporal correlations. Each cell represents the prediction accuracy with the correlated models from the corresponding row and column, where  X  Temporal Only  X  indicates that no spatial con-text is used in Eq. (5), corresponding to the temporal-social correla-tion model Tmp-Soc in Table 3.  X  Spatial Only  X  indicates no tem-poral context is used, corresponding to the above spatial models. The percentage listed next to the accuracy represents the relative improvement over the corresponding spatial model. We summa-rize several observations below:
Foursquare 0.3276 0.3213 0.3423 0.3127
To summarize, our framework provides a way to evaluate tem-poral e ff ects on various location prediction models. The empirical comparison indicates that SHM, considering temporal information (denoted as SHM + T), performs the best. Since SHM + T takes into account temporal, spatial and social information, we would like to further investigate how it fares in comparison with the state-of-the-art location prediction approach which also considers tempo-ral, spatial and social information.
 PSMM [2] is a state-of-the-art location prediction method in LBSNs that leverages spatial, temporal and social information for location prediction. It also utilizes Gaussian distribution; how-ever, di ff erent from our work, it models spatial patterns instead of temporal patterns as Gaussian distribution. We compare SHM + T with PSMM on our two datasets and the results are shown in Ta-ble 5, where D (daily) and W (weekly) denote the type of tem-poral information considered. The experiment results show that SHM + T performs consistently better that PSMM . According to the di ff erent types of cyclic patterns used in SHM + T, it achieves 6 . 30% and 5 . 66% relative improvement, on average, over PSMM on Brightkite and Foursquare, respectively. This indicates that the prediction models selected from our framework could be very ef-fective in capturing a user X  X  mobile behavior.
In this paper, we model the temporal e ff ects of user mobile be-havior on LBSNs with respect to two aspects: temporal preferences and temporal correlations. We study each aspect under a proposed framework which not only models these aspects together but also provides the ability to select the most e ff ective location prediction algorithm. Our experimental results show that a user X  X  mobile be-havior is a ff ected by various temporal cyclic patterns whose dis-tribution can be modeled as a Gaussian mixture distribution and therefore captures a user X  X  temporal preferences more accurately. We also observe that a user X  X  temporal preferences are correlated with his social friends with a lot of preference overlapping, and conclude that temporal context is complementary to spatial con-text in improving location prediction performance. Among various directions for future work, it would be interesting to consider con-tinuous temporal states for modeling cyclic patterns and explore other types of temporal cyclic patterns.
This work is supported, in part, by ONR (N000141010091). [1] J. Chang and E. Sun. Location 3: How users share and [2] E. Cho, S. Myers, and J. Leskovec. Friendship and mobility: [3] H. Gao, G. Barbier, and R. Goolsby. Harnessing the [4] H. Gao, J. Tang, and H. Liu. Exploring social-historical ties [5] H. Gao, J. Tang, and H. Liu. gSCorr: Modeling geo-social [6] H. Gao, J. Tang, and H. Liu. Mobile location prediction in [7] M. C. Gonzalez, C. A. Hidalgo, and A.-L. Barabasi.
 [8] E. Malmi, T. Do, and D. Gatica-Perez. Checking in or [9] A. Research. Mobile advertisers forecast to spend $1.8 [10] S. Scellato, A. Noulas, R. Lambiotte, and C. Mascolo. [11] L. Song, D. Kotz, R. Jain, and X. He. Evaluating location [12] J. Tang, H. Gao, H. Liu, and A. D. Sarma. eTrust: [13] M. Ye, K. Janowicz, C. M X lligann, and W. Lee. What you [14] M. Ye, P. Yin, W. Lee, and D. Lee. Exploiting geographical [15] Y. Zheng, X. Xie, and W.-Y. Ma. Geolife: A collaborative
