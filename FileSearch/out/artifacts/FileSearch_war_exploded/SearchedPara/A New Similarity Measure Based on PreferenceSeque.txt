 Recently, CF-based recommender syste ms have gradually become one of the most important recommender systems. Nowadays, they are widely used and make great success in many applications [2 ], especially in e-commerce web sites, such as www.amazon.com, www.netflix.com, www.ebay.com, et al. Besides, lots of researchers pay more and more attentions to CF techniques of these recom-mender systems. Generally speaking, CF techniques mainly include three cate-gories [10]: memory-based algorithms [7], model-based algorithms [5], and hybrid CF algorithms [9].

In memory-based CF algorithms, they fir stly compute similarity between users or items on the user-item rating matrix, and then generate predictions or rec-ommendations for objective users. So similarity computation is one critical step of CF algorithms. At present, the most commonly used ones are vector cosine similarity and Pearson corre lation coefficient [3]. Vector cosine similarity takes each user or item as a vector of ratings, and computes the cosine angle formed by the rating vectors. Pearson correlati on coefficient measures the degree of two users or items linearly relate to each o ther. They have both made great success in many practical CF applications.

However, in some cases, what recommender systems get are not the ratings, but preference sequences of users on a se ries of items. For this type of data, those traditional similarity measures may fail to meet the practical application requirements. In this paper, from the point view of user behavior, a similarity measure based on inversion (Inversion) is proposed for preference sequences nat-urally. Based on the Inversion similarity measure, some structural information of user preference sequences is analyzed . By merging average precision (AP) and weighted inversion into similarity computation, a new similarity measure based on preference sequences is proposed for co llaborative filtering. Finally some ex-perimental results show that the proposed similarity measure based on preference sequences can get better performance th an the common similarity measures in preference sequences datasets.

The rest of this paper is organized as fo llows. Section 2 intr oduces some pre-liminary knowledge, including overview of CF recommender systems and simi-larity measures. Section 3 gives out some analysis on structural information of user preference sequences, and a new si milarity measure based on preference sequences is proposed for collaborative filtering. Some preliminary experimen-tal results and evaluations are shown in Section 4. Finally, Section 5 presents conclusions and future work. 2.1 Overview of CF Recommender Systems In CF recommender systems, the fundamental assumption is that if users u and v have similar ratings on some items, they will also give similar ratings on other items [10]. Based on the above assumption, the basic form of CF recommender systems can be described as follows. I n a typical CF recomme nder system, there are two lists: one is list of M users, { u 1 ,u 2 , ..., u M } , and the other is list of N items, { i 1 ,i 2 , ..., i N } . The users X  ratings on items can either be explicit in-dications, such as real numbers or like/dislikes, or implicit indications, such as purchases or click-throughs. All the ratings constitute a user-item rating matrix, usually a very sparse matrix. 2.2 Similarity Measures in CF Recommender Systems Similarity computation is one of the most important phases of CF recommender systems. For user based CF recommender s ystems, the co-rating items that the two users u and v have both rated should firstly be found out, and then select the appropriate method to compute the similarity between users u and v . It is similar for item based CF recommender systems. At present, there are many different methods for similarity computation [1], but the most commonly used are vector cosine similarity (Cosine) and Pearson  X  X  correlation coefficient (Pearson). In this section, the ratings of one user are seen as a preference sequence and inversion is employed as a similarity me asure of the preference sequences. By analyzing some problems of the similarity measure based on inversion and some structural information of preference sequences, a new similarity measure based on preference sequences for collaborative filtering is proposed by merging average precision and weighted inversion into similarity computation. Here the similarity measure based on inversion is firstly introduced as follows. 3.1 Similarity Measure Based on Inversion From the point view of behavioral psychology, one X  X  behavior on some items (such as high or low score, purchase or not, int erested or disgusted, et al.) can be seen as a preference sequence, thus the similarity between two users can be measured by the two preference sequences of their b ehaviors [6,8]. In some sense, it may get better performance than the common vector cosine similarity and Pearson correlation coefficient.

Based on the above analysis, a similarity measure based on inversion can be proposed for collaborative filtering, and thus similarity computation between two users can be converted to inversion com putation of their preference sequences. First, some definitions are given as follows.
 Definition 1 ( Inversion ) [4]: Suppose that P =( p 1 ,p 2 ,  X  X  X  ,p n ) is a sequence a pair, the number of pairs at how many times p i &gt;p j occurs in sequence P is called its inversion, written as t ( P )andshownasFormula(1). where, f (  X  ) is an indicator function.
 Definition 2 ( Inversion of two preference sequences ): Suppose that P =( p 1 ,p 2 ,  X  X  X  ,p ferent real numbers respectively, and the re is permutation relationship between them. The inversion of sequence Q can be calculated by taking P as benchmark. In detail, sort P in ascending order to get P =( p 1 ,p 2 ,  X  X  X  ,p n ), meanwhile, ac-cording to the permutatio n relationship between P and Q , Q =( q 1 ,q 2 ,  X  X  X  ,q n ) can be gotten. Thus, the inversion of sequence Q is called the inversion from Q to P , written as t ( Q  X  P ).

According to the above definitions and theorems, similarity between two se-quences can be calculated by normalizin g the inversion between them, as shown in Formula (2).
 According to Formula (1) and Formula (2), the time complexity of similarity measure based on inversion is O ( n 2 ). However, according to merge-sort algo-rithm [4], similarity measure based on inversion can reduce its time complexity to O ( n log n ). 3.2 A New Similarity Measure Based on Preference Sequences In the above section, similarity measure based on inversion tries to understand user behaviors by preference sequences. However, the similarity measure based on inversion may not give the best performance in some cases.

Generally speaking, for high efficien cy and high accuracy of recommender systems, not all the items are considered, but just the items that users are more interested in should be considered in practical recommender systems, that is, items with higher preference should be taken more attention to. To address the above problems, we can take position information into account during similarity computation. According to our research, two kinds of position information should be considered as follows.  X  In similarity measure based on inversion, inversion values on different posi- X  Besides, there is another interesting phenomenon that some elements of where N is the length of sequence, p ( i ) is the precision at cut-off i in the sequence  X  P ,and rel ( i ) is an indicator function.

According to Formula (3) and Formula (4), two kinds of position information of each element in preference sequences can be taken into the similarity com-putation, and a new similarity measure b ased on preference sequences can be proposed for collaborative filtering, named similarity measure based on Weighted Inversion and Average Precision (WIAP), as shown in Formula (5).
 where O is the benchmark sequence, WInv ( P )and AP ( P ) are calculated accord-ing to Formula (3) and Formula (4) respectively. Finally the proposed similarity measure WIAP can be described as Algorithm 1.
 Algorithm 1. Similarity Measure by Merging Weighted Inversion and Average Precision (WIAP) In Algorithm 1, Step (1-2) are some data preprocessing and initialization. Step (3-14) are to calculate of WInv ( P )and AP ( P ) according to Formula (3) and Formula (4), where Step (4-5) are to calculate WInv ( P ), Step (6-9) and Step (11-14) are to calculate of AP ( P ). Step (15) is to normalize WInv ( P )into [0,1]. Step (16) is to calculate the final similarity measure WIAP according to Formula (5). In this section, some experiments are conducted on four similarity measures (Co-sine, Pearson, Inversion and WIAP) to measure the performance of the proposed similarity measure based on preference sequences. The performance of all the similarity measures are measured by Recall, which is one of the most popular metrics in recommender systems. In information retrieval, recall is the fraction of the documents that are relevant to the query that are successfully retrieved, and it can be given by Formula (6).
 User-based top-N recommendation algorithm [10] is chosen for prediction and recommendation computation in the experiments. It firstly identifies the k most similar users to the objective user. After the k most similar users have been discovered, their corresponding rows in the user-item matrix are aggregated to identify a set of items, C , purchased by the group together with average of their weighted ratings. By sorting each row of set C according to their weights, user-based CF techniques then recommend the top-N items of set C to the objective user. In practice, about 10  X  20 items (such as movies, music, books, et al) can shown in one web page, so in the experiments, we set N to 15, and set k to 10. 4.1 Experiments on Synthetic Dataset In this section, some experiments are conducted on the synthetic dataset which is a 1,000  X  1,000 matrix generated by Matlab program. To verify the good suitability of the proposed similarity measure based on preference sequences, the synthetic matrix is randomly sampled to construct five matrices with different matrix filling ratios from 20% to 100%. The experimental results on the five matrices are shown in Fig.1.
From Fig.1, it can be seen that the proposed similarity measure WIAP outper-forms all the other similarity measures Cosine, Pearson and Inversion on different matrix filling ratios. In particular, similarity measure WIAP almost recalls all the items on the full matrix. Besides, recall of WIAP can increase rapidly along with the rise of matrix filling ratio. 4.2 Experiments on Benchmark Datasets In this section, some experiments are conducted on three benchmark datasets: Movielens dataset, Jeste r dataset and BookCrossing dataset. Similar with ex-periments on synthetic dataset, each benchmark dataset is randomly sampled to construct five matrices with different sampling ratios from 20% to 100%. The experimental results on three benchmark datasets are shown in Table 1.
In Table 1, it contains four blocks where the front three blocks are original recalls of three benchmark datasets an d the last block is the average recalls of them. In all the 15 cases of the front three blocks, the proposed similarity mea-sure WIAP can get much better performan ce than other similarity measures in 12 cases. In cases of 80% of Movielens dataset and 80% and 100% of BookCross-ing dataset, Pearson is just a little bit better than WIAP. Actually, the values of Movielens dataset and BookCrossing dataset are just few discrete numbers which may be not suitable to be seen as pr eference sequences. Thus, WIAP may not get best performance in some cases of them. For the  X  X verage X  block of Table 1, it can be seen that WIAP can get much better performance than other similarity measures in all the cases. Be sides, for BookCrossing dataset, there is an interesting phenomenon that on some sparser matrices, all the similarity measures get higher recalls. That is because the matrices are so sparse that there are not enough books to be recommended, and the similarity measures can recall the very few books with higher proportion. Generally speaking, it can be con-cluded that WIAP outperforms three other similarity measures when measuring preference sequences.
 In this paper, some structural information of user preference sequences in recom-mender systems is analyzed, and a new si milarity measure based on preference sequences, named WIAP, is proposed for collaborative filtering by merging AP and weighted inversion into similarity compuation. Experim ental results show that the proposed similarity measure WIAP trends to get better performance on the datasets with continuous real numbers. However, there are still many further research issues. For example, how to improve the performance of WIAP on the datasets with few discrete numbers may be a valuable research point. Acknowledgments. This work is supported by the National Natural Science FoundationofChina(No.61175052,60975039,6 1203297,60933004,61035003),Na-tional High-tech R&amp;D Programof China (863 Program) (No.2012AA011003),Na-tionalProgramonKeyBasicResearchProject(973Program)(No.2013CB329502).
